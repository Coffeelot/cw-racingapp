(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))h(p);new MutationObserver(p=>{for(const _ of p)if(_.type==="childList")for(const m of _.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&h(m)}).observe(document,{childList:!0,subtree:!0});function l(p){const _={};return p.integrity&&(_.integrity=p.integrity),p.referrerPolicy&&(_.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?_.credentials="include":p.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function h(p){if(p.ep)return;p.ep=!0;const _=l(p);fetch(p.href,_)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function ay(e){const i=Object.create(null);for(const l of e.split(","))i[l]=1;return l=>l in i}const _i={},cu=[],Da=()=>{},zT=()=>!1,im=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),sy=e=>e.startsWith("onUpdate:"),Qi=Object.assign,oy=(e,i)=>{const l=e.indexOf(i);l>-1&&e.splice(l,1)},LT=Object.prototype.hasOwnProperty,ei=(e,i)=>LT.call(e,i),gn=Array.isArray,uu=e=>rm(e)==="[object Map]",Kx=e=>rm(e)==="[object Set]",wn=e=>typeof e=="function",Oi=e=>typeof e=="string",Xo=e=>typeof e=="symbol",Ci=e=>e!==null&&typeof e=="object",Yx=e=>(Ci(e)||wn(e))&&wn(e.then)&&wn(e.catch),Jx=Object.prototype.toString,rm=e=>Jx.call(e),BT=e=>rm(e).slice(8,-1),Qx=e=>rm(e)==="[object Object]",ly=e=>Oi(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Yh=ay(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),am=e=>{const i=Object.create(null);return l=>i[l]||(i[l]=e(l))},FT=/-(\w)/g,aa=am(e=>e.replace(FT,(i,l)=>l?l.toUpperCase():"")),OT=/\B([A-Z])/g,Jl=am(e=>e.replace(OT,"-$1").toLowerCase()),io=am(e=>e.charAt(0).toUpperCase()+e.slice(1)),Zg=am(e=>e?`on${io(e)}`:""),Ho=(e,i)=>!Object.is(e,i),vp=(e,...i)=>{for(let l=0;l<e.length;l++)e[l](...i)},e1=(e,i,l,h=!1)=>{Object.defineProperty(e,i,{configurable:!0,enumerable:!1,writable:h,value:l})},w_=e=>{const i=parseFloat(e);return isNaN(i)?e:i},VT=e=>{const i=Oi(e)?Number(e):NaN;return isNaN(i)?e:i};let q0;const sm=()=>q0||(q0=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function cy(e){if(gn(e)){const i={};for(let l=0;l<e.length;l++){const h=e[l],p=Oi(h)?UT(h):cy(h);if(p)for(const _ in p)i[_]=p[_]}return i}else if(Oi(e)||Ci(e))return e}const NT=/;(?![^(]*\))/g,$T=/:([^]+)/,jT=/\/\*[^]*?\*\//g;function UT(e){const i={};return e.replace(jT,"").split(NT).forEach(l=>{if(l){const h=l.split($T);h.length>1&&(i[h[0].trim()]=h[1].trim())}}),i}function om(e){let i="";if(Oi(e))i=e;else if(gn(e))for(let l=0;l<e.length;l++){const h=om(e[l]);h&&(i+=h+" ")}else if(Ci(e))for(const l in e)e[l]&&(i+=l+" ");return i.trim()}const GT="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",HT=ay(GT);function t1(e){return!!e||e===""}const n1=e=>!!(e&&e.__v_isRef===!0),ee=e=>Oi(e)?e:e==null?"":gn(e)||Ci(e)&&(e.toString===Jx||!wn(e.toString))?n1(e)?ee(e.value):JSON.stringify(e,i1,2):String(e),i1=(e,i)=>n1(i)?i1(e,i.value):uu(i)?{[`Map(${i.size})`]:[...i.entries()].reduce((l,[h,p],_)=>(l[qg(h,_)+" =>"]=p,l),{})}:Kx(i)?{[`Set(${i.size})`]:[...i.values()].map(l=>qg(l))}:Xo(i)?qg(i):Ci(i)&&!gn(i)&&!Qx(i)?String(i):i,qg=(e,i="")=>{var l;return Xo(e)?`Symbol(${(l=e.description)!=null?l:i})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Wr;class r1{constructor(i=!1){this.detached=i,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Wr,!i&&Wr&&(this.index=(Wr.scopes||(Wr.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let i,l;if(this.scopes)for(i=0,l=this.scopes.length;i<l;i++)this.scopes[i].pause();for(i=0,l=this.effects.length;i<l;i++)this.effects[i].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let i,l;if(this.scopes)for(i=0,l=this.scopes.length;i<l;i++)this.scopes[i].resume();for(i=0,l=this.effects.length;i<l;i++)this.effects[i].resume()}}run(i){if(this._active){const l=Wr;try{return Wr=this,i()}finally{Wr=l}}}on(){Wr=this}off(){Wr=this.parent}stop(i){if(this._active){this._active=!1;let l,h;for(l=0,h=this.effects.length;l<h;l++)this.effects[l].stop();for(this.effects.length=0,l=0,h=this.cleanups.length;l<h;l++)this.cleanups[l]();if(this.cleanups.length=0,this.scopes){for(l=0,h=this.scopes.length;l<h;l++)this.scopes[l].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!i){const p=this.parent.scopes.pop();p&&p!==this&&(this.parent.scopes[this.index]=p,p.index=this.index)}this.parent=void 0}}}function Sd(e){return new r1(e)}function a1(){return Wr}function Pr(e,i=!1){Wr&&Wr.cleanups.push(e)}let Si;const Wg=new WeakSet;class s1{constructor(i){this.fn=i,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Wr&&Wr.active&&Wr.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Wg.has(this)&&(Wg.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||l1(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,W0(this),c1(this);const i=Si,l=ts;Si=this,ts=!0;try{return this.fn()}finally{u1(this),Si=i,ts=l,this.flags&=-3}}stop(){if(this.flags&1){for(let i=this.deps;i;i=i.nextDep)dy(i);this.deps=this.depsTail=void 0,W0(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Wg.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){S_(this)&&this.run()}get dirty(){return S_(this)}}let o1=0,Jh,Qh;function l1(e,i=!1){if(e.flags|=8,i){e.next=Qh,Qh=e;return}e.next=Jh,Jh=e}function uy(){o1++}function hy(){if(--o1>0)return;if(Qh){let i=Qh;for(Qh=void 0;i;){const l=i.next;i.next=void 0,i.flags&=-9,i=l}}let e;for(;Jh;){let i=Jh;for(Jh=void 0;i;){const l=i.next;if(i.next=void 0,i.flags&=-9,i.flags&1)try{i.trigger()}catch(h){e||(e=h)}i=l}}if(e)throw e}function c1(e){for(let i=e.deps;i;i=i.nextDep)i.version=-1,i.prevActiveLink=i.dep.activeLink,i.dep.activeLink=i}function u1(e){let i,l=e.depsTail,h=l;for(;h;){const p=h.prevDep;h.version===-1?(h===l&&(l=p),dy(h),ZT(h)):i=h,h.dep.activeLink=h.prevActiveLink,h.prevActiveLink=void 0,h=p}e.deps=i,e.depsTail=l}function S_(e){for(let i=e.deps;i;i=i.nextDep)if(i.dep.version!==i.version||i.dep.computed&&(h1(i.dep.computed)||i.dep.version!==i.version))return!0;return!!e._dirty}function h1(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===sd))return;e.globalVersion=sd;const i=e.dep;if(e.flags|=2,i.version>0&&!e.isSSR&&e.deps&&!S_(e)){e.flags&=-3;return}const l=Si,h=ts;Si=e,ts=!0;try{c1(e);const p=e.fn(e._value);(i.version===0||Ho(p,e._value))&&(e._value=p,i.version++)}catch(p){throw i.version++,p}finally{Si=l,ts=h,u1(e),e.flags&=-3}}function dy(e,i=!1){const{dep:l,prevSub:h,nextSub:p}=e;if(h&&(h.nextSub=p,e.prevSub=void 0),p&&(p.prevSub=h,e.nextSub=void 0),l.subs===e&&(l.subs=h,!h&&l.computed)){l.computed.flags&=-5;for(let _=l.computed.deps;_;_=_.nextDep)dy(_,!0)}!i&&!--l.sc&&l.map&&l.map.delete(l.key)}function ZT(e){const{prevDep:i,nextDep:l}=e;i&&(i.nextDep=l,e.prevDep=void 0),l&&(l.prevDep=i,e.nextDep=void 0)}let ts=!0;const d1=[];function Ko(){d1.push(ts),ts=!1}function Yo(){const e=d1.pop();ts=e===void 0?!0:e}function W0(e){const{cleanup:i}=e;if(e.cleanup=void 0,i){const l=Si;Si=void 0;try{i()}finally{Si=l}}}let sd=0;class qT{constructor(i,l){this.sub=i,this.dep=l,this.version=l.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class fy{constructor(i){this.computed=i,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(i){if(!Si||!ts||Si===this.computed)return;let l=this.activeLink;if(l===void 0||l.sub!==Si)l=this.activeLink=new qT(Si,this),Si.deps?(l.prevDep=Si.depsTail,Si.depsTail.nextDep=l,Si.depsTail=l):Si.deps=Si.depsTail=l,f1(l);else if(l.version===-1&&(l.version=this.version,l.nextDep)){const h=l.nextDep;h.prevDep=l.prevDep,l.prevDep&&(l.prevDep.nextDep=h),l.prevDep=Si.depsTail,l.nextDep=void 0,Si.depsTail.nextDep=l,Si.depsTail=l,Si.deps===l&&(Si.deps=h)}return l}trigger(i){this.version++,sd++,this.notify(i)}notify(i){uy();try{for(let l=this.subs;l;l=l.prevSub)l.sub.notify()&&l.sub.dep.notify()}finally{hy()}}}function f1(e){if(e.dep.sc++,e.sub.flags&4){const i=e.dep.computed;if(i&&!e.dep.subs){i.flags|=20;for(let h=i.deps;h;h=h.nextDep)f1(h)}const l=e.dep.subs;l!==e&&(e.prevSub=l,l&&(l.nextSub=e)),e.dep.subs=e}}const Dp=new WeakMap,Gl=Symbol(""),C_=Symbol(""),od=Symbol("");function zr(e,i,l){if(ts&&Si){let h=Dp.get(e);h||Dp.set(e,h=new Map);let p=h.get(l);p||(h.set(l,p=new fy),p.map=h,p.key=l),p.track()}}function Ys(e,i,l,h,p,_){const m=Dp.get(e);if(!m){sd++;return}const o=T=>{T&&T.trigger()};if(uy(),i==="clear")m.forEach(o);else{const T=gn(e),k=T&&ly(l);if(T&&l==="length"){const M=Number(h);m.forEach((D,O)=>{(O==="length"||O===od||!Xo(O)&&O>=M)&&o(D)})}else switch((l!==void 0||m.has(void 0))&&o(m.get(l)),k&&o(m.get(od)),i){case"add":T?k&&o(m.get("length")):(o(m.get(Gl)),uu(e)&&o(m.get(C_)));break;case"delete":T||(o(m.get(Gl)),uu(e)&&o(m.get(C_)));break;case"set":uu(e)&&o(m.get(Gl));break}}hy()}function WT(e,i){const l=Dp.get(e);return l&&l.get(i)}function eu(e){const i=fn(e);return i===e?i:(zr(i,"iterate",od),za(e)?i:i.map(Lr))}function lm(e){return zr(e=fn(e),"iterate",od),e}const XT={__proto__:null,[Symbol.iterator](){return Xg(this,Symbol.iterator,Lr)},concat(...e){return eu(this).concat(...e.map(i=>gn(i)?eu(i):i))},entries(){return Xg(this,"entries",e=>(e[1]=Lr(e[1]),e))},every(e,i){return Ws(this,"every",e,i,void 0,arguments)},filter(e,i){return Ws(this,"filter",e,i,l=>l.map(Lr),arguments)},find(e,i){return Ws(this,"find",e,i,Lr,arguments)},findIndex(e,i){return Ws(this,"findIndex",e,i,void 0,arguments)},findLast(e,i){return Ws(this,"findLast",e,i,Lr,arguments)},findLastIndex(e,i){return Ws(this,"findLastIndex",e,i,void 0,arguments)},forEach(e,i){return Ws(this,"forEach",e,i,void 0,arguments)},includes(...e){return Kg(this,"includes",e)},indexOf(...e){return Kg(this,"indexOf",e)},join(e){return eu(this).join(e)},lastIndexOf(...e){return Kg(this,"lastIndexOf",e)},map(e,i){return Ws(this,"map",e,i,void 0,arguments)},pop(){return Gh(this,"pop")},push(...e){return Gh(this,"push",e)},reduce(e,...i){return X0(this,"reduce",e,i)},reduceRight(e,...i){return X0(this,"reduceRight",e,i)},shift(){return Gh(this,"shift")},some(e,i){return Ws(this,"some",e,i,void 0,arguments)},splice(...e){return Gh(this,"splice",e)},toReversed(){return eu(this).toReversed()},toSorted(e){return eu(this).toSorted(e)},toSpliced(...e){return eu(this).toSpliced(...e)},unshift(...e){return Gh(this,"unshift",e)},values(){return Xg(this,"values",Lr)}};function Xg(e,i,l){const h=lm(e),p=h[i]();return h!==e&&!za(e)&&(p._next=p.next,p.next=()=>{const _=p._next();return _.value&&(_.value=l(_.value)),_}),p}const KT=Array.prototype;function Ws(e,i,l,h,p,_){const m=lm(e),o=m!==e&&!za(e),T=m[i];if(T!==KT[i]){const D=T.apply(e,_);return o?Lr(D):D}let k=l;m!==e&&(o?k=function(D,O){return l.call(this,Lr(D),O,e)}:l.length>2&&(k=function(D,O){return l.call(this,D,O,e)}));const M=T.call(m,k,h);return o&&p?p(M):M}function X0(e,i,l,h){const p=lm(e);let _=l;return p!==e&&(za(e)?l.length>3&&(_=function(m,o,T){return l.call(this,m,o,T,e)}):_=function(m,o,T){return l.call(this,m,Lr(o),T,e)}),p[i](_,...h)}function Kg(e,i,l){const h=fn(e);zr(h,"iterate",od);const p=h[i](...l);return(p===-1||p===!1)&&gy(l[0])?(l[0]=fn(l[0]),h[i](...l)):p}function Gh(e,i,l=[]){Ko(),uy();const h=fn(e)[i].apply(e,l);return hy(),Yo(),h}const YT=ay("__proto__,__v_isRef,__isVue"),p1=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Xo));function JT(e){Xo(e)||(e=String(e));const i=fn(this);return zr(i,"has",e),i.hasOwnProperty(e)}class m1{constructor(i=!1,l=!1){this._isReadonly=i,this._isShallow=l}get(i,l,h){if(l==="__v_skip")return i.__v_skip;const p=this._isReadonly,_=this._isShallow;if(l==="__v_isReactive")return!p;if(l==="__v_isReadonly")return p;if(l==="__v_isShallow")return _;if(l==="__v_raw")return h===(p?_?lP:v1:_?y1:_1).get(i)||Object.getPrototypeOf(i)===Object.getPrototypeOf(h)?i:void 0;const m=gn(i);if(!p){let T;if(m&&(T=XT[l]))return T;if(l==="hasOwnProperty")return JT}const o=Reflect.get(i,l,ci(i)?i:h);return(Xo(l)?p1.has(l):YT(l))||(p||zr(i,"get",l),_)?o:ci(o)?m&&ly(l)?o:o.value:Ci(o)?p?Cd(o):yr(o):o}}class g1 extends m1{constructor(i=!1){super(!1,i)}set(i,l,h,p){let _=i[l];if(!this._isShallow){const T=Wl(_);if(!za(h)&&!Wl(h)&&(_=fn(_),h=fn(h)),!gn(i)&&ci(_)&&!ci(h))return T?!1:(_.value=h,!0)}const m=gn(i)&&ly(l)?Number(l)<i.length:ei(i,l),o=Reflect.set(i,l,h,ci(i)?i:p);return i===fn(p)&&(m?Ho(h,_)&&Ys(i,"set",l,h):Ys(i,"add",l,h)),o}deleteProperty(i,l){const h=ei(i,l);i[l];const p=Reflect.deleteProperty(i,l);return p&&h&&Ys(i,"delete",l,void 0),p}has(i,l){const h=Reflect.has(i,l);return(!Xo(l)||!p1.has(l))&&zr(i,"has",l),h}ownKeys(i){return zr(i,"iterate",gn(i)?"length":Gl),Reflect.ownKeys(i)}}class QT extends m1{constructor(i=!1){super(!0,i)}set(i,l){return!0}deleteProperty(i,l){return!0}}const eP=new g1,tP=new QT,nP=new g1(!0);const T_=e=>e,op=e=>Reflect.getPrototypeOf(e);function iP(e,i,l){return function(...h){const p=this.__v_raw,_=fn(p),m=uu(_),o=e==="entries"||e===Symbol.iterator&&m,T=e==="keys"&&m,k=p[e](...h),M=l?T_:i?P_:Lr;return!i&&zr(_,"iterate",T?C_:Gl),{next(){const{value:D,done:O}=k.next();return O?{value:D,done:O}:{value:o?[M(D[0]),M(D[1])]:M(D),done:O}},[Symbol.iterator](){return this}}}}function lp(e){return function(...i){return e==="delete"?!1:e==="clear"?void 0:this}}function rP(e,i){const l={get(p){const _=this.__v_raw,m=fn(_),o=fn(p);e||(Ho(p,o)&&zr(m,"get",p),zr(m,"get",o));const{has:T}=op(m),k=i?T_:e?P_:Lr;if(T.call(m,p))return k(_.get(p));if(T.call(m,o))return k(_.get(o));_!==m&&_.get(p)},get size(){const p=this.__v_raw;return!e&&zr(fn(p),"iterate",Gl),Reflect.get(p,"size",p)},has(p){const _=this.__v_raw,m=fn(_),o=fn(p);return e||(Ho(p,o)&&zr(m,"has",p),zr(m,"has",o)),p===o?_.has(p):_.has(p)||_.has(o)},forEach(p,_){const m=this,o=m.__v_raw,T=fn(o),k=i?T_:e?P_:Lr;return!e&&zr(T,"iterate",Gl),o.forEach((M,D)=>p.call(_,k(M),k(D),m))}};return Qi(l,e?{add:lp("add"),set:lp("set"),delete:lp("delete"),clear:lp("clear")}:{add(p){!i&&!za(p)&&!Wl(p)&&(p=fn(p));const _=fn(this);return op(_).has.call(_,p)||(_.add(p),Ys(_,"add",p,p)),this},set(p,_){!i&&!za(_)&&!Wl(_)&&(_=fn(_));const m=fn(this),{has:o,get:T}=op(m);let k=o.call(m,p);k||(p=fn(p),k=o.call(m,p));const M=T.call(m,p);return m.set(p,_),k?Ho(_,M)&&Ys(m,"set",p,_):Ys(m,"add",p,_),this},delete(p){const _=fn(this),{has:m,get:o}=op(_);let T=m.call(_,p);T||(p=fn(p),T=m.call(_,p)),o&&o.call(_,p);const k=_.delete(p);return T&&Ys(_,"delete",p,void 0),k},clear(){const p=fn(this),_=p.size!==0,m=p.clear();return _&&Ys(p,"clear",void 0,void 0),m}}),["keys","values","entries",Symbol.iterator].forEach(p=>{l[p]=iP(p,e,i)}),l}function py(e,i){const l=rP(e,i);return(h,p,_)=>p==="__v_isReactive"?!e:p==="__v_isReadonly"?e:p==="__v_raw"?h:Reflect.get(ei(l,p)&&p in h?l:h,p,_)}const aP={get:py(!1,!1)},sP={get:py(!1,!0)},oP={get:py(!0,!1)};const _1=new WeakMap,y1=new WeakMap,v1=new WeakMap,lP=new WeakMap;function cP(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function uP(e){return e.__v_skip||!Object.isExtensible(e)?0:cP(BT(e))}function yr(e){return Wl(e)?e:my(e,!1,eP,aP,_1)}function hP(e){return my(e,!1,nP,sP,y1)}function Cd(e){return my(e,!0,tP,oP,v1)}function my(e,i,l,h,p){if(!Ci(e)||e.__v_raw&&!(i&&e.__v_isReactive))return e;const _=p.get(e);if(_)return _;const m=uP(e);if(m===0)return e;const o=new Proxy(e,m===2?h:l);return p.set(e,o),o}function Zo(e){return Wl(e)?Zo(e.__v_raw):!!(e&&e.__v_isReactive)}function Wl(e){return!!(e&&e.__v_isReadonly)}function za(e){return!!(e&&e.__v_isShallow)}function gy(e){return e?!!e.__v_raw:!1}function fn(e){const i=e&&e.__v_raw;return i?fn(i):e}function cm(e){return!ei(e,"__v_skip")&&Object.isExtensible(e)&&e1(e,"__v_skip",!0),e}const Lr=e=>Ci(e)?yr(e):e,P_=e=>Ci(e)?Cd(e):e;function ci(e){return e?e.__v_isRef===!0:!1}function Ye(e){return b1(e,!1)}function an(e){return b1(e,!0)}function b1(e,i){return ci(e)?e:new dP(e,i)}class dP{constructor(i,l){this.dep=new fy,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=l?i:fn(i),this._value=l?i:Lr(i),this.__v_isShallow=l}get value(){return this.dep.track(),this._value}set value(i){const l=this._rawValue,h=this.__v_isShallow||za(i)||Wl(i);i=h?i:fn(i),Ho(i,l)&&(this._rawValue=i,this._value=h?i:Lr(i),this.dep.trigger())}}function H(e){return ci(e)?e.value:e}const fP={get:(e,i,l)=>i==="__v_raw"?e:H(Reflect.get(e,i,l)),set:(e,i,l,h)=>{const p=e[i];return ci(p)&&!ci(l)?(p.value=l,!0):Reflect.set(e,i,l,h)}};function x1(e){return Zo(e)?e:new Proxy(e,fP)}function um(e){const i=gn(e)?new Array(e.length):{};for(const l in e)i[l]=w1(e,l);return i}class pP{constructor(i,l,h){this._object=i,this._key=l,this._defaultValue=h,this.__v_isRef=!0,this._value=void 0}get value(){const i=this._object[this._key];return this._value=i===void 0?this._defaultValue:i}set value(i){this._object[this._key]=i}get dep(){return WT(fn(this._object),this._key)}}class mP{constructor(i){this._getter=i,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function nn(e,i,l){return ci(e)?e:wn(e)?new mP(e):Ci(e)&&arguments.length>1?w1(e,i,l):Ye(e)}function w1(e,i,l){const h=e[i];return ci(h)?h:new pP(e,i,l)}class gP{constructor(i,l,h){this.fn=i,this.setter=l,this._value=void 0,this.dep=new fy(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=sd-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!l,this.isSSR=h}notify(){if(this.flags|=16,!(this.flags&8)&&Si!==this)return l1(this,!0),!0}get value(){const i=this.dep.track();return h1(this),i&&(i.version=this.dep.version),this._value}set value(i){this.setter&&this.setter(i)}}function _P(e,i,l=!1){let h,p;return wn(e)?h=e:(h=e.get,p=e.set),new gP(h,p,l)}const cp={},zp=new WeakMap;let Nl;function yP(e,i=!1,l=Nl){if(l){let h=zp.get(l);h||zp.set(l,h=[]),h.push(e)}}function vP(e,i,l=_i){const{immediate:h,deep:p,once:_,scheduler:m,augmentJob:o,call:T}=l,k=pe=>p?pe:za(pe)||p===!1||p===0?Js(pe,1):Js(pe);let M,D,O,z,F=!1,N=!1;if(ci(e)?(D=()=>e.value,F=za(e)):Zo(e)?(D=()=>k(e),F=!0):gn(e)?(N=!0,F=e.some(pe=>Zo(pe)||za(pe)),D=()=>e.map(pe=>{if(ci(pe))return pe.value;if(Zo(pe))return k(pe);if(wn(pe))return T?T(pe,2):pe()})):wn(e)?i?D=T?()=>T(e,2):e:D=()=>{if(O){Ko();try{O()}finally{Yo()}}const pe=Nl;Nl=M;try{return T?T(e,3,[z]):e(z)}finally{Nl=pe}}:D=Da,i&&p){const pe=D,be=p===!0?1/0:p;D=()=>Js(pe(),be)}const q=a1(),oe=()=>{M.stop(),q&&q.active&&oy(q.effects,M)};if(_&&i){const pe=i;i=(...be)=>{pe(...be),oe()}}let _e=N?new Array(e.length).fill(cp):cp;const Se=pe=>{if(!(!(M.flags&1)||!M.dirty&&!pe))if(i){const be=M.run();if(p||F||(N?be.some((de,Ce)=>Ho(de,_e[Ce])):Ho(be,_e))){O&&O();const de=Nl;Nl=M;try{const Ce=[be,_e===cp?void 0:N&&_e[0]===cp?[]:_e,z];T?T(i,3,Ce):i(...Ce),_e=be}finally{Nl=de}}}else M.run()};return o&&o(Se),M=new s1(D),M.scheduler=m?()=>m(Se,!1):Se,z=pe=>yP(pe,!1,M),O=M.onStop=()=>{const pe=zp.get(M);if(pe){if(T)T(pe,4);else for(const be of pe)be();zp.delete(M)}},i?h?Se(!0):_e=M.run():m?m(Se.bind(null,!0),!0):M.run(),oe.pause=M.pause.bind(M),oe.resume=M.resume.bind(M),oe.stop=oe,oe}function Js(e,i=1/0,l){if(i<=0||!Ci(e)||e.__v_skip||(l=l||new Set,l.has(e)))return e;if(l.add(e),i--,ci(e))Js(e.value,i,l);else if(gn(e))for(let h=0;h<e.length;h++)Js(e[h],i,l);else if(Kx(e)||uu(e))e.forEach(h=>{Js(h,i,l)});else if(Qx(e)){for(const h in e)Js(e[h],i,l);for(const h of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,h)&&Js(e[h],i,l)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Td(e,i,l,h){try{return h?e(...h):e()}catch(p){hm(p,i,l)}}function rs(e,i,l,h){if(wn(e)){const p=Td(e,i,l,h);return p&&Yx(p)&&p.catch(_=>{hm(_,i,l)}),p}if(gn(e)){const p=[];for(let _=0;_<e.length;_++)p.push(rs(e[_],i,l,h));return p}}function hm(e,i,l,h=!0){const p=i?i.vnode:null,{errorHandler:_,throwUnhandledErrorInProduction:m}=i&&i.appContext.config||_i;if(i){let o=i.parent;const T=i.proxy,k=`https://vuejs.org/error-reference/#runtime-${l}`;for(;o;){const M=o.ec;if(M){for(let D=0;D<M.length;D++)if(M[D](e,T,k)===!1)return}o=o.parent}if(_){Ko(),Td(_,null,10,[e,T,k]),Yo();return}}bP(e,l,p,h,m)}function bP(e,i,l,h=!0,p=!1){if(p)throw e;console.error(e)}const Xr=[];let vs=-1;const hu=[];let $o=null,su=0;const S1=Promise.resolve();let Lp=null;function Fi(e){const i=Lp||S1;return e?i.then(this?e.bind(this):e):i}function xP(e){let i=vs+1,l=Xr.length;for(;i<l;){const h=i+l>>>1,p=Xr[h],_=ld(p);_<e||_===e&&p.flags&2?i=h+1:l=h}return i}function _y(e){if(!(e.flags&1)){const i=ld(e),l=Xr[Xr.length-1];!l||!(e.flags&2)&&i>=ld(l)?Xr.push(e):Xr.splice(xP(i),0,e),e.flags|=1,C1()}}function C1(){Lp||(Lp=S1.then(k1))}function T1(e){gn(e)?hu.push(...e):$o&&e.id===-1?$o.splice(su+1,0,e):e.flags&1||(hu.push(e),e.flags|=1),C1()}function K0(e,i,l=vs+1){for(;l<Xr.length;l++){const h=Xr[l];if(h&&h.flags&2){if(e&&h.id!==e.uid)continue;Xr.splice(l,1),l--,h.flags&4&&(h.flags&=-2),h(),h.flags&4||(h.flags&=-2)}}}function P1(e){if(hu.length){const i=[...new Set(hu)].sort((l,h)=>ld(l)-ld(h));if(hu.length=0,$o){$o.push(...i);return}for($o=i,su=0;su<$o.length;su++){const l=$o[su];l.flags&4&&(l.flags&=-2),l.flags&8||l(),l.flags&=-2}$o=null,su=0}}const ld=e=>e.id==null?e.flags&2?-1:1/0:e.id;function k1(e){const i=Da;try{for(vs=0;vs<Xr.length;vs++){const l=Xr[vs];l&&!(l.flags&8)&&(l.flags&4&&(l.flags&=-2),Td(l,l.i,l.i?15:14),l.flags&4||(l.flags&=-2))}}finally{for(;vs<Xr.length;vs++){const l=Xr[vs];l&&(l.flags&=-2)}vs=-1,Xr.length=0,P1(),Lp=null,(Xr.length||hu.length)&&k1()}}let Yr=null,I1=null;function Bp(e){const i=Yr;return Yr=e,I1=e&&e.type.__scopeId||null,i}function Q(e,i=Yr,l){if(!i||e._n)return e;const h=(...p)=>{h._d&&cb(-1);const _=Bp(i);let m;try{m=e(...p)}finally{Bp(_),h._d&&cb(1)}return m};return h._n=!0,h._c=!0,h._d=!0,h}function Tr(e,i){if(Yr===null)return e;const l=gm(Yr),h=e.dirs||(e.dirs=[]);for(let p=0;p<i.length;p++){let[_,m,o,T=_i]=i[p];_&&(wn(_)&&(_={mounted:_,updated:_}),_.deep&&Js(m),h.push({dir:_,instance:l,value:m,oldValue:void 0,arg:o,modifiers:T}))}return e}function Ll(e,i,l,h){const p=e.dirs,_=i&&i.dirs;for(let m=0;m<p.length;m++){const o=p[m];_&&(o.oldValue=_[m].value);let T=o.dir[h];T&&(Ko(),rs(T,l,8,[e.el,o,e,i]),Yo())}}const M1=Symbol("_vte"),E1=e=>e.__isTeleport,ed=e=>e&&(e.disabled||e.disabled===""),Y0=e=>e&&(e.defer||e.defer===""),J0=e=>typeof SVGElement<"u"&&e instanceof SVGElement,Q0=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,k_=(e,i)=>{const l=e&&e.to;return Oi(l)?i?i(l):null:l},A1={name:"Teleport",__isTeleport:!0,process(e,i,l,h,p,_,m,o,T,k){const{mc:M,pc:D,pbc:O,o:{insert:z,querySelector:F,createText:N,createComment:q}}=k,oe=ed(i.props);let{shapeFlag:_e,children:Se,dynamicChildren:pe}=i;if(e==null){const be=i.el=N(""),de=i.anchor=N("");z(be,l,h),z(de,l,h);const Ce=(Me,ke)=>{_e&16&&(p&&p.isCE&&(p.ce._teleportTarget=Me),M(Se,Me,ke,p,_,m,o,T))},ye=()=>{const Me=i.target=k_(i.props,F),ke=R1(Me,i,N,z);Me&&(m!=="svg"&&J0(Me)?m="svg":m!=="mathml"&&Q0(Me)&&(m="mathml"),oe||(Ce(Me,ke),bp(i,!1)))};oe&&(Ce(l,de),bp(i,!0)),Y0(i.props)?qr(()=>{ye(),i.el.__isMounted=!0},_):ye()}else{if(Y0(i.props)&&!e.el.__isMounted){qr(()=>{A1.process(e,i,l,h,p,_,m,o,T,k),delete e.el.__isMounted},_);return}i.el=e.el,i.targetStart=e.targetStart;const be=i.anchor=e.anchor,de=i.target=e.target,Ce=i.targetAnchor=e.targetAnchor,ye=ed(e.props),Me=ye?l:de,ke=ye?be:Ce;if(m==="svg"||J0(de)?m="svg":(m==="mathml"||Q0(de))&&(m="mathml"),pe?(O(e.dynamicChildren,pe,Me,p,_,m,o),Sy(e,i,!0)):T||D(e,i,Me,ke,p,_,m,o,!1),oe)ye?i.props&&e.props&&i.props.to!==e.props.to&&(i.props.to=e.props.to):up(i,l,be,k,1);else if((i.props&&i.props.to)!==(e.props&&e.props.to)){const Ee=i.target=k_(i.props,F);Ee&&up(i,Ee,null,k,0)}else ye&&up(i,de,Ce,k,1);bp(i,oe)}},remove(e,i,l,{um:h,o:{remove:p}},_){const{shapeFlag:m,children:o,anchor:T,targetStart:k,targetAnchor:M,target:D,props:O}=e;if(D&&(p(k),p(M)),_&&p(T),m&16){const z=_||!ed(O);for(let F=0;F<o.length;F++){const N=o[F];h(N,i,l,z,!!N.dynamicChildren)}}},move:up,hydrate:wP};function up(e,i,l,{o:{insert:h},m:p},_=2){_===0&&h(e.targetAnchor,i,l);const{el:m,anchor:o,shapeFlag:T,children:k,props:M}=e,D=_===2;if(D&&h(m,i,l),(!D||ed(M))&&T&16)for(let O=0;O<k.length;O++)p(k[O],i,l,2);D&&h(o,i,l)}function wP(e,i,l,h,p,_,{o:{nextSibling:m,parentNode:o,querySelector:T,insert:k,createText:M}},D){const O=i.target=k_(i.props,T);if(O){const z=ed(i.props),F=O._lpa||O.firstChild;if(i.shapeFlag&16)if(z)i.anchor=D(m(e),i,o(e),l,h,p,_),i.targetStart=F,i.targetAnchor=F&&m(F);else{i.anchor=m(e);let N=F;for(;N;){if(N&&N.nodeType===8){if(N.data==="teleport start anchor")i.targetStart=N;else if(N.data==="teleport anchor"){i.targetAnchor=N,O._lpa=i.targetAnchor&&m(i.targetAnchor);break}}N=m(N)}i.targetAnchor||R1(O,i,M,k),D(F&&m(F),i,O,l,h,p,_)}bp(i,z)}return i.anchor&&m(i.anchor)}const SP=A1;function bp(e,i){const l=e.ctx;if(l&&l.ut){let h,p;for(i?(h=e.el,p=e.anchor):(h=e.targetStart,p=e.targetAnchor);h&&h!==p;)h.nodeType===1&&h.setAttribute("data-v-owner",l.uid),h=h.nextSibling;l.ut()}}function R1(e,i,l,h){const p=i.targetStart=l(""),_=i.targetAnchor=l("");return p[M1]=_,e&&(h(p,e),h(_,e)),_}const jo=Symbol("_leaveCb"),hp=Symbol("_enterCb");function D1(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return yi(()=>{e.isMounted=!0}),kr(()=>{e.isUnmounting=!0}),e}const Aa=[Function,Array],z1={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Aa,onEnter:Aa,onAfterEnter:Aa,onEnterCancelled:Aa,onBeforeLeave:Aa,onLeave:Aa,onAfterLeave:Aa,onLeaveCancelled:Aa,onBeforeAppear:Aa,onAppear:Aa,onAfterAppear:Aa,onAppearCancelled:Aa},L1=e=>{const i=e.subTree;return i.component?L1(i.component):i},CP={name:"BaseTransition",props:z1,setup(e,{slots:i}){const l=mm(),h=D1();return()=>{const p=i.default&&yy(i.default(),!0);if(!p||!p.length)return;const _=B1(p),m=fn(e),{mode:o}=m;if(h.isLeaving)return Yg(_);const T=eb(_);if(!T)return Yg(_);let k=cd(T,m,h,l,D=>k=D);T.type!==Kr&&Xl(T,k);let M=l.subTree&&eb(l.subTree);if(M&&M.type!==Kr&&!$l(T,M)&&L1(l).type!==Kr){let D=cd(M,m,h,l);if(Xl(M,D),o==="out-in"&&T.type!==Kr)return h.isLeaving=!0,D.afterLeave=()=>{h.isLeaving=!1,l.job.flags&8||l.update(),delete D.afterLeave,M=void 0},Yg(_);o==="in-out"&&T.type!==Kr?D.delayLeave=(O,z,F)=>{const N=F1(h,M);N[String(M.key)]=M,O[jo]=()=>{z(),O[jo]=void 0,delete k.delayedLeave,M=void 0},k.delayedLeave=()=>{F(),delete k.delayedLeave,M=void 0}}:M=void 0}else M&&(M=void 0);return _}}};function B1(e){let i=e[0];if(e.length>1){for(const l of e)if(l.type!==Kr){i=l;break}}return i}const TP=CP;function F1(e,i){const{leavingVNodes:l}=e;let h=l.get(i.type);return h||(h=Object.create(null),l.set(i.type,h)),h}function cd(e,i,l,h,p){const{appear:_,mode:m,persisted:o=!1,onBeforeEnter:T,onEnter:k,onAfterEnter:M,onEnterCancelled:D,onBeforeLeave:O,onLeave:z,onAfterLeave:F,onLeaveCancelled:N,onBeforeAppear:q,onAppear:oe,onAfterAppear:_e,onAppearCancelled:Se}=i,pe=String(e.key),be=F1(l,e),de=(Me,ke)=>{Me&&rs(Me,h,9,ke)},Ce=(Me,ke)=>{const Ee=ke[1];de(Me,ke),gn(Me)?Me.every(xe=>xe.length<=1)&&Ee():Me.length<=1&&Ee()},ye={mode:m,persisted:o,beforeEnter(Me){let ke=T;if(!l.isMounted)if(_)ke=q||T;else return;Me[jo]&&Me[jo](!0);const Ee=be[pe];Ee&&$l(e,Ee)&&Ee.el[jo]&&Ee.el[jo](),de(ke,[Me])},enter(Me){let ke=k,Ee=M,xe=D;if(!l.isMounted)if(_)ke=oe||k,Ee=_e||M,xe=Se||D;else return;let Fe=!1;const We=Me[hp]=ht=>{Fe||(Fe=!0,ht?de(xe,[Me]):de(Ee,[Me]),ye.delayedLeave&&ye.delayedLeave(),Me[hp]=void 0)};ke?Ce(ke,[Me,We]):We()},leave(Me,ke){const Ee=String(e.key);if(Me[hp]&&Me[hp](!0),l.isUnmounting)return ke();de(O,[Me]);let xe=!1;const Fe=Me[jo]=We=>{xe||(xe=!0,ke(),We?de(N,[Me]):de(F,[Me]),Me[jo]=void 0,be[Ee]===e&&delete be[Ee])};be[Ee]=e,z?Ce(z,[Me,Fe]):Fe()},clone(Me){const ke=cd(Me,i,l,h,p);return p&&p(ke),ke}};return ye}function Yg(e){if(dm(e))return e=no(e),e.children=null,e}function eb(e){if(!dm(e))return E1(e.type)&&e.children?B1(e.children):e;const{shapeFlag:i,children:l}=e;if(l){if(i&16)return l[0];if(i&32&&wn(l.default))return l.default()}}function Xl(e,i){e.shapeFlag&6&&e.component?(e.transition=i,Xl(e.component.subTree,i)):e.shapeFlag&128?(e.ssContent.transition=i.clone(e.ssContent),e.ssFallback.transition=i.clone(e.ssFallback)):e.transition=i}function yy(e,i=!1,l){let h=[],p=0;for(let _=0;_<e.length;_++){let m=e[_];const o=l==null?m.key:String(l)+String(m.key!=null?m.key:_);m.type===cn?(m.patchFlag&128&&p++,h=h.concat(yy(m.children,i,o))):(i||m.type!==Kr)&&h.push(o!=null?no(m,{key:o}):m)}if(p>1)for(let _=0;_<h.length;_++)h[_].patchFlag=-2;return h}/*! #__NO_SIDE_EFFECTS__ */function Un(e,i){return wn(e)?(()=>Qi({name:e.name},i,{setup:e}))():e}function O1(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function Fp(e,i,l,h,p=!1){if(gn(e)){e.forEach((F,N)=>Fp(F,i&&(gn(i)?i[N]:i),l,h,p));return}if(td(h)&&!p){h.shapeFlag&512&&h.type.__asyncResolved&&h.component.subTree.component&&Fp(e,i,l,h.component.subTree);return}const _=h.shapeFlag&4?gm(h.component):h.el,m=p?null:_,{i:o,r:T}=e,k=i&&i.r,M=o.refs===_i?o.refs={}:o.refs,D=o.setupState,O=fn(D),z=D===_i?()=>!1:F=>ei(O,F);if(k!=null&&k!==T&&(Oi(k)?(M[k]=null,z(k)&&(D[k]=null)):ci(k)&&(k.value=null)),wn(T))Td(T,o,12,[m,M]);else{const F=Oi(T),N=ci(T);if(F||N){const q=()=>{if(e.f){const oe=F?z(T)?D[T]:M[T]:T.value;p?gn(oe)&&oy(oe,_):gn(oe)?oe.includes(_)||oe.push(_):F?(M[T]=[_],z(T)&&(D[T]=M[T])):(T.value=[_],e.k&&(M[e.k]=T.value))}else F?(M[T]=m,z(T)&&(D[T]=m)):N&&(T.value=m,e.k&&(M[e.k]=m))};m?(q.id=-1,qr(q,l)):q()}}}sm().requestIdleCallback;sm().cancelIdleCallback;const td=e=>!!e.type.__asyncLoader,dm=e=>e.type.__isKeepAlive;function V1(e,i){N1(e,"a",i)}function vy(e,i){N1(e,"da",i)}function N1(e,i,l=vr){const h=e.__wdc||(e.__wdc=()=>{let p=l;for(;p;){if(p.isDeactivated)return;p=p.parent}return e()});if(fm(i,h,l),l){let p=l.parent;for(;p&&p.parent;)dm(p.parent.vnode)&&PP(h,i,l,p),p=p.parent}}function PP(e,i,l,h){const p=fm(i,e,h,!0);kd(()=>{oy(h[i],p)},l)}function fm(e,i,l=vr,h=!1){if(l){const p=l[e]||(l[e]=[]),_=i.__weh||(i.__weh=(...m)=>{Ko();const o=Md(l),T=rs(i,l,e,m);return o(),Yo(),T});return h?p.unshift(_):p.push(_),_}}const ro=e=>(i,l=vr)=>{(!dd||e==="sp")&&fm(e,(...h)=>i(...h),l)},Pd=ro("bm"),yi=ro("m"),$1=ro("bu"),by=ro("u"),kr=ro("bum"),kd=ro("um"),kP=ro("sp"),IP=ro("rtg"),MP=ro("rtc");function EP(e,i=vr){fm("ec",e,i)}const j1="components",AP="directives",U1=Symbol.for("v-ndc");function RP(e){return Oi(e)?G1(j1,e,!1)||e:e||U1}function ao(e){return G1(AP,e)}function G1(e,i,l=!0,h=!1){const p=Yr||vr;if(p){const _=p.type;if(e===j1){const o=yk(_,!1);if(o&&(o===i||o===aa(i)||o===io(aa(i))))return _}const m=tb(p[e]||_[e],i)||tb(p.appContext[e],i);return!m&&h?_:m}}function tb(e,i){return e&&(e[i]||e[aa(i)]||e[io(aa(i))])}function sa(e,i,l,h){let p;const _=l&&l[h],m=gn(e);if(m||Oi(e)){const o=m&&Zo(e);let T=!1;o&&(T=!za(e),e=lm(e)),p=new Array(e.length);for(let k=0,M=e.length;k<M;k++)p[k]=i(T?Lr(e[k]):e[k],k,void 0,_&&_[k])}else if(typeof e=="number"){p=new Array(e);for(let o=0;o<e;o++)p[o]=i(o+1,o,void 0,_&&_[o])}else if(Ci(e))if(e[Symbol.iterator])p=Array.from(e,(o,T)=>i(o,T,void 0,_&&_[T]));else{const o=Object.keys(e);p=new Array(o.length);for(let T=0,k=o.length;T<k;T++){const M=o[T];p[T]=i(e[M],M,T,_&&_[T])}}else p=[];return l&&(l[h]=p),p}const I_=e=>e?lw(e)?gm(e):I_(e.parent):null,nd=Qi(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>I_(e.parent),$root:e=>I_(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>xy(e),$forceUpdate:e=>e.f||(e.f=()=>{_y(e.update)}),$nextTick:e=>e.n||(e.n=Fi.bind(e.proxy)),$watch:e=>ek.bind(e)}),Jg=(e,i)=>e!==_i&&!e.__isScriptSetup&&ei(e,i),DP={get({_:e},i){if(i==="__v_skip")return!0;const{ctx:l,setupState:h,data:p,props:_,accessCache:m,type:o,appContext:T}=e;let k;if(i[0]!=="$"){const z=m[i];if(z!==void 0)switch(z){case 1:return h[i];case 2:return p[i];case 4:return l[i];case 3:return _[i]}else{if(Jg(h,i))return m[i]=1,h[i];if(p!==_i&&ei(p,i))return m[i]=2,p[i];if((k=e.propsOptions[0])&&ei(k,i))return m[i]=3,_[i];if(l!==_i&&ei(l,i))return m[i]=4,l[i];M_&&(m[i]=0)}}const M=nd[i];let D,O;if(M)return i==="$attrs"&&zr(e.attrs,"get",""),M(e);if((D=o.__cssModules)&&(D=D[i]))return D;if(l!==_i&&ei(l,i))return m[i]=4,l[i];if(O=T.config.globalProperties,ei(O,i))return O[i]},set({_:e},i,l){const{data:h,setupState:p,ctx:_}=e;return Jg(p,i)?(p[i]=l,!0):h!==_i&&ei(h,i)?(h[i]=l,!0):ei(e.props,i)||i[0]==="$"&&i.slice(1)in e?!1:(_[i]=l,!0)},has({_:{data:e,setupState:i,accessCache:l,ctx:h,appContext:p,propsOptions:_}},m){let o;return!!l[m]||e!==_i&&ei(e,m)||Jg(i,m)||(o=_[0])&&ei(o,m)||ei(h,m)||ei(nd,m)||ei(p.config.globalProperties,m)},defineProperty(e,i,l){return l.get!=null?e._.accessCache[i]=0:ei(l,"value")&&this.set(e,i,l.value,null),Reflect.defineProperty(e,i,l)}};function nb(e){return gn(e)?e.reduce((i,l)=>(i[l]=null,i),{}):e}let M_=!0;function zP(e){const i=xy(e),l=e.proxy,h=e.ctx;M_=!1,i.beforeCreate&&ib(i.beforeCreate,e,"bc");const{data:p,computed:_,methods:m,watch:o,provide:T,inject:k,created:M,beforeMount:D,mounted:O,beforeUpdate:z,updated:F,activated:N,deactivated:q,beforeDestroy:oe,beforeUnmount:_e,destroyed:Se,unmounted:pe,render:be,renderTracked:de,renderTriggered:Ce,errorCaptured:ye,serverPrefetch:Me,expose:ke,inheritAttrs:Ee,components:xe,directives:Fe,filters:We}=i;if(k&&LP(k,h,null),m)for(const tt in m){const Mt=m[tt];wn(Mt)&&(h[tt]=Mt.bind(l))}if(p){const tt=p.call(l,l);Ci(tt)&&(e.data=yr(tt))}if(M_=!0,_)for(const tt in _){const Mt=_[tt],_t=wn(Mt)?Mt.bind(l,l):wn(Mt.get)?Mt.get.bind(l,l):Da,Qe=!wn(Mt)&&wn(Mt.set)?Mt.set.bind(l):Da,ct=ue({get:_t,set:Qe});Object.defineProperty(h,tt,{enumerable:!0,configurable:!0,get:()=>ct.value,set:Dt=>ct.value=Dt})}if(o)for(const tt in o)H1(o[tt],h,l,tt);if(T){const tt=wn(T)?T.call(l):T;Reflect.ownKeys(tt).forEach(Mt=>{Ir(Mt,tt[Mt])})}M&&ib(M,e,"c");function Ne(tt,Mt){gn(Mt)?Mt.forEach(_t=>tt(_t.bind(l))):Mt&&tt(Mt.bind(l))}if(Ne(Pd,D),Ne(yi,O),Ne($1,z),Ne(by,F),Ne(V1,N),Ne(vy,q),Ne(EP,ye),Ne(MP,de),Ne(IP,Ce),Ne(kr,_e),Ne(kd,pe),Ne(kP,Me),gn(ke))if(ke.length){const tt=e.exposed||(e.exposed={});ke.forEach(Mt=>{Object.defineProperty(tt,Mt,{get:()=>l[Mt],set:_t=>l[Mt]=_t})})}else e.exposed||(e.exposed={});be&&e.render===Da&&(e.render=be),Ee!=null&&(e.inheritAttrs=Ee),xe&&(e.components=xe),Fe&&(e.directives=Fe),Me&&O1(e)}function LP(e,i,l=Da){gn(e)&&(e=E_(e));for(const h in e){const p=e[h];let _;Ci(p)?"default"in p?_=ni(p.from||h,p.default,!0):_=ni(p.from||h):_=ni(p),ci(_)?Object.defineProperty(i,h,{enumerable:!0,configurable:!0,get:()=>_.value,set:m=>_.value=m}):i[h]=_}}function ib(e,i,l){rs(gn(e)?e.map(h=>h.bind(i.proxy)):e.bind(i.proxy),i,l)}function H1(e,i,l,h){let p=h.includes(".")?iw(l,h):()=>l[h];if(Oi(e)){const _=i[e];wn(_)&&Qt(p,_)}else if(wn(e))Qt(p,e.bind(l));else if(Ci(e))if(gn(e))e.forEach(_=>H1(_,i,l,h));else{const _=wn(e.handler)?e.handler.bind(l):i[e.handler];wn(_)&&Qt(p,_,e)}}function xy(e){const i=e.type,{mixins:l,extends:h}=i,{mixins:p,optionsCache:_,config:{optionMergeStrategies:m}}=e.appContext,o=_.get(i);let T;return o?T=o:!p.length&&!l&&!h?T=i:(T={},p.length&&p.forEach(k=>Op(T,k,m,!0)),Op(T,i,m)),Ci(i)&&_.set(i,T),T}function Op(e,i,l,h=!1){const{mixins:p,extends:_}=i;_&&Op(e,_,l,!0),p&&p.forEach(m=>Op(e,m,l,!0));for(const m in i)if(!(h&&m==="expose")){const o=BP[m]||l&&l[m];e[m]=o?o(e[m],i[m]):i[m]}return e}const BP={data:rb,props:ab,emits:ab,methods:Kh,computed:Kh,beforeCreate:Zr,created:Zr,beforeMount:Zr,mounted:Zr,beforeUpdate:Zr,updated:Zr,beforeDestroy:Zr,beforeUnmount:Zr,destroyed:Zr,unmounted:Zr,activated:Zr,deactivated:Zr,errorCaptured:Zr,serverPrefetch:Zr,components:Kh,directives:Kh,watch:OP,provide:rb,inject:FP};function rb(e,i){return i?e?function(){return Qi(wn(e)?e.call(this,this):e,wn(i)?i.call(this,this):i)}:i:e}function FP(e,i){return Kh(E_(e),E_(i))}function E_(e){if(gn(e)){const i={};for(let l=0;l<e.length;l++)i[e[l]]=e[l];return i}return e}function Zr(e,i){return e?[...new Set([].concat(e,i))]:i}function Kh(e,i){return e?Qi(Object.create(null),e,i):i}function ab(e,i){return e?gn(e)&&gn(i)?[...new Set([...e,...i])]:Qi(Object.create(null),nb(e),nb(i??{})):i}function OP(e,i){if(!e)return i;if(!i)return e;const l=Qi(Object.create(null),e);for(const h in i)l[h]=Zr(e[h],i[h]);return l}function Z1(){return{app:null,config:{isNativeTag:zT,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let VP=0;function NP(e,i){return function(h,p=null){wn(h)||(h=Qi({},h)),p!=null&&!Ci(p)&&(p=null);const _=Z1(),m=new WeakSet,o=[];let T=!1;const k=_.app={_uid:VP++,_component:h,_props:p,_container:null,_context:_,_instance:null,version:bk,get config(){return _.config},set config(M){},use(M,...D){return m.has(M)||(M&&wn(M.install)?(m.add(M),M.install(k,...D)):wn(M)&&(m.add(M),M(k,...D))),k},mixin(M){return _.mixins.includes(M)||_.mixins.push(M),k},component(M,D){return D?(_.components[M]=D,k):_.components[M]},directive(M,D){return D?(_.directives[M]=D,k):_.directives[M]},mount(M,D,O){if(!T){const z=k._ceVNode||A(h,p);return z.appContext=_,O===!0?O="svg":O===!1&&(O=void 0),D&&i?i(z,M):e(z,M,O),T=!0,k._container=M,M.__vue_app__=k,gm(z.component)}},onUnmount(M){o.push(M)},unmount(){T&&(rs(o,k._instance,16),e(null,k._container),delete k._container.__vue_app__)},provide(M,D){return _.provides[M]=D,k},runWithContext(M){const D=Hl;Hl=k;try{return M()}finally{Hl=D}}};return k}}let Hl=null;function Ir(e,i){if(vr){let l=vr.provides;const h=vr.parent&&vr.parent.provides;h===l&&(l=vr.provides=Object.create(h)),l[e]=i}}function ni(e,i,l=!1){const h=vr||Yr;if(h||Hl){const p=Hl?Hl._context.provides:h?h.parent==null?h.vnode.appContext&&h.vnode.appContext.provides:h.parent.provides:void 0;if(p&&e in p)return p[e];if(arguments.length>1)return l&&wn(i)?i.call(h&&h.proxy):i}}function $P(){return!!(vr||Yr||Hl)}const q1={},W1=()=>Object.create(q1),X1=e=>Object.getPrototypeOf(e)===q1;function jP(e,i,l,h=!1){const p={},_=W1();e.propsDefaults=Object.create(null),K1(e,i,p,_);for(const m in e.propsOptions[0])m in p||(p[m]=void 0);l?e.props=h?p:hP(p):e.type.props?e.props=p:e.props=_,e.attrs=_}function UP(e,i,l,h){const{props:p,attrs:_,vnode:{patchFlag:m}}=e,o=fn(p),[T]=e.propsOptions;let k=!1;if((h||m>0)&&!(m&16)){if(m&8){const M=e.vnode.dynamicProps;for(let D=0;D<M.length;D++){let O=M[D];if(pm(e.emitsOptions,O))continue;const z=i[O];if(T)if(ei(_,O))z!==_[O]&&(_[O]=z,k=!0);else{const F=aa(O);p[F]=A_(T,o,F,z,e,!1)}else z!==_[O]&&(_[O]=z,k=!0)}}}else{K1(e,i,p,_)&&(k=!0);let M;for(const D in o)(!i||!ei(i,D)&&((M=Jl(D))===D||!ei(i,M)))&&(T?l&&(l[D]!==void 0||l[M]!==void 0)&&(p[D]=A_(T,o,D,void 0,e,!0)):delete p[D]);if(_!==o)for(const D in _)(!i||!ei(i,D))&&(delete _[D],k=!0)}k&&Ys(e.attrs,"set","")}function K1(e,i,l,h){const[p,_]=e.propsOptions;let m=!1,o;if(i)for(let T in i){if(Yh(T))continue;const k=i[T];let M;p&&ei(p,M=aa(T))?!_||!_.includes(M)?l[M]=k:(o||(o={}))[M]=k:pm(e.emitsOptions,T)||(!(T in h)||k!==h[T])&&(h[T]=k,m=!0)}if(_){const T=fn(l),k=o||_i;for(let M=0;M<_.length;M++){const D=_[M];l[D]=A_(p,T,D,k[D],e,!ei(k,D))}}return m}function A_(e,i,l,h,p,_){const m=e[l];if(m!=null){const o=ei(m,"default");if(o&&h===void 0){const T=m.default;if(m.type!==Function&&!m.skipFactory&&wn(T)){const{propsDefaults:k}=p;if(l in k)h=k[l];else{const M=Md(p);h=k[l]=T.call(null,i),M()}}else h=T;p.ce&&p.ce._setProp(l,h)}m[0]&&(_&&!o?h=!1:m[1]&&(h===""||h===Jl(l))&&(h=!0))}return h}const GP=new WeakMap;function Y1(e,i,l=!1){const h=l?GP:i.propsCache,p=h.get(e);if(p)return p;const _=e.props,m={},o=[];let T=!1;if(!wn(e)){const M=D=>{T=!0;const[O,z]=Y1(D,i,!0);Qi(m,O),z&&o.push(...z)};!l&&i.mixins.length&&i.mixins.forEach(M),e.extends&&M(e.extends),e.mixins&&e.mixins.forEach(M)}if(!_&&!T)return Ci(e)&&h.set(e,cu),cu;if(gn(_))for(let M=0;M<_.length;M++){const D=aa(_[M]);sb(D)&&(m[D]=_i)}else if(_)for(const M in _){const D=aa(M);if(sb(D)){const O=_[M],z=m[D]=gn(O)||wn(O)?{type:O}:Qi({},O),F=z.type;let N=!1,q=!0;if(gn(F))for(let oe=0;oe<F.length;++oe){const _e=F[oe],Se=wn(_e)&&_e.name;if(Se==="Boolean"){N=!0;break}else Se==="String"&&(q=!1)}else N=wn(F)&&F.name==="Boolean";z[0]=N,z[1]=q,(N||ei(z,"default"))&&o.push(D)}}const k=[m,o];return Ci(e)&&h.set(e,k),k}function sb(e){return e[0]!=="$"&&!Yh(e)}const J1=e=>e[0]==="_"||e==="$stable",wy=e=>gn(e)?e.map(bs):[bs(e)],HP=(e,i,l)=>{if(i._n)return i;const h=Q((...p)=>wy(i(...p)),l);return h._c=!1,h},Q1=(e,i,l)=>{const h=e._ctx;for(const p in e){if(J1(p))continue;const _=e[p];if(wn(_))i[p]=HP(p,_,h);else if(_!=null){const m=wy(_);i[p]=()=>m}}},ew=(e,i)=>{const l=wy(i);e.slots.default=()=>l},tw=(e,i,l)=>{for(const h in i)(l||h!=="_")&&(e[h]=i[h])},ZP=(e,i,l)=>{const h=e.slots=W1();if(e.vnode.shapeFlag&32){const p=i._;p?(tw(h,i,l),l&&e1(h,"_",p,!0)):Q1(i,h)}else i&&ew(e,i)},qP=(e,i,l)=>{const{vnode:h,slots:p}=e;let _=!0,m=_i;if(h.shapeFlag&32){const o=i._;o?l&&o===1?_=!1:tw(p,i,l):(_=!i.$stable,Q1(i,p)),m=i}else i&&(ew(e,i),m={default:1});if(_)for(const o in p)!J1(o)&&m[o]==null&&delete p[o]},qr=ok;function WP(e){return XP(e)}function XP(e,i){const l=sm();l.__VUE__=!0;const{insert:h,remove:p,patchProp:_,createElement:m,createText:o,createComment:T,setText:k,setElementText:M,parentNode:D,nextSibling:O,setScopeId:z=Da,insertStaticContent:F}=e,N=(Pe,Le,ot,xt=null,mt=null,vt=null,Lt=void 0,It=null,At=!!Le.dynamicChildren)=>{if(Pe===Le)return;Pe&&!$l(Pe,Le)&&(xt=_n(Pe),Dt(Pe,mt,vt,!0),Pe=null),Le.patchFlag===-2&&(At=!1,Le.dynamicChildren=null);const{type:wt,ref:en,shapeFlag:Nt}=Le;switch(wt){case Id:q(Pe,Le,ot,xt);break;case Kr:oe(Pe,Le,ot,xt);break;case xp:Pe==null&&_e(Le,ot,xt,Lt);break;case cn:xe(Pe,Le,ot,xt,mt,vt,Lt,It,At);break;default:Nt&1?be(Pe,Le,ot,xt,mt,vt,Lt,It,At):Nt&6?Fe(Pe,Le,ot,xt,mt,vt,Lt,It,At):(Nt&64||Nt&128)&&wt.process(Pe,Le,ot,xt,mt,vt,Lt,It,At,On)}en!=null&&mt&&Fp(en,Pe&&Pe.ref,vt,Le||Pe,!Le)},q=(Pe,Le,ot,xt)=>{if(Pe==null)h(Le.el=o(Le.children),ot,xt);else{const mt=Le.el=Pe.el;Le.children!==Pe.children&&k(mt,Le.children)}},oe=(Pe,Le,ot,xt)=>{Pe==null?h(Le.el=T(Le.children||""),ot,xt):Le.el=Pe.el},_e=(Pe,Le,ot,xt)=>{[Pe.el,Pe.anchor]=F(Pe.children,Le,ot,xt,Pe.el,Pe.anchor)},Se=({el:Pe,anchor:Le},ot,xt)=>{let mt;for(;Pe&&Pe!==Le;)mt=O(Pe),h(Pe,ot,xt),Pe=mt;h(Le,ot,xt)},pe=({el:Pe,anchor:Le})=>{let ot;for(;Pe&&Pe!==Le;)ot=O(Pe),p(Pe),Pe=ot;p(Le)},be=(Pe,Le,ot,xt,mt,vt,Lt,It,At)=>{Le.type==="svg"?Lt="svg":Le.type==="math"&&(Lt="mathml"),Pe==null?de(Le,ot,xt,mt,vt,Lt,It,At):Me(Pe,Le,mt,vt,Lt,It,At)},de=(Pe,Le,ot,xt,mt,vt,Lt,It)=>{let At,wt;const{props:en,shapeFlag:Nt,transition:Wt,dirs:un}=Pe;if(At=Pe.el=m(Pe.type,vt,en&&en.is,en),Nt&8?M(At,Pe.children):Nt&16&&ye(Pe.children,At,null,xt,mt,Qg(Pe,vt),Lt,It),un&&Ll(Pe,null,xt,"created"),Ce(At,Pe,Pe.scopeId,Lt,xt),en){for(const Dn in en)Dn!=="value"&&!Yh(Dn)&&_(At,Dn,null,en[Dn],vt,xt);"value"in en&&_(At,"value",null,en.value,vt),(wt=en.onVnodeBeforeMount)&&gs(wt,xt,Pe)}un&&Ll(Pe,null,xt,"beforeMount");const Sn=KP(mt,Wt);Sn&&Wt.beforeEnter(At),h(At,Le,ot),((wt=en&&en.onVnodeMounted)||Sn||un)&&qr(()=>{wt&&gs(wt,xt,Pe),Sn&&Wt.enter(At),un&&Ll(Pe,null,xt,"mounted")},mt)},Ce=(Pe,Le,ot,xt,mt)=>{if(ot&&z(Pe,ot),xt)for(let vt=0;vt<xt.length;vt++)z(Pe,xt[vt]);if(mt){let vt=mt.subTree;if(Le===vt||aw(vt.type)&&(vt.ssContent===Le||vt.ssFallback===Le)){const Lt=mt.vnode;Ce(Pe,Lt,Lt.scopeId,Lt.slotScopeIds,mt.parent)}}},ye=(Pe,Le,ot,xt,mt,vt,Lt,It,At=0)=>{for(let wt=At;wt<Pe.length;wt++){const en=Pe[wt]=It?Uo(Pe[wt]):bs(Pe[wt]);N(null,en,Le,ot,xt,mt,vt,Lt,It)}},Me=(Pe,Le,ot,xt,mt,vt,Lt)=>{const It=Le.el=Pe.el;let{patchFlag:At,dynamicChildren:wt,dirs:en}=Le;At|=Pe.patchFlag&16;const Nt=Pe.props||_i,Wt=Le.props||_i;let un;if(ot&&Bl(ot,!1),(un=Wt.onVnodeBeforeUpdate)&&gs(un,ot,Le,Pe),en&&Ll(Le,Pe,ot,"beforeUpdate"),ot&&Bl(ot,!0),(Nt.innerHTML&&Wt.innerHTML==null||Nt.textContent&&Wt.textContent==null)&&M(It,""),wt?ke(Pe.dynamicChildren,wt,It,ot,xt,Qg(Le,mt),vt):Lt||Mt(Pe,Le,It,null,ot,xt,Qg(Le,mt),vt,!1),At>0){if(At&16)Ee(It,Nt,Wt,ot,mt);else if(At&2&&Nt.class!==Wt.class&&_(It,"class",null,Wt.class,mt),At&4&&_(It,"style",Nt.style,Wt.style,mt),At&8){const Sn=Le.dynamicProps;for(let Dn=0;Dn<Sn.length;Dn++){const An=Sn[Dn],Ei=Nt[An],Pi=Wt[An];(Pi!==Ei||An==="value")&&_(It,An,Ei,Pi,mt,ot)}}At&1&&Pe.children!==Le.children&&M(It,Le.children)}else!Lt&&wt==null&&Ee(It,Nt,Wt,ot,mt);((un=Wt.onVnodeUpdated)||en)&&qr(()=>{un&&gs(un,ot,Le,Pe),en&&Ll(Le,Pe,ot,"updated")},xt)},ke=(Pe,Le,ot,xt,mt,vt,Lt)=>{for(let It=0;It<Le.length;It++){const At=Pe[It],wt=Le[It],en=At.el&&(At.type===cn||!$l(At,wt)||At.shapeFlag&70)?D(At.el):ot;N(At,wt,en,null,xt,mt,vt,Lt,!0)}},Ee=(Pe,Le,ot,xt,mt)=>{if(Le!==ot){if(Le!==_i)for(const vt in Le)!Yh(vt)&&!(vt in ot)&&_(Pe,vt,Le[vt],null,mt,xt);for(const vt in ot){if(Yh(vt))continue;const Lt=ot[vt],It=Le[vt];Lt!==It&&vt!=="value"&&_(Pe,vt,It,Lt,mt,xt)}"value"in ot&&_(Pe,"value",Le.value,ot.value,mt)}},xe=(Pe,Le,ot,xt,mt,vt,Lt,It,At)=>{const wt=Le.el=Pe?Pe.el:o(""),en=Le.anchor=Pe?Pe.anchor:o("");let{patchFlag:Nt,dynamicChildren:Wt,slotScopeIds:un}=Le;un&&(It=It?It.concat(un):un),Pe==null?(h(wt,ot,xt),h(en,ot,xt),ye(Le.children||[],ot,en,mt,vt,Lt,It,At)):Nt>0&&Nt&64&&Wt&&Pe.dynamicChildren?(ke(Pe.dynamicChildren,Wt,ot,mt,vt,Lt,It),(Le.key!=null||mt&&Le===mt.subTree)&&Sy(Pe,Le,!0)):Mt(Pe,Le,ot,en,mt,vt,Lt,It,At)},Fe=(Pe,Le,ot,xt,mt,vt,Lt,It,At)=>{Le.slotScopeIds=It,Pe==null?Le.shapeFlag&512?mt.ctx.activate(Le,ot,xt,Lt,At):We(Le,ot,xt,mt,vt,Lt,At):ht(Pe,Le,At)},We=(Pe,Le,ot,xt,mt,vt,Lt)=>{const It=Pe.component=fk(Pe,xt,mt);if(dm(Pe)&&(It.ctx.renderer=On),pk(It,!1,Lt),It.asyncDep){if(mt&&mt.registerDep(It,Ne,Lt),!Pe.el){const At=It.subTree=A(Kr);oe(null,At,Le,ot)}}else Ne(It,Pe,Le,ot,mt,vt,Lt)},ht=(Pe,Le,ot)=>{const xt=Le.component=Pe.component;if(ak(Pe,Le,ot))if(xt.asyncDep&&!xt.asyncResolved){tt(xt,Le,ot);return}else xt.next=Le,xt.update();else Le.el=Pe.el,xt.vnode=Le},Ne=(Pe,Le,ot,xt,mt,vt,Lt)=>{const It=()=>{if(Pe.isMounted){let{next:Nt,bu:Wt,u:un,parent:Sn,vnode:Dn}=Pe;{const Zi=nw(Pe);if(Zi){Nt&&(Nt.el=Dn.el,tt(Pe,Nt,Lt)),Zi.asyncDep.then(()=>{Pe.isUnmounted||It()});return}}let An=Nt,Ei;Bl(Pe,!1),Nt?(Nt.el=Dn.el,tt(Pe,Nt,Lt)):Nt=Dn,Wt&&vp(Wt),(Ei=Nt.props&&Nt.props.onVnodeBeforeUpdate)&&gs(Ei,Sn,Nt,Dn),Bl(Pe,!0);const Pi=e_(Pe),er=Pe.subTree;Pe.subTree=Pi,N(er,Pi,D(er.el),_n(er),Pe,mt,vt),Nt.el=Pi.el,An===null&&sk(Pe,Pi.el),un&&qr(un,mt),(Ei=Nt.props&&Nt.props.onVnodeUpdated)&&qr(()=>gs(Ei,Sn,Nt,Dn),mt)}else{let Nt;const{el:Wt,props:un}=Le,{bm:Sn,m:Dn,parent:An,root:Ei,type:Pi}=Pe,er=td(Le);if(Bl(Pe,!1),Sn&&vp(Sn),!er&&(Nt=un&&un.onVnodeBeforeMount)&&gs(Nt,An,Le),Bl(Pe,!0),Wt&&En){const Zi=()=>{Pe.subTree=e_(Pe),En(Wt,Pe.subTree,Pe,mt,null)};er&&Pi.__asyncHydrate?Pi.__asyncHydrate(Wt,Pe,Zi):Zi()}else{Ei.ce&&Ei.ce._injectChildStyle(Pi);const Zi=Pe.subTree=e_(Pe);N(null,Zi,ot,xt,Pe,mt,vt),Le.el=Zi.el}if(Dn&&qr(Dn,mt),!er&&(Nt=un&&un.onVnodeMounted)){const Zi=Le;qr(()=>gs(Nt,An,Zi),mt)}(Le.shapeFlag&256||An&&td(An.vnode)&&An.vnode.shapeFlag&256)&&Pe.a&&qr(Pe.a,mt),Pe.isMounted=!0,Le=ot=xt=null}};Pe.scope.on();const At=Pe.effect=new s1(It);Pe.scope.off();const wt=Pe.update=At.run.bind(At),en=Pe.job=At.runIfDirty.bind(At);en.i=Pe,en.id=Pe.uid,At.scheduler=()=>_y(en),Bl(Pe,!0),wt()},tt=(Pe,Le,ot)=>{Le.component=Pe;const xt=Pe.vnode.props;Pe.vnode=Le,Pe.next=null,UP(Pe,Le.props,xt,ot),qP(Pe,Le.children,ot),Ko(),K0(Pe),Yo()},Mt=(Pe,Le,ot,xt,mt,vt,Lt,It,At=!1)=>{const wt=Pe&&Pe.children,en=Pe?Pe.shapeFlag:0,Nt=Le.children,{patchFlag:Wt,shapeFlag:un}=Le;if(Wt>0){if(Wt&128){Qe(wt,Nt,ot,xt,mt,vt,Lt,It,At);return}else if(Wt&256){_t(wt,Nt,ot,xt,mt,vt,Lt,It,At);return}}un&8?(en&16&&Zt(wt,mt,vt),Nt!==wt&&M(ot,Nt)):en&16?un&16?Qe(wt,Nt,ot,xt,mt,vt,Lt,It,At):Zt(wt,mt,vt,!0):(en&8&&M(ot,""),un&16&&ye(Nt,ot,xt,mt,vt,Lt,It,At))},_t=(Pe,Le,ot,xt,mt,vt,Lt,It,At)=>{Pe=Pe||cu,Le=Le||cu;const wt=Pe.length,en=Le.length,Nt=Math.min(wt,en);let Wt;for(Wt=0;Wt<Nt;Wt++){const un=Le[Wt]=At?Uo(Le[Wt]):bs(Le[Wt]);N(Pe[Wt],un,ot,null,mt,vt,Lt,It,At)}wt>en?Zt(Pe,mt,vt,!0,!1,Nt):ye(Le,ot,xt,mt,vt,Lt,It,At,Nt)},Qe=(Pe,Le,ot,xt,mt,vt,Lt,It,At)=>{let wt=0;const en=Le.length;let Nt=Pe.length-1,Wt=en-1;for(;wt<=Nt&&wt<=Wt;){const un=Pe[wt],Sn=Le[wt]=At?Uo(Le[wt]):bs(Le[wt]);if($l(un,Sn))N(un,Sn,ot,null,mt,vt,Lt,It,At);else break;wt++}for(;wt<=Nt&&wt<=Wt;){const un=Pe[Nt],Sn=Le[Wt]=At?Uo(Le[Wt]):bs(Le[Wt]);if($l(un,Sn))N(un,Sn,ot,null,mt,vt,Lt,It,At);else break;Nt--,Wt--}if(wt>Nt){if(wt<=Wt){const un=Wt+1,Sn=un<en?Le[un].el:xt;for(;wt<=Wt;)N(null,Le[wt]=At?Uo(Le[wt]):bs(Le[wt]),ot,Sn,mt,vt,Lt,It,At),wt++}}else if(wt>Wt)for(;wt<=Nt;)Dt(Pe[wt],mt,vt,!0),wt++;else{const un=wt,Sn=wt,Dn=new Map;for(wt=Sn;wt<=Wt;wt++){const W=Le[wt]=At?Uo(Le[wt]):bs(Le[wt]);W.key!=null&&Dn.set(W.key,wt)}let An,Ei=0;const Pi=Wt-Sn+1;let er=!1,Zi=0;const Mr=new Array(Pi);for(wt=0;wt<Pi;wt++)Mr[wt]=0;for(wt=un;wt<=Nt;wt++){const W=Pe[wt];if(Ei>=Pi){Dt(W,mt,vt,!0);continue}let J;if(W.key!=null)J=Dn.get(W.key);else for(An=Sn;An<=Wt;An++)if(Mr[An-Sn]===0&&$l(W,Le[An])){J=An;break}J===void 0?Dt(W,mt,vt,!0):(Mr[J-Sn]=wt+1,J>=Zi?Zi=J:er=!0,N(W,Le[J],ot,null,mt,vt,Lt,It,At),Ei++)}const ae=er?YP(Mr):cu;for(An=ae.length-1,wt=Pi-1;wt>=0;wt--){const W=Sn+wt,J=Le[W],te=W+1<en?Le[W+1].el:xt;Mr[wt]===0?N(null,J,ot,te,mt,vt,Lt,It,At):er&&(An<0||wt!==ae[An]?ct(J,ot,te,2):An--)}}},ct=(Pe,Le,ot,xt,mt=null)=>{const{el:vt,type:Lt,transition:It,children:At,shapeFlag:wt}=Pe;if(wt&6){ct(Pe.component.subTree,Le,ot,xt);return}if(wt&128){Pe.suspense.move(Le,ot,xt);return}if(wt&64){Lt.move(Pe,Le,ot,On);return}if(Lt===cn){h(vt,Le,ot);for(let Nt=0;Nt<At.length;Nt++)ct(At[Nt],Le,ot,xt);h(Pe.anchor,Le,ot);return}if(Lt===xp){Se(Pe,Le,ot);return}if(xt!==2&&wt&1&&It)if(xt===0)It.beforeEnter(vt),h(vt,Le,ot),qr(()=>It.enter(vt),mt);else{const{leave:Nt,delayLeave:Wt,afterLeave:un}=It,Sn=()=>h(vt,Le,ot),Dn=()=>{Nt(vt,()=>{Sn(),un&&un()})};Wt?Wt(vt,Sn,Dn):Dn()}else h(vt,Le,ot)},Dt=(Pe,Le,ot,xt=!1,mt=!1)=>{const{type:vt,props:Lt,ref:It,children:At,dynamicChildren:wt,shapeFlag:en,patchFlag:Nt,dirs:Wt,cacheIndex:un}=Pe;if(Nt===-2&&(mt=!1),It!=null&&Fp(It,null,ot,Pe,!0),un!=null&&(Le.renderCache[un]=void 0),en&256){Le.ctx.deactivate(Pe);return}const Sn=en&1&&Wt,Dn=!td(Pe);let An;if(Dn&&(An=Lt&&Lt.onVnodeBeforeUnmount)&&gs(An,Le,Pe),en&6)Kt(Pe.component,ot,xt);else{if(en&128){Pe.suspense.unmount(ot,xt);return}Sn&&Ll(Pe,null,Le,"beforeUnmount"),en&64?Pe.type.remove(Pe,Le,ot,On,xt):wt&&!wt.hasOnce&&(vt!==cn||Nt>0&&Nt&64)?Zt(wt,Le,ot,!1,!0):(vt===cn&&Nt&384||!mt&&en&16)&&Zt(At,Le,ot),xt&&Yt(Pe)}(Dn&&(An=Lt&&Lt.onVnodeUnmounted)||Sn)&&qr(()=>{An&&gs(An,Le,Pe),Sn&&Ll(Pe,null,Le,"unmounted")},ot)},Yt=Pe=>{const{type:Le,el:ot,anchor:xt,transition:mt}=Pe;if(Le===cn){zt(ot,xt);return}if(Le===xp){pe(Pe);return}const vt=()=>{p(ot),mt&&!mt.persisted&&mt.afterLeave&&mt.afterLeave()};if(Pe.shapeFlag&1&&mt&&!mt.persisted){const{leave:Lt,delayLeave:It}=mt,At=()=>Lt(ot,vt);It?It(Pe.el,vt,At):At()}else vt()},zt=(Pe,Le)=>{let ot;for(;Pe!==Le;)ot=O(Pe),p(Pe),Pe=ot;p(Le)},Kt=(Pe,Le,ot)=>{const{bum:xt,scope:mt,job:vt,subTree:Lt,um:It,m:At,a:wt}=Pe;ob(At),ob(wt),xt&&vp(xt),mt.stop(),vt&&(vt.flags|=8,Dt(Lt,Pe,Le,ot)),It&&qr(It,Le),qr(()=>{Pe.isUnmounted=!0},Le),Le&&Le.pendingBranch&&!Le.isUnmounted&&Pe.asyncDep&&!Pe.asyncResolved&&Pe.suspenseId===Le.pendingId&&(Le.deps--,Le.deps===0&&Le.resolve())},Zt=(Pe,Le,ot,xt=!1,mt=!1,vt=0)=>{for(let Lt=vt;Lt<Pe.length;Lt++)Dt(Pe[Lt],Le,ot,xt,mt)},_n=Pe=>{if(Pe.shapeFlag&6)return _n(Pe.component.subTree);if(Pe.shapeFlag&128)return Pe.suspense.next();const Le=O(Pe.anchor||Pe.el),ot=Le&&Le[M1];return ot?O(ot):Le};let bn=!1;const Vn=(Pe,Le,ot)=>{Pe==null?Le._vnode&&Dt(Le._vnode,null,null,!0):N(Le._vnode||null,Pe,Le,null,null,null,ot),Le._vnode=Pe,bn||(bn=!0,K0(),P1(),bn=!1)},On={p:N,um:Dt,m:ct,r:Yt,mt:We,mc:ye,pc:Mt,pbc:ke,n:_n,o:e};let ri,En;return i&&([ri,En]=i(On)),{render:Vn,hydrate:ri,createApp:NP(Vn,ri)}}function Qg({type:e,props:i},l){return l==="svg"&&e==="foreignObject"||l==="mathml"&&e==="annotation-xml"&&i&&i.encoding&&i.encoding.includes("html")?void 0:l}function Bl({effect:e,job:i},l){l?(e.flags|=32,i.flags|=4):(e.flags&=-33,i.flags&=-5)}function KP(e,i){return(!e||e&&!e.pendingBranch)&&i&&!i.persisted}function Sy(e,i,l=!1){const h=e.children,p=i.children;if(gn(h)&&gn(p))for(let _=0;_<h.length;_++){const m=h[_];let o=p[_];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=p[_]=Uo(p[_]),o.el=m.el),!l&&o.patchFlag!==-2&&Sy(m,o)),o.type===Id&&(o.el=m.el)}}function YP(e){const i=e.slice(),l=[0];let h,p,_,m,o;const T=e.length;for(h=0;h<T;h++){const k=e[h];if(k!==0){if(p=l[l.length-1],e[p]<k){i[h]=p,l.push(h);continue}for(_=0,m=l.length-1;_<m;)o=_+m>>1,e[l[o]]<k?_=o+1:m=o;k<e[l[_]]&&(_>0&&(i[h]=l[_-1]),l[_]=h)}}for(_=l.length,m=l[_-1];_-- >0;)l[_]=m,m=i[m];return l}function nw(e){const i=e.subTree.component;if(i)return i.asyncDep&&!i.asyncResolved?i:nw(i)}function ob(e){if(e)for(let i=0;i<e.length;i++)e[i].flags|=8}const JP=Symbol.for("v-scx"),QP=()=>ni(JP);function xa(e,i){return Cy(e,null,i)}function Qt(e,i,l){return Cy(e,i,l)}function Cy(e,i,l=_i){const{immediate:h,deep:p,flush:_,once:m}=l,o=Qi({},l),T=i&&h||!i&&_!=="post";let k;if(dd){if(_==="sync"){const z=QP();k=z.__watcherHandles||(z.__watcherHandles=[])}else if(!T){const z=()=>{};return z.stop=Da,z.resume=Da,z.pause=Da,z}}const M=vr;o.call=(z,F,N)=>rs(z,M,F,N);let D=!1;_==="post"?o.scheduler=z=>{qr(z,M&&M.suspense)}:_!=="sync"&&(D=!0,o.scheduler=(z,F)=>{F?z():_y(z)}),o.augmentJob=z=>{i&&(z.flags|=4),D&&(z.flags|=2,M&&(z.id=M.uid,z.i=M))};const O=vP(e,i,o);return dd&&(k?k.push(O):T&&O()),O}function ek(e,i,l){const h=this.proxy,p=Oi(e)?e.includes(".")?iw(h,e):()=>h[e]:e.bind(h,h);let _;wn(i)?_=i:(_=i.handler,l=i);const m=Md(this),o=Cy(p,_.bind(h),l);return m(),o}function iw(e,i){const l=i.split(".");return()=>{let h=e;for(let p=0;p<l.length&&h;p++)h=h[l[p]];return h}}const tk=(e,i)=>i==="modelValue"||i==="model-value"?e.modelModifiers:e[`${i}Modifiers`]||e[`${aa(i)}Modifiers`]||e[`${Jl(i)}Modifiers`];function nk(e,i,...l){if(e.isUnmounted)return;const h=e.vnode.props||_i;let p=l;const _=i.startsWith("update:"),m=_&&tk(h,i.slice(7));m&&(m.trim&&(p=l.map(M=>Oi(M)?M.trim():M)),m.number&&(p=l.map(w_)));let o,T=h[o=Zg(i)]||h[o=Zg(aa(i))];!T&&_&&(T=h[o=Zg(Jl(i))]),T&&rs(T,e,6,p);const k=h[o+"Once"];if(k){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,rs(k,e,6,p)}}function rw(e,i,l=!1){const h=i.emitsCache,p=h.get(e);if(p!==void 0)return p;const _=e.emits;let m={},o=!1;if(!wn(e)){const T=k=>{const M=rw(k,i,!0);M&&(o=!0,Qi(m,M))};!l&&i.mixins.length&&i.mixins.forEach(T),e.extends&&T(e.extends),e.mixins&&e.mixins.forEach(T)}return!_&&!o?(Ci(e)&&h.set(e,null),null):(gn(_)?_.forEach(T=>m[T]=null):Qi(m,_),Ci(e)&&h.set(e,m),m)}function pm(e,i){return!e||!im(i)?!1:(i=i.slice(2).replace(/Once$/,""),ei(e,i[0].toLowerCase()+i.slice(1))||ei(e,Jl(i))||ei(e,i))}function e_(e){const{type:i,vnode:l,proxy:h,withProxy:p,propsOptions:[_],slots:m,attrs:o,emit:T,render:k,renderCache:M,props:D,data:O,setupState:z,ctx:F,inheritAttrs:N}=e,q=Bp(e);let oe,_e;try{if(l.shapeFlag&4){const pe=p||h,be=pe;oe=bs(k.call(be,pe,M,D,z,O,F)),_e=o}else{const pe=i;oe=bs(pe.length>1?pe(D,{attrs:o,slots:m,emit:T}):pe(D,null)),_e=i.props?o:ik(o)}}catch(pe){id.length=0,hm(pe,e,1),oe=A(Kr)}let Se=oe;if(_e&&N!==!1){const pe=Object.keys(_e),{shapeFlag:be}=Se;pe.length&&be&7&&(_&&pe.some(sy)&&(_e=rk(_e,_)),Se=no(Se,_e,!1,!0))}return l.dirs&&(Se=no(Se,null,!1,!0),Se.dirs=Se.dirs?Se.dirs.concat(l.dirs):l.dirs),l.transition&&Xl(Se,l.transition),oe=Se,Bp(q),oe}const ik=e=>{let i;for(const l in e)(l==="class"||l==="style"||im(l))&&((i||(i={}))[l]=e[l]);return i},rk=(e,i)=>{const l={};for(const h in e)(!sy(h)||!(h.slice(9)in i))&&(l[h]=e[h]);return l};function ak(e,i,l){const{props:h,children:p,component:_}=e,{props:m,children:o,patchFlag:T}=i,k=_.emitsOptions;if(i.dirs||i.transition)return!0;if(l&&T>=0){if(T&1024)return!0;if(T&16)return h?lb(h,m,k):!!m;if(T&8){const M=i.dynamicProps;for(let D=0;D<M.length;D++){const O=M[D];if(m[O]!==h[O]&&!pm(k,O))return!0}}}else return(p||o)&&(!o||!o.$stable)?!0:h===m?!1:h?m?lb(h,m,k):!0:!!m;return!1}function lb(e,i,l){const h=Object.keys(i);if(h.length!==Object.keys(e).length)return!0;for(let p=0;p<h.length;p++){const _=h[p];if(i[_]!==e[_]&&!pm(l,_))return!0}return!1}function sk({vnode:e,parent:i},l){for(;i;){const h=i.subTree;if(h.suspense&&h.suspense.activeBranch===e&&(h.el=e.el),h===e)(e=i.vnode).el=l,i=i.parent;else break}}const aw=e=>e.__isSuspense;function ok(e,i){i&&i.pendingBranch?gn(e)?i.effects.push(...e):i.effects.push(e):T1(e)}const cn=Symbol.for("v-fgt"),Id=Symbol.for("v-txt"),Kr=Symbol.for("v-cmt"),xp=Symbol.for("v-stc"),id=[];let va=null;function $e(e=!1){id.push(va=e?null:[])}function lk(){id.pop(),va=id[id.length-1]||null}let ud=1;function cb(e,i=!1){ud+=e,e<0&&va&&i&&(va.hasOnce=!0)}function sw(e){return e.dynamicChildren=ud>0?va||cu:null,lk(),ud>0&&va&&va.push(e),e}function Vt(e,i,l,h,p,_){return sw(Ke(e,i,l,h,p,_,!0))}function gt(e,i,l,h,p){return sw(A(e,i,l,h,p,!0))}function hd(e){return e?e.__v_isVNode===!0:!1}function $l(e,i){return e.type===i.type&&e.key===i.key}const ow=({key:e})=>e??null,wp=({ref:e,ref_key:i,ref_for:l})=>(typeof e=="number"&&(e=""+e),e!=null?Oi(e)||ci(e)||wn(e)?{i:Yr,r:e,k:i,f:!!l}:e:null);function Ke(e,i=null,l=null,h=0,p=null,_=e===cn?0:1,m=!1,o=!1){const T={__v_isVNode:!0,__v_skip:!0,type:e,props:i,key:i&&ow(i),ref:i&&wp(i),scopeId:I1,slotScopeIds:null,children:l,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:_,patchFlag:h,dynamicProps:p,dynamicChildren:null,appContext:null,ctx:Yr};return o?(Ty(T,l),_&128&&e.normalize(T)):l&&(T.shapeFlag|=Oi(l)?8:16),ud>0&&!m&&va&&(T.patchFlag>0||_&6)&&T.patchFlag!==32&&va.push(T),T}const A=ck;function ck(e,i=null,l=null,h=0,p=null,_=!1){if((!e||e===U1)&&(e=Kr),hd(e)){const o=no(e,i,!0);return l&&Ty(o,l),ud>0&&!_&&va&&(o.shapeFlag&6?va[va.indexOf(e)]=o:va.push(o)),o.patchFlag=-2,o}if(vk(e)&&(e=e.__vccOpts),i){i=uk(i);let{class:o,style:T}=i;o&&!Oi(o)&&(i.class=om(o)),Ci(T)&&(gy(T)&&!gn(T)&&(T=Qi({},T)),i.style=cy(T))}const m=Oi(e)?1:aw(e)?128:E1(e)?64:Ci(e)?4:wn(e)?2:0;return Ke(e,i,l,h,p,m,_,!0)}function uk(e){return e?gy(e)||X1(e)?Qi({},e):e:null}function no(e,i,l=!1,h=!1){const{props:p,ref:_,patchFlag:m,children:o,transition:T}=e,k=i?sn(p||{},i):p,M={__v_isVNode:!0,__v_skip:!0,type:e.type,props:k,key:k&&ow(k),ref:i&&i.ref?l&&_?gn(_)?_.concat(wp(i)):[_,wp(i)]:wp(i):_,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:i&&e.type!==cn?m===-1?16:m|16:m,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:T,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&no(e.ssContent),ssFallback:e.ssFallback&&no(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return T&&h&&Xl(M,T.clone(M)),M}function je(e=" ",i=0){return A(Id,null,e,i)}function Ft(e="",i=!1){return i?($e(),gt(Kr,null,e)):A(Kr,null,e)}function bs(e){return e==null||typeof e=="boolean"?A(Kr):gn(e)?A(cn,null,e.slice()):hd(e)?Uo(e):A(Id,null,String(e))}function Uo(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:no(e)}function Ty(e,i){let l=0;const{shapeFlag:h}=e;if(i==null)i=null;else if(gn(i))l=16;else if(typeof i=="object")if(h&65){const p=i.default;p&&(p._c&&(p._d=!1),Ty(e,p()),p._c&&(p._d=!0));return}else{l=32;const p=i._;!p&&!X1(i)?i._ctx=Yr:p===3&&Yr&&(Yr.slots._===1?i._=1:(i._=2,e.patchFlag|=1024))}else wn(i)?(i={default:i,_ctx:Yr},l=32):(i=String(i),h&64?(l=16,i=[je(i)]):l=8);e.children=i,e.shapeFlag|=l}function sn(...e){const i={};for(let l=0;l<e.length;l++){const h=e[l];for(const p in h)if(p==="class")i.class!==h.class&&(i.class=om([i.class,h.class]));else if(p==="style")i.style=cy([i.style,h.style]);else if(im(p)){const _=i[p],m=h[p];m&&_!==m&&!(gn(_)&&_.includes(m))&&(i[p]=_?[].concat(_,m):m)}else p!==""&&(i[p]=h[p])}return i}function gs(e,i,l,h=null){rs(e,i,7,[l,h])}const hk=Z1();let dk=0;function fk(e,i,l){const h=e.type,p=(i?i.appContext:e.appContext)||hk,_={uid:dk++,vnode:e,type:h,parent:i,appContext:p,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new r1(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:i?i.provides:Object.create(p.provides),ids:i?i.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Y1(h,p),emitsOptions:rw(h,p),emit:null,emitted:null,propsDefaults:_i,inheritAttrs:h.inheritAttrs,ctx:_i,data:_i,props:_i,attrs:_i,slots:_i,refs:_i,setupState:_i,setupContext:null,suspense:l,suspenseId:l?l.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return _.ctx={_},_.root=i?i.root:_,_.emit=nk.bind(null,_),e.ce&&e.ce(_),_}let vr=null;const mm=()=>vr||Yr;let Vp,R_;{const e=sm(),i=(l,h)=>{let p;return(p=e[l])||(p=e[l]=[]),p.push(h),_=>{p.length>1?p.forEach(m=>m(_)):p[0](_)}};Vp=i("__VUE_INSTANCE_SETTERS__",l=>vr=l),R_=i("__VUE_SSR_SETTERS__",l=>dd=l)}const Md=e=>{const i=vr;return Vp(e),e.scope.on(),()=>{e.scope.off(),Vp(i)}},ub=()=>{vr&&vr.scope.off(),Vp(null)};function lw(e){return e.vnode.shapeFlag&4}let dd=!1;function pk(e,i=!1,l=!1){i&&R_(i);const{props:h,children:p}=e.vnode,_=lw(e);jP(e,h,_,i),ZP(e,p,l);const m=_?mk(e,i):void 0;return i&&R_(!1),m}function mk(e,i){const l=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,DP);const{setup:h}=l;if(h){Ko();const p=e.setupContext=h.length>1?_k(e):null,_=Md(e),m=Td(h,e,0,[e.props,p]),o=Yx(m);if(Yo(),_(),(o||e.sp)&&!td(e)&&O1(e),o){if(m.then(ub,ub),i)return m.then(T=>{hb(e,T,i)}).catch(T=>{hm(T,e,0)});e.asyncDep=m}else hb(e,m,i)}else cw(e,i)}function hb(e,i,l){wn(i)?e.type.__ssrInlineRender?e.ssrRender=i:e.render=i:Ci(i)&&(e.setupState=x1(i)),cw(e,l)}let db;function cw(e,i,l){const h=e.type;if(!e.render){if(!i&&db&&!h.render){const p=h.template||xy(e).template;if(p){const{isCustomElement:_,compilerOptions:m}=e.appContext.config,{delimiters:o,compilerOptions:T}=h,k=Qi(Qi({isCustomElement:_,delimiters:o},m),T);h.render=db(p,k)}}e.render=h.render||Da}{const p=Md(e);Ko();try{zP(e)}finally{Yo(),p()}}}const gk={get(e,i){return zr(e,"get",""),e[i]}};function _k(e){const i=l=>{e.exposed=l||{}};return{attrs:new Proxy(e.attrs,gk),slots:e.slots,emit:e.emit,expose:i}}function gm(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(x1(cm(e.exposed)),{get(i,l){if(l in i)return i[l];if(l in nd)return nd[l](e)},has(i,l){return l in i||l in nd}})):e.proxy}function yk(e,i=!0){return wn(e)?e.displayName||e.name:e.name||i&&e.__name}function vk(e){return wn(e)&&"__vccOpts"in e}const ue=(e,i)=>_P(e,i,dd);function Jo(e,i,l){const h=arguments.length;return h===2?Ci(i)&&!gn(i)?hd(i)?A(e,null,[i]):A(e,i):A(e,null,i):(h>3?l=Array.prototype.slice.call(arguments,2):h===3&&hd(l)&&(l=[l]),A(e,i,l))}const bk="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let D_;const fb=typeof window<"u"&&window.trustedTypes;if(fb)try{D_=fb.createPolicy("vue",{createHTML:e=>e})}catch{}const uw=D_?e=>D_.createHTML(e):e=>e,xk="http://www.w3.org/2000/svg",wk="http://www.w3.org/1998/Math/MathML",Xs=typeof document<"u"?document:null,pb=Xs&&Xs.createElement("template"),Sk={insert:(e,i,l)=>{i.insertBefore(e,l||null)},remove:e=>{const i=e.parentNode;i&&i.removeChild(e)},createElement:(e,i,l,h)=>{const p=i==="svg"?Xs.createElementNS(xk,e):i==="mathml"?Xs.createElementNS(wk,e):l?Xs.createElement(e,{is:l}):Xs.createElement(e);return e==="select"&&h&&h.multiple!=null&&p.setAttribute("multiple",h.multiple),p},createText:e=>Xs.createTextNode(e),createComment:e=>Xs.createComment(e),setText:(e,i)=>{e.nodeValue=i},setElementText:(e,i)=>{e.textContent=i},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Xs.querySelector(e),setScopeId(e,i){e.setAttribute(i,"")},insertStaticContent(e,i,l,h,p,_){const m=l?l.previousSibling:i.lastChild;if(p&&(p===_||p.nextSibling))for(;i.insertBefore(p.cloneNode(!0),l),!(p===_||!(p=p.nextSibling)););else{pb.innerHTML=uw(h==="svg"?`<svg>${e}</svg>`:h==="mathml"?`<math>${e}</math>`:e);const o=pb.content;if(h==="svg"||h==="mathml"){const T=o.firstChild;for(;T.firstChild;)o.appendChild(T.firstChild);o.removeChild(T)}i.insertBefore(o,l)}return[m?m.nextSibling:i.firstChild,l?l.previousSibling:i.lastChild]}},Oo="transition",Hh="animation",fu=Symbol("_vtc"),hw={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},dw=Qi({},z1,hw),Ck=e=>(e.displayName="Transition",e.props=dw,e),Cs=Ck((e,{slots:i})=>Jo(TP,fw(e),i)),Fl=(e,i=[])=>{gn(e)?e.forEach(l=>l(...i)):e&&e(...i)},mb=e=>e?gn(e)?e.some(i=>i.length>1):e.length>1:!1;function fw(e){const i={};for(const xe in e)xe in hw||(i[xe]=e[xe]);if(e.css===!1)return i;const{name:l="v",type:h,duration:p,enterFromClass:_=`${l}-enter-from`,enterActiveClass:m=`${l}-enter-active`,enterToClass:o=`${l}-enter-to`,appearFromClass:T=_,appearActiveClass:k=m,appearToClass:M=o,leaveFromClass:D=`${l}-leave-from`,leaveActiveClass:O=`${l}-leave-active`,leaveToClass:z=`${l}-leave-to`}=e,F=Tk(p),N=F&&F[0],q=F&&F[1],{onBeforeEnter:oe,onEnter:_e,onEnterCancelled:Se,onLeave:pe,onLeaveCancelled:be,onBeforeAppear:de=oe,onAppear:Ce=_e,onAppearCancelled:ye=Se}=i,Me=(xe,Fe,We,ht)=>{xe._enterCancelled=ht,Vo(xe,Fe?M:o),Vo(xe,Fe?k:m),We&&We()},ke=(xe,Fe)=>{xe._isLeaving=!1,Vo(xe,D),Vo(xe,z),Vo(xe,O),Fe&&Fe()},Ee=xe=>(Fe,We)=>{const ht=xe?Ce:_e,Ne=()=>Me(Fe,xe,We);Fl(ht,[Fe,Ne]),gb(()=>{Vo(Fe,xe?T:_),ys(Fe,xe?M:o),mb(ht)||_b(Fe,h,N,Ne)})};return Qi(i,{onBeforeEnter(xe){Fl(oe,[xe]),ys(xe,_),ys(xe,m)},onBeforeAppear(xe){Fl(de,[xe]),ys(xe,T),ys(xe,k)},onEnter:Ee(!1),onAppear:Ee(!0),onLeave(xe,Fe){xe._isLeaving=!0;const We=()=>ke(xe,Fe);ys(xe,D),xe._enterCancelled?(ys(xe,O),z_()):(z_(),ys(xe,O)),gb(()=>{xe._isLeaving&&(Vo(xe,D),ys(xe,z),mb(pe)||_b(xe,h,q,We))}),Fl(pe,[xe,We])},onEnterCancelled(xe){Me(xe,!1,void 0,!0),Fl(Se,[xe])},onAppearCancelled(xe){Me(xe,!0,void 0,!0),Fl(ye,[xe])},onLeaveCancelled(xe){ke(xe),Fl(be,[xe])}})}function Tk(e){if(e==null)return null;if(Ci(e))return[t_(e.enter),t_(e.leave)];{const i=t_(e);return[i,i]}}function t_(e){return VT(e)}function ys(e,i){i.split(/\s+/).forEach(l=>l&&e.classList.add(l)),(e[fu]||(e[fu]=new Set)).add(i)}function Vo(e,i){i.split(/\s+/).forEach(h=>h&&e.classList.remove(h));const l=e[fu];l&&(l.delete(i),l.size||(e[fu]=void 0))}function gb(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let Pk=0;function _b(e,i,l,h){const p=e._endId=++Pk,_=()=>{p===e._endId&&h()};if(l!=null)return setTimeout(_,l);const{type:m,timeout:o,propCount:T}=pw(e,i);if(!m)return h();const k=m+"end";let M=0;const D=()=>{e.removeEventListener(k,O),_()},O=z=>{z.target===e&&++M>=T&&D()};setTimeout(()=>{M<T&&D()},o+1),e.addEventListener(k,O)}function pw(e,i){const l=window.getComputedStyle(e),h=F=>(l[F]||"").split(", "),p=h(`${Oo}Delay`),_=h(`${Oo}Duration`),m=yb(p,_),o=h(`${Hh}Delay`),T=h(`${Hh}Duration`),k=yb(o,T);let M=null,D=0,O=0;i===Oo?m>0&&(M=Oo,D=m,O=_.length):i===Hh?k>0&&(M=Hh,D=k,O=T.length):(D=Math.max(m,k),M=D>0?m>k?Oo:Hh:null,O=M?M===Oo?_.length:T.length:0);const z=M===Oo&&/\b(transform|all)(,|$)/.test(h(`${Oo}Property`).toString());return{type:M,timeout:D,propCount:O,hasTransform:z}}function yb(e,i){for(;e.length<i.length;)e=e.concat(e);return Math.max(...i.map((l,h)=>vb(l)+vb(e[h])))}function vb(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function z_(){return document.body.offsetHeight}function kk(e,i,l){const h=e[fu];h&&(i=(i?[i,...h]:[...h]).join(" ")),i==null?e.removeAttribute("class"):l?e.setAttribute("class",i):e.className=i}const Np=Symbol("_vod"),mw=Symbol("_vsh"),Ql={beforeMount(e,{value:i},{transition:l}){e[Np]=e.style.display==="none"?"":e.style.display,l&&i?l.beforeEnter(e):Zh(e,i)},mounted(e,{value:i},{transition:l}){l&&i&&l.enter(e)},updated(e,{value:i,oldValue:l},{transition:h}){!i!=!l&&(h?i?(h.beforeEnter(e),Zh(e,!0),h.enter(e)):h.leave(e,()=>{Zh(e,!1)}):Zh(e,i))},beforeUnmount(e,{value:i}){Zh(e,i)}};function Zh(e,i){e.style.display=i?e[Np]:"none",e[mw]=!i}const gw=Symbol("");function Ik(e){const i=mm();if(!i)return;const l=i.ut=(p=e(i.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${i.uid}"]`)).forEach(_=>$p(_,p))},h=()=>{const p=e(i.proxy);i.ce?$p(i.ce,p):L_(i.subTree,p),l(p)};$1(()=>{T1(h)}),yi(()=>{Qt(h,Da,{flush:"post"});const p=new MutationObserver(h);p.observe(i.subTree.el.parentNode,{childList:!0}),kd(()=>p.disconnect())})}function L_(e,i){if(e.shapeFlag&128){const l=e.suspense;e=l.activeBranch,l.pendingBranch&&!l.isHydrating&&l.effects.push(()=>{L_(l.activeBranch,i)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)$p(e.el,i);else if(e.type===cn)e.children.forEach(l=>L_(l,i));else if(e.type===xp){let{el:l,anchor:h}=e;for(;l&&($p(l,i),l!==h);)l=l.nextSibling}}function $p(e,i){if(e.nodeType===1){const l=e.style;let h="";for(const p in i)l.setProperty(`--${p}`,i[p]),h+=`--${p}: ${i[p]};`;l[gw]=h}}const Mk=/(^|;)\s*display\s*:/;function Ek(e,i,l){const h=e.style,p=Oi(l);let _=!1;if(l&&!p){if(i)if(Oi(i))for(const m of i.split(";")){const o=m.slice(0,m.indexOf(":")).trim();l[o]==null&&Sp(h,o,"")}else for(const m in i)l[m]==null&&Sp(h,m,"");for(const m in l)m==="display"&&(_=!0),Sp(h,m,l[m])}else if(p){if(i!==l){const m=h[gw];m&&(l+=";"+m),h.cssText=l,_=Mk.test(l)}}else i&&e.removeAttribute("style");Np in e&&(e[Np]=_?h.display:"",e[mw]&&(h.display="none"))}const bb=/\s*!important$/;function Sp(e,i,l){if(gn(l))l.forEach(h=>Sp(e,i,h));else if(l==null&&(l=""),i.startsWith("--"))e.setProperty(i,l);else{const h=Ak(e,i);bb.test(l)?e.setProperty(Jl(h),l.replace(bb,""),"important"):e[h]=l}}const xb=["Webkit","Moz","ms"],n_={};function Ak(e,i){const l=n_[i];if(l)return l;let h=aa(i);if(h!=="filter"&&h in e)return n_[i]=h;h=io(h);for(let p=0;p<xb.length;p++){const _=xb[p]+h;if(_ in e)return n_[i]=_}return i}const wb="http://www.w3.org/1999/xlink";function Sb(e,i,l,h,p,_=HT(i)){h&&i.startsWith("xlink:")?l==null?e.removeAttributeNS(wb,i.slice(6,i.length)):e.setAttributeNS(wb,i,l):l==null||_&&!t1(l)?e.removeAttribute(i):e.setAttribute(i,_?"":Xo(l)?String(l):l)}function Cb(e,i,l,h,p){if(i==="innerHTML"||i==="textContent"){l!=null&&(e[i]=i==="innerHTML"?uw(l):l);return}const _=e.tagName;if(i==="value"&&_!=="PROGRESS"&&!_.includes("-")){const o=_==="OPTION"?e.getAttribute("value")||"":e.value,T=l==null?e.type==="checkbox"?"on":"":String(l);(o!==T||!("_value"in e))&&(e.value=T),l==null&&e.removeAttribute(i),e._value=l;return}let m=!1;if(l===""||l==null){const o=typeof e[i];o==="boolean"?l=t1(l):l==null&&o==="string"?(l="",m=!0):o==="number"&&(l=0,m=!0)}try{e[i]=l}catch{}m&&e.removeAttribute(p||i)}function ou(e,i,l,h){e.addEventListener(i,l,h)}function Rk(e,i,l,h){e.removeEventListener(i,l,h)}const Tb=Symbol("_vei");function Dk(e,i,l,h,p=null){const _=e[Tb]||(e[Tb]={}),m=_[i];if(h&&m)m.value=h;else{const[o,T]=zk(i);if(h){const k=_[i]=Fk(h,p);ou(e,o,k,T)}else m&&(Rk(e,o,m,T),_[i]=void 0)}}const Pb=/(?:Once|Passive|Capture)$/;function zk(e){let i;if(Pb.test(e)){i={};let h;for(;h=e.match(Pb);)e=e.slice(0,e.length-h[0].length),i[h[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Jl(e.slice(2)),i]}let i_=0;const Lk=Promise.resolve(),Bk=()=>i_||(Lk.then(()=>i_=0),i_=Date.now());function Fk(e,i){const l=h=>{if(!h._vts)h._vts=Date.now();else if(h._vts<=l.attached)return;rs(Ok(h,l.value),i,5,[h])};return l.value=e,l.attached=Bk(),l}function Ok(e,i){if(gn(i)){const l=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{l.call(e),e._stopped=!0},i.map(h=>p=>!p._stopped&&h&&h(p))}else return i}const kb=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Vk=(e,i,l,h,p,_)=>{const m=p==="svg";i==="class"?kk(e,h,m):i==="style"?Ek(e,l,h):im(i)?sy(i)||Dk(e,i,l,h,_):(i[0]==="."?(i=i.slice(1),!0):i[0]==="^"?(i=i.slice(1),!1):Nk(e,i,h,m))?(Cb(e,i,h),!e.tagName.includes("-")&&(i==="value"||i==="checked"||i==="selected")&&Sb(e,i,h,m,_,i!=="value")):e._isVueCE&&(/[A-Z]/.test(i)||!Oi(h))?Cb(e,aa(i),h,_,i):(i==="true-value"?e._trueValue=h:i==="false-value"&&(e._falseValue=h),Sb(e,i,h,m))};function Nk(e,i,l,h){if(h)return!!(i==="innerHTML"||i==="textContent"||i in e&&kb(i)&&wn(l));if(i==="spellcheck"||i==="draggable"||i==="translate"||i==="form"||i==="list"&&e.tagName==="INPUT"||i==="type"&&e.tagName==="TEXTAREA")return!1;if(i==="width"||i==="height"){const p=e.tagName;if(p==="IMG"||p==="VIDEO"||p==="CANVAS"||p==="SOURCE")return!1}return kb(i)&&Oi(l)?!1:i in e}const _w=new WeakMap,yw=new WeakMap,jp=Symbol("_moveCb"),Ib=Symbol("_enterCb"),$k=e=>(delete e.props.mode,e),jk=$k({name:"TransitionGroup",props:Qi({},dw,{tag:String,moveClass:String}),setup(e,{slots:i}){const l=mm(),h=D1();let p,_;return by(()=>{if(!p.length)return;const m=e.moveClass||`${e.name||"v"}-move`;if(!Zk(p[0].el,l.vnode.el,m))return;p.forEach(Uk),p.forEach(Gk);const o=p.filter(Hk);z_(),o.forEach(T=>{const k=T.el,M=k.style;ys(k,m),M.transform=M.webkitTransform=M.transitionDuration="";const D=k[jp]=O=>{O&&O.target!==k||(!O||/transform$/.test(O.propertyName))&&(k.removeEventListener("transitionend",D),k[jp]=null,Vo(k,m))};k.addEventListener("transitionend",D)})}),()=>{const m=fn(e),o=fw(m);let T=m.tag||cn;if(p=[],_)for(let k=0;k<_.length;k++){const M=_[k];M.el&&M.el instanceof Element&&(p.push(M),Xl(M,cd(M,o,h,l)),_w.set(M,M.el.getBoundingClientRect()))}_=i.default?yy(i.default()):[];for(let k=0;k<_.length;k++){const M=_[k];M.key!=null&&Xl(M,cd(M,o,h,l))}return A(T,null,_)}}}),Py=jk;function Uk(e){const i=e.el;i[jp]&&i[jp](),i[Ib]&&i[Ib]()}function Gk(e){yw.set(e,e.el.getBoundingClientRect())}function Hk(e){const i=_w.get(e),l=yw.get(e),h=i.left-l.left,p=i.top-l.top;if(h||p){const _=e.el.style;return _.transform=_.webkitTransform=`translate(${h}px,${p}px)`,_.transitionDuration="0s",e}}function Zk(e,i,l){const h=e.cloneNode(),p=e[fu];p&&p.forEach(o=>{o.split(/\s+/).forEach(T=>T&&h.classList.remove(T))}),l.split(/\s+/).forEach(o=>o&&h.classList.add(o)),h.style.display="none";const _=i.nodeType===1?i:i.parentNode;_.appendChild(h);const{hasTransform:m}=pw(h);return _.removeChild(h),m}const Mb=e=>{const i=e.props["onUpdate:modelValue"]||!1;return gn(i)?l=>vp(i,l):i};function qk(e){e.target.composing=!0}function Eb(e){const i=e.target;i.composing&&(i.composing=!1,i.dispatchEvent(new Event("input")))}const r_=Symbol("_assign"),Wk={created(e,{modifiers:{lazy:i,trim:l,number:h}},p){e[r_]=Mb(p);const _=h||p.props&&p.props.type==="number";ou(e,i?"change":"input",m=>{if(m.target.composing)return;let o=e.value;l&&(o=o.trim()),_&&(o=w_(o)),e[r_](o)}),l&&ou(e,"change",()=>{e.value=e.value.trim()}),i||(ou(e,"compositionstart",qk),ou(e,"compositionend",Eb),ou(e,"change",Eb))},mounted(e,{value:i}){e.value=i??""},beforeUpdate(e,{value:i,oldValue:l,modifiers:{lazy:h,trim:p,number:_}},m){if(e[r_]=Mb(m),e.composing)return;const o=(_||e.type==="number")&&!/^0\d/.test(e.value)?w_(e.value):e.value,T=i??"";o!==T&&(document.activeElement===e&&e.type!=="range"&&(h&&i===l||p&&e.value.trim()===T)||(e.value=T))}},Xk=Qi({patchProp:Vk},Sk);let Ab;function Kk(){return Ab||(Ab=WP(Xk))}const Yk=(...e)=>{const i=Kk().createApp(...e),{mount:l}=i;return i.mount=h=>{const p=Qk(h);if(!p)return;const _=i._component;!wn(_)&&!_.render&&!_.template&&(_.template=p.innerHTML),p.nodeType===1&&(p.textContent="");const m=l(p,!1,Jk(p));return p instanceof Element&&(p.removeAttribute("v-cloak"),p.setAttribute("data-v-app","")),m},i};function Jk(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function Qk(e){return Oi(e)?document.querySelector(e):e}var eI=!1;/*!
 * pinia v2.3.0
 * (c) 2024 Eduardo San Martin Morote
 * @license MIT
 */let vw;const _m=e=>vw=e,bw=Symbol();function B_(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var rd;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(rd||(rd={}));function xw(){const e=Sd(!0),i=e.run(()=>Ye({}));let l=[],h=[];const p=cm({install(_){_m(p),p._a=_,_.provide(bw,p),_.config.globalProperties.$pinia=p,h.forEach(m=>l.push(m)),h=[]},use(_){return!this._a&&!eI?h.push(_):l.push(_),this},_p:l,_a:null,_e:e,_s:new Map,state:i});return p}const ww=()=>{};function Rb(e,i,l,h=ww){e.push(i);const p=()=>{const _=e.indexOf(i);_>-1&&(e.splice(_,1),h())};return!l&&a1()&&Pr(p),p}function tu(e,...i){e.slice().forEach(l=>{l(...i)})}const tI=e=>e(),Db=Symbol(),a_=Symbol();function F_(e,i){e instanceof Map&&i instanceof Map?i.forEach((l,h)=>e.set(h,l)):e instanceof Set&&i instanceof Set&&i.forEach(e.add,e);for(const l in i){if(!i.hasOwnProperty(l))continue;const h=i[l],p=e[l];B_(p)&&B_(h)&&e.hasOwnProperty(l)&&!ci(h)&&!Zo(h)?e[l]=F_(p,h):e[l]=h}return e}const nI=Symbol();function iI(e){return!B_(e)||!e.hasOwnProperty(nI)}const{assign:No}=Object;function rI(e){return!!(ci(e)&&e.effect)}function aI(e,i,l,h){const{state:p,actions:_,getters:m}=i,o=l.state.value[e];let T;function k(){o||(l.state.value[e]=p?p():{});const M=um(l.state.value[e]);return No(M,_,Object.keys(m||{}).reduce((D,O)=>(D[O]=cm(ue(()=>{_m(l);const z=l._s.get(e);return m[O].call(z,z)})),D),{}))}return T=Sw(e,k,i,l,h,!0),T}function Sw(e,i,l={},h,p,_){let m;const o=No({actions:{}},l),T={deep:!0};let k,M,D=[],O=[],z;const F=h.state.value[e];!_&&!F&&(h.state.value[e]={}),Ye({});let N;function q(ye){let Me;k=M=!1,typeof ye=="function"?(ye(h.state.value[e]),Me={type:rd.patchFunction,storeId:e,events:z}):(F_(h.state.value[e],ye),Me={type:rd.patchObject,payload:ye,storeId:e,events:z});const ke=N=Symbol();Fi().then(()=>{N===ke&&(k=!0)}),M=!0,tu(D,Me,h.state.value[e])}const oe=_?function(){const{state:Me}=l,ke=Me?Me():{};this.$patch(Ee=>{No(Ee,ke)})}:ww;function _e(){m.stop(),D=[],O=[],h._s.delete(e)}const Se=(ye,Me="")=>{if(Db in ye)return ye[a_]=Me,ye;const ke=function(){_m(h);const Ee=Array.from(arguments),xe=[],Fe=[];function We(tt){xe.push(tt)}function ht(tt){Fe.push(tt)}tu(O,{args:Ee,name:ke[a_],store:be,after:We,onError:ht});let Ne;try{Ne=ye.apply(this&&this.$id===e?this:be,Ee)}catch(tt){throw tu(Fe,tt),tt}return Ne instanceof Promise?Ne.then(tt=>(tu(xe,tt),tt)).catch(tt=>(tu(Fe,tt),Promise.reject(tt))):(tu(xe,Ne),Ne)};return ke[Db]=!0,ke[a_]=Me,ke},pe={_p:h,$id:e,$onAction:Rb.bind(null,O),$patch:q,$reset:oe,$subscribe(ye,Me={}){const ke=Rb(D,ye,Me.detached,()=>Ee()),Ee=m.run(()=>Qt(()=>h.state.value[e],xe=>{(Me.flush==="sync"?M:k)&&ye({storeId:e,type:rd.direct,events:z},xe)},No({},T,Me)));return ke},$dispose:_e},be=yr(pe);h._s.set(e,be);const Ce=(h._a&&h._a.runWithContext||tI)(()=>h._e.run(()=>(m=Sd()).run(()=>i({action:Se}))));for(const ye in Ce){const Me=Ce[ye];if(ci(Me)&&!rI(Me)||Zo(Me))_||(F&&iI(Me)&&(ci(Me)?Me.value=F[ye]:F_(Me,F[ye])),h.state.value[e][ye]=Me);else if(typeof Me=="function"){const ke=Se(Me,ye);Ce[ye]=ke,o.actions[ye]=Me}}return No(be,Ce),No(fn(be),Ce),Object.defineProperty(be,"$state",{get:()=>h.state.value[e],set:ye=>{q(Me=>{No(Me,ye)})}}),h._p.forEach(ye=>{No(be,m.run(()=>ye({store:be,app:h._a,pinia:h,options:o})))}),F&&_&&l.hydrate&&l.hydrate(be.$state,F),k=!0,M=!0,be}/*! #__NO_SIDE_EFFECTS__ */function sI(e,i,l){let h,p;const _=typeof i=="function";typeof e=="string"?(h=e,p=_?l:i):(p=e,h=e.id);function m(o,T){const k=$P();return o=o||(k?ni(bw,null):null),o&&_m(o),o=vw,o._s.has(h)||(_?Sw(h,i,p,o):aI(h,p,o)),o._s.get(h)}return m.$id=h,m}const vi=sI("global",{state:()=>({appIsOpen:!1,hudIsOpen:!1,currentPage:"racing",currentTab:"current",showOnlyCurated:!0,activeRace:{},activeHudData:{},countdown:-1,buttons:{},creatorData:{},baseData:{},isLoadingBaseData:!0,settings:{},tracks:[],results:{},myCrew:{},notification:void 0,bounties:[],showCryptoModal:!1})}),re=e=>vi().baseData.data.translations[e]||e;const Zn=typeof window<"u",ky=Zn&&"IntersectionObserver"in window,oI=Zn&&("ontouchstart"in window||window.navigator.maxTouchPoints>0);function zb(e,i,l){lI(e,i),i.set(e,l)}function lI(e,i){if(i.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cI(e,i,l){return e.set(Cw(e,i),l),l}function Ol(e,i){return e.get(Cw(e,i))}function Cw(e,i,l){if(typeof e=="function"?e===i:e.has(i))return arguments.length<3?i:l;throw new TypeError("Private element is not present on this object")}function Tw(e,i,l){const h=i.length-1;if(h<0)return e===void 0?l:e;for(let p=0;p<h;p++){if(e==null)return l;e=e[i[p]]}return e==null||e[i[h]]===void 0?l:e[i[h]]}function _u(e,i){if(e===i)return!0;if(e instanceof Date&&i instanceof Date&&e.getTime()!==i.getTime()||e!==Object(e)||i!==Object(i))return!1;const l=Object.keys(e);return l.length!==Object.keys(i).length?!1:l.every(h=>_u(e[h],i[h]))}function O_(e,i,l){return e==null||!i||typeof i!="string"?l:e[i]!==void 0?e[i]:(i=i.replace(/\[(\w+)\]/g,".$1"),i=i.replace(/^\./,""),Tw(e,i.split("."),l))}function Qs(e,i,l){if(i===!0)return e===void 0?l:e;if(i==null||typeof i=="boolean")return l;if(e!==Object(e)){if(typeof i!="function")return l;const p=i(e,l);return typeof p>"u"?l:p}if(typeof i=="string")return O_(e,i,l);if(Array.isArray(i))return Tw(e,i,l);if(typeof i!="function")return l;const h=i(e,l);return typeof h>"u"?l:h}function Pw(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Array.from({length:e},(l,h)=>i+h)}function mn(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"px";if(!(e==null||e===""))return isNaN(+e)?String(e):isFinite(+e)?`${Number(e)}${i}`:void 0}function Iy(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function Lb(e){let i;return e!==null&&typeof e=="object"&&((i=Object.getPrototypeOf(e))===Object.prototype||i===null)}function My(e){if(e&&"$el"in e){const i=e.$el;return(i==null?void 0:i.nodeType)===Node.TEXT_NODE?i.nextElementSibling:i}return e}const Bb=Object.freeze({enter:13,tab:9,delete:46,esc:27,space:32,up:38,down:40,left:37,right:39,end:35,home:36,del:46,backspace:8,insert:45,pageup:33,pagedown:34,shift:16});function kw(e){return Object.keys(e)}function s_(e,i){return i.every(l=>e.hasOwnProperty(l))}function Iw(e,i){const l={},h=new Set(Object.keys(e));for(const p of i)h.has(p)&&(l[p]=e[p]);return l}function Fb(e,i,l){const h=Object.create(null),p=Object.create(null);for(const _ in e)i.some(m=>m instanceof RegExp?m.test(_):m===_)&&!(l!=null&&l.some(m=>m===_))?h[_]=e[_]:p[_]=e[_];return[h,p]}function Ts(e,i){const l={...e};return i.forEach(h=>delete l[h]),l}function uI(e,i){const l={};return i.forEach(h=>l[h]=e[h]),l}const Mw=/^on[^a-z]/,Ey=e=>Mw.test(e),hI=["onAfterscriptexecute","onAnimationcancel","onAnimationend","onAnimationiteration","onAnimationstart","onAuxclick","onBeforeinput","onBeforescriptexecute","onChange","onClick","onCompositionend","onCompositionstart","onCompositionupdate","onContextmenu","onCopy","onCut","onDblclick","onFocusin","onFocusout","onFullscreenchange","onFullscreenerror","onGesturechange","onGestureend","onGesturestart","onGotpointercapture","onInput","onKeydown","onKeypress","onKeyup","onLostpointercapture","onMousedown","onMousemove","onMouseout","onMouseover","onMouseup","onMousewheel","onPaste","onPointercancel","onPointerdown","onPointerenter","onPointerleave","onPointermove","onPointerout","onPointerover","onPointerup","onReset","onSelect","onSubmit","onTouchcancel","onTouchend","onTouchmove","onTouchstart","onTransitioncancel","onTransitionend","onTransitionrun","onTransitionstart","onWheel"];function ym(e){const[i,l]=Fb(e,[Mw]),h=Ts(i,hI),[p,_]=Fb(l,["class","style","id",/^data-/]);return Object.assign(p,i),Object.assign(_,h),[p,_]}function ns(e){return e==null?[]:Array.isArray(e)?e:[e]}function dI(e,i){let l=0;const h=function(){for(var p=arguments.length,_=new Array(p),m=0;m<p;m++)_[m]=arguments[m];clearTimeout(l),l=setTimeout(()=>e(..._),H(i))};return h.clear=()=>{clearTimeout(l)},h.immediate=e,h}function Ss(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.max(i,Math.min(l,e))}function Ob(e,i){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0";return e+l.repeat(Math.max(0,i-e.length))}function Vb(e,i){return(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0").repeat(Math.max(0,i-e.length))+e}function fI(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const l=[];let h=0;for(;h<e.length;)l.push(e.substr(h,i)),h+=i;return l}function Fr(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=arguments.length>2?arguments[2]:void 0;const h={};for(const p in e)h[p]=e[p];for(const p in i){const _=e[p],m=i[p];if(Lb(_)&&Lb(m)){h[p]=Fr(_,m,l);continue}if(l&&Array.isArray(_)&&Array.isArray(m)){h[p]=l(_,m);continue}h[p]=m}return h}function Ew(e){return e.map(i=>i.type===cn?Ew(i.children):i).flat()}function Zl(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(Zl.cache.has(e))return Zl.cache.get(e);const i=e.replace(/[^a-z]/gi,"-").replace(/\B([A-Z])/g,"-$1").toLowerCase();return Zl.cache.set(e,i),i}Zl.cache=new Map;function lu(e,i){if(!i||typeof i!="object")return[];if(Array.isArray(i))return i.map(l=>lu(e,l)).flat(1);if(i.suspense)return lu(e,i.ssContent);if(Array.isArray(i.children))return i.children.map(l=>lu(e,l)).flat(1);if(i.component){if(Object.getOwnPropertySymbols(i.component.provides).includes(e))return[i.component];if(i.component.subTree)return lu(e,i.component.subTree).flat(1)}return[]}var dp=new WeakMap,nu=new WeakMap;class pI{constructor(i){zb(this,dp,[]),zb(this,nu,0),this.size=i}push(i){Ol(dp,this)[Ol(nu,this)]=i,cI(nu,this,(Ol(nu,this)+1)%this.size)}values(){return Ol(dp,this).slice(Ol(nu,this)).concat(Ol(dp,this).slice(0,Ol(nu,this)))}}function Ay(e){const i=yr({}),l=ue(e);return xa(()=>{for(const h in l.value)i[h]=l.value[h]},{flush:"sync"}),um(i)}function Up(e,i){return e.includes(i)}function Aw(e){return e[2].toLowerCase()+e.slice(3)}const ra=()=>[Function,Array];function Nb(e,i){return i="on"+io(i),!!(e[i]||e[`${i}Once`]||e[`${i}Capture`]||e[`${i}OnceCapture`]||e[`${i}CaptureOnce`])}function Rw(e){for(var i=arguments.length,l=new Array(i>1?i-1:0),h=1;h<i;h++)l[h-1]=arguments[h];if(Array.isArray(e))for(const p of e)p(...l);else typeof e=="function"&&e(...l)}function fd(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const l=["button","[href]",'input:not([type="hidden"])',"select","textarea","[tabindex]"].map(h=>`${h}${i?':not([tabindex="-1"])':""}:not([disabled])`).join(", ");return[...e.querySelectorAll(l)]}function Dw(e,i,l){let h,p=e.indexOf(document.activeElement);const _=i==="next"?1:-1;do p+=_,h=e[p];while((!h||h.offsetParent==null||!((l==null?void 0:l(h))??!0))&&p<e.length&&p>=0);return h}function ad(e,i){var h,p,_,m;const l=fd(e);if(!i)(e===document.activeElement||!e.contains(document.activeElement))&&((h=l[0])==null||h.focus());else if(i==="first")(p=l[0])==null||p.focus();else if(i==="last")(_=l.at(-1))==null||_.focus();else if(typeof i=="number")(m=l[i])==null||m.focus();else{const o=Dw(l,i);o?o.focus():ad(e,i==="next"?"first":"last")}}function Gp(e,i){if(!(Zn&&typeof CSS<"u"&&typeof CSS.supports<"u"&&CSS.supports(`selector(${i})`)))return null;try{return!!e&&e.matches(i)}catch{return null}}function zw(e){return e.some(i=>hd(i)?i.type===Kr?!1:i.type!==cn||zw(i.children):!0)?e:null}function mI(e,i){if(!Zn||e===0)return i(),()=>{};const l=window.setTimeout(i,e);return()=>window.clearTimeout(l)}function gI(e,i){const l=e.clientX,h=e.clientY,p=i.getBoundingClientRect(),_=p.left,m=p.top,o=p.right,T=p.bottom;return l>=_&&l<=o&&h>=m&&h<=T}function V_(){const e=an(),i=l=>{e.value=l};return Object.defineProperty(i,"value",{enumerable:!0,get:()=>e.value,set:l=>e.value=l}),Object.defineProperty(i,"el",{enumerable:!0,get:()=>My(e.value)}),i}function $b(e){const i=e.key.length===1,l=!e.ctrlKey&&!e.metaKey&&!e.altKey;return i&&l}const Lw=["top","bottom"],_I=["start","end","left","right"];function N_(e,i){let[l,h]=e.split(" ");return h||(h=Up(Lw,l)?"start":Up(_I,l)?"top":"center"),{side:$_(l,i),align:$_(h,i)}}function $_(e,i){return e==="start"?i?"right":"left":e==="end"?i?"left":"right":e}function o_(e){return{side:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[e.side],align:e.align}}function l_(e){return{side:e.side,align:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[e.align]}}function jb(e){return{side:e.align,align:e.side}}function Ub(e){return Up(Lw,e.side)?"y":"x"}class ql{constructor(i){let{x:l,y:h,width:p,height:_}=i;this.x=l,this.y=h,this.width=p,this.height=_}get top(){return this.y}get bottom(){return this.y+this.height}get left(){return this.x}get right(){return this.x+this.width}}function Gb(e,i){return{x:{before:Math.max(0,i.left-e.left),after:Math.max(0,e.right-i.right)},y:{before:Math.max(0,i.top-e.top),after:Math.max(0,e.bottom-i.bottom)}}}function Bw(e){return Array.isArray(e)?new ql({x:e[0],y:e[1],width:0,height:0}):e.getBoundingClientRect()}function Ry(e){const i=e.getBoundingClientRect(),l=getComputedStyle(e),h=l.transform;if(h){let p,_,m,o,T;if(h.startsWith("matrix3d("))p=h.slice(9,-1).split(/, /),_=+p[0],m=+p[5],o=+p[12],T=+p[13];else if(h.startsWith("matrix("))p=h.slice(7,-1).split(/, /),_=+p[0],m=+p[3],o=+p[4],T=+p[5];else return new ql(i);const k=l.transformOrigin,M=i.x-o-(1-_)*parseFloat(k),D=i.y-T-(1-m)*parseFloat(k.slice(k.indexOf(" ")+1)),O=_?i.width/_:e.offsetWidth+1,z=m?i.height/m:e.offsetHeight+1;return new ql({x:M,y:D,width:O,height:z})}else return new ql(i)}function jl(e,i,l){if(typeof e.animate>"u")return{finished:Promise.resolve()};let h;try{h=e.animate(i,l)}catch{return{finished:Promise.resolve()}}return typeof h.finished>"u"&&(h.finished=new Promise(p=>{h.onfinish=()=>{p(h)}})),h}const Cp=new WeakMap;function yI(e,i){Object.keys(i).forEach(l=>{if(Ey(l)){const h=Aw(l),p=Cp.get(e);if(i[l]==null)p==null||p.forEach(_=>{const[m,o]=_;m===h&&(e.removeEventListener(h,o),p.delete(_))});else if(!p||![...p].some(_=>_[0]===h&&_[1]===i[l])){e.addEventListener(h,i[l]);const _=p||new Set;_.add([h,i[l]]),Cp.has(e)||Cp.set(e,_)}}else i[l]==null?e.removeAttribute(l):e.setAttribute(l,i[l])})}function vI(e,i){Object.keys(i).forEach(l=>{if(Ey(l)){const h=Aw(l),p=Cp.get(e);p==null||p.forEach(_=>{const[m,o]=_;m===h&&(e.removeEventListener(h,o),p.delete(_))})}else e.removeAttribute(l)})}const iu=2.4,Hb=.2126729,Zb=.7151522,qb=.072175,bI=.55,xI=.58,wI=.57,SI=.62,fp=.03,Wb=1.45,CI=5e-4,TI=1.25,PI=1.25,Xb=.078,Kb=12.82051282051282,pp=.06,Yb=.001;function Jb(e,i){const l=(e.r/255)**iu,h=(e.g/255)**iu,p=(e.b/255)**iu,_=(i.r/255)**iu,m=(i.g/255)**iu,o=(i.b/255)**iu;let T=l*Hb+h*Zb+p*qb,k=_*Hb+m*Zb+o*qb;if(T<=fp&&(T+=(fp-T)**Wb),k<=fp&&(k+=(fp-k)**Wb),Math.abs(k-T)<CI)return 0;let M;if(k>T){const D=(k**bI-T**xI)*TI;M=D<Yb?0:D<Xb?D-D*Kb*pp:D-pp}else{const D=(k**SI-T**wI)*PI;M=D>-Yb?0:D>-Xb?D-D*Kb*pp:D+pp}return M*100}function kI(e,i){i=Array.isArray(i)?i.slice(0,-1).map(l=>`'${l}'`).join(", ")+` or '${i.at(-1)}'`:`'${i}'`}const Hp=.20689655172413793,II=e=>e>Hp**3?Math.cbrt(e):e/(3*Hp**2)+4/29,MI=e=>e>Hp?e**3:3*Hp**2*(e-4/29);function Fw(e){const i=II,l=i(e[1]);return[116*l-16,500*(i(e[0]/.95047)-l),200*(l-i(e[2]/1.08883))]}function Ow(e){const i=MI,l=(e[0]+16)/116;return[i(l+e[1]/500)*.95047,i(l),i(l-e[2]/200)*1.08883]}const EI=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]],AI=e=>e<=.0031308?e*12.92:1.055*e**(1/2.4)-.055,RI=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],DI=e=>e<=.04045?e/12.92:((e+.055)/1.055)**2.4;function Vw(e){const i=Array(3),l=AI,h=EI;for(let p=0;p<3;++p)i[p]=Math.round(Ss(l(h[p][0]*e[0]+h[p][1]*e[1]+h[p][2]*e[2]))*255);return{r:i[0],g:i[1],b:i[2]}}function Dy(e){let{r:i,g:l,b:h}=e;const p=[0,0,0],_=DI,m=RI;i=_(i/255),l=_(l/255),h=_(h/255);for(let o=0;o<3;++o)p[o]=m[o][0]*i+m[o][1]*l+m[o][2]*h;return p}function j_(e){return!!e&&/^(#|var\(--|(rgb|hsl)a?\()/.test(e)}function zI(e){return j_(e)&&!/^((rgb|hsl)a?\()?var\(--/.test(e)}const Qb=/^(?<fn>(?:rgb|hsl)a?)\((?<values>.+)\)/,LI={rgb:(e,i,l,h)=>({r:e,g:i,b:l,a:h}),rgba:(e,i,l,h)=>({r:e,g:i,b:l,a:h}),hsl:(e,i,l,h)=>ex({h:e,s:i,l,a:h}),hsla:(e,i,l,h)=>ex({h:e,s:i,l,a:h}),hsv:(e,i,l,h)=>pd({h:e,s:i,v:l,a:h}),hsva:(e,i,l,h)=>pd({h:e,s:i,v:l,a:h})};function ws(e){if(typeof e=="number")return{r:(e&16711680)>>16,g:(e&65280)>>8,b:e&255};if(typeof e=="string"&&Qb.test(e)){const{groups:i}=e.match(Qb),{fn:l,values:h}=i,p=h.split(/,\s*/).map(_=>_.endsWith("%")&&["hsl","hsla","hsv","hsva"].includes(l)?parseFloat(_)/100:parseFloat(_));return LI[l](...p)}else if(typeof e=="string"){let i=e.startsWith("#")?e.slice(1):e;return[3,4].includes(i.length)?i=i.split("").map(l=>l+l).join(""):[6,8].includes(i.length),FI(i)}else if(typeof e=="object"){if(s_(e,["r","g","b"]))return e;if(s_(e,["h","s","l"]))return pd(Nw(e));if(s_(e,["h","s","v"]))return pd(e)}throw new TypeError(`Invalid color: ${e==null?e:String(e)||e.constructor.name}
Expected #hex, #hexa, rgb(), rgba(), hsl(), hsla(), object or number`)}function pd(e){const{h:i,s:l,v:h,a:p}=e,_=o=>{const T=(o+i/60)%6;return h-h*l*Math.max(Math.min(T,4-T,1),0)},m=[_(5),_(3),_(1)].map(o=>Math.round(o*255));return{r:m[0],g:m[1],b:m[2],a:p}}function ex(e){return pd(Nw(e))}function Nw(e){const{h:i,s:l,l:h,a:p}=e,_=h+l*Math.min(h,1-h),m=_===0?0:2-2*h/_;return{h:i,s:m,v:_,a:p}}function mp(e){const i=Math.round(e).toString(16);return("00".substr(0,2-i.length)+i).toUpperCase()}function BI(e){let{r:i,g:l,b:h,a:p}=e;return`#${[mp(i),mp(l),mp(h),p!==void 0?mp(Math.round(p*255)):""].join("")}`}function FI(e){e=OI(e);let[i,l,h,p]=fI(e,2).map(_=>parseInt(_,16));return p=p===void 0?p:p/255,{r:i,g:l,b:h,a:p}}function OI(e){return e.startsWith("#")&&(e=e.slice(1)),e=e.replace(/([^0-9a-f])/gi,"F"),(e.length===3||e.length===4)&&(e=e.split("").map(i=>i+i).join("")),e.length!==6&&(e=Ob(Ob(e,6),8,"F")),e}function VI(e,i){const l=Fw(Dy(e));return l[0]=l[0]+i*10,Vw(Ow(l))}function NI(e,i){const l=Fw(Dy(e));return l[0]=l[0]-i*10,Vw(Ow(l))}function $I(e){const i=ws(e);return Dy(i)[1]}function $w(e){const i=Math.abs(Jb(ws(0),ws(e)));return Math.abs(Jb(ws(16777215),ws(e)))>Math.min(i,50)?"#fff":"#000"}function Ct(e,i){return l=>Object.keys(e).reduce((h,p)=>{const m=typeof e[p]=="object"&&e[p]!=null&&!Array.isArray(e[p])?e[p]:{type:e[p]};return l&&p in l?h[p]={...m,default:l[p]}:h[p]=m,i&&!h[p].source&&(h[p].source=i),h},{})}const xn=Ct({class:[String,Array,Object],style:{type:[String,Array,Object],default:null}},"component");function Gi(e,i){const l=mm();if(!l)throw new Error(`[Vuetify] ${e} ${i||"must be called from inside a setup function"}`);return l}function Ps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"composables";const i=Gi(e).type;return Zl((i==null?void 0:i.aliasName)||(i==null?void 0:i.name))}let jw=0,Tp=new WeakMap;function wa(){const e=Gi("getUid");if(Tp.has(e))return Tp.get(e);{const i=jw++;return Tp.set(e,i),i}}wa.reset=()=>{jw=0,Tp=new WeakMap};function jI(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Gi("injectSelf");const{provides:l}=i;if(l&&e in l)return l[e]}const pu=Symbol.for("vuetify:defaults");function UI(e){return Ye(e)}function zy(){const e=ni(pu);if(!e)throw new Error("[Vuetify] Could not find defaults instance");return e}function Qo(e,i){const l=zy(),h=Ye(e),p=ue(()=>{if(H(i==null?void 0:i.disabled))return l.value;const m=H(i==null?void 0:i.scoped),o=H(i==null?void 0:i.reset),T=H(i==null?void 0:i.root);if(h.value==null&&!(m||o||T))return l.value;let k=Fr(h.value,{prev:l.value});if(m)return k;if(o||T){const M=Number(o||1/0);for(let D=0;D<=M&&!(!k||!("prev"in k));D++)k=k.prev;return k&&typeof T=="string"&&T in k&&(k=Fr(Fr(k,{prev:k}),k[T])),k}return k.prev?Fr(k.prev,k):k});return Ir(pu,p),p}function GI(e,i){var l,h;return typeof((l=e.props)==null?void 0:l[i])<"u"||typeof((h=e.props)==null?void 0:h[Zl(i)])<"u"}function HI(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:zy();const h=Gi("useDefaults");if(i=i??h.type.name??h.type.__name,!i)throw new Error("[Vuetify] Could not determine component name");const p=ue(()=>{var T;return(T=l.value)==null?void 0:T[e._as??i]}),_=new Proxy(e,{get(T,k){var D,O,z,F,N,q,oe;const M=Reflect.get(T,k);return k==="class"||k==="style"?[(D=p.value)==null?void 0:D[k],M].filter(_e=>_e!=null):typeof k=="string"&&!GI(h.vnode,k)?((O=p.value)==null?void 0:O[k])!==void 0?(z=p.value)==null?void 0:z[k]:((N=(F=l.value)==null?void 0:F.global)==null?void 0:N[k])!==void 0?(oe=(q=l.value)==null?void 0:q.global)==null?void 0:oe[k]:M:M}}),m=an();xa(()=>{if(p.value){const T=Object.entries(p.value).filter(k=>{let[M]=k;return M.startsWith(M[0].toUpperCase())});m.value=T.length?Object.fromEntries(T):void 0}else m.value=void 0});function o(){const T=jI(pu,h);Ir(pu,ue(()=>m.value?Fr((T==null?void 0:T.value)??{},m.value):T==null?void 0:T.value))}return{props:_,provideSubDefaults:o}}function yu(e){if(e._setup=e._setup??e.setup,!e.name)return e;if(e._setup){e.props=Ct(e.props??{},e.name)();const i=Object.keys(e.props).filter(l=>l!=="class"&&l!=="style");e.filterProps=function(h){return Iw(h,i)},e.props._as=String,e.setup=function(h,p){const _=zy();if(!_.value)return e._setup(h,p);const{props:m,provideSubDefaults:o}=HI(h,h._as??e.name,_),T=e._setup(m,p);return o(),T}}return e}function qt(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return i=>(e?yu:Un)(i)}function vm(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"div",l=arguments.length>2?arguments[2]:void 0;return qt()({name:l??io(aa(e.replace(/__/g,"-"))),props:{tag:{type:String,default:i},...xn()},setup(h,p){let{slots:_}=p;return()=>{var m;return Jo(h.tag,{class:[e,h.class],style:h.style},(m=_.default)==null?void 0:m.call(_))}}})}function Uw(e){if(typeof e.getRootNode!="function"){for(;e.parentNode;)e=e.parentNode;return e!==document?null:document}const i=e.getRootNode();return i!==document&&i.getRootNode({composed:!0})!==document?null:i}const md="cubic-bezier(0.4, 0, 0.2, 1)",ZI="cubic-bezier(0.0, 0, 0.2, 1)",qI="cubic-bezier(0.4, 0, 1, 1)";function Gw(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;for(;e;){if(i?WI(e):Ly(e))return e;e=e.parentElement}return document.scrollingElement}function Zp(e,i){const l=[];if(i&&e&&!i.contains(e))return l;for(;e&&(Ly(e)&&l.push(e),e!==i);)e=e.parentElement;return l}function Ly(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const i=window.getComputedStyle(e);return i.overflowY==="scroll"||i.overflowY==="auto"&&e.scrollHeight>e.clientHeight}function WI(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const i=window.getComputedStyle(e);return["scroll","auto"].includes(i.overflowY)}function XI(e){for(;e;){if(window.getComputedStyle(e).position==="fixed")return!0;e=e.offsetParent}return!1}function dn(e){const i=Gi("useRender");i.render=e}const KI=Ct({disabled:Boolean,group:Boolean,hideOnLeave:Boolean,leaveAbsolute:Boolean,mode:String,origin:String},"transition");function Sa(e,i,l){return qt()({name:e,props:KI({mode:l,origin:i}),setup(h,p){let{slots:_}=p;const m={onBeforeEnter(o){h.origin&&(o.style.transformOrigin=h.origin)},onLeave(o){if(h.leaveAbsolute){const{offsetTop:T,offsetLeft:k,offsetWidth:M,offsetHeight:D}=o;o._transitionInitialStyles={position:o.style.position,top:o.style.top,left:o.style.left,width:o.style.width,height:o.style.height},o.style.position="absolute",o.style.top=`${T}px`,o.style.left=`${k}px`,o.style.width=`${M}px`,o.style.height=`${D}px`}h.hideOnLeave&&o.style.setProperty("display","none","important")},onAfterLeave(o){if(h.leaveAbsolute&&(o!=null&&o._transitionInitialStyles)){const{position:T,top:k,left:M,width:D,height:O}=o._transitionInitialStyles;delete o._transitionInitialStyles,o.style.position=T||"",o.style.top=k||"",o.style.left=M||"",o.style.width=D||"",o.style.height=O||""}}};return()=>{const o=h.group?Py:Cs;return Jo(o,{name:h.disabled?"":e,css:!h.disabled,...h.group?void 0:{mode:h.mode},...h.disabled?{}:m},_.default)}}})}function Hw(e,i){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"in-out";return qt()({name:e,props:{mode:{type:String,default:l},disabled:Boolean,group:Boolean},setup(h,p){let{slots:_}=p;const m=h.group?Py:Cs;return()=>Jo(m,{name:h.disabled?"":e,css:!h.disabled,...h.disabled?{}:i},_.default)}})}function Zw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const l=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?"width":"height",h=aa(`offset-${l}`);return{onBeforeEnter(m){m._parent=m.parentNode,m._initialStyle={transition:m.style.transition,overflow:m.style.overflow,[l]:m.style[l]}},onEnter(m){const o=m._initialStyle;m.style.setProperty("transition","none","important"),m.style.overflow="hidden";const T=`${m[h]}px`;m.style[l]="0",m.offsetHeight,m.style.transition=o.transition,e&&m._parent&&m._parent.classList.add(e),requestAnimationFrame(()=>{m.style[l]=T})},onAfterEnter:_,onEnterCancelled:_,onLeave(m){m._initialStyle={transition:"",overflow:m.style.overflow,[l]:m.style[l]},m.style.overflow="hidden",m.style[l]=`${m[h]}px`,m.offsetHeight,requestAnimationFrame(()=>m.style[l]="0")},onAfterLeave:p,onLeaveCancelled:p};function p(m){e&&m._parent&&m._parent.classList.remove(e),_(m)}function _(m){const o=m._initialStyle[l];m.style.overflow=m._initialStyle.overflow,o!=null&&(m.style[l]=o),delete m._initialStyle}}const YI=Ct({target:[Object,Array]},"v-dialog-transition"),By=qt()({name:"VDialogTransition",props:YI(),setup(e,i){let{slots:l}=i;const h={onBeforeEnter(p){p.style.pointerEvents="none",p.style.visibility="hidden"},async onEnter(p,_){var O;await new Promise(z=>requestAnimationFrame(z)),await new Promise(z=>requestAnimationFrame(z)),p.style.visibility="";const{x:m,y:o,sx:T,sy:k,speed:M}=nx(e.target,p),D=jl(p,[{transform:`translate(${m}px, ${o}px) scale(${T}, ${k})`,opacity:0},{}],{duration:225*M,easing:ZI});(O=tx(p))==null||O.forEach(z=>{jl(z,[{opacity:0},{opacity:0,offset:.33},{}],{duration:225*2*M,easing:md})}),D.finished.then(()=>_())},onAfterEnter(p){p.style.removeProperty("pointer-events")},onBeforeLeave(p){p.style.pointerEvents="none"},async onLeave(p,_){var O;await new Promise(z=>requestAnimationFrame(z));const{x:m,y:o,sx:T,sy:k,speed:M}=nx(e.target,p);jl(p,[{},{transform:`translate(${m}px, ${o}px) scale(${T}, ${k})`,opacity:0}],{duration:125*M,easing:qI}).finished.then(()=>_()),(O=tx(p))==null||O.forEach(z=>{jl(z,[{},{opacity:0,offset:.2},{opacity:0}],{duration:125*2*M,easing:md})})},onAfterLeave(p){p.style.removeProperty("pointer-events")}};return()=>e.target?A(Cs,sn({name:"dialog-transition"},h,{css:!1}),l):A(Cs,{name:"dialog-transition"},l)}});function tx(e){var l;const i=(l=e.querySelector(":scope > .v-card, :scope > .v-sheet, :scope > .v-list"))==null?void 0:l.children;return i&&[...i]}function nx(e,i){const l=Bw(e),h=Ry(i),[p,_]=getComputedStyle(i).transformOrigin.split(" ").map(oe=>parseFloat(oe)),[m,o]=getComputedStyle(i).getPropertyValue("--v-overlay-anchor-origin").split(" ");let T=l.left+l.width/2;m==="left"||o==="left"?T-=l.width/2:(m==="right"||o==="right")&&(T+=l.width/2);let k=l.top+l.height/2;m==="top"||o==="top"?k-=l.height/2:(m==="bottom"||o==="bottom")&&(k+=l.height/2);const M=l.width/h.width,D=l.height/h.height,O=Math.max(1,M,D),z=M/O||0,F=D/O||0,N=h.width*h.height/(window.innerWidth*window.innerHeight),q=N>.12?Math.min(1.5,(N-.12)*10+1):1;return{x:T-(p+h.left),y:k-(_+h.top),sx:z,sy:F,speed:q}}Sa("fab-transition","center center","out-in");Sa("dialog-bottom-transition");Sa("dialog-top-transition");const ix=Sa("fade-transition"),JI=Sa("scale-transition");Sa("scroll-x-transition");Sa("scroll-x-reverse-transition");Sa("scroll-y-transition");Sa("scroll-y-reverse-transition");Sa("slide-x-transition");Sa("slide-x-reverse-transition");const qw=Sa("slide-y-transition");Sa("slide-y-reverse-transition");const QI=Hw("expand-transition",Zw()),Ww=Hw("expand-x-transition",Zw("",!0));const eM=Ct({defaults:Object,disabled:Boolean,reset:[Number,String],root:[Boolean,String],scoped:Boolean},"VDefaultsProvider"),Bi=qt(!1)({name:"VDefaultsProvider",props:eM(),setup(e,i){let{slots:l}=i;const{defaults:h,disabled:p,reset:_,root:m,scoped:o}=um(e);return Qo(h,{reset:_,root:m,scoped:o,disabled:p}),()=>{var T;return(T=l.default)==null?void 0:T.call(l)}}});function Fy(e){return Ay(()=>{const i=[],l={};if(e.value.background)if(j_(e.value.background)){if(l.backgroundColor=e.value.background,!e.value.text&&zI(e.value.background)){const h=ws(e.value.background);if(h.a==null||h.a===1){const p=$w(h);l.color=p,l.caretColor=p}}}else i.push(`bg-${e.value.background}`);return e.value.text&&(j_(e.value.text)?(l.color=e.value.text,l.caretColor=e.value.text):i.push(`text-${e.value.text}`)),{colorClasses:i,colorStyles:l}})}function as(e,i){const l=ue(()=>({text:ci(e)?e.value:i?e[i]:null})),{colorClasses:h,colorStyles:p}=Fy(l);return{textColorClasses:h,textColorStyles:p}}function La(e,i){const l=ue(()=>({background:ci(e)?e.value:i?e[i]:null})),{colorClasses:h,colorStyles:p}=Fy(l);return{backgroundColorClasses:h,backgroundColorStyles:p}}const tM={collapse:"mdi-chevron-up",complete:"mdi-check",cancel:"mdi-close-circle",close:"mdi-close",delete:"mdi-close-circle",clear:"mdi-close-circle",success:"mdi-check-circle",info:"mdi-information",warning:"mdi-alert-circle",error:"mdi-close-circle",prev:"mdi-chevron-left",next:"mdi-chevron-right",checkboxOn:"mdi-checkbox-marked",checkboxOff:"mdi-checkbox-blank-outline",checkboxIndeterminate:"mdi-minus-box",delimiter:"mdi-circle",sortAsc:"mdi-arrow-up",sortDesc:"mdi-arrow-down",expand:"mdi-chevron-down",menu:"mdi-menu",subgroup:"mdi-menu-down",dropdown:"mdi-menu-down",radioOn:"mdi-radiobox-marked",radioOff:"mdi-radiobox-blank",edit:"mdi-pencil",ratingEmpty:"mdi-star-outline",ratingFull:"mdi-star",ratingHalf:"mdi-star-half-full",loading:"mdi-cached",first:"mdi-page-first",last:"mdi-page-last",unfold:"mdi-unfold-more-horizontal",file:"mdi-paperclip",plus:"mdi-plus",minus:"mdi-minus",calendar:"mdi-calendar",treeviewCollapse:"mdi-menu-down",treeviewExpand:"mdi-menu-right",eyeDropper:"mdi-eyedropper",upload:"mdi-cloud-upload"},nM={component:e=>Jo(Kw,{...e,class:"mdi"})},jn=[String,Function,Object,Array],U_=Symbol.for("vuetify:icons"),bm=Ct({icon:{type:jn},tag:{type:String,required:!0}},"icon"),rx=qt()({name:"VComponentIcon",props:bm(),setup(e,i){let{slots:l}=i;return()=>{const h=e.icon;return A(e.tag,null,{default:()=>{var p;return[e.icon?A(h,null,null):(p=l.default)==null?void 0:p.call(l)]}})}}}),Xw=yu({name:"VSvgIcon",inheritAttrs:!1,props:bm(),setup(e,i){let{attrs:l}=i;return()=>A(e.tag,sn(l,{style:null}),{default:()=>[A("svg",{class:"v-icon__svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",role:"img","aria-hidden":"true"},[Array.isArray(e.icon)?e.icon.map(h=>Array.isArray(h)?A("path",{d:h[0],"fill-opacity":h[1]},null):A("path",{d:h},null)):A("path",{d:e.icon},null)])]})}});yu({name:"VLigatureIcon",props:bm(),setup(e){return()=>A(e.tag,null,{default:()=>[e.icon]})}});const Kw=yu({name:"VClassIcon",props:bm(),setup(e){return()=>A(e.tag,{class:e.icon},null)}});function iM(){return{svg:{component:Xw},class:{component:Kw}}}function rM(e){const i=iM(),l=(e==null?void 0:e.defaultSet)??"mdi";return l==="mdi"&&!i.mdi&&(i.mdi=nM),Fr({defaultSet:l,sets:i,aliases:{...tM,vuetify:["M8.2241 14.2009L12 21L22 3H14.4459L8.2241 14.2009Z",["M7.26303 12.4733L7.00113 12L2 3H12.5261C12.5261 3 12.5261 3 12.5261 3L7.26303 12.4733Z",.6]],"vuetify-outline":"svg:M7.26 12.47 12.53 3H2L7.26 12.47ZM14.45 3 8.22 14.2 12 21 22 3H14.45ZM18.6 5 12 16.88 10.51 14.2 15.62 5ZM7.26 8.35 5.4 5H9.13L7.26 8.35Z","vuetify-play":["m6.376 13.184-4.11-7.192C1.505 4.66 2.467 3 4.003 3h8.532l-.953 1.576-.006.01-.396.677c-.429.732-.214 1.507.194 2.015.404.503 1.092.878 1.869.806a3.72 3.72 0 0 1 1.005.022c.276.053.434.143.523.237.138.146.38.635-.25 2.09-.893 1.63-1.553 1.722-1.847 1.677-.213-.033-.468-.158-.756-.406a4.95 4.95 0 0 1-.8-.927c-.39-.564-1.04-.84-1.66-.846-.625-.006-1.316.27-1.693.921l-.478.826-.911 1.506Z",["M9.093 11.552c.046-.079.144-.15.32-.148a.53.53 0 0 1 .43.207c.285.414.636.847 1.046 1.2.405.35.914.662 1.516.754 1.334.205 2.502-.698 3.48-2.495l.014-.028.013-.03c.687-1.574.774-2.852-.005-3.675-.37-.391-.861-.586-1.333-.676a5.243 5.243 0 0 0-1.447-.044c-.173.016-.393-.073-.54-.257-.145-.18-.127-.316-.082-.392l.393-.672L14.287 3h5.71c1.536 0 2.499 1.659 1.737 2.992l-7.997 13.996c-.768 1.344-2.706 1.344-3.473 0l-3.037-5.314 1.377-2.278.004-.006.004-.007.481-.831Z",.6]]}},e)}const aM=e=>{const i=ni(U_);if(!i)throw new Error("Missing Vuetify Icons provide!");return{iconData:ue(()=>{var T;const h=H(e);if(!h)return{component:rx};let p=h;if(typeof p=="string"&&(p=p.trim(),p.startsWith("$")&&(p=(T=i.aliases)==null?void 0:T[p.slice(1)])),Array.isArray(p))return{component:Xw,icon:p};if(typeof p!="string")return{component:rx,icon:p};const _=Object.keys(i.sets).find(k=>typeof p=="string"&&p.startsWith(`${k}:`)),m=_?p.slice(_.length+1):p;return{component:i.sets[_??i.defaultSet].component,icon:m}})}},sM=["x-small","small","default","large","x-large"],Ed=Ct({size:{type:[String,Number],default:"default"}},"size");function Ad(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ps();return Ay(()=>{let l,h;return Up(sM,e.size)?l=`${i}--size-${e.size}`:e.size&&(h={width:mn(e.size),height:mn(e.size)}),{sizeClasses:l,sizeStyles:h}})}const Ti=Ct({tag:{type:String,default:"div"}},"tag"),gd=Symbol.for("vuetify:theme"),Di=Ct({theme:String},"theme");function ax(){return{defaultTheme:"light",variations:{colors:[],lighten:0,darken:0},themes:{light:{dark:!1,colors:{background:"#FFFFFF",surface:"#FFFFFF","surface-bright":"#FFFFFF","surface-light":"#EEEEEE","surface-variant":"#424242","on-surface-variant":"#EEEEEE",primary:"#1867C0","primary-darken-1":"#1F5592",secondary:"#48A9A6","secondary-darken-1":"#018786",error:"#B00020",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#000000","border-opacity":.12,"high-emphasis-opacity":.87,"medium-emphasis-opacity":.6,"disabled-opacity":.38,"idle-opacity":.04,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.12,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#F5F5F5","theme-on-code":"#000000"}},dark:{dark:!0,colors:{background:"#121212",surface:"#212121","surface-bright":"#ccbfd6","surface-light":"#424242","surface-variant":"#a3a3a3","on-surface-variant":"#424242",primary:"#2196F3","primary-darken-1":"#277CC1",secondary:"#54B6B2","secondary-darken-1":"#48A9A6",error:"#CF6679",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#FFFFFF","border-opacity":.12,"high-emphasis-opacity":1,"medium-emphasis-opacity":.7,"disabled-opacity":.5,"idle-opacity":.1,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.16,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#343434","theme-on-code":"#CCCCCC"}}}}}function oM(){var h,p;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ax();const i=ax();if(!e)return{...i,isDisabled:!0};const l={};for(const[_,m]of Object.entries(e.themes??{})){const o=m.dark||_==="dark"?(h=i.themes)==null?void 0:h.dark:(p=i.themes)==null?void 0:p.light;l[_]=Fr(o,m)}return Fr(i,{...e,themes:l})}function lM(e){const i=oM(e),l=Ye(i.defaultTheme),h=Ye(i.themes),p=ue(()=>{const M={};for(const[D,O]of Object.entries(h.value)){const z=M[D]={...O,colors:{...O.colors}};if(i.variations)for(const F of i.variations.colors){const N=z.colors[F];if(N)for(const q of["lighten","darken"]){const oe=q==="lighten"?VI:NI;for(const _e of Pw(i.variations[q],1))z.colors[`${F}-${q}-${_e}`]=BI(oe(ws(N),_e))}}for(const F of Object.keys(z.colors)){if(/^on-[a-z]/.test(F)||z.colors[`on-${F}`])continue;const N=`on-${F}`,q=ws(z.colors[F]);z.colors[N]=$w(q)}}return M}),_=ue(()=>p.value[l.value]),m=ue(()=>{var F;const M=[];(F=_.value)!=null&&F.dark&&Vl(M,":root",["color-scheme: dark"]),Vl(M,":root",sx(_.value));for(const[N,q]of Object.entries(p.value))Vl(M,`.v-theme--${N}`,[`color-scheme: ${q.dark?"dark":"normal"}`,...sx(q)]);const D=[],O=[],z=new Set(Object.values(p.value).flatMap(N=>Object.keys(N.colors)));for(const N of z)/^on-[a-z]/.test(N)?Vl(O,`.${N}`,[`color: rgb(var(--v-theme-${N})) !important`]):(Vl(D,`.bg-${N}`,[`--v-theme-overlay-multiplier: var(--v-theme-${N}-overlay-multiplier)`,`background-color: rgb(var(--v-theme-${N})) !important`,`color: rgb(var(--v-theme-on-${N})) !important`]),Vl(O,`.text-${N}`,[`color: rgb(var(--v-theme-${N})) !important`]),Vl(O,`.border-${N}`,[`--v-border-color: var(--v-theme-${N})`]));return M.push(...D,...O),M.map((N,q)=>q===0?N:`    ${N}`).join("")});function o(){return{style:[{children:m.value,id:"vuetify-theme-stylesheet",nonce:i.cspNonce||!1}]}}function T(M){if(i.isDisabled)return;const D=M._context.provides.usehead;if(D)if(D.push){const O=D.push(o);Zn&&Qt(m,()=>{O.patch(o)})}else Zn?(D.addHeadObjs(ue(o)),xa(()=>D.updateDOM())):D.addHeadObjs(o());else{let z=function(){if(typeof document<"u"&&!O){const F=document.createElement("style");F.type="text/css",F.id="vuetify-theme-stylesheet",i.cspNonce&&F.setAttribute("nonce",i.cspNonce),O=F,document.head.appendChild(O)}O&&(O.innerHTML=m.value)},O=Zn?document.getElementById("vuetify-theme-stylesheet"):null;Zn?Qt(m,z,{immediate:!0}):z()}}const k=ue(()=>i.isDisabled?void 0:`v-theme--${l.value}`);return{install:T,isDisabled:i.isDisabled,name:l,themes:h,current:_,computedThemes:p,themeClasses:k,styles:m,global:{name:l,current:_}}}function Hi(e){Gi("provideTheme");const i=ni(gd,null);if(!i)throw new Error("Could not find Vuetify theme injection");const l=ue(()=>e.theme??i.name.value),h=ue(()=>i.themes.value[l.value]),p=ue(()=>i.isDisabled?void 0:`v-theme--${l.value}`),_={...i,name:l,current:h,themeClasses:p};return Ir(gd,_),_}function Yw(){Gi("useTheme");const e=ni(gd,null);if(!e)throw new Error("Could not find Vuetify theme injection");return e}function Vl(e,i,l){e.push(`${i} {
`,...l.map(h=>`  ${h};
`),`}
`)}function sx(e){const i=e.dark?2:1,l=e.dark?1:2,h=[];for(const[p,_]of Object.entries(e.colors)){const m=ws(_);h.push(`--v-theme-${p}: ${m.r},${m.g},${m.b}`),p.startsWith("on-")||h.push(`--v-theme-${p}-overlay-multiplier: ${$I(_)>.18?i:l}`)}for(const[p,_]of Object.entries(e.variables)){const m=typeof _=="string"&&_.startsWith("#")?ws(_):void 0,o=m?`${m.r}, ${m.g}, ${m.b}`:void 0;h.push(`--v-${p}: ${o??_}`)}return h}const cM=Ct({color:String,disabled:Boolean,start:Boolean,end:Boolean,icon:jn,...xn(),...Ed(),...Ti({tag:"i"}),...Di()},"VIcon"),li=qt()({name:"VIcon",props:cM(),setup(e,i){let{attrs:l,slots:h}=i;const p=Ye(),{themeClasses:_}=Hi(e),{iconData:m}=aM(ue(()=>p.value||e.icon)),{sizeClasses:o}=Ad(e),{textColorClasses:T,textColorStyles:k}=as(nn(e,"color"));return dn(()=>{var O,z;const M=(O=h.default)==null?void 0:O.call(h);M&&(p.value=(z=Ew(M).filter(F=>F.type===Id&&F.children&&typeof F.children=="string")[0])==null?void 0:z.children);const D=!!(l.onClick||l.onClickOnce);return A(m.value.component,{tag:e.tag,icon:m.value.icon,class:["v-icon","notranslate",_.value,o.value,T.value,{"v-icon--clickable":D,"v-icon--disabled":e.disabled,"v-icon--start":e.start,"v-icon--end":e.end},e.class],style:[o.value?void 0:{fontSize:mn(e.size),height:mn(e.size),width:mn(e.size)},k.value,e.style],role:D?"button":void 0,"aria-hidden":!D,tabindex:D?e.disabled?-1:0:void 0},{default:()=>[M]})}),{}}});const Oa=Ct({height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],minHeight:[Number,String],minWidth:[Number,String],width:[Number,String]},"dimension");function Va(e){return{dimensionStyles:ue(()=>{const l={},h=mn(e.height),p=mn(e.maxHeight),_=mn(e.maxWidth),m=mn(e.minHeight),o=mn(e.minWidth),T=mn(e.width);return h!=null&&(l.height=h),p!=null&&(l.maxHeight=p),_!=null&&(l.maxWidth=_),m!=null&&(l.minHeight=m),o!=null&&(l.minWidth=o),T!=null&&(l.width=T),l})}}function uM(e){return{aspectStyles:ue(()=>{const i=Number(e.aspectRatio);return i?{paddingBottom:String(1/i*100)+"%"}:void 0})}}const Jw=Ct({aspectRatio:[String,Number],contentClass:null,inline:Boolean,...xn(),...Oa()},"VResponsive"),ox=qt()({name:"VResponsive",props:Jw(),setup(e,i){let{slots:l}=i;const{aspectStyles:h}=uM(e),{dimensionStyles:p}=Va(e);return dn(()=>{var _;return A("div",{class:["v-responsive",{"v-responsive--inline":e.inline},e.class],style:[p.value,e.style]},[A("div",{class:"v-responsive__sizer",style:h.value},null),(_=l.additional)==null?void 0:_.call(l),l.default&&A("div",{class:["v-responsive__content",e.contentClass]},[l.default()])])}),{}}}),oa=Ct({rounded:{type:[Boolean,Number,String],default:void 0},tile:Boolean},"rounded");function la(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ps();return{roundedClasses:ue(()=>{const h=ci(e)?e.value:e.rounded,p=ci(e)?e.value:e.tile,_=[];if(h===!0||h==="")_.push(`${i}--rounded`);else if(typeof h=="string"||h===0)for(const m of String(h).split(" "))_.push(`rounded-${m}`);else(p||h===!1)&&_.push("rounded-0");return _})}}const Rd=Ct({transition:{type:[Boolean,String,Object],default:"fade-transition",validator:e=>e!==!0}},"transition"),eo=(e,i)=>{let{slots:l}=i;const{transition:h,disabled:p,group:_,...m}=e,{component:o=_?Py:Cs,...T}=typeof h=="object"?h:{};return Jo(o,sn(typeof h=="string"?{name:p?"":h}:T,typeof h=="string"?{}:Object.fromEntries(Object.entries({disabled:p,group:_}).filter(k=>{let[M,D]=k;return D!==void 0})),m),l)};function hM(e,i){if(!ky)return;const l=i.modifiers||{},h=i.value,{handler:p,options:_}=typeof h=="object"?h:{handler:h,options:{}},m=new IntersectionObserver(function(){var D;let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],T=arguments.length>1?arguments[1]:void 0;const k=(D=e._observe)==null?void 0:D[i.instance.$.uid];if(!k)return;const M=o.some(O=>O.isIntersecting);p&&(!l.quiet||k.init)&&(!l.once||M||k.init)&&p(M,o,T),M&&l.once?Qw(e,i):k.init=!0},_);e._observe=Object(e._observe),e._observe[i.instance.$.uid]={init:!1,observer:m},m.observe(e)}function Qw(e,i){var h;const l=(h=e._observe)==null?void 0:h[i.instance.$.uid];l&&(l.observer.unobserve(e),delete e._observe[i.instance.$.uid])}const dM={mounted:hM,unmounted:Qw},Oy=dM,fM=Ct({absolute:Boolean,alt:String,cover:Boolean,color:String,draggable:{type:[Boolean,String],default:void 0},eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},sizes:String,src:{type:[String,Object],default:""},crossorigin:String,referrerpolicy:String,srcset:String,position:String,...Jw(),...xn(),...oa(),...Rd()},"VImg"),Vy=qt()({name:"VImg",directives:{intersect:Oy},props:fM(),emits:{loadstart:e=>!0,load:e=>!0,error:e=>!0},setup(e,i){let{emit:l,slots:h}=i;const{backgroundColorClasses:p,backgroundColorStyles:_}=La(nn(e,"color")),{roundedClasses:m}=la(e),o=Gi("VImg"),T=an(""),k=Ye(),M=an(e.eager?"loading":"idle"),D=an(),O=an(),z=ue(()=>e.src&&typeof e.src=="object"?{src:e.src.src,srcset:e.srcset||e.src.srcset,lazySrc:e.lazySrc||e.src.lazySrc,aspect:Number(e.aspectRatio||e.src.aspect||0)}:{src:e.src,srcset:e.srcset,lazySrc:e.lazySrc,aspect:Number(e.aspectRatio||0)}),F=ue(()=>z.value.aspect||D.value/O.value||0);Qt(()=>e.src,()=>{N(M.value!=="idle")}),Qt(F,(xe,Fe)=>{!xe&&Fe&&k.value&&pe(k.value)}),Pd(()=>N());function N(xe){if(!(e.eager&&xe)&&!(ky&&!xe&&!e.eager)){if(M.value="loading",z.value.lazySrc){const Fe=new Image;Fe.src=z.value.lazySrc,pe(Fe,null)}z.value.src&&Fi(()=>{var Fe;l("loadstart",((Fe=k.value)==null?void 0:Fe.currentSrc)||z.value.src),setTimeout(()=>{var We;if(!o.isUnmounted)if((We=k.value)!=null&&We.complete){if(k.value.naturalWidth||oe(),M.value==="error")return;F.value||pe(k.value,null),M.value==="loading"&&q()}else F.value||pe(k.value),_e()})})}}function q(){var xe;o.isUnmounted||(_e(),pe(k.value),M.value="loaded",l("load",((xe=k.value)==null?void 0:xe.currentSrc)||z.value.src))}function oe(){var xe;o.isUnmounted||(M.value="error",l("error",((xe=k.value)==null?void 0:xe.currentSrc)||z.value.src))}function _e(){const xe=k.value;xe&&(T.value=xe.currentSrc||xe.src)}let Se=-1;kr(()=>{clearTimeout(Se)});function pe(xe){let Fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;const We=()=>{if(clearTimeout(Se),o.isUnmounted)return;const{naturalHeight:ht,naturalWidth:Ne}=xe;ht||Ne?(D.value=Ne,O.value=ht):!xe.complete&&M.value==="loading"&&Fe!=null?Se=window.setTimeout(We,Fe):(xe.currentSrc.endsWith(".svg")||xe.currentSrc.startsWith("data:image/svg+xml"))&&(D.value=1,O.value=1)};We()}const be=ue(()=>({"v-img__img--cover":e.cover,"v-img__img--contain":!e.cover})),de=()=>{var We;if(!z.value.src||M.value==="idle")return null;const xe=A("img",{class:["v-img__img",be.value],style:{objectPosition:e.position},src:z.value.src,srcset:z.value.srcset,alt:e.alt,crossorigin:e.crossorigin,referrerpolicy:e.referrerpolicy,draggable:e.draggable,sizes:e.sizes,ref:k,onLoad:q,onError:oe},null),Fe=(We=h.sources)==null?void 0:We.call(h);return A(eo,{transition:e.transition,appear:!0},{default:()=>[Tr(Fe?A("picture",{class:"v-img__picture"},[Fe,xe]):xe,[[Ql,M.value==="loaded"]])]})},Ce=()=>A(eo,{transition:e.transition},{default:()=>[z.value.lazySrc&&M.value!=="loaded"&&A("img",{class:["v-img__img","v-img__img--preload",be.value],style:{objectPosition:e.position},src:z.value.lazySrc,alt:e.alt,crossorigin:e.crossorigin,referrerpolicy:e.referrerpolicy,draggable:e.draggable},null)]}),ye=()=>h.placeholder?A(eo,{transition:e.transition,appear:!0},{default:()=>[(M.value==="loading"||M.value==="error"&&!h.error)&&A("div",{class:"v-img__placeholder"},[h.placeholder()])]}):null,Me=()=>h.error?A(eo,{transition:e.transition,appear:!0},{default:()=>[M.value==="error"&&A("div",{class:"v-img__error"},[h.error()])]}):null,ke=()=>e.gradient?A("div",{class:"v-img__gradient",style:{backgroundImage:`linear-gradient(${e.gradient})`}},null):null,Ee=an(!1);{const xe=Qt(F,Fe=>{Fe&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{Ee.value=!0})}),xe())})}return dn(()=>{const xe=ox.filterProps(e);return Tr(A(ox,sn({class:["v-img",{"v-img--absolute":e.absolute,"v-img--booting":!Ee.value},p.value,m.value,e.class],style:[{width:mn(e.width==="auto"?D.value:e.width)},_.value,e.style]},xe,{aspectRatio:F.value,"aria-label":e.alt,role:e.alt?"img":void 0}),{additional:()=>A(cn,null,[A(de,null,null),A(Ce,null,null),A(ke,null,null),A(ye,null,null),A(Me,null,null)]),default:h.default}),[[ao("intersect"),{handler:N,options:e.options},null,{once:!0}]])}),{currentSrc:T,image:k,state:M,naturalWidth:D,naturalHeight:O}}}),so=Ct({border:[Boolean,Number,String]},"border");function oo(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ps();return{borderClasses:ue(()=>{const h=ci(e)?e.value:e.border,p=[];if(h===!0||h==="")p.push(`${i}--border`);else if(typeof h=="string"||h===0)for(const _ of String(h).split(" "))p.push(`border-${_}`);return p})}}const pM=[null,"default","comfortable","compact"],Ca=Ct({density:{type:String,default:"default",validator:e=>pM.includes(e)}},"density");function Na(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ps();return{densityClasses:ue(()=>`${i}--density-${e.density}`)}}const mM=["elevated","flat","tonal","outlined","text","plain"];function ec(e,i){return A(cn,null,[e&&A("span",{key:"overlay",class:`${i}__overlay`},null),A("span",{key:"underlay",class:`${i}__underlay`},null)])}const ks=Ct({color:String,variant:{type:String,default:"elevated",validator:e=>mM.includes(e)}},"variant");function tc(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ps();const l=ue(()=>{const{variant:_}=H(e);return`${i}--variant-${_}`}),{colorClasses:h,colorStyles:p}=Fy(ue(()=>{const{variant:_,color:m}=H(e);return{[["elevated","flat"].includes(_)?"background":"text"]:m}}));return{colorClasses:h,colorStyles:p,variantClasses:l}}const gM=Ct({start:Boolean,end:Boolean,icon:jn,image:String,text:String,...so(),...xn(),...Ca(),...oa(),...Ed(),...Ti(),...Di(),...ks({variant:"flat"})},"VAvatar"),Kl=qt()({name:"VAvatar",props:gM(),setup(e,i){let{slots:l}=i;const{themeClasses:h}=Hi(e),{borderClasses:p}=oo(e),{colorClasses:_,colorStyles:m,variantClasses:o}=tc(e),{densityClasses:T}=Na(e),{roundedClasses:k}=la(e),{sizeClasses:M,sizeStyles:D}=Ad(e);return dn(()=>A(e.tag,{class:["v-avatar",{"v-avatar--start":e.start,"v-avatar--end":e.end},h.value,p.value,_.value,T.value,k.value,M.value,o.value,e.class],style:[m.value,D.value,e.style]},{default:()=>[l.default?A(Bi,{key:"content-defaults",defaults:{VImg:{cover:!0,src:e.image},VIcon:{icon:e.icon}}},{default:()=>[l.default()]}):e.image?A(Vy,{key:"image",src:e.image,alt:"",cover:!0},null):e.icon?A(li,{key:"icon",icon:e.icon},null):e.text,ec(!1,"v-avatar")]})),{}}});const xm=["sm","md","lg","xl","xxl"],G_=Symbol.for("vuetify:display"),lx={mobileBreakpoint:"lg",thresholds:{xs:0,sm:600,md:960,lg:1280,xl:1920,xxl:2560}},_M=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:lx;return Fr(lx,e)};function cx(e){return Zn&&!e?window.innerWidth:typeof e=="object"&&e.clientWidth||0}function ux(e){return Zn&&!e?window.innerHeight:typeof e=="object"&&e.clientHeight||0}function hx(e){const i=Zn&&!e?window.navigator.userAgent:"ssr";function l(F){return!!i.match(F)}const h=l(/android/i),p=l(/iphone|ipad|ipod/i),_=l(/cordova/i),m=l(/electron/i),o=l(/chrome/i),T=l(/edge/i),k=l(/firefox/i),M=l(/opera/i),D=l(/win/i),O=l(/mac/i),z=l(/linux/i);return{android:h,ios:p,cordova:_,electron:m,chrome:o,edge:T,firefox:k,opera:M,win:D,mac:O,linux:z,touch:oI,ssr:i==="ssr"}}function yM(e,i){const{thresholds:l,mobileBreakpoint:h}=_M(e),p=an(ux(i)),_=an(hx(i)),m=yr({}),o=an(cx(i));function T(){p.value=ux(),o.value=cx()}function k(){T(),_.value=hx()}return xa(()=>{const M=o.value<l.sm,D=o.value<l.md&&!M,O=o.value<l.lg&&!(D||M),z=o.value<l.xl&&!(O||D||M),F=o.value<l.xxl&&!(z||O||D||M),N=o.value>=l.xxl,q=M?"xs":D?"sm":O?"md":z?"lg":F?"xl":"xxl",oe=typeof h=="number"?h:l[h],_e=o.value<oe;m.xs=M,m.sm=D,m.md=O,m.lg=z,m.xl=F,m.xxl=N,m.smAndUp=!M,m.mdAndUp=!(M||D),m.lgAndUp=!(M||D||O),m.xlAndUp=!(M||D||O||z),m.smAndDown=!(O||z||F||N),m.mdAndDown=!(z||F||N),m.lgAndDown=!(F||N),m.xlAndDown=!N,m.name=q,m.height=p.value,m.width=o.value,m.mobile=_e,m.mobileBreakpoint=h,m.platform=_.value,m.thresholds=l}),Zn&&window.addEventListener("resize",T,{passive:!0}),{...um(m),update:k,ssr:!!i}}const eS=Ct({mobile:{type:Boolean,default:!1},mobileBreakpoint:[Number,String]},"display");function wm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ps();const l=ni(G_);if(!l)throw new Error("Could not find Vuetify display injection");const h=ue(()=>{if(e.mobile!=null)return e.mobile;if(!e.mobileBreakpoint)return l.mobile.value;const _=typeof e.mobileBreakpoint=="number"?e.mobileBreakpoint:l.thresholds.value[e.mobileBreakpoint];return l.width.value<_}),p=ue(()=>i?{[`${i}--mobile`]:h.value}:{});return{...l,displayClasses:p,mobile:h}}function Ba(e,i){let l;function h(){l=Sd(),l.run(()=>i.length?i(()=>{l==null||l.stop(),h()}):i())}Qt(e,p=>{p&&!l?h():p||(l==null||l.stop(),l=void 0)},{immediate:!0}),Pr(()=>{l==null||l.stop()})}function ii(e,i,l){let h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:D=>D,p=arguments.length>4&&arguments[4]!==void 0?arguments[4]:D=>D;const _=Gi("useProxiedModel"),m=Ye(e[i]!==void 0?e[i]:l),o=Zl(i),k=ue(o!==i?()=>{var D,O,z,F;return e[i],!!(((D=_.vnode.props)!=null&&D.hasOwnProperty(i)||(O=_.vnode.props)!=null&&O.hasOwnProperty(o))&&((z=_.vnode.props)!=null&&z.hasOwnProperty(`onUpdate:${i}`)||(F=_.vnode.props)!=null&&F.hasOwnProperty(`onUpdate:${o}`)))}:()=>{var D,O;return e[i],!!((D=_.vnode.props)!=null&&D.hasOwnProperty(i)&&((O=_.vnode.props)!=null&&O.hasOwnProperty(`onUpdate:${i}`)))});Ba(()=>!k.value,()=>{Qt(()=>e[i],D=>{m.value=D})});const M=ue({get(){const D=e[i];return h(k.value?D:m.value)},set(D){const O=p(D),z=fn(k.value?e[i]:m.value);z===O||h(z)===D||(m.value=O,_==null||_.emit(`update:${i}`,O))}});return Object.defineProperty(M,"externalValue",{get:()=>k.value?e[i]:m.value}),M}const vM={badge:"Badge",open:"Open",close:"Close",dismiss:"Dismiss",confirmEdit:{ok:"OK",cancel:"Cancel"},dataIterator:{noResultsText:"No matching records found",loadingText:"Loading items..."},dataTable:{itemsPerPageText:"Rows per page:",ariaLabel:{sortDescending:"Sorted descending.",sortAscending:"Sorted ascending.",sortNone:"Not sorted.",activateNone:"Activate to remove sorting.",activateDescending:"Activate to sort descending.",activateAscending:"Activate to sort ascending."},sortBy:"Sort by"},dataFooter:{itemsPerPageText:"Items per page:",itemsPerPageAll:"All",nextPage:"Next page",prevPage:"Previous page",firstPage:"First page",lastPage:"Last page",pageText:"{0}-{1} of {2}"},dateRangeInput:{divider:"to"},datePicker:{itemsSelected:"{0} selected",range:{title:"Select dates",header:"Enter dates"},title:"Select date",header:"Enter date",input:{placeholder:"Enter date"}},noDataText:"No data available",carousel:{prev:"Previous visual",next:"Next visual",ariaLabel:{delimiter:"Carousel slide {0} of {1}"}},calendar:{moreEvents:"{0} more",today:"Today"},input:{clear:"Clear {0}",prependAction:"{0} prepended action",appendAction:"{0} appended action",otp:"Please enter OTP character {0}"},fileInput:{counter:"{0} files",counterSize:"{0} files ({1} in total)"},fileUpload:{title:"Drag and drop files here",divider:"or",browse:"Browse Files"},timePicker:{am:"AM",pm:"PM",title:"Select Time"},pagination:{ariaLabel:{root:"Pagination Navigation",next:"Next page",previous:"Previous page",page:"Go to page {0}",currentPage:"Page {0}, Current page",first:"First page",last:"Last page"}},stepper:{next:"Next",prev:"Previous"},rating:{ariaLabel:{item:"Rating {0} of {1}"}},loading:"Loading...",infiniteScroll:{loadMore:"Load more",empty:"No more"}},dx="$vuetify.",fx=(e,i)=>e.replace(/\{(\d+)\}/g,(l,h)=>String(i[+h])),tS=(e,i,l)=>function(h){for(var p=arguments.length,_=new Array(p>1?p-1:0),m=1;m<p;m++)_[m-1]=arguments[m];if(!h.startsWith(dx))return fx(h,_);const o=h.replace(dx,""),T=e.value&&l.value[e.value],k=i.value&&l.value[i.value];let M=O_(T,o,null);return M||(`${h}${e.value}`,M=O_(k,o,null)),M||(M=h),typeof M!="string"&&(M=h),fx(M,_)};function nS(e,i){return(l,h)=>new Intl.NumberFormat([e.value,i.value],h).format(l)}function c_(e,i,l){const h=ii(e,i,e[i]??l.value);return h.value=e[i]??l.value,Qt(l,p=>{e[i]==null&&(h.value=l.value)}),h}function iS(e){return i=>{const l=c_(i,"locale",e.current),h=c_(i,"fallback",e.fallback),p=c_(i,"messages",e.messages);return{name:"vuetify",current:l,fallback:h,messages:p,t:tS(l,h,p),n:nS(l,h),provide:iS({current:l,fallback:h,messages:p})}}}function bM(e){const i=an((e==null?void 0:e.locale)??"en"),l=an((e==null?void 0:e.fallback)??"en"),h=Ye({en:vM,...e==null?void 0:e.messages});return{name:"vuetify",current:i,fallback:l,messages:h,t:tS(i,l,h),n:nS(i,l),provide:iS({current:i,fallback:l,messages:h})}}const qp=Symbol.for("vuetify:locale");function xM(e){return e.name!=null}function wM(e){const i=e!=null&&e.adapter&&xM(e==null?void 0:e.adapter)?e==null?void 0:e.adapter:bM(e),l=CM(i,e);return{...i,...l}}function Dd(){const e=ni(qp);if(!e)throw new Error("[Vuetify] Could not find injected locale instance");return e}function SM(){return{af:!1,ar:!0,bg:!1,ca:!1,ckb:!1,cs:!1,de:!1,el:!1,en:!1,es:!1,et:!1,fa:!0,fi:!1,fr:!1,hr:!1,hu:!1,he:!0,id:!1,it:!1,ja:!1,km:!1,ko:!1,lv:!1,lt:!1,nl:!1,no:!1,pl:!1,pt:!1,ro:!1,ru:!1,sk:!1,sl:!1,srCyrl:!1,srLatn:!1,sv:!1,th:!1,tr:!1,az:!1,uk:!1,vi:!1,zhHans:!1,zhHant:!1}}function CM(e,i){const l=Ye((i==null?void 0:i.rtl)??SM()),h=ue(()=>l.value[e.current.value]??!1);return{isRtl:h,rtl:l,rtlClasses:ue(()=>`v-locale--is-${h.value?"rtl":"ltr"}`)}}function $a(){const e=ni(qp);if(!e)throw new Error("[Vuetify] Could not find injected rtl instance");return{isRtl:e.isRtl,rtlClasses:e.rtlClasses}}const rS=Symbol.for("vuetify:goto");function aS(){return{container:void 0,duration:300,layout:!1,offset:0,easing:"easeInOutCubic",patterns:{linear:e=>e,easeInQuad:e=>e**2,easeOutQuad:e=>e*(2-e),easeInOutQuad:e=>e<.5?2*e**2:-1+(4-2*e)*e,easeInCubic:e=>e**3,easeOutCubic:e=>--e**3+1,easeInOutCubic:e=>e<.5?4*e**3:(e-1)*(2*e-2)*(2*e-2)+1,easeInQuart:e=>e**4,easeOutQuart:e=>1- --e**4,easeInOutQuart:e=>e<.5?8*e**4:1-8*--e**4,easeInQuint:e=>e**5,easeOutQuint:e=>1+--e**5,easeInOutQuint:e=>e<.5?16*e**5:1+16*--e**5}}}function TM(e){return Ny(e)??(document.scrollingElement||document.body)}function Ny(e){return typeof e=="string"?document.querySelector(e):My(e)}function u_(e,i,l){if(typeof e=="number")return i&&l?-e:e;let h=Ny(e),p=0;for(;h;)p+=i?h.offsetLeft:h.offsetTop,h=h.offsetParent;return p}function PM(e,i){return{rtl:i.isRtl,options:Fr(aS(),e)}}async function px(e,i,l,h){const p=l?"scrollLeft":"scrollTop",_=Fr((h==null?void 0:h.options)??aS(),i),m=h==null?void 0:h.rtl.value,o=(typeof e=="number"?e:Ny(e))??0,T=_.container==="parent"&&o instanceof HTMLElement?o.parentElement:TM(_.container),k=typeof _.easing=="function"?_.easing:_.patterns[_.easing];if(!k)throw new TypeError(`Easing function "${_.easing}" not found.`);let M;if(typeof o=="number")M=u_(o,l,m);else if(M=u_(o,l,m)-u_(T,l,m),_.layout){const F=window.getComputedStyle(o).getPropertyValue("--v-layout-top");F&&(M-=parseInt(F,10))}M+=_.offset,M=IM(T,M,!!m,!!l);const D=T[p]??0;if(M===D)return Promise.resolve(M);const O=performance.now();return new Promise(z=>requestAnimationFrame(function F(N){const oe=(N-O)/_.duration,_e=Math.floor(D+(M-D)*k(Ss(oe,0,1)));if(T[p]=_e,oe>=1&&Math.abs(_e-T[p])<10)return z(M);if(oe>2)return z(T[p]);requestAnimationFrame(F)}))}function kM(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const i=ni(rS),{isRtl:l}=$a();if(!i)throw new Error("[Vuetify] Could not find injected goto instance");const h={...i,rtl:ue(()=>i.rtl.value||l.value)};async function p(_,m){return px(_,Fr(e,m),!1,h)}return p.horizontal=async(_,m)=>px(_,Fr(e,m),!0,h),p}function IM(e,i,l,h){const{scrollWidth:p,scrollHeight:_}=e,[m,o]=e===document.scrollingElement?[window.innerWidth,window.innerHeight]:[e.offsetWidth,e.offsetHeight];let T,k;return h?l?(T=-(p-m),k=0):(T=0,k=p-m):(T=0,k=_+-o),Math.max(Math.min(i,k),T)}const $y=Ct({modelValue:{type:null,default:void 0},multiple:Boolean,mandatory:[Boolean,String],max:Number,selectedClass:String,disabled:Boolean},"group"),jy=Ct({value:null,disabled:Boolean,selectedClass:String},"group-item");function Uy(e,i){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const h=Gi("useGroupItem");if(!h)throw new Error("[Vuetify] useGroupItem composable must be used inside a component setup function");const p=wa();Ir(Symbol.for(`${i.description}:id`),p);const _=ni(i,null);if(!_){if(!l)return _;throw new Error(`[Vuetify] Could not find useGroup injection with symbol ${i.description}`)}const m=nn(e,"value"),o=ue(()=>!!(_.disabled.value||e.disabled));_.register({id:p,value:m,disabled:o},h),kr(()=>{_.unregister(p)});const T=ue(()=>_.isSelected(p)),k=ue(()=>_.items.value[0].id===p),M=ue(()=>_.items.value[_.items.value.length-1].id===p),D=ue(()=>T.value&&[_.selectedClass.value,e.selectedClass]);return Qt(T,O=>{h.emit("group:selected",{value:O})},{flush:"sync"}),{id:p,isSelected:T,isFirst:k,isLast:M,toggle:()=>_.select(p,!T.value),select:O=>_.select(p,O),selectedClass:D,value:m,disabled:o,group:_}}function Sm(e,i){let l=!1;const h=yr([]),p=ii(e,"modelValue",[],O=>O==null?[]:sS(h,ns(O)),O=>{const z=EM(h,O);return e.multiple?z:z[0]}),_=Gi("useGroup");function m(O,z){const F=O,N=Symbol.for(`${i.description}:id`),oe=lu(N,_==null?void 0:_.vnode).indexOf(z);H(F.value)==null&&(F.value=oe,F.useIndexAsValue=!0),oe>-1?h.splice(oe,0,F):h.push(F)}function o(O){if(l)return;T();const z=h.findIndex(F=>F.id===O);h.splice(z,1)}function T(){const O=h.find(z=>!z.disabled);O&&e.mandatory==="force"&&!p.value.length&&(p.value=[O.id])}yi(()=>{T()}),kr(()=>{l=!0}),by(()=>{for(let O=0;O<h.length;O++)h[O].useIndexAsValue&&(h[O].value=O)});function k(O,z){const F=h.find(N=>N.id===O);if(!(z&&(F!=null&&F.disabled)))if(e.multiple){const N=p.value.slice(),q=N.findIndex(_e=>_e===O),oe=~q;if(z=z??!oe,oe&&e.mandatory&&N.length<=1||!oe&&e.max!=null&&N.length+1>e.max)return;q<0&&z?N.push(O):q>=0&&!z&&N.splice(q,1),p.value=N}else{const N=p.value.includes(O);if(e.mandatory&&N)return;p.value=z??!N?[O]:[]}}function M(O){if(e.multiple,p.value.length){const z=p.value[0],F=h.findIndex(oe=>oe.id===z);let N=(F+O)%h.length,q=h[N];for(;q.disabled&&N!==F;)N=(N+O)%h.length,q=h[N];if(q.disabled)return;p.value=[h[N].id]}else{const z=h.find(F=>!F.disabled);z&&(p.value=[z.id])}}const D={register:m,unregister:o,selected:p,select:k,disabled:nn(e,"disabled"),prev:()=>M(h.length-1),next:()=>M(1),isSelected:O=>p.value.includes(O),selectedClass:ue(()=>e.selectedClass),items:ue(()=>h),getItemIndex:O=>MM(h,O)};return Ir(i,D),D}function MM(e,i){const l=sS(e,[i]);return l.length?e.findIndex(h=>h.id===l[0]):-1}function sS(e,i){const l=[];return i.forEach(h=>{const p=e.find(m=>_u(h,m.value)),_=e[h];(p==null?void 0:p.value)!=null?l.push(p.id):_!=null&&l.push(_.id)}),l}function EM(e,i){const l=[];return i.forEach(h=>{const p=e.findIndex(_=>_.id===h);if(~p){const _=e[p];l.push(_.value!=null?_.value:p)}}),l}function mu(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"content";const l=V_(),h=Ye();if(Zn){const p=new ResizeObserver(_=>{e==null||e(_,p),_.length&&(i==="content"?h.value=_[0].contentRect:h.value=_[0].target.getBoundingClientRect())});kr(()=>{p.disconnect()}),Qt(()=>l.el,(_,m)=>{m&&(p.unobserve(m),h.value=void 0),_&&p.observe(_)},{flush:"post"})}return{resizeRef:l,contentRect:Cd(h)}}function AM(e){let{selectedElement:i,containerElement:l,isRtl:h,isHorizontal:p}=e;const _=_d(p,l),m=oS(p,h,l),o=_d(p,i),T=lS(p,i),k=o*.4;return m>T?T-k:m+_<T+o?T-_+o+k:m}function RM(e){let{selectedElement:i,containerElement:l,isHorizontal:h}=e;const p=_d(h,l),_=lS(h,i),m=_d(h,i);return _-p/2+m/2}function mx(e,i){const l=e?"scrollWidth":"scrollHeight";return(i==null?void 0:i[l])||0}function DM(e,i){const l=e?"clientWidth":"clientHeight";return(i==null?void 0:i[l])||0}function oS(e,i,l){if(!l)return 0;const{scrollLeft:h,offsetWidth:p,scrollWidth:_}=l;return e?i?_-p+h:h:l.scrollTop}function _d(e,i){const l=e?"offsetWidth":"offsetHeight";return(i==null?void 0:i[l])||0}function lS(e,i){const l=e?"offsetLeft":"offsetTop";return(i==null?void 0:i[l])||0}const zM=Symbol.for("vuetify:v-slide-group"),Gy=Ct({centerActive:Boolean,direction:{type:String,default:"horizontal"},symbol:{type:null,default:zM},nextIcon:{type:jn,default:"$next"},prevIcon:{type:jn,default:"$prev"},showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["always","desktop","mobile"].includes(e)},...xn(),...eS({mobile:null}),...Ti(),...$y({selectedClass:"v-slide-group-item--active"})},"VSlideGroup"),Wp=qt()({name:"VSlideGroup",props:Gy(),emits:{"update:modelValue":e=>!0},setup(e,i){let{slots:l}=i;const{isRtl:h}=$a(),{displayClasses:p,mobile:_}=wm(e),m=Sm(e,e.symbol),o=an(!1),T=an(0),k=an(0),M=an(0),D=ue(()=>e.direction==="horizontal"),{resizeRef:O,contentRect:z}=mu(),{resizeRef:F,contentRect:N}=mu(),q=kM(),oe=ue(()=>({container:O.el,duration:200,easing:"easeOutQuart"})),_e=ue(()=>m.selected.value.length?m.items.value.findIndex(Qe=>Qe.id===m.selected.value[0]):-1),Se=ue(()=>m.selected.value.length?m.items.value.findIndex(Qe=>Qe.id===m.selected.value[m.selected.value.length-1]):-1);if(Zn){let Qe=-1;Qt(()=>[m.selected.value,z.value,N.value,D.value],()=>{cancelAnimationFrame(Qe),Qe=requestAnimationFrame(()=>{if(z.value&&N.value){const ct=D.value?"width":"height";k.value=z.value[ct],M.value=N.value[ct],o.value=k.value+1<M.value}if(_e.value>=0&&F.el){const ct=F.el.children[Se.value];be(ct,e.centerActive)}})})}const pe=an(!1);function be(Qe,ct){let Dt=0;ct?Dt=RM({containerElement:O.el,isHorizontal:D.value,selectedElement:Qe}):Dt=AM({containerElement:O.el,isHorizontal:D.value,isRtl:h.value,selectedElement:Qe}),de(Dt)}function de(Qe){if(!Zn||!O.el)return;const ct=_d(D.value,O.el),Dt=oS(D.value,h.value,O.el);if(!(mx(D.value,O.el)<=ct||Math.abs(Qe-Dt)<16)){if(D.value&&h.value&&O.el){const{scrollWidth:zt,offsetWidth:Kt}=O.el;Qe=zt-Kt-Qe}D.value?q.horizontal(Qe,oe.value):q(Qe,oe.value)}}function Ce(Qe){const{scrollTop:ct,scrollLeft:Dt}=Qe.target;T.value=D.value?Dt:ct}function ye(Qe){if(pe.value=!0,!(!o.value||!F.el)){for(const ct of Qe.composedPath())for(const Dt of F.el.children)if(Dt===ct){be(Dt);return}}}function Me(Qe){pe.value=!1}let ke=!1;function Ee(Qe){var ct;!ke&&!pe.value&&!(Qe.relatedTarget&&((ct=F.el)!=null&&ct.contains(Qe.relatedTarget)))&&We(),ke=!1}function xe(){ke=!0}function Fe(Qe){if(!F.el)return;function ct(Dt){Qe.preventDefault(),We(Dt)}D.value?Qe.key==="ArrowRight"?ct(h.value?"prev":"next"):Qe.key==="ArrowLeft"&&ct(h.value?"next":"prev"):Qe.key==="ArrowDown"?ct("next"):Qe.key==="ArrowUp"&&ct("prev"),Qe.key==="Home"?ct("first"):Qe.key==="End"&&ct("last")}function We(Qe){var Dt,Yt;if(!F.el)return;let ct;if(!Qe)ct=fd(F.el)[0];else if(Qe==="next"){if(ct=(Dt=F.el.querySelector(":focus"))==null?void 0:Dt.nextElementSibling,!ct)return We("first")}else if(Qe==="prev"){if(ct=(Yt=F.el.querySelector(":focus"))==null?void 0:Yt.previousElementSibling,!ct)return We("last")}else Qe==="first"?ct=F.el.firstElementChild:Qe==="last"&&(ct=F.el.lastElementChild);ct&&ct.focus({preventScroll:!0})}function ht(Qe){const ct=D.value&&h.value?-1:1,Dt=(Qe==="prev"?-ct:ct)*k.value;let Yt=T.value+Dt;if(D.value&&h.value&&O.el){const{scrollWidth:zt,offsetWidth:Kt}=O.el;Yt+=zt-Kt}de(Yt)}const Ne=ue(()=>({next:m.next,prev:m.prev,select:m.select,isSelected:m.isSelected})),tt=ue(()=>{switch(e.showArrows){case"always":return!0;case"desktop":return!_.value;case!0:return o.value||Math.abs(T.value)>0;case"mobile":return _.value||o.value||Math.abs(T.value)>0;default:return!_.value&&(o.value||Math.abs(T.value)>0)}}),Mt=ue(()=>Math.abs(T.value)>1),_t=ue(()=>{if(!O.value)return!1;const Qe=mx(D.value,O.el),ct=DM(D.value,O.el);return Qe-ct-Math.abs(T.value)>1});return dn(()=>A(e.tag,{class:["v-slide-group",{"v-slide-group--vertical":!D.value,"v-slide-group--has-affixes":tt.value,"v-slide-group--is-overflowing":o.value},p.value,e.class],style:e.style,tabindex:pe.value||m.selected.value.length?-1:0,onFocus:Ee},{default:()=>{var Qe,ct,Dt;return[tt.value&&A("div",{key:"prev",class:["v-slide-group__prev",{"v-slide-group__prev--disabled":!Mt.value}],onMousedown:xe,onClick:()=>Mt.value&&ht("prev")},[((Qe=l.prev)==null?void 0:Qe.call(l,Ne.value))??A(ix,null,{default:()=>[A(li,{icon:h.value?e.nextIcon:e.prevIcon},null)]})]),A("div",{key:"container",ref:O,class:"v-slide-group__container",onScroll:Ce},[A("div",{ref:F,class:"v-slide-group__content",onFocusin:ye,onFocusout:Me,onKeydown:Fe},[(ct=l.default)==null?void 0:ct.call(l,Ne.value)])]),tt.value&&A("div",{key:"next",class:["v-slide-group__next",{"v-slide-group__next--disabled":!_t.value}],onMousedown:xe,onClick:()=>_t.value&&ht("next")},[((Dt=l.next)==null?void 0:Dt.call(l,Ne.value))??A(ix,null,{default:()=>[A(li,{icon:h.value?e.prevIcon:e.nextIcon},null)]})])]}})),{selected:m.selected,scrollTo:ht,scrollOffset:T,focus:We,hasPrev:Mt,hasNext:_t}}}),cS=Symbol.for("vuetify:v-chip-group"),LM=Ct({column:Boolean,filter:Boolean,valueComparator:{type:Function,default:_u},...Gy(),...xn(),...$y({selectedClass:"v-chip--selected"}),...Ti(),...Di(),...ks({variant:"tonal"})},"VChipGroup");qt()({name:"VChipGroup",props:LM(),emits:{"update:modelValue":e=>!0},setup(e,i){let{slots:l}=i;const{themeClasses:h}=Hi(e),{isSelected:p,select:_,next:m,prev:o,selected:T}=Sm(e,cS);return Qo({VChip:{color:nn(e,"color"),disabled:nn(e,"disabled"),filter:nn(e,"filter"),variant:nn(e,"variant")}}),dn(()=>{const k=Wp.filterProps(e);return A(Wp,sn(k,{class:["v-chip-group",{"v-chip-group--column":e.column},h.value,e.class],style:e.style}),{default:()=>{var M;return[(M=l.default)==null?void 0:M.call(l,{isSelected:p,select:_,next:m,prev:o,selected:T.value})]}})}),{}}});const lo=Ct({elevation:{type:[Number,String],validator(e){const i=parseInt(e);return!isNaN(i)&&i>=0&&i<=24}}},"elevation");function co(e){return{elevationClasses:ue(()=>{const l=ci(e)?e.value:e.elevation,h=[];return l==null||h.push(`elevation-${l}`),h})}}function BM(){const e=Gi("useRoute");return ue(()=>{var i;return(i=e==null?void 0:e.proxy)==null?void 0:i.$route})}function uS(){var e,i;return(i=(e=Gi("useRouter"))==null?void 0:e.proxy)==null?void 0:i.$router}function Cm(e,i){var D,O;const l=RP("RouterLink"),h=ue(()=>!!(e.href||e.to)),p=ue(()=>(h==null?void 0:h.value)||Nb(i,"click")||Nb(e,"click"));if(typeof l=="string"||!("useLink"in l)){const z=nn(e,"href");return{isLink:h,isClickable:p,href:z,linkProps:yr({href:z})}}const _=ue(()=>({...e,to:nn(()=>e.to||"")})),m=l.useLink(_.value),o=ue(()=>e.to?m:void 0),T=BM(),k=ue(()=>{var z,F,N;return o.value?e.exact?T.value?((N=o.value.isExactActive)==null?void 0:N.value)&&_u(o.value.route.value.query,T.value.query):((F=o.value.isExactActive)==null?void 0:F.value)??!1:((z=o.value.isActive)==null?void 0:z.value)??!1:!1}),M=ue(()=>{var z;return e.to?(z=o.value)==null?void 0:z.route.value.href:e.href});return{isLink:h,isClickable:p,isActive:k,route:(D=o.value)==null?void 0:D.route,navigate:(O=o.value)==null?void 0:O.navigate,href:M,linkProps:yr({href:M,"aria-current":ue(()=>k.value?"page":void 0)})}}const Tm=Ct({href:String,replace:Boolean,to:[String,Object],exact:Boolean},"router");let h_=!1;function FM(e,i){let l=!1,h,p;Zn&&(Fi(()=>{window.addEventListener("popstate",_),h=e==null?void 0:e.beforeEach((m,o,T)=>{h_?l?i(T):T():setTimeout(()=>l?i(T):T()),h_=!0}),p=e==null?void 0:e.afterEach(()=>{h_=!1})}),Pr(()=>{window.removeEventListener("popstate",_),h==null||h(),p==null||p()}));function _(m){var o;(o=m.state)!=null&&o.replaced||(l=!0,setTimeout(()=>l=!1))}}const H_=Symbol("rippleStop"),OM=80;function gx(e,i){e.style.transform=i,e.style.webkitTransform=i}function Z_(e){return e.constructor.name==="TouchEvent"}function hS(e){return e.constructor.name==="KeyboardEvent"}const VM=function(e,i){var D;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},h=0,p=0;if(!hS(e)){const O=i.getBoundingClientRect(),z=Z_(e)?e.touches[e.touches.length-1]:e;h=z.clientX-O.left,p=z.clientY-O.top}let _=0,m=.3;(D=i._ripple)!=null&&D.circle?(m=.15,_=i.clientWidth/2,_=l.center?_:_+Math.sqrt((h-_)**2+(p-_)**2)/4):_=Math.sqrt(i.clientWidth**2+i.clientHeight**2)/2;const o=`${(i.clientWidth-_*2)/2}px`,T=`${(i.clientHeight-_*2)/2}px`,k=l.center?o:`${h-_}px`,M=l.center?T:`${p-_}px`;return{radius:_,scale:m,x:k,y:M,centerX:o,centerY:T}},Xp={show(e,i){var z;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!((z=i==null?void 0:i._ripple)!=null&&z.enabled))return;const h=document.createElement("span"),p=document.createElement("span");h.appendChild(p),h.className="v-ripple__container",l.class&&(h.className+=` ${l.class}`);const{radius:_,scale:m,x:o,y:T,centerX:k,centerY:M}=VM(e,i,l),D=`${_*2}px`;p.className="v-ripple__animation",p.style.width=D,p.style.height=D,i.appendChild(h);const O=window.getComputedStyle(i);O&&O.position==="static"&&(i.style.position="relative",i.dataset.previousPosition="static"),p.classList.add("v-ripple__animation--enter"),p.classList.add("v-ripple__animation--visible"),gx(p,`translate(${o}, ${T}) scale3d(${m},${m},${m})`),p.dataset.activated=String(performance.now()),setTimeout(()=>{p.classList.remove("v-ripple__animation--enter"),p.classList.add("v-ripple__animation--in"),gx(p,`translate(${k}, ${M}) scale3d(1,1,1)`)},0)},hide(e){var _;if(!((_=e==null?void 0:e._ripple)!=null&&_.enabled))return;const i=e.getElementsByClassName("v-ripple__animation");if(i.length===0)return;const l=i[i.length-1];if(l.dataset.isHiding)return;l.dataset.isHiding="true";const h=performance.now()-Number(l.dataset.activated),p=Math.max(250-h,0);setTimeout(()=>{l.classList.remove("v-ripple__animation--in"),l.classList.add("v-ripple__animation--out"),setTimeout(()=>{var o;e.getElementsByClassName("v-ripple__animation").length===1&&e.dataset.previousPosition&&(e.style.position=e.dataset.previousPosition,delete e.dataset.previousPosition),((o=l.parentNode)==null?void 0:o.parentNode)===e&&e.removeChild(l.parentNode)},300)},p)}};function dS(e){return typeof e>"u"||!!e}function yd(e){const i={},l=e.currentTarget;if(!(!(l!=null&&l._ripple)||l._ripple.touched||e[H_])){if(e[H_]=!0,Z_(e))l._ripple.touched=!0,l._ripple.isTouch=!0;else if(l._ripple.isTouch)return;if(i.center=l._ripple.centered||hS(e),l._ripple.class&&(i.class=l._ripple.class),Z_(e)){if(l._ripple.showTimerCommit)return;l._ripple.showTimerCommit=()=>{Xp.show(e,l,i)},l._ripple.showTimer=window.setTimeout(()=>{var h;(h=l==null?void 0:l._ripple)!=null&&h.showTimerCommit&&(l._ripple.showTimerCommit(),l._ripple.showTimerCommit=null)},OM)}else Xp.show(e,l,i)}}function _x(e){e[H_]=!0}function ya(e){const i=e.currentTarget;if(i!=null&&i._ripple){if(window.clearTimeout(i._ripple.showTimer),e.type==="touchend"&&i._ripple.showTimerCommit){i._ripple.showTimerCommit(),i._ripple.showTimerCommit=null,i._ripple.showTimer=window.setTimeout(()=>{ya(e)});return}window.setTimeout(()=>{i._ripple&&(i._ripple.touched=!1)}),Xp.hide(i)}}function fS(e){const i=e.currentTarget;i!=null&&i._ripple&&(i._ripple.showTimerCommit&&(i._ripple.showTimerCommit=null),window.clearTimeout(i._ripple.showTimer))}let vd=!1;function pS(e){!vd&&(e.keyCode===Bb.enter||e.keyCode===Bb.space)&&(vd=!0,yd(e))}function mS(e){vd=!1,ya(e)}function gS(e){vd&&(vd=!1,ya(e))}function _S(e,i,l){const{value:h,modifiers:p}=i,_=dS(h);if(_||Xp.hide(e),e._ripple=e._ripple??{},e._ripple.enabled=_,e._ripple.centered=p.center,e._ripple.circle=p.circle,Iy(h)&&h.class&&(e._ripple.class=h.class),_&&!l){if(p.stop){e.addEventListener("touchstart",_x,{passive:!0}),e.addEventListener("mousedown",_x);return}e.addEventListener("touchstart",yd,{passive:!0}),e.addEventListener("touchend",ya,{passive:!0}),e.addEventListener("touchmove",fS,{passive:!0}),e.addEventListener("touchcancel",ya),e.addEventListener("mousedown",yd),e.addEventListener("mouseup",ya),e.addEventListener("mouseleave",ya),e.addEventListener("keydown",pS),e.addEventListener("keyup",mS),e.addEventListener("blur",gS),e.addEventListener("dragstart",ya,{passive:!0})}else!_&&l&&yS(e)}function yS(e){e.removeEventListener("mousedown",yd),e.removeEventListener("touchstart",yd),e.removeEventListener("touchend",ya),e.removeEventListener("touchmove",fS),e.removeEventListener("touchcancel",ya),e.removeEventListener("mouseup",ya),e.removeEventListener("mouseleave",ya),e.removeEventListener("keydown",pS),e.removeEventListener("keyup",mS),e.removeEventListener("dragstart",ya),e.removeEventListener("blur",gS)}function NM(e,i){_S(e,i,!1)}function $M(e){delete e._ripple,yS(e)}function jM(e,i){if(i.value===i.oldValue)return;const l=dS(i.oldValue);_S(e,i,l)}const zd={mounted:NM,unmounted:$M,updated:jM},UM=Ct({activeClass:String,appendAvatar:String,appendIcon:jn,closable:Boolean,closeIcon:{type:jn,default:"$delete"},closeLabel:{type:String,default:"$vuetify.close"},draggable:Boolean,filter:Boolean,filterIcon:{type:jn,default:"$complete"},label:Boolean,link:{type:Boolean,default:void 0},pill:Boolean,prependAvatar:String,prependIcon:jn,ripple:{type:[Boolean,Object],default:!0},text:String,modelValue:{type:Boolean,default:!0},onClick:ra(),onClickOnce:ra(),...so(),...xn(),...Ca(),...lo(),...jy(),...oa(),...Tm(),...Ed(),...Ti({tag:"span"}),...Di(),...ks({variant:"tonal"})},"VChip"),ln=qt()({name:"VChip",directives:{Ripple:zd},props:UM(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0,"group:selected":e=>!0,click:e=>!0},setup(e,i){let{attrs:l,emit:h,slots:p}=i;const{t:_}=Dd(),{borderClasses:m}=oo(e),{colorClasses:o,colorStyles:T,variantClasses:k}=tc(e),{densityClasses:M}=Na(e),{elevationClasses:D}=co(e),{roundedClasses:O}=la(e),{sizeClasses:z}=Ad(e),{themeClasses:F}=Hi(e),N=ii(e,"modelValue"),q=Uy(e,cS,!1),oe=Cm(e,l),_e=ue(()=>e.link!==!1&&oe.isLink.value),Se=ue(()=>!e.disabled&&e.link!==!1&&(!!q||e.link||oe.isClickable.value)),pe=ue(()=>({"aria-label":_(e.closeLabel),onClick(Ce){Ce.preventDefault(),Ce.stopPropagation(),N.value=!1,h("click:close",Ce)}}));function be(Ce){var ye;h("click",Ce),Se.value&&((ye=oe.navigate)==null||ye.call(oe,Ce),q==null||q.toggle())}function de(Ce){(Ce.key==="Enter"||Ce.key===" ")&&(Ce.preventDefault(),be(Ce))}return()=>{var ht;const Ce=oe.isLink.value?"a":e.tag,ye=!!(e.appendIcon||e.appendAvatar),Me=!!(ye||p.append),ke=!!(p.close||e.closable),Ee=!!(p.filter||e.filter)&&q,xe=!!(e.prependIcon||e.prependAvatar),Fe=!!(xe||p.prepend),We=!q||q.isSelected.value;return N.value&&Tr(A(Ce,sn({class:["v-chip",{"v-chip--disabled":e.disabled,"v-chip--label":e.label,"v-chip--link":Se.value,"v-chip--filter":Ee,"v-chip--pill":e.pill,[`${e.activeClass}`]:e.activeClass&&((ht=oe.isActive)==null?void 0:ht.value)},F.value,m.value,We?o.value:void 0,M.value,D.value,O.value,z.value,k.value,q==null?void 0:q.selectedClass.value,e.class],style:[We?T.value:void 0,e.style],disabled:e.disabled||void 0,draggable:e.draggable,tabindex:Se.value?0:void 0,onClick:be,onKeydown:Se.value&&!_e.value&&de},oe.linkProps),{default:()=>{var Ne;return[ec(Se.value,"v-chip"),Ee&&A(Ww,{key:"filter"},{default:()=>[Tr(A("div",{class:"v-chip__filter"},[p.filter?A(Bi,{key:"filter-defaults",disabled:!e.filterIcon,defaults:{VIcon:{icon:e.filterIcon}}},p.filter):A(li,{key:"filter-icon",icon:e.filterIcon},null)]),[[Ql,q.isSelected.value]])]}),Fe&&A("div",{key:"prepend",class:"v-chip__prepend"},[p.prepend?A(Bi,{key:"prepend-defaults",disabled:!xe,defaults:{VAvatar:{image:e.prependAvatar,start:!0},VIcon:{icon:e.prependIcon,start:!0}}},p.prepend):A(cn,null,[e.prependIcon&&A(li,{key:"prepend-icon",icon:e.prependIcon,start:!0},null),e.prependAvatar&&A(Kl,{key:"prepend-avatar",image:e.prependAvatar,start:!0},null)])]),A("div",{class:"v-chip__content","data-no-activator":""},[((Ne=p.default)==null?void 0:Ne.call(p,{isSelected:q==null?void 0:q.isSelected.value,selectedClass:q==null?void 0:q.selectedClass.value,select:q==null?void 0:q.select,toggle:q==null?void 0:q.toggle,value:q==null?void 0:q.value.value,disabled:e.disabled}))??e.text]),Me&&A("div",{key:"append",class:"v-chip__append"},[p.append?A(Bi,{key:"append-defaults",disabled:!ye,defaults:{VAvatar:{end:!0,image:e.appendAvatar},VIcon:{end:!0,icon:e.appendIcon}}},p.append):A(cn,null,[e.appendIcon&&A(li,{key:"append-icon",end:!0,icon:e.appendIcon},null),e.appendAvatar&&A(Kl,{key:"append-avatar",end:!0,image:e.appendAvatar},null)])]),ke&&A("button",sn({key:"close",class:"v-chip__close",type:"button","data-testid":"close-chip"},pe.value),[p.close?A(Bi,{key:"close-defaults",defaults:{VIcon:{icon:e.closeIcon,size:"x-small"}}},p.close):A(li,{key:"close-icon",icon:e.closeIcon,size:"x-small"},null)])]}}),[[ao("ripple"),Se.value&&e.ripple,null]])}}});const yx={center:"center",top:"bottom",bottom:"top",left:"right",right:"left"},vu=Ct({location:String},"location");function Ld(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=arguments.length>2?arguments[2]:void 0;const{isRtl:h}=$a();return{locationStyles:ue(()=>{if(!e.location)return{};const{side:_,align:m}=N_(e.location.split(" ").length>1?e.location:`${e.location} center`,h.value);function o(k){return l?l(k):0}const T={};return _!=="center"&&(i?T[yx[_]]=`calc(100% - ${o(_)}px)`:T[_]=0),m!=="center"?i?T[yx[m]]=`calc(100% - ${o(m)}px)`:T[m]=0:(_==="center"?T.top=T.left="50%":T[{top:"left",bottom:"left",left:"top",right:"top"}[_]]="50%",T.transform={top:"translateX(-50%)",bottom:"translateX(-50%)",left:"translateY(-50%)",right:"translateY(-50%)",center:"translate(-50%, -50%)"}[_]),T})}}const GM=["static","relative","fixed","absolute","sticky"],Bd=Ct({position:{type:String,validator:e=>GM.includes(e)}},"position");function Fd(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ps();return{positionClasses:ue(()=>e.position?`${i}--${e.position}`:void 0)}}const HM=Ct({color:String,...so(),...xn(),...Oa(),...lo(),...vu(),...Bd(),...oa(),...Ti(),...Di()},"VSheet"),ZM=qt()({name:"VSheet",props:HM(),setup(e,i){let{slots:l}=i;const{themeClasses:h}=Hi(e),{backgroundColorClasses:p,backgroundColorStyles:_}=La(nn(e,"color")),{borderClasses:m}=oo(e),{dimensionStyles:o}=Va(e),{elevationClasses:T}=co(e),{locationStyles:k}=Ld(e),{positionClasses:M}=Fd(e),{roundedClasses:D}=la(e);return dn(()=>A(e.tag,{class:["v-sheet",h.value,p.value,m.value,T.value,M.value,D.value,e.class],style:[_.value,o.value,k.value,e.style]},l)),{}}}),qM={class:"d-flex ga-1"},WM={class:"inline"},XM=Un({__name:"TopBar",setup(e){const i=vi(),l=ue(()=>i.baseData.data.allowBuyingCrypto||i.baseData.data.allowSellingCrypto||i.baseData.data.allowTransferCrypto);return(h,p)=>($e(),gt(ZM,{class:"topbar"},{default:Q(()=>{var _,m,o,T,k,M;return[Ke("div",qM,[A(ln,null,{default:Q(()=>{var D,O;return[je(ee(H(re)("user"))+": "+ee((O=(D=H(i).baseData)==null?void 0:D.data)!=null&&O.currentRacerName?H(i).baseData.data.currentRacerName:H(re)("user_no")),1)]}),_:1}),A(ln,null,{default:Q(()=>{var D,O;return[je(ee(H(re)("auth"))+": "+ee((O=(D=H(i).baseData)==null?void 0:D.data)!=null&&O.currentRacerAuth?H(i).baseData.data.currentRacerAuth:H(re)("auth_no")),1)]}),_:1}),(m=(_=H(i).baseData)==null?void 0:_.data)!=null&&m.currentCrewName?($e(),gt(ln,{key:0},{default:Q(()=>[je(ee(H(re)("crew"))+": "+ee(H(i).baseData.data.currentCrewName),1)]),_:1})):Ft("",!0),(T=(o=H(i).baseData)==null?void 0:o.data)!=null&&T.currentRanking?($e(),gt(ln,{key:1},{default:Q(()=>[je(ee(H(re)("rank"))+": "+ee(H(i).baseData.data.currentRanking),1)]),_:1})):Ft("",!0),H(i).baseData.data.currentRacerName&&((M=(k=H(i).baseData)==null?void 0:k.data)!=null&&M.isUsingRacingCrypto)?($e(),gt(ln,{key:2,color:"orange",onClick:p[0]||(p[0]=D=>l.value?H(i).showCryptoModal=!0:void 0)},{default:Q(()=>[je(ee(H(i).baseData.data.currentCrypto)+" "+ee(H(i).baseData.data.cryptoType),1)]),_:1})):Ft("",!0)]),Ke("div",WM,[A(li,{icon:"mdi-signal"}),A(li,{icon:"mdi-battery-70"}),p[1]||(p[1]=je(" 75% "))])]}),_:1}))}});const Mi=(e,i)=>{const l=e.__vccOpts||e;for(const[h,p]of i)l[h]=p;return l},KM=Mi(XM,[["__scopeId","data-v-9ec86503"]]);const q_=Symbol.for("vuetify:list");function vS(){const e=ni(q_,{hasPrepend:an(!1),updateHasPrepend:()=>null}),i={hasPrepend:an(!1),updateHasPrepend:l=>{l&&(i.hasPrepend.value=l)}};return Ir(q_,i),e}function bS(){return ni(q_,null)}const Hy=e=>{const i={activate:l=>{let{id:h,value:p,activated:_}=l;return h=fn(h),e&&!p&&_.size===1&&_.has(h)||(p?_.add(h):_.delete(h)),_},in:(l,h,p)=>{let _=new Set;if(l!=null)for(const m of ns(l))_=i.activate({id:m,value:!0,activated:new Set(_),children:h,parents:p});return _},out:l=>Array.from(l)};return i},xS=e=>{const i=Hy(e);return{activate:h=>{let{activated:p,id:_,...m}=h;_=fn(_);const o=p.has(_)?new Set([_]):new Set;return i.activate({...m,id:_,activated:o})},in:(h,p,_)=>{let m=new Set;if(h!=null){const o=ns(h);o.length&&(m=i.in(o.slice(0,1),p,_))}return m},out:(h,p,_)=>i.out(h,p,_)}},YM=e=>{const i=Hy(e);return{activate:h=>{let{id:p,activated:_,children:m,...o}=h;return p=fn(p),m.has(p)?_:i.activate({id:p,activated:_,children:m,...o})},in:i.in,out:i.out}},JM=e=>{const i=xS(e);return{activate:h=>{let{id:p,activated:_,children:m,...o}=h;return p=fn(p),m.has(p)?_:i.activate({id:p,activated:_,children:m,...o})},in:i.in,out:i.out}},QM={open:e=>{let{id:i,value:l,opened:h,parents:p}=e;if(l){const _=new Set;_.add(i);let m=p.get(i);for(;m!=null;)_.add(m),m=p.get(m);return _}else return h.delete(i),h},select:()=>null},wS={open:e=>{let{id:i,value:l,opened:h,parents:p}=e;if(l){let _=p.get(i);for(h.add(i);_!=null&&_!==i;)h.add(_),_=p.get(_);return h}else h.delete(i);return h},select:()=>null},eE={open:wS.open,select:e=>{let{id:i,value:l,opened:h,parents:p}=e;if(!l)return h;const _=[];let m=p.get(i);for(;m!=null;)_.push(m),m=p.get(m);return new Set(_)}},Zy=e=>{const i={select:l=>{let{id:h,value:p,selected:_}=l;if(h=fn(h),e&&!p){const m=Array.from(_.entries()).reduce((o,T)=>{let[k,M]=T;return M==="on"&&o.push(k),o},[]);if(m.length===1&&m[0]===h)return _}return _.set(h,p?"on":"off"),_},in:(l,h,p)=>{let _=new Map;for(const m of l||[])_=i.select({id:m,value:!0,selected:new Map(_),children:h,parents:p});return _},out:l=>{const h=[];for(const[p,_]of l.entries())_==="on"&&h.push(p);return h}};return i},SS=e=>{const i=Zy(e);return{select:h=>{let{selected:p,id:_,...m}=h;_=fn(_);const o=p.has(_)?new Map([[_,p.get(_)]]):new Map;return i.select({...m,id:_,selected:o})},in:(h,p,_)=>{let m=new Map;return h!=null&&h.length&&(m=i.in(h.slice(0,1),p,_)),m},out:(h,p,_)=>i.out(h,p,_)}},tE=e=>{const i=Zy(e);return{select:h=>{let{id:p,selected:_,children:m,...o}=h;return p=fn(p),m.has(p)?_:i.select({id:p,selected:_,children:m,...o})},in:i.in,out:i.out}},nE=e=>{const i=SS(e);return{select:h=>{let{id:p,selected:_,children:m,...o}=h;return p=fn(p),m.has(p)?_:i.select({id:p,selected:_,children:m,...o})},in:i.in,out:i.out}},iE=e=>{const i={select:l=>{let{id:h,value:p,selected:_,children:m,parents:o}=l;h=fn(h);const T=new Map(_),k=[h];for(;k.length;){const D=k.shift();_.set(fn(D),p?"on":"off"),m.has(D)&&k.push(...m.get(D))}let M=fn(o.get(h));for(;M;){const D=m.get(M),O=D.every(F=>_.get(fn(F))==="on"),z=D.every(F=>!_.has(fn(F))||_.get(fn(F))==="off");_.set(M,O?"on":z?"off":"indeterminate"),M=fn(o.get(M))}return e&&!p&&Array.from(_.entries()).reduce((O,z)=>{let[F,N]=z;return N==="on"&&O.push(F),O},[]).length===0?T:_},in:(l,h,p)=>{let _=new Map;for(const m of l||[])_=i.select({id:m,value:!0,selected:new Map(_),children:h,parents:p});return _},out:(l,h)=>{const p=[];for(const[_,m]of l.entries())m==="on"&&!h.has(_)&&p.push(_);return p}};return i},bd=Symbol.for("vuetify:nested"),CS={id:an(),root:{register:()=>null,unregister:()=>null,parents:Ye(new Map),children:Ye(new Map),open:()=>null,openOnSelect:()=>null,activate:()=>null,select:()=>null,activatable:Ye(!1),selectable:Ye(!1),opened:Ye(new Set),activated:Ye(new Set),selected:Ye(new Map),selectedValues:Ye([]),getPath:()=>[]}},rE=Ct({activatable:Boolean,selectable:Boolean,activeStrategy:[String,Function,Object],selectStrategy:[String,Function,Object],openStrategy:[String,Object],opened:null,activated:null,selected:null,mandatory:Boolean},"nested"),aE=e=>{let i=!1;const l=Ye(new Map),h=Ye(new Map),p=ii(e,"opened",e.opened,F=>new Set(F),F=>[...F.values()]),_=ue(()=>{if(typeof e.activeStrategy=="object")return e.activeStrategy;if(typeof e.activeStrategy=="function")return e.activeStrategy(e.mandatory);switch(e.activeStrategy){case"leaf":return YM(e.mandatory);case"single-leaf":return JM(e.mandatory);case"independent":return Hy(e.mandatory);case"single-independent":default:return xS(e.mandatory)}}),m=ue(()=>{if(typeof e.selectStrategy=="object")return e.selectStrategy;if(typeof e.selectStrategy=="function")return e.selectStrategy(e.mandatory);switch(e.selectStrategy){case"single-leaf":return nE(e.mandatory);case"leaf":return tE(e.mandatory);case"independent":return Zy(e.mandatory);case"single-independent":return SS(e.mandatory);case"classic":default:return iE(e.mandatory)}}),o=ue(()=>{if(typeof e.openStrategy=="object")return e.openStrategy;switch(e.openStrategy){case"list":return eE;case"single":return QM;case"multiple":default:return wS}}),T=ii(e,"activated",e.activated,F=>_.value.in(F,l.value,h.value),F=>_.value.out(F,l.value,h.value)),k=ii(e,"selected",e.selected,F=>m.value.in(F,l.value,h.value),F=>m.value.out(F,l.value,h.value));kr(()=>{i=!0});function M(F){const N=[];let q=F;for(;q!=null;)N.unshift(q),q=h.value.get(q);return N}const D=Gi("nested"),O=new Set,z={id:an(),root:{opened:p,activatable:nn(e,"activatable"),selectable:nn(e,"selectable"),activated:T,selected:k,selectedValues:ue(()=>{const F=[];for(const[N,q]of k.value.entries())q==="on"&&F.push(N);return F}),register:(F,N,q)=>{if(O.has(F)){M(F).map(String).join(" -> "),M(N).concat(F).map(String).join(" -> ");return}else O.add(F);N&&F!==N&&h.value.set(F,N),q&&l.value.set(F,[]),N!=null&&l.value.set(N,[...l.value.get(N)||[],F])},unregister:F=>{if(i)return;O.delete(F),l.value.delete(F);const N=h.value.get(F);if(N){const q=l.value.get(N)??[];l.value.set(N,q.filter(oe=>oe!==F))}h.value.delete(F)},open:(F,N,q)=>{D.emit("click:open",{id:F,value:N,path:M(F),event:q});const oe=o.value.open({id:F,value:N,opened:new Set(p.value),children:l.value,parents:h.value,event:q});oe&&(p.value=oe)},openOnSelect:(F,N,q)=>{const oe=o.value.select({id:F,value:N,selected:new Map(k.value),opened:new Set(p.value),children:l.value,parents:h.value,event:q});oe&&(p.value=oe)},select:(F,N,q)=>{D.emit("click:select",{id:F,value:N,path:M(F),event:q});const oe=m.value.select({id:F,value:N,selected:new Map(k.value),children:l.value,parents:h.value,event:q});oe&&(k.value=oe),z.root.openOnSelect(F,N,q)},activate:(F,N,q)=>{if(!e.activatable)return z.root.select(F,!0,q);D.emit("click:activate",{id:F,value:N,path:M(F),event:q});const oe=_.value.activate({id:F,value:N,activated:new Set(T.value),children:l.value,parents:h.value,event:q});oe&&(T.value=oe)},children:l,parents:h,getPath:M}};return Ir(bd,z),z.root},TS=(e,i)=>{const l=ni(bd,CS),h=Symbol(wa()),p=ue(()=>e.value!==void 0?e.value:h),_={...l,id:p,open:(m,o)=>l.root.open(p.value,m,o),openOnSelect:(m,o)=>l.root.openOnSelect(p.value,m,o),isOpen:ue(()=>l.root.opened.value.has(p.value)),parent:ue(()=>l.root.parents.value.get(p.value)),activate:(m,o)=>l.root.activate(p.value,m,o),isActivated:ue(()=>l.root.activated.value.has(fn(p.value))),select:(m,o)=>l.root.select(p.value,m,o),isSelected:ue(()=>l.root.selected.value.get(fn(p.value))==="on"),isIndeterminate:ue(()=>l.root.selected.value.get(p.value)==="indeterminate"),isLeaf:ue(()=>!l.root.children.value.get(p.value)),isGroupActivator:l.isGroupActivator};return Pd(()=>{!l.isGroupActivator&&l.root.register(p.value,l.id.value,i)}),kr(()=>{!l.isGroupActivator&&l.root.unregister(p.value)}),i&&Ir(bd,_),_},sE=()=>{const e=ni(bd,CS);Ir(bd,{...e,isGroupActivator:!0})};function qy(){const e=an(!1);return yi(()=>{window.requestAnimationFrame(()=>{e.value=!0})}),{ssrBootStyles:ue(()=>e.value?void 0:{transition:"none !important"}),isBooted:Cd(e)}}const oE=yu({name:"VListGroupActivator",setup(e,i){let{slots:l}=i;return sE(),()=>{var h;return(h=l.default)==null?void 0:h.call(l)}}}),lE=Ct({activeColor:String,baseColor:String,color:String,collapseIcon:{type:jn,default:"$collapse"},expandIcon:{type:jn,default:"$expand"},prependIcon:jn,appendIcon:jn,fluid:Boolean,subgroup:Boolean,title:String,value:null,...xn(),...Ti()},"VListGroup"),vx=qt()({name:"VListGroup",props:lE(),setup(e,i){let{slots:l}=i;const{isOpen:h,open:p,id:_}=TS(nn(e,"value"),!0),m=ue(()=>`v-list-group--id-${String(_.value)}`),o=bS(),{isBooted:T}=qy();function k(z){z.stopPropagation(),p(!h.value,z)}const M=ue(()=>({onClick:k,class:"v-list-group__header",id:m.value})),D=ue(()=>h.value?e.collapseIcon:e.expandIcon),O=ue(()=>({VListItem:{active:h.value,activeColor:e.activeColor,baseColor:e.baseColor,color:e.color,prependIcon:e.prependIcon||e.subgroup&&D.value,appendIcon:e.appendIcon||!e.subgroup&&D.value,title:e.title,value:e.value}}));return dn(()=>A(e.tag,{class:["v-list-group",{"v-list-group--prepend":o==null?void 0:o.hasPrepend.value,"v-list-group--fluid":e.fluid,"v-list-group--subgroup":e.subgroup,"v-list-group--open":h.value},e.class],style:e.style},{default:()=>[l.activator&&A(Bi,{defaults:O.value},{default:()=>[A(oE,null,{default:()=>[l.activator({props:M.value,isOpen:h.value})]})]}),A(eo,{transition:{component:QI},disabled:!T.value},{default:()=>{var z;return[Tr(A("div",{class:"v-list-group__items",role:"group","aria-labelledby":m.value},[(z=l.default)==null?void 0:z.call(l)]),[[Ql,h.value]])]}})]})),{isOpen:h}}});const cE=Ct({opacity:[Number,String],...xn(),...Ti()},"VListItemSubtitle"),uE=qt()({name:"VListItemSubtitle",props:cE(),setup(e,i){let{slots:l}=i;return dn(()=>A(e.tag,{class:["v-list-item-subtitle",e.class],style:[{"--v-list-item-subtitle-opacity":e.opacity},e.style]},l)),{}}}),hE=vm("v-list-item-title"),dE=Ct({active:{type:Boolean,default:void 0},activeClass:String,activeColor:String,appendAvatar:String,appendIcon:jn,baseColor:String,disabled:Boolean,lines:[Boolean,String],link:{type:Boolean,default:void 0},nav:Boolean,prependAvatar:String,prependIcon:jn,ripple:{type:[Boolean,Object],default:!0},slim:Boolean,subtitle:[String,Number],title:[String,Number],value:null,onClick:ra(),onClickOnce:ra(),...so(),...xn(),...Ca(),...Oa(),...lo(),...oa(),...Tm(),...Ti(),...Di(),...ks({variant:"text"})},"VListItem"),es=qt()({name:"VListItem",directives:{Ripple:zd},props:dE(),emits:{click:e=>!0},setup(e,i){let{attrs:l,slots:h,emit:p}=i;const _=Cm(e,l),m=ue(()=>e.value===void 0?_.href.value:e.value),{activate:o,isActivated:T,select:k,isOpen:M,isSelected:D,isIndeterminate:O,isGroupActivator:z,root:F,parent:N,openOnSelect:q,id:oe}=TS(m,!1),_e=bS(),Se=ue(()=>{var zt;return e.active!==!1&&(e.active||((zt=_.isActive)==null?void 0:zt.value)||(F.activatable.value?T.value:D.value))}),pe=ue(()=>e.link!==!1&&_.isLink.value),be=ue(()=>!!_e&&(F.selectable.value||F.activatable.value||e.value!=null)),de=ue(()=>!e.disabled&&e.link!==!1&&(e.link||_.isClickable.value||be.value)),Ce=ue(()=>e.rounded||e.nav),ye=ue(()=>e.color??e.activeColor),Me=ue(()=>({color:Se.value?ye.value??e.baseColor:e.baseColor,variant:e.variant}));Qt(()=>{var zt;return(zt=_.isActive)==null?void 0:zt.value},zt=>{zt&&ke()}),Pd(()=>{var zt;(zt=_.isActive)!=null&&zt.value&&ke()});function ke(){N.value!=null&&F.open(N.value,!0),q(!0)}const{themeClasses:Ee}=Hi(e),{borderClasses:xe}=oo(e),{colorClasses:Fe,colorStyles:We,variantClasses:ht}=tc(Me),{densityClasses:Ne}=Na(e),{dimensionStyles:tt}=Va(e),{elevationClasses:Mt}=co(e),{roundedClasses:_t}=la(Ce),Qe=ue(()=>e.lines?`v-list-item--${e.lines}-line`:void 0),ct=ue(()=>({isActive:Se.value,select:k,isOpen:M.value,isSelected:D.value,isIndeterminate:O.value}));function Dt(zt){var Kt;p("click",zt),de.value&&((Kt=_.navigate)==null||Kt.call(_,zt),!z&&(F.activatable.value?o(!T.value,zt):(F.selectable.value||e.value!=null)&&k(!D.value,zt)))}function Yt(zt){(zt.key==="Enter"||zt.key===" ")&&(zt.preventDefault(),zt.target.dispatchEvent(new MouseEvent("click",zt)))}return dn(()=>{const zt=pe.value?"a":e.tag,Kt=h.title||e.title!=null,Zt=h.subtitle||e.subtitle!=null,_n=!!(e.appendAvatar||e.appendIcon),bn=!!(_n||h.append),Vn=!!(e.prependAvatar||e.prependIcon),On=!!(Vn||h.prepend);return _e==null||_e.updateHasPrepend(On),e.activeColor&&kI("active-color",["color","base-color"]),Tr(A(zt,sn({class:["v-list-item",{"v-list-item--active":Se.value,"v-list-item--disabled":e.disabled,"v-list-item--link":de.value,"v-list-item--nav":e.nav,"v-list-item--prepend":!On&&(_e==null?void 0:_e.hasPrepend.value),"v-list-item--slim":e.slim,[`${e.activeClass}`]:e.activeClass&&Se.value},Ee.value,xe.value,Fe.value,Ne.value,Mt.value,Qe.value,_t.value,ht.value,e.class],style:[We.value,tt.value,e.style],tabindex:de.value?_e?-2:0:void 0,"aria-selected":be.value?F.activatable.value?T.value:F.selectable.value?D.value:Se.value:void 0,onClick:Dt,onKeydown:de.value&&!pe.value&&Yt},_.linkProps),{default:()=>{var ri;return[ec(de.value||Se.value,"v-list-item"),On&&A("div",{key:"prepend",class:"v-list-item__prepend"},[h.prepend?A(Bi,{key:"prepend-defaults",disabled:!Vn,defaults:{VAvatar:{density:e.density,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon},VListItemAction:{start:!0}}},{default:()=>{var En;return[(En=h.prepend)==null?void 0:En.call(h,ct.value)]}}):A(cn,null,[e.prependAvatar&&A(Kl,{key:"prepend-avatar",density:e.density,image:e.prependAvatar},null),e.prependIcon&&A(li,{key:"prepend-icon",density:e.density,icon:e.prependIcon},null)]),A("div",{class:"v-list-item__spacer"},null)]),A("div",{class:"v-list-item__content","data-no-activator":""},[Kt&&A(hE,{key:"title"},{default:()=>{var En;return[((En=h.title)==null?void 0:En.call(h,{title:e.title}))??e.title]}}),Zt&&A(uE,{key:"subtitle"},{default:()=>{var En;return[((En=h.subtitle)==null?void 0:En.call(h,{subtitle:e.subtitle}))??e.subtitle]}}),(ri=h.default)==null?void 0:ri.call(h,ct.value)]),bn&&A("div",{key:"append",class:"v-list-item__append"},[h.append?A(Bi,{key:"append-defaults",disabled:!_n,defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon},VListItemAction:{end:!0}}},{default:()=>{var En;return[(En=h.append)==null?void 0:En.call(h,ct.value)]}}):A(cn,null,[e.appendIcon&&A(li,{key:"append-icon",density:e.density,icon:e.appendIcon},null),e.appendAvatar&&A(Kl,{key:"append-avatar",density:e.density,image:e.appendAvatar},null)]),A("div",{class:"v-list-item__spacer"},null)])]}}),[[ao("ripple"),de.value&&e.ripple]])}),{activate:o,isActivated:T,isGroupActivator:z,isSelected:D,list:_e,select:k,root:F,id:oe}}}),fE=Ct({color:String,inset:Boolean,sticky:Boolean,title:String,...xn(),...Ti()},"VListSubheader"),pE=qt()({name:"VListSubheader",props:fE(),setup(e,i){let{slots:l}=i;const{textColorClasses:h,textColorStyles:p}=as(nn(e,"color"));return dn(()=>{const _=!!(l.default||e.title);return A(e.tag,{class:["v-list-subheader",{"v-list-subheader--inset":e.inset,"v-list-subheader--sticky":e.sticky},h.value,e.class],style:[{textColorStyles:p},e.style]},{default:()=>{var m;return[_&&A("div",{class:"v-list-subheader__text"},[((m=l.default)==null?void 0:m.call(l))??e.title])]}})}),{}}});const mE=Ct({color:String,inset:Boolean,length:[Number,String],opacity:[Number,String],thickness:[Number,String],vertical:Boolean,...xn(),...Di()},"VDivider"),PS=qt()({name:"VDivider",props:mE(),setup(e,i){let{attrs:l,slots:h}=i;const{themeClasses:p}=Hi(e),{textColorClasses:_,textColorStyles:m}=as(nn(e,"color")),o=ue(()=>{const T={};return e.length&&(T[e.vertical?"height":"width"]=mn(e.length)),e.thickness&&(T[e.vertical?"borderRightWidth":"borderTopWidth"]=mn(e.thickness)),T});return dn(()=>{const T=A("hr",{class:[{"v-divider":!0,"v-divider--inset":e.inset,"v-divider--vertical":e.vertical},p.value,_.value,e.class],style:[o.value,m.value,{"--v-border-opacity":e.opacity},e.style],"aria-orientation":!l.role||l.role==="separator"?e.vertical?"vertical":"horizontal":void 0,role:`${l.role||"separator"}`},null);return h.default?A("div",{class:["v-divider__wrapper",{"v-divider__wrapper--vertical":e.vertical,"v-divider__wrapper--inset":e.inset}]},[T,A("div",{class:"v-divider__content"},[h.default()]),T]):T}),{}}}),gE=Ct({items:Array,returnObject:Boolean},"VListChildren"),kS=qt()({name:"VListChildren",props:gE(),setup(e,i){let{slots:l}=i;return vS(),()=>{var h,p;return((h=l.default)==null?void 0:h.call(l))??((p=e.items)==null?void 0:p.map(_=>{var O,z;let{children:m,props:o,type:T,raw:k}=_;if(T==="divider")return((O=l.divider)==null?void 0:O.call(l,{props:o}))??A(PS,o,null);if(T==="subheader")return((z=l.subheader)==null?void 0:z.call(l,{props:o}))??A(pE,o,null);const M={subtitle:l.subtitle?F=>{var N;return(N=l.subtitle)==null?void 0:N.call(l,{...F,item:k})}:void 0,prepend:l.prepend?F=>{var N;return(N=l.prepend)==null?void 0:N.call(l,{...F,item:k})}:void 0,append:l.append?F=>{var N;return(N=l.append)==null?void 0:N.call(l,{...F,item:k})}:void 0,title:l.title?F=>{var N;return(N=l.title)==null?void 0:N.call(l,{...F,item:k})}:void 0},D=vx.filterProps(o);return m?A(vx,sn({value:o==null?void 0:o.value},D),{activator:F=>{let{props:N}=F;const q={...o,...N,value:e.returnObject?k:o.value};return l.header?l.header({props:q}):A(es,q,M)},default:()=>A(kS,{items:m,returnObject:e.returnObject},l)}):l.item?l.item({props:o}):A(es,sn(o,{value:e.returnObject?k:o.value}),M)}))}}}),IS=Ct({items:{type:Array,default:()=>[]},itemTitle:{type:[String,Array,Function],default:"title"},itemValue:{type:[String,Array,Function],default:"value"},itemChildren:{type:[Boolean,String,Array,Function],default:"children"},itemProps:{type:[Boolean,String,Array,Function],default:"props"},returnObject:Boolean,valueComparator:{type:Function,default:_u}},"list-items");function W_(e,i){const l=Qs(i,e.itemTitle,i),h=Qs(i,e.itemValue,l),p=Qs(i,e.itemChildren),_=e.itemProps===!0?typeof i=="object"&&i!=null&&!Array.isArray(i)?"children"in i?Ts(i,["children"]):i:void 0:Qs(i,e.itemProps),m={title:l,value:h,..._};return{title:String(m.title??""),value:m.value,props:m,children:Array.isArray(p)?MS(e,p):void 0,raw:i}}function MS(e,i){const l=[];for(const h of i)l.push(W_(e,h));return l}function _E(e){const i=ue(()=>MS(e,e.items)),l=ue(()=>i.value.some(_=>_.value===null));function h(_){return l.value||(_=_.filter(m=>m!==null)),_.map(m=>e.returnObject&&typeof m=="string"?W_(e,m):i.value.find(o=>e.valueComparator(m,o.value))||W_(e,m))}function p(_){return e.returnObject?_.map(m=>{let{raw:o}=m;return o}):_.map(m=>{let{value:o}=m;return o})}return{items:i,transformIn:h,transformOut:p}}function yE(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"}function vE(e,i){const l=Qs(i,e.itemType,"item"),h=yE(i)?i:Qs(i,e.itemTitle),p=Qs(i,e.itemValue,void 0),_=Qs(i,e.itemChildren),m=e.itemProps===!0?Ts(i,["children"]):Qs(i,e.itemProps),o={title:h,value:p,...m};return{type:l,title:o.title,value:o.value,props:o,children:l==="item"&&_?ES(e,_):void 0,raw:i}}function ES(e,i){const l=[];for(const h of i)l.push(vE(e,h));return l}function bE(e){return{items:ue(()=>ES(e,e.items))}}const xE=Ct({baseColor:String,activeColor:String,activeClass:String,bgColor:String,disabled:Boolean,expandIcon:jn,collapseIcon:jn,lines:{type:[Boolean,String],default:"one"},slim:Boolean,nav:Boolean,"onClick:open":ra(),"onClick:select":ra(),"onUpdate:opened":ra(),...rE({selectStrategy:"single-leaf",openStrategy:"list"}),...so(),...xn(),...Ca(),...Oa(),...lo(),itemType:{type:String,default:"type"},...IS(),...oa(),...Ti(),...Di(),...ks({variant:"text"})},"VList"),Wy=qt()({name:"VList",props:xE(),emits:{"update:selected":e=>!0,"update:activated":e=>!0,"update:opened":e=>!0,"click:open":e=>!0,"click:activate":e=>!0,"click:select":e=>!0},setup(e,i){let{slots:l}=i;const{items:h}=bE(e),{themeClasses:p}=Hi(e),{backgroundColorClasses:_,backgroundColorStyles:m}=La(nn(e,"bgColor")),{borderClasses:o}=oo(e),{densityClasses:T}=Na(e),{dimensionStyles:k}=Va(e),{elevationClasses:M}=co(e),{roundedClasses:D}=la(e),{children:O,open:z,parents:F,select:N,getPath:q}=aE(e),oe=ue(()=>e.lines?`v-list--${e.lines}-line`:void 0),_e=nn(e,"activeColor"),Se=nn(e,"baseColor"),pe=nn(e,"color");vS(),Qo({VListGroup:{activeColor:_e,baseColor:Se,color:pe,expandIcon:nn(e,"expandIcon"),collapseIcon:nn(e,"collapseIcon")},VListItem:{activeClass:nn(e,"activeClass"),activeColor:_e,baseColor:Se,color:pe,density:nn(e,"density"),disabled:nn(e,"disabled"),lines:nn(e,"lines"),nav:nn(e,"nav"),slim:nn(e,"slim"),variant:nn(e,"variant")}});const be=an(!1),de=Ye();function Ce(Fe){be.value=!0}function ye(Fe){be.value=!1}function Me(Fe){var We;!be.value&&!(Fe.relatedTarget&&((We=de.value)!=null&&We.contains(Fe.relatedTarget)))&&xe()}function ke(Fe){const We=Fe.target;if(!(!de.value||["INPUT","TEXTAREA"].includes(We.tagName))){if(Fe.key==="ArrowDown")xe("next");else if(Fe.key==="ArrowUp")xe("prev");else if(Fe.key==="Home")xe("first");else if(Fe.key==="End")xe("last");else return;Fe.preventDefault()}}function Ee(Fe){be.value=!0}function xe(Fe){if(de.value)return ad(de.value,Fe)}return dn(()=>A(e.tag,{ref:de,class:["v-list",{"v-list--disabled":e.disabled,"v-list--nav":e.nav,"v-list--slim":e.slim},p.value,_.value,o.value,T.value,M.value,oe.value,D.value,e.class],style:[m.value,k.value,e.style],tabindex:e.disabled||be.value?-1:0,role:"listbox","aria-activedescendant":void 0,onFocusin:Ce,onFocusout:ye,onFocus:Me,onKeydown:ke,onMousedown:Ee},{default:()=>[A(kS,{items:h.value,returnObject:e.returnObject},l)]})),{open:z,select:N,focus:xe,children:O,parents:F,getPath:q}}});function wE(e){let{rootEl:i,isSticky:l,layoutItemStyles:h}=e;const p=an(!1),_=an(0),m=ue(()=>{const k=typeof p.value=="boolean"?"top":p.value;return[l.value?{top:"auto",bottom:"auto",height:void 0}:void 0,p.value?{[k]:mn(_.value)}:{top:h.value.top}]});yi(()=>{Qt(l,k=>{k?window.addEventListener("scroll",T,{passive:!0}):window.removeEventListener("scroll",T)},{immediate:!0})}),kr(()=>{window.removeEventListener("scroll",T)});let o=0;function T(){const k=o>window.scrollY?"up":"down",M=i.value.getBoundingClientRect(),D=parseFloat(h.value.top??0),O=window.scrollY-Math.max(0,_.value-D),z=M.height+Math.max(_.value,D)-window.scrollY-window.innerHeight,F=parseFloat(getComputedStyle(i.value).getPropertyValue("--v-body-scroll-y"))||0;M.height<window.innerHeight-D?(p.value="top",_.value=D):k==="up"&&p.value==="bottom"||k==="down"&&p.value==="top"?(_.value=window.scrollY+M.top-F,p.value=!0):k==="down"&&z<=0?(_.value=0,p.value="bottom"):k==="up"&&O<=0&&(F?p.value!=="top"&&(_.value=-O+F+D,p.value="top"):(_.value=M.top+O,p.value="top")),o=window.scrollY}return{isStuck:p,stickyStyles:m}}const SE=100,CE=20;function bx(e){const i=1.41421356237;return(e<0?-1:1)*Math.sqrt(Math.abs(e))*i}function xx(e){if(e.length<2)return 0;if(e.length===2)return e[1].t===e[0].t?0:(e[1].d-e[0].d)/(e[1].t-e[0].t);let i=0;for(let l=e.length-1;l>0;l--){if(e[l].t===e[l-1].t)continue;const h=bx(i),p=(e[l].d-e[l-1].d)/(e[l].t-e[l-1].t);i+=(p-h)*Math.abs(p),l===e.length-1&&(i*=.5)}return bx(i)*1e3}function TE(){const e={};function i(p){Array.from(p.changedTouches).forEach(_=>{(e[_.identifier]??(e[_.identifier]=new pI(CE))).push([p.timeStamp,_])})}function l(p){Array.from(p.changedTouches).forEach(_=>{delete e[_.identifier]})}function h(p){var k;const _=(k=e[p])==null?void 0:k.values().reverse();if(!_)throw new Error(`No samples for touch id ${p}`);const m=_[0],o=[],T=[];for(const M of _){if(m[0]-M[0]>SE)break;o.push({t:M[0],d:M[1].clientX}),T.push({t:M[0],d:M[1].clientY})}return{x:xx(o),y:xx(T),get direction(){const{x:M,y:D}=this,[O,z]=[Math.abs(M),Math.abs(D)];return O>z&&M>=0?"right":O>z&&M<=0?"left":z>O&&D>=0?"down":z>O&&D<=0?"up":PE()}}}return{addMovement:i,endTouch:l,getVelocity:h}}function PE(){throw new Error}function kE(e){let{el:i,isActive:l,isTemporary:h,width:p,touchless:_,position:m}=e;yi(()=>{window.addEventListener("touchstart",_e,{passive:!0}),window.addEventListener("touchmove",Se,{passive:!1}),window.addEventListener("touchend",pe,{passive:!0})}),kr(()=>{window.removeEventListener("touchstart",_e),window.removeEventListener("touchmove",Se),window.removeEventListener("touchend",pe)});const o=ue(()=>["left","right"].includes(m.value)),{addMovement:T,endTouch:k,getVelocity:M}=TE();let D=!1;const O=an(!1),z=an(0),F=an(0);let N;function q(de,Ce){return(m.value==="left"?de:m.value==="right"?document.documentElement.clientWidth-de:m.value==="top"?de:m.value==="bottom"?document.documentElement.clientHeight-de:ru())-(Ce?p.value:0)}function oe(de){let Ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const ye=m.value==="left"?(de-F.value)/p.value:m.value==="right"?(document.documentElement.clientWidth-de-F.value)/p.value:m.value==="top"?(de-F.value)/p.value:m.value==="bottom"?(document.documentElement.clientHeight-de-F.value)/p.value:ru();return Ce?Math.max(0,Math.min(1,ye)):ye}function _e(de){if(_.value)return;const Ce=de.changedTouches[0].clientX,ye=de.changedTouches[0].clientY,Me=25,ke=m.value==="left"?Ce<Me:m.value==="right"?Ce>document.documentElement.clientWidth-Me:m.value==="top"?ye<Me:m.value==="bottom"?ye>document.documentElement.clientHeight-Me:ru(),Ee=l.value&&(m.value==="left"?Ce<p.value:m.value==="right"?Ce>document.documentElement.clientWidth-p.value:m.value==="top"?ye<p.value:m.value==="bottom"?ye>document.documentElement.clientHeight-p.value:ru());(ke||Ee||l.value&&h.value)&&(N=[Ce,ye],F.value=q(o.value?Ce:ye,l.value),z.value=oe(o.value?Ce:ye),D=F.value>-20&&F.value<80,k(de),T(de))}function Se(de){const Ce=de.changedTouches[0].clientX,ye=de.changedTouches[0].clientY;if(D){if(!de.cancelable){D=!1;return}const ke=Math.abs(Ce-N[0]),Ee=Math.abs(ye-N[1]);(o.value?ke>Ee&&ke>3:Ee>ke&&Ee>3)?(O.value=!0,D=!1):(o.value?Ee:ke)>3&&(D=!1)}if(!O.value)return;de.preventDefault(),T(de);const Me=oe(o.value?Ce:ye,!1);z.value=Math.max(0,Math.min(1,Me)),Me>1?F.value=q(o.value?Ce:ye,!0):Me<0&&(F.value=q(o.value?Ce:ye,!1))}function pe(de){if(D=!1,!O.value)return;T(de),O.value=!1;const Ce=M(de.changedTouches[0].identifier),ye=Math.abs(Ce.x),Me=Math.abs(Ce.y);(o.value?ye>Me&&ye>400:Me>ye&&Me>3)?l.value=Ce.direction===({left:"right",right:"left",top:"down",bottom:"up"}[m.value]||ru()):l.value=z.value>.5}const be=ue(()=>O.value?{transform:m.value==="left"?`translateX(calc(-100% + ${z.value*p.value}px))`:m.value==="right"?`translateX(calc(100% - ${z.value*p.value}px))`:m.value==="top"?`translateY(calc(-100% + ${z.value*p.value}px))`:m.value==="bottom"?`translateY(calc(100% - ${z.value*p.value}px))`:ru(),transition:"none"}:void 0);return Ba(O,()=>{var ye,Me;const de=((ye=i.value)==null?void 0:ye.style.transform)??null,Ce=((Me=i.value)==null?void 0:Me.style.transition)??null;xa(()=>{var ke,Ee,xe,Fe;(Ee=i.value)==null||Ee.style.setProperty("transform",((ke=be.value)==null?void 0:ke.transform)||"none"),(Fe=i.value)==null||Fe.style.setProperty("transition",((xe=be.value)==null?void 0:xe.transition)||null)}),Pr(()=>{var ke,Ee;(ke=i.value)==null||ke.style.setProperty("transform",de),(Ee=i.value)==null||Ee.style.setProperty("transition",Ce)})}),{isDragging:O,dragProgress:z,dragStyles:be}}function ru(){throw new Error}const Pm={"001":1,AD:1,AE:6,AF:6,AG:0,AI:1,AL:1,AM:1,AN:1,AR:1,AS:0,AT:1,AU:1,AX:1,AZ:1,BA:1,BD:0,BE:1,BG:1,BH:6,BM:1,BN:1,BR:0,BS:0,BT:0,BW:0,BY:1,BZ:0,CA:0,CH:1,CL:1,CM:1,CN:1,CO:0,CR:1,CY:1,CZ:1,DE:1,DJ:6,DK:1,DM:0,DO:0,DZ:6,EC:1,EE:1,EG:6,ES:1,ET:0,FI:1,FJ:1,FO:1,FR:1,GB:1,"GB-alt-variant":0,GE:1,GF:1,GP:1,GR:1,GT:0,GU:0,HK:0,HN:0,HR:1,HU:1,ID:0,IE:1,IL:0,IN:0,IQ:6,IR:6,IS:1,IT:1,JM:0,JO:6,JP:0,KE:0,KG:1,KH:0,KR:0,KW:6,KZ:1,LA:0,LB:1,LI:1,LK:1,LT:1,LU:1,LV:1,LY:6,MC:1,MD:1,ME:1,MH:0,MK:1,MM:0,MN:1,MO:0,MQ:1,MT:0,MV:5,MX:0,MY:1,MZ:0,NI:0,NL:1,NO:1,NP:0,NZ:1,OM:6,PA:0,PE:0,PH:0,PK:0,PL:1,PR:0,PT:0,PY:0,QA:6,RE:1,RO:1,RS:1,RU:1,SA:0,SD:6,SE:1,SG:0,SI:1,SK:1,SM:1,SV:0,SY:6,TH:0,TJ:1,TM:1,TR:1,TT:0,TW:0,UA:1,UM:0,US:0,UY:1,UZ:1,VA:1,VE:0,VI:0,VN:1,WS:0,XK:1,YE:0,ZA:0,ZW:0};function IE(e,i,l){const h=[];let p=[];const _=AS(e),m=RS(e),o=l??Pm[i.slice(-2).toUpperCase()]??0,T=(_.getDay()-o+7)%7,k=(m.getDay()-o+7)%7;for(let M=0;M<T;M++){const D=new Date(_);D.setDate(D.getDate()-(T-M)),p.push(D)}for(let M=1;M<=m.getDate();M++){const D=new Date(e.getFullYear(),e.getMonth(),M);p.push(D),p.length===7&&(h.push(p),p=[])}for(let M=1;M<7-k;M++){const D=new Date(m);D.setDate(D.getDate()+M),p.push(D)}return p.length>0&&h.push(p),h}function ME(e,i,l){const h=l??Pm[i.slice(-2).toUpperCase()]??0,p=new Date(e);for(;p.getDay()!==h;)p.setDate(p.getDate()-1);return p}function EE(e,i){const l=new Date(e),h=((Pm[i.slice(-2).toUpperCase()]??0)+6)%7;for(;l.getDay()!==h;)l.setDate(l.getDate()+1);return l}function AS(e){return new Date(e.getFullYear(),e.getMonth(),1)}function RS(e){return new Date(e.getFullYear(),e.getMonth()+1,0)}function AE(e){const i=e.split("-").map(Number);return new Date(i[0],i[1]-1,i[2])}const RE=/^([12]\d{3}-([1-9]|0[1-9]|1[0-2])-([1-9]|0[1-9]|[12]\d|3[01]))$/;function DS(e){if(e==null)return new Date;if(e instanceof Date)return e;if(typeof e=="string"){let i;if(RE.test(e))return AE(e);if(i=Date.parse(e),!isNaN(i))return new Date(i)}return null}const wx=new Date(2e3,0,2);function DE(e,i){const l=i??Pm[e.slice(-2).toUpperCase()]??0;return Pw(7).map(h=>{const p=new Date(wx);return p.setDate(wx.getDate()+l+h),new Intl.DateTimeFormat(e,{weekday:"narrow"}).format(p)})}function zE(e,i,l,h){const p=DS(e)??new Date,_=h==null?void 0:h[i];if(typeof _=="function")return _(p,i,l);let m={};switch(i){case"fullDate":m={year:"numeric",month:"long",day:"numeric"};break;case"fullDateWithWeekday":m={weekday:"long",year:"numeric",month:"long",day:"numeric"};break;case"normalDate":const o=p.getDate(),T=new Intl.DateTimeFormat(l,{month:"long"}).format(p);return`${o} ${T}`;case"normalDateWithWeekday":m={weekday:"short",day:"numeric",month:"short"};break;case"shortDate":m={month:"short",day:"numeric"};break;case"year":m={year:"numeric"};break;case"month":m={month:"long"};break;case"monthShort":m={month:"short"};break;case"monthAndYear":m={month:"long",year:"numeric"};break;case"monthAndDate":m={month:"long",day:"numeric"};break;case"weekday":m={weekday:"long"};break;case"weekdayShort":m={weekday:"short"};break;case"dayOfMonth":return new Intl.NumberFormat(l).format(p.getDate());case"hours12h":m={hour:"numeric",hour12:!0};break;case"hours24h":m={hour:"numeric",hour12:!1};break;case"minutes":m={minute:"numeric"};break;case"seconds":m={second:"numeric"};break;case"fullTime":m={hour:"numeric",minute:"numeric",second:"numeric",hour12:!0};break;case"fullTime12h":m={hour:"numeric",minute:"numeric",second:"numeric",hour12:!0};break;case"fullTime24h":m={hour:"numeric",minute:"numeric",second:"numeric",hour12:!1};break;case"fullDateTime":m={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0};break;case"fullDateTime12h":m={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0};break;case"fullDateTime24h":m={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1};break;case"keyboardDate":m={year:"numeric",month:"2-digit",day:"2-digit"};break;case"keyboardDateTime":m={year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1};break;case"keyboardDateTime12h":m={year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0};break;case"keyboardDateTime24h":m={year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1};break;default:m=_??{timeZone:"UTC",timeZoneName:"short"}}return new Intl.DateTimeFormat(l,m).format(p)}function LE(e,i){const l=e.toJsDate(i),h=l.getFullYear(),p=Vb(String(l.getMonth()+1),2,"0"),_=Vb(String(l.getDate()),2,"0");return`${h}-${p}-${_}`}function BE(e){const[i,l,h]=e.split("-").map(Number);return new Date(i,l-1,h)}function FE(e,i){const l=new Date(e);return l.setMinutes(l.getMinutes()+i),l}function OE(e,i){const l=new Date(e);return l.setHours(l.getHours()+i),l}function VE(e,i){const l=new Date(e);return l.setDate(l.getDate()+i),l}function NE(e,i){const l=new Date(e);return l.setDate(l.getDate()+i*7),l}function $E(e,i){const l=new Date(e);return l.setDate(1),l.setMonth(l.getMonth()+i),l}function jE(e){return e.getFullYear()}function UE(e){return e.getMonth()}function GE(e){return e.getDate()}function HE(e){return new Date(e.getFullYear(),e.getMonth()+1,1)}function ZE(e){return new Date(e.getFullYear(),e.getMonth()-1,1)}function qE(e){return e.getHours()}function WE(e){return e.getMinutes()}function XE(e){return new Date(e.getFullYear(),0,1)}function KE(e){return new Date(e.getFullYear(),11,31)}function YE(e,i){return Kp(e,i[0])&&eA(e,i[1])}function JE(e){const i=new Date(e);return i instanceof Date&&!isNaN(i.getTime())}function Kp(e,i){return e.getTime()>i.getTime()}function QE(e,i){return Kp(X_(e),X_(i))}function eA(e,i){return e.getTime()<i.getTime()}function Sx(e,i){return e.getTime()===i.getTime()}function tA(e,i){return e.getDate()===i.getDate()&&e.getMonth()===i.getMonth()&&e.getFullYear()===i.getFullYear()}function nA(e,i){return e.getMonth()===i.getMonth()&&e.getFullYear()===i.getFullYear()}function iA(e,i){return e.getFullYear()===i.getFullYear()}function rA(e,i,l){const h=new Date(e),p=new Date(i);switch(l){case"years":return h.getFullYear()-p.getFullYear();case"quarters":return Math.floor((h.getMonth()-p.getMonth()+(h.getFullYear()-p.getFullYear())*12)/4);case"months":return h.getMonth()-p.getMonth()+(h.getFullYear()-p.getFullYear())*12;case"weeks":return Math.floor((h.getTime()-p.getTime())/(1e3*60*60*24*7));case"days":return Math.floor((h.getTime()-p.getTime())/(1e3*60*60*24));case"hours":return Math.floor((h.getTime()-p.getTime())/(1e3*60*60));case"minutes":return Math.floor((h.getTime()-p.getTime())/(1e3*60));case"seconds":return Math.floor((h.getTime()-p.getTime())/1e3);default:return h.getTime()-p.getTime()}}function aA(e,i){const l=new Date(e);return l.setHours(i),l}function sA(e,i){const l=new Date(e);return l.setMinutes(i),l}function oA(e,i){const l=new Date(e);return l.setMonth(i),l}function lA(e,i){const l=new Date(e);return l.setDate(i),l}function cA(e,i){const l=new Date(e);return l.setFullYear(i),l}function X_(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0)}function uA(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999)}class hA{constructor(i){this.locale=i.locale,this.formats=i.formats}date(i){return DS(i)}toJsDate(i){return i}toISO(i){return LE(this,i)}parseISO(i){return BE(i)}addMinutes(i,l){return FE(i,l)}addHours(i,l){return OE(i,l)}addDays(i,l){return VE(i,l)}addWeeks(i,l){return NE(i,l)}addMonths(i,l){return $E(i,l)}getWeekArray(i,l){return IE(i,this.locale,l?Number(l):void 0)}startOfWeek(i,l){return ME(i,this.locale,l?Number(l):void 0)}endOfWeek(i){return EE(i,this.locale)}startOfMonth(i){return AS(i)}endOfMonth(i){return RS(i)}format(i,l){return zE(i,l,this.locale,this.formats)}isEqual(i,l){return Sx(i,l)}isValid(i){return JE(i)}isWithinRange(i,l){return YE(i,l)}isAfter(i,l){return Kp(i,l)}isAfterDay(i,l){return QE(i,l)}isBefore(i,l){return!Kp(i,l)&&!Sx(i,l)}isSameDay(i,l){return tA(i,l)}isSameMonth(i,l){return nA(i,l)}isSameYear(i,l){return iA(i,l)}setMinutes(i,l){return sA(i,l)}setHours(i,l){return aA(i,l)}setMonth(i,l){return oA(i,l)}setDate(i,l){return lA(i,l)}setYear(i,l){return cA(i,l)}getDiff(i,l,h){return rA(i,l,h)}getWeekdays(i){return DE(this.locale,i?Number(i):void 0)}getYear(i){return jE(i)}getMonth(i){return UE(i)}getDate(i){return GE(i)}getNextMonth(i){return HE(i)}getPreviousMonth(i){return ZE(i)}getHours(i){return qE(i)}getMinutes(i){return WE(i)}startOfDay(i){return X_(i)}endOfDay(i){return uA(i)}startOfYear(i){return XE(i)}endOfYear(i){return KE(i)}}const dA=Symbol.for("vuetify:date-options"),Cx=Symbol.for("vuetify:date-adapter");function fA(e,i){const l=Fr({adapter:hA,locale:{af:"af-ZA",bg:"bg-BG",ca:"ca-ES",ckb:"",cs:"cs-CZ",de:"de-DE",el:"el-GR",en:"en-US",et:"et-EE",fa:"fa-IR",fi:"fi-FI",hr:"hr-HR",hu:"hu-HU",he:"he-IL",id:"id-ID",it:"it-IT",ja:"ja-JP",ko:"ko-KR",lv:"lv-LV",lt:"lt-LT",nl:"nl-NL",no:"no-NO",pl:"pl-PL",pt:"pt-PT",ro:"ro-RO",ru:"ru-RU",sk:"sk-SK",sl:"sl-SI",srCyrl:"sr-SP",srLatn:"sr-SP",sv:"sv-SE",th:"th-TH",tr:"tr-TR",az:"az-AZ",uk:"uk-UA",vi:"vi-VN",zhHans:"zh-CN",zhHant:"zh-TW"}},e);return{options:l,instance:pA(l,i)}}function pA(e,i){const l=yr(typeof e.adapter=="function"?new e.adapter({locale:e.locale[i.current.value]??i.current.value,formats:e.formats}):e.adapter);return Qt(i.current,h=>{l.locale=e.locale[h]??h??l.locale}),l}const xd=Symbol.for("vuetify:layout"),zS=Symbol.for("vuetify:layout-item"),Tx=1e3,LS=Ct({overlaps:{type:Array,default:()=>[]},fullHeight:Boolean},"layout"),mA=Ct({name:{type:String},order:{type:[Number,String],default:0},absolute:Boolean},"layout-item");function gA(){const e=ni(xd);if(!e)throw new Error("[Vuetify] Could not find injected layout");return{getLayoutItem:e.getLayoutItem,mainRect:e.mainRect,mainStyles:e.mainStyles}}function _A(e){const i=ni(xd);if(!i)throw new Error("[Vuetify] Could not find injected layout");const l=e.id??`layout-item-${wa()}`,h=Gi("useLayoutItem");Ir(zS,{id:l});const p=an(!1);vy(()=>p.value=!0),V1(()=>p.value=!1);const{layoutItemStyles:_,layoutItemScrimStyles:m}=i.register(h,{...e,active:ue(()=>p.value?!1:e.active.value),id:l});return kr(()=>i.unregister(l)),{layoutItemStyles:_,layoutRect:i.layoutRect,layoutItemScrimStyles:m}}const yA=(e,i,l,h)=>{let p={top:0,left:0,right:0,bottom:0};const _=[{id:"",layer:{...p}}];for(const m of e){const o=i.get(m),T=l.get(m),k=h.get(m);if(!o||!T||!k)continue;const M={...p,[o.value]:parseInt(p[o.value],10)+(k.value?parseInt(T.value,10):0)};_.push({id:m,layer:M}),p=M}return _};function BS(e){const i=ni(xd,null),l=ue(()=>i?i.rootZIndex.value-100:Tx),h=Ye([]),p=yr(new Map),_=yr(new Map),m=yr(new Map),o=yr(new Map),T=yr(new Map),{resizeRef:k,contentRect:M}=mu(),D=ue(()=>{const de=new Map,Ce=e.overlaps??[];for(const ye of Ce.filter(Me=>Me.includes(":"))){const[Me,ke]=ye.split(":");if(!h.value.includes(Me)||!h.value.includes(ke))continue;const Ee=p.get(Me),xe=p.get(ke),Fe=_.get(Me),We=_.get(ke);!Ee||!xe||!Fe||!We||(de.set(ke,{position:Ee.value,amount:parseInt(Fe.value,10)}),de.set(Me,{position:xe.value,amount:-parseInt(We.value,10)}))}return de}),O=ue(()=>{const de=[...new Set([...m.values()].map(ye=>ye.value))].sort((ye,Me)=>ye-Me),Ce=[];for(const ye of de){const Me=h.value.filter(ke=>{var Ee;return((Ee=m.get(ke))==null?void 0:Ee.value)===ye});Ce.push(...Me)}return yA(Ce,p,_,o)}),z=ue(()=>!Array.from(T.values()).some(de=>de.value)),F=ue(()=>O.value[O.value.length-1].layer),N=ue(()=>({"--v-layout-left":mn(F.value.left),"--v-layout-right":mn(F.value.right),"--v-layout-top":mn(F.value.top),"--v-layout-bottom":mn(F.value.bottom),...z.value?void 0:{transition:"none"}})),q=ue(()=>O.value.slice(1).map((de,Ce)=>{let{id:ye}=de;const{layer:Me}=O.value[Ce],ke=_.get(ye),Ee=p.get(ye);return{id:ye,...Me,size:Number(ke.value),position:Ee.value}})),oe=de=>q.value.find(Ce=>Ce.id===de),_e=Gi("createLayout"),Se=an(!1);yi(()=>{Se.value=!0}),Ir(xd,{register:(de,Ce)=>{let{id:ye,order:Me,position:ke,layoutSize:Ee,elementSize:xe,active:Fe,disableTransitions:We,absolute:ht}=Ce;m.set(ye,Me),p.set(ye,ke),_.set(ye,Ee),o.set(ye,Fe),We&&T.set(ye,We);const tt=lu(zS,_e==null?void 0:_e.vnode).indexOf(de);tt>-1?h.value.splice(tt,0,ye):h.value.push(ye);const Mt=ue(()=>q.value.findIndex(Dt=>Dt.id===ye)),_t=ue(()=>l.value+O.value.length*2-Mt.value*2),Qe=ue(()=>{const Dt=ke.value==="left"||ke.value==="right",Yt=ke.value==="right",zt=ke.value==="bottom",Kt=xe.value??Ee.value,Zt=Kt===0?"%":"px",_n={[ke.value]:0,zIndex:_t.value,transform:`translate${Dt?"X":"Y"}(${(Fe.value?0:-(Kt===0?100:Kt))*(Yt||zt?-1:1)}${Zt})`,position:ht.value||l.value!==Tx?"absolute":"fixed",...z.value?void 0:{transition:"none"}};if(!Se.value)return _n;const bn=q.value[Mt.value];if(!bn)throw new Error(`[Vuetify] Could not find layout item "${ye}"`);const Vn=D.value.get(ye);return Vn&&(bn[Vn.position]+=Vn.amount),{..._n,height:Dt?`calc(100% - ${bn.top}px - ${bn.bottom}px)`:xe.value?`${xe.value}px`:void 0,left:Yt?void 0:`${bn.left}px`,right:Yt?`${bn.right}px`:void 0,top:ke.value!=="bottom"?`${bn.top}px`:void 0,bottom:ke.value!=="top"?`${bn.bottom}px`:void 0,width:Dt?xe.value?`${xe.value}px`:void 0:`calc(100% - ${bn.left}px - ${bn.right}px)`}}),ct=ue(()=>({zIndex:_t.value-1}));return{layoutItemStyles:Qe,layoutItemScrimStyles:ct,zIndex:_t}},unregister:de=>{m.delete(de),p.delete(de),_.delete(de),o.delete(de),T.delete(de),h.value=h.value.filter(Ce=>Ce!==de)},mainRect:F,mainStyles:N,getLayoutItem:oe,items:q,layoutRect:M,rootZIndex:l});const pe=ue(()=>["v-layout",{"v-layout--full-height":e.fullHeight}]),be=ue(()=>({zIndex:i?l.value:void 0,position:i?"relative":void 0,overflow:i?"hidden":void 0}));return{layoutClasses:pe,layoutStyles:be,getLayoutItem:oe,items:q,layoutRect:M,layoutRef:k}}const FS=Ct({closeDelay:[Number,String],openDelay:[Number,String]},"delay");function OS(e,i){let l=()=>{};function h(m){l==null||l();const o=Number(m?e.openDelay:e.closeDelay);return new Promise(T=>{l=mI(o,()=>{i==null||i(m),T(m)})})}function p(){return h(!0)}function _(){return h(!1)}return{clearDelay:l,runOpenDelay:p,runCloseDelay:_}}function nc(){const i=Gi("useScopeId").vnode.scopeId;return{scopeId:i?{[i]:""}:void 0}}const vA=["start","end","left","right","top","bottom"],bA=Ct({color:String,disableResizeWatcher:Boolean,disableRouteWatcher:Boolean,expandOnHover:Boolean,floating:Boolean,modelValue:{type:Boolean,default:null},permanent:Boolean,rail:{type:Boolean,default:null},railWidth:{type:[Number,String],default:56},scrim:{type:[Boolean,String],default:!0},image:String,temporary:Boolean,persistent:Boolean,touchless:Boolean,width:{type:[Number,String],default:256},location:{type:String,default:"start",validator:e=>vA.includes(e)},sticky:Boolean,...so(),...xn(),...FS(),...eS({mobile:null}),...lo(),...mA(),...oa(),...Ti({tag:"nav"}),...Di()},"VNavigationDrawer"),xA=qt()({name:"VNavigationDrawer",props:bA(),emits:{"update:modelValue":e=>!0,"update:rail":e=>!0},setup(e,i){let{attrs:l,emit:h,slots:p}=i;const{isRtl:_}=$a(),{themeClasses:m}=Hi(e),{borderClasses:o}=oo(e),{backgroundColorClasses:T,backgroundColorStyles:k}=La(nn(e,"color")),{elevationClasses:M}=co(e),{displayClasses:D,mobile:O}=wm(e),{roundedClasses:z}=la(e),F=uS(),N=ii(e,"modelValue",null,ct=>!!ct),{ssrBootStyles:q}=qy(),{scopeId:oe}=nc(),_e=Ye(),Se=an(!1),{runOpenDelay:pe,runCloseDelay:be}=OS(e,ct=>{Se.value=ct}),de=ue(()=>e.rail&&e.expandOnHover&&Se.value?Number(e.width):Number(e.rail?e.railWidth:e.width)),Ce=ue(()=>$_(e.location,_.value)),ye=ue(()=>e.persistent),Me=ue(()=>!e.permanent&&(O.value||e.temporary)),ke=ue(()=>e.sticky&&!Me.value&&Ce.value!=="bottom");Ba(()=>e.expandOnHover&&e.rail!=null,()=>{Qt(Se,ct=>h("update:rail",!ct))}),Ba(()=>!e.disableResizeWatcher,()=>{Qt(Me,ct=>!e.permanent&&Fi(()=>N.value=!ct))}),Ba(()=>!e.disableRouteWatcher&&!!F,()=>{Qt(F.currentRoute,()=>Me.value&&(N.value=!1))}),Qt(()=>e.permanent,ct=>{ct&&(N.value=!0)}),e.modelValue==null&&!Me.value&&(N.value=e.permanent||!O.value);const{isDragging:Ee,dragProgress:xe}=kE({el:_e,isActive:N,isTemporary:Me,width:de,touchless:nn(e,"touchless"),position:Ce}),Fe=ue(()=>{const ct=Me.value?0:e.rail&&e.expandOnHover?Number(e.railWidth):de.value;return Ee.value?ct*xe.value:ct}),We=ue(()=>["top","bottom"].includes(e.location)?0:de.value),{layoutItemStyles:ht,layoutItemScrimStyles:Ne}=_A({id:e.name,order:ue(()=>parseInt(e.order,10)),position:Ce,layoutSize:Fe,elementSize:We,active:ue(()=>N.value||Ee.value),disableTransitions:ue(()=>Ee.value),absolute:ue(()=>e.absolute||ke.value&&typeof tt.value!="string")}),{isStuck:tt,stickyStyles:Mt}=wE({rootEl:_e,isSticky:ke,layoutItemStyles:ht}),_t=La(ue(()=>typeof e.scrim=="string"?e.scrim:null)),Qe=ue(()=>({...Ee.value?{opacity:xe.value*.2,transition:"none"}:void 0,...Ne.value}));return Qo({VList:{bgColor:"transparent"}}),dn(()=>{const ct=p.image||e.image;return A(cn,null,[A(e.tag,sn({ref:_e,onMouseenter:pe,onMouseleave:be,class:["v-navigation-drawer",`v-navigation-drawer--${Ce.value}`,{"v-navigation-drawer--expand-on-hover":e.expandOnHover,"v-navigation-drawer--floating":e.floating,"v-navigation-drawer--is-hovering":Se.value,"v-navigation-drawer--rail":e.rail,"v-navigation-drawer--temporary":Me.value,"v-navigation-drawer--persistent":ye.value,"v-navigation-drawer--active":N.value,"v-navigation-drawer--sticky":ke.value},m.value,T.value,o.value,D.value,M.value,z.value,e.class],style:[k.value,ht.value,q.value,Mt.value,e.style,["top","bottom"].includes(Ce.value)?{height:"auto"}:{}]},oe,l),{default:()=>{var Dt,Yt,zt;return[ct&&A("div",{key:"image",class:"v-navigation-drawer__img"},[p.image?A(Bi,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{alt:"",cover:!0,height:"inherit",src:e.image}}},p.image):A(Vy,{key:"image-img",alt:"",cover:!0,height:"inherit",src:e.image},null)]),p.prepend&&A("div",{class:"v-navigation-drawer__prepend"},[(Dt=p.prepend)==null?void 0:Dt.call(p)]),A("div",{class:"v-navigation-drawer__content"},[(Yt=p.default)==null?void 0:Yt.call(p)]),p.append&&A("div",{class:"v-navigation-drawer__append"},[(zt=p.append)==null?void 0:zt.call(p)])]}}),A(Cs,{name:"fade-transition"},{default:()=>[Me.value&&(Ee.value||N.value)&&!!e.scrim&&A("div",sn({class:["v-navigation-drawer__scrim",_t.backgroundColorClasses.value],style:[Qe.value,_t.backgroundColorStyles.value],onClick:()=>{ye.value||(N.value=!1)}},oe),null)]})])}),{isStuck:tt}}}),wA=Un({__name:"SideBar",setup(e){const i=vi(),l=h=>{i.$state.currentPage=h};return(h,p)=>($e(),gt(xA,{"expand-on-hover":"",rail:""},{append:Q(()=>[A(es,{"prepend-icon":"mdi-cog",title:H(re)("settings"),value:"settings",onClick:p[5]||(p[5]=_=>l("settings"))},null,8,["title"])]),default:Q(()=>[A(Wy,{density:"compact",nav:""},{default:Q(()=>{var _,m,o,T;return[A(es,{color:"primary",active:H(i).currentPage==="racing",rounded:"lg","prepend-icon":"mdi-racing-helmet",title:H(re)("racing"),value:"racing",onClick:p[0]||(p[0]=k=>l("racing"))},null,8,["active","title"]),A(es,{color:"primary",active:H(i).currentPage==="results",rounded:"lg","prepend-icon":"mdi-trophy",title:H(re)("results"),value:"results",onClick:p[1]||(p[1]=k=>l("results"))},null,8,["active","title"]),A(es,{color:"primary",active:H(i).currentPage==="crew",rounded:"lg","prepend-icon":"mdi-account-group",title:H(re)("crew"),value:"crew",onClick:p[2]||(p[2]=k=>l("crew"))},null,8,["active","title"]),(m=(_=H(i).baseData.data)==null?void 0:_.auth)!=null&&m.create?($e(),gt(es,{key:0,color:"primary",active:H(i).currentPage==="mytracks",rounded:"lg","prepend-icon":"mdi-go-kart-track",title:H(re)("my_tracks"),value:"mytracks",onClick:p[3]||(p[3]=k=>l("mytracks"))},null,8,["active","title"])):Ft("",!0),(T=(o=H(i).baseData.data)==null?void 0:o.auth)!=null&&T.control?($e(),gt(es,{key:1,color:"primary",active:H(i).currentPage==="racers",rounded:"lg","prepend-icon":"mdi-account-multiple",title:H(re)("racers"),value:"racers",onClick:p[4]||(p[4]=k=>l("racers"))},null,8,["active","title"])):Ft("",!0)]}),_:1})]),_:1}))}});const SA=Mi(wA,[["__scopeId","data-v-c6af5940"]]);function VS(e,i){return function(){return e.apply(i,arguments)}}const{toString:CA}=Object.prototype,{getPrototypeOf:Xy}=Object,km=(e=>i=>{const l=CA.call(i);return e[l]||(e[l]=l.slice(8,-1).toLowerCase())})(Object.create(null)),ss=e=>(e=e.toLowerCase(),i=>km(i)===e),Im=e=>i=>typeof i===e,{isArray:bu}=Array,wd=Im("undefined");function TA(e){return e!==null&&!wd(e)&&e.constructor!==null&&!wd(e.constructor)&&ba(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const NS=ss("ArrayBuffer");function PA(e){let i;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?i=ArrayBuffer.isView(e):i=e&&e.buffer&&NS(e.buffer),i}const kA=Im("string"),ba=Im("function"),$S=Im("number"),Mm=e=>e!==null&&typeof e=="object",IA=e=>e===!0||e===!1,Pp=e=>{if(km(e)!=="object")return!1;const i=Xy(e);return(i===null||i===Object.prototype||Object.getPrototypeOf(i)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},MA=ss("Date"),EA=ss("File"),AA=ss("Blob"),RA=ss("FileList"),DA=e=>Mm(e)&&ba(e.pipe),zA=e=>{let i;return e&&(typeof FormData=="function"&&e instanceof FormData||ba(e.append)&&((i=km(e))==="formdata"||i==="object"&&ba(e.toString)&&e.toString()==="[object FormData]"))},LA=ss("URLSearchParams"),[BA,FA,OA,VA]=["ReadableStream","Request","Response","Headers"].map(ss),NA=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Od(e,i,{allOwnKeys:l=!1}={}){if(e===null||typeof e>"u")return;let h,p;if(typeof e!="object"&&(e=[e]),bu(e))for(h=0,p=e.length;h<p;h++)i.call(null,e[h],h,e);else{const _=l?Object.getOwnPropertyNames(e):Object.keys(e),m=_.length;let o;for(h=0;h<m;h++)o=_[h],i.call(null,e[o],o,e)}}function jS(e,i){i=i.toLowerCase();const l=Object.keys(e);let h=l.length,p;for(;h-- >0;)if(p=l[h],i===p.toLowerCase())return p;return null}const Ul=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),US=e=>!wd(e)&&e!==Ul;function K_(){const{caseless:e}=US(this)&&this||{},i={},l=(h,p)=>{const _=e&&jS(i,p)||p;Pp(i[_])&&Pp(h)?i[_]=K_(i[_],h):Pp(h)?i[_]=K_({},h):bu(h)?i[_]=h.slice():i[_]=h};for(let h=0,p=arguments.length;h<p;h++)arguments[h]&&Od(arguments[h],l);return i}const $A=(e,i,l,{allOwnKeys:h}={})=>(Od(i,(p,_)=>{l&&ba(p)?e[_]=VS(p,l):e[_]=p},{allOwnKeys:h}),e),jA=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),UA=(e,i,l,h)=>{e.prototype=Object.create(i.prototype,h),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:i.prototype}),l&&Object.assign(e.prototype,l)},GA=(e,i,l,h)=>{let p,_,m;const o={};if(i=i||{},e==null)return i;do{for(p=Object.getOwnPropertyNames(e),_=p.length;_-- >0;)m=p[_],(!h||h(m,e,i))&&!o[m]&&(i[m]=e[m],o[m]=!0);e=l!==!1&&Xy(e)}while(e&&(!l||l(e,i))&&e!==Object.prototype);return i},HA=(e,i,l)=>{e=String(e),(l===void 0||l>e.length)&&(l=e.length),l-=i.length;const h=e.indexOf(i,l);return h!==-1&&h===l},ZA=e=>{if(!e)return null;if(bu(e))return e;let i=e.length;if(!$S(i))return null;const l=new Array(i);for(;i-- >0;)l[i]=e[i];return l},qA=(e=>i=>e&&i instanceof e)(typeof Uint8Array<"u"&&Xy(Uint8Array)),WA=(e,i)=>{const h=(e&&e[Symbol.iterator]).call(e);let p;for(;(p=h.next())&&!p.done;){const _=p.value;i.call(e,_[0],_[1])}},XA=(e,i)=>{let l;const h=[];for(;(l=e.exec(i))!==null;)h.push(l);return h},KA=ss("HTMLFormElement"),YA=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(l,h,p){return h.toUpperCase()+p}),Px=(({hasOwnProperty:e})=>(i,l)=>e.call(i,l))(Object.prototype),JA=ss("RegExp"),GS=(e,i)=>{const l=Object.getOwnPropertyDescriptors(e),h={};Od(l,(p,_)=>{let m;(m=i(p,_,e))!==!1&&(h[_]=m||p)}),Object.defineProperties(e,h)},QA=e=>{GS(e,(i,l)=>{if(ba(e)&&["arguments","caller","callee"].indexOf(l)!==-1)return!1;const h=e[l];if(ba(h)){if(i.enumerable=!1,"writable"in i){i.writable=!1;return}i.set||(i.set=()=>{throw Error("Can not rewrite read-only method '"+l+"'")})}})},eR=(e,i)=>{const l={},h=p=>{p.forEach(_=>{l[_]=!0})};return bu(e)?h(e):h(String(e).split(i)),l},tR=()=>{},nR=(e,i)=>e!=null&&Number.isFinite(e=+e)?e:i,d_="abcdefghijklmnopqrstuvwxyz",kx="0123456789",HS={DIGIT:kx,ALPHA:d_,ALPHA_DIGIT:d_+d_.toUpperCase()+kx},iR=(e=16,i=HS.ALPHA_DIGIT)=>{let l="";const{length:h}=i;for(;e--;)l+=i[Math.random()*h|0];return l};function rR(e){return!!(e&&ba(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const aR=e=>{const i=new Array(10),l=(h,p)=>{if(Mm(h)){if(i.indexOf(h)>=0)return;if(!("toJSON"in h)){i[p]=h;const _=bu(h)?[]:{};return Od(h,(m,o)=>{const T=l(m,p+1);!wd(T)&&(_[o]=T)}),i[p]=void 0,_}}return h};return l(e,0)},sR=ss("AsyncFunction"),oR=e=>e&&(Mm(e)||ba(e))&&ba(e.then)&&ba(e.catch),ZS=((e,i)=>e?setImmediate:i?((l,h)=>(Ul.addEventListener("message",({source:p,data:_})=>{p===Ul&&_===l&&h.length&&h.shift()()},!1),p=>{h.push(p),Ul.postMessage(l,"*")}))(`axios@${Math.random()}`,[]):l=>setTimeout(l))(typeof setImmediate=="function",ba(Ul.postMessage)),lR=typeof queueMicrotask<"u"?queueMicrotask.bind(Ul):typeof process<"u"&&process.nextTick||ZS,ut={isArray:bu,isArrayBuffer:NS,isBuffer:TA,isFormData:zA,isArrayBufferView:PA,isString:kA,isNumber:$S,isBoolean:IA,isObject:Mm,isPlainObject:Pp,isReadableStream:BA,isRequest:FA,isResponse:OA,isHeaders:VA,isUndefined:wd,isDate:MA,isFile:EA,isBlob:AA,isRegExp:JA,isFunction:ba,isStream:DA,isURLSearchParams:LA,isTypedArray:qA,isFileList:RA,forEach:Od,merge:K_,extend:$A,trim:NA,stripBOM:jA,inherits:UA,toFlatObject:GA,kindOf:km,kindOfTest:ss,endsWith:HA,toArray:ZA,forEachEntry:WA,matchAll:XA,isHTMLForm:KA,hasOwnProperty:Px,hasOwnProp:Px,reduceDescriptors:GS,freezeMethods:QA,toObjectSet:eR,toCamelCase:YA,noop:tR,toFiniteNumber:nR,findKey:jS,global:Ul,isContextDefined:US,ALPHABET:HS,generateString:iR,isSpecCompliantForm:rR,toJSONObject:aR,isAsyncFn:sR,isThenable:oR,setImmediate:ZS,asap:lR};function In(e,i,l,h,p){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",i&&(this.code=i),l&&(this.config=l),h&&(this.request=h),p&&(this.response=p,this.status=p.status?p.status:null)}ut.inherits(In,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ut.toJSONObject(this.config),code:this.code,status:this.status}}});const qS=In.prototype,WS={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{WS[e]={value:e}});Object.defineProperties(In,WS);Object.defineProperty(qS,"isAxiosError",{value:!0});In.from=(e,i,l,h,p,_)=>{const m=Object.create(qS);return ut.toFlatObject(e,m,function(T){return T!==Error.prototype},o=>o!=="isAxiosError"),In.call(m,e.message,i,l,h,p),m.cause=e,m.name=e.name,_&&Object.assign(m,_),m};const cR=null;function Y_(e){return ut.isPlainObject(e)||ut.isArray(e)}function XS(e){return ut.endsWith(e,"[]")?e.slice(0,-2):e}function Ix(e,i,l){return e?e.concat(i).map(function(p,_){return p=XS(p),!l&&_?"["+p+"]":p}).join(l?".":""):i}function uR(e){return ut.isArray(e)&&!e.some(Y_)}const hR=ut.toFlatObject(ut,{},null,function(i){return/^is[A-Z]/.test(i)});function Em(e,i,l){if(!ut.isObject(e))throw new TypeError("target must be an object");i=i||new FormData,l=ut.toFlatObject(l,{metaTokens:!0,dots:!1,indexes:!1},!1,function(N,q){return!ut.isUndefined(q[N])});const h=l.metaTokens,p=l.visitor||M,_=l.dots,m=l.indexes,T=(l.Blob||typeof Blob<"u"&&Blob)&&ut.isSpecCompliantForm(i);if(!ut.isFunction(p))throw new TypeError("visitor must be a function");function k(F){if(F===null)return"";if(ut.isDate(F))return F.toISOString();if(!T&&ut.isBlob(F))throw new In("Blob is not supported. Use a Buffer instead.");return ut.isArrayBuffer(F)||ut.isTypedArray(F)?T&&typeof Blob=="function"?new Blob([F]):Buffer.from(F):F}function M(F,N,q){let oe=F;if(F&&!q&&typeof F=="object"){if(ut.endsWith(N,"{}"))N=h?N:N.slice(0,-2),F=JSON.stringify(F);else if(ut.isArray(F)&&uR(F)||(ut.isFileList(F)||ut.endsWith(N,"[]"))&&(oe=ut.toArray(F)))return N=XS(N),oe.forEach(function(Se,pe){!(ut.isUndefined(Se)||Se===null)&&i.append(m===!0?Ix([N],pe,_):m===null?N:N+"[]",k(Se))}),!1}return Y_(F)?!0:(i.append(Ix(q,N,_),k(F)),!1)}const D=[],O=Object.assign(hR,{defaultVisitor:M,convertValue:k,isVisitable:Y_});function z(F,N){if(!ut.isUndefined(F)){if(D.indexOf(F)!==-1)throw Error("Circular reference detected in "+N.join("."));D.push(F),ut.forEach(F,function(oe,_e){(!(ut.isUndefined(oe)||oe===null)&&p.call(i,oe,ut.isString(_e)?_e.trim():_e,N,O))===!0&&z(oe,N?N.concat(_e):[_e])}),D.pop()}}if(!ut.isObject(e))throw new TypeError("data must be an object");return z(e),i}function Mx(e){const i={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(h){return i[h]})}function Ky(e,i){this._pairs=[],e&&Em(e,this,i)}const KS=Ky.prototype;KS.append=function(i,l){this._pairs.push([i,l])};KS.toString=function(i){const l=i?function(h){return i.call(this,h,Mx)}:Mx;return this._pairs.map(function(p){return l(p[0])+"="+l(p[1])},"").join("&")};function dR(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function YS(e,i,l){if(!i)return e;const h=l&&l.encode||dR;ut.isFunction(l)&&(l={serialize:l});const p=l&&l.serialize;let _;if(p?_=p(i,l):_=ut.isURLSearchParams(i)?i.toString():new Ky(i,l).toString(h),_){const m=e.indexOf("#");m!==-1&&(e=e.slice(0,m)),e+=(e.indexOf("?")===-1?"?":"&")+_}return e}class fR{constructor(){this.handlers=[]}use(i,l,h){return this.handlers.push({fulfilled:i,rejected:l,synchronous:h?h.synchronous:!1,runWhen:h?h.runWhen:null}),this.handlers.length-1}eject(i){this.handlers[i]&&(this.handlers[i]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(i){ut.forEach(this.handlers,function(h){h!==null&&i(h)})}}const Ex=fR,JS={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},pR=typeof URLSearchParams<"u"?URLSearchParams:Ky,mR=typeof FormData<"u"?FormData:null,gR=typeof Blob<"u"?Blob:null,_R={isBrowser:!0,classes:{URLSearchParams:pR,FormData:mR,Blob:gR},protocols:["http","https","file","blob","url","data"]},Yy=typeof window<"u"&&typeof document<"u",J_=typeof navigator=="object"&&navigator||void 0,yR=Yy&&(!J_||["ReactNative","NativeScript","NS"].indexOf(J_.product)<0),vR=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),bR=Yy&&window.location.href||"http://localhost",xR=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Yy,hasStandardBrowserEnv:yR,hasStandardBrowserWebWorkerEnv:vR,navigator:J_,origin:bR},Symbol.toStringTag,{value:"Module"})),Br={...xR,..._R};function wR(e,i){return Em(e,new Br.classes.URLSearchParams,Object.assign({visitor:function(l,h,p,_){return Br.isNode&&ut.isBuffer(l)?(this.append(h,l.toString("base64")),!1):_.defaultVisitor.apply(this,arguments)}},i))}function SR(e){return ut.matchAll(/\w+|\[(\w*)]/g,e).map(i=>i[0]==="[]"?"":i[1]||i[0])}function CR(e){const i={},l=Object.keys(e);let h;const p=l.length;let _;for(h=0;h<p;h++)_=l[h],i[_]=e[_];return i}function QS(e){function i(l,h,p,_){let m=l[_++];if(m==="__proto__")return!0;const o=Number.isFinite(+m),T=_>=l.length;return m=!m&&ut.isArray(p)?p.length:m,T?(ut.hasOwnProp(p,m)?p[m]=[p[m],h]:p[m]=h,!o):((!p[m]||!ut.isObject(p[m]))&&(p[m]=[]),i(l,h,p[m],_)&&ut.isArray(p[m])&&(p[m]=CR(p[m])),!o)}if(ut.isFormData(e)&&ut.isFunction(e.entries)){const l={};return ut.forEachEntry(e,(h,p)=>{i(SR(h),p,l,0)}),l}return null}function TR(e,i,l){if(ut.isString(e))try{return(i||JSON.parse)(e),ut.trim(e)}catch(h){if(h.name!=="SyntaxError")throw h}return(l||JSON.stringify)(e)}const Jy={transitional:JS,adapter:["xhr","http","fetch"],transformRequest:[function(i,l){const h=l.getContentType()||"",p=h.indexOf("application/json")>-1,_=ut.isObject(i);if(_&&ut.isHTMLForm(i)&&(i=new FormData(i)),ut.isFormData(i))return p?JSON.stringify(QS(i)):i;if(ut.isArrayBuffer(i)||ut.isBuffer(i)||ut.isStream(i)||ut.isFile(i)||ut.isBlob(i)||ut.isReadableStream(i))return i;if(ut.isArrayBufferView(i))return i.buffer;if(ut.isURLSearchParams(i))return l.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),i.toString();let o;if(_){if(h.indexOf("application/x-www-form-urlencoded")>-1)return wR(i,this.formSerializer).toString();if((o=ut.isFileList(i))||h.indexOf("multipart/form-data")>-1){const T=this.env&&this.env.FormData;return Em(o?{"files[]":i}:i,T&&new T,this.formSerializer)}}return _||p?(l.setContentType("application/json",!1),TR(i)):i}],transformResponse:[function(i){const l=this.transitional||Jy.transitional,h=l&&l.forcedJSONParsing,p=this.responseType==="json";if(ut.isResponse(i)||ut.isReadableStream(i))return i;if(i&&ut.isString(i)&&(h&&!this.responseType||p)){const m=!(l&&l.silentJSONParsing)&&p;try{return JSON.parse(i)}catch(o){if(m)throw o.name==="SyntaxError"?In.from(o,In.ERR_BAD_RESPONSE,this,null,this.response):o}}return i}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Br.classes.FormData,Blob:Br.classes.Blob},validateStatus:function(i){return i>=200&&i<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ut.forEach(["delete","get","head","post","put","patch"],e=>{Jy.headers[e]={}});const Qy=Jy,PR=ut.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),kR=e=>{const i={};let l,h,p;return e&&e.split(`
`).forEach(function(m){p=m.indexOf(":"),l=m.substring(0,p).trim().toLowerCase(),h=m.substring(p+1).trim(),!(!l||i[l]&&PR[l])&&(l==="set-cookie"?i[l]?i[l].push(h):i[l]=[h]:i[l]=i[l]?i[l]+", "+h:h)}),i},Ax=Symbol("internals");function qh(e){return e&&String(e).trim().toLowerCase()}function kp(e){return e===!1||e==null?e:ut.isArray(e)?e.map(kp):String(e)}function IR(e){const i=Object.create(null),l=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let h;for(;h=l.exec(e);)i[h[1]]=h[2];return i}const MR=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function f_(e,i,l,h,p){if(ut.isFunction(h))return h.call(this,i,l);if(p&&(i=l),!!ut.isString(i)){if(ut.isString(h))return i.indexOf(h)!==-1;if(ut.isRegExp(h))return h.test(i)}}function ER(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(i,l,h)=>l.toUpperCase()+h)}function AR(e,i){const l=ut.toCamelCase(" "+i);["get","set","has"].forEach(h=>{Object.defineProperty(e,h+l,{value:function(p,_,m){return this[h].call(this,i,p,_,m)},configurable:!0})})}class Am{constructor(i){i&&this.set(i)}set(i,l,h){const p=this;function _(o,T,k){const M=qh(T);if(!M)throw new Error("header name must be a non-empty string");const D=ut.findKey(p,M);(!D||p[D]===void 0||k===!0||k===void 0&&p[D]!==!1)&&(p[D||T]=kp(o))}const m=(o,T)=>ut.forEach(o,(k,M)=>_(k,M,T));if(ut.isPlainObject(i)||i instanceof this.constructor)m(i,l);else if(ut.isString(i)&&(i=i.trim())&&!MR(i))m(kR(i),l);else if(ut.isHeaders(i))for(const[o,T]of i.entries())_(T,o,h);else i!=null&&_(l,i,h);return this}get(i,l){if(i=qh(i),i){const h=ut.findKey(this,i);if(h){const p=this[h];if(!l)return p;if(l===!0)return IR(p);if(ut.isFunction(l))return l.call(this,p,h);if(ut.isRegExp(l))return l.exec(p);throw new TypeError("parser must be boolean|regexp|function")}}}has(i,l){if(i=qh(i),i){const h=ut.findKey(this,i);return!!(h&&this[h]!==void 0&&(!l||f_(this,this[h],h,l)))}return!1}delete(i,l){const h=this;let p=!1;function _(m){if(m=qh(m),m){const o=ut.findKey(h,m);o&&(!l||f_(h,h[o],o,l))&&(delete h[o],p=!0)}}return ut.isArray(i)?i.forEach(_):_(i),p}clear(i){const l=Object.keys(this);let h=l.length,p=!1;for(;h--;){const _=l[h];(!i||f_(this,this[_],_,i,!0))&&(delete this[_],p=!0)}return p}normalize(i){const l=this,h={};return ut.forEach(this,(p,_)=>{const m=ut.findKey(h,_);if(m){l[m]=kp(p),delete l[_];return}const o=i?ER(_):String(_).trim();o!==_&&delete l[_],l[o]=kp(p),h[o]=!0}),this}concat(...i){return this.constructor.concat(this,...i)}toJSON(i){const l=Object.create(null);return ut.forEach(this,(h,p)=>{h!=null&&h!==!1&&(l[p]=i&&ut.isArray(h)?h.join(", "):h)}),l}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([i,l])=>i+": "+l).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(i){return i instanceof this?i:new this(i)}static concat(i,...l){const h=new this(i);return l.forEach(p=>h.set(p)),h}static accessor(i){const h=(this[Ax]=this[Ax]={accessors:{}}).accessors,p=this.prototype;function _(m){const o=qh(m);h[o]||(AR(p,m),h[o]=!0)}return ut.isArray(i)?i.forEach(_):_(i),this}}Am.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ut.reduceDescriptors(Am.prototype,({value:e},i)=>{let l=i[0].toUpperCase()+i.slice(1);return{get:()=>e,set(h){this[l]=h}}});ut.freezeMethods(Am);const is=Am;function p_(e,i){const l=this||Qy,h=i||l,p=is.from(h.headers);let _=h.data;return ut.forEach(e,function(o){_=o.call(l,_,p.normalize(),i?i.status:void 0)}),p.normalize(),_}function eC(e){return!!(e&&e.__CANCEL__)}function xu(e,i,l){In.call(this,e??"canceled",In.ERR_CANCELED,i,l),this.name="CanceledError"}ut.inherits(xu,In,{__CANCEL__:!0});function tC(e,i,l){const h=l.config.validateStatus;!l.status||!h||h(l.status)?e(l):i(new In("Request failed with status code "+l.status,[In.ERR_BAD_REQUEST,In.ERR_BAD_RESPONSE][Math.floor(l.status/100)-4],l.config,l.request,l))}function RR(e){const i=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return i&&i[1]||""}function DR(e,i){e=e||10;const l=new Array(e),h=new Array(e);let p=0,_=0,m;return i=i!==void 0?i:1e3,function(T){const k=Date.now(),M=h[_];m||(m=k),l[p]=T,h[p]=k;let D=_,O=0;for(;D!==p;)O+=l[D++],D=D%e;if(p=(p+1)%e,p===_&&(_=(_+1)%e),k-m<i)return;const z=M&&k-M;return z?Math.round(O*1e3/z):void 0}}function zR(e,i){let l=0,h=1e3/i,p,_;const m=(k,M=Date.now())=>{l=M,p=null,_&&(clearTimeout(_),_=null),e.apply(null,k)};return[(...k)=>{const M=Date.now(),D=M-l;D>=h?m(k,M):(p=k,_||(_=setTimeout(()=>{_=null,m(p)},h-D)))},()=>p&&m(p)]}const Yp=(e,i,l=3)=>{let h=0;const p=DR(50,250);return zR(_=>{const m=_.loaded,o=_.lengthComputable?_.total:void 0,T=m-h,k=p(T),M=m<=o;h=m;const D={loaded:m,total:o,progress:o?m/o:void 0,bytes:T,rate:k||void 0,estimated:k&&o&&M?(o-m)/k:void 0,event:_,lengthComputable:o!=null,[i?"download":"upload"]:!0};e(D)},l)},Rx=(e,i)=>{const l=e!=null;return[h=>i[0]({lengthComputable:l,total:e,loaded:h}),i[1]]},Dx=e=>(...i)=>ut.asap(()=>e(...i)),LR=Br.hasStandardBrowserEnv?((e,i)=>l=>(l=new URL(l,Br.origin),e.protocol===l.protocol&&e.host===l.host&&(i||e.port===l.port)))(new URL(Br.origin),Br.navigator&&/(msie|trident)/i.test(Br.navigator.userAgent)):()=>!0,BR=Br.hasStandardBrowserEnv?{write(e,i,l,h,p,_){const m=[e+"="+encodeURIComponent(i)];ut.isNumber(l)&&m.push("expires="+new Date(l).toGMTString()),ut.isString(h)&&m.push("path="+h),ut.isString(p)&&m.push("domain="+p),_===!0&&m.push("secure"),document.cookie=m.join("; ")},read(e){const i=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return i?decodeURIComponent(i[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function FR(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function OR(e,i){return i?e.replace(/\/?\/$/,"")+"/"+i.replace(/^\/+/,""):e}function nC(e,i){return e&&!FR(i)?OR(e,i):i}const zx=e=>e instanceof is?{...e}:e;function Yl(e,i){i=i||{};const l={};function h(k,M,D,O){return ut.isPlainObject(k)&&ut.isPlainObject(M)?ut.merge.call({caseless:O},k,M):ut.isPlainObject(M)?ut.merge({},M):ut.isArray(M)?M.slice():M}function p(k,M,D,O){if(ut.isUndefined(M)){if(!ut.isUndefined(k))return h(void 0,k,D,O)}else return h(k,M,D,O)}function _(k,M){if(!ut.isUndefined(M))return h(void 0,M)}function m(k,M){if(ut.isUndefined(M)){if(!ut.isUndefined(k))return h(void 0,k)}else return h(void 0,M)}function o(k,M,D){if(D in i)return h(k,M);if(D in e)return h(void 0,k)}const T={url:_,method:_,data:_,baseURL:m,transformRequest:m,transformResponse:m,paramsSerializer:m,timeout:m,timeoutMessage:m,withCredentials:m,withXSRFToken:m,adapter:m,responseType:m,xsrfCookieName:m,xsrfHeaderName:m,onUploadProgress:m,onDownloadProgress:m,decompress:m,maxContentLength:m,maxBodyLength:m,beforeRedirect:m,transport:m,httpAgent:m,httpsAgent:m,cancelToken:m,socketPath:m,responseEncoding:m,validateStatus:o,headers:(k,M,D)=>p(zx(k),zx(M),D,!0)};return ut.forEach(Object.keys(Object.assign({},e,i)),function(M){const D=T[M]||p,O=D(e[M],i[M],M);ut.isUndefined(O)&&D!==o||(l[M]=O)}),l}const iC=e=>{const i=Yl({},e);let{data:l,withXSRFToken:h,xsrfHeaderName:p,xsrfCookieName:_,headers:m,auth:o}=i;i.headers=m=is.from(m),i.url=YS(nC(i.baseURL,i.url),e.params,e.paramsSerializer),o&&m.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let T;if(ut.isFormData(l)){if(Br.hasStandardBrowserEnv||Br.hasStandardBrowserWebWorkerEnv)m.setContentType(void 0);else if((T=m.getContentType())!==!1){const[k,...M]=T?T.split(";").map(D=>D.trim()).filter(Boolean):[];m.setContentType([k||"multipart/form-data",...M].join("; "))}}if(Br.hasStandardBrowserEnv&&(h&&ut.isFunction(h)&&(h=h(i)),h||h!==!1&&LR(i.url))){const k=p&&_&&BR.read(_);k&&m.set(p,k)}return i},VR=typeof XMLHttpRequest<"u",NR=VR&&function(e){return new Promise(function(l,h){const p=iC(e);let _=p.data;const m=is.from(p.headers).normalize();let{responseType:o,onUploadProgress:T,onDownloadProgress:k}=p,M,D,O,z,F;function N(){z&&z(),F&&F(),p.cancelToken&&p.cancelToken.unsubscribe(M),p.signal&&p.signal.removeEventListener("abort",M)}let q=new XMLHttpRequest;q.open(p.method.toUpperCase(),p.url,!0),q.timeout=p.timeout;function oe(){if(!q)return;const Se=is.from("getAllResponseHeaders"in q&&q.getAllResponseHeaders()),be={data:!o||o==="text"||o==="json"?q.responseText:q.response,status:q.status,statusText:q.statusText,headers:Se,config:e,request:q};tC(function(Ce){l(Ce),N()},function(Ce){h(Ce),N()},be),q=null}"onloadend"in q?q.onloadend=oe:q.onreadystatechange=function(){!q||q.readyState!==4||q.status===0&&!(q.responseURL&&q.responseURL.indexOf("file:")===0)||setTimeout(oe)},q.onabort=function(){q&&(h(new In("Request aborted",In.ECONNABORTED,e,q)),q=null)},q.onerror=function(){h(new In("Network Error",In.ERR_NETWORK,e,q)),q=null},q.ontimeout=function(){let pe=p.timeout?"timeout of "+p.timeout+"ms exceeded":"timeout exceeded";const be=p.transitional||JS;p.timeoutErrorMessage&&(pe=p.timeoutErrorMessage),h(new In(pe,be.clarifyTimeoutError?In.ETIMEDOUT:In.ECONNABORTED,e,q)),q=null},_===void 0&&m.setContentType(null),"setRequestHeader"in q&&ut.forEach(m.toJSON(),function(pe,be){q.setRequestHeader(be,pe)}),ut.isUndefined(p.withCredentials)||(q.withCredentials=!!p.withCredentials),o&&o!=="json"&&(q.responseType=p.responseType),k&&([O,F]=Yp(k,!0),q.addEventListener("progress",O)),T&&q.upload&&([D,z]=Yp(T),q.upload.addEventListener("progress",D),q.upload.addEventListener("loadend",z)),(p.cancelToken||p.signal)&&(M=Se=>{q&&(h(!Se||Se.type?new xu(null,e,q):Se),q.abort(),q=null)},p.cancelToken&&p.cancelToken.subscribe(M),p.signal&&(p.signal.aborted?M():p.signal.addEventListener("abort",M)));const _e=RR(p.url);if(_e&&Br.protocols.indexOf(_e)===-1){h(new In("Unsupported protocol "+_e+":",In.ERR_BAD_REQUEST,e));return}q.send(_||null)})},$R=(e,i)=>{const{length:l}=e=e?e.filter(Boolean):[];if(i||l){let h=new AbortController,p;const _=function(k){if(!p){p=!0,o();const M=k instanceof Error?k:this.reason;h.abort(M instanceof In?M:new xu(M instanceof Error?M.message:M))}};let m=i&&setTimeout(()=>{m=null,_(new In(`timeout ${i} of ms exceeded`,In.ETIMEDOUT))},i);const o=()=>{e&&(m&&clearTimeout(m),m=null,e.forEach(k=>{k.unsubscribe?k.unsubscribe(_):k.removeEventListener("abort",_)}),e=null)};e.forEach(k=>k.addEventListener("abort",_));const{signal:T}=h;return T.unsubscribe=()=>ut.asap(o),T}},jR=$R,UR=function*(e,i){let l=e.byteLength;if(!i||l<i){yield e;return}let h=0,p;for(;h<l;)p=h+i,yield e.slice(h,p),h=p},GR=async function*(e,i){for await(const l of HR(e))yield*UR(l,i)},HR=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const i=e.getReader();try{for(;;){const{done:l,value:h}=await i.read();if(l)break;yield h}}finally{await i.cancel()}},Lx=(e,i,l,h)=>{const p=GR(e,i);let _=0,m,o=T=>{m||(m=!0,h&&h(T))};return new ReadableStream({async pull(T){try{const{done:k,value:M}=await p.next();if(k){o(),T.close();return}let D=M.byteLength;if(l){let O=_+=D;l(O)}T.enqueue(new Uint8Array(M))}catch(k){throw o(k),k}},cancel(T){return o(T),p.return()}},{highWaterMark:2})},Rm=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",rC=Rm&&typeof ReadableStream=="function",ZR=Rm&&(typeof TextEncoder=="function"?(e=>i=>e.encode(i))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),aC=(e,...i)=>{try{return!!e(...i)}catch{return!1}},qR=rC&&aC(()=>{let e=!1;const i=new Request(Br.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!i}),Bx=64*1024,Q_=rC&&aC(()=>ut.isReadableStream(new Response("").body)),Jp={stream:Q_&&(e=>e.body)};Rm&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(i=>{!Jp[i]&&(Jp[i]=ut.isFunction(e[i])?l=>l[i]():(l,h)=>{throw new In(`Response type '${i}' is not supported`,In.ERR_NOT_SUPPORT,h)})})})(new Response);const WR=async e=>{if(e==null)return 0;if(ut.isBlob(e))return e.size;if(ut.isSpecCompliantForm(e))return(await new Request(Br.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(ut.isArrayBufferView(e)||ut.isArrayBuffer(e))return e.byteLength;if(ut.isURLSearchParams(e)&&(e=e+""),ut.isString(e))return(await ZR(e)).byteLength},XR=async(e,i)=>{const l=ut.toFiniteNumber(e.getContentLength());return l??WR(i)},KR=Rm&&(async e=>{let{url:i,method:l,data:h,signal:p,cancelToken:_,timeout:m,onDownloadProgress:o,onUploadProgress:T,responseType:k,headers:M,withCredentials:D="same-origin",fetchOptions:O}=iC(e);k=k?(k+"").toLowerCase():"text";let z=jR([p,_&&_.toAbortSignal()],m),F;const N=z&&z.unsubscribe&&(()=>{z.unsubscribe()});let q;try{if(T&&qR&&l!=="get"&&l!=="head"&&(q=await XR(M,h))!==0){let be=new Request(i,{method:"POST",body:h,duplex:"half"}),de;if(ut.isFormData(h)&&(de=be.headers.get("content-type"))&&M.setContentType(de),be.body){const[Ce,ye]=Rx(q,Yp(Dx(T)));h=Lx(be.body,Bx,Ce,ye)}}ut.isString(D)||(D=D?"include":"omit");const oe="credentials"in Request.prototype;F=new Request(i,{...O,signal:z,method:l.toUpperCase(),headers:M.normalize().toJSON(),body:h,duplex:"half",credentials:oe?D:void 0});let _e=await fetch(F);const Se=Q_&&(k==="stream"||k==="response");if(Q_&&(o||Se&&N)){const be={};["status","statusText","headers"].forEach(Me=>{be[Me]=_e[Me]});const de=ut.toFiniteNumber(_e.headers.get("content-length")),[Ce,ye]=o&&Rx(de,Yp(Dx(o),!0))||[];_e=new Response(Lx(_e.body,Bx,Ce,()=>{ye&&ye(),N&&N()}),be)}k=k||"text";let pe=await Jp[ut.findKey(Jp,k)||"text"](_e,e);return!Se&&N&&N(),await new Promise((be,de)=>{tC(be,de,{data:pe,headers:is.from(_e.headers),status:_e.status,statusText:_e.statusText,config:e,request:F})})}catch(oe){throw N&&N(),oe&&oe.name==="TypeError"&&/fetch/i.test(oe.message)?Object.assign(new In("Network Error",In.ERR_NETWORK,e,F),{cause:oe.cause||oe}):In.from(oe,oe&&oe.code,e,F)}}),ey={http:cR,xhr:NR,fetch:KR};ut.forEach(ey,(e,i)=>{if(e){try{Object.defineProperty(e,"name",{value:i})}catch{}Object.defineProperty(e,"adapterName",{value:i})}});const Fx=e=>`- ${e}`,YR=e=>ut.isFunction(e)||e===null||e===!1,sC={getAdapter:e=>{e=ut.isArray(e)?e:[e];const{length:i}=e;let l,h;const p={};for(let _=0;_<i;_++){l=e[_];let m;if(h=l,!YR(l)&&(h=ey[(m=String(l)).toLowerCase()],h===void 0))throw new In(`Unknown adapter '${m}'`);if(h)break;p[m||"#"+_]=h}if(!h){const _=Object.entries(p).map(([o,T])=>`adapter ${o} `+(T===!1?"is not supported by the environment":"is not available in the build"));let m=i?_.length>1?`since :
`+_.map(Fx).join(`
`):" "+Fx(_[0]):"as no adapter specified";throw new In("There is no suitable adapter to dispatch the request "+m,"ERR_NOT_SUPPORT")}return h},adapters:ey};function m_(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new xu(null,e)}function Ox(e){return m_(e),e.headers=is.from(e.headers),e.data=p_.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),sC.getAdapter(e.adapter||Qy.adapter)(e).then(function(h){return m_(e),h.data=p_.call(e,e.transformResponse,h),h.headers=is.from(h.headers),h},function(h){return eC(h)||(m_(e),h&&h.response&&(h.response.data=p_.call(e,e.transformResponse,h.response),h.response.headers=is.from(h.response.headers))),Promise.reject(h)})}const oC="1.7.9",Dm={};["object","boolean","number","function","string","symbol"].forEach((e,i)=>{Dm[e]=function(h){return typeof h===e||"a"+(i<1?"n ":" ")+e}});const Vx={};Dm.transitional=function(i,l,h){function p(_,m){return"[Axios v"+oC+"] Transitional option '"+_+"'"+m+(h?". "+h:"")}return(_,m,o)=>{if(i===!1)throw new In(p(m," has been removed"+(l?" in "+l:"")),In.ERR_DEPRECATED);return l&&!Vx[m]&&(Vx[m]=!0,console.warn(p(m," has been deprecated since v"+l+" and will be removed in the near future"))),i?i(_,m,o):!0}};Dm.spelling=function(i){return(l,h)=>(console.warn(`${h} is likely a misspelling of ${i}`),!0)};function JR(e,i,l){if(typeof e!="object")throw new In("options must be an object",In.ERR_BAD_OPTION_VALUE);const h=Object.keys(e);let p=h.length;for(;p-- >0;){const _=h[p],m=i[_];if(m){const o=e[_],T=o===void 0||m(o,_,e);if(T!==!0)throw new In("option "+_+" must be "+T,In.ERR_BAD_OPTION_VALUE);continue}if(l!==!0)throw new In("Unknown option "+_,In.ERR_BAD_OPTION)}}const Ip={assertOptions:JR,validators:Dm},_s=Ip.validators;class Qp{constructor(i){this.defaults=i,this.interceptors={request:new Ex,response:new Ex}}async request(i,l){try{return await this._request(i,l)}catch(h){if(h instanceof Error){let p={};Error.captureStackTrace?Error.captureStackTrace(p):p=new Error;const _=p.stack?p.stack.replace(/^.+\n/,""):"";try{h.stack?_&&!String(h.stack).endsWith(_.replace(/^.+\n.+\n/,""))&&(h.stack+=`
`+_):h.stack=_}catch{}}throw h}}_request(i,l){typeof i=="string"?(l=l||{},l.url=i):l=i||{},l=Yl(this.defaults,l);const{transitional:h,paramsSerializer:p,headers:_}=l;h!==void 0&&Ip.assertOptions(h,{silentJSONParsing:_s.transitional(_s.boolean),forcedJSONParsing:_s.transitional(_s.boolean),clarifyTimeoutError:_s.transitional(_s.boolean)},!1),p!=null&&(ut.isFunction(p)?l.paramsSerializer={serialize:p}:Ip.assertOptions(p,{encode:_s.function,serialize:_s.function},!0)),Ip.assertOptions(l,{baseUrl:_s.spelling("baseURL"),withXsrfToken:_s.spelling("withXSRFToken")},!0),l.method=(l.method||this.defaults.method||"get").toLowerCase();let m=_&&ut.merge(_.common,_[l.method]);_&&ut.forEach(["delete","get","head","post","put","patch","common"],F=>{delete _[F]}),l.headers=is.concat(m,_);const o=[];let T=!0;this.interceptors.request.forEach(function(N){typeof N.runWhen=="function"&&N.runWhen(l)===!1||(T=T&&N.synchronous,o.unshift(N.fulfilled,N.rejected))});const k=[];this.interceptors.response.forEach(function(N){k.push(N.fulfilled,N.rejected)});let M,D=0,O;if(!T){const F=[Ox.bind(this),void 0];for(F.unshift.apply(F,o),F.push.apply(F,k),O=F.length,M=Promise.resolve(l);D<O;)M=M.then(F[D++],F[D++]);return M}O=o.length;let z=l;for(D=0;D<O;){const F=o[D++],N=o[D++];try{z=F(z)}catch(q){N.call(this,q);break}}try{M=Ox.call(this,z)}catch(F){return Promise.reject(F)}for(D=0,O=k.length;D<O;)M=M.then(k[D++],k[D++]);return M}getUri(i){i=Yl(this.defaults,i);const l=nC(i.baseURL,i.url);return YS(l,i.params,i.paramsSerializer)}}ut.forEach(["delete","get","head","options"],function(i){Qp.prototype[i]=function(l,h){return this.request(Yl(h||{},{method:i,url:l,data:(h||{}).data}))}});ut.forEach(["post","put","patch"],function(i){function l(h){return function(_,m,o){return this.request(Yl(o||{},{method:i,headers:h?{"Content-Type":"multipart/form-data"}:{},url:_,data:m}))}}Qp.prototype[i]=l(),Qp.prototype[i+"Form"]=l(!0)});const Mp=Qp;class ev{constructor(i){if(typeof i!="function")throw new TypeError("executor must be a function.");let l;this.promise=new Promise(function(_){l=_});const h=this;this.promise.then(p=>{if(!h._listeners)return;let _=h._listeners.length;for(;_-- >0;)h._listeners[_](p);h._listeners=null}),this.promise.then=p=>{let _;const m=new Promise(o=>{h.subscribe(o),_=o}).then(p);return m.cancel=function(){h.unsubscribe(_)},m},i(function(_,m,o){h.reason||(h.reason=new xu(_,m,o),l(h.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(i){if(this.reason){i(this.reason);return}this._listeners?this._listeners.push(i):this._listeners=[i]}unsubscribe(i){if(!this._listeners)return;const l=this._listeners.indexOf(i);l!==-1&&this._listeners.splice(l,1)}toAbortSignal(){const i=new AbortController,l=h=>{i.abort(h)};return this.subscribe(l),i.signal.unsubscribe=()=>this.unsubscribe(l),i.signal}static source(){let i;return{token:new ev(function(p){i=p}),cancel:i}}}const QR=ev;function eD(e){return function(l){return e.apply(null,l)}}function tD(e){return ut.isObject(e)&&e.isAxiosError===!0}const ty={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ty).forEach(([e,i])=>{ty[i]=e});const nD=ty;function lC(e){const i=new Mp(e),l=VS(Mp.prototype.request,i);return ut.extend(l,Mp.prototype,i,{allOwnKeys:!0}),ut.extend(l,i,null,{allOwnKeys:!0}),l.create=function(p){return lC(Yl(e,p))},l}const sr=lC(Qy);sr.Axios=Mp;sr.CanceledError=xu;sr.CancelToken=QR;sr.isCancel=eC;sr.VERSION=oC;sr.toFormData=Em;sr.AxiosError=In;sr.Cancel=sr.CanceledError;sr.all=function(i){return Promise.all(i)};sr.spread=eD;sr.isAxiosError=tD;sr.mergeConfig=Yl;sr.AxiosHeaders=is;sr.formToJSON=e=>QS(ut.isHTMLForm(e)?new FormData(e):e);sr.getAdapter=sC.getAdapter;sr.HttpStatusCode=nD;sr.default=sr;const iD=sr,hn=iD.create({baseURL:"https://cw-racingapp/"}),Fa=()=>{const e=vi();e.appIsOpen=!1,hn.post("UiCloseUi")};const cC=Ct({baseColor:String,divided:Boolean,...so(),...xn(),...Ca(),...lo(),...oa(),...Ti(),...Di(),...ks()},"VBtnGroup"),Nx=qt()({name:"VBtnGroup",props:cC(),setup(e,i){let{slots:l}=i;const{themeClasses:h}=Hi(e),{densityClasses:p}=Na(e),{borderClasses:_}=oo(e),{elevationClasses:m}=co(e),{roundedClasses:o}=la(e);Qo({VBtn:{height:"auto",baseColor:nn(e,"baseColor"),color:nn(e,"color"),density:nn(e,"density"),flat:!0,variant:nn(e,"variant")}}),dn(()=>A(e.tag,{class:["v-btn-group",{"v-btn-group--divided":e.divided},h.value,_.value,p.value,m.value,o.value,e.class],style:e.style},l))}}),uC=Symbol.for("vuetify:v-btn-toggle"),rD=Ct({...cC(),...$y()},"VBtnToggle");qt()({name:"VBtnToggle",props:rD(),emits:{"update:modelValue":e=>!0},setup(e,i){let{slots:l}=i;const{isSelected:h,next:p,prev:_,select:m,selected:o}=Sm(e,uC);return dn(()=>{const T=Nx.filterProps(e);return A(Nx,sn({class:["v-btn-toggle",e.class]},T,{style:e.style}),{default:()=>{var k;return[(k=l.default)==null?void 0:k.call(l,{isSelected:h,next:p,prev:_,select:m,selected:o})]}})}),{next:p,prev:_,select:m}}});function hC(e,i){const l=Ye(),h=an(!1);if(ky){const p=new IntersectionObserver(_=>{e==null||e(_,p),h.value=!!_.find(m=>m.isIntersecting)},i);kr(()=>{p.disconnect()}),Qt(l,(_,m)=>{m&&(p.unobserve(m),h.value=!1),_&&p.observe(_)},{flush:"post"})}return{intersectionRef:l,isIntersecting:h}}const aD=Ct({bgColor:String,color:String,indeterminate:[Boolean,String],modelValue:{type:[Number,String],default:0},rotate:{type:[Number,String],default:0},width:{type:[Number,String],default:4},...xn(),...Ed(),...Ti({tag:"div"}),...Di()},"VProgressCircular"),dC=qt()({name:"VProgressCircular",props:aD(),setup(e,i){let{slots:l}=i;const h=20,p=2*Math.PI*h,_=Ye(),{themeClasses:m}=Hi(e),{sizeClasses:o,sizeStyles:T}=Ad(e),{textColorClasses:k,textColorStyles:M}=as(nn(e,"color")),{textColorClasses:D,textColorStyles:O}=as(nn(e,"bgColor")),{intersectionRef:z,isIntersecting:F}=hC(),{resizeRef:N,contentRect:q}=mu(),oe=ue(()=>Math.max(0,Math.min(100,parseFloat(e.modelValue)))),_e=ue(()=>Number(e.width)),Se=ue(()=>T.value?Number(e.size):q.value?q.value.width:Math.max(_e.value,32)),pe=ue(()=>h/(1-_e.value/Se.value)*2),be=ue(()=>_e.value/Se.value*pe.value),de=ue(()=>mn((100-oe.value)/100*p));return xa(()=>{z.value=_.value,N.value=_.value}),dn(()=>A(e.tag,{ref:_,class:["v-progress-circular",{"v-progress-circular--indeterminate":!!e.indeterminate,"v-progress-circular--visible":F.value,"v-progress-circular--disable-shrink":e.indeterminate==="disable-shrink"},m.value,o.value,k.value,e.class],style:[T.value,M.value,e.style],role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":e.indeterminate?void 0:oe.value},{default:()=>[A("svg",{style:{transform:`rotate(calc(-90deg + ${Number(e.rotate)}deg))`},xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${pe.value} ${pe.value}`},[A("circle",{class:["v-progress-circular__underlay",D.value],style:O.value,fill:"transparent",cx:"50%",cy:"50%",r:h,"stroke-width":be.value,"stroke-dasharray":p,"stroke-dashoffset":0},null),A("circle",{class:"v-progress-circular__overlay",fill:"transparent",cx:"50%",cy:"50%",r:h,"stroke-width":be.value,"stroke-dasharray":p,"stroke-dashoffset":de.value},null)]),l.default&&A("div",{class:"v-progress-circular__content"},[l.default({value:oe.value})])]})),{}}});const sD=Ct({absolute:Boolean,active:{type:Boolean,default:!0},bgColor:String,bgOpacity:[Number,String],bufferValue:{type:[Number,String],default:0},bufferColor:String,bufferOpacity:[Number,String],clickable:Boolean,color:String,height:{type:[Number,String],default:4},indeterminate:Boolean,max:{type:[Number,String],default:100},modelValue:{type:[Number,String],default:0},opacity:[Number,String],reverse:Boolean,stream:Boolean,striped:Boolean,roundedBar:Boolean,...xn(),...vu({location:"top"}),...oa(),...Ti(),...Di()},"VProgressLinear"),fC=qt()({name:"VProgressLinear",props:sD(),emits:{"update:modelValue":e=>!0},setup(e,i){var Ee;let{slots:l}=i;const h=ii(e,"modelValue"),{isRtl:p,rtlClasses:_}=$a(),{themeClasses:m}=Hi(e),{locationStyles:o}=Ld(e),{textColorClasses:T,textColorStyles:k}=as(e,"color"),{backgroundColorClasses:M,backgroundColorStyles:D}=La(ue(()=>e.bgColor||e.color)),{backgroundColorClasses:O,backgroundColorStyles:z}=La(ue(()=>e.bufferColor||e.bgColor||e.color)),{backgroundColorClasses:F,backgroundColorStyles:N}=La(e,"color"),{roundedClasses:q}=la(e),{intersectionRef:oe,isIntersecting:_e}=hC(),Se=ue(()=>parseFloat(e.max)),pe=ue(()=>parseFloat(e.height)),be=ue(()=>Ss(parseFloat(e.bufferValue)/Se.value*100,0,100)),de=ue(()=>Ss(parseFloat(h.value)/Se.value*100,0,100)),Ce=ue(()=>p.value!==e.reverse),ye=ue(()=>e.indeterminate?"fade-transition":"slide-x-transition"),Me=Zn&&((Ee=window.matchMedia)==null?void 0:Ee.call(window,"(forced-colors: active)").matches);function ke(xe){if(!oe.value)return;const{left:Fe,right:We,width:ht}=oe.value.getBoundingClientRect(),Ne=Ce.value?ht-xe.clientX+(We-ht):xe.clientX-Fe;h.value=Math.round(Ne/ht*Se.value)}return dn(()=>A(e.tag,{ref:oe,class:["v-progress-linear",{"v-progress-linear--absolute":e.absolute,"v-progress-linear--active":e.active&&_e.value,"v-progress-linear--reverse":Ce.value,"v-progress-linear--rounded":e.rounded,"v-progress-linear--rounded-bar":e.roundedBar,"v-progress-linear--striped":e.striped},q.value,m.value,_.value,e.class],style:[{bottom:e.location==="bottom"?0:void 0,top:e.location==="top"?0:void 0,height:e.active?mn(pe.value):0,"--v-progress-linear-height":mn(pe.value),...e.absolute?o.value:{}},e.style],role:"progressbar","aria-hidden":e.active?"false":"true","aria-valuemin":"0","aria-valuemax":e.max,"aria-valuenow":e.indeterminate?void 0:de.value,onClick:e.clickable&&ke},{default:()=>[e.stream&&A("div",{key:"stream",class:["v-progress-linear__stream",T.value],style:{...k.value,[Ce.value?"left":"right"]:mn(-pe.value),borderTop:`${mn(pe.value/2)} dotted`,opacity:parseFloat(e.bufferOpacity),top:`calc(50% - ${mn(pe.value/4)})`,width:mn(100-be.value,"%"),"--v-progress-linear-stream-to":mn(pe.value*(Ce.value?1:-1))}},null),A("div",{class:["v-progress-linear__background",Me?void 0:M.value],style:[D.value,{opacity:parseFloat(e.bgOpacity),width:e.stream?0:void 0}]},null),A("div",{class:["v-progress-linear__buffer",Me?void 0:O.value],style:[z.value,{opacity:parseFloat(e.bufferOpacity),width:mn(be.value,"%")}]},null),A(Cs,{name:ye.value},{default:()=>[e.indeterminate?A("div",{class:"v-progress-linear__indeterminate"},[["long","short"].map(xe=>A("div",{key:xe,class:["v-progress-linear__indeterminate",xe,Me?void 0:F.value],style:N.value},null))]):A("div",{class:["v-progress-linear__determinate",Me?void 0:F.value],style:[N.value,{width:mn(de.value,"%")}]},null)]}),l.default&&A("div",{class:"v-progress-linear__content"},[l.default({value:de.value,buffer:be.value})])]})),{}}}),tv=Ct({loading:[Boolean,String]},"loader");function zm(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ps();return{loaderClasses:ue(()=>({[`${i}--loading`]:e.loading}))}}function nv(e,i){var h;let{slots:l}=i;return A("div",{class:`${e.name}__loader`},[((h=l.default)==null?void 0:h.call(l,{color:e.color,isActive:e.active}))||A(fC,{absolute:e.absolute,active:e.active,color:e.color,height:"2",indeterminate:!0},null)])}function oD(e,i){Qt(()=>{var l;return(l=e.isActive)==null?void 0:l.value},l=>{e.isLink.value&&l&&i&&Fi(()=>{i(!0)})},{immediate:!0})}const pC=Ct({active:{type:Boolean,default:void 0},activeColor:String,baseColor:String,symbol:{type:null,default:uC},flat:Boolean,icon:[Boolean,String,Function,Object],prependIcon:jn,appendIcon:jn,block:Boolean,readonly:Boolean,slim:Boolean,stacked:Boolean,ripple:{type:[Boolean,Object],default:!0},text:String,...so(),...xn(),...Ca(),...Oa(),...lo(),...jy(),...tv(),...vu(),...Bd(),...oa(),...Tm(),...Ed(),...Ti({tag:"button"}),...Di(),...ks({variant:"elevated"})},"VBtn"),Gt=qt()({name:"VBtn",props:pC(),emits:{"group:selected":e=>!0},setup(e,i){let{attrs:l,slots:h}=i;const{themeClasses:p}=Hi(e),{borderClasses:_}=oo(e),{densityClasses:m}=Na(e),{dimensionStyles:o}=Va(e),{elevationClasses:T}=co(e),{loaderClasses:k}=zm(e),{locationStyles:M}=Ld(e),{positionClasses:D}=Fd(e),{roundedClasses:O}=la(e),{sizeClasses:z,sizeStyles:F}=Ad(e),N=Uy(e,e.symbol,!1),q=Cm(e,l),oe=ue(()=>{var Ee;return e.active!==void 0?e.active:q.isLink.value?(Ee=q.isActive)==null?void 0:Ee.value:N==null?void 0:N.isSelected.value}),_e=ue(()=>oe.value?e.activeColor??e.color:e.color),Se=ue(()=>{var xe,Fe;return{color:(N==null?void 0:N.isSelected.value)&&(!q.isLink.value||((xe=q.isActive)==null?void 0:xe.value))||!N||((Fe=q.isActive)==null?void 0:Fe.value)?_e.value??e.baseColor:e.baseColor,variant:e.variant}}),{colorClasses:pe,colorStyles:be,variantClasses:de}=tc(Se),Ce=ue(()=>(N==null?void 0:N.disabled.value)||e.disabled),ye=ue(()=>e.variant==="elevated"&&!(e.disabled||e.flat||e.border)),Me=ue(()=>{if(!(e.value===void 0||typeof e.value=="symbol"))return Object(e.value)===e.value?JSON.stringify(e.value,null,0):e.value});function ke(Ee){var xe;Ce.value||q.isLink.value&&(Ee.metaKey||Ee.ctrlKey||Ee.shiftKey||Ee.button!==0||l.target==="_blank")||((xe=q.navigate)==null||xe.call(q,Ee),N==null||N.toggle())}return oD(q,N==null?void 0:N.select),dn(()=>{const Ee=q.isLink.value?"a":e.tag,xe=!!(e.prependIcon||h.prepend),Fe=!!(e.appendIcon||h.append),We=!!(e.icon&&e.icon!==!0);return Tr(A(Ee,sn({type:Ee==="a"?void 0:"button",class:["v-btn",N==null?void 0:N.selectedClass.value,{"v-btn--active":oe.value,"v-btn--block":e.block,"v-btn--disabled":Ce.value,"v-btn--elevated":ye.value,"v-btn--flat":e.flat,"v-btn--icon":!!e.icon,"v-btn--loading":e.loading,"v-btn--readonly":e.readonly,"v-btn--slim":e.slim,"v-btn--stacked":e.stacked},p.value,_.value,pe.value,m.value,T.value,k.value,D.value,O.value,z.value,de.value,e.class],style:[be.value,o.value,M.value,F.value,e.style],"aria-busy":e.loading?!0:void 0,disabled:Ce.value||void 0,tabindex:e.loading||e.readonly?-1:void 0,onClick:ke,value:Me.value},q.linkProps),{default:()=>{var ht;return[ec(!0,"v-btn"),!e.icon&&xe&&A("span",{key:"prepend",class:"v-btn__prepend"},[h.prepend?A(Bi,{key:"prepend-defaults",disabled:!e.prependIcon,defaults:{VIcon:{icon:e.prependIcon}}},h.prepend):A(li,{key:"prepend-icon",icon:e.prependIcon},null)]),A("span",{class:"v-btn__content","data-no-activator":""},[!h.default&&We?A(li,{key:"content-icon",icon:e.icon},null):A(Bi,{key:"content-defaults",disabled:!We,defaults:{VIcon:{icon:e.icon}}},{default:()=>{var Ne;return[((Ne=h.default)==null?void 0:Ne.call(h))??e.text]}})]),!e.icon&&Fe&&A("span",{key:"append",class:"v-btn__append"},[h.append?A(Bi,{key:"append-defaults",disabled:!e.appendIcon,defaults:{VIcon:{icon:e.appendIcon}}},h.append):A(li,{key:"append-icon",icon:e.appendIcon},null)]),!!e.loading&&A("span",{key:"loader",class:"v-btn__loader"},[((ht=h.loader)==null?void 0:ht.call(h))??A(dC,{color:typeof e.loading=="boolean"?void 0:e.loading,indeterminate:!0,width:"2"},null)])]}}),[[zd,!Ce.value&&e.ripple,"",{center:!!e.icon}]])}),{group:N}}});const Yn=qt()({name:"VCardActions",props:xn(),setup(e,i){let{slots:l}=i;return Qo({VBtn:{slim:!0,variant:"text"}}),dn(()=>{var h;return A("div",{class:["v-card-actions",e.class],style:e.style},[(h=l.default)==null?void 0:h.call(l)])}),{}}}),lD=Ct({opacity:[Number,String],...xn(),...Ti()},"VCardSubtitle"),iv=qt()({name:"VCardSubtitle",props:lD(),setup(e,i){let{slots:l}=i;return dn(()=>A(e.tag,{class:["v-card-subtitle",e.class],style:[{"--v-card-subtitle-opacity":e.opacity},e.style]},l)),{}}}),Hn=vm("v-card-title"),cD=Ct({appendAvatar:String,appendIcon:jn,prependAvatar:String,prependIcon:jn,subtitle:[String,Number],title:[String,Number],...xn(),...Ca()},"VCardItem"),uD=qt()({name:"VCardItem",props:cD(),setup(e,i){let{slots:l}=i;return dn(()=>{var k;const h=!!(e.prependAvatar||e.prependIcon),p=!!(h||l.prepend),_=!!(e.appendAvatar||e.appendIcon),m=!!(_||l.append),o=!!(e.title!=null||l.title),T=!!(e.subtitle!=null||l.subtitle);return A("div",{class:["v-card-item",e.class],style:e.style},[p&&A("div",{key:"prepend",class:"v-card-item__prepend"},[l.prepend?A(Bi,{key:"prepend-defaults",disabled:!h,defaults:{VAvatar:{density:e.density,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon}}},l.prepend):A(cn,null,[e.prependAvatar&&A(Kl,{key:"prepend-avatar",density:e.density,image:e.prependAvatar},null),e.prependIcon&&A(li,{key:"prepend-icon",density:e.density,icon:e.prependIcon},null)])]),A("div",{class:"v-card-item__content"},[o&&A(Hn,{key:"title"},{default:()=>{var M;return[((M=l.title)==null?void 0:M.call(l))??e.title]}}),T&&A(iv,{key:"subtitle"},{default:()=>{var M;return[((M=l.subtitle)==null?void 0:M.call(l))??e.subtitle]}}),(k=l.default)==null?void 0:k.call(l)]),m&&A("div",{key:"append",class:"v-card-item__append"},[l.append?A(Bi,{key:"append-defaults",disabled:!_,defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon}}},l.append):A(cn,null,[e.appendIcon&&A(li,{key:"append-icon",density:e.density,icon:e.appendIcon},null),e.appendAvatar&&A(Kl,{key:"append-avatar",density:e.density,image:e.appendAvatar},null)])])])}),{}}}),hD=Ct({opacity:[Number,String],...xn(),...Ti()},"VCardText"),ti=qt()({name:"VCardText",props:hD(),setup(e,i){let{slots:l}=i;return dn(()=>A(e.tag,{class:["v-card-text",e.class],style:[{"--v-card-text-opacity":e.opacity},e.style]},l)),{}}}),dD=Ct({appendAvatar:String,appendIcon:jn,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:jn,ripple:{type:[Boolean,Object],default:!0},subtitle:[String,Number],text:[String,Number],title:[String,Number],...so(),...xn(),...Ca(),...Oa(),...lo(),...tv(),...vu(),...Bd(),...oa(),...Tm(),...Ti(),...Di(),...ks({variant:"elevated"})},"VCard"),$n=qt()({name:"VCard",directives:{Ripple:zd},props:dD(),setup(e,i){let{attrs:l,slots:h}=i;const{themeClasses:p}=Hi(e),{borderClasses:_}=oo(e),{colorClasses:m,colorStyles:o,variantClasses:T}=tc(e),{densityClasses:k}=Na(e),{dimensionStyles:M}=Va(e),{elevationClasses:D}=co(e),{loaderClasses:O}=zm(e),{locationStyles:z}=Ld(e),{positionClasses:F}=Fd(e),{roundedClasses:N}=la(e),q=Cm(e,l),oe=ue(()=>e.link!==!1&&q.isLink.value),_e=ue(()=>!e.disabled&&e.link!==!1&&(e.link||q.isClickable.value));return dn(()=>{const Se=oe.value?"a":e.tag,pe=!!(h.title||e.title!=null),be=!!(h.subtitle||e.subtitle!=null),de=pe||be,Ce=!!(h.append||e.appendAvatar||e.appendIcon),ye=!!(h.prepend||e.prependAvatar||e.prependIcon),Me=!!(h.image||e.image),ke=de||ye||Ce,Ee=!!(h.text||e.text!=null);return Tr(A(Se,sn({class:["v-card",{"v-card--disabled":e.disabled,"v-card--flat":e.flat,"v-card--hover":e.hover&&!(e.disabled||e.flat),"v-card--link":_e.value},p.value,_.value,m.value,k.value,D.value,O.value,F.value,N.value,T.value,e.class],style:[o.value,M.value,z.value,e.style],onClick:_e.value&&q.navigate,tabindex:e.disabled?-1:void 0},q.linkProps),{default:()=>{var xe;return[Me&&A("div",{key:"image",class:"v-card__image"},[h.image?A(Bi,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},h.image):A(Vy,{key:"image-img",cover:!0,src:e.image},null)]),A(nv,{name:"v-card",active:!!e.loading,color:typeof e.loading=="boolean"?void 0:e.loading},{default:h.loader}),ke&&A(uD,{key:"item",prependAvatar:e.prependAvatar,prependIcon:e.prependIcon,title:e.title,subtitle:e.subtitle,appendAvatar:e.appendAvatar,appendIcon:e.appendIcon},{default:h.item,prepend:h.prepend,title:h.title,subtitle:h.subtitle,append:h.append}),Ee&&A(ti,{key:"text"},{default:()=>{var Fe;return[((Fe=h.text)==null?void 0:Fe.call(h))??e.text]}}),(xe=h.default)==null?void 0:xe.call(h),h.actions&&A(Yn,null,{default:h.actions}),ec(_e.value,"v-card")]}}),[[ao("ripple"),_e.value&&e.ripple]])}),{}}});const fD=Ct({fluid:{type:Boolean,default:!1},...xn(),...Oa(),...Ti()},"VContainer"),rv=qt()({name:"VContainer",props:fD(),setup(e,i){let{slots:l}=i;const{rtlClasses:h}=$a(),{dimensionStyles:p}=Va(e);return dn(()=>A(e.tag,{class:["v-container",{"v-container--fluid":e.fluid},h.value,e.class],style:[p.value,e.style]},l)),{}}}),mC=(()=>xm.reduce((e,i)=>(e[i]={type:[Boolean,String,Number],default:!1},e),{}))(),gC=(()=>xm.reduce((e,i)=>{const l="offset"+io(i);return e[l]={type:[String,Number],default:null},e},{}))(),_C=(()=>xm.reduce((e,i)=>{const l="order"+io(i);return e[l]={type:[String,Number],default:null},e},{}))(),$x={col:Object.keys(mC),offset:Object.keys(gC),order:Object.keys(_C)};function pD(e,i,l){let h=e;if(!(l==null||l===!1)){if(i){const p=i.replace(e,"");h+=`-${p}`}return e==="col"&&(h="v-"+h),e==="col"&&(l===""||l===!0)||(h+=`-${l}`),h.toLowerCase()}}const mD=["auto","start","end","center","baseline","stretch"],gD=Ct({cols:{type:[Boolean,String,Number],default:!1},...mC,offset:{type:[String,Number],default:null},...gC,order:{type:[String,Number],default:null},..._C,alignSelf:{type:String,default:null,validator:e=>mD.includes(e)},...xn(),...Ti()},"VCol"),Dr=qt()({name:"VCol",props:gD(),setup(e,i){let{slots:l}=i;const h=ue(()=>{const p=[];let _;for(_ in $x)$x[_].forEach(o=>{const T=e[o],k=pD(_,o,T);k&&p.push(k)});const m=p.some(o=>o.startsWith("v-col-"));return p.push({"v-col":!m||!e.cols,[`v-col-${e.cols}`]:e.cols,[`offset-${e.offset}`]:e.offset,[`order-${e.order}`]:e.order,[`align-self-${e.alignSelf}`]:e.alignSelf}),p});return()=>{var p;return Jo(e.tag,{class:[h.value,e.class],style:e.style},(p=l.default)==null?void 0:p.call(l))}}}),av=["start","end","center"],yC=["space-between","space-around","space-evenly"];function sv(e,i){return xm.reduce((l,h)=>{const p=e+io(h);return l[p]=i(),l},{})}const _D=[...av,"baseline","stretch"],vC=e=>_D.includes(e),bC=sv("align",()=>({type:String,default:null,validator:vC})),yD=[...av,...yC],xC=e=>yD.includes(e),wC=sv("justify",()=>({type:String,default:null,validator:xC})),vD=[...av,...yC,"stretch"],SC=e=>vD.includes(e),CC=sv("alignContent",()=>({type:String,default:null,validator:SC})),jx={align:Object.keys(bC),justify:Object.keys(wC),alignContent:Object.keys(CC)},bD={align:"align",justify:"justify",alignContent:"align-content"};function xD(e,i,l){let h=bD[e];if(l!=null){if(i){const p=i.replace(e,"");h+=`-${p}`}return h+=`-${l}`,h.toLowerCase()}}const wD=Ct({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:vC},...bC,justify:{type:String,default:null,validator:xC},...wC,alignContent:{type:String,default:null,validator:SC},...CC,...xn(),...Ti()},"VRow"),Go=qt()({name:"VRow",props:wD(),setup(e,i){let{slots:l}=i;const h=ue(()=>{const p=[];let _;for(_ in jx)jx[_].forEach(m=>{const o=e[m],T=xD(_,m,o);T&&p.push(T)});return p.push({"v-row--no-gutters":e.noGutters,"v-row--dense":e.dense,[`align-${e.align}`]:e.align,[`justify-${e.justify}`]:e.justify,[`align-content-${e.alignContent}`]:e.alignContent}),p});return()=>{var p;return Jo(e.tag,{class:["v-row",h.value,e.class],style:e.style},(p=l.default)==null?void 0:p.call(l))}}}),ar=vm("v-spacer","div","VSpacer");function g_(e,i){return{x:e.x+i.x,y:e.y+i.y}}function SD(e,i){return{x:e.x-i.x,y:e.y-i.y}}function Ux(e,i){if(e.side==="top"||e.side==="bottom"){const{side:l,align:h}=e,p=h==="left"?0:h==="center"?i.width/2:h==="right"?i.width:h,_=l==="top"?0:l==="bottom"?i.height:l;return g_({x:p,y:_},i)}else if(e.side==="left"||e.side==="right"){const{side:l,align:h}=e,p=l==="left"?0:l==="right"?i.width:l,_=h==="top"?0:h==="center"?i.height/2:h==="bottom"?i.height:h;return g_({x:p,y:_},i)}return g_({x:i.width/2,y:i.height/2},i)}const TC={static:PD,connected:ID},CD=Ct({locationStrategy:{type:[String,Function],default:"static",validator:e=>typeof e=="function"||e in TC},location:{type:String,default:"bottom"},origin:{type:String,default:"auto"},offset:[Number,String,Array]},"VOverlay-location-strategies");function TD(e,i){const l=Ye({}),h=Ye();Zn&&Ba(()=>!!(i.isActive.value&&e.locationStrategy),_=>{var m,o;Qt(()=>e.locationStrategy,_),Pr(()=>{window.removeEventListener("resize",p),h.value=void 0}),window.addEventListener("resize",p,{passive:!0}),typeof e.locationStrategy=="function"?h.value=(m=e.locationStrategy(i,e,l))==null?void 0:m.updateLocation:h.value=(o=TC[e.locationStrategy](i,e,l))==null?void 0:o.updateLocation});function p(_){var m;(m=h.value)==null||m.call(h,_)}return{contentStyles:l,updateLocation:h}}function PD(){}function kD(e,i){const l=Ry(e);return i?l.x+=parseFloat(e.style.right||0):l.x-=parseFloat(e.style.left||0),l.y-=parseFloat(e.style.top||0),l}function ID(e,i,l){(Array.isArray(e.target.value)||XI(e.target.value))&&Object.assign(l.value,{position:"fixed",top:0,[e.isRtl.value?"right":"left"]:0});const{preferredAnchor:p,preferredOrigin:_}=Ay(()=>{const F=N_(i.location,e.isRtl.value),N=i.origin==="overlap"?F:i.origin==="auto"?o_(F):N_(i.origin,e.isRtl.value);return F.side===N.side&&F.align===l_(N).align?{preferredAnchor:jb(F),preferredOrigin:jb(N)}:{preferredAnchor:F,preferredOrigin:N}}),[m,o,T,k]=["minWidth","minHeight","maxWidth","maxHeight"].map(F=>ue(()=>{const N=parseFloat(i[F]);return isNaN(N)?1/0:N})),M=ue(()=>{if(Array.isArray(i.offset))return i.offset;if(typeof i.offset=="string"){const F=i.offset.split(" ").map(parseFloat);return F.length<2&&F.push(0),F}return typeof i.offset=="number"?[i.offset,0]:[0,0]});let D=!1;const O=new ResizeObserver(()=>{D&&z()});Qt([e.target,e.contentEl],(F,N)=>{let[q,oe]=F,[_e,Se]=N;_e&&!Array.isArray(_e)&&O.unobserve(_e),q&&!Array.isArray(q)&&O.observe(q),Se&&O.unobserve(Se),oe&&O.observe(oe)},{immediate:!0}),Pr(()=>{O.disconnect()});function z(){if(D=!1,requestAnimationFrame(()=>D=!0),!e.target.value||!e.contentEl.value)return;const F=Bw(e.target.value),N=kD(e.contentEl.value,e.isRtl.value),q=Zp(e.contentEl.value),oe=12;q.length||(q.push(document.documentElement),e.contentEl.value.style.top&&e.contentEl.value.style.left||(N.x-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-x")||0),N.y-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-y")||0)));const _e=q.reduce((Ee,xe)=>{const Fe=xe.getBoundingClientRect(),We=new ql({x:xe===document.documentElement?0:Fe.x,y:xe===document.documentElement?0:Fe.y,width:xe.clientWidth,height:xe.clientHeight});return Ee?new ql({x:Math.max(Ee.left,We.left),y:Math.max(Ee.top,We.top),width:Math.min(Ee.right,We.right)-Math.max(Ee.left,We.left),height:Math.min(Ee.bottom,We.bottom)-Math.max(Ee.top,We.top)}):We},void 0);_e.x+=oe,_e.y+=oe,_e.width-=oe*2,_e.height-=oe*2;let Se={anchor:p.value,origin:_.value};function pe(Ee){const xe=new ql(N),Fe=Ux(Ee.anchor,F),We=Ux(Ee.origin,xe);let{x:ht,y:Ne}=SD(Fe,We);switch(Ee.anchor.side){case"top":Ne-=M.value[0];break;case"bottom":Ne+=M.value[0];break;case"left":ht-=M.value[0];break;case"right":ht+=M.value[0];break}switch(Ee.anchor.align){case"top":Ne-=M.value[1];break;case"bottom":Ne+=M.value[1];break;case"left":ht-=M.value[1];break;case"right":ht+=M.value[1];break}return xe.x+=ht,xe.y+=Ne,xe.width=Math.min(xe.width,T.value),xe.height=Math.min(xe.height,k.value),{overflows:Gb(xe,_e),x:ht,y:Ne}}let be=0,de=0;const Ce={x:0,y:0},ye={x:!1,y:!1};let Me=-1;for(;!(Me++>10);){const{x:Ee,y:xe,overflows:Fe}=pe(Se);be+=Ee,de+=xe,N.x+=Ee,N.y+=xe;{const We=Ub(Se.anchor),ht=Fe.x.before||Fe.x.after,Ne=Fe.y.before||Fe.y.after;let tt=!1;if(["x","y"].forEach(Mt=>{if(Mt==="x"&&ht&&!ye.x||Mt==="y"&&Ne&&!ye.y){const _t={anchor:{...Se.anchor},origin:{...Se.origin}},Qe=Mt==="x"?We==="y"?l_:o_:We==="y"?o_:l_;_t.anchor=Qe(_t.anchor),_t.origin=Qe(_t.origin);const{overflows:ct}=pe(_t);(ct[Mt].before<=Fe[Mt].before&&ct[Mt].after<=Fe[Mt].after||ct[Mt].before+ct[Mt].after<(Fe[Mt].before+Fe[Mt].after)/2)&&(Se=_t,tt=ye[Mt]=!0)}}),tt)continue}Fe.x.before&&(be+=Fe.x.before,N.x+=Fe.x.before),Fe.x.after&&(be-=Fe.x.after,N.x-=Fe.x.after),Fe.y.before&&(de+=Fe.y.before,N.y+=Fe.y.before),Fe.y.after&&(de-=Fe.y.after,N.y-=Fe.y.after);{const We=Gb(N,_e);Ce.x=_e.width-We.x.before-We.x.after,Ce.y=_e.height-We.y.before-We.y.after,be+=We.x.before,N.x+=We.x.before,de+=We.y.before,N.y+=We.y.before}break}const ke=Ub(Se.anchor);return Object.assign(l.value,{"--v-overlay-anchor-origin":`${Se.anchor.side} ${Se.anchor.align}`,transformOrigin:`${Se.origin.side} ${Se.origin.align}`,top:mn(__(de)),left:e.isRtl.value?void 0:mn(__(be)),right:e.isRtl.value?mn(__(-be)):void 0,minWidth:mn(ke==="y"?Math.min(m.value,F.width):m.value),maxWidth:mn(Gx(Ss(Ce.x,m.value===1/0?0:m.value,T.value))),maxHeight:mn(Gx(Ss(Ce.y,o.value===1/0?0:o.value,k.value)))}),{available:Ce,contentBox:N}}return Qt(()=>[p.value,_.value,i.offset,i.minWidth,i.minHeight,i.maxWidth,i.maxHeight],()=>z()),Fi(()=>{const F=z();if(!F)return;const{available:N,contentBox:q}=F;q.height>N.y&&requestAnimationFrame(()=>{z(),requestAnimationFrame(()=>{z()})})}),{updateLocation:z}}function __(e){return Math.round(e*devicePixelRatio)/devicePixelRatio}function Gx(e){return Math.ceil(e*devicePixelRatio)/devicePixelRatio}let ny=!0;const em=[];function MD(e){!ny||em.length?(em.push(e),iy()):(ny=!1,e(),iy())}let Hx=-1;function iy(){cancelAnimationFrame(Hx),Hx=requestAnimationFrame(()=>{const e=em.shift();e&&e(),em.length?iy():ny=!0})}const Ep={none:null,close:RD,block:DD,reposition:zD},ED=Ct({scrollStrategy:{type:[String,Function],default:"block",validator:e=>typeof e=="function"||e in Ep}},"VOverlay-scroll-strategies");function AD(e,i){if(!Zn)return;let l;xa(async()=>{l==null||l.stop(),i.isActive.value&&e.scrollStrategy&&(l=Sd(),await new Promise(h=>setTimeout(h)),l.active&&l.run(()=>{var h;typeof e.scrollStrategy=="function"?e.scrollStrategy(i,e,l):(h=Ep[e.scrollStrategy])==null||h.call(Ep,i,e,l)}))}),Pr(()=>{l==null||l.stop()})}function RD(e){function i(l){e.isActive.value=!1}PC(e.targetEl.value??e.contentEl.value,i)}function DD(e,i){var m;const l=(m=e.root.value)==null?void 0:m.offsetParent,h=[...new Set([...Zp(e.targetEl.value,i.contained?l:void 0),...Zp(e.contentEl.value,i.contained?l:void 0)])].filter(o=>!o.classList.contains("v-overlay-scroll-blocked")),p=window.innerWidth-document.documentElement.offsetWidth,_=(o=>Ly(o)&&o)(l||document.documentElement);_&&e.root.value.classList.add("v-overlay--scroll-blocked"),h.forEach((o,T)=>{o.style.setProperty("--v-body-scroll-x",mn(-o.scrollLeft)),o.style.setProperty("--v-body-scroll-y",mn(-o.scrollTop)),o!==document.documentElement&&o.style.setProperty("--v-scrollbar-offset",mn(p)),o.classList.add("v-overlay-scroll-blocked")}),Pr(()=>{h.forEach((o,T)=>{const k=parseFloat(o.style.getPropertyValue("--v-body-scroll-x")),M=parseFloat(o.style.getPropertyValue("--v-body-scroll-y")),D=o.style.scrollBehavior;o.style.scrollBehavior="auto",o.style.removeProperty("--v-body-scroll-x"),o.style.removeProperty("--v-body-scroll-y"),o.style.removeProperty("--v-scrollbar-offset"),o.classList.remove("v-overlay-scroll-blocked"),o.scrollLeft=-k,o.scrollTop=-M,o.style.scrollBehavior=D}),_&&e.root.value.classList.remove("v-overlay--scroll-blocked")})}function zD(e,i,l){let h=!1,p=-1,_=-1;function m(o){MD(()=>{var M,D;const T=performance.now();(D=(M=e.updateLocation).value)==null||D.call(M,o),h=(performance.now()-T)/(1e3/60)>2})}_=(typeof requestIdleCallback>"u"?o=>o():requestIdleCallback)(()=>{l.run(()=>{PC(e.targetEl.value??e.contentEl.value,o=>{h?(cancelAnimationFrame(p),p=requestAnimationFrame(()=>{p=requestAnimationFrame(()=>{m(o)})})):m(o)})})}),Pr(()=>{typeof cancelIdleCallback<"u"&&cancelIdleCallback(_),cancelAnimationFrame(p)})}function PC(e,i){const l=[document,...Zp(e)];l.forEach(h=>{h.addEventListener("scroll",i,{passive:!0})}),Pr(()=>{l.forEach(h=>{h.removeEventListener("scroll",i)})})}const ry=Symbol.for("vuetify:v-menu"),LD=Ct({target:[String,Object],activator:[String,Object],activatorProps:{type:Object,default:()=>({})},openOnClick:{type:Boolean,default:void 0},openOnHover:Boolean,openOnFocus:{type:Boolean,default:void 0},closeOnContentClick:Boolean,...FS()},"VOverlay-activator");function BD(e,i){let{isActive:l,isTop:h,contentEl:p}=i;const _=Gi("useActivator"),m=Ye();let o=!1,T=!1,k=!0;const M=ue(()=>e.openOnFocus||e.openOnFocus==null&&e.openOnHover),D=ue(()=>e.openOnClick||e.openOnClick==null&&!e.openOnHover&&!M.value),{runOpenDelay:O,runCloseDelay:z}=OS(e,ye=>{ye===(e.openOnHover&&o||M.value&&T)&&!(e.openOnHover&&l.value&&!h.value)&&(l.value!==ye&&(k=!0),l.value=ye)}),F=Ye(),N={onClick:ye=>{ye.stopPropagation(),m.value=ye.currentTarget||ye.target,l.value||(F.value=[ye.clientX,ye.clientY]),l.value=!l.value},onMouseenter:ye=>{var Me;(Me=ye.sourceCapabilities)!=null&&Me.firesTouchEvents||(o=!0,m.value=ye.currentTarget||ye.target,O())},onMouseleave:ye=>{o=!1,z()},onFocus:ye=>{Gp(ye.target,":focus-visible")!==!1&&(T=!0,ye.stopPropagation(),m.value=ye.currentTarget||ye.target,O())},onBlur:ye=>{T=!1,ye.stopPropagation(),z()}},q=ue(()=>{const ye={};return D.value&&(ye.onClick=N.onClick),e.openOnHover&&(ye.onMouseenter=N.onMouseenter,ye.onMouseleave=N.onMouseleave),M.value&&(ye.onFocus=N.onFocus,ye.onBlur=N.onBlur),ye}),oe=ue(()=>{const ye={};if(e.openOnHover&&(ye.onMouseenter=()=>{o=!0,O()},ye.onMouseleave=()=>{o=!1,z()}),M.value&&(ye.onFocusin=()=>{T=!0,O()},ye.onFocusout=()=>{T=!1,z()}),e.closeOnContentClick){const Me=ni(ry,null);ye.onClick=()=>{l.value=!1,Me==null||Me.closeParents()}}return ye}),_e=ue(()=>{const ye={};return e.openOnHover&&(ye.onMouseenter=()=>{k&&(o=!0,k=!1,O())},ye.onMouseleave=()=>{o=!1,z()}),ye});Qt(h,ye=>{var Me;ye&&(e.openOnHover&&!o&&(!M.value||!T)||M.value&&!T&&(!e.openOnHover||!o))&&!((Me=p.value)!=null&&Me.contains(document.activeElement))&&(l.value=!1)}),Qt(l,ye=>{ye||setTimeout(()=>{F.value=void 0})},{flush:"post"});const Se=V_();xa(()=>{Se.value&&Fi(()=>{m.value=Se.el})});const pe=V_(),be=ue(()=>e.target==="cursor"&&F.value?F.value:pe.value?pe.el:kC(e.target,_)||m.value),de=ue(()=>Array.isArray(be.value)?void 0:be.value);let Ce;return Qt(()=>!!e.activator,ye=>{ye&&Zn?(Ce=Sd(),Ce.run(()=>{FD(e,_,{activatorEl:m,activatorEvents:q})})):Ce&&Ce.stop()},{flush:"post",immediate:!0}),Pr(()=>{Ce==null||Ce.stop()}),{activatorEl:m,activatorRef:Se,target:be,targetEl:de,targetRef:pe,activatorEvents:q,contentEvents:oe,scrimEvents:_e}}function FD(e,i,l){let{activatorEl:h,activatorEvents:p}=l;Qt(()=>e.activator,(T,k)=>{if(k&&T!==k){const M=o(k);M&&m(M)}T&&Fi(()=>_())},{immediate:!0}),Qt(()=>e.activatorProps,()=>{_()}),Pr(()=>{m()});function _(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:o(),k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;T&&yI(T,sn(p.value,k))}function m(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:o(),k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;T&&vI(T,sn(p.value,k))}function o(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.activator;const k=kC(T,i);return h.value=(k==null?void 0:k.nodeType)===Node.ELEMENT_NODE?k:void 0,h.value}}function kC(e,i){var h,p;if(!e)return;let l;if(e==="parent"){let _=(p=(h=i==null?void 0:i.proxy)==null?void 0:h.$el)==null?void 0:p.parentNode;for(;_!=null&&_.hasAttribute("data-no-activator");)_=_.parentNode;l=_}else typeof e=="string"?l=document.querySelector(e):"$el"in e?l=e.$el:l=e;return l}function OD(){if(!Zn)return an(!1);const{ssr:e}=wm();if(e){const i=an(!1);return yi(()=>{i.value=!0}),i}else return an(!0)}const IC=Ct({eager:Boolean},"lazy");function MC(e,i){const l=an(!1),h=ue(()=>l.value||e.eager||i.value);Qt(i,()=>l.value=!0);function p(){e.eager||(l.value=!1)}return{isBooted:l,hasContent:h,onAfterLeave:p}}const Zx=Symbol.for("vuetify:stack"),Wh=yr([]);function VD(e,i,l){const h=Gi("useStack"),p=!l,_=ni(Zx,void 0),m=yr({activeChildren:new Set});Ir(Zx,m);const o=an(+i.value);Ba(e,()=>{var D;const M=(D=Wh.at(-1))==null?void 0:D[1];o.value=M?M+10:+i.value,p&&Wh.push([h.uid,o.value]),_==null||_.activeChildren.add(h.uid),Pr(()=>{if(p){const O=fn(Wh).findIndex(z=>z[0]===h.uid);Wh.splice(O,1)}_==null||_.activeChildren.delete(h.uid)})});const T=an(!0);p&&xa(()=>{var D;const M=((D=Wh.at(-1))==null?void 0:D[0])===h.uid;setTimeout(()=>T.value=M)});const k=ue(()=>!m.activeChildren.size);return{globalTop:Cd(T),localTop:k,stackStyles:ue(()=>({zIndex:o.value}))}}function ND(e){return{teleportTarget:ue(()=>{const l=e();if(l===!0||!Zn)return;const h=l===!1?document.body:typeof l=="string"?document.querySelector(l):l;if(h==null)return;let p=[...h.children].find(_=>_.matches(".v-overlay-container"));return p||(p=document.createElement("div"),p.className="v-overlay-container",h.appendChild(p)),p})}}function $D(){return!0}function EC(e,i,l){if(!e||AC(e,l)===!1)return!1;const h=Uw(i);if(typeof ShadowRoot<"u"&&h instanceof ShadowRoot&&h.host===e.target)return!1;const p=(typeof l.value=="object"&&l.value.include||(()=>[]))();return p.push(i),!p.some(_=>_==null?void 0:_.contains(e.target))}function AC(e,i){return(typeof i.value=="object"&&i.value.closeConditional||$D)(e)}function jD(e,i,l){const h=typeof l.value=="function"?l.value:l.value.handler;e.shadowTarget=e.target,i._clickOutside.lastMousedownWasOutside&&EC(e,i,l)&&setTimeout(()=>{AC(e,l)&&h&&h(e)},0)}function qx(e,i){const l=Uw(e);i(document),typeof ShadowRoot<"u"&&l instanceof ShadowRoot&&i(l)}const UD={mounted(e,i){const l=p=>jD(p,e,i),h=p=>{e._clickOutside.lastMousedownWasOutside=EC(p,e,i)};qx(e,p=>{p.addEventListener("click",l,!0),p.addEventListener("mousedown",h,!0)}),e._clickOutside||(e._clickOutside={lastMousedownWasOutside:!1}),e._clickOutside[i.instance.$.uid]={onClick:l,onMousedown:h}},beforeUnmount(e,i){e._clickOutside&&(qx(e,l=>{var _;if(!l||!((_=e._clickOutside)!=null&&_[i.instance.$.uid]))return;const{onClick:h,onMousedown:p}=e._clickOutside[i.instance.$.uid];l.removeEventListener("click",h,!0),l.removeEventListener("mousedown",p,!0)}),delete e._clickOutside[i.instance.$.uid])}};function GD(e){const{modelValue:i,color:l,...h}=e;return A(Cs,{name:"fade-transition",appear:!0},{default:()=>[e.modelValue&&A("div",sn({class:["v-overlay__scrim",e.color.backgroundColorClasses.value],style:e.color.backgroundColorStyles.value},h),null)]})}const Vd=Ct({absolute:Boolean,attach:[Boolean,String,Object],closeOnBack:{type:Boolean,default:!0},contained:Boolean,contentClass:null,contentProps:null,disabled:Boolean,opacity:[Number,String],noClickAnimation:Boolean,modelValue:Boolean,persistent:Boolean,scrim:{type:[Boolean,String],default:!0},zIndex:{type:[Number,String],default:2e3},...LD(),...xn(),...Oa(),...IC(),...CD(),...ED(),...Di(),...Rd()},"VOverlay"),qo=qt()({name:"VOverlay",directives:{ClickOutside:UD},inheritAttrs:!1,props:{_disableGlobalStack:Boolean,...Vd()},emits:{"click:outside":e=>!0,"update:modelValue":e=>!0,afterEnter:()=>!0,afterLeave:()=>!0},setup(e,i){let{slots:l,attrs:h,emit:p}=i;const _=Gi("VOverlay"),m=Ye(),o=Ye(),T=Ye(),k=ii(e,"modelValue"),M=ue({get:()=>k.value,set:Zt=>{Zt&&e.disabled||(k.value=Zt)}}),{themeClasses:D}=Hi(e),{rtlClasses:O,isRtl:z}=$a(),{hasContent:F,onAfterLeave:N}=MC(e,M),q=La(ue(()=>typeof e.scrim=="string"?e.scrim:null)),{globalTop:oe,localTop:_e,stackStyles:Se}=VD(M,nn(e,"zIndex"),e._disableGlobalStack),{activatorEl:pe,activatorRef:be,target:de,targetEl:Ce,targetRef:ye,activatorEvents:Me,contentEvents:ke,scrimEvents:Ee}=BD(e,{isActive:M,isTop:_e,contentEl:T}),{teleportTarget:xe}=ND(()=>{var bn,Vn,On;const Zt=e.attach||e.contained;if(Zt)return Zt;const _n=((bn=pe==null?void 0:pe.value)==null?void 0:bn.getRootNode())||((On=(Vn=_.proxy)==null?void 0:Vn.$el)==null?void 0:On.getRootNode());return _n instanceof ShadowRoot?_n:!1}),{dimensionStyles:Fe}=Va(e),We=OD(),{scopeId:ht}=nc();Qt(()=>e.disabled,Zt=>{Zt&&(M.value=!1)});const{contentStyles:Ne,updateLocation:tt}=TD(e,{isRtl:z,contentEl:T,target:de,isActive:M});AD(e,{root:m,contentEl:T,targetEl:Ce,isActive:M,updateLocation:tt});function Mt(Zt){p("click:outside",Zt),e.persistent?Yt():M.value=!1}function _t(Zt){return M.value&&oe.value&&(!e.scrim||Zt.target===o.value||Zt instanceof MouseEvent&&Zt.shadowTarget===o.value)}Zn&&Qt(M,Zt=>{Zt?window.addEventListener("keydown",Qe):window.removeEventListener("keydown",Qe)},{immediate:!0}),kr(()=>{Zn&&window.removeEventListener("keydown",Qe)});function Qe(Zt){var _n,bn;Zt.key==="Escape"&&oe.value&&(e.persistent?Yt():(M.value=!1,(_n=T.value)!=null&&_n.contains(document.activeElement)&&((bn=pe.value)==null||bn.focus())))}const ct=uS();Ba(()=>e.closeOnBack,()=>{FM(ct,Zt=>{oe.value&&M.value?(Zt(!1),e.persistent?Yt():M.value=!1):Zt()})});const Dt=Ye();Qt(()=>M.value&&(e.absolute||e.contained)&&xe.value==null,Zt=>{if(Zt){const _n=Gw(m.value);_n&&_n!==document.scrollingElement&&(Dt.value=_n.scrollTop)}});function Yt(){e.noClickAnimation||T.value&&jl(T.value,[{transformOrigin:"center"},{transform:"scale(1.03)"},{transformOrigin:"center"}],{duration:150,easing:md})}function zt(){p("afterEnter")}function Kt(){N(),p("afterLeave")}return dn(()=>{var Zt;return A(cn,null,[(Zt=l.activator)==null?void 0:Zt.call(l,{isActive:M.value,targetRef:ye,props:sn({ref:be},Me.value,e.activatorProps)}),We.value&&F.value&&A(SP,{disabled:!xe.value,to:xe.value},{default:()=>[A("div",sn({class:["v-overlay",{"v-overlay--absolute":e.absolute||e.contained,"v-overlay--active":M.value,"v-overlay--contained":e.contained},D.value,O.value,e.class],style:[Se.value,{"--v-overlay-opacity":e.opacity,top:mn(Dt.value)},e.style],ref:m},ht,h),[A(GD,sn({color:q,modelValue:M.value&&!!e.scrim,ref:o},Ee.value),null),A(eo,{appear:!0,persisted:!0,transition:e.transition,target:de.value,onAfterEnter:zt,onAfterLeave:Kt},{default:()=>{var _n;return[Tr(A("div",sn({ref:T,class:["v-overlay__content",e.contentClass],style:[Fe.value,Ne.value]},ke.value,e.contentProps),[(_n=l.default)==null?void 0:_n.call(l,{isActive:M})]),[[Ql,M.value],[ao("click-outside"),{handler:Mt,closeConditional:_t,include:()=>[pe.value]}]])]}})])]})])}),{activatorEl:pe,scrimEl:o,target:de,animateClick:Yt,contentEl:T,globalTop:oe,localTop:_e,updateLocation:tt}}}),y_=Symbol("Forwarded refs");function v_(e,i){let l=e;for(;l;){const h=Reflect.getOwnPropertyDescriptor(l,i);if(h)return h;l=Object.getPrototypeOf(l)}}function uo(e){for(var i=arguments.length,l=new Array(i>1?i-1:0),h=1;h<i;h++)l[h-1]=arguments[h];return e[y_]=l,new Proxy(e,{get(p,_){if(Reflect.has(p,_))return Reflect.get(p,_);if(!(typeof _=="symbol"||_.startsWith("$")||_.startsWith("__"))){for(const m of l)if(m.value&&Reflect.has(m.value,_)){const o=Reflect.get(m.value,_);return typeof o=="function"?o.bind(m.value):o}}},has(p,_){if(Reflect.has(p,_))return!0;if(typeof _=="symbol"||_.startsWith("$")||_.startsWith("__"))return!1;for(const m of l)if(m.value&&Reflect.has(m.value,_))return!0;return!1},set(p,_,m){if(Reflect.has(p,_))return Reflect.set(p,_,m);if(typeof _=="symbol"||_.startsWith("$")||_.startsWith("__"))return!1;for(const o of l)if(o.value&&Reflect.has(o.value,_))return Reflect.set(o.value,_,m);return!1},getOwnPropertyDescriptor(p,_){var o;const m=Reflect.getOwnPropertyDescriptor(p,_);if(m)return m;if(!(typeof _=="symbol"||_.startsWith("$")||_.startsWith("__"))){for(const T of l){if(!T.value)continue;const k=v_(T.value,_)??("_"in T.value?v_((o=T.value._)==null?void 0:o.setupState,_):void 0);if(k)return k}for(const T of l){const k=T.value&&T.value[y_];if(!k)continue;const M=k.slice();for(;M.length;){const D=M.shift(),O=v_(D.value,_);if(O)return O;const z=D.value&&D.value[y_];z&&M.push(...z)}}}}})}const HD=Ct({id:String,text:String,...Ts(Vd({closeOnBack:!1,location:"end",locationStrategy:"connected",eager:!0,minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent"])},"VTooltip"),tm=qt()({name:"VTooltip",props:HD(),emits:{"update:modelValue":e=>!0},setup(e,i){let{slots:l}=i;const h=ii(e,"modelValue"),{scopeId:p}=nc(),_=wa(),m=ue(()=>e.id||`v-tooltip-${_}`),o=Ye(),T=ue(()=>e.location.split(" ").length>1?e.location:e.location+" center"),k=ue(()=>e.origin==="auto"||e.origin==="overlap"||e.origin.split(" ").length>1||e.location.split(" ").length>1?e.origin:e.origin+" center"),M=ue(()=>e.transition?e.transition:h.value?"scale-transition":"fade-transition"),D=ue(()=>sn({"aria-describedby":m.value},e.activatorProps));return dn(()=>{const O=qo.filterProps(e);return A(qo,sn({ref:o,class:["v-tooltip",e.class],style:e.style,id:m.value},O,{modelValue:h.value,"onUpdate:modelValue":z=>h.value=z,transition:M.value,absolute:!0,location:T.value,origin:k.value,persistent:!0,role:"tooltip",activatorProps:D.value,_disableGlobalStack:!0},p),{activator:l.activator,default:function(){var q;for(var z=arguments.length,F=new Array(z),N=0;N<z;N++)F[N]=arguments[N];return((q=l.default)==null?void 0:q.call(l,...F))??e.text}})}),uo({},o)}}),ZD=Un({__name:"AvailableRacesCard",props:{race:{}},setup(e){const i=e,l=vi(),h=async()=>{(await hn.post("UiJoinRace",JSON.stringify(i.race.RaceData.RaceId))).data&&Fa()},p=ue(()=>i.race.ParticipationCurrency==="racingcrypto"?i.race.ParticipationAmount+" "+l.baseData.data.payments.cryptoType:"$"+i.race.ParticipationAmount),_=ue(()=>{let N="Sprint | ";return i.race.laps==-1?N="Elimination | ":i.race.laps>0&&(N=i.race.Laps+" "+re("laps")+" | "),N}),m=ue(()=>{let N;return i.race.BuyIn>0&&(l.baseData.data.payments.racing==="racingcrypto"?N=i.race.BuyIn+" "+l.baseData.data.payments.cryptoType+" "+re("buy_in"):N="$"+i.race.BuyIn+" "+re("buy_in")),N}),o=ue(()=>{let N;return i.race.BuyIn>0&&(N=re("pot")+": "+i.race.racers*i.race.BuyIn),N}),T=ue(()=>{let N="";return i.race.Ghosting&&(N=re("active"),i.race.GhostingTime&&(N=i.race.GhostingTime+"s)")),N}),k=async()=>{(await hn.post("UiShowTrack",JSON.stringify(i.race.RaceId))).data&&Fa()},M=Ye(i.race.ExpirationTime),D=Ye(M.value?M.value-Math.floor(Date.now()/1e3):0),O=ue(()=>Math.floor(D.value/60).toString().padStart(2,"0")),z=ue(()=>(D.value%60).toString().padStart(2,"0")),F=()=>{if(M.value){const N=setInterval(()=>{D.value-=1,D.value<=0&&(D.value=0,clearInterval(N))},1e3);kd(()=>{F(),clearInterval(N)})}};return yi(()=>{F()}),(N,q)=>($e(),gt($n,{rounded:"xl",border:""},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(i.race.RaceData.RaceName),1)]),_:1}),A(ti,{class:"inline standardGap"},{default:Q(()=>{var oe;return[(oe=i.race)!=null&&oe.Ranked?($e(),gt(ln,{key:0,"prepend-icon":"mdi-podium-gold",color:"orange"},{default:Q(()=>[je(ee(H(re)("ranked")),1)]),_:1})):Ft("",!0),N.race.ParticipationAmount?($e(),gt(ln,{key:1,"prepend-icon":"mdi-hand-coin",color:"green"},{default:Q(()=>[je(ee(p.value)+" ",1),A(tm,{location:"top",activator:"parent",text:H(re)("participation_info")},null,8,["text"])]),_:1})):Ft("",!0),A(ln,{"prepend-icon":"mdi-go-kart-track"},{default:Q(()=>[je(ee(`${_.value} ${i.race.RaceData.Distance} m`),1)]),_:1}),m.value?($e(),gt(ln,{key:2,"prepend-icon":"mdi-cash"},{default:Q(()=>[je(ee(m.value),1)]),_:1})):Ft("",!0),o.value&&i.race.racers>1?($e(),gt(ln,{key:3,"prepend-icon":"mdi-cash-multiple"},{default:Q(()=>[je(ee(o.value),1)]),_:1})):Ft("",!0),A(ln,{"prepend-icon":"mdi-account-group"},{default:Q(()=>[je(ee(`${i.race.racers} ${H(re)("racers")}`),1)]),_:1}),i.race.MaxClass?($e(),gt(ln,{key:4,"prepend-icon":"mdi-car-info"},{default:Q(()=>[je(ee(`${H(re)("class")}: ${i.race.MaxClass}`),1)]),_:1})):Ft("",!0),i.race.Ghosting?($e(),gt(ln,{key:5,"prepend-icon":"mdi-ghost"},{default:Q(()=>[je(ee(T.value),1)]),_:1})):Ft("",!0),i.race.FirstPerson?($e(),gt(ln,{key:6,"prepend-icon":"mdi-eye-lock"},{default:Q(()=>[je(ee(H(re)("first_person")),1)]),_:1})):Ft("",!0),A(ln,{"prepend-icon":"mdi-robot-dead"},{default:Q(()=>[je(ee(`${i.race.RaceData.Automated?H(re)("starts_in"):`${H(re)("expires")}:`} ${O.value}:${z.value}`),1)]),_:1}),i.race.Reversed?($e(),gt(ln,{key:7,"prepend-icon":"mdi-backup-restore"},{default:Q(()=>[je(ee(H(re)("reversed")),1)]),_:1})):Ft("",!0),A(ln,{"prepend-icon":"mdi-account-star"},{default:Q(()=>[je(ee(H(re)("hosted_by"))+" "+ee(i.race.SetupRacerName),1)]),_:1})]}),_:1}),i.race.disabled?Ft("",!0):($e(),gt(Yn,{key:0},{default:Q(()=>[A(ar),A(Gt,{rounded:"xl",variant:"text",onClick:q[0]||(q[0]=oe=>k())},{default:Q(()=>[je(ee(H(re)("show_track")),1)]),_:1}),A(Gt,{rounded:"xl",variant:"flat",color:"primary",onClick:q[1]||(q[1]=oe=>h())},{default:Q(()=>[je(ee(H(re)("join_race")),1)]),_:1})]),_:1}))]),_:1}))}}),qD={class:"inline standardGap"},WD=Un({__name:"AvailableTracksCard",props:{track:{}},emits:["select"],setup(e,{emit:i}){const l=e,h=i,p=async()=>{(await hn.post("UiShowTrack",JSON.stringify(l.track.RaceId))).data&&Fa()},_=async()=>{(await hn.post("UiQuickHost",JSON.stringify(l.track))).data&&Fa()},m=async()=>{h("select",l.track)};return(o,T)=>($e(),gt($n,{rounded:"xl",class:"available-card",border:""},{default:Q(()=>{var k;return[A(Hn,null,{default:Q(()=>[je(ee(o.track.RaceName),1)]),_:1}),(k=o.track.Metadata)!=null&&k.description?($e(),gt(iv,{key:0,class:"subtitle-text"},{default:Q(()=>[je(ee(o.track.Metadata.description),1)]),_:1})):Ft("",!0),A(ti,null,{default:Q(()=>{var M;return[Ke("div",qD,[o.track.Curated?($e(),gt(ln,{key:0,color:"green","prepend-icon":"mdi-star"},{default:Q(()=>[je(ee(H(re)("curated")),1)]),_:1})):Ft("",!0),A(ln,{color:"primary","prepend-icon":"mdi-account-star"},{default:Q(()=>[je(ee(H(re)("creator"))+" : "+ee(o.track.CreatorName),1)]),_:1}),A(ln,{color:"primary"},{default:Q(()=>[je(ee(H(re)("length"))+" : "+ee(o.track.Distance),1)]),_:1}),(M=o.track.Metadata)!=null&&M.raceType&&o.track.Metadata.raceType!=="any_type"?($e(),gt(ln,{key:1,color:"primary","prepend-icon":"mdi-go-kart-track"},{default:Q(()=>[je(ee(H(re)(o.track.Metadata.raceType)),1)]),_:1})):Ft("",!0)])]}),_:1}),A(Yn,null,{default:Q(()=>[A(ar),A(Gt,{rounded:"xl",variant:"text",onClick:T[0]||(T[0]=M=>p())},{default:Q(()=>[je(ee(H(re)("show_track")),1)]),_:1}),A(Gt,{rounded:"xl",variant:"outlined",color:"primary",onClick:T[1]||(T[1]=M=>m())},{default:Q(()=>[je(ee(H(re)("setup_race")),1)]),_:1}),A(Gt,{rounded:"xl",variant:"flat",color:"primary",onClick:T[2]||(T[2]=M=>_())},{default:Q(()=>[je(ee(H(re)("quick_host")),1)]),_:1})]),_:1})]}),_:1}))}});const XD=Mi(WD,[["__scopeId","data-v-409f3761"]]),KD=Un({__name:"CurrentRaceCard",props:{race:{}},emits:["start","leave","cancel"],setup(e,{emit:i}){const l=vi(),h=e,p=i,_=ue(()=>{let M=re("sprint");return h.race.laps==-1?M=re("elimination")+" ":h.race.laps>0&&(M=h.race.laps+" "+re("laps")),M}),m=async()=>{p("start",h.race)},o=async()=>{p("leave",h.race)},T=Ye(!1),k=async()=>{T.value=!0;const M=await hn.post("UiCancelRace",JSON.stringify(h.race.raceId));M&&M.data&&p("cancel"),T.value=!1};return(M,D)=>($e(),gt($n,{border:"",rounded:"xl"},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(h.race.trackName),1)]),_:1}),A(ti,{class:"inline standardGap"},{default:Q(()=>[h.race.ranked?($e(),gt(ln,{key:0,"prepend-icon":"mdi-podium-gold",color:"orange",text:H(re)("ranked")},null,8,["text"])):Ft("",!0),A(ln,{"prepend-icon":"mdi-go-kart-track"},{default:Q(()=>[je(ee(_.value),1)]),_:1}),A(ln,{"prepend-icon":"mdi-account-group"},{default:Q(()=>[je(ee(H(re)("racers"))+" "+ee(h.race.racers),1)]),_:1}),A(ln,{"prepend-icon":"mdi-ghost"},{default:Q(()=>[je(ee(H(re)("ghosting"))+" : "+ee(h.race.ghosting?H(re)("on"):H(re)("off")),1)]),_:1}),A(ln,{"prepend-icon":"mdi-car-info"},{default:Q(()=>[je(ee(H(re)("max_class"))+" : "+ee(h.race.class),1)]),_:1}),A(ln,{"prepend-icon":"mdi-account-star"},{default:Q(()=>[je(ee(H(re)("hosted_by"))+" "+ee(h.race.hostName),1)]),_:1}),h.race.reversed?($e(),gt(ln,{key:1,"prepend-icon":"mdi-backup-restore"},{default:Q(()=>[je(ee(H(re)("reversed")),1)]),_:1})):Ft("",!0)]),_:1}),A(Yn,null,{default:Q(()=>[A(ar),h.race.canStart?($e(),gt(Gt,{key:0,rounded:"xl",variant:"flat",loading:T.value,color:"red",onClick:D[0]||(D[0]=O=>k())},{default:Q(()=>[je(ee(H(re)("cancel_race")),1)]),_:1},8,["loading"])):Ft("",!0),!h.race.canStart&&H(l).baseData.data.auth.cancelAll?($e(),gt(Gt,{key:1,rounded:"xl",variant:"flat",loading:T.value,color:"red",onClick:D[1]||(D[1]=O=>k())},{default:Q(()=>[je(ee(H(re)("cancel_race_forced")),1)]),_:1},8,["loading"])):Ft("",!0),A(Gt,{rounded:"xl",variant:"flat",color:"red",onClick:D[2]||(D[2]=O=>o())},{default:Q(()=>[je(ee(H(re)("leave_race")),1)]),_:1}),h.race.canStart?($e(),gt(Gt,{key:2,rounded:"xl",variant:"flat",color:"success",onClick:D[3]||(D[3]=O=>m())},{default:Q(()=>[je(ee(H(re)("start_race")),1)]),_:1})):Ft("",!0),!h.race.canStart&&H(l).baseData.data.auth.startAll?($e(),gt(Gt,{key:3,rounded:"xl",variant:"flat",color:"success",onClick:D[4]||(D[4]=O=>m())},{default:Q(()=>[je(ee(H(re)("start_race_forced")),1)]),_:1})):Ft("",!0)]),_:1})]),_:1}))}});const YD=Ct({fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,...Vd({origin:"center center",scrollStrategy:"block",transition:{component:By},zIndex:2400})},"VDialog"),_a=qt()({name:"VDialog",props:YD(),emits:{"update:modelValue":e=>!0,afterEnter:()=>!0,afterLeave:()=>!0},setup(e,i){let{emit:l,slots:h}=i;const p=ii(e,"modelValue"),{scopeId:_}=nc(),m=Ye();function o(M){var z,F;const D=M.relatedTarget,O=M.target;if(D!==O&&((z=m.value)!=null&&z.contentEl)&&((F=m.value)!=null&&F.globalTop)&&![document,m.value.contentEl].includes(O)&&!m.value.contentEl.contains(O)){const N=fd(m.value.contentEl);if(!N.length)return;const q=N[0],oe=N[N.length-1];D===q?oe.focus():q.focus()}}kr(()=>{document.removeEventListener("focusin",o)}),Zn&&Qt(()=>p.value&&e.retainFocus,M=>{M?document.addEventListener("focusin",o):document.removeEventListener("focusin",o)},{immediate:!0});function T(){var M;l("afterEnter"),(M=m.value)!=null&&M.contentEl&&!m.value.contentEl.contains(document.activeElement)&&m.value.contentEl.focus({preventScroll:!0})}function k(){l("afterLeave")}return Qt(p,async M=>{var D;M||(await Fi(),(D=m.value.activatorEl)==null||D.focus({preventScroll:!0}))}),dn(()=>{const M=qo.filterProps(e),D=sn({"aria-haspopup":"dialog"},e.activatorProps),O=sn({tabindex:-1},e.contentProps);return A(qo,sn({ref:m,class:["v-dialog",{"v-dialog--fullscreen":e.fullscreen,"v-dialog--scrollable":e.scrollable},e.class],style:e.style},M,{modelValue:p.value,"onUpdate:modelValue":z=>p.value=z,"aria-modal":"true",activatorProps:D,contentProps:O,height:e.fullscreen?void 0:e.height,width:e.fullscreen?void 0:e.width,maxHeight:e.fullscreen?void 0:e.maxHeight,maxWidth:e.fullscreen?void 0:e.maxWidth,role:"dialog",onAfterEnter:T,onAfterLeave:k},_),{activator:h.activator,default:function(){for(var z=arguments.length,F=new Array(z),N=0;N<z;N++)F[N]=arguments[N];return A(Bi,{root:"VDialog"},{default:()=>{var q;return[(q=h.default)==null?void 0:q.call(h,...F)]}})}})}),uo({},m)}}),RC=Symbol.for("vuetify:form"),JD=Ct({disabled:Boolean,fastFail:Boolean,readonly:Boolean,modelValue:{type:Boolean,default:null},validateOn:{type:String,default:"input"}},"form");function QD(e){const i=ii(e,"modelValue"),l=ue(()=>e.disabled),h=ue(()=>e.readonly),p=an(!1),_=Ye([]),m=Ye([]);async function o(){const M=[];let D=!0;m.value=[],p.value=!0;for(const O of _.value){const z=await O.validate();if(z.length>0&&(D=!1,M.push({id:O.id,errorMessages:z})),!D&&e.fastFail)break}return m.value=M,p.value=!1,{valid:D,errors:m.value}}function T(){_.value.forEach(M=>M.reset())}function k(){_.value.forEach(M=>M.resetValidation())}return Qt(_,()=>{let M=0,D=0;const O=[];for(const z of _.value)z.isValid===!1?(D++,O.push({id:z.id,errorMessages:z.errorMessages})):z.isValid===!0&&M++;m.value=O,i.value=D>0?!1:M===_.value.length?!0:null},{deep:!0,flush:"post"}),Ir(RC,{register:M=>{let{id:D,vm:O,validate:z,reset:F,resetValidation:N}=M;_.value.some(q=>q.id===D),_.value.push({id:D,validate:z,reset:F,resetValidation:N,vm:cm(O),isValid:null,errorMessages:[]})},unregister:M=>{_.value=_.value.filter(D=>D.id!==M)},update:(M,D,O)=>{const z=_.value.find(F=>F.id===M);z&&(z.isValid=D,z.errorMessages=O)},isDisabled:l,isReadonly:h,isValidating:p,isValid:i,items:_,validateOn:nn(e,"validateOn")}),{errors:m,isDisabled:l,isReadonly:h,isValidating:p,isValid:i,items:_,validate:o,reset:T,resetValidation:k}}function DC(e){const i=ni(RC,null);return{...i,isReadonly:ue(()=>!!((e==null?void 0:e.readonly)??(i==null?void 0:i.isReadonly.value))),isDisabled:ue(()=>!!((e==null?void 0:e.disabled)??(i==null?void 0:i.isDisabled.value)))}}const ez=Ct({...xn(),...JD()},"VForm"),zC=qt()({name:"VForm",props:ez(),emits:{"update:modelValue":e=>!0,submit:e=>!0},setup(e,i){let{slots:l,emit:h}=i;const p=QD(e),_=Ye();function m(T){T.preventDefault(),p.reset()}function o(T){const k=T,M=p.validate();k.then=M.then.bind(M),k.catch=M.catch.bind(M),k.finally=M.finally.bind(M),h("submit",k),k.defaultPrevented||M.then(D=>{var z;let{valid:O}=D;O&&((z=_.value)==null||z.submit())}),k.preventDefault()}return dn(()=>{var T;return A("form",{ref:_,class:["v-form",e.class],style:e.style,novalidate:!0,onReset:m,onSubmit:o},[(T=l.default)==null?void 0:T.call(l,p)])}),uo(p,_)}});const tz=Ct({text:String,onClick:ra(),...xn(),...Di()},"VLabel"),LC=qt()({name:"VLabel",props:tz(),setup(e,i){let{slots:l}=i;return dn(()=>{var h;return A("label",{class:["v-label",{"v-label--clickable":!!e.onClick},e.class],style:e.style,onClick:e.onClick},[e.text,(h=l.default)==null?void 0:h.call(l)])}),{}}});const BC=Symbol.for("vuetify:selection-control-group"),FC=Ct({color:String,disabled:{type:Boolean,default:null},defaultsTarget:String,error:Boolean,id:String,inline:Boolean,falseIcon:jn,trueIcon:jn,ripple:{type:[Boolean,Object],default:!0},multiple:{type:Boolean,default:null},name:String,readonly:{type:Boolean,default:null},modelValue:null,type:String,valueComparator:{type:Function,default:_u},...xn(),...Ca(),...Di()},"SelectionControlGroup"),nz=Ct({...FC({defaultsTarget:"VSelectionControl"})},"VSelectionControlGroup");qt()({name:"VSelectionControlGroup",props:nz(),emits:{"update:modelValue":e=>!0},setup(e,i){let{slots:l}=i;const h=ii(e,"modelValue"),p=wa(),_=ue(()=>e.id||`v-selection-control-group-${p}`),m=ue(()=>e.name||_.value),o=new Set;return Ir(BC,{modelValue:h,forceUpdate:()=>{o.forEach(T=>T())},onForceUpdate:T=>{o.add(T),Pr(()=>{o.delete(T)})}}),Qo({[e.defaultsTarget]:{color:nn(e,"color"),disabled:nn(e,"disabled"),density:nn(e,"density"),error:nn(e,"error"),inline:nn(e,"inline"),modelValue:h,multiple:ue(()=>!!e.multiple||e.multiple==null&&Array.isArray(h.value)),name:m,falseIcon:nn(e,"falseIcon"),trueIcon:nn(e,"trueIcon"),readonly:nn(e,"readonly"),ripple:nn(e,"ripple"),type:nn(e,"type"),valueComparator:nn(e,"valueComparator")}}),dn(()=>{var T;return A("div",{class:["v-selection-control-group",{"v-selection-control-group--inline":e.inline},e.class],style:e.style,role:e.type==="radio"?"radiogroup":void 0},[(T=l.default)==null?void 0:T.call(l)])}),{}}});const ov=Ct({label:String,baseColor:String,trueValue:null,falseValue:null,value:null,...xn(),...FC()},"VSelectionControl");function iz(e){const i=ni(BC,void 0),{densityClasses:l}=Na(e),h=ii(e,"modelValue"),p=ue(()=>e.trueValue!==void 0?e.trueValue:e.value!==void 0?e.value:!0),_=ue(()=>e.falseValue!==void 0?e.falseValue:!1),m=ue(()=>!!e.multiple||e.multiple==null&&Array.isArray(h.value)),o=ue({get(){const z=i?i.modelValue.value:h.value;return m.value?ns(z).some(F=>e.valueComparator(F,p.value)):e.valueComparator(z,p.value)},set(z){if(e.readonly)return;const F=z?p.value:_.value;let N=F;m.value&&(N=z?[...ns(h.value),F]:ns(h.value).filter(q=>!e.valueComparator(q,p.value))),i?i.modelValue.value=N:h.value=N}}),{textColorClasses:T,textColorStyles:k}=as(ue(()=>{if(!(e.error||e.disabled))return o.value?e.color:e.baseColor})),{backgroundColorClasses:M,backgroundColorStyles:D}=La(ue(()=>o.value&&!e.error&&!e.disabled?e.color:e.baseColor)),O=ue(()=>o.value?e.trueIcon:e.falseIcon);return{group:i,densityClasses:l,trueValue:p,falseValue:_,model:o,textColorClasses:T,textColorStyles:k,backgroundColorClasses:M,backgroundColorStyles:D,icon:O}}const nm=qt()({name:"VSelectionControl",directives:{Ripple:zd},inheritAttrs:!1,props:ov(),emits:{"update:modelValue":e=>!0},setup(e,i){let{attrs:l,slots:h}=i;const{group:p,densityClasses:_,icon:m,model:o,textColorClasses:T,textColorStyles:k,backgroundColorClasses:M,backgroundColorStyles:D,trueValue:O}=iz(e),z=wa(),F=an(!1),N=an(!1),q=Ye(),oe=ue(()=>e.id||`input-${z}`),_e=ue(()=>!e.disabled&&!e.readonly);p==null||p.onForceUpdate(()=>{q.value&&(q.value.checked=o.value)});function Se(Ce){_e.value&&(F.value=!0,Gp(Ce.target,":focus-visible")!==!1&&(N.value=!0))}function pe(){F.value=!1,N.value=!1}function be(Ce){Ce.stopPropagation()}function de(Ce){if(!_e.value){q.value&&(q.value.checked=o.value);return}e.readonly&&p&&Fi(()=>p.forceUpdate()),o.value=Ce.target.checked}return dn(()=>{var Ee,xe;const Ce=h.label?h.label({label:e.label,props:{for:oe.value}}):e.label,[ye,Me]=ym(l),ke=A("input",sn({ref:q,checked:o.value,disabled:!!e.disabled,id:oe.value,onBlur:pe,onFocus:Se,onInput:de,"aria-disabled":!!e.disabled,"aria-label":e.label,type:e.type,value:O.value,name:e.name,"aria-checked":e.type==="checkbox"?o.value:void 0},Me),null);return A("div",sn({class:["v-selection-control",{"v-selection-control--dirty":o.value,"v-selection-control--disabled":e.disabled,"v-selection-control--error":e.error,"v-selection-control--focused":F.value,"v-selection-control--focus-visible":N.value,"v-selection-control--inline":e.inline},_.value,e.class]},ye,{style:e.style}),[A("div",{class:["v-selection-control__wrapper",T.value],style:k.value},[(Ee=h.default)==null?void 0:Ee.call(h,{backgroundColorClasses:M,backgroundColorStyles:D}),Tr(A("div",{class:["v-selection-control__input"]},[((xe=h.input)==null?void 0:xe.call(h,{model:o,textColorClasses:T,textColorStyles:k,backgroundColorClasses:M,backgroundColorStyles:D,inputNode:ke,icon:m.value,props:{onFocus:Se,onBlur:pe,id:oe.value}}))??A(cn,null,[m.value&&A(li,{key:"icon",icon:m.value},null),ke])]),[[ao("ripple"),e.ripple&&[!e.disabled&&!e.readonly,null,["center","circle"]]]])]),Ce&&A(LC,{for:oe.value,onClick:be},{default:()=>[Ce]})])}),{isFocused:F,input:q}}}),rz=Ct({indeterminate:Boolean,indeterminateIcon:{type:jn,default:"$checkboxIndeterminate"},...ov({falseIcon:"$checkboxOff",trueIcon:"$checkboxOn"})},"VCheckboxBtn"),az=qt()({name:"VCheckboxBtn",props:rz(),emits:{"update:modelValue":e=>!0,"update:indeterminate":e=>!0},setup(e,i){let{slots:l}=i;const h=ii(e,"indeterminate"),p=ii(e,"modelValue");function _(T){h.value&&(h.value=!1)}const m=ue(()=>h.value?e.indeterminateIcon:e.falseIcon),o=ue(()=>h.value?e.indeterminateIcon:e.trueIcon);return dn(()=>{const T=Ts(nm.filterProps(e),["modelValue"]);return A(nm,sn(T,{modelValue:p.value,"onUpdate:modelValue":[k=>p.value=k,_],class:["v-checkbox-btn",e.class],style:e.style,type:"checkbox",falseIcon:m.value,trueIcon:o.value,"aria-checked":h.value?"mixed":void 0}),l)}),{}}});function OC(e){const{t:i}=Dd();function l(h){let{name:p}=h;const _={prepend:"prependAction",prependInner:"prependAction",append:"appendAction",appendInner:"appendAction",clear:"clear"}[p],m=e[`onClick:${p}`],o=m&&_?i(`$vuetify.input.${_}`,e.label??""):void 0;return A(li,{icon:e[`${p}Icon`],"aria-label":o,onClick:m},null)}return{InputIcon:l}}const sz=Ct({active:Boolean,color:String,messages:{type:[Array,String],default:()=>[]},...xn(),...Rd({transition:{component:qw,leaveAbsolute:!0,group:!0}})},"VMessages"),oz=qt()({name:"VMessages",props:sz(),setup(e,i){let{slots:l}=i;const h=ue(()=>ns(e.messages)),{textColorClasses:p,textColorStyles:_}=as(ue(()=>e.color));return dn(()=>A(eo,{transition:e.transition,tag:"div",class:["v-messages",p.value,e.class],style:[_.value,e.style],role:"alert","aria-live":"polite"},{default:()=>[e.active&&h.value.map((m,o)=>A("div",{class:"v-messages__message",key:`${o}-${h.value}`},[l.message?l.message({message:m}):m]))]})),{}}}),VC=Ct({focused:Boolean,"onUpdate:focused":ra()},"focus");function Lm(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ps();const l=ii(e,"focused"),h=ue(()=>({[`${i}--focused`]:l.value}));function p(){l.value=!0}function _(){l.value=!1}return{focusClasses:h,isFocused:l,focus:p,blur:_}}const lz=Ct({disabled:{type:Boolean,default:null},error:Boolean,errorMessages:{type:[Array,String],default:()=>[]},maxErrors:{type:[Number,String],default:1},name:String,label:String,readonly:{type:Boolean,default:null},rules:{type:Array,default:()=>[]},modelValue:null,validateOn:String,validationValue:null,...VC()},"validation");function cz(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ps(),l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:wa();const h=ii(e,"modelValue"),p=ue(()=>e.validationValue===void 0?h.value:e.validationValue),_=DC(e),m=Ye([]),o=an(!0),T=ue(()=>!!(ns(h.value===""?null:h.value).length||ns(p.value===""?null:p.value).length)),k=ue(()=>{var Se;return(Se=e.errorMessages)!=null&&Se.length?ns(e.errorMessages).concat(m.value).slice(0,Math.max(0,+e.maxErrors)):m.value}),M=ue(()=>{var be;let Se=(e.validateOn??((be=_.validateOn)==null?void 0:be.value))||"input";Se==="lazy"&&(Se="input lazy"),Se==="eager"&&(Se="input eager");const pe=new Set((Se==null?void 0:Se.split(" "))??[]);return{input:pe.has("input"),blur:pe.has("blur")||pe.has("input")||pe.has("invalid-input"),invalidInput:pe.has("invalid-input"),lazy:pe.has("lazy"),eager:pe.has("eager")}}),D=ue(()=>{var Se;return e.error||(Se=e.errorMessages)!=null&&Se.length?!1:e.rules.length?o.value?m.value.length||M.value.lazy?null:!0:!m.value.length:!0}),O=an(!1),z=ue(()=>({[`${i}--error`]:D.value===!1,[`${i}--dirty`]:T.value,[`${i}--disabled`]:_.isDisabled.value,[`${i}--readonly`]:_.isReadonly.value})),F=Gi("validation"),N=ue(()=>e.name??H(l));Pd(()=>{var Se;(Se=_.register)==null||Se.call(_,{id:N.value,vm:F,validate:_e,reset:q,resetValidation:oe})}),kr(()=>{var Se;(Se=_.unregister)==null||Se.call(_,N.value)}),yi(async()=>{var Se;M.value.lazy||await _e(!M.value.eager),(Se=_.update)==null||Se.call(_,N.value,D.value,k.value)}),Ba(()=>M.value.input||M.value.invalidInput&&D.value===!1,()=>{Qt(p,()=>{if(p.value!=null)_e();else if(e.focused){const Se=Qt(()=>e.focused,pe=>{pe||_e(),Se()})}})}),Ba(()=>M.value.blur,()=>{Qt(()=>e.focused,Se=>{Se||_e()})}),Qt([D,k],()=>{var Se;(Se=_.update)==null||Se.call(_,N.value,D.value,k.value)});async function q(){h.value=null,await Fi(),await oe()}async function oe(){o.value=!0,M.value.lazy?m.value=[]:await _e(!M.value.eager)}async function _e(){let Se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const pe=[];O.value=!0;for(const be of e.rules){if(pe.length>=+(e.maxErrors??1))break;const Ce=await(typeof be=="function"?be:()=>be)(p.value);if(Ce!==!0){if(Ce!==!1&&typeof Ce!="string"){console.warn(`${Ce} is not a valid value. Rule functions must return boolean true or a string.`);continue}pe.push(Ce||"")}}return m.value=pe,O.value=!1,o.value=Se,m.value}return{errorMessages:k,isDirty:T,isDisabled:_.isDisabled,isReadonly:_.isReadonly,isPristine:o,isValid:D,isValidating:O,reset:q,resetValidation:oe,validate:_e,validationClasses:z}}const Bm=Ct({id:String,appendIcon:jn,centerAffix:{type:Boolean,default:!0},prependIcon:jn,hideDetails:[Boolean,String],hideSpinButtons:Boolean,hint:String,persistentHint:Boolean,messages:{type:[Array,String],default:()=>[]},direction:{type:String,default:"horizontal",validator:e=>["horizontal","vertical"].includes(e)},"onClick:prepend":ra(),"onClick:append":ra(),...xn(),...Ca(),...uI(Oa(),["maxWidth","minWidth","width"]),...Di(),...lz()},"VInput"),gu=qt()({name:"VInput",props:{...Bm()},emits:{"update:modelValue":e=>!0},setup(e,i){let{attrs:l,slots:h,emit:p}=i;const{densityClasses:_}=Na(e),{dimensionStyles:m}=Va(e),{themeClasses:o}=Hi(e),{rtlClasses:T}=$a(),{InputIcon:k}=OC(e),M=wa(),D=ue(()=>e.id||`input-${M}`),O=ue(()=>`${D.value}-messages`),{errorMessages:z,isDirty:F,isDisabled:N,isReadonly:q,isPristine:oe,isValid:_e,isValidating:Se,reset:pe,resetValidation:be,validate:de,validationClasses:Ce}=cz(e,"v-input",D),ye=ue(()=>({id:D,messagesId:O,isDirty:F,isDisabled:N,isReadonly:q,isPristine:oe,isValid:_e,isValidating:Se,reset:pe,resetValidation:be,validate:de})),Me=ue(()=>{var ke;return(ke=e.errorMessages)!=null&&ke.length||!oe.value&&z.value.length?z.value:e.hint&&(e.persistentHint||e.focused)?e.hint:e.messages});return dn(()=>{var We,ht,Ne,tt;const ke=!!(h.prepend||e.prependIcon),Ee=!!(h.append||e.appendIcon),xe=Me.value.length>0,Fe=!e.hideDetails||e.hideDetails==="auto"&&(xe||!!h.details);return A("div",{class:["v-input",`v-input--${e.direction}`,{"v-input--center-affix":e.centerAffix,"v-input--hide-spin-buttons":e.hideSpinButtons},_.value,o.value,T.value,Ce.value,e.class],style:[m.value,e.style]},[ke&&A("div",{key:"prepend",class:"v-input__prepend"},[(We=h.prepend)==null?void 0:We.call(h,ye.value),e.prependIcon&&A(k,{key:"prepend-icon",name:"prepend"},null)]),h.default&&A("div",{class:"v-input__control"},[(ht=h.default)==null?void 0:ht.call(h,ye.value)]),Ee&&A("div",{key:"append",class:"v-input__append"},[e.appendIcon&&A(k,{key:"append-icon",name:"append"},null),(Ne=h.append)==null?void 0:Ne.call(h,ye.value)]),Fe&&A("div",{class:"v-input__details"},[A(oz,{id:O.value,active:xe,messages:Me.value},{message:h.message}),(tt=h.details)==null?void 0:tt.call(h,ye.value)])])}),{reset:pe,resetValidation:be,validate:de,isValid:_e,errorMessages:z}}});const uz=Ct({id:String,submenu:Boolean,...Ts(Vd({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",location:void 0,openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:By}}),["absolute"])},"VMenu"),hz=qt()({name:"VMenu",props:uz(),emits:{"update:modelValue":e=>!0},setup(e,i){let{slots:l}=i;const h=ii(e,"modelValue"),{scopeId:p}=nc(),{isRtl:_}=$a(),m=wa(),o=ue(()=>e.id||`v-menu-${m}`),T=Ye(),k=ni(ry,null),M=an(new Set);Ir(ry,{register(){M.value.add(m)},unregister(){M.value.delete(m)},closeParents(q){setTimeout(()=>{var oe;!M.value.size&&!e.persistent&&(q==null||(oe=T.value)!=null&&oe.contentEl&&!gI(q,T.value.contentEl))&&(h.value=!1,k==null||k.closeParents())},40)}}),kr(()=>{k==null||k.unregister(),document.removeEventListener("focusin",D)}),vy(()=>h.value=!1);async function D(q){var Se,pe,be;const oe=q.relatedTarget,_e=q.target;await Fi(),h.value&&oe!==_e&&((Se=T.value)!=null&&Se.contentEl)&&((pe=T.value)!=null&&pe.globalTop)&&![document,T.value.contentEl].includes(_e)&&!T.value.contentEl.contains(_e)&&((be=fd(T.value.contentEl)[0])==null||be.focus())}Qt(h,q=>{q?(k==null||k.register(),Zn&&document.addEventListener("focusin",D,{once:!0})):(k==null||k.unregister(),Zn&&document.removeEventListener("focusin",D))},{immediate:!0});function O(q){k==null||k.closeParents(q)}function z(q){var oe,_e,Se,pe,be;if(!e.disabled)if(q.key==="Tab"||q.key==="Enter"&&!e.closeOnContentClick){if(q.key==="Enter"&&(q.target instanceof HTMLTextAreaElement||q.target instanceof HTMLInputElement&&q.target.closest("form")))return;q.key==="Enter"&&q.preventDefault(),Dw(fd((oe=T.value)==null?void 0:oe.contentEl,!1),q.shiftKey?"prev":"next",Ce=>Ce.tabIndex>=0)||(h.value=!1,(Se=(_e=T.value)==null?void 0:_e.activatorEl)==null||Se.focus())}else e.submenu&&q.key===(_.value?"ArrowRight":"ArrowLeft")&&(h.value=!1,(be=(pe=T.value)==null?void 0:pe.activatorEl)==null||be.focus())}function F(q){var _e;if(e.disabled)return;const oe=(_e=T.value)==null?void 0:_e.contentEl;oe&&h.value?q.key==="ArrowDown"?(q.preventDefault(),q.stopImmediatePropagation(),ad(oe,"next")):q.key==="ArrowUp"?(q.preventDefault(),q.stopImmediatePropagation(),ad(oe,"prev")):e.submenu&&(q.key===(_.value?"ArrowRight":"ArrowLeft")?h.value=!1:q.key===(_.value?"ArrowLeft":"ArrowRight")&&(q.preventDefault(),ad(oe,"first"))):(e.submenu?q.key===(_.value?"ArrowLeft":"ArrowRight"):["ArrowDown","ArrowUp"].includes(q.key))&&(h.value=!0,q.preventDefault(),setTimeout(()=>setTimeout(()=>F(q))))}const N=ue(()=>sn({"aria-haspopup":"menu","aria-expanded":String(h.value),"aria-owns":o.value,onKeydown:F},e.activatorProps));return dn(()=>{const q=qo.filterProps(e);return A(qo,sn({ref:T,id:o.value,class:["v-menu",e.class],style:e.style},q,{modelValue:h.value,"onUpdate:modelValue":oe=>h.value=oe,absolute:!0,activatorProps:N.value,location:e.location??(e.submenu?"end":"bottom"),"onClick:outside":O,onKeydown:z},p),{activator:l.activator,default:function(){for(var oe=arguments.length,_e=new Array(oe),Se=0;Se<oe;Se++)_e[Se]=arguments[Se];return A(Bi,{root:"VMenu"},{default:()=>{var pe;return[(pe=l.default)==null?void 0:pe.call(l,..._e)]}})}})}),uo({id:o,ΨopenChildren:M},T)}});const dz=Ct({active:Boolean,disabled:Boolean,max:[Number,String],value:{type:[Number,String],default:0},...xn(),...Rd({transition:{component:qw}})},"VCounter"),NC=qt()({name:"VCounter",functional:!0,props:dz(),setup(e,i){let{slots:l}=i;const h=ue(()=>e.max?`${e.value} / ${e.max}`:String(e.value));return dn(()=>A(eo,{transition:e.transition},{default:()=>[Tr(A("div",{class:["v-counter",{"text-error":e.max&&!e.disabled&&parseFloat(e.value)>parseFloat(e.max)},e.class],style:e.style},[l.default?l.default({counter:h.value,max:e.max,value:e.value}):h.value]),[[Ql,e.active]])]})),{}}});const fz=Ct({floating:Boolean,...xn()},"VFieldLabel"),gp=qt()({name:"VFieldLabel",props:fz(),setup(e,i){let{slots:l}=i;return dn(()=>A(LC,{class:["v-field-label",{"v-field-label--floating":e.floating},e.class],style:e.style,"aria-hidden":e.floating||void 0},l)),{}}}),pz=["underlined","outlined","filled","solo","solo-inverted","solo-filled","plain"],lv=Ct({appendInnerIcon:jn,bgColor:String,clearable:Boolean,clearIcon:{type:jn,default:"$clear"},active:Boolean,centerAffix:{type:Boolean,default:void 0},color:String,baseColor:String,dirty:Boolean,disabled:{type:Boolean,default:null},error:Boolean,flat:Boolean,label:String,persistentClear:Boolean,prependInnerIcon:jn,reverse:Boolean,singleLine:Boolean,variant:{type:String,default:"filled",validator:e=>pz.includes(e)},"onClick:clear":ra(),"onClick:appendInner":ra(),"onClick:prependInner":ra(),...xn(),...tv(),...oa(),...Di()},"VField"),cv=qt()({name:"VField",inheritAttrs:!1,props:{id:String,...VC(),...lv()},emits:{"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,i){let{attrs:l,emit:h,slots:p}=i;const{themeClasses:_}=Hi(e),{loaderClasses:m}=zm(e),{focusClasses:o,isFocused:T,focus:k,blur:M}=Lm(e),{InputIcon:D}=OC(e),{roundedClasses:O}=la(e),{rtlClasses:z}=$a(),F=ue(()=>e.dirty||e.active),N=ue(()=>!e.singleLine&&!!(e.label||p.label)),q=wa(),oe=ue(()=>e.id||`input-${q}`),_e=ue(()=>`${oe.value}-messages`),Se=Ye(),pe=Ye(),be=Ye(),de=ue(()=>["plain","underlined"].includes(e.variant)),{backgroundColorClasses:Ce,backgroundColorStyles:ye}=La(nn(e,"bgColor")),{textColorClasses:Me,textColorStyles:ke}=as(ue(()=>e.error||e.disabled?void 0:F.value&&T.value?e.color:e.baseColor));Qt(F,We=>{if(N.value){const ht=Se.value.$el,Ne=pe.value.$el;requestAnimationFrame(()=>{const tt=Ry(ht),Mt=Ne.getBoundingClientRect(),_t=Mt.x-tt.x,Qe=Mt.y-tt.y-(tt.height/2-Mt.height/2),ct=Mt.width/.75,Dt=Math.abs(ct-tt.width)>1?{maxWidth:mn(ct)}:void 0,Yt=getComputedStyle(ht),zt=getComputedStyle(Ne),Kt=parseFloat(Yt.transitionDuration)*1e3||150,Zt=parseFloat(zt.getPropertyValue("--v-field-label-scale")),_n=zt.getPropertyValue("color");ht.style.visibility="visible",Ne.style.visibility="hidden",jl(ht,{transform:`translate(${_t}px, ${Qe}px) scale(${Zt})`,color:_n,...Dt},{duration:Kt,easing:md,direction:We?"normal":"reverse"}).finished.then(()=>{ht.style.removeProperty("visibility"),Ne.style.removeProperty("visibility")})})}},{flush:"post"});const Ee=ue(()=>({isActive:F,isFocused:T,controlRef:be,blur:M,focus:k}));function xe(We){We.target!==document.activeElement&&We.preventDefault()}function Fe(We){var ht;We.key!=="Enter"&&We.key!==" "||(We.preventDefault(),We.stopPropagation(),(ht=e["onClick:clear"])==null||ht.call(e,new MouseEvent("click")))}return dn(()=>{var _t,Qe,ct;const We=e.variant==="outlined",ht=!!(p["prepend-inner"]||e.prependInnerIcon),Ne=!!(e.clearable||p.clear),tt=!!(p["append-inner"]||e.appendInnerIcon||Ne),Mt=()=>p.label?p.label({...Ee.value,label:e.label,props:{for:oe.value}}):e.label;return A("div",sn({class:["v-field",{"v-field--active":F.value,"v-field--appended":tt,"v-field--center-affix":e.centerAffix??!de.value,"v-field--disabled":e.disabled,"v-field--dirty":e.dirty,"v-field--error":e.error,"v-field--flat":e.flat,"v-field--has-background":!!e.bgColor,"v-field--persistent-clear":e.persistentClear,"v-field--prepended":ht,"v-field--reverse":e.reverse,"v-field--single-line":e.singleLine,"v-field--no-label":!Mt(),[`v-field--variant-${e.variant}`]:!0},_.value,Ce.value,o.value,m.value,O.value,z.value,e.class],style:[ye.value,e.style],onClick:xe},l),[A("div",{class:"v-field__overlay"},null),A(nv,{name:"v-field",active:!!e.loading,color:e.error?"error":typeof e.loading=="string"?e.loading:e.color},{default:p.loader}),ht&&A("div",{key:"prepend",class:"v-field__prepend-inner"},[e.prependInnerIcon&&A(D,{key:"prepend-icon",name:"prependInner"},null),(_t=p["prepend-inner"])==null?void 0:_t.call(p,Ee.value)]),A("div",{class:"v-field__field","data-no-activator":""},[["filled","solo","solo-inverted","solo-filled"].includes(e.variant)&&N.value&&A(gp,{key:"floating-label",ref:pe,class:[Me.value],floating:!0,for:oe.value,style:ke.value},{default:()=>[Mt()]}),N.value&&A(gp,{key:"label",ref:Se,for:oe.value},{default:()=>[Mt()]}),(Qe=p.default)==null?void 0:Qe.call(p,{...Ee.value,props:{id:oe.value,class:"v-field__input","aria-describedby":_e.value},focus:k,blur:M})]),Ne&&A(Ww,{key:"clear"},{default:()=>[Tr(A("div",{class:"v-field__clearable",onMousedown:Dt=>{Dt.preventDefault(),Dt.stopPropagation()}},[A(Bi,{defaults:{VIcon:{icon:e.clearIcon}}},{default:()=>[p.clear?p.clear({...Ee.value,props:{onKeydown:Fe,onFocus:k,onBlur:M,onClick:e["onClick:clear"]}}):A(D,{name:"clear",onKeydown:Fe,onFocus:k,onBlur:M},null)]})]),[[Ql,e.dirty]])]}),tt&&A("div",{key:"append",class:"v-field__append-inner"},[(ct=p["append-inner"])==null?void 0:ct.call(p,Ee.value),e.appendInnerIcon&&A(D,{key:"append-icon",name:"appendInner"},null)]),A("div",{class:["v-field__outline",Me.value],style:ke.value},[We&&A(cn,null,[A("div",{class:"v-field__outline__start"},null),N.value&&A("div",{class:"v-field__outline__notch"},[A(gp,{ref:pe,floating:!0,for:oe.value},{default:()=>[Mt()]})]),A("div",{class:"v-field__outline__end"},null)]),de.value&&N.value&&A(gp,{ref:pe,floating:!0,for:oe.value},{default:()=>[Mt()]})])])}),{controlRef:be}}});function $C(e){const i=Object.keys(cv.props).filter(l=>!Ey(l)&&l!=="class"&&l!=="style");return Iw(e,i)}const mz=["color","file","time","date","datetime-local","week","month"],jC=Ct({autofocus:Boolean,counter:[Boolean,Number,String],counterValue:[Number,Function],prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,suffix:String,role:String,type:{type:String,default:"text"},modelModifiers:Object,...Bm(),...lv()},"VTextField"),hr=qt()({name:"VTextField",directives:{Intersect:Oy},inheritAttrs:!1,props:jC(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,i){let{attrs:l,emit:h,slots:p}=i;const _=ii(e,"modelValue"),{isFocused:m,focus:o,blur:T}=Lm(e),k=ue(()=>typeof e.counterValue=="function"?e.counterValue(_.value):typeof e.counterValue=="number"?e.counterValue:(_.value??"").toString().length),M=ue(()=>{if(l.maxlength)return l.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter}),D=ue(()=>["plain","underlined"].includes(e.variant));function O(de,Ce){var ye,Me;!e.autofocus||!de||(Me=(ye=Ce[0].target)==null?void 0:ye.focus)==null||Me.call(ye)}const z=Ye(),F=Ye(),N=Ye(),q=ue(()=>mz.includes(e.type)||e.persistentPlaceholder||m.value||e.active);function oe(){var de;N.value!==document.activeElement&&((de=N.value)==null||de.focus()),m.value||o()}function _e(de){h("mousedown:control",de),de.target!==N.value&&(oe(),de.preventDefault())}function Se(de){oe(),h("click:control",de)}function pe(de){de.stopPropagation(),oe(),Fi(()=>{_.value=null,Rw(e["onClick:clear"],de)})}function be(de){var ye;const Ce=de.target;if(_.value=Ce.value,(ye=e.modelModifiers)!=null&&ye.trim&&["text","search","password","tel","url"].includes(e.type)){const Me=[Ce.selectionStart,Ce.selectionEnd];Fi(()=>{Ce.selectionStart=Me[0],Ce.selectionEnd=Me[1]})}}return dn(()=>{const de=!!(p.counter||e.counter!==!1&&e.counter!=null),Ce=!!(de||p.details),[ye,Me]=ym(l),{modelValue:ke,...Ee}=gu.filterProps(e),xe=$C(e);return A(gu,sn({ref:z,modelValue:_.value,"onUpdate:modelValue":Fe=>_.value=Fe,class:["v-text-field",{"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-input--plain-underlined":D.value},e.class],style:e.style},ye,Ee,{centerAffix:!D.value,focused:m.value}),{...p,default:Fe=>{let{id:We,isDisabled:ht,isDirty:Ne,isReadonly:tt,isValid:Mt}=Fe;return A(cv,sn({ref:F,onMousedown:_e,onClick:Se,"onClick:clear":pe,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"],role:e.role},xe,{id:We.value,active:q.value||Ne.value,dirty:Ne.value||e.dirty,disabled:ht.value,focused:m.value,error:Mt.value===!1}),{...p,default:_t=>{let{props:{class:Qe,...ct}}=_t;const Dt=Tr(A("input",sn({ref:N,value:_.value,onInput:be,autofocus:e.autofocus,readonly:tt.value,disabled:ht.value,name:e.name,placeholder:e.placeholder,size:1,type:e.type,onFocus:oe,onBlur:T},ct,Me),null),[[ao("intersect"),{handler:O},null,{once:!0}]]);return A(cn,null,[e.prefix&&A("span",{class:"v-text-field__prefix"},[A("span",{class:"v-text-field__prefix__text"},[e.prefix])]),p.default?A("div",{class:Qe,"data-no-activator":""},[p.default(),Dt]):no(Dt,{class:Qe}),e.suffix&&A("span",{class:"v-text-field__suffix"},[A("span",{class:"v-text-field__suffix__text"},[e.suffix])])])}})},details:Ce?Fe=>{var We;return A(cn,null,[(We=p.details)==null?void 0:We.call(p,Fe),de&&A(cn,null,[A("span",null,null),A(NC,{active:e.persistentCounter||m.value,value:k.value,max:M.value,disabled:e.disabled},p.counter)])])}:void 0})}),uo({},z,F,N)}});const gz=Ct({renderless:Boolean,...xn()},"VVirtualScrollItem"),_z=qt()({name:"VVirtualScrollItem",inheritAttrs:!1,props:gz(),emits:{"update:height":e=>!0},setup(e,i){let{attrs:l,emit:h,slots:p}=i;const{resizeRef:_,contentRect:m}=mu(void 0,"border");Qt(()=>{var o;return(o=m.value)==null?void 0:o.height},o=>{o!=null&&h("update:height",o)}),dn(()=>{var o,T;return e.renderless?A(cn,null,[(o=p.default)==null?void 0:o.call(p,{itemRef:_})]):A("div",sn({ref:_,class:["v-virtual-scroll__item",e.class],style:e.style},l),[(T=p.default)==null?void 0:T.call(p)])})}}),yz=-1,vz=1,b_=100,bz=Ct({itemHeight:{type:[Number,String],default:null},height:[Number,String]},"virtual");function xz(e,i){const l=wm(),h=an(0);xa(()=>{h.value=parseFloat(e.itemHeight||0)});const p=an(0),_=an(Math.ceil((parseInt(e.height)||l.height.value)/(h.value||16))||1),m=an(0),o=an(0),T=Ye(),k=Ye();let M=0;const{resizeRef:D,contentRect:O}=mu();xa(()=>{D.value=T.value});const z=ue(()=>{var Qe;return T.value===document.documentElement?l.height.value:((Qe=O.value)==null?void 0:Qe.height)||parseInt(e.height)||0}),F=ue(()=>!!(T.value&&k.value&&z.value&&h.value));let N=Array.from({length:i.value.length}),q=Array.from({length:i.value.length});const oe=an(0);let _e=-1;function Se(Qe){return N[Qe]||h.value}const pe=dI(()=>{const Qe=performance.now();q[0]=0;const ct=i.value.length;for(let Dt=1;Dt<=ct-1;Dt++)q[Dt]=(q[Dt-1]||0)+Se(Dt-1);oe.value=Math.max(oe.value,performance.now()-Qe)},oe),be=Qt(F,Qe=>{Qe&&(be(),M=k.value.offsetTop,pe.immediate(),Ne(),~_e&&Fi(()=>{Zn&&window.requestAnimationFrame(()=>{Mt(_e),_e=-1})}))});Pr(()=>{pe.clear()});function de(Qe,ct){const Dt=N[Qe],Yt=h.value;h.value=Yt?Math.min(h.value,ct):ct,(Dt!==ct||Yt!==h.value)&&(N[Qe]=ct,pe())}function Ce(Qe){return Qe=Ss(Qe,0,i.value.length-1),q[Qe]||0}function ye(Qe){return wz(q,Qe)}let Me=0,ke=0,Ee=0;Qt(z,(Qe,ct)=>{ct&&(Ne(),Qe<ct&&requestAnimationFrame(()=>{ke=0,Ne()}))});let xe=-1;function Fe(){if(!T.value||!k.value)return;const Qe=T.value.scrollTop,ct=performance.now();ct-Ee>500?(ke=Math.sign(Qe-Me),M=k.value.offsetTop):ke=Qe-Me,Me=Qe,Ee=ct,window.clearTimeout(xe),xe=window.setTimeout(We,500),Ne()}function We(){!T.value||!k.value||(ke=0,Ee=0,window.clearTimeout(xe),Ne())}let ht=-1;function Ne(){cancelAnimationFrame(ht),ht=requestAnimationFrame(tt)}function tt(){if(!T.value||!z.value)return;const Qe=Me-M,ct=Math.sign(ke),Dt=Math.max(0,Qe-b_),Yt=Ss(ye(Dt),0,i.value.length),zt=Qe+z.value+b_,Kt=Ss(ye(zt)+1,Yt+1,i.value.length);if((ct!==yz||Yt<p.value)&&(ct!==vz||Kt>_.value)){const Zt=Ce(p.value)-Ce(Yt),_n=Ce(Kt)-Ce(_.value);Math.max(Zt,_n)>b_?(p.value=Yt,_.value=Kt):(Yt<=0&&(p.value=Yt),Kt>=i.value.length&&(_.value=Kt))}m.value=Ce(p.value),o.value=Ce(i.value.length)-Ce(_.value)}function Mt(Qe){const ct=Ce(Qe);!T.value||Qe&&!ct?_e=Qe:T.value.scrollTop=ct}const _t=ue(()=>i.value.slice(p.value,_.value).map((Qe,ct)=>({raw:Qe,index:ct+p.value,key:Iy(Qe)&&"value"in Qe?Qe.value:ct+p.value})));return Qt(i,()=>{N=Array.from({length:i.value.length}),q=Array.from({length:i.value.length}),pe.immediate(),Ne()},{deep:!0}),{calculateVisibleItems:Ne,containerRef:T,markerRef:k,computedItems:_t,paddingTop:m,paddingBottom:o,scrollToIndex:Mt,handleScroll:Fe,handleScrollend:We,handleItemResize:de}}function wz(e,i){let l=e.length-1,h=0,p=0,_=null,m=-1;if(e[l]<i)return l;for(;h<=l;)if(p=h+l>>1,_=e[p],_>i)l=p-1;else if(_<i)m=p,h=p+1;else return _===i?p:h;return m}const Sz=Ct({items:{type:Array,default:()=>[]},renderless:Boolean,...bz(),...xn(),...Oa()},"VVirtualScroll"),Cz=qt()({name:"VVirtualScroll",props:Sz(),setup(e,i){let{slots:l}=i;const h=Gi("VVirtualScroll"),{dimensionStyles:p}=Va(e),{calculateVisibleItems:_,containerRef:m,markerRef:o,handleScroll:T,handleScrollend:k,handleItemResize:M,scrollToIndex:D,paddingTop:O,paddingBottom:z,computedItems:F}=xz(e,nn(e,"items"));return Ba(()=>e.renderless,()=>{function N(){var _e,Se;const oe=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?"addEventListener":"removeEventListener";m.value===document.documentElement?(document[oe]("scroll",T,{passive:!0}),document[oe]("scrollend",k)):((_e=m.value)==null||_e[oe]("scroll",T,{passive:!0}),(Se=m.value)==null||Se[oe]("scrollend",k))}yi(()=>{m.value=Gw(h.vnode.el,!0),N(!0)}),Pr(N)}),dn(()=>{const N=F.value.map(q=>A(_z,{key:q.key,renderless:e.renderless,"onUpdate:height":oe=>M(q.index,oe)},{default:oe=>{var _e;return(_e=l.default)==null?void 0:_e.call(l,{item:q.raw,index:q.index,...oe})}}));return e.renderless?A(cn,null,[A("div",{ref:o,class:"v-virtual-scroll__spacer",style:{paddingTop:mn(O.value)}},null),N,A("div",{class:"v-virtual-scroll__spacer",style:{paddingBottom:mn(z.value)}},null)]):A("div",{ref:m,class:["v-virtual-scroll",e.class],onScrollPassive:T,onScrollend:k,style:[p.value,e.style]},[A("div",{ref:o,class:"v-virtual-scroll__container",style:{paddingTop:mn(O.value),paddingBottom:mn(z.value)}},[N])])}),{calculateVisibleItems:_,scrollToIndex:D}}});function Tz(e,i){const l=an(!1);let h;function p(o){cancelAnimationFrame(h),l.value=!0,h=requestAnimationFrame(()=>{h=requestAnimationFrame(()=>{l.value=!1})})}async function _(){await new Promise(o=>requestAnimationFrame(o)),await new Promise(o=>requestAnimationFrame(o)),await new Promise(o=>requestAnimationFrame(o)),await new Promise(o=>{if(l.value){const T=Qt(l,()=>{T(),o()})}else o()})}async function m(o){var M,D;if(o.key==="Tab"&&((M=i.value)==null||M.focus()),!["PageDown","PageUp","Home","End"].includes(o.key))return;const T=(D=e.value)==null?void 0:D.$el;if(!T)return;(o.key==="Home"||o.key==="End")&&T.scrollTo({top:o.key==="Home"?0:T.scrollHeight,behavior:"smooth"}),await _();const k=T.querySelectorAll(":scope > :not(.v-virtual-scroll__spacer)");if(o.key==="PageDown"||o.key==="Home"){const O=T.getBoundingClientRect().top;for(const z of k)if(z.getBoundingClientRect().top>=O){z.focus();break}}else{const O=T.getBoundingClientRect().bottom;for(const z of[...k].reverse())if(z.getBoundingClientRect().bottom<=O){z.focus();break}}}return{onScrollPassive:p,onKeydown:m}}const Pz=Ct({chips:Boolean,closableChips:Boolean,closeText:{type:String,default:"$vuetify.close"},openText:{type:String,default:"$vuetify.open"},eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,listProps:{type:Object},menu:Boolean,menuIcon:{type:jn,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,itemColor:String,...IS({itemChildren:!1})},"Select"),kz=Ct({...Pz(),...Ts(jC({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...Rd({transition:{component:By}})},"VSelect"),xs=qt()({name:"VSelect",props:kz(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,i){let{slots:l}=i;const{t:h}=Dd(),p=Ye(),_=Ye(),m=Ye(),o=ii(e,"menu"),T=ue({get:()=>o.value,set:_t=>{var Qe;o.value&&!_t&&((Qe=_.value)!=null&&Qe.ΨopenChildren.size)||(o.value=_t)}}),{items:k,transformIn:M,transformOut:D}=_E(e),O=ii(e,"modelValue",[],_t=>M(_t===null?[null]:ns(_t)),_t=>{const Qe=D(_t);return e.multiple?Qe:Qe[0]??null}),z=ue(()=>typeof e.counterValue=="function"?e.counterValue(O.value):typeof e.counterValue=="number"?e.counterValue:O.value.length),F=DC(e),N=ue(()=>O.value.map(_t=>_t.value)),q=an(!1),oe=ue(()=>T.value?e.closeText:e.openText);let _e="",Se;const pe=ue(()=>e.hideSelected?k.value.filter(_t=>!O.value.some(Qe=>e.valueComparator(Qe,_t))):k.value),be=ue(()=>e.hideNoData&&!pe.value.length||F.isReadonly.value||F.isDisabled.value),de=ue(()=>{var _t;return{...e.menuProps,activatorProps:{...((_t=e.menuProps)==null?void 0:_t.activatorProps)||{},"aria-haspopup":"listbox"}}}),Ce=Ye(),ye=Tz(Ce,p);function Me(_t){e.openOnClear&&(T.value=!0)}function ke(){be.value||(T.value=!T.value)}function Ee(_t){$b(_t)&&xe(_t)}function xe(_t){var Yt,zt;if(!_t.key||F.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(_t.key)&&_t.preventDefault(),["Enter","ArrowDown"," "].includes(_t.key)&&(T.value=!0),["Escape","Tab"].includes(_t.key)&&(T.value=!1),_t.key==="Home"?(Yt=Ce.value)==null||Yt.focus("first"):_t.key==="End"&&((zt=Ce.value)==null||zt.focus("last"));const Qe=1e3;if(e.multiple||!$b(_t))return;const ct=performance.now();ct-Se>Qe&&(_e=""),_e+=_t.key.toLowerCase(),Se=ct;const Dt=k.value.find(Kt=>Kt.title.toLowerCase().startsWith(_e));if(Dt!==void 0){O.value=[Dt];const Kt=pe.value.indexOf(Dt);Zn&&window.requestAnimationFrame(()=>{var Zt;Kt>=0&&((Zt=m.value)==null||Zt.scrollToIndex(Kt))})}}function Fe(_t){let Qe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!_t.props.disabled)if(e.multiple){const ct=O.value.findIndex(Yt=>e.valueComparator(Yt.value,_t.value)),Dt=Qe??!~ct;if(~ct){const Yt=Dt?[...O.value,_t]:[...O.value];Yt.splice(ct,1),O.value=Yt}else Dt&&(O.value=[...O.value,_t])}else{const ct=Qe!==!1;O.value=ct?[_t]:[],Fi(()=>{T.value=!1})}}function We(_t){var Qe;(Qe=Ce.value)!=null&&Qe.$el.contains(_t.relatedTarget)||(T.value=!1)}function ht(){var _t;e.eager&&((_t=m.value)==null||_t.calculateVisibleItems())}function Ne(){var _t;q.value&&((_t=p.value)==null||_t.focus())}function tt(_t){q.value=!0}function Mt(_t){if(_t==null)O.value=[];else if(Gp(p.value,":autofill")||Gp(p.value,":-webkit-autofill")){const Qe=k.value.find(ct=>ct.title===_t);Qe&&Fe(Qe)}else p.value&&(p.value.value="")}return Qt(T,()=>{if(!e.hideSelected&&T.value&&O.value.length){const _t=pe.value.findIndex(Qe=>O.value.some(ct=>e.valueComparator(ct.value,Qe.value)));Zn&&window.requestAnimationFrame(()=>{var Qe;_t>=0&&((Qe=m.value)==null||Qe.scrollToIndex(_t))})}}),Qt(()=>e.items,(_t,Qe)=>{T.value||q.value&&!Qe.length&&_t.length&&(T.value=!0)}),dn(()=>{const _t=!!(e.chips||l.chip),Qe=!!(!e.hideNoData||pe.value.length||l["prepend-item"]||l["append-item"]||l["no-data"]),ct=O.value.length>0,Dt=hr.filterProps(e),Yt=ct||!q.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return A(hr,sn({ref:p},Dt,{modelValue:O.value.map(zt=>zt.props.value).join(", "),"onUpdate:modelValue":Mt,focused:q.value,"onUpdate:focused":zt=>q.value=zt,validationValue:O.externalValue,counterValue:z.value,dirty:ct,class:["v-select",{"v-select--active-menu":T.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":O.value.length,"v-select--selection-slot":!!l.selection},e.class],style:e.style,inputmode:"none",placeholder:Yt,"onClick:clear":Me,"onMousedown:control":ke,onBlur:We,onKeydown:xe,"aria-label":h(oe.value),title:h(oe.value)}),{...l,default:()=>A(cn,null,[A(hz,sn({ref:_,modelValue:T.value,"onUpdate:modelValue":zt=>T.value=zt,activator:"parent",contentClass:"v-select__content",disabled:be.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:ht,onAfterLeave:Ne},de.value),{default:()=>[Qe&&A(Wy,sn({ref:Ce,selected:N.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:zt=>zt.preventDefault(),onKeydown:Ee,onFocusin:tt,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},ye,e.listProps),{default:()=>{var zt,Kt,Zt;return[(zt=l["prepend-item"])==null?void 0:zt.call(l),!pe.value.length&&!e.hideNoData&&(((Kt=l["no-data"])==null?void 0:Kt.call(l))??A(es,{key:"no-data",title:h(e.noDataText)},null)),A(Cz,{ref:m,renderless:!0,items:pe.value},{default:_n=>{var En;let{item:bn,index:Vn,itemRef:On}=_n;const ri=sn(bn.props,{ref:On,key:bn.value,onClick:()=>Fe(bn,null)});return((En=l.item)==null?void 0:En.call(l,{item:bn,index:Vn,props:ri}))??A(es,sn(ri,{role:"option"}),{prepend:Pe=>{let{isSelected:Le}=Pe;return A(cn,null,[e.multiple&&!e.hideSelected?A(az,{key:bn.value,modelValue:Le,ripple:!1,tabindex:"-1"},null):void 0,bn.props.prependAvatar&&A(Kl,{image:bn.props.prependAvatar},null),bn.props.prependIcon&&A(li,{icon:bn.props.prependIcon},null)])}})}}),(Zt=l["append-item"])==null?void 0:Zt.call(l)]}})]}),O.value.map((zt,Kt)=>{function Zt(On){On.stopPropagation(),On.preventDefault(),Fe(zt,!1)}const _n={"onClick:close":Zt,onKeydown(On){On.key!=="Enter"&&On.key!==" "||(On.preventDefault(),On.stopPropagation(),Zt(On))},onMousedown(On){On.preventDefault(),On.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},bn=_t?!!l.chip:!!l.selection,Vn=bn?zw(_t?l.chip({item:zt,index:Kt,props:_n}):l.selection({item:zt,index:Kt})):void 0;if(!(bn&&!Vn))return A("div",{key:zt.value,class:"v-select__selection"},[_t?l.chip?A(Bi,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:zt.title}}},{default:()=>[Vn]}):A(ln,sn({key:"chip",closable:e.closableChips,size:"small",text:zt.title,disabled:zt.props.disabled},_n),null):Vn??A("span",{class:"v-select__selection-text"},[zt.title,e.multiple&&Kt<O.value.length-1&&A("span",{class:"v-select__selection-comma"},[je(",")])])])})]),"append-inner":function(){var _n;for(var zt=arguments.length,Kt=new Array(zt),Zt=0;Zt<zt;Zt++)Kt[Zt]=arguments[Zt];return A(cn,null,[(_n=l["append-inner"])==null?void 0:_n.call(l,...Kt),e.menuIcon?A(li,{class:"v-select__menu-icon",icon:e.menuIcon},null):void 0])}})}),uo({isFocused:q,menu:T,select:Fe},p)}});const Iz=Ct({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...Bm(),...ov()},"VSwitch"),Ra=qt()({name:"VSwitch",inheritAttrs:!1,props:Iz(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:indeterminate":e=>!0},setup(e,i){let{attrs:l,slots:h}=i;const p=ii(e,"indeterminate"),_=ii(e,"modelValue"),{loaderClasses:m}=zm(e),{isFocused:o,focus:T,blur:k}=Lm(e),M=Ye(),D=Zn&&window.matchMedia("(forced-colors: active)").matches,O=ue(()=>typeof e.loading=="string"&&e.loading!==""?e.loading:e.color),z=wa(),F=ue(()=>e.id||`switch-${z}`);function N(){p.value&&(p.value=!1)}function q(oe){var _e,Se;oe.stopPropagation(),oe.preventDefault(),(Se=(_e=M.value)==null?void 0:_e.input)==null||Se.click()}return dn(()=>{const[oe,_e]=ym(l),Se=gu.filterProps(e),pe=nm.filterProps(e);return A(gu,sn({class:["v-switch",{"v-switch--flat":e.flat},{"v-switch--inset":e.inset},{"v-switch--indeterminate":p.value},m.value,e.class]},oe,Se,{modelValue:_.value,"onUpdate:modelValue":be=>_.value=be,id:F.value,focused:o.value,style:e.style}),{...h,default:be=>{let{id:de,messagesId:Ce,isDisabled:ye,isReadonly:Me,isValid:ke}=be;const Ee={model:_,isValid:ke};return A(nm,sn({ref:M},pe,{modelValue:_.value,"onUpdate:modelValue":[xe=>_.value=xe,N],id:de.value,"aria-describedby":Ce.value,type:"checkbox","aria-checked":p.value?"mixed":void 0,disabled:ye.value,readonly:Me.value,onFocus:T,onBlur:k},_e),{...h,default:xe=>{let{backgroundColorClasses:Fe,backgroundColorStyles:We}=xe;return A("div",{class:["v-switch__track",D?void 0:Fe.value],style:We.value,onClick:q},[h["track-true"]&&A("div",{key:"prepend",class:"v-switch__track-true"},[h["track-true"](Ee)]),h["track-false"]&&A("div",{key:"append",class:"v-switch__track-false"},[h["track-false"](Ee)])])},input:xe=>{let{inputNode:Fe,icon:We,backgroundColorClasses:ht,backgroundColorStyles:Ne}=xe;return A(cn,null,[Fe,A("div",{class:["v-switch__thumb",{"v-switch__thumb--filled":We||e.loading},e.inset||D?void 0:ht.value],style:e.inset?void 0:Ne.value},[h.thumb?A(Bi,{defaults:{VIcon:{icon:We,size:"x-small"}}},{default:()=>[h.thumb({...Ee,icon:We})]}):A(JI,null,{default:()=>[e.loading?A(nv,{name:"v-switch",active:!0,color:ke.value===!1?void 0:O.value},{default:tt=>h.loader?h.loader(tt):A(dC,{active:tt.isActive,color:tt.color,indeterminate:!0,size:"16",width:"2"},null)}):We&&A(li,{key:String(We),icon:We,size:"x-small"},null)]})])])}})}})}),{}}}),Mz=Un({__name:"SetupRaceDialog",props:{track:{},open:{type:Boolean}},emits:["goBack"],setup(e,{emit:i}){var O,z,F;const l=e,h=i,p=vi(),_=Ye(l.open),m=ue(()=>p.baseData.data.laps.filter(N=>{var q;return N.value===-1?p.baseData.data.auth.startElimination:!((q=l.track.Metadata)!=null&&q.raceType&&(l.track.Metadata.raceType==="sprint"&&N.value>0||l.track.Metadata.raceType==="circuit_only"&&N.value===0))})),T=(((O=l.track.Metadata)==null?void 0:O.raceType)==="circuit_only"||((z=l.track.Metadata)==null?void 0:z.raceType)==="sprint")&&((F=l.track.Metadata)==null?void 0:F.raceType)==="circuit_only"?p.baseData.data.laps[2].value:p.baseData.data.laps[1].value,k=Ye({laps:T,buyIn:p.baseData.data.buyIns[0].value,ghosting:p.baseData.data.ghostingTimes[0].value,maxClass:p.baseData.data.classes[0].value,ranked:!1,reversed:!1,firstPerson:!1,participationMoney:0,participationCurrency:p.baseData.data.participationCurrencyOptions[0].value,silent:!1}),M=()=>{_.value=!1,h("goBack")},D=async()=>{k.value.participationMoney<0&&(k.value.participationMoney=0),k.value.laps===-1&&(k.value.ranked=!1);let N={track:l.track.RaceId,laps:k.value.laps,buyIn:k.value.buyIn,maxClass:k.value.maxClass,ghostingOn:k.value.ghosting!==-1,ghostingTime:k.value.ghosting,ranked:k.value.ranked,participationMoney:k.value.participationMoney,participationCurrency:k.value.participationCurrency,reversed:k.value.reversed,firstPerson:k.value.firstPerson,silent:k.value.silent};(await hn.post("UiSetupRace",JSON.stringify(N))).data&&(_.value=!1,Fa(),h("goBack"))};return(N,q)=>($e(),gt(_a,{modelValue:_.value,"onUpdate:modelValue":q[12]||(q[12]=oe=>_.value=oe),persistent:"",width:"1024",contained:""},{default:Q(()=>[A(zC,null,{default:Q(()=>[A($n,null,{default:Q(()=>[A(Hn,{class:"title-holder"},{default:Q(()=>[je(ee(H(re)("selected_track"))+" "+ee(N.track.RaceName),1)]),_:1}),A(ti,null,{default:Q(()=>[A(rv,null,{default:Q(()=>[A(Go,null,{default:Q(()=>[A(Dr,{cols:"12",sm:"6"},{default:Q(()=>[A(xs,{color:"primary",density:"compact",items:m.value,"item-value":"value","item-title":"text",label:H(re)("laps"),hideDetails:"",modelValue:k.value.laps,"onUpdate:modelValue":q[0]||(q[0]=oe=>k.value.laps=oe)},null,8,["items","label","modelValue"])]),_:1}),A(Dr,{cols:"12",sm:"6"},{default:Q(()=>[A(xs,{color:"primary",density:"compact",items:H(p).baseData.data.buyIns,"item-value":"value","item-title":"text",label:H(re)("buy_in"),hideDetails:"",modelValue:k.value.buyIn,"onUpdate:modelValue":q[1]||(q[1]=oe=>k.value.buyIn=oe)},null,8,["items","label","modelValue"])]),_:1})]),_:1}),A(Go,null,{default:Q(()=>[A(Dr,{cols:"12",sm:"6"},{default:Q(()=>[H(p).baseData.data.ghostingEnabled?($e(),gt(xs,{key:0,color:"primary",density:"compact",items:H(p).baseData.data.ghostingTimes,"item-value":"value","item-title":"text",label:H(re)("ghosting"),hideDetails:"",modelValue:k.value.ghosting,"onUpdate:modelValue":q[2]||(q[2]=oe=>k.value.ghosting=oe)},null,8,["items","label","modelValue"])):Ft("",!0)]),_:1}),A(Dr,{cols:"12",sm:"6"},{default:Q(()=>[A(xs,{color:"primary",density:"compact",items:H(p).baseData.data.classes,"item-value":"value","item-title":"text",label:H(re)("max_class"),hideDetails:"",modelValue:k.value.maxClass,"onUpdate:modelValue":q[3]||(q[3]=oe=>k.value.maxClass=oe)},null,8,["items","label","modelValue"])]),_:1})]),_:1}),A(Go,{justify:"center"},{default:Q(()=>[A(Dr,{cols:"12",sm:"4"},{default:Q(()=>[A(Ra,{color:"primary",class:"reverse-switch",label:H(re)("host_silent"),modelValue:k.value.silent,"onUpdate:modelValue":q[4]||(q[4]=oe=>k.value.silent=oe),density:"compact","hide-details":""},null,8,["label","modelValue"])]),_:1}),A(Dr,{cols:"12",sm:"4"},{default:Q(()=>[H(p).baseData.data.auth.startReversed?($e(),gt(Ra,{key:0,color:"primary",class:"reverse-switch",label:H(re)("reversed"),modelValue:k.value.reversed,"onUpdate:modelValue":q[5]||(q[5]=oe=>k.value.reversed=oe),density:"compact","hide-details":""},null,8,["label","modelValue"])):Ft("",!0)]),_:1}),A(Dr,{cols:"12",sm:"4"},{default:Q(()=>[A(Ra,{color:"primary",class:"reverse-switch",label:H(re)("first_person"),modelValue:k.value.firstPerson,"onUpdate:modelValue":q[6]||(q[6]=oe=>k.value.firstPerson=oe),density:"compact","hide-details":""},null,8,["label","modelValue"])]),_:1})]),_:1}),A(Go,null,{default:Q(()=>{var oe,_e,Se,pe,be,de,Ce,ye,Me,ke,Ee,xe;return[(pe=(Se=(_e=(oe=H(p))==null?void 0:oe.baseData)==null?void 0:_e.data)==null?void 0:Se.auth)!=null&&pe.setupParticipation?($e(),gt(Dr,{key:0,cols:"12",sm:"6"},{default:Q(()=>[A(hr,{color:"primary",class:"text-field",hideDetails:"",label:H(re)("participation_amount"),density:"compact",type:"number",modelValue:k.value.participationMoney,"onUpdate:modelValue":q[7]||(q[7]=Fe=>k.value.participationMoney=Fe)},{prepend:Q(()=>[A(tm,{location:"bottom"},{activator:Q(({props:Fe})=>[A(li,sn(Fe,{icon:"mdi-help-circle-outline"}),null,16)]),default:Q(()=>[je(" "+ee(H(re)("participation_info")),1)]),_:1})]),_:1},8,["label","modelValue"])]),_:1})):Ft("",!0),(ye=(Ce=(de=(be=H(p))==null?void 0:be.baseData)==null?void 0:de.data)==null?void 0:Ce.auth)!=null&&ye.setupParticipation?($e(),gt(Dr,{key:1,cols:"12",sm:"6"},{default:Q(()=>[A(xs,{label:H(re)("currency"),density:"compact",items:H(p).baseData.data.participationCurrencyOptions,modelValue:k.value.participationCurrency,"onUpdate:modelValue":q[8]||(q[8]=Fe=>k.value.participationCurrency=Fe),"item-title":"title","item-value":"value"},null,8,["label","items","modelValue"])]),_:1})):Ft("",!0),(xe=(Ee=(ke=(Me=H(p))==null?void 0:Me.baseData)==null?void 0:ke.data)==null?void 0:Ee.auth)!=null&&xe.startRanked?($e(),gt(Dr,{key:2,cols:"12",sm:"6"},{default:Q(()=>[A(Ra,{color:"primary",label:H(re)("ranked"),modelValue:k.value.ranked,"onUpdate:modelValue":q[9]||(q[9]=Fe=>k.value.ranked=Fe),density:"compact","hide-details":"",disabled:k.value.laps===-1},null,8,["label","modelValue","disabled"])]),_:1})):Ft("",!0)]}),_:1})]),_:1})]),_:1}),A(Yn,null,{default:Q(()=>[A(ar),A(Gt,{rounded:"xl",variant:"text",onClick:q[10]||(q[10]=oe=>M())},{default:Q(()=>[je(ee(H(re)("close")),1)]),_:1}),A(Gt,{rounded:"xl",color:"success",variant:"flat",onClick:q[11]||(q[11]=oe=>D())},{default:Q(()=>[je(ee(H(re)("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}});const UC=Mi(Mz,[["__scopeId","data-v-a9abb82f"]]),Ez={class:"infotext"},Az={key:0},Rz=Un({__name:"InfoText",props:{title:{},text:{}},setup(e){const i=e;return(l,h)=>($e(),Vt("div",Ez,[Ke("h3",null,ee(i.title),1),i.text?($e(),Vt("h4",Az,ee(i.text),1)):Ft("",!0)]))}});const Cr=Mi(Rz,[["__scopeId","data-v-a911d7f3"]]),to=e=>{const i=e,l=Math.floor(i/1e3),h=Math.floor(l/60),p=l%60,_=i%1e3,m=String(h).padStart(2,"0"),o=String(p).padStart(2,"0"),T=String(_).padStart(3,"0");return`${m}:${o}.${T}`};const Dz=Ct({fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,...xn(),...Ca(),...Ti(),...Di()},"VTable"),Nd=qt()({name:"VTable",props:Dz(),setup(e,i){let{slots:l,emit:h}=i;const{themeClasses:p}=Hi(e),{densityClasses:_}=Na(e);return dn(()=>A(e.tag,{class:["v-table",{"v-table--fixed-height":!!e.height,"v-table--fixed-header":e.fixedHeader,"v-table--fixed-footer":e.fixedFooter,"v-table--has-top":!!l.top,"v-table--has-bottom":!!l.bottom,"v-table--hover":e.hover},p.value,_.value,e.class],style:e.style},{default:()=>{var m,o,T;return[(m=l.top)==null?void 0:m.call(l),l.default?A("div",{class:"v-table__wrapper",style:{height:mn(e.height)}},[A("table",null,[l.default()])]):(o=l.wrapper)==null?void 0:o.call(l),(T=l.bottom)==null?void 0:T.call(l)]}})),{}}}),zz={class:"d-flex ga-1"},Lz={class:"text-left"},Bz={class:"text-left"},Fz=Un({__name:"BountyItem",props:{bounty:{}},setup(e){const i=e,l=Ye(!1),h=Ye(!1),p=vi(),_=ue(()=>{const k=i.bounty.claimed;return Object.values(k).sort((D,O)=>D.time<O.time?-1:1)}),m=ue(()=>_.value.filter(k=>k.racerName===p.baseData.data.currentRacerName).length>0),o=ue(()=>i.bounty.rankRequired<=p.baseData.data.currentRanking),T=async()=>{l.value=!0,(await hn.post("UiQuickSetupBounty",JSON.stringify(i.bounty))).data&&(l.value=!1)};return(k,M)=>($e(),Vt(cn,null,[A($n,{rounded:"xl",border:""},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(k.bounty.trackName)+" ",1),A(ln,{variant:"outlined",color:m.value?"green":"primary"},{default:Q(()=>[je(ee(H(to)(k.bounty.timeToBeat)),1)]),_:1},8,["color"])]),_:1}),A(ti,{class:"text"},{default:Q(()=>[A(ln,{color:"green"},{default:Q(()=>[je(ee(H(re)("price"))+": "+ee(H(re)("currency_text"))+ee(k.bounty.price),1)]),_:1}),A(ln,{color:"primary"},{default:Q(()=>[je(ee(H(re)("class"))+": "+ee(k.bounty.maxClass),1)]),_:1}),A(ln,{color:o.value?"green":"error"},{default:Q(()=>[je(ee(H(re)("required_rank"))+": "+ee(k.bounty.rankRequired),1)]),_:1},8,["color"]),k.bounty.reversed?($e(),gt(ln,{key:0,color:"primary"},{default:Q(()=>[je(ee(H(re)("reversed")),1)]),_:1})):Ft("",!0),k.bounty.sprint?($e(),gt(ln,{key:1,color:"primary"},{default:Q(()=>[je(ee(H(re)("sprint")),1)]),_:1})):($e(),gt(ln,{key:2,color:"primary"},{default:Q(()=>[je(ee(H(re)("circuit")),1)]),_:1}))]),_:1}),A(Yn,null,{default:Q(()=>[A(ar),A(Gt,{rounded:"xl",onClick:M[0]||(M[0]=D=>h.value=!0)},{default:Q(()=>[je(ee(H(re)("records")),1)]),_:1}),A(Gt,{variant:"flat",color:"primary",disabled:!o.value||l.value,rounded:"xl",onClick:T},{default:Q(()=>[je(ee(H(re)("quick_host")),1)]),_:1},8,["disabled"])]),_:1})]),_:1}),A(_a,{attach:".app-container",contained:"",modelValue:h.value,"onUpdate:modelValue":M[2]||(M[2]=D=>h.value=D),width:"auto"},{default:Q(()=>[A($n,{rounded:"xl"},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(k.bounty.trackName),1)]),_:1}),A(ti,null,{default:Q(()=>[Ke("div",zz,[A(ln,{color:"primary"},{default:Q(()=>[je(ee(H(re)("class"))+": "+ee(k.bounty.maxClass),1)]),_:1}),k.bounty.reversed?($e(),gt(ln,{key:0,color:"primary"},{default:Q(()=>[je(ee(H(re)("reversed")),1)]),_:1})):Ft("",!0),k.bounty.sprint?($e(),gt(ln,{key:1,color:"primary"},{default:Q(()=>[je(ee(H(re)("sprint")),1)]),_:1})):($e(),gt(ln,{key:2,color:"primary"},{default:Q(()=>[je(ee(H(re)("circuit")),1)]),_:1})),A(ln,{color:o.value?"green":"error"},{default:Q(()=>[je(ee(H(re)("required_rank"))+": "+ee(k.bounty.rankRequired),1)]),_:1},8,["color"])]),_.value&&_.value.length>0?($e(),gt(Nd,{key:0},{default:Q(()=>[Ke("thead",null,[Ke("tr",null,[M[3]||(M[3]=Ke("th",{class:"text-left"},null,-1)),Ke("th",Lz,ee(H(re)("time")),1),Ke("th",Bz,ee(H(re)("vehicle")),1)])]),Ke("tbody",null,[($e(!0),Vt(cn,null,sa(_.value,(D,O)=>($e(),Vt("tr",{key:O},[Ke("td",null,ee(O+1)+". "+ee(D.racerName),1),Ke("td",null,ee(H(to)(D.time)),1),Ke("td",null,ee(D.vehicleModel),1)]))),128))])]),_:1})):($e(),gt(Cr,{key:1,title:H(re)("no_data")},null,8,["title"]))]),_:1}),A(Yn,null,{default:Q(()=>[A(ar),A(Gt,{rounded:"xl",onClick:M[1]||(M[1]=D=>h.value=!1)},{default:Q(()=>[je(ee(H(re)("close")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}});const Oz=Mi(Fz,[["__scopeId","data-v-a6d551be"]]),Vz={class:"results-container"},Nz={key:0,class:"bounty-list"},$z={key:1},jz=Un({__name:"BountiesTab",setup(e){const i=vi(),l=async()=>{const p=await hn.post("UiGetBounties");p.data&&(i.bounties=p.data)},h=()=>{hn.post("UIRerollBounties")};return yi(()=>{l()}),(p,_)=>($e(),Vt("div",Vz,[A($n,{class:"mb-3"},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(H(re)("bounties")),1)]),_:1}),A(ti,{class:"text"},{default:Q(()=>[Ke("p",null,ee(H(re)("bounties_desc")),1),Ke("p",null,ee(H(re)("bounties_desc_2")),1)]),_:1}),H(i).baseData.data.auth.handleBounties?($e(),gt(Yn,{key:0},{default:Q(()=>[A(ar),A(Gt,{onClick:h,variant:"flat",color:"primary"},{default:Q(()=>[je(ee(H(re)("reroll_bounties")),1)]),_:1})]),_:1})):Ft("",!0)]),_:1}),H(i).bounties.length>0?($e(),Vt("div",Nz,[($e(!0),Vt(cn,null,sa(H(i).bounties,m=>($e(),gt(Oz,{key:m.id,bounty:m},null,8,["bounty"]))),128))])):($e(),Vt("div",$z,[A(Cr,{title:H(re)("no_bounties")},null,8,["title"])]))]))}});const Uz=Mi(jz,[["__scopeId","data-v-3eeb7c2a"]]);const Ui=[{game:{x:0,y:0},map:{lng:-97.383049,lat:11.992}},{game:{x:-52.34,y:-254.46},map:{lng:-98.2266,lat:6.9408}},{game:{x:-510.44,y:-371.56},map:{lng:-107.4021,lat:4.7763}},{game:{x:192.18,y:-3009.55},map:{lng:-93.3233,lat:-43.323}},{game:{x:-966.44,y:-3162.13},map:{lng:-116.49922,lat:-45.5551}},{game:{x:222.51715087890625,y:-3328.126220703125},map:{lng:-92.79132004220685,lat:-47.80717334396935}},{game:{x:1916.57,y:-959.06},map:{lng:-59.047,lat:-7.2755}},{game:{x:-2582.43,y:2286.39},map:{lng:-148.6607,lat:49.9221}},{game:{x:-2256.86,y:4326.72},map:{lng:-142.3285,lat:69.7424}},{game:{x:91.8,y:7028.52},map:{lng:-95.3158,lat:82.0328}}],Gz=()=>{const e=Ui.reduce((z,F)=>z+F.game.x,0),i=Ui.reduce((z,F)=>z+F.game.x**2,0),l=Ui.reduce((z,F)=>z+F.game.x**3,0),h=Ui.reduce((z,F)=>z+F.game.x**4,0),p=Ui.reduce((z,F)=>z+F.map.lng,0),_=Ui.reduce((z,F)=>z+F.game.x*F.map.lng,0),m=Ui.reduce((z,F)=>z+F.game.x**2*F.map.lng,0),T=[[Ui.length,e,i],[e,i,l],[i,l,h]],k=[p,_,m],[M,D,O]=GC(T,k);return{a:O,b:D,c:M}},Hz=()=>{const e=Ui.reduce((be,de)=>be+de.game.y,0),i=Ui.reduce((be,de)=>be+de.game.y**2,0),l=Ui.reduce((be,de)=>be+de.game.y**3,0),h=Ui.reduce((be,de)=>be+de.game.y**4,0),p=Ui.reduce((be,de)=>be+de.game.y**5,0),_=Ui.reduce((be,de)=>be+de.game.y**6,0),m=Ui.reduce((be,de)=>be+de.game.y**7,0),o=Ui.reduce((be,de)=>be+de.game.y**8,0),T=Ui.reduce((be,de)=>be+de.map.lat,0),k=Ui.reduce((be,de)=>be+de.game.y*de.map.lat,0),M=Ui.reduce((be,de)=>be+de.game.y**2*de.map.lat,0),D=Ui.reduce((be,de)=>be+de.game.y**3*de.map.lat,0),O=Ui.reduce((be,de)=>be+de.game.y**4*de.map.lat,0),F=[[Ui.length,e,i,l,h],[e,i,l,h,p],[i,l,h,p,_],[l,h,p,_,m],[h,p,_,m,o]],N=[T,k,M,D,O],[q,oe,_e,Se,pe]=GC(F,N);return{a:pe,b:Se,c:_e,d:oe,e:q}},GC=(e,i)=>{const l=i.length,h=e.map((_,m)=>[..._,i[m]]);for(let _=0;_<l;_++){let m=_;for(let o=_+1;o<l;o++)Math.abs(h[o][_])>Math.abs(h[m][_])&&(m=o);[h[_],h[m]]=[h[m],h[_]];for(let o=_+1;o<l;o++){const T=h[o][_]/h[_][_];for(let k=_;k<=l;k++)h[o][k]-=T*h[_][k]}}const p=new Array(l);for(let _=l-1;_>=0;_--){p[_]=h[_][l];for(let m=_+1;m<l;m++)p[_]-=h[_][m]*p[m];p[_]/=h[_][_]}return p},x_=Gz(),Xh=Hz(),_p=(e,i)=>{const l=x_.a*e**2+x_.b*e+x_.c,h=Xh.a*i**4+Xh.b*i**3+Xh.c*i**2+Xh.d*i+Xh.e;return[l,h]};function HC(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{blueprint:i,...l}=e,h=Fr(i,l),{aliases:p={},components:_={},directives:m={}}=h,o=UI(h.defaults),T=yM(h.display,h.ssr),k=lM(h.theme),M=rM(h.icons),D=wM(h.locale),O=fA(h.date,D),z=PM(h.goTo,D);return{install:N=>{for(const q in m)N.directive(q,m[q]);for(const q in _)N.component(q,_[q]);for(const q in p)N.component(q,yu({...p[q],name:q,aliasName:p[q].name}));if(k.install(N),N.provide(pu,o),N.provide(G_,T),N.provide(gd,k),N.provide(U_,M),N.provide(qp,D),N.provide(dA,O.options),N.provide(Cx,O.instance),N.provide(rS,z),Zn&&h.ssr)if(N.$nuxt)N.$nuxt.hook("app:suspense:resolve",()=>{T.update()});else{const{mount:q}=N;N.mount=function(){const oe=q(...arguments);return Fi(()=>T.update()),N.mount=q,oe}}wa.reset(),N.mixin({computed:{$vuetify(){return yr({defaults:au.call(this,pu),display:au.call(this,G_),theme:au.call(this,gd),icons:au.call(this,U_),locale:au.call(this,qp),date:au.call(this,Cx)})}}})},defaults:o,display:T,theme:k,icons:M,locale:D,date:O,goTo:z}}const Zz="3.7.6";HC.version=Zz;function au(e){var h,p;const i=this.$,l=((h=i.parent)==null?void 0:h.provides)??((p=i.vnode.appContext)==null?void 0:p.provides);if(l&&e in l)return l[e]}var qz=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Wz(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ZC={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.1.0/LICENSE.txt
 */(function(e,i){(function(l,h){e.exports=h()})(qz,function(){var l={},h={};function p(m,o,T){if(h[m]=T,m==="index"){var k="var sharedModule = {}; ("+h.shared+")(sharedModule); ("+h.worker+")(sharedModule);",M={};return h.shared(M),h.index(l,M),typeof window<"u"&&l.setWorkerUrl(window.URL.createObjectURL(new Blob([k],{type:"text/javascript"}))),l}}p("shared",["exports"],function(m){function o(s,n,a,c){return new(a||(a=Promise))(function(f,v){function b(I){try{C(c.next(I))}catch(R){v(R)}}function w(I){try{C(c.throw(I))}catch(R){v(R)}}function C(I){var R;I.done?f(I.value):(R=I.value,R instanceof a?R:new a(function(L){L(R)})).then(b,w)}C((c=c.apply(s,n||[])).next())})}function T(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var k,M;function D(){if(M)return k;function s(n,a){this.x=n,this.y=a}return M=1,k=s,s.prototype={clone:function(){return new s(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,a){return this.clone()._rotateAround(n,a)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var a=n.x-this.x,c=n.y-this.y;return a*a+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,a){return Math.atan2(this.x*a-this.y*n,this.x*n+this.y*a)},_matMult:function(n){var a=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=a,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var a=Math.cos(n),c=Math.sin(n),f=c*this.x+a*this.y;return this.x=a*this.x-c*this.y,this.y=f,this},_rotateAround:function(n,a){var c=Math.cos(n),f=Math.sin(n),v=a.y+f*(this.x-a.x)+c*(this.y-a.y);return this.x=a.x+c*(this.x-a.x)-f*(this.y-a.y),this.y=v,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},s.convert=function(n){return n instanceof s?n:Array.isArray(n)?new s(n[0],n[1]):n},k}typeof SuppressedError=="function"&&SuppressedError;var O,z,F=T(D()),N=function(){if(z)return O;function s(n,a,c,f){this.cx=3*n,this.bx=3*(c-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(f-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=a,this.p2x=c,this.p2y=f}return z=1,O=s,s.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,a){if(a===void 0&&(a=1e-6),n<0)return 0;if(n>1)return 1;for(var c=n,f=0;f<8;f++){var v=this.sampleCurveX(c)-n;if(Math.abs(v)<a)return c;var b=this.sampleCurveDerivativeX(c);if(Math.abs(b)<1e-6)break;c-=v/b}var w=0,C=1;for(c=n,f=0;f<20&&(v=this.sampleCurveX(c),!(Math.abs(v-n)<a));f++)n>v?w=c:C=c,c=.5*(C-w)+w;return c},solve:function(n,a){return this.sampleCurveY(this.solveCurveX(n,a))}},O}(),q=T(N);let oe,_e;function Se(){return oe==null&&(oe=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),oe}function pe(){if(_e==null&&(_e=!1,Se())){const n=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(n){for(let c=0;c<5*5;c++){const f=4*c;n.fillStyle=`rgb(${f},${f+1},${f+2})`,n.fillRect(c%5,Math.floor(c/5),1,1)}const a=n.getImageData(0,0,5,5).data;for(let c=0;c<5*5*4;c++)if(c%4!=3&&a[c]!==c){_e=!0;break}}}return _e||!1}var be,de=1e-6,Ce=typeof Float32Array<"u"?Float32Array:Array;function ye(){var s=new Ce(9);return Ce!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s}function Me(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function ke(){var s=new Ce(3);return Ce!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function Ee(s,n,a){var c=new Ce(3);return c[0]=s,c[1]=n,c[2]=a,c}function xe(s,n,a){var c=n[0],f=n[1],v=n[2],b=n[3];return s[0]=a[0]*c+a[4]*f+a[8]*v+a[12]*b,s[1]=a[1]*c+a[5]*f+a[9]*v+a[13]*b,s[2]=a[2]*c+a[6]*f+a[10]*v+a[14]*b,s[3]=a[3]*c+a[7]*f+a[11]*v+a[15]*b,s}function Fe(){var s=new Ce(4);return Ce!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s[3]=1,s}function We(){var s=new Ce(2);return Ce!=Float32Array&&(s[0]=0,s[1]=0),s}function ht(s,n){var a=new Ce(2);return a[0]=s,a[1]=n,a}Math.hypot||(Math.hypot=function(){for(var s=0,n=arguments.length;n--;)s+=arguments[n]*arguments[n];return Math.sqrt(s)}),ke(),be=new Ce(4),Ce!=Float32Array&&(be[0]=0,be[1]=0,be[2]=0,be[3]=0),ke(),Ee(1,0,0),Ee(0,1,0),Fe(),Fe(),ye(),We();const Ne=8192;function tt(s,n,a){return n*(Ne/(s.tileSize*Math.pow(2,a-s.tileID.overscaledZ)))}function Mt(s,n){return(s%n+n)%n}function _t(s,n,a){return s*(1-a)+n*a}function Qe(s){if(s<=0)return 0;if(s>=1)return 1;const n=s*s,a=n*s;return 4*(s<.5?a:3*(s-n)+a-.75)}function ct(s,n,a,c){const f=new q(s,n,a,c);return v=>f.solve(v)}const Dt=ct(.25,.1,.25,1);function Yt(s,n,a){return Math.min(a,Math.max(n,s))}function zt(s,n,a){const c=a-n,f=((s-n)%c+c)%c+n;return f===n?a:f}function Kt(s,...n){for(const a of n)for(const c in a)s[c]=a[c];return s}let Zt=1;function _n(s,n,a){const c={};for(const f in s)c[f]=n.call(this,s[f],f,s);return c}function bn(s,n,a){const c={};for(const f in s)n.call(this,s[f],f,s)&&(c[f]=s[f]);return c}function Vn(s){return Array.isArray(s)?s.map(Vn):typeof s=="object"&&s?_n(s,Vn):s}const On={};function ri(s){On[s]||(typeof console<"u"&&console.warn(s),On[s]=!0)}function En(s,n,a){return(a.y-s.y)*(n.x-s.x)>(n.y-s.y)*(a.x-s.x)}function Pe(s){return typeof WorkerGlobalScope<"u"&&s!==void 0&&s instanceof WorkerGlobalScope}let Le=null;function ot(s){return typeof ImageBitmap<"u"&&s instanceof ImageBitmap}const xt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function mt(s,n,a,c,f){return o(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const v=new VideoFrame(s,{timestamp:0});try{const b=v==null?void 0:v.format;if(!b||!b.startsWith("BGR")&&!b.startsWith("RGB"))throw new Error(`Unrecognized format ${b}`);const w=b.startsWith("BGR"),C=new Uint8ClampedArray(c*f*4);if(yield v.copyTo(C,function(I,R,L,$,G){const Z=4*Math.max(1,0),K=(Math.max(0,L)-L)*$*4+Z,ie=4*$,he=Math.max(0,R),ze=Math.max(0,L);return{rect:{x:he,y:ze,width:Math.min(I.width,R+$)-he,height:Math.min(I.height,L+G)-ze},layout:[{offset:K,stride:ie}]}}(s,n,a,c,f)),w)for(let I=0;I<C.length;I+=4){const R=C[I];C[I]=C[I+2],C[I+2]=R}return C}finally{v.close()}})}let vt,Lt;function It(s){return s/Math.PI*180}const At="AbortError";function wt(){return new Error(At)}const en={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Nt(s){return en.REGISTERED_PROTOCOLS[s.substring(0,s.indexOf("://"))]}const Wt="global-dispatcher";class un extends Error{constructor(n,a,c,f){super(`AJAXError: ${a} (${n}): ${c}`),this.status=n,this.statusText=a,this.url=c,this.body=f}}const Sn=()=>Pe(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Dn=function(s,n){if(/:\/\//.test(s.url)&&!/^https?:|^file:/.test(s.url)){const c=Nt(s.url);if(c)return c(s,n);if(Pe(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,targetMapId:Wt},n)}if(!(/^file:/.test(a=s.url)||/^file:/.test(Sn())&&!/^\w+:/.test(a))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(c,f){return o(this,void 0,void 0,function*(){const v=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,cache:c.cache,referrer:Sn(),signal:f.signal});let b,w;c.type!=="json"||v.headers.has("Accept")||v.headers.set("Accept","application/json");try{b=yield fetch(v)}catch(I){throw new un(0,I.message,c.url,new Blob)}if(!b.ok){const I=yield b.blob();throw new un(b.status,b.statusText,c.url,I)}w=c.type==="arrayBuffer"||c.type==="image"?b.arrayBuffer():c.type==="json"?b.json():b.text();const C=yield w;if(f.signal.aborted)throw wt();return{data:C,cacheControl:b.headers.get("Cache-Control"),expires:b.headers.get("Expires")}})}(s,n);if(Pe(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,mustQueue:!0,targetMapId:Wt},n)}var a;return function(c,f){return new Promise((v,b)=>{var w;const C=new XMLHttpRequest;C.open(c.method||"GET",c.url,!0),c.type!=="arrayBuffer"&&c.type!=="image"||(C.responseType="arraybuffer");for(const I in c.headers)C.setRequestHeader(I,c.headers[I]);c.type==="json"&&(C.responseType="text",!((w=c.headers)===null||w===void 0)&&w.Accept||C.setRequestHeader("Accept","application/json")),C.withCredentials=c.credentials==="include",C.onerror=()=>{b(new Error(C.statusText))},C.onload=()=>{if(!f.signal.aborted)if((C.status>=200&&C.status<300||C.status===0)&&C.response!==null){let I=C.response;if(c.type==="json")try{I=JSON.parse(C.response)}catch(R){return void b(R)}v({data:I,cacheControl:C.getResponseHeader("Cache-Control"),expires:C.getResponseHeader("Expires")})}else{const I=new Blob([C.response],{type:C.getResponseHeader("Content-Type")});b(new un(C.status,C.statusText,c.url,I))}},f.signal.addEventListener("abort",()=>{C.abort(),b(wt())}),C.send(c.body)})}(s,n)};function An(s){if(!s||s.indexOf("://")<=0||s.indexOf("data:image/")===0||s.indexOf("blob:")===0)return!0;const n=new URL(s),a=window.location;return n.protocol===a.protocol&&n.host===a.host}function Ei(s,n,a){a[s]&&a[s].indexOf(n)!==-1||(a[s]=a[s]||[],a[s].push(n))}function Pi(s,n,a){if(a&&a[s]){const c=a[s].indexOf(n);c!==-1&&a[s].splice(c,1)}}class er{constructor(n,a={}){Kt(this,a),this.type=n}}class Zi extends er{constructor(n,a={}){super("error",Kt({error:n},a))}}class Mr{on(n,a){return this._listeners=this._listeners||{},Ei(n,a,this._listeners),{unsubscribe:()=>{this.off(n,a)}}}off(n,a){return Pi(n,a,this._listeners),Pi(n,a,this._oneTimeListeners),this}once(n,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},Ei(n,a,this._oneTimeListeners),this):new Promise(c=>this.once(n,c))}fire(n,a){typeof n=="string"&&(n=new er(n,a||{}));const c=n.type;if(this.listens(c)){n.target=this;const f=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const w of f)w.call(this,n);const v=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const w of v)Pi(c,w,this._oneTimeListeners),w.call(this,n);const b=this._eventedParent;b&&(Kt(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),b.fire(n))}else n instanceof Zi&&console.error(n.error);return this}listens(n){return this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n)}setEventedParent(n,a){return this._eventedParent=n,this._eventedParentData=a,this}}var ae={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const W=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function J(s,n){const a={};for(const c in s)c!=="ref"&&(a[c]=s[c]);return W.forEach(c=>{c in n&&(a[c]=n[c])}),a}function te(s,n){if(Array.isArray(s)){if(!Array.isArray(n)||s.length!==n.length)return!1;for(let a=0;a<s.length;a++)if(!te(s[a],n[a]))return!1;return!0}if(typeof s=="object"&&s!==null&&n!==null){if(typeof n!="object"||Object.keys(s).length!==Object.keys(n).length)return!1;for(const a in s)if(!te(s[a],n[a]))return!1;return!0}return s===n}function me(s,n){s.push(n)}function Ae(s,n,a){me(a,{command:"addSource",args:[s,n[s]]})}function Ve(s,n,a){me(n,{command:"removeSource",args:[s]}),a[s]=!0}function qe(s,n,a,c){Ve(s,a,c),Ae(s,n,a)}function Oe(s,n,a){let c;for(c in s[a])if(Object.prototype.hasOwnProperty.call(s[a],c)&&c!=="data"&&!te(s[a][c],n[a][c]))return!1;for(c in n[a])if(Object.prototype.hasOwnProperty.call(n[a],c)&&c!=="data"&&!te(s[a][c],n[a][c]))return!1;return!0}function it(s,n,a,c,f,v){s=s||{},n=n||{};for(const b in s)Object.prototype.hasOwnProperty.call(s,b)&&(te(s[b],n[b])||a.push({command:v,args:[c,b,n[b],f]}));for(const b in n)Object.prototype.hasOwnProperty.call(n,b)&&!Object.prototype.hasOwnProperty.call(s,b)&&(te(s[b],n[b])||a.push({command:v,args:[c,b,n[b],f]}))}function Je(s){return s.id}function Ue(s,n){return s[n.id]=n,s}class Be{constructor(n,a,c,f){this.message=(n?`${n}: `:"")+c,f&&(this.identifier=f),a!=null&&a.__line__&&(this.line=a.__line__)}}function kt(s,...n){for(const a of n)for(const c in a)s[c]=a[c];return s}class Tt extends Error{constructor(n,a){super(a),this.message=a,this.key=n}}class tn{constructor(n,a=[]){this.parent=n,this.bindings={};for(const[c,f]of a)this.bindings[c]=f}concat(n){return new tn(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const pn={kind:"null"},st={kind:"number"},Et={kind:"string"},jt={kind:"boolean"},Cn={kind:"color"},zn={kind:"projectionDefinition"},on={kind:"object"},Ot={kind:"value"},ki={kind:"collator"},os={kind:"formatted"},qi={kind:"padding"},Vi={kind:"resolvedImage"},ui={kind:"variableAnchorOffsetCollection"};function Or(s,n){return{kind:"array",itemType:s,N:n}}function hi(s){if(s.kind==="array"){const n=hi(s.itemType);return typeof s.N=="number"?`array<${n}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${n}>`}return s.kind}const el=[pn,st,Et,jt,Cn,zn,os,on,Or(Ot),qi,Vi,ui];function ho(s,n){if(n.kind==="error")return null;if(s.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!ho(s.itemType,n.itemType))&&(typeof s.N!="number"||s.N===n.N))return null}else{if(s.kind===n.kind)return null;if(s.kind==="value"){for(const a of el)if(!ho(a,n))return null}}return`Expected ${hi(s)} but found ${hi(n)} instead.`}function Su(s,n){return n.some(a=>a.kind===s.kind)}function Is(s,n){return n.some(a=>a==="null"?s===null:a==="array"?Array.isArray(s):a==="object"?s&&!Array.isArray(s)&&typeof s=="object":a===typeof s)}function Ms(s,n){return s.kind==="array"&&n.kind==="array"?s.itemType.kind===n.itemType.kind&&typeof s.N=="number":s.kind===n.kind}const $d=.96422,Cu=.82521,jd=4/29,fo=6/29,Ud=3*fo*fo,Fm=fo*fo*fo,Om=Math.PI/180,Vm=180/Math.PI;function Gd(s){return(s%=360)<0&&(s+=360),s}function Tu([s,n,a,c]){let f,v;const b=Pu((.2225045*(s=Es(s))+.7168786*(n=Es(n))+.0606169*(a=Es(a)))/1);s===n&&n===a?f=v=b:(f=Pu((.4360747*s+.3850649*n+.1430804*a)/$d),v=Pu((.0139322*s+.0971045*n+.7141733*a)/Cu));const w=116*b-16;return[w<0?0:w,500*(f-b),200*(b-v),c]}function Es(s){return s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function Pu(s){return s>Fm?Math.pow(s,1/3):s/Ud+jd}function Hd([s,n,a,c]){let f=(s+16)/116,v=isNaN(n)?f:f+n/500,b=isNaN(a)?f:f-a/200;return f=1*ku(f),v=$d*ku(v),b=Cu*ku(b),[As(3.1338561*v-1.6168667*f-.4906146*b),As(-.9787684*v+1.9161415*f+.033454*b),As(.0719453*v-.2289914*f+1.4052427*b),c]}function As(s){return(s=s<=.00304?12.92*s:1.055*Math.pow(s,1/2.4)-.055)<0?0:s>1?1:s}function ku(s){return s>fo?s*s*s:Ud*(s-jd)}function ic(s){return parseInt(s.padEnd(2,s),16)/255}function Zd(s,n){return Rs(n?s/100:s,0,1)}function Rs(s,n,a){return Math.min(Math.max(n,s),a)}function Iu(s){return!s.some(Number.isNaN)}const Ta={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Tn(s,n,a){return s+a*(n-s)}function Pa(s,n,a){return s.map((c,f)=>Tn(c,n[f],a))}class Pn{constructor(n,a,c,f=1,v=!0){this.r=n,this.g=a,this.b=c,this.a=f,v||(this.r*=f,this.g*=f,this.b*=f,f||this.overwriteGetter("rgb",[n,a,c,f]))}static parse(n){if(n instanceof Pn)return n;if(typeof n!="string")return;const a=function(c){if((c=c.toLowerCase().trim())==="transparent")return[0,0,0,0];const f=Ta[c];if(f){const[b,w,C]=f;return[b/255,w/255,C/255,1]}if(c.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(c)){const b=c.length<6?1:2;let w=1;return[ic(c.slice(w,w+=b)),ic(c.slice(w,w+=b)),ic(c.slice(w,w+=b)),ic(c.slice(w,w+b)||"ff")]}if(c.startsWith("rgb")){const b=c.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){const[w,C,I,R,L,$,G,Z,K,ie,he,ze]=b,ge=[R||" ",G||" ",ie].join("");if(ge==="  "||ge==="  /"||ge===",,"||ge===",,,"){const U=[I,$,K].join(""),ne=U==="%%%"?100:U===""?255:0;if(ne){const ve=[Rs(+C/ne,0,1),Rs(+L/ne,0,1),Rs(+Z/ne,0,1),he?Zd(+he,ze):1];if(Iu(ve))return ve}}return}}const v=c.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[b,w,C,I,R,L,$,G,Z]=v,K=[C||" ",R||" ",$].join("");if(K==="  "||K==="  /"||K===",,"||K===",,,"){const ie=[+w,Rs(+I,0,100),Rs(+L,0,100),G?Zd(+G,Z):1];if(Iu(ie))return function([he,ze,ge,U]){function ne(ve){const He=(ve+he/30)%12,dt=ze*Math.min(ge,1-ge);return ge-dt*Math.max(-1,Math.min(He-3,9-He,1))}return he=Gd(he),ze/=100,ge/=100,[ne(0),ne(8),ne(4),U]}(ie)}}}(n);return a?new Pn(...a,!1):void 0}get rgb(){const{r:n,g:a,b:c,a:f}=this,v=f||1/0;return this.overwriteGetter("rgb",[n/v,a/v,c/v,f])}get hcl(){return this.overwriteGetter("hcl",function(n){const[a,c,f,v]=Tu(n),b=Math.sqrt(c*c+f*f);return[Math.round(1e4*b)?Gd(Math.atan2(f,c)*Vm):NaN,b,a,v]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Tu(this.rgb))}overwriteGetter(n,a){return Object.defineProperty(this,n,{value:a}),a}toString(){const[n,a,c,f]=this.rgb;return`rgba(${[n,a,c].map(v=>Math.round(255*v)).join(",")},${f})`}static interpolate(n,a,c,f="rgb"){switch(f){case"rgb":{const[v,b,w,C]=Pa(n.rgb,a.rgb,c);return new Pn(v,b,w,C,!1)}case"hcl":{const[v,b,w,C]=n.hcl,[I,R,L,$]=a.hcl;let G,Z;if(isNaN(v)||isNaN(I))isNaN(v)?isNaN(I)?G=NaN:(G=I,w!==1&&w!==0||(Z=R)):(G=v,L!==1&&L!==0||(Z=b));else{let ge=I-v;I>v&&ge>180?ge-=360:I<v&&v-I>180&&(ge+=360),G=v+c*ge}const[K,ie,he,ze]=function([ge,U,ne,ve]){return ge=isNaN(ge)?0:ge*Om,Hd([ne,Math.cos(ge)*U,Math.sin(ge)*U,ve])}([G,Z??Tn(b,R,c),Tn(w,L,c),Tn(C,$,c)]);return new Pn(K,ie,he,ze,!1)}case"lab":{const[v,b,w,C]=Hd(Pa(n.lab,a.lab,c));return new Pn(v,b,w,C,!1)}}}}Pn.black=new Pn(0,0,0,1),Pn.white=new Pn(1,1,1,1),Pn.transparent=new Pn(0,0,0,0),Pn.red=new Pn(1,0,0,1);class rc{constructor(n,a,c){this.sensitivity=n?a?"variant":"case":a?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,a){return this.collator.compare(n,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const qd=["bottom","center","top"];class tl{constructor(n,a,c,f,v,b){this.text=n,this.image=a,this.scale=c,this.fontStack=f,this.textColor=v,this.verticalAlign=b}}class Ai{constructor(n){this.sections=n}static fromString(n){return new Ai([new tl(n,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.name.length!==0)}static factory(n){return n instanceof Ai?n:Ai.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}}class Wi{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof Wi)return n;if(typeof n=="number")return new Wi([n,n,n,n]);if(Array.isArray(n)&&!(n.length<1||n.length>4)){for(const a of n)if(typeof a!="number")return;switch(n.length){case 1:n=[n[0],n[0],n[0],n[0]];break;case 2:n=[n[0],n[1],n[0],n[1]];break;case 3:n=[n[0],n[1],n[2],n[1]]}return new Wi(n)}}toString(){return JSON.stringify(this.values)}static interpolate(n,a,c){return new Wi(Pa(n.values,a.values,c))}}class bi{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const Mu=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class fr{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof fr)return n;if(Array.isArray(n)&&!(n.length<1)&&n.length%2==0){for(let a=0;a<n.length;a+=2){const c=n[a],f=n[a+1];if(typeof c!="string"||!Mu.has(c)||!Array.isArray(f)||f.length!==2||typeof f[0]!="number"||typeof f[1]!="number")return}return new fr(n)}}toString(){return JSON.stringify(this.values)}static interpolate(n,a,c){const f=n.values,v=a.values;if(f.length!==v.length)throw new bi(`Cannot interpolate values of different length. from: ${n.toString()}, to: ${a.toString()}`);const b=[];for(let w=0;w<f.length;w+=2){if(f[w]!==v[w])throw new bi(`Cannot interpolate values containing mismatched anchors. from[${w}]: ${f[w]}, to[${w}]: ${v[w]}`);b.push(f[w]);const[C,I]=f[w+1],[R,L]=v[w+1];b.push([Tn(C,R,c),Tn(I,L,c)])}return new fr(b)}}class pr{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new pr({name:n,available:!1}):null}}class mr{constructor(n,a,c){this.from=n,this.to=a,this.transition=c}static interpolate(n,a,c){return new mr(n,a,c)}static parse(n){return n instanceof mr?n:Array.isArray(n)&&n.length===3&&typeof n[0]=="string"&&typeof n[1]=="string"&&typeof n[2]=="number"?new mr(n[0],n[1],n[2]):typeof n=="object"&&typeof n.from=="string"&&typeof n.to=="string"&&typeof n.transition=="number"?new mr(n.from,n.to,n.transition):typeof n=="string"?new mr(n,n,1):void 0}}function Eu(s,n,a,c){return typeof s=="number"&&s>=0&&s<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof a=="number"&&a>=0&&a<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[s,n,a,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[s,n,a,c]:[s,n,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ds(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof mr||s instanceof Pn||s instanceof rc||s instanceof Ai||s instanceof Wi||s instanceof fr||s instanceof pr)return!0;if(Array.isArray(s)){for(const n of s)if(!Ds(n))return!1;return!0}if(typeof s=="object"){for(const n in s)if(!Ds(s[n]))return!1;return!0}return!1}function ai(s){if(s===null)return pn;if(typeof s=="string")return Et;if(typeof s=="boolean")return jt;if(typeof s=="number")return st;if(s instanceof Pn)return Cn;if(s instanceof mr)return zn;if(s instanceof rc)return ki;if(s instanceof Ai)return os;if(s instanceof Wi)return qi;if(s instanceof fr)return ui;if(s instanceof pr)return Vi;if(Array.isArray(s)){const n=s.length;let a;for(const c of s){const f=ai(c);if(a){if(a===f)continue;a=Ot;break}a=f}return Or(a||Ot,n)}return on}function nl(s){const n=typeof s;return s===null?"":n==="string"||n==="number"||n==="boolean"?String(s):s instanceof Pn||s instanceof mr||s instanceof Ai||s instanceof Wi||s instanceof fr||s instanceof pr?s.toString():JSON.stringify(s)}class ka{constructor(n,a){this.type=n,this.value=a}static parse(n,a){if(n.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!Ds(n[1]))return a.error("invalid value");const c=n[1];let f=ai(c);const v=a.expectedType;return f.kind!=="array"||f.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(f=v),new ka(f,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const ja={string:Et,number:st,boolean:jt,object:on};class Jr{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");let c,f=1;const v=n[0];if(v==="array"){let w,C;if(n.length>2){const I=n[1];if(typeof I!="string"||!(I in ja)||I==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);w=ja[I],f++}else w=Ot;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return a.error('The length argument to "array" must be a positive integer literal',2);C=n[2],f++}c=Or(w,C)}else{if(!ja[v])throw new Error(`Types doesn't contain name = ${v}`);c=ja[v]}const b=[];for(;f<n.length;f++){const w=a.parse(n[f],f,Ot);if(!w)return null;b.push(w)}return new Jr(c,b)}evaluate(n){for(let a=0;a<this.args.length;a++){const c=this.args[a].evaluate(n);if(!ho(this.type,ai(c)))return c;if(a===this.args.length-1)throw new bi(`Expected value to be of type ${hi(this.type)}, but found ${hi(ai(c))} instead.`)}throw new Error}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const Au={"to-boolean":jt,"to-color":Cn,"to-number":st,"to-string":Et};class Ua{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");const c=n[0];if(!Au[c])throw new Error(`Can't parse ${c} as it is not part of the known types`);if((c==="to-boolean"||c==="to-string")&&n.length!==2)return a.error("Expected one argument.");const f=Au[c],v=[];for(let b=1;b<n.length;b++){const w=a.parse(n[b],b,Ot);if(!w)return null;v.push(w)}return new Ua(f,v)}evaluate(n){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(n);case"color":{let a,c;for(const f of this.args){if(a=f.evaluate(n),c=null,a instanceof Pn)return a;if(typeof a=="string"){const v=n.parseColor(a);if(v)return v}else if(Array.isArray(a)&&(c=a.length<3||a.length>4?`Invalid rgba value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:Eu(a[0],a[1],a[2],a[3]),!c))return new Pn(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new bi(c||`Could not parse color from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"padding":{let a;for(const c of this.args){a=c.evaluate(n);const f=Wi.parse(a);if(f)return f}throw new bi(`Could not parse padding from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"variableAnchorOffsetCollection":{let a;for(const c of this.args){a=c.evaluate(n);const f=fr.parse(a);if(f)return f}throw new bi(`Could not parse variableAnchorOffsetCollection from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"number":{let a=null;for(const c of this.args){if(a=c.evaluate(n),a===null)return 0;const f=Number(a);if(!isNaN(f))return f}throw new bi(`Could not convert ${JSON.stringify(a)} to number.`)}case"formatted":return Ai.fromString(nl(this.args[0].evaluate(n)));case"resolvedImage":return pr.fromString(nl(this.args[0].evaluate(n)));case"projectionDefinition":return this.args[0].evaluate(n);default:return nl(this.args[0].evaluate(n))}}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const ac=["Unknown","Point","LineString","Polygon"];class si{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ac[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(n){let a=this._parseColorCache[n];return a||(a=this._parseColorCache[n]=Pn.parse(n)),a}}class po{constructor(n,a,c=[],f,v=new tn,b=[]){this.registry=n,this.path=c,this.key=c.map(w=>`[${w}]`).join(""),this.scope=v,this.errors=b,this.expectedType=f,this._isConstant=a}parse(n,a,c,f,v={}){return a?this.concat(a,c,f)._parse(n,v):this._parse(n,v)}_parse(n,a){function c(f,v,b){return b==="assert"?new Jr(v,[f]):b==="coerce"?new Ua(v,[f]):f}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=n[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[f];if(v){let b=v.parse(n,this);if(!b)return null;if(this.expectedType){const w=this.expectedType,C=b.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||C.kind!=="value")if(w.kind!=="projectionDefinition"||C.kind!=="string"&&C.kind!=="array")if(w.kind!=="color"&&w.kind!=="formatted"&&w.kind!=="resolvedImage"||C.kind!=="value"&&C.kind!=="string")if(w.kind!=="padding"||C.kind!=="value"&&C.kind!=="number"&&C.kind!=="array")if(w.kind!=="variableAnchorOffsetCollection"||C.kind!=="value"&&C.kind!=="array"){if(this.checkSubtype(w,C))return null}else b=c(b,w,a.typeAnnotation||"coerce");else b=c(b,w,a.typeAnnotation||"coerce");else b=c(b,w,a.typeAnnotation||"coerce");else b=c(b,w,a.typeAnnotation||"coerce");else b=c(b,w,a.typeAnnotation||"assert")}if(!(b instanceof ka)&&b.type.kind!=="resolvedImage"&&this._isConstant(b)){const w=new si;try{b=new ka(b.type,b.evaluate(w))}catch(C){return this.error(C.message),null}}return b}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,a,c){const f=typeof n=="number"?this.path.concat(n):this.path,v=c?this.scope.concat(c):this.scope;return new po(this.registry,this._isConstant,f,a||null,v,this.errors)}error(n,...a){const c=`${this.key}${a.map(f=>`[${f}]`).join("")}`;this.errors.push(new Tt(c,n))}checkSubtype(n,a){const c=ho(n,a);return c&&this.error(c),c}}class Rn{constructor(n,a){this.type=a.type,this.bindings=[].concat(n),this.result=a}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const a of this.bindings)n(a[1]);n(this.result)}static parse(n,a){if(n.length<4)return a.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const c=[];for(let v=1;v<n.length-1;v+=2){const b=n[v];if(typeof b!="string")return a.error(`Expected string, but found ${typeof b} instead.`,v);if(/[^a-zA-Z0-9_]/.test(b))return a.error("Variable names must contain only alphanumeric characters or '_'.",v);const w=a.parse(n[v+1],v+1);if(!w)return null;c.push([b,w])}const f=a.parse(n[n.length-1],n.length-1,a.expectedType,c);return f?new Rn(c,f):null}outputDefined(){return this.result.outputDefined()}}class yn{constructor(n,a){this.type=a.type,this.name=n,this.boundExpression=a}static parse(n,a){if(n.length!==2||typeof n[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const c=n[1];return a.scope.has(c)?new yn(c,a.scope.get(c)):a.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}}class il{constructor(n,a,c){this.type=n,this.index=a,this.input=c}static parse(n,a){if(n.length!==3)return a.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const c=a.parse(n[1],1,st),f=a.parse(n[2],2,Or(a.expectedType||Ot));return c&&f?new il(f.type.itemType,c,f):null}evaluate(n){const a=this.index.evaluate(n),c=this.input.evaluate(n);if(a<0)throw new bi(`Array index out of bounds: ${a} < 0.`);if(a>=c.length)throw new bi(`Array index out of bounds: ${a} > ${c.length-1}.`);if(a!==Math.floor(a))throw new bi(`Array index must be an integer, but found ${a} instead.`);return c[a]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}}class Ln{constructor(n,a){this.type=jt,this.needle=n,this.haystack=a}static parse(n,a){if(n.length!==3)return a.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const c=a.parse(n[1],1,Ot),f=a.parse(n[2],2,Ot);return c&&f?Su(c.type,[jt,Et,st,pn,Ot])?new Ln(c,f):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${hi(c.type)} instead`):null}evaluate(n){const a=this.needle.evaluate(n),c=this.haystack.evaluate(n);if(!c)return!1;if(!Is(a,["boolean","string","number","null"]))throw new bi(`Expected first argument to be of type boolean, string, number or null, but found ${hi(ai(a))} instead.`);if(!Is(c,["string","array"]))throw new bi(`Expected second argument to be of type array or string, but found ${hi(ai(c))} instead.`);return c.indexOf(a)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}}class mo{constructor(n,a,c){this.type=st,this.needle=n,this.haystack=a,this.fromIndex=c}static parse(n,a){if(n.length<=2||n.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const c=a.parse(n[1],1,Ot),f=a.parse(n[2],2,Ot);if(!c||!f)return null;if(!Su(c.type,[jt,Et,st,pn,Ot]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${hi(c.type)} instead`);if(n.length===4){const v=a.parse(n[3],3,st);return v?new mo(c,f,v):null}return new mo(c,f)}evaluate(n){const a=this.needle.evaluate(n),c=this.haystack.evaluate(n);if(!Is(a,["boolean","string","number","null"]))throw new bi(`Expected first argument to be of type boolean, string, number or null, but found ${hi(ai(a))} instead.`);let f;if(this.fromIndex&&(f=this.fromIndex.evaluate(n)),Is(c,["string"])){const v=c.indexOf(a,f);return v===-1?-1:[...c.slice(0,v)].length}if(Is(c,["array"]))return c.indexOf(a,f);throw new bi(`Expected second argument to be of type array or string, but found ${hi(ai(c))} instead.`)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}}class ca{constructor(n,a,c,f,v,b){this.inputType=n,this.type=a,this.input=c,this.cases=f,this.outputs=v,this.otherwise=b}static parse(n,a){if(n.length<5)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return a.error("Expected an even number of arguments.");let c,f;a.expectedType&&a.expectedType.kind!=="value"&&(f=a.expectedType);const v={},b=[];for(let I=2;I<n.length-1;I+=2){let R=n[I];const L=n[I+1];Array.isArray(R)||(R=[R]);const $=a.concat(I);if(R.length===0)return $.error("Expected at least one branch label.");for(const Z of R){if(typeof Z!="number"&&typeof Z!="string")return $.error("Branch labels must be numbers or strings.");if(typeof Z=="number"&&Math.abs(Z)>Number.MAX_SAFE_INTEGER)return $.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Z=="number"&&Math.floor(Z)!==Z)return $.error("Numeric branch labels must be integer values.");if(c){if($.checkSubtype(c,ai(Z)))return null}else c=ai(Z);if(v[String(Z)]!==void 0)return $.error("Branch labels must be unique.");v[String(Z)]=b.length}const G=a.parse(L,I,f);if(!G)return null;f=f||G.type,b.push(G)}const w=a.parse(n[1],1,Ot);if(!w)return null;const C=a.parse(n[n.length-1],n.length-1,f);return C?w.type.kind!=="value"&&a.concat(1).checkSubtype(c,w.type)?null:new ca(c,f,w,v,b,C):null}evaluate(n){const a=this.input.evaluate(n);return(ai(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}}class rl{constructor(n,a,c){this.type=n,this.branches=a,this.otherwise=c}static parse(n,a){if(n.length<4)return a.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return a.error("Expected an odd number of arguments.");let c;a.expectedType&&a.expectedType.kind!=="value"&&(c=a.expectedType);const f=[];for(let b=1;b<n.length-1;b+=2){const w=a.parse(n[b],b,jt);if(!w)return null;const C=a.parse(n[b+1],b+1,c);if(!C)return null;f.push([w,C]),c=c||C.type}const v=a.parse(n[n.length-1],n.length-1,c);if(!v)return null;if(!c)throw new Error("Can't infer output type");return new rl(c,f,v)}evaluate(n){for(const[a,c]of this.branches)if(a.evaluate(n))return c.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[a,c]of this.branches)n(a),n(c);n(this.otherwise)}outputDefined(){return this.branches.every(([n,a])=>a.outputDefined())&&this.otherwise.outputDefined()}}class al{constructor(n,a,c,f){this.type=n,this.input=a,this.beginIndex=c,this.endIndex=f}static parse(n,a){if(n.length<=2||n.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const c=a.parse(n[1],1,Ot),f=a.parse(n[2],2,st);if(!c||!f)return null;if(!Su(c.type,[Or(Ot),Et,Ot]))return a.error(`Expected first argument to be of type array or string, but found ${hi(c.type)} instead`);if(n.length===4){const v=a.parse(n[3],3,st);return v?new al(c.type,c,f,v):null}return new al(c.type,c,f)}evaluate(n){const a=this.input.evaluate(n),c=this.beginIndex.evaluate(n);let f;if(this.endIndex&&(f=this.endIndex.evaluate(n)),Is(a,["string"]))return[...a].slice(c,f).join("");if(Is(a,["array"]))return a.slice(c,f);throw new bi(`Expected first argument to be of type array or string, but found ${hi(ai(a))} instead.`)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}}function sl(s,n){const a=s.length-1;let c,f,v=0,b=a,w=0;for(;v<=b;)if(w=Math.floor((v+b)/2),c=s[w],f=s[w+1],c<=n){if(w===a||n<f)return w;v=w+1}else{if(!(c>n))throw new bi("Input is not a number.");b=w-1}return 0}class zs{constructor(n,a,c){this.type=n,this.input=a,this.labels=[],this.outputs=[];for(const[f,v]of c)this.labels.push(f),this.outputs.push(v)}static parse(n,a){if(n.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return a.error("Expected an even number of arguments.");const c=a.parse(n[1],1,st);if(!c)return null;const f=[];let v=null;a.expectedType&&a.expectedType.kind!=="value"&&(v=a.expectedType);for(let b=1;b<n.length;b+=2){const w=b===1?-1/0:n[b],C=n[b+1],I=b,R=b+1;if(typeof w!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(f.length&&f[f.length-1][0]>=w)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const L=a.parse(C,R,v);if(!L)return null;v=v||L.type,f.push([w,L])}return new zs(v,c,f)}evaluate(n){const a=this.labels,c=this.outputs;if(a.length===1)return c[0].evaluate(n);const f=this.input.evaluate(n);if(f<=a[0])return c[0].evaluate(n);const v=a.length;return f>=a[v-1]?c[v-1].evaluate(n):c[sl(a,f)].evaluate(n)}eachChild(n){n(this.input);for(const a of this.outputs)n(a)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function Wd(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Ru,Du,Xd=function(){if(Du)return Ru;function s(n,a,c,f){this.cx=3*n,this.bx=3*(c-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(f-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=a,this.p2x=c,this.p2y=f}return Du=1,Ru=s,s.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,a){if(a===void 0&&(a=1e-6),n<0)return 0;if(n>1)return 1;for(var c=n,f=0;f<8;f++){var v=this.sampleCurveX(c)-n;if(Math.abs(v)<a)return c;var b=this.sampleCurveDerivativeX(c);if(Math.abs(b)<1e-6)break;c-=v/b}var w=0,C=1;for(c=n,f=0;f<20&&(v=this.sampleCurveX(c),!(Math.abs(v-n)<a));f++)n>v?w=c:C=c,c=.5*(C-w)+w;return c},solve:function(n,a){return this.sampleCurveY(this.solveCurveX(n,a))}},Ru}(),ol=Wd(Xd);class Jn{constructor(n,a,c,f,v){this.type=n,this.operator=a,this.interpolation=c,this.input=f,this.labels=[],this.outputs=[];for(const[b,w]of v)this.labels.push(b),this.outputs.push(w)}static interpolationFactor(n,a,c,f){let v=0;if(n.name==="exponential")v=go(a,n.base,c,f);else if(n.name==="linear")v=go(a,1,c,f);else if(n.name==="cubic-bezier"){const b=n.controlPoints;v=new ol(b[0],b[1],b[2],b[3]).solve(go(a,1,c,f))}return v}static parse(n,a){let[c,f,v,...b]=n;if(!Array.isArray(f)||f.length===0)return a.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const I=f[1];if(typeof I!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:I}}else{if(f[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const I=f.slice(1);if(I.length!==4||I.some(R=>typeof R!="number"||R<0||R>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:I}}}if(n.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(v=a.parse(v,2,st),!v)return null;const w=[];let C=null;c==="interpolate-hcl"||c==="interpolate-lab"?C=Cn:a.expectedType&&a.expectedType.kind!=="value"&&(C=a.expectedType);for(let I=0;I<b.length;I+=2){const R=b[I],L=b[I+1],$=I+3,G=I+4;if(typeof R!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(w.length&&w[w.length-1][0]>=R)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);const Z=a.parse(L,G,C);if(!Z)return null;C=C||Z.type,w.push([R,Z])}return Ms(C,st)||Ms(C,zn)||Ms(C,Cn)||Ms(C,qi)||Ms(C,ui)||Ms(C,Or(st))?new Jn(C,c,f,v,w):a.error(`Type ${hi(C)} is not interpolatable.`)}evaluate(n){const a=this.labels,c=this.outputs;if(a.length===1)return c[0].evaluate(n);const f=this.input.evaluate(n);if(f<=a[0])return c[0].evaluate(n);const v=a.length;if(f>=a[v-1])return c[v-1].evaluate(n);const b=sl(a,f),w=Jn.interpolationFactor(this.interpolation,f,a[b],a[b+1]),C=c[b].evaluate(n),I=c[b+1].evaluate(n);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Tn(C,I,w);case"color":return Pn.interpolate(C,I,w);case"padding":return Wi.interpolate(C,I,w);case"variableAnchorOffsetCollection":return fr.interpolate(C,I,w);case"array":return Pa(C,I,w);case"projectionDefinition":return mr.interpolate(C,I,w)}case"interpolate-hcl":return Pn.interpolate(C,I,w,"hcl");case"interpolate-lab":return Pn.interpolate(C,I,w,"lab")}}eachChild(n){n(this.input);for(const a of this.outputs)n(a)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function go(s,n,a,c){const f=c-a,v=s-a;return f===0?0:n===1?v/f:(Math.pow(n,v)-1)/(Math.pow(n,f)-1)}const ua={color:Pn.interpolate,number:Tn,padding:Wi.interpolate,variableAnchorOffsetCollection:fr.interpolate,array:Pa};class Ls{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");let c=null;const f=a.expectedType;f&&f.kind!=="value"&&(c=f);const v=[];for(const w of n.slice(1)){const C=a.parse(w,1+v.length,c,void 0,{typeAnnotation:"omit"});if(!C)return null;c=c||C.type,v.push(C)}if(!c)throw new Error("No output type");const b=f&&v.some(w=>ho(f,w.type));return new Ls(b?Ot:c,v)}evaluate(n){let a,c=null,f=0;for(const v of this.args)if(f++,c=v.evaluate(n),c&&c instanceof pr&&!c.available&&(a||(a=c.name),c=null,f===this.args.length&&(c=a)),c!==null)break;return c}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}function Xi(s,n){return s==="=="||s==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function zu(s,n,a,c){return c.compare(n,a)===0}function ls(s,n,a){const c=s!=="=="&&s!=="!=";return class qC{constructor(v,b,w){this.type=jt,this.lhs=v,this.rhs=b,this.collator=w,this.hasUntypedArgument=v.type.kind==="value"||b.type.kind==="value"}static parse(v,b){if(v.length!==3&&v.length!==4)return b.error("Expected two or three arguments.");const w=v[0];let C=b.parse(v[1],1,Ot);if(!C)return null;if(!Xi(w,C.type))return b.concat(1).error(`"${w}" comparisons are not supported for type '${hi(C.type)}'.`);let I=b.parse(v[2],2,Ot);if(!I)return null;if(!Xi(w,I.type))return b.concat(2).error(`"${w}" comparisons are not supported for type '${hi(I.type)}'.`);if(C.type.kind!==I.type.kind&&C.type.kind!=="value"&&I.type.kind!=="value")return b.error(`Cannot compare types '${hi(C.type)}' and '${hi(I.type)}'.`);c&&(C.type.kind==="value"&&I.type.kind!=="value"?C=new Jr(I.type,[C]):C.type.kind!=="value"&&I.type.kind==="value"&&(I=new Jr(C.type,[I])));let R=null;if(v.length===4){if(C.type.kind!=="string"&&I.type.kind!=="string"&&C.type.kind!=="value"&&I.type.kind!=="value")return b.error("Cannot use collator to compare non-string types.");if(R=b.parse(v[3],3,ki),!R)return null}return new qC(C,I,R)}evaluate(v){const b=this.lhs.evaluate(v),w=this.rhs.evaluate(v);if(c&&this.hasUntypedArgument){const C=ai(b),I=ai(w);if(C.kind!==I.kind||C.kind!=="string"&&C.kind!=="number")throw new bi(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${C.kind}, ${I.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const C=ai(b),I=ai(w);if(C.kind!=="string"||I.kind!=="string")return n(v,b,w)}return this.collator?a(v,b,w,this.collator.evaluate(v)):n(v,b,w)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}}}const Kd=ls("==",function(s,n,a){return n===a},zu),Nm=ls("!=",function(s,n,a){return n!==a},function(s,n,a,c){return!zu(0,n,a,c)}),sc=ls("<",function(s,n,a){return n<a},function(s,n,a,c){return c.compare(n,a)<0}),Lu=ls(">",function(s,n,a){return n>a},function(s,n,a,c){return c.compare(n,a)>0}),$m=ls("<=",function(s,n,a){return n<=a},function(s,n,a,c){return c.compare(n,a)<=0}),oc=ls(">=",function(s,n,a){return n>=a},function(s,n,a,c){return c.compare(n,a)>=0});class Bs{constructor(n,a,c){this.type=ki,this.locale=c,this.caseSensitive=n,this.diacriticSensitive=a}static parse(n,a){if(n.length!==2)return a.error("Expected one argument.");const c=n[1];if(typeof c!="object"||Array.isArray(c))return a.error("Collator options argument must be an object.");const f=a.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,jt);if(!f)return null;const v=a.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,jt);if(!v)return null;let b=null;return c.locale&&(b=a.parse(c.locale,1,Et),!b)?null:new Bs(f,v,b)}evaluate(n){return new rc(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}}class Vr{constructor(n,a,c,f,v){this.type=Et,this.number=n,this.locale=a,this.currency=c,this.minFractionDigits=f,this.maxFractionDigits=v}static parse(n,a){if(n.length!==3)return a.error("Expected two arguments.");const c=a.parse(n[1],1,st);if(!c)return null;const f=n[2];if(typeof f!="object"||Array.isArray(f))return a.error("NumberFormat options argument must be an object.");let v=null;if(f.locale&&(v=a.parse(f.locale,1,Et),!v))return null;let b=null;if(f.currency&&(b=a.parse(f.currency,1,Et),!b))return null;let w=null;if(f["min-fraction-digits"]&&(w=a.parse(f["min-fraction-digits"],1,st),!w))return null;let C=null;return f["max-fraction-digits"]&&(C=a.parse(f["max-fraction-digits"],1,st),!C)?null:new Vr(c,v,b,w,C)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}}class ll{constructor(n){this.type=os,this.sections=n}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");const c=n[1];if(!Array.isArray(c)&&typeof c=="object")return a.error("First argument must be an image or text section.");const f=[];let v=!1;for(let b=1;b<=n.length-1;++b){const w=n[b];if(v&&typeof w=="object"&&!Array.isArray(w)){v=!1;let C=null;if(w["font-scale"]&&(C=a.parse(w["font-scale"],1,st),!C))return null;let I=null;if(w["text-font"]&&(I=a.parse(w["text-font"],1,Or(Et)),!I))return null;let R=null;if(w["text-color"]&&(R=a.parse(w["text-color"],1,Cn),!R))return null;let L=null;if(w["vertical-align"]){if(typeof w["vertical-align"]=="string"&&!qd.includes(w["vertical-align"]))return a.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${w["vertical-align"]}' instead.`);if(L=a.parse(w["vertical-align"],1,Et),!L)return null}const $=f[f.length-1];$.scale=C,$.font=I,$.textColor=R,$.verticalAlign=L}else{const C=a.parse(n[b],1,Ot);if(!C)return null;const I=C.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,f.push({content:C,scale:null,font:null,textColor:null,verticalAlign:null})}}return new ll(f)}evaluate(n){return new Ai(this.sections.map(a=>{const c=a.content.evaluate(n);return ai(c)===Vi?new tl("",c,null,null,null,a.verticalAlign?a.verticalAlign.evaluate(n):null):new tl(nl(c),null,a.scale?a.scale.evaluate(n):null,a.font?a.font.evaluate(n).join(","):null,a.textColor?a.textColor.evaluate(n):null,a.verticalAlign?a.verticalAlign.evaluate(n):null)}))}eachChild(n){for(const a of this.sections)n(a.content),a.scale&&n(a.scale),a.font&&n(a.font),a.textColor&&n(a.textColor),a.verticalAlign&&n(a.verticalAlign)}outputDefined(){return!1}}class _o{constructor(n){this.type=Vi,this.input=n}static parse(n,a){if(n.length!==2)return a.error("Expected two arguments.");const c=a.parse(n[1],1,Et);return c?new _o(c):a.error("No image name provided.")}evaluate(n){const a=this.input.evaluate(n),c=pr.fromString(a);return c&&n.availableImages&&(c.available=n.availableImages.indexOf(a)>-1),c}eachChild(n){n(this.input)}outputDefined(){return!1}}class Bu{constructor(n){this.type=st,this.input=n}static parse(n,a){if(n.length!==2)return a.error(`Expected 1 argument, but found ${n.length-1} instead.`);const c=a.parse(n[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${hi(c.type)} instead.`):new Bu(c):null}evaluate(n){const a=this.input.evaluate(n);if(typeof a=="string")return[...a].length;if(Array.isArray(a))return a.length;throw new bi(`Expected value to be of type string or array, but found ${hi(ai(a))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}}const Qr=8192;function jm(s,n){const a=(180+s[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,f=Math.pow(2,n.z);return[Math.round(a*f*Qr),Math.round(c*f*Qr)]}function Fu(s,n){const a=Math.pow(2,n.z);return[(f=(s[0]/Qr+n.x)/a,360*f-180),(c=(s[1]/Qr+n.y)/a,360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90)];var c,f}function cl(s,n){s[0]=Math.min(s[0],n[0]),s[1]=Math.min(s[1],n[1]),s[2]=Math.max(s[2],n[0]),s[3]=Math.max(s[3],n[1])}function ul(s,n){return!(s[0]<=n[0]||s[2]>=n[2]||s[1]<=n[1]||s[3]>=n[3])}function lc(s,n,a){const c=s[0]-n[0],f=s[1]-n[1],v=s[0]-a[0],b=s[1]-a[1];return c*b-v*f==0&&c*v<=0&&f*b<=0}function cc(s,n,a,c){return(f=[c[0]-a[0],c[1]-a[1]])[0]*(v=[n[0]-s[0],n[1]-s[1]])[1]-f[1]*v[0]!=0&&!(!Jd(s,n,a,c)||!Jd(a,c,s,n));var f,v}function Yd(s,n,a){for(const c of a)for(let f=0;f<c.length-1;++f)if(cc(s,n,c[f],c[f+1]))return!0;return!1}function Fs(s,n,a=!1){let c=!1;for(const w of n)for(let C=0;C<w.length-1;C++){if(lc(s,w[C],w[C+1]))return a;(v=w[C])[1]>(f=s)[1]!=(b=w[C+1])[1]>f[1]&&f[0]<(b[0]-v[0])*(f[1]-v[1])/(b[1]-v[1])+v[0]&&(c=!c)}var f,v,b;return c}function Um(s,n){for(const a of n)if(Fs(s,a))return!0;return!1}function Ou(s,n){for(const a of s)if(!Fs(a,n))return!1;for(let a=0;a<s.length-1;++a)if(Yd(s[a],s[a+1],n))return!1;return!0}function Gm(s,n){for(const a of n)if(Ou(s,a))return!0;return!1}function Jd(s,n,a,c){const f=c[0]-a[0],v=c[1]-a[1],b=(s[0]-a[0])*v-f*(s[1]-a[1]),w=(n[0]-a[0])*v-f*(n[1]-a[1]);return b>0&&w<0||b<0&&w>0}function Vu(s,n,a){const c=[];for(let f=0;f<s.length;f++){const v=[];for(let b=0;b<s[f].length;b++){const w=jm(s[f][b],a);cl(n,w),v.push(w)}c.push(v)}return c}function Qd(s,n,a){const c=[];for(let f=0;f<s.length;f++){const v=Vu(s[f],n,a);c.push(v)}return c}function ef(s,n,a,c){if(s[0]<a[0]||s[0]>a[2]){const f=.5*c;let v=s[0]-a[0]>f?-c:a[0]-s[0]>f?c:0;v===0&&(v=s[0]-a[2]>f?-c:a[2]-s[0]>f?c:0),s[0]+=v}cl(n,s)}function Nu(s,n,a,c){const f=Math.pow(2,c.z)*Qr,v=[c.x*Qr,c.y*Qr],b=[];for(const w of s)for(const C of w){const I=[C.x+v[0],C.y+v[1]];ef(I,n,a,f),b.push(I)}return b}function $u(s,n,a,c){const f=Math.pow(2,c.z)*Qr,v=[c.x*Qr,c.y*Qr],b=[];for(const C of s){const I=[];for(const R of C){const L=[R.x+v[0],R.y+v[1]];cl(n,L),I.push(L)}b.push(I)}if(n[2]-n[0]<=f/2){(w=n)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const C of b)for(const I of C)ef(I,n,a,f)}var w;return b}class cs{constructor(n,a){this.type=jt,this.geojson=n,this.geometries=a}static parse(n,a){if(n.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Ds(n[1])){const c=n[1];if(c.type==="FeatureCollection"){const f=[];for(const v of c.features){const{type:b,coordinates:w}=v.geometry;b==="Polygon"&&f.push(w),b==="MultiPolygon"&&f.push(...w)}if(f.length)return new cs(c,{type:"MultiPolygon",coordinates:f})}else if(c.type==="Feature"){const f=c.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new cs(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new cs(c,c)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(a,c){const f=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],b=a.canonicalID();if(c.type==="Polygon"){const w=Vu(c.coordinates,v,b),C=Nu(a.geometry(),f,v,b);if(!ul(f,v))return!1;for(const I of C)if(!Fs(I,w))return!1}if(c.type==="MultiPolygon"){const w=Qd(c.coordinates,v,b),C=Nu(a.geometry(),f,v,b);if(!ul(f,v))return!1;for(const I of C)if(!Um(I,w))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(a,c){const f=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],b=a.canonicalID();if(c.type==="Polygon"){const w=Vu(c.coordinates,v,b),C=$u(a.geometry(),f,v,b);if(!ul(f,v))return!1;for(const I of C)if(!Ou(I,w))return!1}if(c.type==="MultiPolygon"){const w=Qd(c.coordinates,v,b),C=$u(a.geometry(),f,v,b);if(!ul(f,v))return!1;for(const I of C)if(!Gm(I,w))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let tf=class{constructor(s=[],n=(a,c)=>a<c?-1:a>c?1:0){if(this.data=s,this.length=this.data.length,this.compare=n,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(s){this.data.push(s),this._up(this.length++)}pop(){if(this.length===0)return;const s=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:n,compare:a}=this,c=n[s];for(;s>0;){const f=s-1>>1,v=n[f];if(a(c,v)>=0)break;n[s]=v,s=f}n[s]=c}_down(s){const{data:n,compare:a}=this,c=this.length>>1,f=n[s];for(;s<c;){let v=1+(s<<1);const b=v+1;if(b<this.length&&a(n[b],n[v])<0&&(v=b),a(n[v],f)>=0)break;n[s]=n[v],s=v}n[s]=f}};function nf(s,n,a=0,c=s.length-1,f=ju){for(;c>a;){if(c-a>600){const C=c-a+1,I=n-a+1,R=Math.log(C),L=.5*Math.exp(2*R/3),$=.5*Math.sqrt(R*L*(C-L)/C)*(I-C/2<0?-1:1);nf(s,n,Math.max(a,Math.floor(n-I*L/C+$)),Math.min(c,Math.floor(n+(C-I)*L/C+$)),f)}const v=s[n];let b=a,w=c;for(hl(s,a,n),f(s[c],v)>0&&hl(s,a,c);b<w;){for(hl(s,b,w),b++,w--;f(s[b],v)<0;)b++;for(;f(s[w],v)>0;)w--}f(s[a],v)===0?hl(s,a,w):(w++,hl(s,w,c)),w<=n&&(a=w+1),n<=w&&(c=w-1)}}function hl(s,n,a){const c=s[n];s[n]=s[a],s[a]=c}function ju(s,n){return s<n?-1:s>n?1:0}function uc(s,n){if(s.length<=1)return[s];const a=[];let c,f;for(const v of s){const b=Zm(v);b!==0&&(v.area=Math.abs(b),f===void 0&&(f=b<0),f===b<0?(c&&a.push(c),c=[v]):c.push(v))}if(c&&a.push(c),n>1)for(let v=0;v<a.length;v++)a[v].length<=n||(nf(a[v],n,1,a[v].length-1,Hm),a[v]=a[v].slice(0,n));return a}function Hm(s,n){return n.area-s.area}function Zm(s){let n=0;for(let a,c,f=0,v=s.length,b=v-1;f<v;b=f++)a=s[f],c=s[b],n+=(c.x-a.x)*(a.y+c.y);return n}const Uu=1/298.257223563,Gu=Uu*(2-Uu),rf=Math.PI/180;class Hu{constructor(n){const a=6378.137*rf*1e3,c=Math.cos(n*rf),f=1/(1-Gu*(1-c*c)),v=Math.sqrt(f);this.kx=a*v*c,this.ky=a*v*f*(1-Gu)}distance(n,a){const c=this.wrap(n[0]-a[0])*this.kx,f=(n[1]-a[1])*this.ky;return Math.sqrt(c*c+f*f)}pointOnLine(n,a){let c,f,v,b,w=1/0;for(let C=0;C<n.length-1;C++){let I=n[C][0],R=n[C][1],L=this.wrap(n[C+1][0]-I)*this.kx,$=(n[C+1][1]-R)*this.ky,G=0;L===0&&$===0||(G=(this.wrap(a[0]-I)*this.kx*L+(a[1]-R)*this.ky*$)/(L*L+$*$),G>1?(I=n[C+1][0],R=n[C+1][1]):G>0&&(I+=L/this.kx*G,R+=$/this.ky*G)),L=this.wrap(a[0]-I)*this.kx,$=(a[1]-R)*this.ky;const Z=L*L+$*$;Z<w&&(w=Z,c=I,f=R,v=C,b=G)}return{point:[c,f],index:v,t:Math.max(0,Math.min(1,b))}}wrap(n){for(;n<-180;)n+=360;for(;n>180;)n-=360;return n}}function Zu(s,n){return n[0]-s[0]}function dl(s){return s[1]-s[0]+1}function Ga(s,n){return s[1]>=s[0]&&s[1]<n}function qu(s,n){if(s[0]>s[1])return[null,null];const a=dl(s);if(n){if(a===2)return[s,null];const f=Math.floor(a/2);return[[s[0],s[0]+f],[s[0]+f,s[1]]]}if(a===1)return[s,null];const c=Math.floor(a/2)-1;return[[s[0],s[0]+c],[s[0]+c+1,s[1]]]}function Wu(s,n){if(!Ga(n,s.length))return[1/0,1/0,-1/0,-1/0];const a=[1/0,1/0,-1/0,-1/0];for(let c=n[0];c<=n[1];++c)cl(a,s[c]);return a}function hc(s){const n=[1/0,1/0,-1/0,-1/0];for(const a of s)for(const c of a)cl(n,c);return n}function af(s){return s[0]!==-1/0&&s[1]!==-1/0&&s[2]!==1/0&&s[3]!==1/0}function Xu(s,n,a){if(!af(s)||!af(n))return NaN;let c=0,f=0;return s[2]<n[0]&&(c=n[0]-s[2]),s[0]>n[2]&&(c=s[0]-n[2]),s[1]>n[3]&&(f=s[1]-n[3]),s[3]<n[1]&&(f=n[1]-s[3]),a.distance([0,0],[c,f])}function Os(s,n,a){const c=a.pointOnLine(n,s);return a.distance(s,c.point)}function Ku(s,n,a,c,f){const v=Math.min(Os(s,[a,c],f),Os(n,[a,c],f)),b=Math.min(Os(a,[s,n],f),Os(c,[s,n],f));return Math.min(v,b)}function Nn(s,n,a,c,f){if(!Ga(n,s.length)||!Ga(c,a.length))return 1/0;let v=1/0;for(let b=n[0];b<n[1];++b){const w=s[b],C=s[b+1];for(let I=c[0];I<c[1];++I){const R=a[I],L=a[I+1];if(cc(w,C,R,L))return 0;v=Math.min(v,Ku(w,C,R,L,f))}}return v}function qm(s,n,a,c,f){if(!Ga(n,s.length)||!Ga(c,a.length))return NaN;let v=1/0;for(let b=n[0];b<=n[1];++b)for(let w=c[0];w<=c[1];++w)if(v=Math.min(v,f.distance(s[b],a[w])),v===0)return v;return v}function Wm(s,n,a){if(Fs(s,n,!0))return 0;let c=1/0;for(const f of n){const v=f[0],b=f[f.length-1];if(v!==b&&(c=Math.min(c,Os(s,[b,v],a)),c===0))return c;const w=a.pointOnLine(f,s);if(c=Math.min(c,a.distance(s,w.point)),c===0)return c}return c}function Xm(s,n,a,c){if(!Ga(n,s.length))return NaN;for(let v=n[0];v<=n[1];++v)if(Fs(s[v],a,!0))return 0;let f=1/0;for(let v=n[0];v<n[1];++v){const b=s[v],w=s[v+1];for(const C of a)for(let I=0,R=C.length,L=R-1;I<R;L=I++){const $=C[L],G=C[I];if(cc(b,w,$,G))return 0;f=Math.min(f,Ku(b,w,$,G,c))}}return f}function sf(s,n){for(const a of s)for(const c of a)if(Fs(c,n,!0))return!0;return!1}function Km(s,n,a,c=1/0){const f=hc(s),v=hc(n);if(c!==1/0&&Xu(f,v,a)>=c)return c;if(ul(f,v)){if(sf(s,n))return 0}else if(sf(n,s))return 0;let b=1/0;for(const w of s)for(let C=0,I=w.length,R=I-1;C<I;R=C++){const L=w[R],$=w[C];for(const G of n)for(let Z=0,K=G.length,ie=K-1;Z<K;ie=Z++){const he=G[ie],ze=G[Z];if(cc(L,$,he,ze))return 0;b=Math.min(b,Ku(L,$,he,ze,a))}}return b}function of(s,n,a,c,f,v){if(!v)return;const b=Xu(Wu(c,v),f,a);b<n&&s.push([b,v,[0,0]])}function dc(s,n,a,c,f,v,b){if(!v||!b)return;const w=Xu(Wu(c,v),Wu(f,b),a);w<n&&s.push([w,v,b])}function fc(s,n,a,c,f=1/0){let v=Math.min(c.distance(s[0],a[0][0]),f);if(v===0)return v;const b=new tf([[0,[0,s.length-1],[0,0]]],Zu),w=hc(a);for(;b.length>0;){const C=b.pop();if(C[0]>=v)continue;const I=C[1],R=n?50:100;if(dl(I)<=R){if(!Ga(I,s.length))return NaN;if(n){const L=Xm(s,I,a,c);if(isNaN(L)||L===0)return L;v=Math.min(v,L)}else for(let L=I[0];L<=I[1];++L){const $=Wm(s[L],a,c);if(v=Math.min(v,$),v===0)return 0}}else{const L=qu(I,n);of(b,v,c,s,w,L[0]),of(b,v,c,s,w,L[1])}}return v}function pc(s,n,a,c,f,v=1/0){let b=Math.min(v,f.distance(s[0],a[0]));if(b===0)return b;const w=new tf([[0,[0,s.length-1],[0,a.length-1]]],Zu);for(;w.length>0;){const C=w.pop();if(C[0]>=b)continue;const I=C[1],R=C[2],L=n?50:100,$=c?50:100;if(dl(I)<=L&&dl(R)<=$){if(!Ga(I,s.length)&&Ga(R,a.length))return NaN;let G;if(n&&c)G=Nn(s,I,a,R,f),b=Math.min(b,G);else if(n&&!c){const Z=s.slice(I[0],I[1]+1);for(let K=R[0];K<=R[1];++K)if(G=Os(a[K],Z,f),b=Math.min(b,G),b===0)return b}else if(!n&&c){const Z=a.slice(R[0],R[1]+1);for(let K=I[0];K<=I[1];++K)if(G=Os(s[K],Z,f),b=Math.min(b,G),b===0)return b}else G=qm(s,I,a,R,f),b=Math.min(b,G)}else{const G=qu(I,n),Z=qu(R,c);dc(w,b,f,s,a,G[0],Z[0]),dc(w,b,f,s,a,G[0],Z[1]),dc(w,b,f,s,a,G[1],Z[0]),dc(w,b,f,s,a,G[1],Z[1])}}return b}function Yu(s){return s.type==="MultiPolygon"?s.coordinates.map(n=>({type:"Polygon",coordinates:n})):s.type==="MultiLineString"?s.coordinates.map(n=>({type:"LineString",coordinates:n})):s.type==="MultiPoint"?s.coordinates.map(n=>({type:"Point",coordinates:n})):[s]}class Vs{constructor(n,a){this.type=st,this.geojson=n,this.geometries=a}static parse(n,a){if(n.length!==2)return a.error(`'distance' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Ds(n[1])){const c=n[1];if(c.type==="FeatureCollection")return new Vs(c,c.features.map(f=>Yu(f.geometry)).flat());if(c.type==="Feature")return new Vs(c,Yu(c.geometry));if("type"in c&&"coordinates"in c)return new Vs(c,Yu(c))}return a.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(a,c){const f=a.geometry(),v=f.flat().map(C=>Fu([C.x,C.y],a.canonical));if(f.length===0)return NaN;const b=new Hu(v[0][1]);let w=1/0;for(const C of c){switch(C.type){case"Point":w=Math.min(w,pc(v,!1,[C.coordinates],!1,b,w));break;case"LineString":w=Math.min(w,pc(v,!1,C.coordinates,!0,b,w));break;case"Polygon":w=Math.min(w,fc(v,!1,C.coordinates,b,w))}if(w===0)return w}return w}(n,this.geometries);if(n.geometryType()==="LineString")return function(a,c){const f=a.geometry(),v=f.flat().map(C=>Fu([C.x,C.y],a.canonical));if(f.length===0)return NaN;const b=new Hu(v[0][1]);let w=1/0;for(const C of c){switch(C.type){case"Point":w=Math.min(w,pc(v,!0,[C.coordinates],!1,b,w));break;case"LineString":w=Math.min(w,pc(v,!0,C.coordinates,!0,b,w));break;case"Polygon":w=Math.min(w,fc(v,!0,C.coordinates,b,w))}if(w===0)return w}return w}(n,this.geometries);if(n.geometryType()==="Polygon")return function(a,c){const f=a.geometry();if(f.length===0||f[0].length===0)return NaN;const v=uc(f,0).map(C=>C.map(I=>I.map(R=>Fu([R.x,R.y],a.canonical)))),b=new Hu(v[0][0][0][1]);let w=1/0;for(const C of c)for(const I of v){switch(C.type){case"Point":w=Math.min(w,fc([C.coordinates],!1,I,b,w));break;case"LineString":w=Math.min(w,fc(C.coordinates,!0,I,b,w));break;case"Polygon":w=Math.min(w,Km(I,C.coordinates,b,w))}if(w===0)return w}return w}(n,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const yo={"==":Kd,"!=":Nm,">":Lu,"<":sc,">=":oc,"<=":$m,array:Jr,at:il,boolean:Jr,case:rl,coalesce:Ls,collator:Bs,format:ll,image:_o,in:Ln,"index-of":mo,interpolate:Jn,"interpolate-hcl":Jn,"interpolate-lab":Jn,length:Bu,let:Rn,literal:ka,match:ca,number:Jr,"number-format":Vr,object:Jr,slice:al,step:zs,string:Jr,"to-boolean":Ua,"to-color":Ua,"to-number":Ua,"to-string":Ua,var:yn,within:cs,distance:Vs};class ea{constructor(n,a,c,f){this.name=n,this.type=a,this._evaluate=c,this.args=f}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}static parse(n,a){const c=n[0],f=ea.definitions[c];if(!f)return a.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(f)?f[0]:f.type,b=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,w=b.filter(([I])=>!Array.isArray(I)||I.length===n.length-1);let C=null;for(const[I,R]of w){C=new po(a.registry,mc,a.path,null,a.scope);const L=[];let $=!1;for(let G=1;G<n.length;G++){const Z=n[G],K=Array.isArray(I)?I[G-1]:I.type,ie=C.parse(Z,1+L.length,K);if(!ie){$=!0;break}L.push(ie)}if(!$)if(Array.isArray(I)&&I.length!==L.length)C.error(`Expected ${I.length} arguments, but found ${L.length} instead.`);else{for(let G=0;G<L.length;G++){const Z=Array.isArray(I)?I[G]:I.type,K=L[G];C.concat(G+1).checkSubtype(Z,K.type)}if(C.errors.length===0)return new ea(c,v,R,L)}}if(w.length===1)a.errors.push(...C.errors);else{const I=(w.length?w:b).map(([L])=>{return $=L,Array.isArray($)?`(${$.map(hi).join(", ")})`:`(${hi($.type)}...)`;var $}).join(" | "),R=[];for(let L=1;L<n.length;L++){const $=a.parse(n[L],1+R.length);if(!$)return null;R.push(hi($.type))}a.error(`Expected arguments of type ${I}, but found (${R.join(", ")}) instead.`)}return null}static register(n,a){ea.definitions=a;for(const c in a)n[c]=ea}}function lf(s,[n,a,c,f]){n=n.evaluate(s),a=a.evaluate(s),c=c.evaluate(s);const v=f?f.evaluate(s):1,b=Eu(n,a,c,v);if(b)throw new bi(b);return new Pn(n/255,a/255,c/255,v,!1)}function cf(s,n){return s in n}function Ju(s,n){const a=n[s];return a===void 0?null:a}function Ns(s){return{type:s}}function mc(s){if(s instanceof yn)return mc(s.boundExpression);if(s instanceof ea&&s.name==="error"||s instanceof Bs||s instanceof cs||s instanceof Vs)return!1;const n=s instanceof Ua||s instanceof Jr;let a=!0;return s.eachChild(c=>{a=n?a&&mc(c):a&&c instanceof ka}),!!a&&gc(s)&&_c(s,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function gc(s){if(s instanceof ea&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof cs||s instanceof Vs)return!1;let n=!0;return s.eachChild(a=>{n&&!gc(a)&&(n=!1)}),n}function fl(s){if(s instanceof ea&&s.name==="feature-state")return!1;let n=!0;return s.eachChild(a=>{n&&!fl(a)&&(n=!1)}),n}function _c(s,n){if(s instanceof ea&&n.indexOf(s.name)>=0)return!1;let a=!0;return s.eachChild(c=>{a&&!_c(c,n)&&(a=!1)}),a}function uf(s){return{result:"success",value:s}}function vo(s){return{result:"error",value:s}}function bo(s){return s["property-type"]==="data-driven"||s["property-type"]==="cross-faded-data-driven"}function hf(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function Qu(s){return!!s.expression&&s.expression.interpolated}function Fn(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function yc(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)}function Ym(s){return s}function df(s,n){const a=n.type==="color",c=s.stops&&typeof s.stops[0][0]=="object",f=c||!(c||s.property!==void 0),v=s.type||(Qu(n)?"exponential":"interval");if(a||n.type==="padding"){const R=a?Pn.parse:Wi.parse;(s=kt({},s)).stops&&(s.stops=s.stops.map(L=>[L[0],R(L[1])])),s.default=R(s.default?s.default:n.default)}if(s.colorSpace&&(b=s.colorSpace)!=="rgb"&&b!=="hcl"&&b!=="lab")throw new Error(`Unknown color space: "${s.colorSpace}"`);var b;let w,C,I;if(v==="exponential")w=ff;else if(v==="interval")w=Jm;else if(v==="categorical"){w=eh,C=Object.create(null);for(const R of s.stops)C[R[0]]=R[1];I=typeof s.stops[0][0]}else{if(v!=="identity")throw new Error(`Unknown function type "${v}"`);w=Qm}if(c){const R={},L=[];for(let Z=0;Z<s.stops.length;Z++){const K=s.stops[Z],ie=K[0].zoom;R[ie]===void 0&&(R[ie]={zoom:ie,type:s.type,property:s.property,default:s.default,stops:[]},L.push(ie)),R[ie].stops.push([K[0].value,K[1]])}const $=[];for(const Z of L)$.push([R[Z].zoom,df(R[Z],n)]);const G={name:"linear"};return{kind:"composite",interpolationType:G,interpolationFactor:Jn.interpolationFactor.bind(void 0,G),zoomStops:$.map(Z=>Z[0]),evaluate:({zoom:Z},K)=>ff({stops:$,base:s.base},n,Z).evaluate(Z,K)}}if(f){const R=v==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:R,interpolationFactor:Jn.interpolationFactor.bind(void 0,R),zoomStops:s.stops.map(L=>L[0]),evaluate:({zoom:L})=>w(s,n,L,C,I)}}return{kind:"source",evaluate(R,L){const $=L&&L.properties?L.properties[s.property]:void 0;return $===void 0?pl(s.default,n.default):w(s,n,$,C,I)}}}function pl(s,n,a){return s!==void 0?s:n!==void 0?n:a!==void 0?a:void 0}function eh(s,n,a,c,f){return pl(typeof a===f?c[a]:void 0,s.default,n.default)}function Jm(s,n,a){if(Fn(a)!=="number")return pl(s.default,n.default);const c=s.stops.length;if(c===1||a<=s.stops[0][0])return s.stops[0][1];if(a>=s.stops[c-1][0])return s.stops[c-1][1];const f=sl(s.stops.map(v=>v[0]),a);return s.stops[f][1]}function ff(s,n,a){const c=s.base!==void 0?s.base:1;if(Fn(a)!=="number")return pl(s.default,n.default);const f=s.stops.length;if(f===1||a<=s.stops[0][0])return s.stops[0][1];if(a>=s.stops[f-1][0])return s.stops[f-1][1];const v=sl(s.stops.map(R=>R[0]),a),b=function(R,L,$,G){const Z=G-$,K=R-$;return Z===0?0:L===1?K/Z:(Math.pow(L,K)-1)/(Math.pow(L,Z)-1)}(a,c,s.stops[v][0],s.stops[v+1][0]),w=s.stops[v][1],C=s.stops[v+1][1],I=ua[n.type]||Ym;return typeof w.evaluate=="function"?{evaluate(...R){const L=w.evaluate.apply(void 0,R),$=C.evaluate.apply(void 0,R);if(L!==void 0&&$!==void 0)return I(L,$,b,s.colorSpace)}}:I(w,C,b,s.colorSpace)}function Qm(s,n,a){switch(n.type){case"color":a=Pn.parse(a);break;case"formatted":a=Ai.fromString(a.toString());break;case"resolvedImage":a=pr.fromString(a.toString());break;case"padding":a=Wi.parse(a);break;default:Fn(a)===n.type||n.type==="enum"&&n.values[a]||(a=void 0)}return pl(a,s.default,n.default)}ea.register(yo,{error:[{kind:"error"},[Et],(s,[n])=>{throw new bi(n.evaluate(s))}],typeof:[Et,[Ot],(s,[n])=>hi(ai(n.evaluate(s)))],"to-rgba":[Or(st,4),[Cn],(s,[n])=>{const[a,c,f,v]=n.evaluate(s).rgb;return[255*a,255*c,255*f,v]}],rgb:[Cn,[st,st,st],lf],rgba:[Cn,[st,st,st,st],lf],has:{type:jt,overloads:[[[Et],(s,[n])=>cf(n.evaluate(s),s.properties())],[[Et,on],(s,[n,a])=>cf(n.evaluate(s),a.evaluate(s))]]},get:{type:Ot,overloads:[[[Et],(s,[n])=>Ju(n.evaluate(s),s.properties())],[[Et,on],(s,[n,a])=>Ju(n.evaluate(s),a.evaluate(s))]]},"feature-state":[Ot,[Et],(s,[n])=>Ju(n.evaluate(s),s.featureState||{})],properties:[on,[],s=>s.properties()],"geometry-type":[Et,[],s=>s.geometryType()],id:[Ot,[],s=>s.id()],zoom:[st,[],s=>s.globals.zoom],"heatmap-density":[st,[],s=>s.globals.heatmapDensity||0],"line-progress":[st,[],s=>s.globals.lineProgress||0],accumulated:[Ot,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[st,Ns(st),(s,n)=>{let a=0;for(const c of n)a+=c.evaluate(s);return a}],"*":[st,Ns(st),(s,n)=>{let a=1;for(const c of n)a*=c.evaluate(s);return a}],"-":{type:st,overloads:[[[st,st],(s,[n,a])=>n.evaluate(s)-a.evaluate(s)],[[st],(s,[n])=>-n.evaluate(s)]]},"/":[st,[st,st],(s,[n,a])=>n.evaluate(s)/a.evaluate(s)],"%":[st,[st,st],(s,[n,a])=>n.evaluate(s)%a.evaluate(s)],ln2:[st,[],()=>Math.LN2],pi:[st,[],()=>Math.PI],e:[st,[],()=>Math.E],"^":[st,[st,st],(s,[n,a])=>Math.pow(n.evaluate(s),a.evaluate(s))],sqrt:[st,[st],(s,[n])=>Math.sqrt(n.evaluate(s))],log10:[st,[st],(s,[n])=>Math.log(n.evaluate(s))/Math.LN10],ln:[st,[st],(s,[n])=>Math.log(n.evaluate(s))],log2:[st,[st],(s,[n])=>Math.log(n.evaluate(s))/Math.LN2],sin:[st,[st],(s,[n])=>Math.sin(n.evaluate(s))],cos:[st,[st],(s,[n])=>Math.cos(n.evaluate(s))],tan:[st,[st],(s,[n])=>Math.tan(n.evaluate(s))],asin:[st,[st],(s,[n])=>Math.asin(n.evaluate(s))],acos:[st,[st],(s,[n])=>Math.acos(n.evaluate(s))],atan:[st,[st],(s,[n])=>Math.atan(n.evaluate(s))],min:[st,Ns(st),(s,n)=>Math.min(...n.map(a=>a.evaluate(s)))],max:[st,Ns(st),(s,n)=>Math.max(...n.map(a=>a.evaluate(s)))],abs:[st,[st],(s,[n])=>Math.abs(n.evaluate(s))],round:[st,[st],(s,[n])=>{const a=n.evaluate(s);return a<0?-Math.round(-a):Math.round(a)}],floor:[st,[st],(s,[n])=>Math.floor(n.evaluate(s))],ceil:[st,[st],(s,[n])=>Math.ceil(n.evaluate(s))],"filter-==":[jt,[Et,Ot],(s,[n,a])=>s.properties()[n.value]===a.value],"filter-id-==":[jt,[Ot],(s,[n])=>s.id()===n.value],"filter-type-==":[jt,[Et],(s,[n])=>s.geometryType()===n.value],"filter-<":[jt,[Et,Ot],(s,[n,a])=>{const c=s.properties()[n.value],f=a.value;return typeof c==typeof f&&c<f}],"filter-id-<":[jt,[Ot],(s,[n])=>{const a=s.id(),c=n.value;return typeof a==typeof c&&a<c}],"filter->":[jt,[Et,Ot],(s,[n,a])=>{const c=s.properties()[n.value],f=a.value;return typeof c==typeof f&&c>f}],"filter-id->":[jt,[Ot],(s,[n])=>{const a=s.id(),c=n.value;return typeof a==typeof c&&a>c}],"filter-<=":[jt,[Et,Ot],(s,[n,a])=>{const c=s.properties()[n.value],f=a.value;return typeof c==typeof f&&c<=f}],"filter-id-<=":[jt,[Ot],(s,[n])=>{const a=s.id(),c=n.value;return typeof a==typeof c&&a<=c}],"filter->=":[jt,[Et,Ot],(s,[n,a])=>{const c=s.properties()[n.value],f=a.value;return typeof c==typeof f&&c>=f}],"filter-id->=":[jt,[Ot],(s,[n])=>{const a=s.id(),c=n.value;return typeof a==typeof c&&a>=c}],"filter-has":[jt,[Ot],(s,[n])=>n.value in s.properties()],"filter-has-id":[jt,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[jt,[Or(Et)],(s,[n])=>n.value.indexOf(s.geometryType())>=0],"filter-id-in":[jt,[Or(Ot)],(s,[n])=>n.value.indexOf(s.id())>=0],"filter-in-small":[jt,[Et,Or(Ot)],(s,[n,a])=>a.value.indexOf(s.properties()[n.value])>=0],"filter-in-large":[jt,[Et,Or(Ot)],(s,[n,a])=>function(c,f,v,b){for(;v<=b;){const w=v+b>>1;if(f[w]===c)return!0;f[w]>c?b=w-1:v=w+1}return!1}(s.properties()[n.value],a.value,0,a.value.length-1)],all:{type:jt,overloads:[[[jt,jt],(s,[n,a])=>n.evaluate(s)&&a.evaluate(s)],[Ns(jt),(s,n)=>{for(const a of n)if(!a.evaluate(s))return!1;return!0}]]},any:{type:jt,overloads:[[[jt,jt],(s,[n,a])=>n.evaluate(s)||a.evaluate(s)],[Ns(jt),(s,n)=>{for(const a of n)if(a.evaluate(s))return!0;return!1}]]},"!":[jt,[jt],(s,[n])=>!n.evaluate(s)],"is-supported-script":[jt,[Et],(s,[n])=>{const a=s.globals&&s.globals.isSupportedScript;return!a||a(n.evaluate(s))}],upcase:[Et,[Et],(s,[n])=>n.evaluate(s).toUpperCase()],downcase:[Et,[Et],(s,[n])=>n.evaluate(s).toLowerCase()],concat:[Et,Ns(Ot),(s,n)=>n.map(a=>nl(a.evaluate(s))).join("")],"resolved-locale":[Et,[ki],(s,[n])=>n.evaluate(s).resolvedLocale()]});class vc{constructor(n,a){var c;this.expression=n,this._warningHistory={},this._evaluator=new si,this._defaultValue=a?(c=a).type==="color"&&yc(c.default)?new Pn(0,0,0,0):c.type==="color"?Pn.parse(c.default)||null:c.type==="padding"?Wi.parse(c.default)||null:c.type==="variableAnchorOffsetCollection"?fr.parse(c.default)||null:c.type==="projectionDefinition"?mr.parse(c.default)||null:c.default===void 0?null:c.default:null,this._enumValues=a&&a.type==="enum"?a.values:null}evaluateWithoutErrorHandling(n,a,c,f,v,b){return this._evaluator.globals=n,this._evaluator.feature=a,this._evaluator.featureState=c,this._evaluator.canonical=f,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=b,this.expression.evaluate(this._evaluator)}evaluate(n,a,c,f,v,b){this._evaluator.globals=n,this._evaluator.feature=a||null,this._evaluator.featureState=c||null,this._evaluator.canonical=f,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=b||null;try{const w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new bi(`Expected value to be one of ${Object.keys(this._enumValues).map(C=>JSON.stringify(C)).join(", ")}, but found ${JSON.stringify(w)} instead.`);return w}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console<"u"&&console.warn(w.message)),this._defaultValue}}}function bc(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in yo}function xc(s,n){const a=new po(yo,mc,[],n?function(f){const v={color:Cn,string:Et,number:st,enum:Et,boolean:jt,formatted:os,padding:qi,projectionDefinition:zn,resolvedImage:Vi,variableAnchorOffsetCollection:ui};return f.type==="array"?Or(v[f.value]||Ot,f.length):v[f.type]}(n):void 0),c=a.parse(s,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return c?uf(new vc(c,n)):vo(a.errors)}class xo{constructor(n,a){this.kind=n,this._styleExpression=a,this.isStateDependent=n!=="constant"&&!fl(a.expression)}evaluateWithoutErrorHandling(n,a,c,f,v,b){return this._styleExpression.evaluateWithoutErrorHandling(n,a,c,f,v,b)}evaluate(n,a,c,f,v,b){return this._styleExpression.evaluate(n,a,c,f,v,b)}}class wc{constructor(n,a,c,f){this.kind=n,this.zoomStops=c,this._styleExpression=a,this.isStateDependent=n!=="camera"&&!fl(a.expression),this.interpolationType=f}evaluateWithoutErrorHandling(n,a,c,f,v,b){return this._styleExpression.evaluateWithoutErrorHandling(n,a,c,f,v,b)}evaluate(n,a,c,f,v,b){return this._styleExpression.evaluate(n,a,c,f,v,b)}interpolationFactor(n,a,c){return this.interpolationType?Jn.interpolationFactor(this.interpolationType,n,a,c):0}}function pf(s,n){const a=xc(s,n);if(a.result==="error")return a;const c=a.value.expression,f=gc(c);if(!f&&!bo(n))return vo([new Tt("","data expressions not supported")]);const v=_c(c,["zoom"]);if(!v&&!hf(n))return vo([new Tt("","zoom expressions not supported")]);const b=Cc(c);return b||v?b instanceof Tt?vo([b]):b instanceof Jn&&!Qu(n)?vo([new Tt("",'"interpolate" expressions cannot be used with this property')]):uf(b?new wc(f?"camera":"composite",a.value,b.labels,b instanceof Jn?b.interpolation:void 0):new xo(f?"constant":"source",a.value)):vo([new Tt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Sc{constructor(n,a){this._parameters=n,this._specification=a,kt(this,df(this._parameters,this._specification))}static deserialize(n){return new Sc(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function Cc(s){let n=null;if(s instanceof Rn)n=Cc(s.result);else if(s instanceof Ls){for(const a of s.args)if(n=Cc(a),n)break}else(s instanceof zs||s instanceof Jn)&&s.input instanceof ea&&s.input.name==="zoom"&&(n=s);return n instanceof Tt||s.eachChild(a=>{const c=Cc(a);c instanceof Tt?n=c:!n&&c?n=new Tt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&c&&n!==c&&(n=new Tt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}function th(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const n of s.slice(1))if(!th(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}const eg={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Tc(s){if(s==null)return{filter:()=>!0,needGeometry:!1};th(s)||(s=Pc(s));const n=xc(s,eg);if(n.result==="error")throw new Error(n.value.map(a=>`${a.key}: ${a.message}`).join(", "));return{filter:(a,c,f)=>n.value.evaluate(a,c,{},f),needGeometry:gf(s)}}function mf(s,n){return s<n?-1:s>n?1:0}function gf(s){if(!Array.isArray(s))return!1;if(s[0]==="within"||s[0]==="distance")return!0;for(let n=1;n<s.length;n++)if(gf(s[n]))return!0;return!1}function Pc(s){if(!s)return!0;const n=s[0];return s.length<=1?n!=="any":n==="=="?kc(s[1],s[2],"=="):n==="!="?ml(kc(s[1],s[2],"==")):n==="<"||n===">"||n==="<="||n===">="?kc(s[1],s[2],n):n==="any"?(a=s.slice(1),["any"].concat(a.map(Pc))):n==="all"?["all"].concat(s.slice(1).map(Pc)):n==="none"?["all"].concat(s.slice(1).map(Pc).map(ml)):n==="in"?nh(s[1],s.slice(2)):n==="!in"?ml(nh(s[1],s.slice(2))):n==="has"?ih(s[1]):n!=="!has"||ml(ih(s[1]));var a}function kc(s,n,a){switch(s){case"$type":return[`filter-type-${a}`,n];case"$id":return[`filter-id-${a}`,n];default:return[`filter-${a}`,s,n]}}function nh(s,n){if(n.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(a=>typeof a!=typeof n[0])?["filter-in-large",s,["literal",n.sort(mf)]]:["filter-in-small",s,["literal",n]]}}function ih(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function ml(s){return["!",s]}function gl(s){const n=typeof s;if(n==="number"||n==="boolean"||n==="string"||s==null)return JSON.stringify(s);if(Array.isArray(s)){let f="[";for(const v of s)f+=`${gl(v)},`;return`${f}]`}const a=Object.keys(s).sort();let c="{";for(let f=0;f<a.length;f++)c+=`${JSON.stringify(a[f])}:${gl(s[a[f]])},`;return`${c}}`}function rh(s){let n="";for(const a of W)n+=`/${gl(s[a])}`;return n}function Ic(s){const n=s.value;return n?[new Be(s.key,n,"constants have been deprecated as of v8")]:[]}function di(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function $s(s){if(Array.isArray(s))return s.map($s);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const n={};for(const a in s)n[a]=$s(s[a]);return n}return di(s)}function ta(s){const n=s.key,a=s.value,c=s.valueSpec||{},f=s.objectElementValidators||{},v=s.style,b=s.styleSpec,w=s.validateSpec;let C=[];const I=Fn(a);if(I!=="object")return[new Be(n,a,`object expected, ${I} found`)];for(const R in a){const L=R.split(".")[0],$=c[L]||c["*"];let G;if(f[L])G=f[L];else if(c[L])G=w;else if(f["*"])G=f["*"];else{if(!c["*"]){C.push(new Be(n,a[R],`unknown property "${R}"`));continue}G=w}C=C.concat(G({key:(n&&`${n}.`)+R,value:a[R],valueSpec:$,style:v,styleSpec:b,object:a,objectKey:R,validateSpec:w},a))}for(const R in c)f[R]||c[R].required&&c[R].default===void 0&&a[R]===void 0&&C.push(new Be(n,a,`missing required property "${R}"`));return C}function ah(s){const n=s.value,a=s.valueSpec,c=s.style,f=s.styleSpec,v=s.key,b=s.arrayElementValidator||s.validateSpec;if(Fn(n)!=="array")return[new Be(v,n,`array expected, ${Fn(n)} found`)];if(a.length&&n.length!==a.length)return[new Be(v,n,`array length ${a.length} expected, length ${n.length} found`)];if(a["min-length"]&&n.length<a["min-length"])return[new Be(v,n,`array length at least ${a["min-length"]} expected, length ${n.length} found`)];let w={type:a.value,values:a.values};f.$version<7&&(w.function=a.function),Fn(a.value)==="object"&&(w=a.value);let C=[];for(let I=0;I<n.length;I++)C=C.concat(b({array:n,arrayIndex:I,value:n[I],valueSpec:w,validateSpec:s.validateSpec,style:c,styleSpec:f,key:`${v}[${I}]`}));return C}function sh(s){const n=s.key,a=s.value,c=s.valueSpec;let f=Fn(a);return f==="number"&&a!=a&&(f="NaN"),f!=="number"?[new Be(n,a,`number expected, ${f} found`)]:"minimum"in c&&a<c.minimum?[new Be(n,a,`${a} is less than the minimum value ${c.minimum}`)]:"maximum"in c&&a>c.maximum?[new Be(n,a,`${a} is greater than the maximum value ${c.maximum}`)]:[]}function _f(s){const n=s.valueSpec,a=di(s.value.type);let c,f,v,b={};const w=a!=="categorical"&&s.value.property===void 0,C=!w,I=Fn(s.value.stops)==="array"&&Fn(s.value.stops[0])==="array"&&Fn(s.value.stops[0][0])==="object",R=ta({key:s.key,value:s.value,valueSpec:s.styleSpec.function,validateSpec:s.validateSpec,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(G){if(a==="identity")return[new Be(G.key,G.value,'identity function may not have a "stops" property')];let Z=[];const K=G.value;return Z=Z.concat(ah({key:G.key,value:K,valueSpec:G.valueSpec,validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec,arrayElementValidator:L})),Fn(K)==="array"&&K.length===0&&Z.push(new Be(G.key,K,"array must have at least one stop")),Z},default:function(G){return G.validateSpec({key:G.key,value:G.value,valueSpec:n,validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec})}}});return a==="identity"&&w&&R.push(new Be(s.key,s.value,'missing required property "property"')),a==="identity"||s.value.stops||R.push(new Be(s.key,s.value,'missing required property "stops"')),a==="exponential"&&s.valueSpec.expression&&!Qu(s.valueSpec)&&R.push(new Be(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(C&&!bo(s.valueSpec)?R.push(new Be(s.key,s.value,"property functions not supported")):w&&!hf(s.valueSpec)&&R.push(new Be(s.key,s.value,"zoom functions not supported"))),a!=="categorical"&&!I||s.value.property!==void 0||R.push(new Be(s.key,s.value,'"property" property is required')),R;function L(G){let Z=[];const K=G.value,ie=G.key;if(Fn(K)!=="array")return[new Be(ie,K,`array expected, ${Fn(K)} found`)];if(K.length!==2)return[new Be(ie,K,`array length 2 expected, length ${K.length} found`)];if(I){if(Fn(K[0])!=="object")return[new Be(ie,K,`object expected, ${Fn(K[0])} found`)];if(K[0].zoom===void 0)return[new Be(ie,K,"object stop key must have zoom")];if(K[0].value===void 0)return[new Be(ie,K,"object stop key must have value")];if(v&&v>di(K[0].zoom))return[new Be(ie,K[0].zoom,"stop zoom values must appear in ascending order")];di(K[0].zoom)!==v&&(v=di(K[0].zoom),f=void 0,b={}),Z=Z.concat(ta({key:`${ie}[0]`,value:K[0],valueSpec:{zoom:{}},validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec,objectElementValidators:{zoom:sh,value:$}}))}else Z=Z.concat($({key:`${ie}[0]`,value:K[0],valueSpec:{},validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec},K));return bc($s(K[1]))?Z.concat([new Be(`${ie}[1]`,K[1],"expressions are not allowed in function stops.")]):Z.concat(G.validateSpec({key:`${ie}[1]`,value:K[1],valueSpec:n,validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec}))}function $(G,Z){const K=Fn(G.value),ie=di(G.value),he=G.value!==null?G.value:Z;if(c){if(K!==c)return[new Be(G.key,he,`${K} stop domain type must match previous stop domain type ${c}`)]}else c=K;if(K!=="number"&&K!=="string"&&K!=="boolean")return[new Be(G.key,he,"stop domain value must be a number, string, or boolean")];if(K!=="number"&&a!=="categorical"){let ze=`number expected, ${K} found`;return bo(n)&&a===void 0&&(ze+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Be(G.key,he,ze)]}return a!=="categorical"||K!=="number"||isFinite(ie)&&Math.floor(ie)===ie?a!=="categorical"&&K==="number"&&f!==void 0&&ie<f?[new Be(G.key,he,"stop domain values must appear in ascending order")]:(f=ie,a==="categorical"&&ie in b?[new Be(G.key,he,"stop domain values must be unique")]:(b[ie]=!0,[])):[new Be(G.key,he,`integer expected, found ${ie}`)]}}function wo(s){const n=(s.expressionContext==="property"?pf:xc)($s(s.value),s.valueSpec);if(n.result==="error")return n.value.map(c=>new Be(`${s.key}${c.key}`,s.value,c.message));const a=n.value.expression||n.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!a.outputDefined())return[new Be(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!fl(a))return[new Be(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter"&&!fl(a))return[new Be(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!_c(a,["zoom","feature-state"]))return[new Be(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!gc(a))return[new Be(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function So(s){const n=s.key,a=s.value,c=s.valueSpec,f=[];return Array.isArray(c.values)?c.values.indexOf(di(a))===-1&&f.push(new Be(n,a,`expected one of [${c.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(c.values).indexOf(di(a))===-1&&f.push(new Be(n,a,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(a)} found`)),f}function Mc(s){return th($s(s.value))?wo(kt({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):_l(s)}function _l(s){const n=s.value,a=s.key;if(Fn(n)!=="array")return[new Be(a,n,`array expected, ${Fn(n)} found`)];const c=s.styleSpec;let f,v=[];if(n.length<1)return[new Be(a,n,"filter array must have at least 1 element")];switch(v=v.concat(So({key:`${a}[0]`,value:n[0],valueSpec:c.filter_operator,style:s.style,styleSpec:s.styleSpec})),di(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&di(n[1])==="$type"&&v.push(new Be(a,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&v.push(new Be(a,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(f=Fn(n[1]),f!=="string"&&v.push(new Be(`${a}[1]`,n[1],`string expected, ${f} found`)));for(let b=2;b<n.length;b++)f=Fn(n[b]),di(n[1])==="$type"?v=v.concat(So({key:`${a}[${b}]`,value:n[b],valueSpec:c.geometry_type,style:s.style,styleSpec:s.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&v.push(new Be(`${a}[${b}]`,n[b],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let b=1;b<n.length;b++)v=v.concat(_l({key:`${a}[${b}]`,value:n[b],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":f=Fn(n[1]),n.length!==2?v.push(new Be(a,n,`filter array for "${n[0]}" operator must have 2 elements`)):f!=="string"&&v.push(new Be(`${a}[1]`,n[1],`string expected, ${f} found`))}return v}function yf(s,n){const a=s.key,c=s.validateSpec,f=s.style,v=s.styleSpec,b=s.value,w=s.objectKey,C=v[`${n}_${s.layerType}`];if(!C)return[];const I=w.match(/^(.*)-transition$/);if(n==="paint"&&I&&C[I[1]]&&C[I[1]].transition)return c({key:a,value:b,valueSpec:v.transition,style:f,styleSpec:v});const R=s.valueSpec||C[w];if(!R)return[new Be(a,b,`unknown property "${w}"`)];let L;if(Fn(b)==="string"&&bo(R)&&!R.tokens&&(L=/^{([^}]+)}$/.exec(b)))return[new Be(a,b,`"${w}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(L[1])} }\`.`)];const $=[];return s.layerType==="symbol"&&(w==="text-field"&&f&&!f.glyphs&&$.push(new Be(a,b,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&yc($s(b))&&di(b.type)==="identity"&&$.push(new Be(a,b,'"text-font" does not support identity functions'))),$.concat(c({key:s.key,value:b,valueSpec:R,style:f,styleSpec:v,expressionContext:"property",propertyType:n,propertyKey:w}))}function oh(s){return yf(s,"paint")}function lh(s){return yf(s,"layout")}function vf(s){let n=[];const a=s.value,c=s.key,f=s.style,v=s.styleSpec;a.type||a.ref||n.push(new Be(c,a,'either "type" or "ref" is required'));let b=di(a.type);const w=di(a.ref);if(a.id){const C=di(a.id);for(let I=0;I<s.arrayIndex;I++){const R=f.layers[I];di(R.id)===C&&n.push(new Be(c,a.id,`duplicate layer id "${a.id}", previously used at line ${R.id.__line__}`))}}if("ref"in a){let C;["type","source","source-layer","filter","layout"].forEach(I=>{I in a&&n.push(new Be(c,a[I],`"${I}" is prohibited for ref layers`))}),f.layers.forEach(I=>{di(I.id)===w&&(C=I)}),C?C.ref?n.push(new Be(c,a.ref,"ref cannot reference another ref layer")):b=di(C.type):n.push(new Be(c,a.ref,`ref layer "${w}" not found`))}else if(b!=="background")if(a.source){const C=f.sources&&f.sources[a.source],I=C&&di(C.type);C?I==="vector"&&b==="raster"?n.push(new Be(c,a.source,`layer "${a.id}" requires a raster source`)):I!=="raster-dem"&&b==="hillshade"?n.push(new Be(c,a.source,`layer "${a.id}" requires a raster-dem source`)):I==="raster"&&b!=="raster"?n.push(new Be(c,a.source,`layer "${a.id}" requires a vector source`)):I!=="vector"||a["source-layer"]?I==="raster-dem"&&b!=="hillshade"?n.push(new Be(c,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):b!=="line"||!a.paint||!a.paint["line-gradient"]||I==="geojson"&&C.lineMetrics||n.push(new Be(c,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new Be(c,a,`layer "${a.id}" must specify a "source-layer"`)):n.push(new Be(c,a.source,`source "${a.source}" not found`))}else n.push(new Be(c,a,'missing required property "source"'));return n=n.concat(ta({key:c,value:a,valueSpec:v.layer,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,objectElementValidators:{"*":()=>[],type:()=>s.validateSpec({key:`${c}.type`,value:a.type,valueSpec:v.layer.type,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,object:a,objectKey:"type"}),filter:Mc,layout:C=>ta({layer:a,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,objectElementValidators:{"*":I=>lh(kt({layerType:b},I))}}),paint:C=>ta({layer:a,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,objectElementValidators:{"*":I=>oh(kt({layerType:b},I))}})}})),n}function us(s){const n=s.value,a=s.key,c=Fn(n);return c!=="string"?[new Be(a,n,`string expected, ${c} found`)]:[]}const ch={promoteId:function({key:s,value:n}){if(Fn(n)==="string")return us({key:s,value:n});{const a=[];for(const c in n)a.push(...us({key:`${s}.${c}`,value:n[c]}));return a}}};function Co(s){const n=s.value,a=s.key,c=s.styleSpec,f=s.style,v=s.validateSpec;if(!n.type)return[new Be(a,n,'"type" is required')];const b=di(n.type);let w;switch(b){case"vector":case"raster":return w=ta({key:a,value:n,valueSpec:c[`source_${b.replace("-","_")}`],style:s.style,styleSpec:c,objectElementValidators:ch,validateSpec:v}),w;case"raster-dem":return w=function(C){var I;const R=(I=C.sourceName)!==null&&I!==void 0?I:"",L=C.value,$=C.styleSpec,G=$.source_raster_dem,Z=C.style;let K=[];const ie=Fn(L);if(L===void 0)return K;if(ie!=="object")return K.push(new Be("source_raster_dem",L,`object expected, ${ie} found`)),K;const he=di(L.encoding)==="custom",ze=["redFactor","greenFactor","blueFactor","baseShift"],ge=C.value.encoding?`"${C.value.encoding}"`:"Default";for(const U in L)!he&&ze.includes(U)?K.push(new Be(U,L[U],`In "${R}": "${U}" is only valid when "encoding" is set to "custom". ${ge} encoding found`)):G[U]?K=K.concat(C.validateSpec({key:U,value:L[U],valueSpec:G[U],validateSpec:C.validateSpec,style:Z,styleSpec:$})):K.push(new Be(U,L[U],`unknown property "${U}"`));return K}({sourceName:a,value:n,style:s.style,styleSpec:c,validateSpec:v}),w;case"geojson":if(w=ta({key:a,value:n,valueSpec:c.source_geojson,style:f,styleSpec:c,validateSpec:v,objectElementValidators:ch}),n.cluster)for(const C in n.clusterProperties){const[I,R]=n.clusterProperties[C],L=typeof I=="string"?[I,["accumulated"],["get",C]]:I;w.push(...wo({key:`${a}.${C}.map`,value:R,validateSpec:v,expressionContext:"cluster-map"})),w.push(...wo({key:`${a}.${C}.reduce`,value:L,validateSpec:v,expressionContext:"cluster-reduce"}))}return w;case"video":return ta({key:a,value:n,valueSpec:c.source_video,style:f,validateSpec:v,styleSpec:c});case"image":return ta({key:a,value:n,valueSpec:c.source_image,style:f,validateSpec:v,styleSpec:c});case"canvas":return[new Be(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return So({key:`${a}.type`,value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,validateSpec:v,styleSpec:c})}}function bf(s){const n=s.value,a=s.styleSpec,c=a.light,f=s.style;let v=[];const b=Fn(n);if(n===void 0)return v;if(b!=="object")return v=v.concat([new Be("light",n,`object expected, ${b} found`)]),v;for(const w in n){const C=w.match(/^(.*)-transition$/);v=v.concat(C&&c[C[1]]&&c[C[1]].transition?s.validateSpec({key:w,value:n[w],valueSpec:a.transition,validateSpec:s.validateSpec,style:f,styleSpec:a}):c[w]?s.validateSpec({key:w,value:n[w],valueSpec:c[w],validateSpec:s.validateSpec,style:f,styleSpec:a}):[new Be(w,n[w],`unknown property "${w}"`)])}return v}function xf(s){const n=s.value,a=s.styleSpec,c=a.sky,f=s.style,v=Fn(n);if(n===void 0)return[];if(v!=="object")return[new Be("sky",n,`object expected, ${v} found`)];let b=[];for(const w in n)b=b.concat(c[w]?s.validateSpec({key:w,value:n[w],valueSpec:c[w],style:f,styleSpec:a}):[new Be(w,n[w],`unknown property "${w}"`)]);return b}function wf(s){const n=s.value,a=s.styleSpec,c=a.terrain,f=s.style;let v=[];const b=Fn(n);if(n===void 0)return v;if(b!=="object")return v=v.concat([new Be("terrain",n,`object expected, ${b} found`)]),v;for(const w in n)v=v.concat(c[w]?s.validateSpec({key:w,value:n[w],valueSpec:c[w],validateSpec:s.validateSpec,style:f,styleSpec:a}):[new Be(w,n[w],`unknown property "${w}"`)]);return v}function Sf(s){let n=[];const a=s.value,c=s.key;if(Array.isArray(a)){const f=[],v=[];for(const b in a)a[b].id&&f.includes(a[b].id)&&n.push(new Be(c,a,`all the sprites' ids must be unique, but ${a[b].id} is duplicated`)),f.push(a[b].id),a[b].url&&v.includes(a[b].url)&&n.push(new Be(c,a,`all the sprites' URLs must be unique, but ${a[b].url} is duplicated`)),v.push(a[b].url),n=n.concat(ta({key:`${c}[${b}]`,value:a[b],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:s.validateSpec}));return n}return us({key:c,value:a})}const Cf={"*":()=>[],array:ah,boolean:function(s){const n=s.value,a=s.key,c=Fn(n);return c!=="boolean"?[new Be(a,n,`boolean expected, ${c} found`)]:[]},number:sh,color:function(s){const n=s.key,a=s.value,c=Fn(a);return c!=="string"?[new Be(n,a,`color expected, ${c} found`)]:Pn.parse(String(a))?[]:[new Be(n,a,`color expected, "${a}" found`)]},constants:Ic,enum:So,filter:Mc,function:_f,layer:vf,object:ta,source:Co,light:bf,sky:xf,terrain:wf,projection:function(s){const n=s.value,a=s.styleSpec,c=a.projection,f=s.style,v=Fn(n);if(n===void 0)return[];if(v!=="object")return[new Be("projection",n,`object expected, ${v} found`)];let b=[];for(const w in n)b=b.concat(c[w]?s.validateSpec({key:w,value:n[w],valueSpec:c[w],style:f,styleSpec:a}):[new Be(w,n[w],`unknown property "${w}"`)]);return b},projectionDefinition:function(s){const n=s.key;let a=s.value;a=a instanceof String?a.valueOf():a;const c=Fn(a);return c!=="array"||function(f){return Array.isArray(f)&&f.length===3&&typeof f[0]=="string"&&typeof f[1]=="string"&&typeof f[2]=="number"}(a)||function(f){return!!["interpolate","step","literal"].includes(f[0])}(a)?["array","string"].includes(c)?[]:[new Be(n,a,`projection expected, invalid type "${c}" found`)]:[new Be(n,a,`projection expected, invalid array ${JSON.stringify(a)} found`)]},string:us,formatted:function(s){return us(s).length===0?[]:wo(s)},resolvedImage:function(s){return us(s).length===0?[]:wo(s)},padding:function(s){const n=s.key,a=s.value;if(Fn(a)==="array"){if(a.length<1||a.length>4)return[new Be(n,a,`padding requires 1 to 4 values; ${a.length} values found`)];const c={type:"number"};let f=[];for(let v=0;v<a.length;v++)f=f.concat(s.validateSpec({key:`${n}[${v}]`,value:a[v],validateSpec:s.validateSpec,valueSpec:c}));return f}return sh({key:n,value:a,valueSpec:{}})},variableAnchorOffsetCollection:function(s){const n=s.key,a=s.value,c=Fn(a),f=s.styleSpec;if(c!=="array"||a.length<1||a.length%2!=0)return[new Be(n,a,"variableAnchorOffsetCollection requires a non-empty array of even length")];let v=[];for(let b=0;b<a.length;b+=2)v=v.concat(So({key:`${n}[${b}]`,value:a[b],valueSpec:f.layout_symbol["text-anchor"]})),v=v.concat(ah({key:`${n}[${b+1}]`,value:a[b+1],valueSpec:{length:2,value:"number"},validateSpec:s.validateSpec,style:s.style,styleSpec:f}));return v},sprite:Sf};function yl(s){const n=s.value,a=s.valueSpec,c=s.styleSpec;return s.validateSpec=yl,a.expression&&yc(di(n))?_f(s):a.expression&&bc($s(n))?wo(s):a.type&&Cf[a.type]?Cf[a.type](s):ta(kt({},s,{valueSpec:a.type?c[a.type]:a}))}function To(s){const n=s.value,a=s.key,c=us(s);return c.length||(n.indexOf("{fontstack}")===-1&&c.push(new Be(a,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&c.push(new Be(a,n,'"glyphs" url must include a "{range}" token'))),c}function xr(s,n=ae){let a=[];return a=a.concat(yl({key:"",value:s,valueSpec:n.$root,styleSpec:n,style:s,validateSpec:yl,objectElementValidators:{glyphs:To,"*":()=>[]}})),s.constants&&(a=a.concat(Ic({key:"constants",value:s.constants,style:s,styleSpec:n,validateSpec:yl}))),Po(a)}function Ri(s){return function(n){return s({...n,validateSpec:yl})}}function Po(s){return[].concat(s).sort((n,a)=>n.line-a.line)}function ha(s){return function(...n){return Po(s.apply(this,n))}}xr.source=ha(Ri(Co)),xr.sprite=ha(Ri(Sf)),xr.glyphs=ha(Ri(To)),xr.light=ha(Ri(bf)),xr.sky=ha(Ri(xf)),xr.terrain=ha(Ri(wf)),xr.layer=ha(Ri(vf)),xr.filter=ha(Ri(Mc)),xr.paintProperty=ha(Ri(oh)),xr.layoutProperty=ha(Ri(lh));const ko=xr,tg=ko.light,vl=ko.sky,Tf=ko.paintProperty,uh=ko.layoutProperty;function Pf(s,n){let a=!1;if(n&&n.length)for(const c of n)s.fire(new Zi(new Error(c.message))),a=!0;return a}class js{constructor(n,a,c){const f=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;const b=new Int32Array(this.arrayBuffer);n=b[0],this.d=(a=b[1])+2*(c=b[2]);for(let C=0;C<this.d*this.d;C++){const I=b[3+C],R=b[3+C+1];f.push(I===R?null:b.subarray(I,R))}const w=b[3+f.length+1];this.keys=b.subarray(b[3+f.length],w),this.bboxes=b.subarray(w),this.insert=this._insertReadonly}else{this.d=a+2*c;for(let b=0;b<this.d*this.d;b++)f.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=n,this.padding=c,this.scale=a/n,this.uid=0;const v=c/a*n;this.min=-v,this.max=n+v}insert(n,a,c,f,v){this._forEachCell(a,c,f,v,this._insertCell,this.uid++,void 0,void 0),this.keys.push(n),this.bboxes.push(a),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(v)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(n,a,c,f,v,b){this.cells[v].push(b)}query(n,a,c,f,v){const b=this.min,w=this.max;if(n<=b&&a<=b&&w<=c&&w<=f&&!v)return Array.prototype.slice.call(this.keys);{const C=[];return this._forEachCell(n,a,c,f,this._queryCell,C,{},v),C}}_queryCell(n,a,c,f,v,b,w,C){const I=this.cells[v];if(I!==null){const R=this.keys,L=this.bboxes;for(let $=0;$<I.length;$++){const G=I[$];if(w[G]===void 0){const Z=4*G;(C?C(L[Z+0],L[Z+1],L[Z+2],L[Z+3]):n<=L[Z+2]&&a<=L[Z+3]&&c>=L[Z+0]&&f>=L[Z+1])?(w[G]=!0,b.push(R[G])):w[G]=!1}}}}_forEachCell(n,a,c,f,v,b,w,C){const I=this._convertToCellCoord(n),R=this._convertToCellCoord(a),L=this._convertToCellCoord(c),$=this._convertToCellCoord(f);for(let G=I;G<=L;G++)for(let Z=R;Z<=$;Z++){const K=this.d*Z+G;if((!C||C(this._convertFromCellCoord(G),this._convertFromCellCoord(Z),this._convertFromCellCoord(G+1),this._convertFromCellCoord(Z+1)))&&v.call(this,n,a,c,f,K,b,w,C))return}}_convertFromCellCoord(n){return(n-this.padding)/this.scale}_convertToCellCoord(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const n=this.cells,a=3+this.cells.length+1+1;let c=0;for(let b=0;b<this.cells.length;b++)c+=this.cells[b].length;const f=new Int32Array(a+c+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;let v=a;for(let b=0;b<n.length;b++){const w=n[b];f[3+b]=v,f.set(w,v),v+=w.length}return f[3+n.length]=v,f.set(this.keys,v),v+=this.keys.length,f[3+n.length+1]=v,f.set(this.bboxes,v),v+=this.bboxes.length,f.buffer}static serialize(n,a){const c=n.toArrayBuffer();return a&&a.push(c),{buffer:c}}static deserialize(n){return new js(n.buffer)}}const Ha={};function Bt(s,n,a={}){if(Ha[s])throw new Error(`${s} is already registered.`);Object.defineProperty(n,"_classRegistryKey",{value:s,writeable:!1}),Ha[s]={klass:n,omit:a.omit||[],shallow:a.shallow||[]}}Bt("Object",Object),Bt("TransferableGridIndex",js),Bt("Color",Pn),Bt("Error",Error),Bt("AJAXError",un),Bt("ResolvedImage",pr),Bt("StylePropertyFunction",Sc),Bt("StyleExpression",vc,{omit:["_evaluator"]}),Bt("ZoomDependentExpression",wc),Bt("ZoomConstantExpression",xo),Bt("CompoundExpression",ea,{omit:["_evaluate"]});for(const s in yo)yo[s]._classRegistryKey||Bt(`Expression_${s}`,yo[s]);function kf(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function Us(s){return s.$name||s.constructor._classRegistryKey}function If(s){return!function(n){if(n===null||typeof n!="object")return!1;const a=Us(n);return!(!a||a==="Object")}(s)&&(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob||s instanceof Error||kf(s)||ot(s)||ArrayBuffer.isView(s)||s instanceof ImageData)}function bl(s,n){if(If(s))return(kf(s)||ot(s))&&n&&n.push(s),ArrayBuffer.isView(s)&&n&&n.push(s.buffer),s instanceof ImageData&&n&&n.push(s.data.buffer),s;if(Array.isArray(s)){const v=[];for(const b of s)v.push(bl(b,n));return v}if(typeof s!="object")throw new Error("can't serialize object of type "+typeof s);const a=Us(s);if(!a)throw new Error(`can't serialize object of unregistered class ${s.constructor.name}`);if(!Ha[a])throw new Error(`${a} is not registered.`);const{klass:c}=Ha[a],f=c.serialize?c.serialize(s,n):{};if(c.serialize){if(n&&f===n[n.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const v in s){if(!s.hasOwnProperty(v)||Ha[a].omit.indexOf(v)>=0)continue;const b=s[v];f[v]=Ha[a].shallow.indexOf(v)>=0?b:bl(b,n)}s instanceof Error&&(f.message=s.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(f.$name=a),f}function hs(s){if(If(s))return s;if(Array.isArray(s))return s.map(hs);if(typeof s!="object")throw new Error("can't deserialize object of type "+typeof s);const n=Us(s)||"Object";if(!Ha[n])throw new Error(`can't deserialize unregistered class ${n}`);const{klass:a}=Ha[n];if(!a)throw new Error(`can't deserialize unregistered class ${n}`);if(a.deserialize)return a.deserialize(s);const c=Object.create(a.prototype);for(const f of Object.keys(s)){if(f==="$name")continue;const v=s[f];c[f]=Ha[n].shallow.indexOf(f)>=0?v:hs(v)}return c}class Mf{constructor(){this.first=!0}update(n,a){const c=Math.floor(n);return this.first?(this.first=!1,this.lastIntegerZoom=c,this.lastIntegerZoomTime=0,this.lastZoom=n,this.lastFloorZoom=c,!0):(this.lastFloorZoom>c?(this.lastIntegerZoom=c+1,this.lastIntegerZoomTime=a):this.lastFloorZoom<c&&(this.lastIntegerZoom=c,this.lastIntegerZoomTime=a),n!==this.lastZoom&&(this.lastZoom=n,this.lastFloorZoom=c,!0))}}const kn={"Latin-1 Supplement":s=>s>=128&&s<=255,"Hangul Jamo":s=>s>=4352&&s<=4607,Khmer:s=>s>=6016&&s<=6143,"General Punctuation":s=>s>=8192&&s<=8303,"Letterlike Symbols":s=>s>=8448&&s<=8527,"Number Forms":s=>s>=8528&&s<=8591,"Miscellaneous Technical":s=>s>=8960&&s<=9215,"Control Pictures":s=>s>=9216&&s<=9279,"Optical Character Recognition":s=>s>=9280&&s<=9311,"Enclosed Alphanumerics":s=>s>=9312&&s<=9471,"Geometric Shapes":s=>s>=9632&&s<=9727,"Miscellaneous Symbols":s=>s>=9728&&s<=9983,"Miscellaneous Symbols and Arrows":s=>s>=11008&&s<=11263,"Ideographic Description Characters":s=>s>=12272&&s<=12287,"CJK Symbols and Punctuation":s=>s>=12288&&s<=12351,Katakana:s=>s>=12448&&s<=12543,Kanbun:s=>s>=12688&&s<=12703,"CJK Strokes":s=>s>=12736&&s<=12783,"Enclosed CJK Letters and Months":s=>s>=12800&&s<=13055,"CJK Compatibility":s=>s>=13056&&s<=13311,"Yijing Hexagram Symbols":s=>s>=19904&&s<=19967,"Private Use Area":s=>s>=57344&&s<=63743,"Vertical Forms":s=>s>=65040&&s<=65055,"CJK Compatibility Forms":s=>s>=65072&&s<=65103,"Small Form Variants":s=>s>=65104&&s<=65135,"Halfwidth and Fullwidth Forms":s=>s>=65280&&s<=65519};function Io(s){for(const n of s)if(Rc(n.charCodeAt(0)))return!0;return!1}function Ef(s){for(const n of s)if(!Rf(n.charCodeAt(0)))return!1;return!0}function Ec(s){const n=s.map(a=>{try{return new RegExp(`\\p{sc=${a}}`,"u").source}catch{return null}}).filter(a=>a);return new RegExp(n.join("|"),"u")}const Af=Ec(["Arab","Dupl","Mong","Ougr","Syrc"]);function Rf(s){return!Af.test(String.fromCodePoint(s))}const Ac=Ec(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Rc(s){return!(s!==746&&s!==747&&(s<4352||!(kn["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||kn["CJK Compatibility"](s)||kn["CJK Strokes"](s)||!(!kn["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||kn["Enclosed CJK Letters and Months"](s)||kn["Ideographic Description Characters"](s)||kn.Kanbun(s)||kn.Katakana(s)&&s!==12540||!(!kn["Halfwidth and Fullwidth Forms"](s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!kn["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||kn["Vertical Forms"](s)||kn["Yijing Hexagram Symbols"](s)||/\p{sc=Cans}/u.test(String.fromCodePoint(s))||/\p{sc=Hang}/u.test(String.fromCodePoint(s))||Ac.test(String.fromCodePoint(s)))))}function Df(s){return!(Rc(s)||function(n){return!!(kn["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||kn["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||kn["Letterlike Symbols"](n)||kn["Number Forms"](n)||kn["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||kn["Control Pictures"](n)&&n!==9251||kn["Optical Character Recognition"](n)||kn["Enclosed Alphanumerics"](n)||kn["Geometric Shapes"](n)||kn["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||kn["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||kn["CJK Symbols and Punctuation"](n)||kn.Katakana(n)||kn["Private Use Area"](n)||kn["CJK Compatibility Forms"](n)||kn["Small Form Variants"](n)||kn["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(s))}const zf=Ec(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Lf(s){return zf.test(String.fromCodePoint(s))}function Bf(s,n){return!(!n&&Lf(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||kn.Khmer(s))}function Ff(s){for(const n of s)if(Lf(n.charCodeAt(0)))return!0;return!1}const Za=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(s){this.pluginStatus=s.pluginStatus,this.pluginURL=s.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(s){if(Za.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=s.applyArabicShaping,this.processBidirectionalText=s.processBidirectionalText,this.processStyledBidirectionalText=s.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(s,n){return o(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(s.pluginStatus!=="loading")return this.setState(s),s;const a=s.pluginURL,c=new Promise(v=>{this.loadScriptResolve=v});n(a);const f=new Promise(v=>setTimeout(()=>v(),this.TIMEOUT));if(yield Promise.race([c,f]),this.isParsed()){const v={pluginStatus:"loaded",pluginURL:a};return this.setState(v),v}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${a}`)})}};class fi{constructor(n,a){this.zoom=n,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.zoomHistory=a.zoomHistory,this.transition=a.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Mf,this.transition={})}isSupportedScript(n){return function(a,c){for(const f of a)if(!Bf(f.charCodeAt(0),c))return!1;return!0}(n,Za.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const n=this.zoom,a=n-Math.floor(n),c=this.crossFadingFactor();return n>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:a+(1-a)*c}:{fromScale:.5,toScale:1,t:1-(1-c)*a}}}class Dc{constructor(n,a){this.property=n,this.value=a,this.expression=function(c,f){if(yc(c))return new Sc(c,f);if(bc(c)){const v=pf(c,f);if(v.result==="error")throw new Error(v.value.map(b=>`${b.key}: ${b.message}`).join(", "));return v.value}{let v=c;return f.type==="color"&&typeof c=="string"?v=Pn.parse(c):f.type!=="padding"||typeof c!="number"&&!Array.isArray(c)?f.type==="variableAnchorOffsetCollection"&&Array.isArray(c)?v=fr.parse(c):f.type==="projectionDefinition"&&typeof c=="string"&&(v=mr.parse(c)):v=Wi.parse(c),{kind:"constant",evaluate:()=>v}}}(a===void 0?n.specification.default:a,n.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,a,c){return this.property.possiblyEvaluate(this,n,a,c)}}class zc{constructor(n){this.property=n,this.value=new Dc(n,void 0)}transitioned(n,a){return new dh(this.property,this.value,a,Kt({},n.transition,this.transition),n.now)}untransitioned(){return new dh(this.property,this.value,null,{},0)}}class hh{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues)}getValue(n){return Vn(this._values[n].value.value)}setValue(n,a){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new zc(this._values[n].property)),this._values[n].value=new Dc(this._values[n].property,a===null?void 0:Vn(a))}getTransition(n){return Vn(this._values[n].transition)}setTransition(n,a){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new zc(this._values[n].property)),this._values[n].transition=Vn(a)||void 0}serialize(){const n={};for(const a of Object.keys(this._values)){const c=this.getValue(a);c!==void 0&&(n[a]=c);const f=this.getTransition(a);f!==void 0&&(n[`${a}-transition`]=f)}return n}transitioned(n,a){const c=new fh(this._properties);for(const f of Object.keys(this._values))c._values[f]=this._values[f].transitioned(n,a._values[f]);return c}untransitioned(){const n=new fh(this._properties);for(const a of Object.keys(this._values))n._values[a]=this._values[a].untransitioned();return n}}class dh{constructor(n,a,c,f,v){this.property=n,this.value=a,this.begin=v+f.delay||0,this.end=this.begin+f.duration||0,n.specification.transition&&(f.delay||f.duration)&&(this.prior=c)}possiblyEvaluate(n,a,c){const f=n.now||0,v=this.value.possiblyEvaluate(n,a,c),b=this.prior;if(b){if(f>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(f<this.begin)return b.possiblyEvaluate(n,a,c);{const w=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(n,a,c),v,Qe(w))}}return v}}class fh{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,a,c){const f=new Mo(this._properties);for(const v of Object.keys(this._values))f._values[v]=this._values[v].possiblyEvaluate(n,a,c);return f}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class Lc{constructor(n){this._properties=n,this._values=Object.create(n.defaultPropertyValues)}hasValue(n){return this._values[n].value!==void 0}getValue(n){return Vn(this._values[n].value)}setValue(n,a){this._values[n]=new Dc(this._values[n].property,a===null?void 0:Vn(a))}serialize(){const n={};for(const a of Object.keys(this._values)){const c=this.getValue(a);c!==void 0&&(n[a]=c)}return n}possiblyEvaluate(n,a,c){const f=new Mo(this._properties);for(const v of Object.keys(this._values))f._values[v]=this._values[v].possiblyEvaluate(n,a,c);return f}}class Ia{constructor(n,a,c){this.property=n,this.value=a,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,a,c,f){return this.property.evaluate(this.value,this.parameters,n,a,c,f)}}class Mo{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class Ht{constructor(n){this.specification=n}possiblyEvaluate(n,a){if(n.isDataDriven())throw new Error("Value should not be data driven");return n.expression.evaluate(a)}interpolate(n,a,c){const f=ua[this.specification.type];return f?f(n,a,c):n}}class rn{constructor(n,a){this.specification=n,this.overrides=a}possiblyEvaluate(n,a,c,f){return new Ia(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(a,null,{},c,f)}:n.expression,a)}interpolate(n,a,c){if(n.value.kind!=="constant"||a.value.kind!=="constant")return n;if(n.value.value===void 0||a.value.value===void 0)return new Ia(this,{kind:"constant",value:void 0},n.parameters);const f=ua[this.specification.type];if(f){const v=f(n.value.value,a.value.value,c);return new Ia(this,{kind:"constant",value:v},n.parameters)}return n}evaluate(n,a,c,f,v,b){return n.kind==="constant"?n.value:n.evaluate(a,c,f,v,b)}}class xl extends rn{possiblyEvaluate(n,a,c,f){if(n.value===void 0)return new Ia(this,{kind:"constant",value:void 0},a);if(n.expression.kind==="constant"){const v=n.expression.evaluate(a,null,{},c,f),b=n.property.specification.type==="resolvedImage"&&typeof v!="string"?v.name:v,w=this._calculate(b,b,b,a);return new Ia(this,{kind:"constant",value:w},a)}if(n.expression.kind==="camera"){const v=this._calculate(n.expression.evaluate({zoom:a.zoom-1}),n.expression.evaluate({zoom:a.zoom}),n.expression.evaluate({zoom:a.zoom+1}),a);return new Ia(this,{kind:"constant",value:v},a)}return new Ia(this,n.expression,a)}evaluate(n,a,c,f,v,b){if(n.kind==="source"){const w=n.evaluate(a,c,f,v,b);return this._calculate(w,w,w,a)}return n.kind==="composite"?this._calculate(n.evaluate({zoom:Math.floor(a.zoom)-1},c,f),n.evaluate({zoom:Math.floor(a.zoom)},c,f),n.evaluate({zoom:Math.floor(a.zoom)+1},c,f),a):n.value}_calculate(n,a,c,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:n,to:a}:{from:c,to:a}}interpolate(n){return n}}class Bc{constructor(n){this.specification=n}possiblyEvaluate(n,a,c,f){if(n.value!==void 0){if(n.expression.kind==="constant"){const v=n.expression.evaluate(a,null,{},c,f);return this._calculate(v,v,v,a)}return this._calculate(n.expression.evaluate(new fi(Math.floor(a.zoom-1),a)),n.expression.evaluate(new fi(Math.floor(a.zoom),a)),n.expression.evaluate(new fi(Math.floor(a.zoom+1),a)),a)}}_calculate(n,a,c,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:n,to:a}:{from:c,to:a}}interpolate(n){return n}}class Fc{constructor(n){this.specification=n}possiblyEvaluate(n,a,c,f){return!!n.expression.evaluate(a,null,{},c,f)}interpolate(){return!1}}class Er{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const a in n){const c=n[a];c.specification.overridable&&this.overridableProperties.push(a);const f=this.defaultPropertyValues[a]=new Dc(c,void 0),v=this.defaultTransitionablePropertyValues[a]=new zc(c);this.defaultTransitioningPropertyValues[a]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=f.possiblyEvaluate({})}}}Bt("DataDrivenProperty",rn),Bt("DataConstantProperty",Ht),Bt("CrossFadedDataDrivenProperty",xl),Bt("CrossFadedProperty",Bc),Bt("ColorRampProperty",Fc);const Of="-transition";class Ma extends Mr{constructor(n,a){if(super(),this.id=n.id,this.type=n.type,this._featureFilter={filter:()=>!0,needGeometry:!1},n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),a.layout&&(this._unevaluatedLayout=new Lc(a.layout)),a.paint)){this._transitionablePaint=new hh(a.paint);for(const c in n.paint)this.setPaintProperty(c,n.paint[c],{validate:!1});for(const c in n.layout)this.setLayoutProperty(c,n.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Mo(a.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,a,c={}){a!=null&&this._validate(uh,`layers.${this.id}.layout.${n}`,n,a,c)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,a):this.visibility=a)}getPaintProperty(n){return n.endsWith(Of)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,a,c={}){if(a!=null&&this._validate(Tf,`layers.${this.id}.paint.${n}`,n,a,c))return!1;if(n.endsWith(Of))return this._transitionablePaint.setTransition(n.slice(0,-11),a||void 0),!1;{const f=this._transitionablePaint._values[n],v=f.property.specification["property-type"]==="cross-faded-data-driven",b=f.value.isDataDriven(),w=f.value;this._transitionablePaint.setValue(n,a),this._handleSpecialPaintPropertyUpdate(n);const C=this._transitionablePaint._values[n].value;return C.isDataDriven()||b||v||this._handleOverridablePaintPropertyUpdate(n,w,C)}}_handleSpecialPaintPropertyUpdate(n){}_handleOverridablePaintPropertyUpdate(n,a,c){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,a){n.getCrossfadeParameters&&(this._crossfadeParameters=n.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,a)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),bn(n,(a,c)=>!(a===void 0||c==="layout"&&!Object.keys(a).length||c==="paint"&&!Object.keys(a).length))}_validate(n,a,c,f,v={}){return(!v||v.validate!==!1)&&Pf(this,n.call(ko,{key:a,layerType:this.type,objectKey:c,value:f,styleSpec:ae,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const a=this.paint.get(n);if(a instanceof Ia&&bo(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}}const ng={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class wl{constructor(n,a){this._structArray=n,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Qn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,a){return n._trim(),a&&(n.isTransferred=!0,a.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const a=Object.create(this.prototype);return a.arrayBuffer=n.arrayBuffer,a.length=n.length,a.capacity=n.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function zi(s,n=1){let a=0,c=0;return{members:s.map(f=>{const v=ng[f.type].BYTES_PER_ELEMENT,b=a=Vf(a,Math.max(n,v)),w=f.components||1;return c=Math.max(c,v),a+=v*w,{name:f.name,type:f.type,components:w,offset:b}}),size:Vf(a,Math.max(c,n)),alignment:n}}function Vf(s,n){return Math.ceil(s/n)*n}class Sl extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a){const c=this.length;return this.resize(c+1),this.emplace(c,n,a)}emplace(n,a,c){const f=2*n;return this.int16[f+0]=a,this.int16[f+1]=c,n}}Sl.prototype.bytesPerElement=4,Bt("StructArrayLayout2i4",Sl);class Cl extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,c){const f=this.length;return this.resize(f+1),this.emplace(f,n,a,c)}emplace(n,a,c,f){const v=3*n;return this.int16[v+0]=a,this.int16[v+1]=c,this.int16[v+2]=f,n}}Cl.prototype.bytesPerElement=6,Bt("StructArrayLayout3i6",Cl);class ph extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,c,f){const v=this.length;return this.resize(v+1),this.emplace(v,n,a,c,f)}emplace(n,a,c,f,v){const b=4*n;return this.int16[b+0]=a,this.int16[b+1]=c,this.int16[b+2]=f,this.int16[b+3]=v,n}}ph.prototype.bytesPerElement=8,Bt("StructArrayLayout4i8",ph);class mh extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,c,f,v,b){const w=this.length;return this.resize(w+1),this.emplace(w,n,a,c,f,v,b)}emplace(n,a,c,f,v,b,w){const C=6*n;return this.int16[C+0]=a,this.int16[C+1]=c,this.int16[C+2]=f,this.int16[C+3]=v,this.int16[C+4]=b,this.int16[C+5]=w,n}}mh.prototype.bytesPerElement=12,Bt("StructArrayLayout2i4i12",mh);class qa extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,c,f,v,b){const w=this.length;return this.resize(w+1),this.emplace(w,n,a,c,f,v,b)}emplace(n,a,c,f,v,b,w){const C=4*n,I=8*n;return this.int16[C+0]=a,this.int16[C+1]=c,this.uint8[I+4]=f,this.uint8[I+5]=v,this.uint8[I+6]=b,this.uint8[I+7]=w,n}}qa.prototype.bytesPerElement=8,Bt("StructArrayLayout2i4ub8",qa);class Eo extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a){const c=this.length;return this.resize(c+1),this.emplace(c,n,a)}emplace(n,a,c){const f=2*n;return this.float32[f+0]=a,this.float32[f+1]=c,n}}Eo.prototype.bytesPerElement=8,Bt("StructArrayLayout2f8",Eo);class Tl extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,c,f,v,b,w,C,I,R){const L=this.length;return this.resize(L+1),this.emplace(L,n,a,c,f,v,b,w,C,I,R)}emplace(n,a,c,f,v,b,w,C,I,R,L){const $=10*n;return this.uint16[$+0]=a,this.uint16[$+1]=c,this.uint16[$+2]=f,this.uint16[$+3]=v,this.uint16[$+4]=b,this.uint16[$+5]=w,this.uint16[$+6]=C,this.uint16[$+7]=I,this.uint16[$+8]=R,this.uint16[$+9]=L,n}}Tl.prototype.bytesPerElement=20,Bt("StructArrayLayout10ui20",Tl);class Oc extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,c,f,v,b,w,C,I,R,L,$){const G=this.length;return this.resize(G+1),this.emplace(G,n,a,c,f,v,b,w,C,I,R,L,$)}emplace(n,a,c,f,v,b,w,C,I,R,L,$,G){const Z=12*n;return this.int16[Z+0]=a,this.int16[Z+1]=c,this.int16[Z+2]=f,this.int16[Z+3]=v,this.uint16[Z+4]=b,this.uint16[Z+5]=w,this.uint16[Z+6]=C,this.uint16[Z+7]=I,this.int16[Z+8]=R,this.int16[Z+9]=L,this.int16[Z+10]=$,this.int16[Z+11]=G,n}}Oc.prototype.bytesPerElement=24,Bt("StructArrayLayout4i4ui4i24",Oc);class Pl extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,c){const f=this.length;return this.resize(f+1),this.emplace(f,n,a,c)}emplace(n,a,c,f){const v=3*n;return this.float32[v+0]=a,this.float32[v+1]=c,this.float32[v+2]=f,n}}Pl.prototype.bytesPerElement=12,Bt("StructArrayLayout3f12",Pl);class gh extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.uint32[1*n+0]=a,n}}gh.prototype.bytesPerElement=4,Bt("StructArrayLayout1ul4",gh);class Ao extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,c,f,v,b,w,C,I){const R=this.length;return this.resize(R+1),this.emplace(R,n,a,c,f,v,b,w,C,I)}emplace(n,a,c,f,v,b,w,C,I,R){const L=10*n,$=5*n;return this.int16[L+0]=a,this.int16[L+1]=c,this.int16[L+2]=f,this.int16[L+3]=v,this.int16[L+4]=b,this.int16[L+5]=w,this.uint32[$+3]=C,this.uint16[L+8]=I,this.uint16[L+9]=R,n}}Ao.prototype.bytesPerElement=20,Bt("StructArrayLayout6i1ul2ui20",Ao);class Gs extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,c,f,v,b){const w=this.length;return this.resize(w+1),this.emplace(w,n,a,c,f,v,b)}emplace(n,a,c,f,v,b,w){const C=6*n;return this.int16[C+0]=a,this.int16[C+1]=c,this.int16[C+2]=f,this.int16[C+3]=v,this.int16[C+4]=b,this.int16[C+5]=w,n}}Gs.prototype.bytesPerElement=12,Bt("StructArrayLayout2i2i2i12",Gs);class _h extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,c,f,v){const b=this.length;return this.resize(b+1),this.emplace(b,n,a,c,f,v)}emplace(n,a,c,f,v,b){const w=4*n,C=8*n;return this.float32[w+0]=a,this.float32[w+1]=c,this.float32[w+2]=f,this.int16[C+6]=v,this.int16[C+7]=b,n}}_h.prototype.bytesPerElement=16,Bt("StructArrayLayout2f1f2i16",_h);class Vc extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,c,f,v,b){const w=this.length;return this.resize(w+1),this.emplace(w,n,a,c,f,v,b)}emplace(n,a,c,f,v,b,w){const C=16*n,I=4*n,R=8*n;return this.uint8[C+0]=a,this.uint8[C+1]=c,this.float32[I+1]=f,this.float32[I+2]=v,this.int16[R+6]=b,this.int16[R+7]=w,n}}Vc.prototype.bytesPerElement=16,Bt("StructArrayLayout2ub2f2i16",Vc);class ds extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,c){const f=this.length;return this.resize(f+1),this.emplace(f,n,a,c)}emplace(n,a,c,f){const v=3*n;return this.uint16[v+0]=a,this.uint16[v+1]=c,this.uint16[v+2]=f,n}}ds.prototype.bytesPerElement=6,Bt("StructArrayLayout3ui6",ds);class yh extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,c,f,v,b,w,C,I,R,L,$,G,Z,K,ie,he){const ze=this.length;return this.resize(ze+1),this.emplace(ze,n,a,c,f,v,b,w,C,I,R,L,$,G,Z,K,ie,he)}emplace(n,a,c,f,v,b,w,C,I,R,L,$,G,Z,K,ie,he,ze){const ge=24*n,U=12*n,ne=48*n;return this.int16[ge+0]=a,this.int16[ge+1]=c,this.uint16[ge+2]=f,this.uint16[ge+3]=v,this.uint32[U+2]=b,this.uint32[U+3]=w,this.uint32[U+4]=C,this.uint16[ge+10]=I,this.uint16[ge+11]=R,this.uint16[ge+12]=L,this.float32[U+7]=$,this.float32[U+8]=G,this.uint8[ne+36]=Z,this.uint8[ne+37]=K,this.uint8[ne+38]=ie,this.uint32[U+10]=he,this.int16[ge+22]=ze,n}}yh.prototype.bytesPerElement=48,Bt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",yh);class vh extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,c,f,v,b,w,C,I,R,L,$,G,Z,K,ie,he,ze,ge,U,ne,ve,He,dt,Xe,nt,yt,pt){const bt=this.length;return this.resize(bt+1),this.emplace(bt,n,a,c,f,v,b,w,C,I,R,L,$,G,Z,K,ie,he,ze,ge,U,ne,ve,He,dt,Xe,nt,yt,pt)}emplace(n,a,c,f,v,b,w,C,I,R,L,$,G,Z,K,ie,he,ze,ge,U,ne,ve,He,dt,Xe,nt,yt,pt,bt){const at=32*n,$t=16*n;return this.int16[at+0]=a,this.int16[at+1]=c,this.int16[at+2]=f,this.int16[at+3]=v,this.int16[at+4]=b,this.int16[at+5]=w,this.int16[at+6]=C,this.int16[at+7]=I,this.uint16[at+8]=R,this.uint16[at+9]=L,this.uint16[at+10]=$,this.uint16[at+11]=G,this.uint16[at+12]=Z,this.uint16[at+13]=K,this.uint16[at+14]=ie,this.uint16[at+15]=he,this.uint16[at+16]=ze,this.uint16[at+17]=ge,this.uint16[at+18]=U,this.uint16[at+19]=ne,this.uint16[at+20]=ve,this.uint16[at+21]=He,this.uint16[at+22]=dt,this.uint32[$t+12]=Xe,this.float32[$t+13]=nt,this.float32[$t+14]=yt,this.uint16[at+30]=pt,this.uint16[at+31]=bt,n}}vh.prototype.bytesPerElement=64,Bt("StructArrayLayout8i15ui1ul2f2ui64",vh);class kl extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.float32[1*n+0]=a,n}}kl.prototype.bytesPerElement=4,Bt("StructArrayLayout1f4",kl);class bh extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,c){const f=this.length;return this.resize(f+1),this.emplace(f,n,a,c)}emplace(n,a,c,f){const v=3*n;return this.uint16[6*n+0]=a,this.float32[v+1]=c,this.float32[v+2]=f,n}}bh.prototype.bytesPerElement=12,Bt("StructArrayLayout1ui2f12",bh);class g extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,c){const f=this.length;return this.resize(f+1),this.emplace(f,n,a,c)}emplace(n,a,c,f){const v=4*n;return this.uint32[2*n+0]=a,this.uint16[v+2]=c,this.uint16[v+3]=f,n}}g.prototype.bytesPerElement=8,Bt("StructArrayLayout1ul2ui8",g);class t extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a){const c=this.length;return this.resize(c+1),this.emplace(c,n,a)}emplace(n,a,c){const f=2*n;return this.uint16[f+0]=a,this.uint16[f+1]=c,n}}t.prototype.bytesPerElement=4,Bt("StructArrayLayout2ui4",t);class r extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.uint16[1*n+0]=a,n}}r.prototype.bytesPerElement=2,Bt("StructArrayLayout1ui2",r);class u extends Qn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,c,f){const v=this.length;return this.resize(v+1),this.emplace(v,n,a,c,f)}emplace(n,a,c,f,v){const b=4*n;return this.float32[b+0]=a,this.float32[b+1]=c,this.float32[b+2]=f,this.float32[b+3]=v,n}}u.prototype.bytesPerElement=16,Bt("StructArrayLayout4f16",u);class d extends wl{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new F(this.anchorPointX,this.anchorPointY)}}d.prototype.size=20;class y extends Ao{get(n){return new d(this,n)}}Bt("CollisionBoxArray",y);class x extends wl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(n){this._structArray.uint8[this._pos1+37]=n}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(n){this._structArray.uint8[this._pos1+38]=n}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(n){this._structArray.uint32[this._pos4+10]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}x.prototype.size=48;class S extends yh{get(n){return new x(this,n)}}Bt("PlacedSymbolArray",S);class P extends wl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(n){this._structArray.uint32[this._pos4+12]=n}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}P.prototype.size=64;class E extends vh{get(n){return new P(this,n)}}Bt("SymbolInstanceArray",E);class B extends kl{getoffsetX(n){return this.float32[1*n+0]}}Bt("GlyphOffsetArray",B);class V extends Cl{getx(n){return this.int16[3*n+0]}gety(n){return this.int16[3*n+1]}gettileUnitDistanceFromAnchor(n){return this.int16[3*n+2]}}Bt("SymbolLineVertexArray",V);class j extends wl{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}j.prototype.size=12;class X extends bh{get(n){return new j(this,n)}}Bt("TextAnchorOffsetArray",X);class Y extends wl{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Y.prototype.size=8;class le extends g{get(n){return new Y(this,n)}}Bt("FeatureIndexArray",le);class se extends Sl{}class ce extends Sl{}class fe extends Sl{}class we extends mh{}class Te extends qa{}class Ie extends Eo{}class De extends Tl{}class Re extends Oc{}class Ge extends Pl{}class Ze extends gh{}class rt extends Gs{}class lt extends Vc{}class et extends ds{}class Pt extends t{}const St=zi([{name:"a_pos",components:2,type:"Int16"}],4),{members:ft}=St;class Rt{constructor(n=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=n}prepareSegment(n,a,c,f){const v=this.segments[this.segments.length-1];return n>Rt.MAX_VERTEX_ARRAY_LENGTH&&ri(`Max vertices per segment is ${Rt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Rt.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!v||v.vertexLength+n>Rt.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==f?this.createNewSegment(a,c,f):v}createNewSegment(n,a,c){const f={vertexOffset:n.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0,vaos:{}};return c!==void 0&&(f.sortKey=c),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(f),f}getOrCreateLatestSegment(n,a,c){return this.prepareSegment(0,n,a,c)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const n of this.segments)for(const a in n.vaos)n.vaos[a].destroy()}static simpleSegment(n,a,c,f){return new Rt([{vertexOffset:n,primitiveOffset:a,vertexLength:c,primitiveLength:f,vaos:{},sortKey:0}])}}function vn(s,n){return 256*(s=Yt(Math.floor(s),0,255))+Yt(Math.floor(n),0,255)}Rt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Bt("SegmentVector",Rt);const Bn=zi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var pi,qn,mi,Wn={exports:{}},Gn={exports:{}},Xn={exports:{}},or=function(){if(mi)return Wn.exports;mi=1;var s=(pi||(pi=1,Gn.exports=function(a,c){var f,v,b,w,C,I,R,L;for(v=a.length-(f=3&a.length),b=c,C=3432918353,I=461845907,L=0;L<v;)R=255&a.charCodeAt(L)|(255&a.charCodeAt(++L))<<8|(255&a.charCodeAt(++L))<<16|(255&a.charCodeAt(++L))<<24,++L,b=27492+(65535&(w=5*(65535&(b=(b^=R=(65535&(R=(R=(65535&R)*C+(((R>>>16)*C&65535)<<16)&4294967295)<<15|R>>>17))*I+(((R>>>16)*I&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(w>>>16)&65535)<<16);switch(R=0,f){case 3:R^=(255&a.charCodeAt(L+2))<<16;case 2:R^=(255&a.charCodeAt(L+1))<<8;case 1:b^=R=(65535&(R=(R=(65535&(R^=255&a.charCodeAt(L)))*C+(((R>>>16)*C&65535)<<16)&4294967295)<<15|R>>>17))*I+(((R>>>16)*I&65535)<<16)&4294967295}return b^=a.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0}),Gn.exports),n=(qn||(qn=1,Xn.exports=function(a,c){for(var f,v=a.length,b=c^v,w=0;v>=4;)f=1540483477*(65535&(f=255&a.charCodeAt(w)|(255&a.charCodeAt(++w))<<8|(255&a.charCodeAt(++w))<<16|(255&a.charCodeAt(++w))<<24))+((1540483477*(f>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),v-=4,++w;switch(v){case 3:b^=(255&a.charCodeAt(w+2))<<16;case 2:b^=(255&a.charCodeAt(w+1))<<8;case 1:b=1540483477*(65535&(b^=255&a.charCodeAt(w)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0}),Xn.exports);return Wn.exports=s,Wn.exports.murmur3=s,Wn.exports.murmur2=n,Wn.exports}(),Ni=T(or);class $i{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,a,c,f){this.ids.push(wr(n)),this.positions.push(a,c,f)}getPositions(n){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const a=wr(n);let c=0,f=this.ids.length-1;for(;c<f;){const b=c+f>>1;this.ids[b]>=a?f=b:c=b+1}const v=[];for(;this.ids[c]===a;)v.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return v}static serialize(n,a){const c=new Float64Array(n.ids),f=new Uint32Array(n.positions);return Wa(c,f,0,c.length-1),a&&a.push(c.buffer,f.buffer),{ids:c,positions:f}}static deserialize(n){const a=new $i;return a.ids=n.ids,a.positions=n.positions,a.indexed=!0,a}}function wr(s){const n=+s;return!isNaN(n)&&n<=Number.MAX_SAFE_INTEGER?n:Ni(String(s))}function Wa(s,n,a,c){for(;a<c;){const f=s[a+c>>1];let v=a-1,b=c+1;for(;;){do v++;while(s[v]<f);do b--;while(s[b]>f);if(v>=b)break;Ea(s,v,b),Ea(n,3*v,3*b),Ea(n,3*v+1,3*b+1),Ea(n,3*v+2,3*b+2)}b-a<c-b?(Wa(s,n,a,b),a=b+1):(Wa(s,n,b+1,c),c=b)}}function Ea(s,n,a){const c=s[n];s[n]=s[a],s[a]=c}Bt("FeaturePositionMap",$i);class Nr{constructor(n,a){this.gl=n.gl,this.location=a}}class Xa extends Nr{constructor(n,a){super(n,a),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class Il extends Nr{constructor(n,a){super(n,a),this.current=[0,0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3]))}}class Ml extends Nr{constructor(n,a){super(n,a),this.current=Pn.transparent}set(n){n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a))}}const Ro=new Float32Array(16);function Ar(s){return[vn(255*s.r,255*s.g),vn(255*s.b,255*s.a)]}class na{constructor(n,a,c){this.value=n,this.uniformNames=a.map(f=>`u_${f}`),this.type=c}setUniform(n,a,c){n.set(c.constantOr(this.value))}getBinding(n,a,c){return this.type==="color"?new Ml(n,a):new Xa(n,a)}}class ia{constructor(n,a){this.uniformNames=a.map(c=>`u_${c}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(n,a){this.pixelRatioFrom=a.pixelRatio,this.pixelRatioTo=n.pixelRatio,this.patternFrom=a.tlbr,this.patternTo=n.tlbr}setUniform(n,a,c,f){const v=f==="u_pattern_to"?this.patternTo:f==="u_pattern_from"?this.patternFrom:f==="u_pixel_ratio_to"?this.pixelRatioTo:f==="u_pixel_ratio_from"?this.pixelRatioFrom:null;v&&n.set(v)}getBinding(n,a,c){return c.substr(0,9)==="u_pattern"?new Il(n,a):new Xa(n,a)}}class $r{constructor(n,a,c,f){this.expression=n,this.type=c,this.maxValue=0,this.paintVertexAttributes=a.map(v=>({name:`a_${v}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(n,a,c,f,v){const b=this.paintVertexArray.length,w=this.expression.evaluate(new fi(0),a,{},f,[],v);this.paintVertexArray.resize(n),this._setPaintValue(b,n,w)}updatePaintArray(n,a,c,f){const v=this.expression.evaluate({zoom:0},c,f);this._setPaintValue(n,a,v)}_setPaintValue(n,a,c){if(this.type==="color"){const f=Ar(c);for(let v=n;v<a;v++)this.paintVertexArray.emplace(v,f[0],f[1])}else{for(let f=n;f<a;f++)this.paintVertexArray.emplace(f,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Kn{constructor(n,a,c,f,v,b){this.expression=n,this.uniformNames=a.map(w=>`u_${w}_t`),this.type=c,this.useIntegerZoom=f,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=a.map(w=>({name:`a_${w}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new b}populatePaintArray(n,a,c,f,v){const b=this.expression.evaluate(new fi(this.zoom),a,{},f,[],v),w=this.expression.evaluate(new fi(this.zoom+1),a,{},f,[],v),C=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(C,n,b,w)}updatePaintArray(n,a,c,f){const v=this.expression.evaluate({zoom:this.zoom},c,f),b=this.expression.evaluate({zoom:this.zoom+1},c,f);this._setPaintValue(n,a,v,b)}_setPaintValue(n,a,c,f){if(this.type==="color"){const v=Ar(c),b=Ar(f);for(let w=n;w<a;w++)this.paintVertexArray.emplace(w,v[0],v[1],b[0],b[1])}else{for(let v=n;v<a;v++)this.paintVertexArray.emplace(v,c,f);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(f))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,a){const c=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,f=Yt(this.expression.interpolationFactor(c,this.zoom,this.zoom+1),0,1);n.set(f)}getBinding(n,a,c){return new Xa(n,a)}}class gi{constructor(n,a,c,f,v,b){this.expression=n,this.type=a,this.useIntegerZoom=c,this.zoom=f,this.layerId=b,this.zoomInPaintVertexArray=new v,this.zoomOutPaintVertexArray=new v}populatePaintArray(n,a,c){const f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(n),this.zoomOutPaintVertexArray.resize(n),this._setPaintValues(f,n,a.patterns&&a.patterns[this.layerId],c)}updatePaintArray(n,a,c,f,v){this._setPaintValues(n,a,c.patterns&&c.patterns[this.layerId],v)}_setPaintValues(n,a,c,f){if(!f||!c)return;const{min:v,mid:b,max:w}=c,C=f[v],I=f[b],R=f[w];if(C&&I&&R)for(let L=n;L<a;L++)this.zoomInPaintVertexArray.emplace(L,I.tl[0],I.tl[1],I.br[0],I.br[1],C.tl[0],C.tl[1],C.br[0],C.br[1],I.pixelRatio,C.pixelRatio),this.zoomOutPaintVertexArray.emplace(L,I.tl[0],I.tl[1],I.br[0],I.br[1],R.tl[0],R.tl[1],R.br[0],R.br[1],I.pixelRatio,R.pixelRatio)}upload(n){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=n.createVertexBuffer(this.zoomInPaintVertexArray,Bn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=n.createVertexBuffer(this.zoomOutPaintVertexArray,Bn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class jr{constructor(n,a,c){this.binders={},this._buffers=[];const f=[];for(const v in n.paint._values){if(!c(v))continue;const b=n.paint.get(v);if(!(b instanceof Ia&&bo(b.property.specification)))continue;const w=ig(v,n.type),C=b.value,I=b.property.specification.type,R=b.property.useIntegerZoom,L=b.property.specification["property-type"],$=L==="cross-faded"||L==="cross-faded-data-driven";if(C.kind==="constant")this.binders[v]=$?new ia(C.value,w):new na(C.value,w,I),f.push(`/u_${v}`);else if(C.kind==="source"||$){const G=Nf(v,I,"source");this.binders[v]=$?new gi(C,I,R,a,G,n.id):new $r(C,w,I,G),f.push(`/a_${v}`)}else{const G=Nf(v,I,"composite");this.binders[v]=new Kn(C,w,I,R,a,G),f.push(`/z_${v}`)}}this.cacheKey=f.sort().join("")}getMaxValue(n){const a=this.binders[n];return a instanceof $r||a instanceof Kn?a.maxValue:0}populatePaintArrays(n,a,c,f,v){for(const b in this.binders){const w=this.binders[b];(w instanceof $r||w instanceof Kn||w instanceof gi)&&w.populatePaintArray(n,a,c,f,v)}}setConstantPatternPositions(n,a){for(const c in this.binders){const f=this.binders[c];f instanceof ia&&f.setConstantPatternPositions(n,a)}}updatePaintArrays(n,a,c,f,v){let b=!1;for(const w in n){const C=a.getPositions(w);for(const I of C){const R=c.feature(I.index);for(const L in this.binders){const $=this.binders[L];if(($ instanceof $r||$ instanceof Kn||$ instanceof gi)&&$.expression.isStateDependent===!0){const G=f.paint.get(L);$.expression=G.value,$.updatePaintArray(I.start,I.end,R,n[w],v),b=!0}}}}return b}defines(){const n=[];for(const a in this.binders){const c=this.binders[a];(c instanceof na||c instanceof ia)&&n.push(...c.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return n}getBinderAttributes(){const n=[];for(const a in this.binders){const c=this.binders[a];if(c instanceof $r||c instanceof Kn)for(let f=0;f<c.paintVertexAttributes.length;f++)n.push(c.paintVertexAttributes[f].name);else if(c instanceof gi)for(let f=0;f<Bn.members.length;f++)n.push(Bn.members[f].name)}return n}getBinderUniforms(){const n=[];for(const a in this.binders){const c=this.binders[a];if(c instanceof na||c instanceof ia||c instanceof Kn)for(const f of c.uniformNames)n.push(f)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n,a){const c=[];for(const f in this.binders){const v=this.binders[f];if(v instanceof na||v instanceof ia||v instanceof Kn){for(const b of v.uniformNames)if(a[b]){const w=v.getBinding(n,a[b],b);c.push({name:b,property:f,binding:w})}}}return c}setUniforms(n,a,c,f){for(const{name:v,property:b,binding:w}of a)this.binders[b].setUniform(w,f,c.get(b),v)}updatePaintBuffers(n){this._buffers=[];for(const a in this.binders){const c=this.binders[a];if(n&&c instanceof gi){const f=n.fromScale===2?c.zoomInPaintVertexBuffer:c.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(c instanceof $r||c instanceof Kn)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(n){for(const a in this.binders){const c=this.binders[a];(c instanceof $r||c instanceof Kn||c instanceof gi)&&c.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const a=this.binders[n];(a instanceof $r||a instanceof Kn||a instanceof gi)&&a.destroy()}}}class xi{constructor(n,a,c=()=>!0){this.programConfigurations={};for(const f of n)this.programConfigurations[f.id]=new jr(f,a,c);this.needsUpload=!1,this._featureMap=new $i,this._bufferOffset=0}populatePaintArrays(n,a,c,f,v,b){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(n,a,f,v,b);a.id!==void 0&&this._featureMap.add(a.id,c,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,a,c,f){for(const v of c)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(n,this._featureMap,a,v,f)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}function ig(s,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[s]||[s.replace(`${n}-`,"").replace(/-/g,"_")]}function Nf(s,n,a){const c={color:{source:Eo,composite:u},number:{source:kl,composite:Eo}},f=function(v){return{"line-pattern":{source:De,composite:De},"fill-pattern":{source:De,composite:De},"fill-extrusion-pattern":{source:De,composite:De}}[v]}(s);return f&&f[a]||c[n][a]}Bt("ConstantBinder",na),Bt("CrossFadedConstantBinder",ia),Bt("SourceExpressionBinder",$r),Bt("CrossFadedCompositeBinder",gi),Bt("CompositeExpressionBinder",Kn),Bt("ProgramConfiguration",jr,{omit:["_buffers"]}),Bt("ProgramConfigurationSet",xi);const xh=Math.pow(2,14)-1,$f=-xh-1;function Hs(s){const n=Ne/s.extent,a=s.loadGeometry();for(let c=0;c<a.length;c++){const f=a[c];for(let v=0;v<f.length;v++){const b=f[v],w=Math.round(b.x*n),C=Math.round(b.y*n);b.x=Yt(w,$f,xh),b.y=Yt(C,$f,xh),(w<b.x||w>b.x+1||C<b.y||C>b.y+1)&&ri("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return a}function Zs(s,n){return{type:s.type,id:s.id,properties:s.properties,geometry:n?Hs(s):[]}}const fs=-32768;function jf(s,n,a,c,f){s.emplaceBack(fs+8*n+c,fs+8*a+f)}class Nc{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new ce,this.indexArray=new et,this.segments=new Rt,this.programConfigurations=new xi(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(n,a,c){const f=this.layers[0],v=[];let b=null,w=!1,C=f.type==="heatmap";if(f.type==="circle"){const R=f;b=R.layout.get("circle-sort-key"),w=!b.isConstant(),C=C||R.paint.get("circle-pitch-alignment")==="map"}const I=C?a.subdivisionGranularity.circle:1;for(const{feature:R,id:L,index:$,sourceLayerIndex:G}of n){const Z=this.layers[0]._featureFilter.needGeometry,K=Zs(R,Z);if(!this.layers[0]._featureFilter.filter(new fi(this.zoom),K,c))continue;const ie=w?b.evaluate(K,{},c):void 0,he={id:L,properties:R.properties,type:R.type,sourceLayerIndex:G,index:$,geometry:Z?K.geometry:Hs(R),patterns:{},sortKey:ie};v.push(he)}w&&v.sort((R,L)=>R.sortKey-L.sortKey);for(const R of v){const{geometry:L,index:$,sourceLayerIndex:G}=R,Z=n[$].feature;this.addFeature(R,L,$,c,I),a.featureIndex.insert(Z,L,$,G,this.index)}}update(n,a,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,a,this.stateDependentLayers,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,ft),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,a,c,f,v=1){let b;switch(v){case 1:b=[0,7];break;case 3:b=[0,2,5,7];break;case 5:b=[0,1,3,4,6,7];break;case 7:b=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${v}; valid values are 1, 3, 5, 7.`)}const w=b.length;for(const C of a)for(const I of C){const R=I.x,L=I.y;if(R<0||R>=Ne||L<0||L>=Ne)continue;const $=this.segments.prepareSegment(w*w,this.layoutVertexArray,this.indexArray,n.sortKey),G=$.vertexLength;for(let Z=0;Z<w;Z++)for(let K=0;K<w;K++)jf(this.layoutVertexArray,R,L,b[K],b[Z]);for(let Z=0;Z<w-1;Z++)for(let K=0;K<w-1;K++){const ie=G+Z*w+K,he=G+(Z+1)*w+K;this.indexArray.emplaceBack(ie,he+1,ie+1),this.indexArray.emplaceBack(ie,he,he+1)}$.vertexLength+=w*w,$.primitiveLength+=(w-1)*(w-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,{},f)}}function wh(s,n){for(let a=0;a<s.length;a++)if($c(n,s[a]))return!0;for(let a=0;a<n.length;a++)if($c(s,n[a]))return!0;return!!rg(s,n)}function Sh(s,n,a){return!!$c(s,n)||!!ag(n,s,a)}function Ch(s,n){if(s.length===1)return fv(n,s[0]);for(let a=0;a<n.length;a++){const c=n[a];for(let f=0;f<c.length;f++)if($c(s,c[f]))return!0}for(let a=0;a<s.length;a++)if(fv(n,s[a]))return!0;for(let a=0;a<n.length;a++)if(rg(s,n[a]))return!0;return!1}function Th(s,n,a){if(s.length>1){if(rg(s,n))return!0;for(let c=0;c<n.length;c++)if(ag(n[c],s,a))return!0}for(let c=0;c<s.length;c++)if(ag(s[c],n,a))return!0;return!1}function rg(s,n){if(s.length===0||n.length===0)return!1;for(let a=0;a<s.length-1;a++){const c=s[a],f=s[a+1];for(let v=0;v<n.length-1;v++)if(e2(c,f,n[v],n[v+1]))return!0}return!1}function e2(s,n,a,c){return En(s,a,c)!==En(n,a,c)&&En(s,n,a)!==En(s,n,c)}function ag(s,n,a){const c=a*a;if(n.length===1)return s.distSqr(n[0])<c;for(let f=1;f<n.length;f++)if(dv(s,n[f-1],n[f])<c)return!0;return!1}function dv(s,n,a){const c=n.distSqr(a);if(c===0)return s.distSqr(n);const f=((s.x-n.x)*(a.x-n.x)+(s.y-n.y)*(a.y-n.y))/c;return s.distSqr(f<0?n:f>1?a:a.sub(n)._mult(f)._add(n))}function fv(s,n){let a,c,f,v=!1;for(let b=0;b<s.length;b++){a=s[b];for(let w=0,C=a.length-1;w<a.length;C=w++)c=a[w],f=a[C],c.y>n.y!=f.y>n.y&&n.x<(f.x-c.x)*(n.y-c.y)/(f.y-c.y)+c.x&&(v=!v)}return v}function $c(s,n){let a=!1;for(let c=0,f=s.length-1;c<s.length;f=c++){const v=s[c],b=s[f];v.y>n.y!=b.y>n.y&&n.x<(b.x-v.x)*(n.y-v.y)/(b.y-v.y)+v.x&&(a=!a)}return a}function t2(s,n,a){const c=a[0],f=a[2];if(s.x<c.x&&n.x<c.x||s.x>f.x&&n.x>f.x||s.y<c.y&&n.y<c.y||s.y>f.y&&n.y>f.y)return!1;const v=En(s,n,a[0]);return v!==En(s,n,a[1])||v!==En(s,n,a[2])||v!==En(s,n,a[3])}function Ph(s,n,a){const c=n.paint.get(s).value;return c.kind==="constant"?c.value:a.programConfigurations.get(n.id).getMaxValue(s)}function Uf(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function Gf(s,n,a,c,f){if(!n[0]&&!n[1])return s;const v=F.convert(n)._mult(f);a==="viewport"&&v._rotate(-c);const b=[];for(let w=0;w<s.length;w++)b.push(s[w].sub(v));return b}let pv,mv;Bt("CircleBucket",Nc,{omit:["layers"]});var n2={get paint(){return mv=mv||new Er({"circle-radius":new rn(ae.paint_circle["circle-radius"]),"circle-color":new rn(ae.paint_circle["circle-color"]),"circle-blur":new rn(ae.paint_circle["circle-blur"]),"circle-opacity":new rn(ae.paint_circle["circle-opacity"]),"circle-translate":new Ht(ae.paint_circle["circle-translate"]),"circle-translate-anchor":new Ht(ae.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ht(ae.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ht(ae.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new rn(ae.paint_circle["circle-stroke-width"]),"circle-stroke-color":new rn(ae.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new rn(ae.paint_circle["circle-stroke-opacity"])})},get layout(){return pv=pv||new Er({"circle-sort-key":new rn(ae.layout_circle["circle-sort-key"])})}};class i2 extends Ma{constructor(n){super(n,n2)}createBucket(n){return new Nc(n)}queryRadius(n){const a=n;return Ph("circle-radius",this,a)+Ph("circle-stroke-width",this,a)+Uf(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:n,feature:a,featureState:c,geometry:f,transform:v,pixelsToTileUnits:b,pixelPosMatrix:w}){const C=Gf(n,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-v.bearingInRadians,b),I=this.paint.get("circle-radius").evaluate(a,c)+this.paint.get("circle-stroke-width").evaluate(a,c),R=this.paint.get("circle-pitch-alignment")==="map",L=R?C:function(G,Z){return G.map(K=>gv(K,Z))}(C,w),$=R?I*b:I;for(const G of f)for(const Z of G){const K=R?Z:gv(Z,w);let ie=$;const he=xe([],[Z.x,Z.y,0,1],w);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ie*=he[3]/v.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ie*=v.cameraToCenterDistance/he[3]),Sh(L,K,ie))return!0}return!1}}function gv(s,n){const a=xe([],[s.x,s.y,0,1],n);return new F(a[0]/a[3],a[1]/a[3])}class _v extends Nc{}let yv;Bt("HeatmapBucket",_v,{omit:["layers"]});var r2={get paint(){return yv=yv||new Er({"heatmap-radius":new rn(ae.paint_heatmap["heatmap-radius"]),"heatmap-weight":new rn(ae.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ht(ae.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Fc(ae.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ht(ae.paint_heatmap["heatmap-opacity"])})}};function sg(s,{width:n,height:a},c,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==n*a*c)throw new RangeError(`mismatched image size. expected: ${f.length} but got: ${n*a*c}`)}else f=new Uint8Array(n*a*c);return s.width=n,s.height=a,s.data=f,s}function vv(s,{width:n,height:a},c){if(n===s.width&&a===s.height)return;const f=sg({},{width:n,height:a},c);og(s,f,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,n),height:Math.min(s.height,a)},c),s.width=n,s.height=a,s.data=f.data}function og(s,n,a,c,f,v){if(f.width===0||f.height===0)return n;if(f.width>s.width||f.height>s.height||a.x>s.width-f.width||a.y>s.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>n.width||f.height>n.height||c.x>n.width-f.width||c.y>n.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const b=s.data,w=n.data;if(b===w)throw new Error("srcData equals dstData, so image is already copied");for(let C=0;C<f.height;C++){const I=((a.y+C)*s.width+a.x)*v,R=((c.y+C)*n.width+c.x)*v;for(let L=0;L<f.width*v;L++)w[R+L]=b[I+L]}return n}class kh{constructor(n,a){sg(this,n,1,a)}resize(n){vv(this,n,1)}clone(){return new kh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,a,c,f,v){og(n,a,c,f,v,1)}}class da{constructor(n,a){sg(this,n,4,a)}resize(n){vv(this,n,4)}replace(n,a){a?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new da({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,a,c,f,v){og(n,a,c,f,v,4)}}function bv(s){const n={},a=s.resolution||256,c=s.clips?s.clips.length:1,f=s.image||new da({width:a,height:c});if(Math.log(a)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${a}`);const v=(b,w,C)=>{n[s.evaluationKey]=C;const I=s.expression.evaluate(n);f.data[b+w+0]=Math.floor(255*I.r/I.a),f.data[b+w+1]=Math.floor(255*I.g/I.a),f.data[b+w+2]=Math.floor(255*I.b/I.a),f.data[b+w+3]=Math.floor(255*I.a)};if(s.clips)for(let b=0,w=0;b<c;++b,w+=4*a)for(let C=0,I=0;C<a;C++,I+=4){const R=C/(a-1),{start:L,end:$}=s.clips[b];v(w,I,L*(1-R)+$*R)}else for(let b=0,w=0;b<a;b++,w+=4)v(0,w,b/(a-1));return f}Bt("AlphaImage",kh),Bt("RGBAImage",da);const lg="big-fb";class a2 extends Ma{createBucket(n){return new _v(n)}constructor(n){super(n,r2),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=bv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(lg)&&this.heatmapFbos.delete(lg)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let xv;var s2={get paint(){return xv=xv||new Er({"hillshade-illumination-direction":new Ht(ae.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ht(ae.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ht(ae.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ht(ae.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ht(ae.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ht(ae.paint_hillshade["hillshade-accent-color"])})}};class o2 extends Ma{constructor(n){super(n,s2)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const l2=zi([{name:"a_pos",components:2,type:"Int16"}],4),{members:c2}=l2;function cg(s,n,a){const c=a.patternDependencies;let f=!1;for(const v of n){const b=v.paint.get(`${s}-pattern`);b.isConstant()||(f=!0);const w=b.constantOr(null);w&&(f=!0,c[w.to]=!0,c[w.from]=!0)}return f}function ug(s,n,a,c,f){const v=f.patternDependencies;for(const b of n){const w=b.paint.get(`${s}-pattern`).value;if(w.kind!=="constant"){let C=w.evaluate({zoom:c-1},a,{},f.availableImages),I=w.evaluate({zoom:c},a,{},f.availableImages),R=w.evaluate({zoom:c+1},a,{},f.availableImages);C=C&&C.name?C.name:C,I=I&&I.name?I.name:I,R=R&&R.name?R.name:R,v[C]=!0,v[I]=!0,v[R]=!0,a.patterns[b.id]={min:C,mid:I,max:R}}}return a}function wv(s,n,a,c,f){let v;if(f===function(b,w,C,I){let R=0;for(let L=w,$=C-I;L<C;L+=I)R+=(b[$]-b[L])*(b[L+1]+b[$+1]),$=L;return R}(s,n,a,c)>0)for(let b=n;b<a;b+=c)v=Pv(b/c|0,s[b],s[b+1],v);else for(let b=a-c;b>=n;b-=c)v=Pv(b/c|0,s[b],s[b+1],v);return v&&jc(v,v.next)&&(Ah(v),v=v.next),v}function El(s,n){if(!s)return s;n||(n=s);let a,c=s;do if(a=!1,c.steiner||!jc(c,c.next)&&Li(c.prev,c,c.next)!==0)c=c.next;else{if(Ah(c),c=n=c.prev,c===c.next)break;a=!0}while(a||c!==n);return n}function Ih(s,n,a,c,f,v,b){if(!s)return;!b&&v&&function(C,I,R,L){let $=C;do $.z===0&&($.z=hg($.x,$.y,I,R,L)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next;while($!==C);$.prevZ.nextZ=null,$.prevZ=null,function(G){let Z,K=1;do{let ie,he=G;G=null;let ze=null;for(Z=0;he;){Z++;let ge=he,U=0;for(let ve=0;ve<K&&(U++,ge=ge.nextZ,ge);ve++);let ne=K;for(;U>0||ne>0&&ge;)U!==0&&(ne===0||!ge||he.z<=ge.z)?(ie=he,he=he.nextZ,U--):(ie=ge,ge=ge.nextZ,ne--),ze?ze.nextZ=ie:G=ie,ie.prevZ=ze,ze=ie;he=ge}ze.nextZ=null,K*=2}while(Z>1)}($)}(s,c,f,v);let w=s;for(;s.prev!==s.next;){const C=s.prev,I=s.next;if(v?h2(s,c,f,v):u2(s))n.push(C.i,s.i,I.i),Ah(s),s=I.next,w=I.next;else if((s=I)===w){b?b===1?Ih(s=d2(El(s),n),n,a,c,f,v,2):b===2&&f2(s,n,a,c,f,v):Ih(El(s),n,a,c,f,v,1);break}}}function u2(s){const n=s.prev,a=s,c=s.next;if(Li(n,a,c)>=0)return!1;const f=n.x,v=a.x,b=c.x,w=n.y,C=a.y,I=c.y,R=Math.min(f,v,b),L=Math.min(w,C,I),$=Math.max(f,v,b),G=Math.max(w,C,I);let Z=c.next;for(;Z!==n;){if(Z.x>=R&&Z.x<=$&&Z.y>=L&&Z.y<=G&&Mh(f,w,v,C,b,I,Z.x,Z.y)&&Li(Z.prev,Z,Z.next)>=0)return!1;Z=Z.next}return!0}function h2(s,n,a,c){const f=s.prev,v=s,b=s.next;if(Li(f,v,b)>=0)return!1;const w=f.x,C=v.x,I=b.x,R=f.y,L=v.y,$=b.y,G=Math.min(w,C,I),Z=Math.min(R,L,$),K=Math.max(w,C,I),ie=Math.max(R,L,$),he=hg(G,Z,n,a,c),ze=hg(K,ie,n,a,c);let ge=s.prevZ,U=s.nextZ;for(;ge&&ge.z>=he&&U&&U.z<=ze;){if(ge.x>=G&&ge.x<=K&&ge.y>=Z&&ge.y<=ie&&ge!==f&&ge!==b&&Mh(w,R,C,L,I,$,ge.x,ge.y)&&Li(ge.prev,ge,ge.next)>=0||(ge=ge.prevZ,U.x>=G&&U.x<=K&&U.y>=Z&&U.y<=ie&&U!==f&&U!==b&&Mh(w,R,C,L,I,$,U.x,U.y)&&Li(U.prev,U,U.next)>=0))return!1;U=U.nextZ}for(;ge&&ge.z>=he;){if(ge.x>=G&&ge.x<=K&&ge.y>=Z&&ge.y<=ie&&ge!==f&&ge!==b&&Mh(w,R,C,L,I,$,ge.x,ge.y)&&Li(ge.prev,ge,ge.next)>=0)return!1;ge=ge.prevZ}for(;U&&U.z<=ze;){if(U.x>=G&&U.x<=K&&U.y>=Z&&U.y<=ie&&U!==f&&U!==b&&Mh(w,R,C,L,I,$,U.x,U.y)&&Li(U.prev,U,U.next)>=0)return!1;U=U.nextZ}return!0}function d2(s,n){let a=s;do{const c=a.prev,f=a.next.next;!jc(c,f)&&Cv(c,a,a.next,f)&&Eh(c,f)&&Eh(f,c)&&(n.push(c.i,a.i,f.i),Ah(a),Ah(a.next),a=s=f),a=a.next}while(a!==s);return El(a)}function f2(s,n,a,c,f,v){let b=s;do{let w=b.next.next;for(;w!==b.prev;){if(b.i!==w.i&&y2(b,w)){let C=Tv(b,w);return b=El(b,b.next),C=El(C,C.next),Ih(b,n,a,c,f,v,0),void Ih(C,n,a,c,f,v,0)}w=w.next}b=b.next}while(b!==s)}function p2(s,n){let a=s.x-n.x;return a===0&&(a=s.y-n.y,a===0)&&(a=(s.next.y-s.y)/(s.next.x-s.x)-(n.next.y-n.y)/(n.next.x-n.x)),a}function m2(s,n){const a=function(f,v){let b=v;const w=f.x,C=f.y;let I,R=-1/0;if(jc(f,b))return b;do{if(jc(f,b.next))return b.next;if(C<=b.y&&C>=b.next.y&&b.next.y!==b.y){const K=b.x+(C-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(K<=w&&K>R&&(R=K,I=b.x<b.next.x?b:b.next,K===w))return I}b=b.next}while(b!==v);if(!I)return null;const L=I,$=I.x,G=I.y;let Z=1/0;b=I;do{if(w>=b.x&&b.x>=$&&w!==b.x&&Sv(C<G?w:R,C,$,G,C<G?R:w,C,b.x,b.y)){const K=Math.abs(C-b.y)/(w-b.x);Eh(b,f)&&(K<Z||K===Z&&(b.x>I.x||b.x===I.x&&g2(I,b)))&&(I=b,Z=K)}b=b.next}while(b!==L);return I}(s,n);if(!a)return n;const c=Tv(a,s);return El(c,c.next),El(a,a.next)}function g2(s,n){return Li(s.prev,s,n.prev)<0&&Li(n.next,s,s.next)<0}function hg(s,n,a,c,f){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-a)*f|0)|s<<8))|s<<4))|s<<2))|s<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-c)*f|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function _2(s){let n=s,a=s;do(n.x<a.x||n.x===a.x&&n.y<a.y)&&(a=n),n=n.next;while(n!==s);return a}function Sv(s,n,a,c,f,v,b,w){return(f-b)*(n-w)>=(s-b)*(v-w)&&(s-b)*(c-w)>=(a-b)*(n-w)&&(a-b)*(v-w)>=(f-b)*(c-w)}function Mh(s,n,a,c,f,v,b,w){return!(s===b&&n===w)&&Sv(s,n,a,c,f,v,b,w)}function y2(s,n){return s.next.i!==n.i&&s.prev.i!==n.i&&!function(a,c){let f=a;do{if(f.i!==a.i&&f.next.i!==a.i&&f.i!==c.i&&f.next.i!==c.i&&Cv(f,f.next,a,c))return!0;f=f.next}while(f!==a);return!1}(s,n)&&(Eh(s,n)&&Eh(n,s)&&function(a,c){let f=a,v=!1;const b=(a.x+c.x)/2,w=(a.y+c.y)/2;do f.y>w!=f.next.y>w&&f.next.y!==f.y&&b<(f.next.x-f.x)*(w-f.y)/(f.next.y-f.y)+f.x&&(v=!v),f=f.next;while(f!==a);return v}(s,n)&&(Li(s.prev,s,n.prev)||Li(s,n.prev,n))||jc(s,n)&&Li(s.prev,s,s.next)>0&&Li(n.prev,n,n.next)>0)}function Li(s,n,a){return(n.y-s.y)*(a.x-n.x)-(n.x-s.x)*(a.y-n.y)}function jc(s,n){return s.x===n.x&&s.y===n.y}function Cv(s,n,a,c){const f=Zf(Li(s,n,a)),v=Zf(Li(s,n,c)),b=Zf(Li(a,c,s)),w=Zf(Li(a,c,n));return f!==v&&b!==w||!(f!==0||!Hf(s,a,n))||!(v!==0||!Hf(s,c,n))||!(b!==0||!Hf(a,s,c))||!(w!==0||!Hf(a,n,c))}function Hf(s,n,a){return n.x<=Math.max(s.x,a.x)&&n.x>=Math.min(s.x,a.x)&&n.y<=Math.max(s.y,a.y)&&n.y>=Math.min(s.y,a.y)}function Zf(s){return s>0?1:s<0?-1:0}function Eh(s,n){return Li(s.prev,s,s.next)<0?Li(s,n,s.next)>=0&&Li(s,s.prev,n)>=0:Li(s,n,s.prev)<0||Li(s,s.next,n)<0}function Tv(s,n){const a=dg(s.i,s.x,s.y),c=dg(n.i,n.x,n.y),f=s.next,v=n.prev;return s.next=n,n.prev=s,a.next=f,f.prev=a,c.next=a,a.prev=c,v.next=c,c.prev=v,c}function Pv(s,n,a,c){const f=dg(s,n,a);return c?(f.next=c.next,f.prev=c,c.next.prev=f,c.next=f):(f.prev=f,f.next=f),f}function Ah(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function dg(s,n,a){return{i:s,x:n,y:a,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Uc{constructor(n,a){if(a>n)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=n,this._minGranularity=a}getGranularityForZoomLevel(n){return Math.max(Math.floor(this._baseZoomGranularity/(1<<n)),this._minGranularity,1)}}class qf{constructor(n){this.fill=n.fill,this.line=n.line,this.tile=n.tile,this.stencil=n.stencil,this.circle=n.circle}}qf.noSubdivision=new qf({fill:new Uc(0,0),line:new Uc(0,0),tile:new Uc(0,0),stencil:new Uc(0,0),circle:1}),Bt("SubdivisionGranularityExpression",Uc),Bt("SubdivisionGranularitySetting",qf);const Gc=-32768,Rh=32767;class v2{constructor(n,a){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=n,this._granularityCellSize=Ne/n,this._canonical=a}_getKey(n,a){return(n+=32768)<<16|(a+=32768)<<0}_vertexToIndex(n,a){if(n<-32768||a<-32768||n>32767||a>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const c=0|Math.round(n),f=0|Math.round(a),v=this._getKey(c,f);if(this._vertexDictionary.has(v))return this._vertexDictionary.get(v);const b=this._vertexBuffer.length/2;return this._vertexDictionary.set(v,b),this._vertexBuffer.push(c,f),b}_subdivideTrianglesScanline(n){if(this._granularity<2)return function(f,v){const b=[];for(let w=0;w<v.length;w+=3){const C=v[w],I=v[w+1],R=v[w+2],L=f[2*C],$=f[2*C+1];(f[2*I]-L)*(f[2*R+1]-$)-(f[2*I+1]-$)*(f[2*R]-L)>0?(b.push(C),b.push(R),b.push(I)):(b.push(C),b.push(I),b.push(R))}return b}(this._vertexBuffer,n);const a=[],c=n.length;for(let f=0;f<c;f+=3){const v=[n[f+0],n[f+1],n[f+2]],b=[this._vertexBuffer[2*n[f+0]+0],this._vertexBuffer[2*n[f+0]+1],this._vertexBuffer[2*n[f+1]+0],this._vertexBuffer[2*n[f+1]+1],this._vertexBuffer[2*n[f+2]+0],this._vertexBuffer[2*n[f+2]+1]];let w=1/0,C=1/0,I=-1/0,R=-1/0;for(let K=0;K<3;K++){const ie=b[2*K],he=b[2*K+1];w=Math.min(w,ie),I=Math.max(I,ie),C=Math.min(C,he),R=Math.max(R,he)}if(w===I||C===R)continue;const L=Math.floor(w/this._granularityCellSize),$=Math.ceil(I/this._granularityCellSize),G=Math.floor(C/this._granularityCellSize),Z=Math.ceil(R/this._granularityCellSize);if(L!==$||G!==Z)for(let K=G;K<Z;K++){const ie=this._scanlineGenerateVertexRingForCellRow(K,b,v);b2(this._vertexBuffer,ie,a)}else a.push(...v)}return a}_scanlineGenerateVertexRingForCellRow(n,a,c){const f=n*this._granularityCellSize,v=f+this._granularityCellSize,b=[];for(let w=0;w<3;w++){const C=a[2*w],I=a[2*w+1],R=a[2*(w+1)%6],L=a[(2*(w+1)+1)%6],$=a[2*(w+2)%6],G=a[(2*(w+2)+1)%6],Z=R-C,K=L-I,ie=Z===0,he=K===0,ze=(f-I)/K,ge=(v-I)/K,U=Math.min(ze,ge),ne=Math.max(ze,ge);if(!he&&(U>=1||ne<=0)||he&&(I<f||I>v)){L>=f&&L<=v&&b.push(c[(w+1)%3]);continue}!he&&U>0&&b.push(this._vertexToIndex(C+Z*U,I+K*U));const ve=C+Z*Math.max(U,0),He=C+Z*Math.min(ne,1);ie||this._generateIntraEdgeVertices(b,C,I,R,L,ve,He),!he&&ne<1&&b.push(this._vertexToIndex(C+Z*ne,I+K*ne)),(he||L>=f&&L<=v)&&b.push(c[(w+1)%3]),!he&&(L<=f||L>=v)&&this._generateInterEdgeVertices(b,C,I,R,L,$,G,He,f,v)}return b}_generateIntraEdgeVertices(n,a,c,f,v,b,w){const C=f-a,I=v-c,R=I===0,L=R?Math.min(a,f):Math.min(b,w),$=R?Math.max(a,f):Math.max(b,w),G=Math.floor(L/this._granularityCellSize)+1,Z=Math.ceil($/this._granularityCellSize)-1;if(R?a<f:b<w)for(let K=G;K<=Z;K++){const ie=K*this._granularityCellSize;n.push(this._vertexToIndex(ie,c+I*(ie-a)/C))}else for(let K=Z;K>=G;K--){const ie=K*this._granularityCellSize;n.push(this._vertexToIndex(ie,c+I*(ie-a)/C))}}_generateInterEdgeVertices(n,a,c,f,v,b,w,C,I,R){const L=v-c,$=b-f,G=w-v,Z=(I-v)/G,K=(R-v)/G,ie=Math.min(Z,K),he=Math.max(Z,K),ze=f+$*ie;let ge=Math.floor(Math.min(ze,C)/this._granularityCellSize)+1,U=Math.ceil(Math.max(ze,C)/this._granularityCellSize)-1,ne=C<ze;const ve=G===0;if(ve&&(w===I||w===R))return;if(ve||ie>=1||he<=0){const dt=c-w,Xe=b+(a-b)*Math.min((I-w)/dt,(R-w)/dt);ge=Math.floor(Math.min(Xe,C)/this._granularityCellSize)+1,U=Math.ceil(Math.max(Xe,C)/this._granularityCellSize)-1,ne=C<Xe}const He=L>0?R:I;if(ne)for(let dt=ge;dt<=U;dt++)n.push(this._vertexToIndex(dt*this._granularityCellSize,He));else for(let dt=U;dt>=ge;dt--)n.push(this._vertexToIndex(dt*this._granularityCellSize,He))}_generateOutline(n){const a=[];for(const c of n){const f=Al(c,this._granularity,!0),v=this._pointArrayToIndices(f),b=[];for(let w=1;w<v.length;w++)b.push(v[w-1]),b.push(v[w]);a.push(b)}return a}_handlePoles(n){let a=!1,c=!1;this._canonical&&(this._canonical.y===0&&(a=!0),this._canonical.y===(1<<this._canonical.z)-1&&(c=!0)),(a||c)&&this._fillPoles(n,a,c)}_ensureNoPoleVertices(){const n=this._vertexBuffer;for(let a=0;a<n.length;a+=2){const c=n[a+1];c===Gc&&(n[a+1]=-32767),c===Rh&&(n[a+1]=32766)}}_generatePoleQuad(n,a,c,f,v,b){f>v!=(b===Gc)?(n.push(a),n.push(c),n.push(this._vertexToIndex(f,b)),n.push(c),n.push(this._vertexToIndex(v,b)),n.push(this._vertexToIndex(f,b))):(n.push(c),n.push(a),n.push(this._vertexToIndex(f,b)),n.push(this._vertexToIndex(v,b)),n.push(c),n.push(this._vertexToIndex(f,b)))}_fillPoles(n,a,c){const f=this._vertexBuffer,v=Ne,b=n.length;for(let w=2;w<b;w+=3){const C=n[w-2],I=n[w-1],R=n[w],L=f[2*C],$=f[2*C+1],G=f[2*I],Z=f[2*I+1],K=f[2*R],ie=f[2*R+1];a&&($===0&&Z===0&&this._generatePoleQuad(n,C,I,L,G,Gc),Z===0&&ie===0&&this._generatePoleQuad(n,I,R,G,K,Gc),ie===0&&$===0&&this._generatePoleQuad(n,R,C,K,L,Gc)),c&&($===v&&Z===v&&this._generatePoleQuad(n,C,I,L,G,Rh),Z===v&&ie===v&&this._generatePoleQuad(n,I,R,G,K,Rh),ie===v&&$===v&&this._generatePoleQuad(n,R,C,K,L,Rh))}}_initializeVertices(n){for(let a=0;a<n.length;a+=2)this._vertexToIndex(n[a],n[a+1])}subdividePolygonInternal(n,a){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:c,holeIndices:f}=function(w){const C=[],I=[];for(const R of w)if(R.length!==0){R!==w[0]&&C.push(I.length/2);for(let L=0;L<R.length;L++)I.push(R[L].x),I.push(R[L].y)}return{flattened:I,holeIndices:C}}(n);let v;this._initializeVertices(c);try{const w=function(I,R,L=2){const $=R&&R.length,G=$?R[0]*L:I.length;let Z=wv(I,0,G,L,!0);const K=[];if(!Z||Z.next===Z.prev)return K;let ie,he,ze;if($&&(Z=function(ge,U,ne,ve){const He=[];for(let dt=0,Xe=U.length;dt<Xe;dt++){const nt=wv(ge,U[dt]*ve,dt<Xe-1?U[dt+1]*ve:ge.length,ve,!1);nt===nt.next&&(nt.steiner=!0),He.push(_2(nt))}He.sort(p2);for(let dt=0;dt<He.length;dt++)ne=m2(He[dt],ne);return ne}(I,R,Z,L)),I.length>80*L){ie=1/0,he=1/0;let ge=-1/0,U=-1/0;for(let ne=L;ne<G;ne+=L){const ve=I[ne],He=I[ne+1];ve<ie&&(ie=ve),He<he&&(he=He),ve>ge&&(ge=ve),He>U&&(U=He)}ze=Math.max(ge-ie,U-he),ze=ze!==0?32767/ze:0}return Ih(Z,K,L,ie,he,ze,0),K}(c,f),C=this._convertIndices(c,w);v=this._subdivideTrianglesScanline(C)}catch(w){console.error(w)}let b=[];return a&&(b=this._generateOutline(n)),this._ensureNoPoleVertices(),this._handlePoles(v),{verticesFlattened:this._vertexBuffer,indicesTriangles:v,indicesLineList:b}}_convertIndices(n,a){const c=[];for(let f=0;f<a.length;f++)c.push(this._vertexToIndex(n[2*a[f]],n[2*a[f]+1]));return c}_pointArrayToIndices(n){const a=[];for(let c=0;c<n.length;c++){const f=n[c];a.push(this._vertexToIndex(f.x,f.y))}return a}}function kv(s,n,a,c=!0){return new v2(a,n).subdividePolygonInternal(s,c)}function Al(s,n,a=!1){if(!s||s.length<1)return[];if(s.length<2)return[];const c=s[0],f=s[s.length-1],v=a&&(c.x!==f.x||c.y!==f.y);if(n<2)return v?[...s,s[0]]:[...s];const b=Math.floor(Ne/n),w=[];w.push(new F(s[0].x,s[0].y));const C=s.length,I=v?C:C-1;for(let R=0;R<I;R++){const L=s[R],$=R<C-1?s[R+1]:s[0],G=L.x,Z=L.y,K=$.x,ie=$.y,he=G!==K,ze=Z!==ie;if(!he&&!ze)continue;const ge=K-G,U=ie-Z,ne=Math.abs(ge),ve=Math.abs(U);let He=G,dt=Z;for(;;){const nt=ge>0?(Math.floor(He/b)+1)*b:(Math.ceil(He/b)-1)*b,yt=U>0?(Math.floor(dt/b)+1)*b:(Math.ceil(dt/b)-1)*b,pt=Math.abs(He-nt),bt=Math.abs(dt-yt),at=Math.abs(He-K),$t=Math.abs(dt-ie),Jt=he?pt/ne:Number.POSITIVE_INFINITY,Xt=ze?bt/ve:Number.POSITIVE_INFINITY;if((at<=pt||!he)&&($t<=bt||!ze))break;if(Jt<Xt&&he||!ze){He=nt,dt+=U*Jt;const Ut=new F(He,Math.round(dt));w[w.length-1].x===Ut.x&&w[w.length-1].y===Ut.y||w.push(Ut)}else{He+=ge*Xt,dt=yt;const Ut=new F(Math.round(He),dt);w[w.length-1].x===Ut.x&&w[w.length-1].y===Ut.y||w.push(Ut)}}const Xe=new F(K,ie);w[w.length-1].x===Xe.x&&w[w.length-1].y===Xe.y||w.push(Xe)}return w}function b2(s,n,a){if(n.length===0)throw new Error("Subdivision vertex ring is empty.");let c=0,f=s[2*n[0]];for(let C=1;C<n.length;C++){const I=s[2*n[C]];I<f&&(f=I,c=C)}const v=n.length;let b=c,w=(b+1)%v;for(;;){const C=b-1>=0?b-1:v-1,I=(w+1)%v,R=s[2*n[C]],L=s[2*n[I]],$=s[2*n[b]],G=s[2*n[b]+1],Z=s[2*n[w]+1];let K=!1;if(R<L)K=!0;else if(R>L)K=!1;else{const ie=Z-G,he=-(s[2*n[w]]-$),ze=G<Z?1:-1;((R-$)*ie+(s[2*n[C]+1]-G)*he)*ze>((L-$)*ie+(s[2*n[I]+1]-G)*he)*ze&&(K=!0)}if(K){const ie=n[C],he=n[b],ze=n[w];ie!==he&&ie!==ze&&he!==ze&&a.push(ze,he,ie),b--,b<0&&(b=v-1)}else{const ie=n[I],he=n[b],ze=n[w];ie!==he&&ie!==ze&&he!==ze&&a.push(ze,he,ie),w++,w>=v&&(w=0)}if(C===I)break}}function Iv(s,n,a,c,f,v,b,w,C){const I=f.length/2,R=b&&w&&C;if(I<Rt.MAX_VERTEX_ARRAY_LENGTH){const L=n.prepareSegment(I,a,c),$=L.vertexLength;for(let K=0;K<v.length;K+=3)c.emplaceBack($+v[K],$+v[K+1],$+v[K+2]);let G,Z;L.vertexLength+=I,L.primitiveLength+=v.length/3,R&&(Z=b.prepareSegment(I,a,w),G=Z.vertexLength,Z.vertexLength+=I);for(let K=0;K<f.length;K+=2)s(f[K],f[K+1]);if(R)for(let K=0;K<C.length;K++){const ie=C[K];for(let he=1;he<ie.length;he+=2)w.emplaceBack(G+ie[he-1],G+ie[he]);Z.primitiveLength+=ie.length/2}}else(function(L,$,G,Z,K,ie){const he=[];for(let ve=0;ve<Z.length/2;ve++)he.push(-1);const ze={count:0};let ge=0,U=L.getOrCreateLatestSegment($,G),ne=U.vertexLength;for(let ve=2;ve<K.length;ve+=3){const He=K[ve-2],dt=K[ve-1],Xe=K[ve];let nt=he[He]<ge,yt=he[dt]<ge,pt=he[Xe]<ge;U.vertexLength+((nt?1:0)+(yt?1:0)+(pt?1:0))>Rt.MAX_VERTEX_ARRAY_LENGTH&&(U=L.createNewSegment($,G),ge=ze.count,nt=!0,yt=!0,pt=!0,ne=0);const bt=Dh(he,Z,ie,ze,He,nt,U),at=Dh(he,Z,ie,ze,dt,yt,U),$t=Dh(he,Z,ie,ze,Xe,pt,U);G.emplaceBack(ne+bt-ge,ne+at-ge,ne+$t-ge),U.primitiveLength++}})(n,a,c,f,v,s),R&&function(L,$,G,Z,K,ie){const he=[];for(let ve=0;ve<Z.length/2;ve++)he.push(-1);const ze={count:0};let ge=0,U=L.getOrCreateLatestSegment($,G),ne=U.vertexLength;for(let ve=0;ve<K.length;ve++){const He=K[ve];for(let dt=1;dt<K[ve].length;dt+=2){const Xe=He[dt-1],nt=He[dt];let yt=he[Xe]<ge,pt=he[nt]<ge;U.vertexLength+((yt?1:0)+(pt?1:0))>Rt.MAX_VERTEX_ARRAY_LENGTH&&(U=L.createNewSegment($,G),ge=ze.count,yt=!0,pt=!0,ne=0);const bt=Dh(he,Z,ie,ze,Xe,yt,U),at=Dh(he,Z,ie,ze,nt,pt,U);G.emplaceBack(ne+bt-ge,ne+at-ge),U.primitiveLength++}}}(b,a,w,f,C,s),n.forceNewSegmentOnNextPrepare(),b==null||b.forceNewSegmentOnNextPrepare()}function Dh(s,n,a,c,f,v,b){if(v){const w=c.count;return a(n[2*f],n[2*f+1]),s[f]=c.count,c.count++,b.vertexLength++,w}return s[f]}class fg{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new fe,this.indexArray=new et,this.indexArray2=new Pt,this.programConfigurations=new xi(n.layers,n.zoom),this.segments=new Rt,this.segments2=new Rt,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(n,a,c){this.hasPattern=cg("fill",this.layers,a);const f=this.layers[0].layout.get("fill-sort-key"),v=!f.isConstant(),b=[];for(const{feature:w,id:C,index:I,sourceLayerIndex:R}of n){const L=this.layers[0]._featureFilter.needGeometry,$=Zs(w,L);if(!this.layers[0]._featureFilter.filter(new fi(this.zoom),$,c))continue;const G=v?f.evaluate($,{},c,a.availableImages):void 0,Z={id:C,properties:w.properties,type:w.type,sourceLayerIndex:R,index:I,geometry:L?$.geometry:Hs(w),patterns:{},sortKey:G};b.push(Z)}v&&b.sort((w,C)=>w.sortKey-C.sortKey);for(const w of b){const{geometry:C,index:I,sourceLayerIndex:R}=w;if(this.hasPattern){const L=ug("fill",this.layers,w,this.zoom,a);this.patternFeatures.push(L)}else this.addFeature(w,C,I,c,{},a.subdivisionGranularity);a.featureIndex.insert(n[I].feature,C,I,R,this.index)}}update(n,a,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,a,this.stateDependentLayers,c)}addFeatures(n,a,c){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,a,c,n.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,c2),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,a,c,f,v,b){for(const w of uc(a,500)){const C=kv(w,f,b.fill.getGranularityForZoomLevel(f.z)),I=this.layoutVertexArray;Iv((R,L)=>{I.emplaceBack(R,L)},this.segments,this.layoutVertexArray,this.indexArray,C.verticesFlattened,C.indicesTriangles,this.segments2,this.indexArray2,C.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,v,f)}}let Mv,Ev;Bt("FillBucket",fg,{omit:["layers","patternFeatures"]});var x2={get paint(){return Ev=Ev||new Er({"fill-antialias":new Ht(ae.paint_fill["fill-antialias"]),"fill-opacity":new rn(ae.paint_fill["fill-opacity"]),"fill-color":new rn(ae.paint_fill["fill-color"]),"fill-outline-color":new rn(ae.paint_fill["fill-outline-color"]),"fill-translate":new Ht(ae.paint_fill["fill-translate"]),"fill-translate-anchor":new Ht(ae.paint_fill["fill-translate-anchor"]),"fill-pattern":new xl(ae.paint_fill["fill-pattern"])})},get layout(){return Mv=Mv||new Er({"fill-sort-key":new rn(ae.layout_fill["fill-sort-key"])})}};class w2 extends Ma{constructor(n){super(n,x2)}recalculate(n,a){super.recalculate(n,a);const c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new fg(n)}queryRadius(){return Uf(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:n,geometry:a,transform:c,pixelsToTileUnits:f}){return Ch(Gf(n,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-c.bearingInRadians,f),a)}isTileClipped(){return!0}}const S2=zi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),C2=zi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:T2}=S2;var pg,Av,mg,Rv,gg,Dv,zv,Wf={};function Lv(){if(Av)return pg;Av=1;var s=D();function n(f,v,b,w,C){this.properties={},this.extent=b,this.type=0,this._pbf=f,this._geometry=-1,this._keys=w,this._values=C,f.readFields(a,this,v)}function a(f,v,b){f==1?v.id=b.readVarint():f==2?function(w,C){for(var I=w.readVarint()+w.pos;w.pos<I;){var R=C._keys[w.readVarint()],L=C._values[w.readVarint()];C.properties[R]=L}}(b,v):f==3?v.type=b.readVarint():f==4&&(v._geometry=b.pos)}function c(f){for(var v,b,w=0,C=0,I=f.length,R=I-1;C<I;R=C++)w+=((b=f[R]).x-(v=f[C]).x)*(v.y+b.y);return w}return pg=n,n.types=["Unknown","Point","LineString","Polygon"],n.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var v,b=f.readVarint()+f.pos,w=1,C=0,I=0,R=0,L=[];f.pos<b;){if(C<=0){var $=f.readVarint();w=7&$,C=$>>3}if(C--,w===1||w===2)I+=f.readSVarint(),R+=f.readSVarint(),w===1&&(v&&L.push(v),v=[]),v.push(new s(I,R));else{if(w!==7)throw new Error("unknown command "+w);v&&v.push(v[0].clone())}}return v&&L.push(v),L},n.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var v=f.readVarint()+f.pos,b=1,w=0,C=0,I=0,R=1/0,L=-1/0,$=1/0,G=-1/0;f.pos<v;){if(w<=0){var Z=f.readVarint();b=7&Z,w=Z>>3}if(w--,b===1||b===2)(C+=f.readSVarint())<R&&(R=C),C>L&&(L=C),(I+=f.readSVarint())<$&&($=I),I>G&&(G=I);else if(b!==7)throw new Error("unknown command "+b)}return[R,$,L,G]},n.prototype.toGeoJSON=function(f,v,b){var w,C,I=this.extent*Math.pow(2,b),R=this.extent*f,L=this.extent*v,$=this.loadGeometry(),G=n.types[this.type];function Z(he){for(var ze=0;ze<he.length;ze++){var ge=he[ze];he[ze]=[360*(ge.x+R)/I-180,360/Math.PI*Math.atan(Math.exp((180-360*(ge.y+L)/I)*Math.PI/180))-90]}}switch(this.type){case 1:var K=[];for(w=0;w<$.length;w++)K[w]=$[w][0];Z($=K);break;case 2:for(w=0;w<$.length;w++)Z($[w]);break;case 3:for($=function(he){var ze=he.length;if(ze<=1)return[he];for(var ge,U,ne=[],ve=0;ve<ze;ve++){var He=c(he[ve]);He!==0&&(U===void 0&&(U=He<0),U===He<0?(ge&&ne.push(ge),ge=[he[ve]]):ge.push(he[ve]))}return ge&&ne.push(ge),ne}($),w=0;w<$.length;w++)for(C=0;C<$[w].length;C++)Z($[w][C])}$.length===1?$=$[0]:G="Multi"+G;var ie={type:"Feature",geometry:{type:G,coordinates:$},properties:this.properties};return"id"in this&&(ie.id=this.id),ie},pg}function Bv(){if(Rv)return mg;Rv=1;var s=Lv();function n(c,f){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(a,this,f),this.length=this._features.length}function a(c,f,v){c===15?f.version=v.readVarint():c===1?f.name=v.readString():c===5?f.extent=v.readVarint():c===2?f._features.push(v.pos):c===3?f._keys.push(v.readString()):c===4&&f._values.push(function(b){for(var w=null,C=b.readVarint()+b.pos;b.pos<C;){var I=b.readVarint()>>3;w=I===1?b.readString():I===2?b.readFloat():I===3?b.readDouble():I===4?b.readVarint64():I===5?b.readVarint():I===6?b.readSVarint():I===7?b.readBoolean():null}return w}(v))}return mg=n,n.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var f=this._pbf.readVarint()+this._pbf.pos;return new s(this._pbf,f,this.extent,this._keys,this._values)},mg}function Fv(){return zv||(zv=1,Wf.VectorTile=function(){if(Dv)return gg;Dv=1;var s=Bv();function n(a,c,f){if(a===3){var v=new s(f,f.readVarint()+f.pos);v.length&&(c[v.name]=v)}}return gg=function(a,c){this.layers=a.readFields(n,{},c)},gg}(),Wf.VectorTileFeature=Lv(),Wf.VectorTileLayer=Bv()),Wf}var zh=T(Fv());const P2=zh.VectorTileFeature.types,_g=Math.pow(2,13);function Lh(s,n,a,c,f,v,b,w){s.emplaceBack(n,a,2*Math.floor(c*_g)+b,f*_g*2,v*_g*2,Math.round(w))}class yg{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new we,this.centroidVertexArray=new se,this.indexArray=new et,this.programConfigurations=new xi(n.layers,n.zoom),this.segments=new Rt,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(n,a,c){this.features=[],this.hasPattern=cg("fill-extrusion",this.layers,a);for(const{feature:f,id:v,index:b,sourceLayerIndex:w}of n){const C=this.layers[0]._featureFilter.needGeometry,I=Zs(f,C);if(!this.layers[0]._featureFilter.filter(new fi(this.zoom),I,c))continue;const R={id:v,sourceLayerIndex:w,index:b,geometry:C?I.geometry:Hs(f),properties:f.properties,type:f.type,patterns:{}};this.hasPattern?this.features.push(ug("fill-extrusion",this.layers,R,this.zoom,a)):this.addFeature(R,R.geometry,b,c,{},a.subdivisionGranularity),a.featureIndex.insert(f,R.geometry,b,w,this.index,!0)}}addFeatures(n,a,c){for(const f of this.features){const{geometry:v}=f;this.addFeature(f,v,f.index,a,c,n.subdivisionGranularity)}}update(n,a,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,a,this.stateDependentLayers,c)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,T2),this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,C2.members,!0),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(n,a,c,f,v,b){for(const w of uc(a,500)){const C={x:0,y:0,sampleCount:0},I=this.layoutVertexArray.length;this.processPolygon(C,f,n,w,b);const R=this.layoutVertexArray.length-I,L=Math.floor(C.x/C.sampleCount),$=Math.floor(C.y/C.sampleCount);for(let G=0;G<R;G++)this.centroidVertexArray.emplaceBack(L,$)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,v,f)}processPolygon(n,a,c,f,v){if(f.length<1||Ov(f[0]))return;for(const L of f)L.length!==0&&k2(n,L);const b={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},w=v.fill.getGranularityForZoomLevel(a.z),C=P2[c.type]==="Polygon";for(const L of f){if(L.length===0||Ov(L))continue;const $=Al(L,w,C);this._generateSideFaces($,b)}if(!C)return;const I=kv(f,a,w,!1),R=this.layoutVertexArray;Iv((L,$)=>{Lh(R,L,$,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,I.verticesFlattened,I.indicesTriangles)}_generateSideFaces(n,a){let c=0;for(let f=1;f<n.length;f++){const v=n[f],b=n[f-1];if(I2(v,b))continue;a.segment.vertexLength+4>Rt.MAX_VERTEX_ARRAY_LENGTH&&(a.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const w=v.sub(b)._perp()._unit(),C=b.dist(v);c+C>32768&&(c=0),Lh(this.layoutVertexArray,v.x,v.y,w.x,w.y,0,0,c),Lh(this.layoutVertexArray,v.x,v.y,w.x,w.y,0,1,c),c+=C,Lh(this.layoutVertexArray,b.x,b.y,w.x,w.y,0,0,c),Lh(this.layoutVertexArray,b.x,b.y,w.x,w.y,0,1,c);const I=a.segment.vertexLength;this.indexArray.emplaceBack(I,I+2,I+1),this.indexArray.emplaceBack(I+1,I+2,I+3),a.segment.vertexLength+=4,a.segment.primitiveLength+=2}}}function k2(s,n){for(let a=0;a<n.length;a++){const c=n[a];a===n.length-1&&n[0].x===c.x&&n[0].y===c.y||(s.x+=c.x,s.y+=c.y,s.sampleCount++)}}function I2(s,n){return s.x===n.x&&(s.x<0||s.x>Ne)||s.y===n.y&&(s.y<0||s.y>Ne)}function Ov(s){return s.every(n=>n.x<0)||s.every(n=>n.x>Ne)||s.every(n=>n.y<0)||s.every(n=>n.y>Ne)}let Vv;Bt("FillExtrusionBucket",yg,{omit:["layers","features"]});var M2={get paint(){return Vv=Vv||new Er({"fill-extrusion-opacity":new Ht(ae["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new rn(ae["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ht(ae["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ht(ae["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new xl(ae["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new rn(ae["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new rn(ae["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ht(ae["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class E2 extends Ma{constructor(n){super(n,M2)}createBucket(n){return new yg(n)}queryRadius(){return Uf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:n,feature:a,featureState:c,geometry:f,transform:v,pixelsToTileUnits:b,pixelPosMatrix:w}){const C=Gf(n,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-v.bearingInRadians,b),I=this.paint.get("fill-extrusion-height").evaluate(a,c),R=this.paint.get("fill-extrusion-base").evaluate(a,c),L=function(G,Z,K){const ie=[];for(const he of G){const ze=[he.x,he.y,0,1];xe(ze,ze,Z),ie.push(new F(ze[0]/ze[3],ze[1]/ze[3]))}return ie}(C,w),$=function(G,Z,K,ie){const he=[],ze=[],ge=ie[8]*Z,U=ie[9]*Z,ne=ie[10]*Z,ve=ie[11]*Z,He=ie[8]*K,dt=ie[9]*K,Xe=ie[10]*K,nt=ie[11]*K;for(const yt of G){const pt=[],bt=[];for(const at of yt){const $t=at.x,Jt=at.y,Xt=ie[0]*$t+ie[4]*Jt+ie[12],Ut=ie[1]*$t+ie[5]*Jt+ie[13],Mn=ie[2]*$t+ie[6]*Jt+ie[14],Ii=ie[3]*$t+ie[7]*Jt+ie[15],Yi=Mn+ne,_r=Ii+ve,pa=Xt+He,Gr=Ut+dt,lr=Mn+Xe,wi=Ii+nt,tr=new F((Xt+ge)/_r,(Ut+U)/_r);tr.z=Yi/_r,pt.push(tr);const cr=new F(pa/wi,Gr/wi);cr.z=lr/wi,bt.push(cr)}he.push(pt),ze.push(bt)}return[he,ze]}(f,R,I,w);return function(G,Z,K){let ie=1/0;Ch(K,Z)&&(ie=Nv(K,Z[0]));for(let he=0;he<Z.length;he++){const ze=Z[he],ge=G[he];for(let U=0;U<ze.length-1;U++){const ne=ze[U],ve=[ne,ze[U+1],ge[U+1],ge[U],ne];wh(K,ve)&&(ie=Math.min(ie,Nv(K,ve)))}}return ie!==1/0&&ie}($[0],$[1],L)}}function Bh(s,n){return s.x*n.x+s.y*n.y}function Nv(s,n){if(s.length===1){let a=0;const c=n[a++];let f;for(;!f||c.equals(f);)if(f=n[a++],!f)return 1/0;for(;a<n.length;a++){const v=n[a],b=s[0],w=f.sub(c),C=v.sub(c),I=b.sub(c),R=Bh(w,w),L=Bh(w,C),$=Bh(C,C),G=Bh(I,w),Z=Bh(I,C),K=R*$-L*L,ie=($*G-L*Z)/K,he=(R*Z-L*G)/K,ze=c.z*(1-ie-he)+f.z*ie+v.z*he;if(isFinite(ze))return ze}return 1/0}{let a=1/0;for(const c of n)a=Math.min(a,c.z);return a}}const A2=zi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:R2}=A2,D2=zi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:z2}=D2,L2=zh.VectorTileFeature.types,B2=Math.cos(Math.PI/180*37.5),$v=Math.pow(2,14)/.5;class vg{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new Te,this.layoutVertexArray2=new Ie,this.indexArray=new et,this.programConfigurations=new xi(n.layers,n.zoom),this.segments=new Rt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(n,a,c){this.hasPattern=cg("line",this.layers,a);const f=this.layers[0].layout.get("line-sort-key"),v=!f.isConstant(),b=[];for(const{feature:w,id:C,index:I,sourceLayerIndex:R}of n){const L=this.layers[0]._featureFilter.needGeometry,$=Zs(w,L);if(!this.layers[0]._featureFilter.filter(new fi(this.zoom),$,c))continue;const G=v?f.evaluate($,{},c):void 0,Z={id:C,properties:w.properties,type:w.type,sourceLayerIndex:R,index:I,geometry:L?$.geometry:Hs(w),patterns:{},sortKey:G};b.push(Z)}v&&b.sort((w,C)=>w.sortKey-C.sortKey);for(const w of b){const{geometry:C,index:I,sourceLayerIndex:R}=w;if(this.hasPattern){const L=ug("line",this.layers,w,this.zoom,a);this.patternFeatures.push(L)}else this.addFeature(w,C,I,c,{},a.subdivisionGranularity);a.featureIndex.insert(n[I].feature,C,I,R,this.index)}}update(n,a,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,a,this.stateDependentLayers,c)}addFeatures(n,a,c){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,a,c,n.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,z2)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,R2),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,a,c,f,v,b){const w=this.layers[0].layout,C=w.get("line-join").evaluate(n,{}),I=w.get("line-cap"),R=w.get("line-miter-limit"),L=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const $ of a)this.addLine($,n,C,I,R,L,f,b);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,v,f)}addLine(n,a,c,f,v,b,w,C){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,n=Al(n,w?C.line.getGranularityForZoomLevel(w.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ge=0;ge<n.length-1;ge++)this.totalDistance+=n[ge].dist(n[ge+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const I=L2[a.type]==="Polygon";let R=n.length;for(;R>=2&&n[R-1].equals(n[R-2]);)R--;let L=0;for(;L<R-1&&n[L].equals(n[L+1]);)L++;if(R<(I?3:2))return;c==="bevel"&&(v=1.05);const $=this.overscaling<=16?15*Ne/(512*this.overscaling):0,G=this.segments.prepareSegment(10*R,this.layoutVertexArray,this.indexArray);let Z,K,ie,he,ze;this.e1=this.e2=-1,I&&(Z=n[R-2],ze=n[L].sub(Z)._unit()._perp());for(let ge=L;ge<R;ge++){if(ie=ge===R-1?I?n[L+1]:void 0:n[ge+1],ie&&n[ge].equals(ie))continue;ze&&(he=ze),Z&&(K=Z),Z=n[ge],ze=ie?ie.sub(Z)._unit()._perp():he,he=he||ze;let U=he.add(ze);U.x===0&&U.y===0||U._unit();const ne=he.x*ze.x+he.y*ze.y,ve=U.x*ze.x+U.y*ze.y,He=ve!==0?1/ve:1/0,dt=2*Math.sqrt(2-2*ve),Xe=ve<B2&&K&&ie,nt=he.x*ze.y-he.y*ze.x>0;if(Xe&&ge>L){const bt=Z.dist(K);if(bt>2*$){const at=Z.sub(Z.sub(K)._mult($/bt)._round());this.updateDistance(K,at),this.addCurrentVertex(at,he,0,0,G),K=at}}const yt=K&&ie;let pt=yt?c:I?"butt":f;if(yt&&pt==="round"&&(He<b?pt="miter":He<=2&&(pt="fakeround")),pt==="miter"&&He>v&&(pt="bevel"),pt==="bevel"&&(He>2&&(pt="flipbevel"),He<v&&(pt="miter")),K&&this.updateDistance(K,Z),pt==="miter")U._mult(He),this.addCurrentVertex(Z,U,0,0,G);else if(pt==="flipbevel"){if(He>100)U=ze.mult(-1);else{const bt=He*he.add(ze).mag()/he.sub(ze).mag();U._perp()._mult(bt*(nt?-1:1))}this.addCurrentVertex(Z,U,0,0,G),this.addCurrentVertex(Z,U.mult(-1),0,0,G)}else if(pt==="bevel"||pt==="fakeround"){const bt=-Math.sqrt(He*He-1),at=nt?bt:0,$t=nt?0:bt;if(K&&this.addCurrentVertex(Z,he,at,$t,G),pt==="fakeround"){const Jt=Math.round(180*dt/Math.PI/20);for(let Xt=1;Xt<Jt;Xt++){let Ut=Xt/Jt;if(Ut!==.5){const Ii=Ut-.5;Ut+=Ut*Ii*(Ut-1)*((1.0904+ne*(ne*(3.55645-1.43519*ne)-3.2452))*Ii*Ii+(.848013+ne*(.215638*ne-1.06021)))}const Mn=ze.sub(he)._mult(Ut)._add(he)._unit()._mult(nt?-1:1);this.addHalfVertex(Z,Mn.x,Mn.y,!1,nt,0,G)}}ie&&this.addCurrentVertex(Z,ze,-at,-$t,G)}else if(pt==="butt")this.addCurrentVertex(Z,U,0,0,G);else if(pt==="square"){const bt=K?1:-1;this.addCurrentVertex(Z,U,bt,bt,G)}else pt==="round"&&(K&&(this.addCurrentVertex(Z,he,0,0,G),this.addCurrentVertex(Z,he,1,1,G,!0)),ie&&(this.addCurrentVertex(Z,ze,-1,-1,G,!0),this.addCurrentVertex(Z,ze,0,0,G)));if(Xe&&ge<R-1){const bt=Z.dist(ie);if(bt>2*$){const at=Z.add(ie.sub(Z)._mult($/bt)._round());this.updateDistance(Z,at),this.addCurrentVertex(at,ze,0,0,G),Z=at}}}}addCurrentVertex(n,a,c,f,v,b=!1){const w=a.y*f-a.x,C=-a.y-a.x*f;this.addHalfVertex(n,a.x+a.y*c,a.y-a.x*c,b,!1,c,v),this.addHalfVertex(n,w,C,b,!0,-f,v),this.distance>$v/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(n,a,c,f,v,b))}addHalfVertex({x:n,y:a},c,f,v,b,w,C){const I=.5*(this.lineClips?this.scaledDistance*($v-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((n<<1)+(v?1:0),(a<<1)+(b?1:0),Math.round(63*c)+128,Math.round(63*f)+128,1+(w===0?0:w<0?-1:1)|(63&I)<<2,I>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const R=C.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,R,this.e2),C.primitiveLength++),b?this.e2=R:this.e1=R}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(n,a){this.distance+=n.dist(a),this.updateScaledDistance()}}let jv,Uv;Bt("LineBucket",vg,{omit:["layers","patternFeatures"]});var Gv={get paint(){return Uv=Uv||new Er({"line-opacity":new rn(ae.paint_line["line-opacity"]),"line-color":new rn(ae.paint_line["line-color"]),"line-translate":new Ht(ae.paint_line["line-translate"]),"line-translate-anchor":new Ht(ae.paint_line["line-translate-anchor"]),"line-width":new rn(ae.paint_line["line-width"]),"line-gap-width":new rn(ae.paint_line["line-gap-width"]),"line-offset":new rn(ae.paint_line["line-offset"]),"line-blur":new rn(ae.paint_line["line-blur"]),"line-dasharray":new Bc(ae.paint_line["line-dasharray"]),"line-pattern":new xl(ae.paint_line["line-pattern"]),"line-gradient":new Fc(ae.paint_line["line-gradient"])})},get layout(){return jv=jv||new Er({"line-cap":new Ht(ae.layout_line["line-cap"]),"line-join":new rn(ae.layout_line["line-join"]),"line-miter-limit":new Ht(ae.layout_line["line-miter-limit"]),"line-round-limit":new Ht(ae.layout_line["line-round-limit"]),"line-sort-key":new rn(ae.layout_line["line-sort-key"])})}};class F2 extends rn{possiblyEvaluate(n,a){return a=new fi(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition}),super.possiblyEvaluate(n,a)}evaluate(n,a,c,f){return a=Kt({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(n,a,c,f)}}let Xf;class O2 extends Ma{constructor(n){super(n,Gv),this.gradientVersion=0,Xf||(Xf=new F2(Gv.paint.properties["line-width"].specification),Xf.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const a=this.gradientExpression();this.stepInterpolant=!!function(c){return c._styleExpression!==void 0}(a)&&a._styleExpression.expression instanceof zs,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,a){super.recalculate(n,a),this.paint._values["line-floorwidth"]=Xf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new vg(n)}queryRadius(n){const a=n,c=Hv(Ph("line-width",this,a),Ph("line-gap-width",this,a)),f=Ph("line-offset",this,a);return c/2+Math.abs(f)+Uf(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:n,feature:a,featureState:c,geometry:f,transform:v,pixelsToTileUnits:b}){const w=Gf(n,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-v.bearingInRadians,b),C=b/2*Hv(this.paint.get("line-width").evaluate(a,c),this.paint.get("line-gap-width").evaluate(a,c)),I=this.paint.get("line-offset").evaluate(a,c);return I&&(f=function(R,L){const $=[];for(let G=0;G<R.length;G++){const Z=R[G],K=[];for(let ie=0;ie<Z.length;ie++){const he=Z[ie-1],ze=Z[ie],ge=Z[ie+1],U=ie===0?new F(0,0):ze.sub(he)._unit()._perp(),ne=ie===Z.length-1?new F(0,0):ge.sub(ze)._unit()._perp(),ve=U._add(ne)._unit(),He=ve.x*ne.x+ve.y*ne.y;He!==0&&ve._mult(1/He),K.push(ve._mult(L)._add(ze))}$.push(K)}return $}(f,I*b)),function(R,L,$){for(let G=0;G<L.length;G++){const Z=L[G];if(R.length>=3){for(let K=0;K<Z.length;K++)if($c(R,Z[K]))return!0}if(Th(R,Z,$))return!0}return!1}(w,f,C)}isTileClipped(){return!0}}function Hv(s,n){return n>0?n+2*s:s}const V2=zi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),N2=zi([{name:"a_projected_pos",components:3,type:"Float32"}],4);zi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const $2=zi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);zi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Zv=zi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),j2=zi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function U2(s,n,a){return s.sections.forEach(c=>{c.text=function(f,v,b){const w=v.layout.get("text-transform").evaluate(b,{});return w==="uppercase"?f=f.toLocaleUpperCase():w==="lowercase"&&(f=f.toLocaleLowerCase()),Za.applyArabicShaping&&(f=Za.applyArabicShaping(f)),f}(c.text,n,a)}),s}zi([{name:"triangle",components:3,type:"Uint16"}]),zi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),zi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),zi([{type:"Float32",name:"offsetX"}]),zi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),zi([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Fh={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var qv,bg,Wv,Ki=24,xg={};function G2(){return qv||(qv=1,xg.read=function(s,n,a,c,f){var v,b,w=8*f-c-1,C=(1<<w)-1,I=C>>1,R=-7,L=a?f-1:0,$=a?-1:1,G=s[n+L];for(L+=$,v=G&(1<<-R)-1,G>>=-R,R+=w;R>0;v=256*v+s[n+L],L+=$,R-=8);for(b=v&(1<<-R)-1,v>>=-R,R+=c;R>0;b=256*b+s[n+L],L+=$,R-=8);if(v===0)v=1-I;else{if(v===C)return b?NaN:1/0*(G?-1:1);b+=Math.pow(2,c),v-=I}return(G?-1:1)*b*Math.pow(2,v-c)},xg.write=function(s,n,a,c,f,v){var b,w,C,I=8*v-f-1,R=(1<<I)-1,L=R>>1,$=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,G=c?0:v-1,Z=c?1:-1,K=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(w=isNaN(n)?1:0,b=R):(b=Math.floor(Math.log(n)/Math.LN2),n*(C=Math.pow(2,-b))<1&&(b--,C*=2),(n+=b+L>=1?$/C:$*Math.pow(2,1-L))*C>=2&&(b++,C/=2),b+L>=R?(w=0,b=R):b+L>=1?(w=(n*C-1)*Math.pow(2,f),b+=L):(w=n*Math.pow(2,L-1)*Math.pow(2,f),b=0));f>=8;s[a+G]=255&w,G+=Z,w/=256,f-=8);for(b=b<<f|w,I+=f;I>0;s[a+G]=255&b,G+=Z,b/=256,I-=8);s[a+G-Z]|=128*K}),xg}function Xv(){if(Wv)return bg;Wv=1,bg=n;var s=G2();function n(U){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(U)?U:new Uint8Array(U||0),this.pos=0,this.type=0,this.length=this.buf.length}n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var a=4294967296,c=1/a,f=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function v(U){return U.type===n.Bytes?U.readVarint()+U.pos:U.pos+1}function b(U,ne,ve){return ve?4294967296*ne+(U>>>0):4294967296*(ne>>>0)+(U>>>0)}function w(U,ne,ve){var He=ne<=16383?1:ne<=2097151?2:ne<=268435455?3:Math.floor(Math.log(ne)/(7*Math.LN2));ve.realloc(He);for(var dt=ve.pos-1;dt>=U;dt--)ve.buf[dt+He]=ve.buf[dt]}function C(U,ne){for(var ve=0;ve<U.length;ve++)ne.writeVarint(U[ve])}function I(U,ne){for(var ve=0;ve<U.length;ve++)ne.writeSVarint(U[ve])}function R(U,ne){for(var ve=0;ve<U.length;ve++)ne.writeFloat(U[ve])}function L(U,ne){for(var ve=0;ve<U.length;ve++)ne.writeDouble(U[ve])}function $(U,ne){for(var ve=0;ve<U.length;ve++)ne.writeBoolean(U[ve])}function G(U,ne){for(var ve=0;ve<U.length;ve++)ne.writeFixed32(U[ve])}function Z(U,ne){for(var ve=0;ve<U.length;ve++)ne.writeSFixed32(U[ve])}function K(U,ne){for(var ve=0;ve<U.length;ve++)ne.writeFixed64(U[ve])}function ie(U,ne){for(var ve=0;ve<U.length;ve++)ne.writeSFixed64(U[ve])}function he(U,ne){return(U[ne]|U[ne+1]<<8|U[ne+2]<<16)+16777216*U[ne+3]}function ze(U,ne,ve){U[ve]=ne,U[ve+1]=ne>>>8,U[ve+2]=ne>>>16,U[ve+3]=ne>>>24}function ge(U,ne){return(U[ne]|U[ne+1]<<8|U[ne+2]<<16)+(U[ne+3]<<24)}return n.prototype={destroy:function(){this.buf=null},readFields:function(U,ne,ve){for(ve=ve||this.length;this.pos<ve;){var He=this.readVarint(),dt=He>>3,Xe=this.pos;this.type=7&He,U(dt,ne,this),this.pos===Xe&&this.skip(He)}return ne},readMessage:function(U,ne){return this.readFields(U,ne,this.readVarint()+this.pos)},readFixed32:function(){var U=he(this.buf,this.pos);return this.pos+=4,U},readSFixed32:function(){var U=ge(this.buf,this.pos);return this.pos+=4,U},readFixed64:function(){var U=he(this.buf,this.pos)+he(this.buf,this.pos+4)*a;return this.pos+=8,U},readSFixed64:function(){var U=he(this.buf,this.pos)+ge(this.buf,this.pos+4)*a;return this.pos+=8,U},readFloat:function(){var U=s.read(this.buf,this.pos,!0,23,4);return this.pos+=4,U},readDouble:function(){var U=s.read(this.buf,this.pos,!0,52,8);return this.pos+=8,U},readVarint:function(U){var ne,ve,He=this.buf;return ne=127&(ve=He[this.pos++]),ve<128?ne:(ne|=(127&(ve=He[this.pos++]))<<7,ve<128?ne:(ne|=(127&(ve=He[this.pos++]))<<14,ve<128?ne:(ne|=(127&(ve=He[this.pos++]))<<21,ve<128?ne:function(dt,Xe,nt){var yt,pt,bt=nt.buf;if(yt=(112&(pt=bt[nt.pos++]))>>4,pt<128||(yt|=(127&(pt=bt[nt.pos++]))<<3,pt<128)||(yt|=(127&(pt=bt[nt.pos++]))<<10,pt<128)||(yt|=(127&(pt=bt[nt.pos++]))<<17,pt<128)||(yt|=(127&(pt=bt[nt.pos++]))<<24,pt<128)||(yt|=(1&(pt=bt[nt.pos++]))<<31,pt<128))return b(dt,yt,Xe);throw new Error("Expected varint not more than 10 bytes")}(ne|=(15&(ve=He[this.pos]))<<28,U,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var U=this.readVarint();return U%2==1?(U+1)/-2:U/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var U=this.readVarint()+this.pos,ne=this.pos;return this.pos=U,U-ne>=12&&f?function(ve,He,dt){return f.decode(ve.subarray(He,dt))}(this.buf,ne,U):function(ve,He,dt){for(var Xe="",nt=He;nt<dt;){var yt,pt,bt,at=ve[nt],$t=null,Jt=at>239?4:at>223?3:at>191?2:1;if(nt+Jt>dt)break;Jt===1?at<128&&($t=at):Jt===2?(192&(yt=ve[nt+1]))==128&&($t=(31&at)<<6|63&yt)<=127&&($t=null):Jt===3?(pt=ve[nt+2],(192&(yt=ve[nt+1]))==128&&(192&pt)==128&&(($t=(15&at)<<12|(63&yt)<<6|63&pt)<=2047||$t>=55296&&$t<=57343)&&($t=null)):Jt===4&&(pt=ve[nt+2],bt=ve[nt+3],(192&(yt=ve[nt+1]))==128&&(192&pt)==128&&(192&bt)==128&&(($t=(15&at)<<18|(63&yt)<<12|(63&pt)<<6|63&bt)<=65535||$t>=1114112)&&($t=null)),$t===null?($t=65533,Jt=1):$t>65535&&($t-=65536,Xe+=String.fromCharCode($t>>>10&1023|55296),$t=56320|1023&$t),Xe+=String.fromCharCode($t),nt+=Jt}return Xe}(this.buf,ne,U)},readBytes:function(){var U=this.readVarint()+this.pos,ne=this.buf.subarray(this.pos,U);return this.pos=U,ne},readPackedVarint:function(U,ne){if(this.type!==n.Bytes)return U.push(this.readVarint(ne));var ve=v(this);for(U=U||[];this.pos<ve;)U.push(this.readVarint(ne));return U},readPackedSVarint:function(U){if(this.type!==n.Bytes)return U.push(this.readSVarint());var ne=v(this);for(U=U||[];this.pos<ne;)U.push(this.readSVarint());return U},readPackedBoolean:function(U){if(this.type!==n.Bytes)return U.push(this.readBoolean());var ne=v(this);for(U=U||[];this.pos<ne;)U.push(this.readBoolean());return U},readPackedFloat:function(U){if(this.type!==n.Bytes)return U.push(this.readFloat());var ne=v(this);for(U=U||[];this.pos<ne;)U.push(this.readFloat());return U},readPackedDouble:function(U){if(this.type!==n.Bytes)return U.push(this.readDouble());var ne=v(this);for(U=U||[];this.pos<ne;)U.push(this.readDouble());return U},readPackedFixed32:function(U){if(this.type!==n.Bytes)return U.push(this.readFixed32());var ne=v(this);for(U=U||[];this.pos<ne;)U.push(this.readFixed32());return U},readPackedSFixed32:function(U){if(this.type!==n.Bytes)return U.push(this.readSFixed32());var ne=v(this);for(U=U||[];this.pos<ne;)U.push(this.readSFixed32());return U},readPackedFixed64:function(U){if(this.type!==n.Bytes)return U.push(this.readFixed64());var ne=v(this);for(U=U||[];this.pos<ne;)U.push(this.readFixed64());return U},readPackedSFixed64:function(U){if(this.type!==n.Bytes)return U.push(this.readSFixed64());var ne=v(this);for(U=U||[];this.pos<ne;)U.push(this.readSFixed64());return U},skip:function(U){var ne=7&U;if(ne===n.Varint)for(;this.buf[this.pos++]>127;);else if(ne===n.Bytes)this.pos=this.readVarint()+this.pos;else if(ne===n.Fixed32)this.pos+=4;else{if(ne!==n.Fixed64)throw new Error("Unimplemented type: "+ne);this.pos+=8}},writeTag:function(U,ne){this.writeVarint(U<<3|ne)},realloc:function(U){for(var ne=this.length||16;ne<this.pos+U;)ne*=2;if(ne!==this.length){var ve=new Uint8Array(ne);ve.set(this.buf),this.buf=ve,this.length=ne}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(U){this.realloc(4),ze(this.buf,U,this.pos),this.pos+=4},writeSFixed32:function(U){this.realloc(4),ze(this.buf,U,this.pos),this.pos+=4},writeFixed64:function(U){this.realloc(8),ze(this.buf,-1&U,this.pos),ze(this.buf,Math.floor(U*c),this.pos+4),this.pos+=8},writeSFixed64:function(U){this.realloc(8),ze(this.buf,-1&U,this.pos),ze(this.buf,Math.floor(U*c),this.pos+4),this.pos+=8},writeVarint:function(U){(U=+U||0)>268435455||U<0?function(ne,ve){var He,dt;if(ne>=0?(He=ne%4294967296|0,dt=ne/4294967296|0):(dt=~(-ne/4294967296),4294967295^(He=~(-ne%4294967296))?He=He+1|0:(He=0,dt=dt+1|0)),ne>=18446744073709552e3||ne<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ve.realloc(10),function(Xe,nt,yt){yt.buf[yt.pos++]=127&Xe|128,Xe>>>=7,yt.buf[yt.pos++]=127&Xe|128,Xe>>>=7,yt.buf[yt.pos++]=127&Xe|128,Xe>>>=7,yt.buf[yt.pos++]=127&Xe|128,yt.buf[yt.pos]=127&(Xe>>>=7)}(He,0,ve),function(Xe,nt){var yt=(7&Xe)<<4;nt.buf[nt.pos++]|=yt|((Xe>>>=3)?128:0),Xe&&(nt.buf[nt.pos++]=127&Xe|((Xe>>>=7)?128:0),Xe&&(nt.buf[nt.pos++]=127&Xe|((Xe>>>=7)?128:0),Xe&&(nt.buf[nt.pos++]=127&Xe|((Xe>>>=7)?128:0),Xe&&(nt.buf[nt.pos++]=127&Xe|((Xe>>>=7)?128:0),Xe&&(nt.buf[nt.pos++]=127&Xe)))))}(dt,ve)}(U,this):(this.realloc(4),this.buf[this.pos++]=127&U|(U>127?128:0),U<=127||(this.buf[this.pos++]=127&(U>>>=7)|(U>127?128:0),U<=127||(this.buf[this.pos++]=127&(U>>>=7)|(U>127?128:0),U<=127||(this.buf[this.pos++]=U>>>7&127))))},writeSVarint:function(U){this.writeVarint(U<0?2*-U-1:2*U)},writeBoolean:function(U){this.writeVarint(!!U)},writeString:function(U){U=String(U),this.realloc(4*U.length),this.pos++;var ne=this.pos;this.pos=function(He,dt,Xe){for(var nt,yt,pt=0;pt<dt.length;pt++){if((nt=dt.charCodeAt(pt))>55295&&nt<57344){if(!yt){nt>56319||pt+1===dt.length?(He[Xe++]=239,He[Xe++]=191,He[Xe++]=189):yt=nt;continue}if(nt<56320){He[Xe++]=239,He[Xe++]=191,He[Xe++]=189,yt=nt;continue}nt=yt-55296<<10|nt-56320|65536,yt=null}else yt&&(He[Xe++]=239,He[Xe++]=191,He[Xe++]=189,yt=null);nt<128?He[Xe++]=nt:(nt<2048?He[Xe++]=nt>>6|192:(nt<65536?He[Xe++]=nt>>12|224:(He[Xe++]=nt>>18|240,He[Xe++]=nt>>12&63|128),He[Xe++]=nt>>6&63|128),He[Xe++]=63&nt|128)}return Xe}(this.buf,U,this.pos);var ve=this.pos-ne;ve>=128&&w(ne,ve,this),this.pos=ne-1,this.writeVarint(ve),this.pos+=ve},writeFloat:function(U){this.realloc(4),s.write(this.buf,U,this.pos,!0,23,4),this.pos+=4},writeDouble:function(U){this.realloc(8),s.write(this.buf,U,this.pos,!0,52,8),this.pos+=8},writeBytes:function(U){var ne=U.length;this.writeVarint(ne),this.realloc(ne);for(var ve=0;ve<ne;ve++)this.buf[this.pos++]=U[ve]},writeRawMessage:function(U,ne){this.pos++;var ve=this.pos;U(ne,this);var He=this.pos-ve;He>=128&&w(ve,He,this),this.pos=ve-1,this.writeVarint(He),this.pos+=He},writeMessage:function(U,ne,ve){this.writeTag(U,n.Bytes),this.writeRawMessage(ne,ve)},writePackedVarint:function(U,ne){ne.length&&this.writeMessage(U,C,ne)},writePackedSVarint:function(U,ne){ne.length&&this.writeMessage(U,I,ne)},writePackedBoolean:function(U,ne){ne.length&&this.writeMessage(U,$,ne)},writePackedFloat:function(U,ne){ne.length&&this.writeMessage(U,R,ne)},writePackedDouble:function(U,ne){ne.length&&this.writeMessage(U,L,ne)},writePackedFixed32:function(U,ne){ne.length&&this.writeMessage(U,G,ne)},writePackedSFixed32:function(U,ne){ne.length&&this.writeMessage(U,Z,ne)},writePackedFixed64:function(U,ne){ne.length&&this.writeMessage(U,K,ne)},writePackedSFixed64:function(U,ne){ne.length&&this.writeMessage(U,ie,ne)},writeBytesField:function(U,ne){this.writeTag(U,n.Bytes),this.writeBytes(ne)},writeFixed32Field:function(U,ne){this.writeTag(U,n.Fixed32),this.writeFixed32(ne)},writeSFixed32Field:function(U,ne){this.writeTag(U,n.Fixed32),this.writeSFixed32(ne)},writeFixed64Field:function(U,ne){this.writeTag(U,n.Fixed64),this.writeFixed64(ne)},writeSFixed64Field:function(U,ne){this.writeTag(U,n.Fixed64),this.writeSFixed64(ne)},writeVarintField:function(U,ne){this.writeTag(U,n.Varint),this.writeVarint(ne)},writeSVarintField:function(U,ne){this.writeTag(U,n.Varint),this.writeSVarint(ne)},writeStringField:function(U,ne){this.writeTag(U,n.Bytes),this.writeString(ne)},writeFloatField:function(U,ne){this.writeTag(U,n.Fixed32),this.writeFloat(ne)},writeDoubleField:function(U,ne){this.writeTag(U,n.Fixed64),this.writeDouble(ne)},writeBooleanField:function(U,ne){this.writeVarintField(U,!!ne)}},bg}var wg=T(Xv());const Sg=3;function H2(s,n,a){s===1&&a.readMessage(Z2,n)}function Z2(s,n,a){if(s===3){const{id:c,bitmap:f,width:v,height:b,left:w,top:C,advance:I}=a.readMessage(q2,{});n.push({id:c,bitmap:new kh({width:v+2*Sg,height:b+2*Sg},f),metrics:{width:v,height:b,left:w,top:C,advance:I}})}}function q2(s,n,a){s===1?n.id=a.readVarint():s===2?n.bitmap=a.readBytes():s===3?n.width=a.readVarint():s===4?n.height=a.readVarint():s===5?n.left=a.readSVarint():s===6?n.top=a.readSVarint():s===7&&(n.advance=a.readVarint())}const W2=Sg;function Kv(s){let n=0,a=0;for(const b of s)n+=b.w*b.h,a=Math.max(a,b.w);s.sort((b,w)=>w.h-b.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),a),h:1/0}];let f=0,v=0;for(const b of s)for(let w=c.length-1;w>=0;w--){const C=c[w];if(!(b.w>C.w||b.h>C.h)){if(b.x=C.x,b.y=C.y,v=Math.max(v,b.y+b.h),f=Math.max(f,b.x+b.w),b.w===C.w&&b.h===C.h){const I=c.pop();w<c.length&&(c[w]=I)}else b.h===C.h?(C.x+=b.w,C.w-=b.w):b.w===C.w?(C.y+=b.h,C.h-=b.h):(c.push({x:C.x+b.w,y:C.y,w:C.w-b.w,h:b.h}),C.y+=b.h,C.h-=b.h);break}}return{w:f,h:v,fill:n/(f*v)||0}}const Ur=1;class Cg{constructor(n,{pixelRatio:a,version:c,stretchX:f,stretchY:v,content:b,textFitWidth:w,textFitHeight:C}){this.paddedRect=n,this.pixelRatio=a,this.stretchX=f,this.stretchY=v,this.content=b,this.version=c,this.textFitWidth=w,this.textFitHeight=C}get tl(){return[this.paddedRect.x+Ur,this.paddedRect.y+Ur]}get br(){return[this.paddedRect.x+this.paddedRect.w-Ur,this.paddedRect.y+this.paddedRect.h-Ur]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Ur)/this.pixelRatio,(this.paddedRect.h-2*Ur)/this.pixelRatio]}}class Yv{constructor(n,a){const c={},f={};this.haveRenderCallbacks=[];const v=[];this.addImages(n,c,v),this.addImages(a,f,v);const{w:b,h:w}=Kv(v),C=new da({width:b||1,height:w||1});for(const I in n){const R=n[I],L=c[I].paddedRect;da.copy(R.data,C,{x:0,y:0},{x:L.x+Ur,y:L.y+Ur},R.data)}for(const I in a){const R=a[I],L=f[I].paddedRect,$=L.x+Ur,G=L.y+Ur,Z=R.data.width,K=R.data.height;da.copy(R.data,C,{x:0,y:0},{x:$,y:G},R.data),da.copy(R.data,C,{x:0,y:K-1},{x:$,y:G-1},{width:Z,height:1}),da.copy(R.data,C,{x:0,y:0},{x:$,y:G+K},{width:Z,height:1}),da.copy(R.data,C,{x:Z-1,y:0},{x:$-1,y:G},{width:1,height:K}),da.copy(R.data,C,{x:0,y:0},{x:$+Z,y:G},{width:1,height:K})}this.image=C,this.iconPositions=c,this.patternPositions=f}addImages(n,a,c){for(const f in n){const v=n[f],b={x:0,y:0,w:v.data.width+2*Ur,h:v.data.height+2*Ur};c.push(b),a[f]=new Cg(b,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(n,a){n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in n.updatedImages)this.patchUpdatedImage(this.iconPositions[c],n.getImage(c),a),this.patchUpdatedImage(this.patternPositions[c],n.getImage(c),a)}patchUpdatedImage(n,a,c){if(!n||!a||n.version===a.version)return;n.version=a.version;const[f,v]=n.tl;c.update(a.data,void 0,{x:f,y:v})}}var Do;Bt("ImagePosition",Cg),Bt("ImageAtlas",Yv),m.ai=void 0,(Do=m.ai||(m.ai={}))[Do.none=0]="none",Do[Do.horizontal=1]="horizontal",Do[Do.vertical=2]="vertical",Do[Do.horizontalOnly=3]="horizontalOnly";const Kf=-17;class Oh{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(n,a,c){const f=new Oh;return f.scale=n||1,f.fontStack=a,f.verticalAlign=c||"bottom",f}static forImage(n,a){const c=new Oh;return c.imageName=n,c.verticalAlign=a||"bottom",c}}class Hc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,a){const c=new Hc;for(let f=0;f<n.sections.length;f++){const v=n.sections[f];v.image?c.addImageSection(v):c.addTextSection(v,a)}return c}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(){this.text=function(n){let a="";for(let c=0;c<n.length;c++){const f=n.charCodeAt(c+1)||null,v=n.charCodeAt(c-1)||null;a+=f&&Df(f)&&!Fh[n[c+1]]||v&&Df(v)&&!Fh[n[c-1]]||!Fh[n[c]]?n[c]:Fh[n[c]]}return a}(this.text)}trim(){let n=0;for(let c=0;c<this.text.length&&Jf[this.text.charCodeAt(c)];c++)n++;let a=this.text.length;for(let c=this.text.length-1;c>=0&&c>=n&&Jf[this.text.charCodeAt(c)];c--)a--;this.text=this.text.substring(n,a),this.sectionIndex=this.sectionIndex.slice(n,a)}substring(n,a){const c=new Hc;return c.text=this.text.substring(n,a),c.sectionIndex=this.sectionIndex.slice(n,a),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,a)=>Math.max(n,this.sections[a].scale),0)}getMaxImageSize(n){let a=0,c=0;for(let f=0;f<this.length();f++){const v=this.getSection(f);if(v.imageName){const b=n[v.imageName];if(!b)continue;const w=b.displaySize;a=Math.max(a,w[0]),c=Math.max(c,w[1])}}return{maxImageWidth:a,maxImageHeight:c}}addTextSection(n,a){this.text+=n.text,this.sections.push(Oh.forText(n.scale,n.fontStack||a,n.verticalAlign));const c=this.sections.length-1;for(let f=0;f<n.text.length;++f)this.sectionIndex.push(c)}addImageSection(n){const a=n.image?n.image.name:"";if(a.length===0)return void ri("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(Oh.forImage(a,n.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):ri("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Yf(s,n,a,c,f,v,b,w,C,I,R,L,$,G,Z){const K=Hc.fromFeature(s,f);let ie;L===m.ai.vertical&&K.verticalizePunctuation();const{processBidirectionalText:he,processStyledBidirectionalText:ze}=Za;if(he&&K.sections.length===1){ie=[];const ne=he(K.toString(),Tg(K,I,v,n,c,G));for(const ve of ne){const He=new Hc;He.text=ve,He.sections=K.sections;for(let dt=0;dt<ve.length;dt++)He.sectionIndex.push(0);ie.push(He)}}else if(ze){ie=[];const ne=ze(K.text,K.sectionIndex,Tg(K,I,v,n,c,G));for(const ve of ne){const He=new Hc;He.text=ve[0],He.sectionIndex=ve[1],He.sections=K.sections,ie.push(He)}}else ie=function(ne,ve){const He=[],dt=ne.text;let Xe=0;for(const nt of ve)He.push(ne.substring(Xe,nt)),Xe=nt;return Xe<dt.length&&He.push(ne.substring(Xe,dt.length)),He}(K,Tg(K,I,v,n,c,G));const ge=[],U={positionedLines:ge,text:K.toString(),top:R[1],bottom:R[1],left:R[0],right:R[0],writingMode:L,iconsInText:!1,verticalizable:!1};return function(ne,ve,He,dt,Xe,nt,yt,pt,bt,at,$t,Jt){let Xt=0,Ut=0,Mn=0,Ii=0;const Yi=pt==="right"?1:pt==="left"?0:.5,_r=Ki/Jt;let pa=0;for(const wi of Xe){wi.trim();const tr=wi.getMaxScale(),cr={positionedGlyphs:[],lineOffset:0};ne.positionedLines[pa]=cr;const ur=cr.positionedGlyphs;let Rr=0;if(!wi.length()){Ut+=nt,++pa;continue}const ma=J2(dt,wi,_r);for(let Hr=0;Hr<wi.length();Hr++){const Ji=wi.getSection(Hr),ir=wi.getSectionIndex(Hr),rr=wi.getCharCode(Hr),ji=Q2(bt,$t,rr);let oi;if(Ji.imageName){if(ne.iconsInText=!0,Ji.scale=Ji.scale*_r,oi=tT(Ji,ji,tr,ma,dt),!oi)continue;Rr=Math.max(Rr,oi.imageOffset)}else if(oi=eT(Ji,rr,ji,ma,ve,He),!oi)continue;const{rect:Ka,metrics:Xc,baselineOffset:Ya}=oi;ur.push({glyph:rr,imageName:Ji.imageName,x:Xt,y:Ut+Ya+Kf,vertical:ji,scale:Ji.scale,fontStack:Ji.fontStack,sectionIndex:ir,metrics:Xc,rect:Ka}),ji?(ne.verticalizable=!0,Xt+=(Ji.imageName?Xc.advance:Ki)*Ji.scale+at):Xt+=Xc.advance*Ji.scale+at}ur.length!==0&&(Mn=Math.max(Xt-at,Mn),nT(ur,0,ur.length-1,Yi)),Xt=0,cr.lineOffset=Math.max(Rr,(tr-1)*Ki);const nr=nt*tr+Rr;Ut+=nr,Ii=Math.max(nr,Ii),++pa}const{horizontalAlign:Gr,verticalAlign:lr}=Pg(yt);(function(wi,tr,cr,ur,Rr,ma,nr,Hr,Ji){const ir=(tr-cr)*Rr;let rr=0;rr=ma!==nr?-Hr*ur-Kf:-ur*Ji*nr+.5*nr;for(const ji of wi)for(const oi of ji.positionedGlyphs)oi.x+=ir,oi.y+=rr})(ne.positionedLines,Yi,Gr,lr,Mn,Ii,nt,Ut,Xe.length),ne.top+=-lr*Ut,ne.bottom=ne.top+Ut,ne.left+=-Gr*Mn,ne.right=ne.left+Mn}(U,n,a,c,ie,b,w,C,L,I,$,Z),!function(ne){for(const ve of ne)if(ve.positionedGlyphs.length!==0)return!1;return!0}(ge)&&U}const Jf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},X2={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},K2={40:!0};function Jv(s,n,a,c,f,v){if(n.imageName){const b=c[n.imageName];return b?b.displaySize[0]*n.scale*Ki/v+f:0}{const b=a[n.fontStack],w=b&&b[s];return w?w.metrics.advance*n.scale+f:0}}function Qv(s,n,a,c){const f=Math.pow(s-n,2);return c?s<n?f/2:2*f:f+Math.abs(a)*a}function Y2(s,n,a){let c=0;return s===10&&(c-=1e4),a&&(c+=150),s!==40&&s!==65288||(c+=50),n!==41&&n!==65289||(c+=50),c}function e0(s,n,a,c,f,v){let b=null,w=Qv(n,a,f,v);for(const C of c){const I=Qv(n-C.x,a,f,v)+C.badness;I<=w&&(b=C,w=I)}return{index:s,x:n,priorBreak:b,badness:w}}function t0(s){return s?t0(s.priorBreak).concat(s.index):[]}function Tg(s,n,a,c,f,v){if(!s)return[];const b=[],w=function(L,$,G,Z,K,ie){let he=0;for(let ze=0;ze<L.length();ze++){const ge=L.getSection(ze);he+=Jv(L.getCharCode(ze),ge,Z,K,$,ie)}return he/Math.max(1,Math.ceil(he/G))}(s,n,a,c,f,v),C=s.text.indexOf("​")>=0;let I=0;for(let L=0;L<s.length();L++){const $=s.getSection(L),G=s.getCharCode(L);if(Jf[G]||(I+=Jv(G,$,c,f,n,v)),L<s.length()-1){const Z=!((R=G)<11904)&&(!!kn["CJK Compatibility Forms"](R)||!!kn["CJK Compatibility"](R)||!!kn["CJK Strokes"](R)||!!kn["CJK Symbols and Punctuation"](R)||!!kn["Enclosed CJK Letters and Months"](R)||!!kn["Halfwidth and Fullwidth Forms"](R)||!!kn["Ideographic Description Characters"](R)||!!kn["Vertical Forms"](R)||Ac.test(String.fromCodePoint(R)));(X2[G]||Z||$.imageName||L!==s.length()-2&&K2[s.getCharCode(L+1)])&&b.push(e0(L+1,I,w,b,Y2(G,s.getCharCode(L+1),Z&&C),!1))}}var R;return t0(e0(s.length(),I,w,b,0,!0))}function Pg(s){let n=.5,a=.5;switch(s){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:n,verticalAlign:a}}function J2(s,n,a){const c=n.getMaxScale()*Ki,{maxImageWidth:f,maxImageHeight:v}=n.getMaxImageSize(s),b=Math.max(c,v*a);return{verticalLineContentWidth:Math.max(c,f*a),horizontalLineContentHeight:b}}function n0(s){switch(s){case"top":return 0;case"center":return .5;default:return 1}}function Q2(s,n,a){return!(s===m.ai.horizontal||!n&&!Rc(a)||n&&(Jf[a]||(c=a,/\p{sc=Arab}/u.test(String.fromCodePoint(c)))));var c}function eT(s,n,a,c,f,v){const b=v[s.fontStack],w=function(I,R,L,$){if(I&&I.rect)return I;const G=R[L.fontStack],Z=G&&G[$];return Z?{rect:null,metrics:Z.metrics}:null}(b&&b[n],f,s,n);if(w===null)return null;let C;if(a)C=c.verticalLineContentWidth-s.scale*Ki;else{const I=n0(s.verticalAlign);C=(c.horizontalLineContentHeight-s.scale*Ki)*I}return{rect:w.rect,metrics:w.metrics,baselineOffset:C}}function tT(s,n,a,c,f){const v=f[s.imageName];if(!v)return null;const b=v.paddedRect,w=v.displaySize,C={width:w[0],height:w[1],left:Ur,top:-3,advance:n?w[1]:w[0]};let I;if(n)I=c.verticalLineContentWidth-w[1]*s.scale;else{const R=n0(s.verticalAlign);I=(c.horizontalLineContentHeight-w[1]*s.scale)*R}return{rect:b,metrics:C,baselineOffset:I,imageOffset:(n?w[0]:w[1])*s.scale-Ki*a}}function nT(s,n,a,c){if(c===0)return;const f=s[a],v=(s[a].x+f.metrics.advance*f.scale)*c;for(let b=n;b<=a;b++)s[b].x-=v}function iT(s,n,a){const{horizontalAlign:c,verticalAlign:f}=Pg(a),v=n[0]-s.displaySize[0]*c,b=n[1]-s.displaySize[1]*f;return{image:s,top:b,bottom:b+s.displaySize[1],left:v,right:v+s.displaySize[0]}}function i0(s){var n,a;let c=s.left,f=s.top,v=s.right-c,b=s.bottom-f;const w=(n=s.image.textFitWidth)!==null&&n!==void 0?n:"stretchOrShrink",C=(a=s.image.textFitHeight)!==null&&a!==void 0?a:"stretchOrShrink",I=(s.image.content[2]-s.image.content[0])/(s.image.content[3]-s.image.content[1]);if(C==="proportional"){if(w==="stretchOnly"&&v/b<I||w==="proportional"){const R=Math.ceil(b*I);c*=R/v,v=R}}else if(w==="proportional"&&C==="stretchOnly"&&I!==0&&v/b>I){const R=Math.ceil(v/I);f*=R/b,b=R}return{x1:c,y1:f,x2:c+v,y2:f+b}}function r0(s,n,a,c,f,v){const b=s.image;let w;if(b.content){const ie=b.content,he=b.pixelRatio||1;w=[ie[0]/he,ie[1]/he,b.displaySize[0]-ie[2]/he,b.displaySize[1]-ie[3]/he]}const C=n.left*v,I=n.right*v;let R,L,$,G;a==="width"||a==="both"?(G=f[0]+C-c[3],L=f[0]+I+c[1]):(G=f[0]+(C+I-b.displaySize[0])/2,L=G+b.displaySize[0]);const Z=n.top*v,K=n.bottom*v;return a==="height"||a==="both"?(R=f[1]+Z-c[0],$=f[1]+K+c[2]):(R=f[1]+(Z+K-b.displaySize[1])/2,$=R+b.displaySize[1]),{image:b,top:R,right:L,bottom:$,left:G,collisionPadding:w}}const Vh=255,ps=128,zo=Vh*ps;function a0(s,n){const{expression:a}=n;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new fi(s+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:f}=a;let v=0;for(;v<c.length&&c[v]<=s;)v++;v=Math.max(0,v-1);let b=v;for(;b<c.length&&c[b]<s+1;)b++;b=Math.min(c.length-1,b);const w=c[v],C=c[b];return a.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:C,interpolationType:f}:{kind:"camera",minZoom:w,maxZoom:C,minSize:a.evaluate(new fi(w)),maxSize:a.evaluate(new fi(C)),interpolationType:f}}}function kg(s,n,a){let c="never";const f=s.get(n);return f?c=f:s.get(a)&&(c="always"),c}const rT=zh.VectorTileFeature.types,aT=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Qf(s,n,a,c,f,v,b,w,C,I,R,L,$){const G=w?Math.min(zo,Math.round(w[0])):0,Z=w?Math.min(zo,Math.round(w[1])):0;s.emplaceBack(n,a,Math.round(32*c),Math.round(32*f),v,b,(G<<1)+(C?1:0),Z,16*I,16*R,256*L,256*$)}function Ig(s,n,a){s.emplaceBack(n.x,n.y,a),s.emplaceBack(n.x,n.y,a),s.emplaceBack(n.x,n.y,a),s.emplaceBack(n.x,n.y,a)}function sT(s){for(const n of s.sections)if(Ff(n.text))return!0;return!1}class Mg{constructor(n){this.layoutVertexArray=new Re,this.indexArray=new et,this.programConfigurations=n,this.segments=new Rt,this.dynamicLayoutVertexArray=new Ge,this.opacityVertexArray=new Ze,this.hasVisibleVertices=!1,this.placedSymbolArray=new S}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,a,c,f){this.isEmpty()||(c&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,V2.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,N2.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,aT,!0),this.opacityVertexBuffer.itemSize=1),(c||f)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Bt("SymbolBuffers",Mg);class Eg{constructor(n,a,c){this.layoutVertexArray=new n,this.layoutAttributes=a,this.indexArray=new c,this.segments=new Rt,this.collisionVertexArray=new lt}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,$2.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Bt("CollisionBuffers",Eg);class Zc{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(b=>b.id),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=a0(this.zoom,a["text-size"]),this.iconSizeData=a0(this.zoom,a["icon-size"]);const c=this.layers[0].layout,f=c.get("symbol-sort-key"),v=c.get("symbol-z-order");this.canOverlap=kg(c,"text-overlap","text-allow-overlap")!=="never"||kg(c,"icon-overlap","icon-allow-overlap")!=="never"||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&!f.isConstant(),this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,c.get("symbol-placement")==="point"&&(this.writingModes=c.get("text-writing-mode").map(b=>m.ai[b])),this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id),this.sourceID=n.sourceID}createArrays(){this.text=new Mg(new xi(this.layers,this.zoom,n=>/^text/.test(n))),this.icon=new Mg(new xi(this.layers,this.zoom,n=>/^icon/.test(n))),this.glyphOffsetArray=new B,this.lineVertexArray=new V,this.symbolInstances=new E,this.textAnchorOffsets=new X}calculateGlyphDependencies(n,a,c,f,v){for(let b=0;b<n.length;b++)if(a[n.charCodeAt(b)]=!0,(c||f)&&v){const w=Fh[n.charAt(b)];w&&(a[w.charCodeAt(0)]=!0)}}populate(n,a,c){const f=this.layers[0],v=f.layout,b=v.get("text-font"),w=v.get("text-field"),C=v.get("icon-image"),I=(w.value.kind!=="constant"||w.value.value instanceof Ai&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(b.value.kind!=="constant"||b.value.value.length>0),R=C.value.kind!=="constant"||!!C.value.value||Object.keys(C.parameters).length>0,L=v.get("symbol-sort-key");if(this.features=[],!I&&!R)return;const $=a.iconDependencies,G=a.glyphDependencies,Z=a.availableImages,K=new fi(this.zoom);for(const{feature:ie,id:he,index:ze,sourceLayerIndex:ge}of n){const U=f._featureFilter.needGeometry,ne=Zs(ie,U);if(!f._featureFilter.filter(K,ne,c))continue;let ve,He;if(U||(ne.geometry=Hs(ie)),I){const Xe=f.getValueAndResolveTokens("text-field",ne,c,Z),nt=Ai.factory(Xe),yt=this.hasRTLText=this.hasRTLText||sT(nt);(!yt||Za.getRTLTextPluginStatus()==="unavailable"||yt&&Za.isParsed())&&(ve=U2(nt,f,ne))}if(R){const Xe=f.getValueAndResolveTokens("icon-image",ne,c,Z);He=Xe instanceof pr?Xe:pr.fromString(Xe)}if(!ve&&!He)continue;const dt=this.sortFeaturesByKey?L.evaluate(ne,{},c):void 0;if(this.features.push({id:he,text:ve,icon:He,index:ze,sourceLayerIndex:ge,geometry:ne.geometry,properties:ie.properties,type:rT[ie.type],sortKey:dt}),He&&($[He.name]=!0),ve){const Xe=b.evaluate(ne,{},c).join(","),nt=v.get("text-rotation-alignment")!=="viewport"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(m.ai.vertical)>=0;for(const yt of ve.sections)if(yt.image)$[yt.image.name]=!0;else{const pt=Io(ve.toString()),bt=yt.fontStack||Xe,at=G[bt]=G[bt]||{};this.calculateGlyphDependencies(yt.text,at,nt,this.allowVerticalPlacement,pt)}}}v.get("symbol-placement")==="line"&&(this.features=function(ie){const he={},ze={},ge=[];let U=0;function ne(Xe){ge.push(ie[Xe]),U++}function ve(Xe,nt,yt){const pt=ze[Xe];return delete ze[Xe],ze[nt]=pt,ge[pt].geometry[0].pop(),ge[pt].geometry[0]=ge[pt].geometry[0].concat(yt[0]),pt}function He(Xe,nt,yt){const pt=he[nt];return delete he[nt],he[Xe]=pt,ge[pt].geometry[0].shift(),ge[pt].geometry[0]=yt[0].concat(ge[pt].geometry[0]),pt}function dt(Xe,nt,yt){const pt=yt?nt[0][nt[0].length-1]:nt[0][0];return`${Xe}:${pt.x}:${pt.y}`}for(let Xe=0;Xe<ie.length;Xe++){const nt=ie[Xe],yt=nt.geometry,pt=nt.text?nt.text.toString():null;if(!pt){ne(Xe);continue}const bt=dt(pt,yt),at=dt(pt,yt,!0);if(bt in ze&&at in he&&ze[bt]!==he[at]){const $t=He(bt,at,yt),Jt=ve(bt,at,ge[$t].geometry);delete he[bt],delete ze[at],ze[dt(pt,ge[Jt].geometry,!0)]=Jt,ge[$t].geometry=null}else bt in ze?ve(bt,at,yt):at in he?He(bt,at,yt):(ne(Xe),he[bt]=U-1,ze[at]=U-1)}return ge.filter(Xe=>Xe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ie,he)=>ie.sortKey-he.sortKey)}update(n,a,c){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,a,this.layers,c),this.icon.programConfigurations.updatePaintArrays(n,a,this.layers,c))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,a){const c=this.lineVertexArray.length;if(n.segment!==void 0){let f=n.dist(a[n.segment+1]),v=n.dist(a[n.segment]);const b={};for(let w=n.segment+1;w<a.length;w++)b[w]={x:a[w].x,y:a[w].y,tileUnitDistanceFromAnchor:f},w<a.length-1&&(f+=a[w+1].dist(a[w]));for(let w=n.segment||0;w>=0;w--)b[w]={x:a[w].x,y:a[w].y,tileUnitDistanceFromAnchor:v},w>0&&(v+=a[w-1].dist(a[w]));for(let w=0;w<a.length;w++){const C=b[w];this.lineVertexArray.emplaceBack(C.x,C.y,C.tileUnitDistanceFromAnchor)}}return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(n,a,c,f,v,b,w,C,I,R,L,$){const G=n.indexArray,Z=n.layoutVertexArray,K=n.segments.prepareSegment(4*a.length,Z,G,this.canOverlap?b.sortKey:void 0),ie=this.glyphOffsetArray.length,he=K.vertexLength,ze=this.allowVerticalPlacement&&w===m.ai.vertical?Math.PI/2:0,ge=b.text&&b.text.sections;for(let U=0;U<a.length;U++){const{tl:ne,tr:ve,bl:He,br:dt,tex:Xe,pixelOffsetTL:nt,pixelOffsetBR:yt,minFontScaleX:pt,minFontScaleY:bt,glyphOffset:at,isSDF:$t,sectionIndex:Jt}=a[U],Xt=K.vertexLength,Ut=at[1];Qf(Z,C.x,C.y,ne.x,Ut+ne.y,Xe.x,Xe.y,c,$t,nt.x,nt.y,pt,bt),Qf(Z,C.x,C.y,ve.x,Ut+ve.y,Xe.x+Xe.w,Xe.y,c,$t,yt.x,nt.y,pt,bt),Qf(Z,C.x,C.y,He.x,Ut+He.y,Xe.x,Xe.y+Xe.h,c,$t,nt.x,yt.y,pt,bt),Qf(Z,C.x,C.y,dt.x,Ut+dt.y,Xe.x+Xe.w,Xe.y+Xe.h,c,$t,yt.x,yt.y,pt,bt),Ig(n.dynamicLayoutVertexArray,C,ze),G.emplaceBack(Xt,Xt+2,Xt+1),G.emplaceBack(Xt+1,Xt+2,Xt+3),K.vertexLength+=4,K.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(at[0]),U!==a.length-1&&Jt===a[U+1].sectionIndex||n.programConfigurations.populatePaintArrays(Z.length,b,b.index,{},$,ge&&ge[Jt])}n.placedSymbolArray.emplaceBack(C.x,C.y,ie,this.glyphOffsetArray.length-ie,he,I,R,C.segment,c?c[0]:0,c?c[1]:0,f[0],f[1],w,0,!1,0,L)}_addCollisionDebugVertex(n,a,c,f,v,b){return a.emplaceBack(0,0),n.emplaceBack(c.x,c.y,f,v,Math.round(b.x),Math.round(b.y))}addCollisionDebugVertices(n,a,c,f,v,b,w){const C=v.segments.prepareSegment(4,v.layoutVertexArray,v.indexArray),I=C.vertexLength,R=v.layoutVertexArray,L=v.collisionVertexArray,$=w.anchorX,G=w.anchorY;this._addCollisionDebugVertex(R,L,b,$,G,new F(n,a)),this._addCollisionDebugVertex(R,L,b,$,G,new F(c,a)),this._addCollisionDebugVertex(R,L,b,$,G,new F(c,f)),this._addCollisionDebugVertex(R,L,b,$,G,new F(n,f)),C.vertexLength+=4;const Z=v.indexArray;Z.emplaceBack(I,I+1),Z.emplaceBack(I+1,I+2),Z.emplaceBack(I+2,I+3),Z.emplaceBack(I+3,I),C.primitiveLength+=4}addDebugCollisionBoxes(n,a,c,f){for(let v=n;v<a;v++){const b=this.collisionBoxArray.get(v);this.addCollisionDebugVertices(b.x1,b.y1,b.x2,b.y2,f?this.textCollisionBox:this.iconCollisionBox,b.anchorPoint,c)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Eg(rt,Zv.members,Pt),this.iconCollisionBox=new Eg(rt,Zv.members,Pt);for(let n=0;n<this.symbolInstances.length;n++){const a=this.symbolInstances.get(n);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}}_deserializeCollisionBoxesForSymbol(n,a,c,f,v,b,w,C,I){const R={};for(let L=a;L<c;L++){const $=n.get(L);R.textBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},R.textFeatureIndex=$.featureIndex;break}for(let L=f;L<v;L++){const $=n.get(L);R.verticalTextBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},R.verticalTextFeatureIndex=$.featureIndex;break}for(let L=b;L<w;L++){const $=n.get(L);R.iconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},R.iconFeatureIndex=$.featureIndex;break}for(let L=C;L<I;L++){const $=n.get(L);R.verticalIconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},R.verticalIconFeatureIndex=$.featureIndex;break}return R}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const c=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,a){const c=n.placedSymbolArray.get(a),f=c.vertexStartIndex+4*c.numGlyphs;for(let v=c.vertexStartIndex;v<f;v+=4)n.indexArray.emplaceBack(v,v+2,v+1),n.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(n),c=Math.cos(n),f=[],v=[],b=[];for(let w=0;w<this.symbolInstances.length;++w){b.push(w);const C=this.symbolInstances.get(w);f.push(0|Math.round(a*C.anchorX+c*C.anchorY)),v.push(C.featureIndex)}return b.sort((w,C)=>f[w]-f[C]||v[C]-v[w]),b}addToSortKeyRanges(n,a){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===a?c.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const c=this.symbolInstances.get(a);this.featureSortOrder.push(c.featureIndex),[c.rightJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.leftJustifiedTextSymbolIndex].forEach((f,v,b)=>{f>=0&&b.indexOf(f)===v&&this.addIndicesForPlacedSymbol(this.text,f)}),c.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,c.verticalPlacedTextSymbolIndex),c.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.placedIconSymbolIndex),c.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let s0,o0;Bt("SymbolBucket",Zc,{omit:["layers","collisionBoxArray","features","compareText"]}),Zc.MAX_GLYPHS=65535,Zc.addDynamicAttributes=Ig;var Ag={get paint(){return o0=o0||new Er({"icon-opacity":new rn(ae.paint_symbol["icon-opacity"]),"icon-color":new rn(ae.paint_symbol["icon-color"]),"icon-halo-color":new rn(ae.paint_symbol["icon-halo-color"]),"icon-halo-width":new rn(ae.paint_symbol["icon-halo-width"]),"icon-halo-blur":new rn(ae.paint_symbol["icon-halo-blur"]),"icon-translate":new Ht(ae.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ht(ae.paint_symbol["icon-translate-anchor"]),"text-opacity":new rn(ae.paint_symbol["text-opacity"]),"text-color":new rn(ae.paint_symbol["text-color"],{runtimeType:Cn,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new rn(ae.paint_symbol["text-halo-color"]),"text-halo-width":new rn(ae.paint_symbol["text-halo-width"]),"text-halo-blur":new rn(ae.paint_symbol["text-halo-blur"]),"text-translate":new Ht(ae.paint_symbol["text-translate"]),"text-translate-anchor":new Ht(ae.paint_symbol["text-translate-anchor"])})},get layout(){return s0=s0||new Er({"symbol-placement":new Ht(ae.layout_symbol["symbol-placement"]),"symbol-spacing":new Ht(ae.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ht(ae.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new rn(ae.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ht(ae.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ht(ae.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ht(ae.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ht(ae.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ht(ae.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ht(ae.layout_symbol["icon-rotation-alignment"]),"icon-size":new rn(ae.layout_symbol["icon-size"]),"icon-text-fit":new Ht(ae.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ht(ae.layout_symbol["icon-text-fit-padding"]),"icon-image":new rn(ae.layout_symbol["icon-image"]),"icon-rotate":new rn(ae.layout_symbol["icon-rotate"]),"icon-padding":new rn(ae.layout_symbol["icon-padding"]),"icon-keep-upright":new Ht(ae.layout_symbol["icon-keep-upright"]),"icon-offset":new rn(ae.layout_symbol["icon-offset"]),"icon-anchor":new rn(ae.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ht(ae.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ht(ae.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ht(ae.layout_symbol["text-rotation-alignment"]),"text-field":new rn(ae.layout_symbol["text-field"]),"text-font":new rn(ae.layout_symbol["text-font"]),"text-size":new rn(ae.layout_symbol["text-size"]),"text-max-width":new rn(ae.layout_symbol["text-max-width"]),"text-line-height":new Ht(ae.layout_symbol["text-line-height"]),"text-letter-spacing":new rn(ae.layout_symbol["text-letter-spacing"]),"text-justify":new rn(ae.layout_symbol["text-justify"]),"text-radial-offset":new rn(ae.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ht(ae.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new rn(ae.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new rn(ae.layout_symbol["text-anchor"]),"text-max-angle":new Ht(ae.layout_symbol["text-max-angle"]),"text-writing-mode":new Ht(ae.layout_symbol["text-writing-mode"]),"text-rotate":new rn(ae.layout_symbol["text-rotate"]),"text-padding":new Ht(ae.layout_symbol["text-padding"]),"text-keep-upright":new Ht(ae.layout_symbol["text-keep-upright"]),"text-transform":new rn(ae.layout_symbol["text-transform"]),"text-offset":new rn(ae.layout_symbol["text-offset"]),"text-allow-overlap":new Ht(ae.layout_symbol["text-allow-overlap"]),"text-overlap":new Ht(ae.layout_symbol["text-overlap"]),"text-ignore-placement":new Ht(ae.layout_symbol["text-ignore-placement"]),"text-optional":new Ht(ae.layout_symbol["text-optional"])})}};class l0{constructor(n){if(n.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=n.property.overrides?n.property.overrides.runtimeType:pn,this.defaultValue=n}evaluate(n){if(n.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(n.formattedSection))return a.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Bt("FormatSectionOverride",l0,{omit:["defaultValue"]});class ep extends Ma{constructor(n){super(n,Ag)}recalculate(n,a){if(super.recalculate(n,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const c=this.layout.get("text-writing-mode");if(c){const f=[];for(const v of c)f.indexOf(v)<0&&f.push(v);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(n,a,c,f){const v=this.layout.get(n).evaluate(a,{},c,f),b=this._unevaluatedLayout._values[n];return b.isDataDriven()||bc(b.value)||!v?v:function(w,C){return C.replace(/{([^{}]+)}/g,(I,R)=>w&&R in w?String(w[R]):"")}(a.properties,v)}createBucket(n){return new Zc(n)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const n of Ag.paint.overridableProperties){if(!ep.hasPaintOverride(this.layout,n))continue;const a=this.paint.get(n),c=new l0(a),f=new vc(c,a.property.specification);let v=null;v=a.value.kind==="constant"||a.value.kind==="source"?new xo("source",f):new wc("composite",f,a.value.zoomStops),this.paint._values[n]=new Ia(a.property,v,a.parameters)}}_handleOverridablePaintPropertyUpdate(n,a,c){return!(!this.layout||a.isDataDriven()||c.isDataDriven())&&ep.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,a){const c=n.get("text-field"),f=Ag.paint.properties[a];let v=!1;const b=w=>{for(const C of w)if(f.overrides&&f.overrides.hasOverride(C))return void(v=!0)};if(c.value.kind==="constant"&&c.value.value instanceof Ai)b(c.value.value.sections);else if(c.value.kind==="source"){const w=I=>{v||(I instanceof ka&&ai(I.value)===os?b(I.value.sections):I instanceof ll?b(I.sections):I.eachChild(w))},C=c.value;C._styleExpression&&w(C._styleExpression.expression)}return v}}let c0;var oT={get paint(){return c0=c0||new Er({"background-color":new Ht(ae.paint_background["background-color"]),"background-pattern":new Bc(ae.paint_background["background-pattern"]),"background-opacity":new Ht(ae.paint_background["background-opacity"])})}};class lT extends Ma{constructor(n){super(n,oT)}}let u0;var cT={get paint(){return u0=u0||new Er({"raster-opacity":new Ht(ae.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ht(ae.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ht(ae.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ht(ae.paint_raster["raster-brightness-max"]),"raster-saturation":new Ht(ae.paint_raster["raster-saturation"]),"raster-contrast":new Ht(ae.paint_raster["raster-contrast"]),"raster-resampling":new Ht(ae.paint_raster["raster-resampling"]),"raster-fade-duration":new Ht(ae.paint_raster["raster-fade-duration"])})}};class uT extends Ma{constructor(n){super(n,cT)}}class hT extends Ma{constructor(n){super(n,{}),this.onAdd=a=>{this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)},this.onRemove=a=>{this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)},this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class dT{constructor(n){this._methodToThrottle=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Rg=63710088e-1;class Lo{constructor(n,a){if(isNaN(n)||isNaN(a))throw new Error(`Invalid LngLat object: (${n}, ${a})`);if(this.lng=+n,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Lo(zt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const a=Math.PI/180,c=this.lat*a,f=n.lat*a,v=Math.sin(c)*Math.sin(f)+Math.cos(c)*Math.cos(f)*Math.cos((n.lng-this.lng)*a);return Rg*Math.acos(Math.min(v,1))}static convert(n){if(n instanceof Lo)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new Lo(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new Lo(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const h0=2*Math.PI*Rg;function d0(s){return h0*Math.cos(s*Math.PI/180)}function f0(s){return(180+s)/360}function p0(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function m0(s,n){return s/d0(n)}function Dg(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function g0(s,n){return s*d0(Dg(n))}class Nh{constructor(n,a,c=0){this.x=+n,this.y=+a,this.z=+c}static fromLngLat(n,a=0){const c=Lo.convert(n);return new Nh(f0(c.lng),p0(c.lat),m0(a,c.lat))}toLngLat(){return new Lo(360*this.x-180,Dg(this.y))}toAltitude(){return g0(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/h0*(n=Dg(this.y),1/Math.cos(n*Math.PI/180));var n}}function _0(s,n,a){var c=2*Math.PI*6378137/256/Math.pow(2,a);return[s*c-2*Math.PI*6378137/2,n*c-2*Math.PI*6378137/2]}class zg{constructor(n,a,c){if(!function(f,v,b){return!(f<0||f>25||b<0||b>=Math.pow(2,f)||v<0||v>=Math.pow(2,f))}(n,a,c))throw new Error(`x=${a}, y=${c}, z=${n} outside of bounds. 0<=x<${Math.pow(2,n)}, 0<=y<${Math.pow(2,n)} 0<=z<=25 `);this.z=n,this.x=a,this.y=c,this.key=qc(0,n,n,a,c)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,a,c){const f=(b=this.y,w=this.z,C=_0(256*(v=this.x),256*(b=Math.pow(2,w)-b-1),w),I=_0(256*(v+1),256*(b+1),w),C[0]+","+C[1]+","+I[0]+","+I[1]);var v,b,w,C,I;const R=function(L,$,G){let Z,K="";for(let ie=L;ie>0;ie--)Z=1<<ie-1,K+=($&Z?1:0)+(G&Z?2:0);return K}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,a>1?"@2x":"").replace(/{quadkey}/g,R).replace(/{bbox-epsg-3857}/g,f)}isChildOf(n){const a=this.z-n.z;return a>0&&n.x===this.x>>a&&n.y===this.y>>a}getTilePoint(n){const a=Math.pow(2,this.z);return new F((n.x*a-this.x)*Ne,(n.y*a-this.y)*Ne)}toString(){return`${this.z}/${this.x}/${this.y}`}}class y0{constructor(n,a){this.wrap=n,this.canonical=a,this.key=qc(n,a.z,a.z,a.x,a.y)}}class fa{constructor(n,a,c,f,v){if(this.terrainRttPosMatrix32f=null,n<c)throw new Error(`overscaledZ should be >= z; overscaledZ = ${n}; z = ${c}`);this.overscaledZ=n,this.wrap=a,this.canonical=new zg(c,+f,+v),this.key=qc(a,n,c,f,v)}clone(){return new fa(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-n;return n>this.canonical.z?new fa(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new fa(n,this.wrap,n,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(n,a){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const c=this.canonical.z-n;return n>this.canonical.z?qc(this.wrap*+a,n,this.canonical.z,this.canonical.x,this.canonical.y):qc(this.wrap*+a,n,n,this.canonical.x>>c,this.canonical.y>>c)}isChildOf(n){if(n.wrap!==this.wrap)return!1;const a=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.x===this.canonical.x>>a&&n.canonical.y===this.canonical.y>>a}children(n){if(this.overscaledZ>=n)return[new fa(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,c=2*this.canonical.x,f=2*this.canonical.y;return[new fa(a,this.wrap,a,c,f),new fa(a,this.wrap,a,c+1,f),new fa(a,this.wrap,a,c,f+1),new fa(a,this.wrap,a,c+1,f+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new fa(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new fa(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new y0(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(n){return this.canonical.getTilePoint(new Nh(n.x-this.wrap,n.y))}}function qc(s,n,a,c,f){(s*=2)<0&&(s=-1*s-1);const v=1<<a;return(v*v*s+v*f+c).toString(36)+a.toString(36)+n.toString(36)}Bt("CanonicalTileID",zg),Bt("OverscaledTileID",fa,{omit:["terrainRttPosMatrix32f"]});class v0{constructor(n,a,c,f=1,v=1,b=1,w=0){if(this.uid=n,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(c&&!["mapbox","terrarium","custom"].includes(c))return void ri(`"${c}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=a.height;const C=this.dim=a.height-2;switch(this.data=new Uint32Array(a.data.buffer),c){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=f,this.greenFactor=v,this.blueFactor=b,this.baseShift=w;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let I=0;I<C;I++)this.data[this._idx(-1,I)]=this.data[this._idx(0,I)],this.data[this._idx(C,I)]=this.data[this._idx(C-1,I)],this.data[this._idx(I,-1)]=this.data[this._idx(I,0)],this.data[this._idx(I,C)]=this.data[this._idx(I,C-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(C,-1)]=this.data[this._idx(C-1,0)],this.data[this._idx(-1,C)]=this.data[this._idx(0,C-1)],this.data[this._idx(C,C)]=this.data[this._idx(C-1,C-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let I=0;I<C;I++)for(let R=0;R<C;R++){const L=this.get(I,R);L>this.max&&(this.max=L),L<this.min&&(this.min=L)}}get(n,a){const c=new Uint8Array(this.data.buffer),f=4*this._idx(n,a);return this.unpack(c[f],c[f+1],c[f+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(n,a){if(n<-1||n>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(n+1)}unpack(n,a,c){return n*this.redFactor+a*this.greenFactor+c*this.blueFactor-this.baseShift}getPixels(){return new da({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(n,a,c){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let f=a*this.dim,v=a*this.dim+this.dim,b=c*this.dim,w=c*this.dim+this.dim;switch(a){case-1:f=v-1;break;case 1:v=f+1}switch(c){case-1:b=w-1;break;case 1:w=b+1}const C=-a*this.dim,I=-c*this.dim;for(let R=b;R<w;R++)for(let L=f;L<v;L++)this.data[this._idx(L,R)]=n.data[this._idx(L+C,R+I)]}}Bt("DEMData",v0);class b0{constructor(n){this._stringToNumber={},this._numberToString=[];for(let a=0;a<n.length;a++){const c=n[a];this._stringToNumber[c]=a,this._numberToString[a]=c}}encode(n){return this._stringToNumber[n]}decode(n){if(n>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${n} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[n]}}class x0{constructor(n,a,c,f,v){this.type="Feature",this._vectorTileFeature=n,n._z=a,n._x=c,n._y=f,this.properties=n.properties,this.id=v}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={geometry:this.geometry};for(const a in this)a!=="_geometry"&&a!=="_vectorTileFeature"&&(n[a]=this[a]);return n}}class w0{constructor(n,a){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new js(Ne,16,0),this.grid3D=new js(Ne,16,0),this.featureIndexArray=new le,this.promoteId=a}insert(n,a,c,f,v,b){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,f,v);const C=b?this.grid3D:this.grid;for(let I=0;I<a.length;I++){const R=a[I],L=[1/0,1/0,-1/0,-1/0];for(let $=0;$<R.length;$++){const G=R[$];L[0]=Math.min(L[0],G.x),L[1]=Math.min(L[1],G.y),L[2]=Math.max(L[2],G.x),L[3]=Math.max(L[3],G.y)}L[0]<Ne&&L[1]<Ne&&L[2]>=0&&L[3]>=0&&C.insert(w,L[0],L[1],L[2],L[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new zh.VectorTile(new wg(this.rawTileData)).layers,this.sourceLayerCoder=new b0(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(n,a,c,f){this.loadVTLayers();const v=n.params,b=Ne/n.tileSize/n.scale,w=Tc(v.filter),C=n.queryGeometry,I=n.queryPadding*b,R=C0(C),L=this.grid.query(R.minX-I,R.minY-I,R.maxX+I,R.maxY+I),$=C0(n.cameraQueryGeometry),G=this.grid3D.query($.minX-I,$.minY-I,$.maxX+I,$.maxY+I,(ie,he,ze,ge)=>function(U,ne,ve,He,dt){for(const nt of U)if(ne<=nt.x&&ve<=nt.y&&He>=nt.x&&dt>=nt.y)return!0;const Xe=[new F(ne,ve),new F(ne,dt),new F(He,dt),new F(He,ve)];if(U.length>2){for(const nt of Xe)if($c(U,nt))return!0}for(let nt=0;nt<U.length-1;nt++)if(t2(U[nt],U[nt+1],Xe))return!0;return!1}(n.cameraQueryGeometry,ie-I,he-I,ze+I,ge+I));for(const ie of G)L.push(ie);L.sort(fT);const Z={};let K;for(let ie=0;ie<L.length;ie++){const he=L[ie];if(he===K)continue;K=he;const ze=this.featureIndexArray.get(he);let ge=null;this.loadMatchingFeature(Z,ze.bucketIndex,ze.sourceLayerIndex,ze.featureIndex,w,v.layers,v.availableImages,a,c,f,(U,ne,ve)=>(ge||(ge=Hs(U)),ne.queryIntersectsFeature({queryGeometry:C,feature:U,featureState:ve,geometry:ge,zoom:this.z,transform:n.transform,pixelsToTileUnits:b,pixelPosMatrix:n.pixelPosMatrix})))}return Z}loadMatchingFeature(n,a,c,f,v,b,w,C,I,R,L){const $=this.bucketLayerIDs[a];if(b&&!$.some(ie=>b.has(ie)))return;const G=this.sourceLayerCoder.decode(c),Z=this.vtLayers[G].feature(f);if(v.needGeometry){const ie=Zs(Z,!0);if(!v.filter(new fi(this.tileID.overscaledZ),ie,this.tileID.canonical))return}else if(!v.filter(new fi(this.tileID.overscaledZ),Z))return;const K=this.getId(Z,G);for(let ie=0;ie<$.length;ie++){const he=$[ie];if(b&&!b.has(he))continue;const ze=C[he];if(!ze)continue;let ge={};K&&R&&(ge=R.getState(ze.sourceLayer||"_geojsonTileLayer",K));const U=Kt({},I[he]);U.paint=S0(U.paint,ze.paint,Z,ge,w),U.layout=S0(U.layout,ze.layout,Z,ge,w);const ne=!L||L(Z,ze,ge);if(!ne)continue;const ve=new x0(Z,this.z,this.x,this.y,K);ve.layer=U;let He=n[he];He===void 0&&(He=n[he]=[]),He.push({featureIndex:f,feature:ve,intersectionZ:ne})}}lookupSymbolFeatures(n,a,c,f,v,b,w,C){const I={};this.loadVTLayers();const R=Tc(v);for(const L of n)this.loadMatchingFeature(I,c,f,L,R,b,w,C,a);return I}hasLayer(n){for(const a of this.bucketLayerIDs)for(const c of a)if(n===c)return!0;return!1}getId(n,a){var c;let f=n.id;return this.promoteId&&(f=n.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[a]],typeof f=="boolean"&&(f=Number(f)),f===void 0&&(!((c=n.properties)===null||c===void 0)&&c.cluster)&&this.promoteId&&(f=Number(n.properties.cluster_id))),f}}function S0(s,n,a,c,f){return _n(s,(v,b)=>{const w=n instanceof Mo?n.get(b):null;return w&&w.evaluate?w.evaluate(a,c,f):w})}function C0(s){let n=1/0,a=1/0,c=-1/0,f=-1/0;for(const v of s)n=Math.min(n,v.x),a=Math.min(a,v.y),c=Math.max(c,v.x),f=Math.max(f,v.y);return{minX:n,minY:a,maxX:c,maxY:f}}function fT(s,n){return n-s}function T0(s,n,a,c,f){const v=[];for(let b=0;b<s.length;b++){const w=s[b];let C;for(let I=0;I<w.length-1;I++){let R=w[I],L=w[I+1];R.x<n&&L.x<n||(R.x<n?R=new F(n,R.y+(n-R.x)/(L.x-R.x)*(L.y-R.y))._round():L.x<n&&(L=new F(n,R.y+(n-R.x)/(L.x-R.x)*(L.y-R.y))._round()),R.y<a&&L.y<a||(R.y<a?R=new F(R.x+(a-R.y)/(L.y-R.y)*(L.x-R.x),a)._round():L.y<a&&(L=new F(R.x+(a-R.y)/(L.y-R.y)*(L.x-R.x),a)._round()),R.x>=c&&L.x>=c||(R.x>=c?R=new F(c,R.y+(c-R.x)/(L.x-R.x)*(L.y-R.y))._round():L.x>=c&&(L=new F(c,R.y+(c-R.x)/(L.x-R.x)*(L.y-R.y))._round()),R.y>=f&&L.y>=f||(R.y>=f?R=new F(R.x+(f-R.y)/(L.y-R.y)*(L.x-R.x),f)._round():L.y>=f&&(L=new F(R.x+(f-R.y)/(L.y-R.y)*(L.x-R.x),f)._round()),C&&R.equals(C[C.length-1])||(C=[R],v.push(C)),C.push(L)))))}}return v}Bt("FeatureIndex",w0,{omit:["rawTileData","sourceLayerCoder"]});class Bo extends F{constructor(n,a,c,f){super(n,a),this.angle=c,f!==void 0&&(this.segment=f)}clone(){return new Bo(this.x,this.y,this.angle,this.segment)}}function P0(s,n,a,c,f){if(n.segment===void 0||a===0)return!0;let v=n,b=n.segment+1,w=0;for(;w>-a/2;){if(b--,b<0)return!1;w-=s[b].dist(v),v=s[b]}w+=s[b].dist(s[b+1]),b++;const C=[];let I=0;for(;w<a/2;){const R=s[b],L=s[b+1];if(!L)return!1;let $=s[b-1].angleTo(R)-R.angleTo(L);for($=Math.abs(($+3*Math.PI)%(2*Math.PI)-Math.PI),C.push({distance:w,angleDelta:$}),I+=$;w-C[0].distance>c;)I-=C.shift().angleDelta;if(I>f)return!1;b++,w+=R.dist(L)}return!0}function k0(s){let n=0;for(let a=0;a<s.length-1;a++)n+=s[a].dist(s[a+1]);return n}function I0(s,n,a){return s?.6*n*a:0}function M0(s,n){return Math.max(s?s.right-s.left:0,n?n.right-n.left:0)}function pT(s,n,a,c,f,v){const b=I0(a,f,v),w=M0(a,c)*v;let C=0;const I=k0(s)/2;for(let R=0;R<s.length-1;R++){const L=s[R],$=s[R+1],G=L.dist($);if(C+G>I){const Z=(I-C)/G,K=ua.number(L.x,$.x,Z),ie=ua.number(L.y,$.y,Z),he=new Bo(K,ie,$.angleTo(L),R);return he._round(),!b||P0(s,he,w,b,n)?he:void 0}C+=G}}function mT(s,n,a,c,f,v,b,w,C){const I=I0(c,v,b),R=M0(c,f),L=R*b,$=s[0].x===0||s[0].x===C||s[0].y===0||s[0].y===C;return n-L<n/4&&(n=L+n/4),E0(s,$?n/2*w%n:(R/2+2*v)*b*w%n,n,I,a,L,$,!1,C)}function E0(s,n,a,c,f,v,b,w,C){const I=v/2,R=k0(s);let L=0,$=n-a,G=[];for(let Z=0;Z<s.length-1;Z++){const K=s[Z],ie=s[Z+1],he=K.dist(ie),ze=ie.angleTo(K);for(;$+a<L+he;){$+=a;const ge=($-L)/he,U=ua.number(K.x,ie.x,ge),ne=ua.number(K.y,ie.y,ge);if(U>=0&&U<C&&ne>=0&&ne<C&&$-I>=0&&$+I<=R){const ve=new Bo(U,ne,ze,Z);ve._round(),c&&!P0(s,ve,v,c,f)||G.push(ve)}}L+=he}return w||G.length||b||(G=E0(s,L/2,a,c,f,v,b,!0,C)),G}Bt("Anchor",Bo);const $h=Ur;function A0(s,n,a,c){const f=[],v=s.image,b=v.pixelRatio,w=v.paddedRect.w-2*$h,C=v.paddedRect.h-2*$h;let I={x1:s.left,y1:s.top,x2:s.right,y2:s.bottom};const R=v.stretchX||[[0,w]],L=v.stretchY||[[0,C]],$=(at,$t)=>at+$t[1]-$t[0],G=R.reduce($,0),Z=L.reduce($,0),K=w-G,ie=C-Z;let he=0,ze=G,ge=0,U=Z,ne=0,ve=K,He=0,dt=ie;if(v.content&&c){const at=v.content,$t=at[2]-at[0],Jt=at[3]-at[1];(v.textFitWidth||v.textFitHeight)&&(I=i0(s)),he=tp(R,0,at[0]),ge=tp(L,0,at[1]),ze=tp(R,at[0],at[2]),U=tp(L,at[1],at[3]),ne=at[0]-he,He=at[1]-ge,ve=$t-ze,dt=Jt-U}const Xe=I.x1,nt=I.y1,yt=I.x2-Xe,pt=I.y2-nt,bt=(at,$t,Jt,Xt)=>{const Ut=np(at.stretch-he,ze,yt,Xe),Mn=ip(at.fixed-ne,ve,at.stretch,G),Ii=np($t.stretch-ge,U,pt,nt),Yi=ip($t.fixed-He,dt,$t.stretch,Z),_r=np(Jt.stretch-he,ze,yt,Xe),pa=ip(Jt.fixed-ne,ve,Jt.stretch,G),Gr=np(Xt.stretch-ge,U,pt,nt),lr=ip(Xt.fixed-He,dt,Xt.stretch,Z),wi=new F(Ut,Ii),tr=new F(_r,Ii),cr=new F(_r,Gr),ur=new F(Ut,Gr),Rr=new F(Mn/b,Yi/b),ma=new F(pa/b,lr/b),nr=n*Math.PI/180;if(nr){const ir=Math.sin(nr),rr=Math.cos(nr),ji=[rr,-ir,ir,rr];wi._matMult(ji),tr._matMult(ji),ur._matMult(ji),cr._matMult(ji)}const Hr=at.stretch+at.fixed,Ji=$t.stretch+$t.fixed;return{tl:wi,tr,bl:ur,br:cr,tex:{x:v.paddedRect.x+$h+Hr,y:v.paddedRect.y+$h+Ji,w:Jt.stretch+Jt.fixed-Hr,h:Xt.stretch+Xt.fixed-Ji},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Rr,pixelOffsetBR:ma,minFontScaleX:ve/b/yt,minFontScaleY:dt/b/pt,isSDF:a}};if(c&&(v.stretchX||v.stretchY)){const at=R0(R,K,G),$t=R0(L,ie,Z);for(let Jt=0;Jt<at.length-1;Jt++){const Xt=at[Jt],Ut=at[Jt+1];for(let Mn=0;Mn<$t.length-1;Mn++)f.push(bt(Xt,$t[Mn],Ut,$t[Mn+1]))}}else f.push(bt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:C+1}));return f}function tp(s,n,a){let c=0;for(const f of s)c+=Math.max(n,Math.min(a,f[1]))-Math.max(n,Math.min(a,f[0]));return c}function R0(s,n,a){const c=[{fixed:-1,stretch:0}];for(const[f,v]of s){const b=c[c.length-1];c.push({fixed:f-b.stretch,stretch:b.stretch}),c.push({fixed:f-b.stretch,stretch:b.stretch+(v-f)})}return c.push({fixed:n+$h,stretch:a}),c}function np(s,n,a,c){return s/n*a+c}function ip(s,n,a,c){return s-n*a/c}class rp{constructor(n,a,c,f,v,b,w,C,I,R){var L;if(this.boxStartIndex=n.length,I){let $=b.top,G=b.bottom;const Z=b.collisionPadding;Z&&($-=Z[1],G+=Z[3]);let K=G-$;K>0&&(K=Math.max(10,K),this.circleDiameter=K)}else{const $=!((L=b.image)===null||L===void 0)&&L.content&&(b.image.textFitWidth||b.image.textFitHeight)?i0(b):{x1:b.left,y1:b.top,x2:b.right,y2:b.bottom};$.y1=$.y1*w-C[0],$.y2=$.y2*w+C[2],$.x1=$.x1*w-C[3],$.x2=$.x2*w+C[1];const G=b.collisionPadding;if(G&&($.x1-=G[0]*w,$.y1-=G[1]*w,$.x2+=G[2]*w,$.y2+=G[3]*w),R){const Z=new F($.x1,$.y1),K=new F($.x2,$.y1),ie=new F($.x1,$.y2),he=new F($.x2,$.y2),ze=R*Math.PI/180;Z._rotate(ze),K._rotate(ze),ie._rotate(ze),he._rotate(ze),$.x1=Math.min(Z.x,K.x,ie.x,he.x),$.x2=Math.max(Z.x,K.x,ie.x,he.x),$.y1=Math.min(Z.y,K.y,ie.y,he.y),$.y2=Math.max(Z.y,K.y,ie.y,he.y)}n.emplaceBack(a.x,a.y,$.x1,$.y1,$.x2,$.y2,c,f,v)}this.boxEndIndex=n.length}}class gT{constructor(n=[],a=(c,f)=>c<f?-1:c>f?1:0){if(this.data=n,this.length=this.data.length,this.compare=a,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:a,compare:c}=this,f=a[n];for(;n>0;){const v=n-1>>1,b=a[v];if(c(f,b)>=0)break;a[n]=b,n=v}a[n]=f}_down(n){const{data:a,compare:c}=this,f=this.length>>1,v=a[n];for(;n<f;){let b=1+(n<<1);const w=b+1;if(w<this.length&&c(a[w],a[b])<0&&(b=w),c(a[b],v)>=0)break;a[n]=a[b],n=b}a[n]=v}}function _T(s,n=1,a=!1){let c=1/0,f=1/0,v=-1/0,b=-1/0;const w=s[0];for(let G=0;G<w.length;G++){const Z=w[G];(!G||Z.x<c)&&(c=Z.x),(!G||Z.y<f)&&(f=Z.y),(!G||Z.x>v)&&(v=Z.x),(!G||Z.y>b)&&(b=Z.y)}const C=Math.min(v-c,b-f);let I=C/2;const R=new gT([],yT);if(C===0)return new F(c,f);for(let G=c;G<v;G+=C)for(let Z=f;Z<b;Z+=C)R.push(new Wc(G+I,Z+I,I,s));let L=function(G){let Z=0,K=0,ie=0;const he=G[0];for(let ze=0,ge=he.length,U=ge-1;ze<ge;U=ze++){const ne=he[ze],ve=he[U],He=ne.x*ve.y-ve.x*ne.y;K+=(ne.x+ve.x)*He,ie+=(ne.y+ve.y)*He,Z+=3*He}return new Wc(K/Z,ie/Z,0,G)}(s),$=R.length;for(;R.length;){const G=R.pop();(G.d>L.d||!L.d)&&(L=G,a&&console.log("found best %d after %d probes",Math.round(1e4*G.d)/1e4,$)),G.max-L.d<=n||(I=G.h/2,R.push(new Wc(G.p.x-I,G.p.y-I,I,s)),R.push(new Wc(G.p.x+I,G.p.y-I,I,s)),R.push(new Wc(G.p.x-I,G.p.y+I,I,s)),R.push(new Wc(G.p.x+I,G.p.y+I,I,s)),$+=4)}return a&&(console.log(`num probes: ${$}`),console.log(`best distance: ${L.d}`)),L.p}function yT(s,n){return n.max-s.max}function Wc(s,n,a,c){this.p=new F(s,n),this.h=a,this.d=function(f,v){let b=!1,w=1/0;for(let C=0;C<v.length;C++){const I=v[C];for(let R=0,L=I.length,$=L-1;R<L;$=R++){const G=I[R],Z=I[$];G.y>f.y!=Z.y>f.y&&f.x<(Z.x-G.x)*(f.y-G.y)/(Z.y-G.y)+G.x&&(b=!b),w=Math.min(w,dv(f,G,Z))}}return(b?1:-1)*Math.sqrt(w)}(this.p,c),this.max=this.d+this.h*Math.SQRT2}var gr;m.av=void 0,(gr=m.av||(m.av={}))[gr.center=1]="center",gr[gr.left=2]="left",gr[gr.right=3]="right",gr[gr.top=4]="top",gr[gr.bottom=5]="bottom",gr[gr["top-left"]=6]="top-left",gr[gr["top-right"]=7]="top-right",gr[gr["bottom-left"]=8]="bottom-left",gr[gr["bottom-right"]=9]="bottom-right";const Fo=7,Lg=Number.POSITIVE_INFINITY;function D0(s,n){return n[1]!==Lg?function(a,c,f){let v=0,b=0;switch(c=Math.abs(c),f=Math.abs(f),a){case"top-right":case"top-left":case"top":b=f-Fo;break;case"bottom-right":case"bottom-left":case"bottom":b=-f+Fo}switch(a){case"top-right":case"bottom-right":case"right":v=-c;break;case"top-left":case"bottom-left":case"left":v=c}return[v,b]}(s,n[0],n[1]):function(a,c){let f=0,v=0;c<0&&(c=0);const b=c/Math.SQRT2;switch(a){case"top-right":case"top-left":v=b-Fo;break;case"bottom-right":case"bottom-left":v=-b+Fo;break;case"bottom":v=-c+Fo;break;case"top":v=c-Fo}switch(a){case"top-right":case"bottom-right":f=-b;break;case"top-left":case"bottom-left":f=b;break;case"left":f=c;break;case"right":f=-c}return[f,v]}(s,n[0])}function z0(s,n,a){var c;const f=s.layout,v=(c=f.get("text-variable-anchor-offset"))===null||c===void 0?void 0:c.evaluate(n,{},a);if(v){const w=v.values,C=[];for(let I=0;I<w.length;I+=2){const R=C[I]=w[I],L=w[I+1].map($=>$*Ki);R.startsWith("top")?L[1]-=Fo:R.startsWith("bottom")&&(L[1]+=Fo),C[I+1]=L}return new fr(C)}const b=f.get("text-variable-anchor");if(b){let w;w=s._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[f.get("text-radial-offset").evaluate(n,{},a)*Ki,Lg]:f.get("text-offset").evaluate(n,{},a).map(I=>I*Ki);const C=[];for(const I of b)C.push(I,D0(I,w));return new fr(C)}return null}function Bg(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function vT(s,n,a,c,f,v,b,w,C,I,R,L){let $=v.textMaxSize.evaluate(n,{});$===void 0&&($=b);const G=s.layers[0].layout,Z=G.get("icon-offset").evaluate(n,{},R),K=B0(a.horizontal),ie=b/24,he=s.tilePixelRatio*ie,ze=s.tilePixelRatio*$/24,ge=s.tilePixelRatio*w,U=s.tilePixelRatio*G.get("symbol-spacing"),ne=G.get("text-padding")*s.tilePixelRatio,ve=function(Jt,Xt,Ut,Mn=1){const Ii=Jt.get("icon-padding").evaluate(Xt,{},Ut),Yi=Ii&&Ii.values;return[Yi[0]*Mn,Yi[1]*Mn,Yi[2]*Mn,Yi[3]*Mn]}(G,n,R,s.tilePixelRatio),He=G.get("text-max-angle")/180*Math.PI,dt=G.get("text-rotation-alignment")!=="viewport"&&G.get("symbol-placement")!=="point",Xe=G.get("icon-rotation-alignment")==="map"&&G.get("symbol-placement")!=="point",nt=G.get("symbol-placement"),yt=U/2,pt=G.get("icon-text-fit");let bt;c&&pt!=="none"&&(s.allowVerticalPlacement&&a.vertical&&(bt=r0(c,a.vertical,pt,G.get("icon-text-fit-padding"),Z,ie)),K&&(c=r0(c,K,pt,G.get("icon-text-fit-padding"),Z,ie)));const at=R?L.line.getGranularityForZoomLevel(R.z):1,$t=(Jt,Xt)=>{Xt.x<0||Xt.x>=Ne||Xt.y<0||Xt.y>=Ne||function(Ut,Mn,Ii,Yi,_r,pa,Gr,lr,wi,tr,cr,ur,Rr,ma,nr,Hr,Ji,ir,rr,ji,oi,Ka,Xc,Ya,wT){const Kc=Ut.addToLineVertexArray(Mn,Ii);let Rl,Yc,Jc,Qc,N0=0,$0=0,j0=0,U0=0,Gg=-1,Hg=-1;const qs={};let G0=Ni("");if(Ut.allowVerticalPlacement&&Yi.vertical){const Sr=lr.layout.get("text-rotate").evaluate(oi,{},Ya)+90;Jc=new rp(wi,Mn,tr,cr,ur,Yi.vertical,Rr,ma,nr,Sr),Gr&&(Qc=new rp(wi,Mn,tr,cr,ur,Gr,Ji,ir,nr,Sr))}if(_r){const Sr=lr.layout.get("icon-rotate").evaluate(oi,{}),ga=lr.layout.get("icon-text-fit")!=="none",Dl=A0(_r,Sr,Xc,ga),Qa=Gr?A0(Gr,Sr,Xc,ga):void 0;Yc=new rp(wi,Mn,tr,cr,ur,_r,Ji,ir,!1,Sr),N0=4*Dl.length;const zl=Ut.iconSizeData;let ms=null;zl.kind==="source"?(ms=[ps*lr.layout.get("icon-size").evaluate(oi,{})],ms[0]>zo&&ri(`${Ut.layerIds[0]}: Value for "icon-size" is >= ${Vh}. Reduce your "icon-size".`)):zl.kind==="composite"&&(ms=[ps*Ka.compositeIconSizes[0].evaluate(oi,{},Ya),ps*Ka.compositeIconSizes[1].evaluate(oi,{},Ya)],(ms[0]>zo||ms[1]>zo)&&ri(`${Ut.layerIds[0]}: Value for "icon-size" is >= ${Vh}. Reduce your "icon-size".`)),Ut.addSymbols(Ut.icon,Dl,ms,ji,rr,oi,m.ai.none,Mn,Kc.lineStartIndex,Kc.lineLength,-1,Ya),Gg=Ut.icon.placedSymbolArray.length-1,Qa&&($0=4*Qa.length,Ut.addSymbols(Ut.icon,Qa,ms,ji,rr,oi,m.ai.vertical,Mn,Kc.lineStartIndex,Kc.lineLength,-1,Ya),Hg=Ut.icon.placedSymbolArray.length-1)}const H0=Object.keys(Yi.horizontal);for(const Sr of H0){const ga=Yi.horizontal[Sr];if(!Rl){G0=Ni(ga.text);const Qa=lr.layout.get("text-rotate").evaluate(oi,{},Ya);Rl=new rp(wi,Mn,tr,cr,ur,ga,Rr,ma,nr,Qa)}const Dl=ga.positionedLines.length===1;if(j0+=L0(Ut,Mn,ga,pa,lr,nr,oi,Hr,Kc,Yi.vertical?m.ai.horizontal:m.ai.horizontalOnly,Dl?H0:[Sr],qs,Gg,Ka,Ya),Dl)break}Yi.vertical&&(U0+=L0(Ut,Mn,Yi.vertical,pa,lr,nr,oi,Hr,Kc,m.ai.vertical,["vertical"],qs,Hg,Ka,Ya));const ST=Rl?Rl.boxStartIndex:Ut.collisionBoxArray.length,CT=Rl?Rl.boxEndIndex:Ut.collisionBoxArray.length,TT=Jc?Jc.boxStartIndex:Ut.collisionBoxArray.length,PT=Jc?Jc.boxEndIndex:Ut.collisionBoxArray.length,kT=Yc?Yc.boxStartIndex:Ut.collisionBoxArray.length,IT=Yc?Yc.boxEndIndex:Ut.collisionBoxArray.length,MT=Qc?Qc.boxStartIndex:Ut.collisionBoxArray.length,ET=Qc?Qc.boxEndIndex:Ut.collisionBoxArray.length;let Ja=-1;const sp=(Sr,ga)=>Sr&&Sr.circleDiameter?Math.max(Sr.circleDiameter,ga):ga;Ja=sp(Rl,Ja),Ja=sp(Jc,Ja),Ja=sp(Yc,Ja),Ja=sp(Qc,Ja);const Z0=Ja>-1?1:0;Z0&&(Ja*=wT/Ki),Ut.glyphOffsetArray.length>=Zc.MAX_GLYPHS&&ri("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),oi.sortKey!==void 0&&Ut.addToSortKeyRanges(Ut.symbolInstances.length,oi.sortKey);const AT=z0(lr,oi,Ya),[RT,DT]=function(Sr,ga){const Dl=Sr.length,Qa=ga==null?void 0:ga.values;if((Qa==null?void 0:Qa.length)>0)for(let zl=0;zl<Qa.length;zl+=2){const ms=Qa[zl+1];Sr.emplaceBack(m.av[Qa[zl]],ms[0],ms[1])}return[Dl,Sr.length]}(Ut.textAnchorOffsets,AT);Ut.symbolInstances.emplaceBack(Mn.x,Mn.y,qs.right>=0?qs.right:-1,qs.center>=0?qs.center:-1,qs.left>=0?qs.left:-1,qs.vertical||-1,Gg,Hg,G0,ST,CT,TT,PT,kT,IT,MT,ET,tr,j0,U0,N0,$0,Z0,0,Rr,Ja,RT,DT)}(s,Xt,Jt,a,c,f,bt,s.layers[0],s.collisionBoxArray,n.index,n.sourceLayerIndex,s.index,he,[ne,ne,ne,ne],dt,C,ge,ve,Xe,Z,n,v,I,R,b)};if(nt==="line")for(const Jt of T0(n.geometry,0,0,Ne,Ne)){const Xt=Al(Jt,at),Ut=mT(Xt,U,He,a.vertical||K,c,24,ze,s.overscaling,Ne);for(const Mn of Ut)K&&bT(s,K.text,yt,Mn)||$t(Xt,Mn)}else if(nt==="line-center"){for(const Jt of n.geometry)if(Jt.length>1){const Xt=Al(Jt,at),Ut=pT(Xt,He,a.vertical||K,c,24,ze);Ut&&$t(Xt,Ut)}}else if(n.type==="Polygon")for(const Jt of uc(n.geometry,0)){const Xt=_T(Jt,16);$t(Al(Jt[0],at,!0),new Bo(Xt.x,Xt.y,0))}else if(n.type==="LineString")for(const Jt of n.geometry){const Xt=Al(Jt,at);$t(Xt,new Bo(Xt[0].x,Xt[0].y,0))}else if(n.type==="Point")for(const Jt of n.geometry)for(const Xt of Jt)$t([Xt],new Bo(Xt.x,Xt.y,0))}function L0(s,n,a,c,f,v,b,w,C,I,R,L,$,G,Z){const K=function(ze,ge,U,ne,ve,He,dt,Xe){const nt=ne.layout.get("text-rotate").evaluate(He,{})*Math.PI/180,yt=[];for(const pt of ge.positionedLines)for(const bt of pt.positionedGlyphs){if(!bt.rect)continue;const at=bt.rect||{};let $t=W2+1,Jt=!0,Xt=1,Ut=0;const Mn=(ve||Xe)&&bt.vertical,Ii=bt.metrics.advance*bt.scale/2;if(Xe&&ge.verticalizable&&(Ut=pt.lineOffset/2-(bt.imageName?-(Ki-bt.metrics.width*bt.scale)/2:(bt.scale-1)*Ki)),bt.imageName){const ir=dt[bt.imageName];Jt=ir.sdf,Xt=ir.pixelRatio,$t=Ur/Xt}const Yi=ve?[bt.x+Ii,bt.y]:[0,0];let _r=ve?[0,0]:[bt.x+Ii+U[0],bt.y+U[1]-Ut],pa=[0,0];Mn&&(pa=_r,_r=[0,0]);const Gr=bt.metrics.isDoubleResolution?2:1,lr=(bt.metrics.left-$t)*bt.scale-Ii+_r[0],wi=(-bt.metrics.top-$t)*bt.scale+_r[1],tr=lr+at.w/Gr*bt.scale/Xt,cr=wi+at.h/Gr*bt.scale/Xt,ur=new F(lr,wi),Rr=new F(tr,wi),ma=new F(lr,cr),nr=new F(tr,cr);if(Mn){const ir=new F(-Ii,Ii-Kf),rr=-Math.PI/2,ji=Ki/2-Ii,oi=new F(5-Kf-ji,-(bt.imageName?ji:0)),Ka=new F(...pa);ur._rotateAround(rr,ir)._add(oi)._add(Ka),Rr._rotateAround(rr,ir)._add(oi)._add(Ka),ma._rotateAround(rr,ir)._add(oi)._add(Ka),nr._rotateAround(rr,ir)._add(oi)._add(Ka)}if(nt){const ir=Math.sin(nt),rr=Math.cos(nt),ji=[rr,-ir,ir,rr];ur._matMult(ji),Rr._matMult(ji),ma._matMult(ji),nr._matMult(ji)}const Hr=new F(0,0),Ji=new F(0,0);yt.push({tl:ur,tr:Rr,bl:ma,br:nr,tex:at,writingMode:ge.writingMode,glyphOffset:Yi,sectionIndex:bt.sectionIndex,isSDF:Jt,pixelOffsetTL:Hr,pixelOffsetBR:Ji,minFontScaleX:0,minFontScaleY:0})}return yt}(0,a,w,f,v,b,c,s.allowVerticalPlacement),ie=s.textSizeData;let he=null;ie.kind==="source"?(he=[ps*f.layout.get("text-size").evaluate(b,{})],he[0]>zo&&ri(`${s.layerIds[0]}: Value for "text-size" is >= ${Vh}. Reduce your "text-size".`)):ie.kind==="composite"&&(he=[ps*G.compositeTextSizes[0].evaluate(b,{},Z),ps*G.compositeTextSizes[1].evaluate(b,{},Z)],(he[0]>zo||he[1]>zo)&&ri(`${s.layerIds[0]}: Value for "text-size" is >= ${Vh}. Reduce your "text-size".`)),s.addSymbols(s.text,K,he,w,v,b,I,n,C.lineStartIndex,C.lineLength,$,Z);for(const ze of R)L[ze]=s.text.placedSymbolArray.length-1;return 4*K.length}function B0(s){for(const n in s)return s[n];return null}function bT(s,n,a,c){const f=s.compareText;if(n in f){const v=f[n];for(let b=v.length-1;b>=0;b--)if(c.dist(v[b])<a)return!0}else f[n]=[];return f[n].push(c),!1}const F0=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Fg{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,c]=new Uint8Array(n,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=c>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const v=F0[15&c];if(!v)throw new Error("Unrecognized array type.");const[b]=new Uint16Array(n,2,1),[w]=new Uint32Array(n,4,1);return new Fg(w,b,v,n)}constructor(n,a=64,c=Float64Array,f){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=c,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const v=F0.indexOf(this.ArrayType),b=2*n*this.ArrayType.BYTES_PER_ELEMENT,w=n*this.IndexArrayType.BYTES_PER_ELEMENT,C=(8-w%8)%8;if(v<0)throw new Error(`Unexpected typed array class: ${c}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+w+C,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+b+w+C),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+w+C,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+v]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=n)}add(n,a){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=n,this.coords[this._pos++]=a,c}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return Og(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,a,c,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:b,nodeSize:w}=this,C=[0,v.length-1,0],I=[];for(;C.length;){const R=C.pop()||0,L=C.pop()||0,$=C.pop()||0;if(L-$<=w){for(let ie=$;ie<=L;ie++){const he=b[2*ie],ze=b[2*ie+1];he>=n&&he<=c&&ze>=a&&ze<=f&&I.push(v[ie])}continue}const G=$+L>>1,Z=b[2*G],K=b[2*G+1];Z>=n&&Z<=c&&K>=a&&K<=f&&I.push(v[G]),(R===0?n<=Z:a<=K)&&(C.push($),C.push(G-1),C.push(1-R)),(R===0?c>=Z:f>=K)&&(C.push(G+1),C.push(L),C.push(1-R))}return I}within(n,a,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:v,nodeSize:b}=this,w=[0,f.length-1,0],C=[],I=c*c;for(;w.length;){const R=w.pop()||0,L=w.pop()||0,$=w.pop()||0;if(L-$<=b){for(let ie=$;ie<=L;ie++)V0(v[2*ie],v[2*ie+1],n,a)<=I&&C.push(f[ie]);continue}const G=$+L>>1,Z=v[2*G],K=v[2*G+1];V0(Z,K,n,a)<=I&&C.push(f[G]),(R===0?n-c<=Z:a-c<=K)&&(w.push($),w.push(G-1),w.push(1-R)),(R===0?n+c>=Z:a+c>=K)&&(w.push(G+1),w.push(L),w.push(1-R))}return C}}function Og(s,n,a,c,f,v){if(f-c<=a)return;const b=c+f>>1;O0(s,n,b,c,f,v),Og(s,n,a,c,b-1,1-v),Og(s,n,a,b+1,f,1-v)}function O0(s,n,a,c,f,v){for(;f>c;){if(f-c>600){const I=f-c+1,R=a-c+1,L=Math.log(I),$=.5*Math.exp(2*L/3),G=.5*Math.sqrt(L*$*(I-$)/I)*(R-I/2<0?-1:1);O0(s,n,a,Math.max(c,Math.floor(a-R*$/I+G)),Math.min(f,Math.floor(a+(I-R)*$/I+G)),v)}const b=n[2*a+v];let w=c,C=f;for(jh(s,n,c,a),n[2*f+v]>b&&jh(s,n,c,f);w<C;){for(jh(s,n,w,C),w++,C--;n[2*w+v]<b;)w++;for(;n[2*C+v]>b;)C--}n[2*c+v]===b?jh(s,n,c,C):(C++,jh(s,n,C,f)),C<=a&&(c=C+1),a<=C&&(f=C-1)}}function jh(s,n,a,c){Vg(s,a,c),Vg(n,2*a,2*c),Vg(n,2*a+1,2*c+1)}function Vg(s,n,a){const c=s[n];s[n]=s[a],s[a]=c}function V0(s,n,a,c){const f=s-a,v=n-c;return f*f+v*v}var Ng;m.ce=void 0,(Ng=m.ce||(m.ce={})).create="create",Ng.load="load",Ng.fullLoad="fullLoad";let ap=null,Uh=[];const $g=1e3/60,jg="loadTime",Ug="fullLoadTime",xT={mark(s){performance.mark(s)},frame(s){const n=s;ap!=null&&Uh.push(n-ap),ap=n},clearMetrics(){ap=null,Uh=[],performance.clearMeasures(jg),performance.clearMeasures(Ug);for(const s in m.ce)performance.clearMarks(m.ce[s])},getPerformanceMetrics(){performance.measure(jg,m.ce.create,m.ce.load),performance.measure(Ug,m.ce.create,m.ce.fullLoad);const s=performance.getEntriesByName(jg)[0].duration,n=performance.getEntriesByName(Ug)[0].duration,a=Uh.length,c=1/(Uh.reduce((v,b)=>v+b,0)/a/1e3),f=Uh.filter(v=>v>$g).reduce((v,b)=>v+(b-$g)/$g,0);return{loadTime:s,fullLoadTime:n,fps:c,percentDroppedFrames:f/(a+f)*100,totalFrames:a}}};m.$=Be,m.A=Ce,m.B=vl,m.C=function(s){if(Le==null){const n=s.navigator?s.navigator.userAgent:null;Le=!!s.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return Le},m.D=Ht,m.E=Mr,m.F=class{constructor(s,n){this.target=s,this.mapId=n,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new dT(()=>this.process()),this.subscription=function(a,c,f,v){return a.addEventListener(c,f,!1),{unsubscribe:()=>{a.removeEventListener(c,f,!1)}}}(this.target,"message",a=>this.receive(a)),this.globalScope=Pe(self)?s:window}registerMessageHandler(s,n){this.messageHandlers[s]=n}sendAsync(s,n){return new Promise((a,c)=>{const f=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[f]={resolve:a,reject:c},n&&n.signal.addEventListener("abort",()=>{delete this.resolveRejects[f];const w={id:f,type:"<cancel>",origin:location.origin,targetMapId:s.targetMapId,sourceMapId:this.mapId};this.target.postMessage(w)},{once:!0});const v=[],b=Object.assign(Object.assign({},s),{id:f,sourceMapId:this.mapId,origin:location.origin,data:bl(s.data,v)});this.target.postMessage(b,{transfer:v})})}receive(s){const n=s.data,a=n.id;if(!(n.origin!=="file://"&&location.origin!=="file://"&&n.origin!=="resource://android"&&location.origin!=="resource://android"&&n.origin!==location.origin||n.targetMapId&&this.mapId!==n.targetMapId)){if(n.type==="<cancel>"){delete this.tasks[a];const c=this.abortControllers[a];return delete this.abortControllers[a],void(c&&c.abort())}if(Pe(self)||n.mustQueue)return this.tasks[a]=n,this.taskQueue.push(a),void this.invoker.trigger();this.processTask(a,n)}}process(){if(this.taskQueue.length===0)return;const s=this.taskQueue.shift(),n=this.tasks[s];delete this.tasks[s],this.taskQueue.length>0&&this.invoker.trigger(),n&&this.processTask(s,n)}processTask(s,n){return o(this,void 0,void 0,function*(){if(n.type==="<response>"){const f=this.resolveRejects[s];return delete this.resolveRejects[s],f?void(n.error?f.reject(hs(n.error)):f.resolve(hs(n.data))):void 0}if(!this.messageHandlers[n.type])return void this.completeTask(s,new Error(`Could not find a registered handler for ${n.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const a=hs(n.data),c=new AbortController;this.abortControllers[s]=c;try{const f=yield this.messageHandlers[n.type](n.sourceMapId,a,c);this.completeTask(s,null,f)}catch(f){this.completeTask(s,f)}})}completeTask(s,n,a){const c=[];delete this.abortControllers[s];const f={id:s,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:n?bl(n):null,data:bl(a,c)};this.target.postMessage(f,{transfer:c})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},m.G=Wt,m.H=function(){var s=new Ce(16);return Ce!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},m.I=Cg,m.J=function(s,n,a){var c,f,v,b,w,C,I,R,L,$,G,Z,K=a[0],ie=a[1],he=a[2];return n===s?(s[12]=n[0]*K+n[4]*ie+n[8]*he+n[12],s[13]=n[1]*K+n[5]*ie+n[9]*he+n[13],s[14]=n[2]*K+n[6]*ie+n[10]*he+n[14],s[15]=n[3]*K+n[7]*ie+n[11]*he+n[15]):(f=n[1],v=n[2],b=n[3],w=n[4],C=n[5],I=n[6],R=n[7],L=n[8],$=n[9],G=n[10],Z=n[11],s[0]=c=n[0],s[1]=f,s[2]=v,s[3]=b,s[4]=w,s[5]=C,s[6]=I,s[7]=R,s[8]=L,s[9]=$,s[10]=G,s[11]=Z,s[12]=c*K+w*ie+L*he+n[12],s[13]=f*K+C*ie+$*he+n[13],s[14]=v*K+I*ie+G*he+n[14],s[15]=b*K+R*ie+Z*he+n[15]),s},m.K=function(s,n,a){var c=a[0],f=a[1],v=a[2];return s[0]=n[0]*c,s[1]=n[1]*c,s[2]=n[2]*c,s[3]=n[3]*c,s[4]=n[4]*f,s[5]=n[5]*f,s[6]=n[6]*f,s[7]=n[7]*f,s[8]=n[8]*v,s[9]=n[9]*v,s[10]=n[10]*v,s[11]=n[11]*v,s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15],s},m.L=function(s,n,a){var c=n[0],f=n[1],v=n[2],b=n[3],w=n[4],C=n[5],I=n[6],R=n[7],L=n[8],$=n[9],G=n[10],Z=n[11],K=n[12],ie=n[13],he=n[14],ze=n[15],ge=a[0],U=a[1],ne=a[2],ve=a[3];return s[0]=ge*c+U*w+ne*L+ve*K,s[1]=ge*f+U*C+ne*$+ve*ie,s[2]=ge*v+U*I+ne*G+ve*he,s[3]=ge*b+U*R+ne*Z+ve*ze,s[4]=(ge=a[4])*c+(U=a[5])*w+(ne=a[6])*L+(ve=a[7])*K,s[5]=ge*f+U*C+ne*$+ve*ie,s[6]=ge*v+U*I+ne*G+ve*he,s[7]=ge*b+U*R+ne*Z+ve*ze,s[8]=(ge=a[8])*c+(U=a[9])*w+(ne=a[10])*L+(ve=a[11])*K,s[9]=ge*f+U*C+ne*$+ve*ie,s[10]=ge*v+U*I+ne*G+ve*he,s[11]=ge*b+U*R+ne*Z+ve*ze,s[12]=(ge=a[12])*c+(U=a[13])*w+(ne=a[14])*L+(ve=a[15])*K,s[13]=ge*f+U*C+ne*$+ve*ie,s[14]=ge*v+U*I+ne*G+ve*he,s[15]=ge*b+U*R+ne*Z+ve*ze,s},m.M=function(s,n){const a={};for(let c=0;c<n.length;c++){const f=n[c];f in s&&(a[f]=s[f])}return a},m.N=Lo,m.O=f0,m.P=F,m.Q=p0,m.R=da,m.S=fa,m.T=hh,m.U=Se,m.V=pe,m.W=mt,m.X=Ne,m.Y=Nh,m.Z=zg,m._=o,m.a=en,m.a$=function(){return new Float64Array(16)},m.a0=s=>{const n=window.document.createElement("video");return n.muted=!0,new Promise(a=>{n.onloadstart=()=>{a(n)};for(const c of s){const f=window.document.createElement("source");An(c)||(n.crossOrigin="Anonymous"),f.src=c,n.appendChild(f)}})},m.a1=function(){return Zt++},m.a2=y,m.a3=Zc,m.a4=Tc,m.a5=Zs,m.a6=x0,m.a7=function(s){const n={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,c,f,v)=>{const b=f||v;return n[c]=!b||b.toLowerCase(),""}),n["max-age"]){const a=parseInt(n["max-age"],10);isNaN(a)?delete n["max-age"]:n["max-age"]=a}return n},m.a8=function(s){return Math.log(s)/Math.LN2},m.a9=function(s){var n=s[0],a=s[1];return n*n+a*a},m.aA=zi,m.aB=qf,m.aC=se,m.aD=Rt,m.aE=et,m.aF=85.051129,m.aG=function(s){return Math.pow(2,s)},m.aH=m0,m.aI=zt,m.aJ=It,m.aK=g0,m.aL=function(s,n,a){return s[0]=n[0]*a,s[1]=n[1]*a,s[2]=n[2]*a,s},m.aM=function(s,n,a){return s[0]=n[0]+a[0],s[1]=n[1]+a[1],s[2]=n[2]+a[2],s},m.aN=function(s){var n=new Ce(3);return n[0]=s[0],n[1]=s[1],n[2]=s[2],n},m.aO=function(s,n,a){return s[0]=n[0]*a[0],s[1]=n[1]*a[1],s[2]=n[2]*a[2],s[3]=n[3]*a[3],s},m.aP=function(s,n,a){return s[0]=n[0]-a[0],s[1]=n[1]-a[1],s[2]=n[2]-a[2],s},m.aQ=function(s,n){var a=n[0],c=n[1],f=n[2],v=a*a+c*c+f*f;return v>0&&(v=1/Math.sqrt(v)),s[0]=n[0]*v,s[1]=n[1]*v,s[2]=n[2]*v,s},m.aR=function(s,n,a){var c=n[0],f=n[1],v=n[2],b=a[0],w=a[1],C=a[2];return s[0]=f*C-v*w,s[1]=v*b-c*C,s[2]=c*w-f*b,s},m.aS=function(s,n){return s[0]*n[0]+s[1]*n[1]+s[2]*n[2]},m.aT=y0,m.aU=qc,m.aV=function(s,n,a,c,f){var v,b=1/Math.tan(n/2);return s[0]=b/a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=b,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,f!=null&&f!==1/0?(s[10]=(f+c)*(v=1/(c-f)),s[14]=2*f*c*v):(s[10]=-1,s[14]=-2*c),s},m.aW=function(s){var n=new Ce(16);return n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],n[4]=s[4],n[5]=s[5],n[6]=s[6],n[7]=s[7],n[8]=s[8],n[9]=s[9],n[10]=s[10],n[11]=s[11],n[12]=s[12],n[13]=s[13],n[14]=s[14],n[15]=s[15],n},m.aX=function(s,n,a){var c=Math.sin(a),f=Math.cos(a),v=n[0],b=n[1],w=n[2],C=n[3],I=n[4],R=n[5],L=n[6],$=n[7];return n!==s&&(s[8]=n[8],s[9]=n[9],s[10]=n[10],s[11]=n[11],s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15]),s[0]=v*f+I*c,s[1]=b*f+R*c,s[2]=w*f+L*c,s[3]=C*f+$*c,s[4]=I*f-v*c,s[5]=R*f-b*c,s[6]=L*f-w*c,s[7]=$*f-C*c,s},m.aY=function(s,n,a){var c=Math.sin(a),f=Math.cos(a),v=n[4],b=n[5],w=n[6],C=n[7],I=n[8],R=n[9],L=n[10],$=n[11];return n!==s&&(s[0]=n[0],s[1]=n[1],s[2]=n[2],s[3]=n[3],s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15]),s[4]=v*f+I*c,s[5]=b*f+R*c,s[6]=w*f+L*c,s[7]=C*f+$*c,s[8]=I*f-v*c,s[9]=R*f-b*c,s[10]=L*f-w*c,s[11]=$*f-C*c,s},m.aZ=function(){const s=new Float32Array(16);return Me(s),s},m.a_=function(){const s=new Float64Array(16);return Me(s),s},m.aa=function(s){return s*Math.PI/180},m.ab=Yt,m.ac=function(s,n){const a=[];for(const c in s)c in n||a.push(c);return a},m.ad=We,m.ae=function(s){return Math.hypot(s[0],s[1])},m.af=function(s){return s[0]=0,s[1]=0,s},m.ag=function(s,n,a){return s[0]=n[0]*a,s[1]=n[1]*a,s},m.ah=function(s,n){let a=0,c=0;if(s.kind==="constant")c=s.layoutSize;else if(s.kind!=="source"){const{interpolationType:f,minZoom:v,maxZoom:b}=s,w=f?Yt(Jn.interpolationFactor(f,n,v,b),0,1):0;s.kind==="camera"?c=ua.number(s.minSize,s.maxSize,w):a=w}return{uSizeT:a,uSize:c}},m.aj=function(s,{uSize:n,uSizeT:a},{lowerSize:c,upperSize:f}){return s.kind==="source"?c/ps:s.kind==="composite"?ua.number(c/ps,f/ps,a):n},m.ak=Ig,m.al=xe,m.am=function(s,n,a,c){const f=n.y-s.y,v=n.x-s.x,b=c.y-a.y,w=c.x-a.x,C=b*v-w*f;if(C===0)return null;const I=(w*(s.y-a.y)-b*(s.x-a.x))/C;return new F(s.x+I*v,s.y+I*f)},m.an=function(s,n){var a=n[0],c=n[1],f=n[2],v=n[3],b=n[4],w=n[5],C=n[6],I=n[7],R=n[8],L=n[9],$=n[10],G=n[11],Z=n[12],K=n[13],ie=n[14],he=n[15],ze=a*w-c*b,ge=a*C-f*b,U=a*I-v*b,ne=c*C-f*w,ve=c*I-v*w,He=f*I-v*C,dt=R*K-L*Z,Xe=R*ie-$*Z,nt=R*he-G*Z,yt=L*ie-$*K,pt=L*he-G*K,bt=$*he-G*ie,at=ze*bt-ge*pt+U*yt+ne*nt-ve*Xe+He*dt;return at?(s[0]=(w*bt-C*pt+I*yt)*(at=1/at),s[1]=(f*pt-c*bt-v*yt)*at,s[2]=(K*He-ie*ve+he*ne)*at,s[3]=($*ve-L*He-G*ne)*at,s[4]=(C*nt-b*bt-I*Xe)*at,s[5]=(a*bt-f*nt+v*Xe)*at,s[6]=(ie*U-Z*He-he*ge)*at,s[7]=(R*He-$*U+G*ge)*at,s[8]=(b*pt-w*nt+I*dt)*at,s[9]=(c*nt-a*pt-v*dt)*at,s[10]=(Z*ve-K*U+he*ze)*at,s[11]=(L*U-R*ve-G*ze)*at,s[12]=(w*Xe-b*yt-C*dt)*at,s[13]=(a*yt-c*Xe+f*dt)*at,s[14]=(K*ge-Z*ne-ie*ze)*at,s[15]=(R*ne-L*ge+$*ze)*at,s):null},m.ao=T0,m.ap=wh,m.aq=Me,m.ar=function(s){let n=1/0,a=1/0,c=-1/0,f=-1/0;for(const v of s)n=Math.min(n,v.x),a=Math.min(a,v.y),c=Math.max(c,v.x),f=Math.max(f,v.y);return[n,a,c,f]},m.as=Ki,m.at=tt,m.au=function(s,n,a,c,f=!1){if(!a[0]&&!a[1])return[0,0];const v=f?c==="map"?-s.bearingInRadians:0:c==="viewport"?s.bearingInRadians:0;if(v){const b=Math.sin(v),w=Math.cos(v);a=[a[0]*w-a[1]*b,a[0]*b+a[1]*w]}return[f?a[0]:tt(n,a[0],s.zoom),f?a[1]:tt(n,a[1],s.zoom)]},m.aw=kg,m.ax=Bg,m.ay=Pg,m.az=Fg,m.b=ot,m.b$=s=>s.type==="line",m.b0=function(s,n,a){const c=new Float64Array(4);return function(f,v,b,w){var C=.5*Math.PI/180;v*=C,b*=C,w*=C;var I=Math.sin(v),R=Math.cos(v),L=Math.sin(b),$=Math.cos(b),G=Math.sin(w),Z=Math.cos(w);f[0]=I*$*Z-R*L*G,f[1]=R*L*Z+I*$*G,f[2]=R*$*G-I*L*Z,f[3]=R*$*Z+I*L*G}(c,s,n-90,a),c},m.b1=function(s,n,a,c){var f,v,b,w,C,I=n[0],R=n[1],L=n[2],$=n[3],G=a[0],Z=a[1],K=a[2],ie=a[3];return(v=I*G+R*Z+L*K+$*ie)<0&&(v=-v,G=-G,Z=-Z,K=-K,ie=-ie),1-v>de?(f=Math.acos(v),b=Math.sin(f),w=Math.sin((1-c)*f)/b,C=Math.sin(c*f)/b):(w=1-c,C=c),s[0]=w*I+C*G,s[1]=w*R+C*Z,s[2]=w*L+C*K,s[3]=w*$+C*ie,s},m.b2=function(s){const n=new Float64Array(9);var a,c,f,v,b,w,C,I,R,L,$,G,Z,K,ie,he,ze,ge;L=(f=(c=s)[0])*(C=f+f),$=(v=c[1])*C,Z=(b=c[2])*C,K=b*(I=v+v),he=(w=c[3])*C,ze=w*I,ge=w*(R=b+b),(a=n)[0]=1-(G=v*I)-(ie=b*R),a[3]=$-ge,a[6]=Z+ze,a[1]=$+ge,a[4]=1-L-ie,a[7]=K-he,a[2]=Z-ze,a[5]=K+he,a[8]=1-L-G;const U=It(-Math.asin(Yt(n[2],-1,1)));let ne,ve;return Math.hypot(n[5],n[8])<.001?(ne=0,ve=-It(Math.atan2(n[3],n[4]))):(ne=It(n[5]===0&&n[8]===0?0:Math.atan2(n[5],n[8])),ve=It(n[1]===0&&n[0]===0?0:Math.atan2(n[1],n[0]))),{roll:ne,pitch:U+90,bearing:ve}},m.b3=function(s,n){return s.roll==n.roll&&s.pitch==n.pitch&&s.bearing==n.bearing},m.b4=Pn,m.b5=Xa,m.b6=Gc,m.b7=Rh,m.b8=Uc,m.b9=_t,m.bA=_n,m.bB=bn,m.bC=class extends Nr{constructor(s,n){super(s,n),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},m.bD=class extends Nr{constructor(s,n){super(s,n),this.current=Ro}set(s){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let n=1;n<16;n++)if(s[n]!==this.current[n]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}},m.bE=Il,m.bF=Ml,m.bG=class extends Nr{constructor(s,n){super(s,n),this.current=[0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2]))}},m.bH=class extends Nr{constructor(s,n){super(s,n),this.current=[0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1]))}},m.bI=ye,m.bJ=function(s,n){var a=Math.sin(n),c=Math.cos(n);return s[0]=c,s[1]=a,s[2]=0,s[3]=-a,s[4]=c,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},m.bK=function(s,n,a){var c=n[0],f=n[1],v=n[2];return s[0]=c*a[0]+f*a[3]+v*a[6],s[1]=c*a[1]+f*a[4]+v*a[7],s[2]=c*a[2]+f*a[5]+v*a[8],s},m.bL=function(s,n,a,c,f,v,b){var w=1/(n-a),C=1/(c-f),I=1/(v-b);return s[0]=-2*w,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*C,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*I,s[11]=0,s[12]=(n+a)*w,s[13]=(f+c)*C,s[14]=(b+v)*I,s[15]=1,s},m.bM=class extends _h{},m.bN=j2,m.bO=class extends ds{},m.bP=lg,m.bQ=function(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))},m.bR=bv,m.bS=function(s,n,a){var c=n[0],f=n[1],v=n[2],b=a[3]*c+a[7]*f+a[11]*v+a[15];return s[0]=(a[0]*c+a[4]*f+a[8]*v+a[12])/(b=b||1),s[1]=(a[1]*c+a[5]*f+a[9]*v+a[13])/b,s[2]=(a[2]*c+a[6]*f+a[10]*v+a[14])/b,s},m.bT=class extends ph{},m.bU=class extends r{},m.bV=function(s,n){return s[0]===n[0]&&s[1]===n[1]&&s[2]===n[2]&&s[3]===n[3]&&s[4]===n[4]&&s[5]===n[5]&&s[6]===n[6]&&s[7]===n[7]&&s[8]===n[8]&&s[9]===n[9]&&s[10]===n[10]&&s[11]===n[11]&&s[12]===n[12]&&s[13]===n[13]&&s[14]===n[14]&&s[15]===n[15]},m.bW=function(s,n){var a=s[0],c=s[1],f=s[2],v=s[3],b=s[4],w=s[5],C=s[6],I=s[7],R=s[8],L=s[9],$=s[10],G=s[11],Z=s[12],K=s[13],ie=s[14],he=s[15],ze=n[0],ge=n[1],U=n[2],ne=n[3],ve=n[4],He=n[5],dt=n[6],Xe=n[7],nt=n[8],yt=n[9],pt=n[10],bt=n[11],at=n[12],$t=n[13],Jt=n[14],Xt=n[15];return Math.abs(a-ze)<=de*Math.max(1,Math.abs(a),Math.abs(ze))&&Math.abs(c-ge)<=de*Math.max(1,Math.abs(c),Math.abs(ge))&&Math.abs(f-U)<=de*Math.max(1,Math.abs(f),Math.abs(U))&&Math.abs(v-ne)<=de*Math.max(1,Math.abs(v),Math.abs(ne))&&Math.abs(b-ve)<=de*Math.max(1,Math.abs(b),Math.abs(ve))&&Math.abs(w-He)<=de*Math.max(1,Math.abs(w),Math.abs(He))&&Math.abs(C-dt)<=de*Math.max(1,Math.abs(C),Math.abs(dt))&&Math.abs(I-Xe)<=de*Math.max(1,Math.abs(I),Math.abs(Xe))&&Math.abs(R-nt)<=de*Math.max(1,Math.abs(R),Math.abs(nt))&&Math.abs(L-yt)<=de*Math.max(1,Math.abs(L),Math.abs(yt))&&Math.abs($-pt)<=de*Math.max(1,Math.abs($),Math.abs(pt))&&Math.abs(G-bt)<=de*Math.max(1,Math.abs(G),Math.abs(bt))&&Math.abs(Z-at)<=de*Math.max(1,Math.abs(Z),Math.abs(at))&&Math.abs(K-$t)<=de*Math.max(1,Math.abs(K),Math.abs($t))&&Math.abs(ie-Jt)<=de*Math.max(1,Math.abs(ie),Math.abs(Jt))&&Math.abs(he-Xt)<=de*Math.max(1,Math.abs(he),Math.abs(Xt))},m.bX=function(s,n){return s[0]=n[0],s[1]=n[1],s[2]=n[2],s[3]=n[3],s[4]=n[4],s[5]=n[5],s[6]=n[6],s[7]=n[7],s[8]=n[8],s[9]=n[9],s[10]=n[10],s[11]=n[11],s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15],s},m.bY=s=>s.type==="symbol",m.bZ=s=>s.type==="circle",m.b_=s=>s.type==="heatmap",m.ba=Qe,m.bb=mr,m.bc=function(s,n,a,c,f){return _t(c,f,Yt((s-n)/(a-n),0,1))},m.bd=Mt,m.be=function(){return new Float64Array(4)},m.bf=function(){return new Float64Array(3)},m.bg=function(s,n,a,c){var f=[],v=[];return f[0]=n[0]-a[0],f[1]=n[1]-a[1],f[2]=n[2]-a[2],v[0]=f[0]*Math.cos(c)-f[1]*Math.sin(c),v[1]=f[0]*Math.sin(c)+f[1]*Math.cos(c),v[2]=f[2],s[0]=v[0]+a[0],s[1]=v[1]+a[1],s[2]=v[2]+a[2],s},m.bh=function(s,n,a,c){var f=[],v=[];return f[0]=n[0]-a[0],f[1]=n[1]-a[1],f[2]=n[2]-a[2],v[0]=f[0],v[1]=f[1]*Math.cos(c)-f[2]*Math.sin(c),v[2]=f[1]*Math.sin(c)+f[2]*Math.cos(c),s[0]=v[0]+a[0],s[1]=v[1]+a[1],s[2]=v[2]+a[2],s},m.bi=function(s,n,a,c){var f=[],v=[];return f[0]=n[0]-a[0],f[1]=n[1]-a[1],f[2]=n[2]-a[2],v[0]=f[2]*Math.sin(c)+f[0]*Math.cos(c),v[1]=f[1],v[2]=f[2]*Math.cos(c)-f[0]*Math.sin(c),s[0]=v[0]+a[0],s[1]=v[1]+a[1],s[2]=v[2]+a[2],s},m.bj=function(s,n,a){var c=Math.sin(a),f=Math.cos(a),v=n[0],b=n[1],w=n[2],C=n[3],I=n[8],R=n[9],L=n[10],$=n[11];return n!==s&&(s[4]=n[4],s[5]=n[5],s[6]=n[6],s[7]=n[7],s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15]),s[0]=v*f-I*c,s[1]=b*f-R*c,s[2]=w*f-L*c,s[3]=C*f-$*c,s[8]=v*c+I*f,s[9]=b*c+R*f,s[10]=w*c+L*f,s[11]=C*c+$*f,s},m.bk=function(s,n){const a=Mt(s,360),c=Mt(n,360),f=c-a,v=c>a?f-360:f+360;return Math.abs(f)<Math.abs(v)?f:v},m.bl=function(s){return s[0]=0,s[1]=0,s[2]=0,s},m.bm=function(s,n,a,c){const f=Math.sqrt(s*s+n*n),v=Math.sqrt(a*a+c*c);s/=f,n/=f,a/=v,c/=v;const b=Math.acos(s*a+n*c);return-n*a+s*c>0?b:-b},m.bn=function(s,n){return s[0]*n[0]+s[1]*n[1]+s[2]*n[2]+s[3]},m.bo=Rg,m.bp=function(s,n){const a=Mt(s,2*Math.PI),c=Mt(n,2*Math.PI);return Math.min(Math.abs(a-c),Math.abs(a-c+2*Math.PI),Math.abs(a-c-2*Math.PI))},m.bq=function(s){return Math.hypot(s[0],s[1],s[2])},m.br=function(){const s={},n=ae.$version;for(const a in ae.$root){const c=ae.$root[a];if(c.required){let f=null;f=a==="version"?n:c.type==="array"?[]:{},f!=null&&(s[a]=f)}}return s},m.bs=Mf,m.bt=Sn,m.bu=function(s){s=s.slice();const n=Object.create(null);for(let a=0;a<s.length;a++)n[s[a].id]=s[a];for(let a=0;a<s.length;a++)"ref"in s[a]&&(s[a]=J(s[a],n[s[a].ref]));return s},m.bv=function(s){if(s.type==="custom")return new hT(s);switch(s.type){case"background":return new lT(s);case"circle":return new i2(s);case"fill":return new w2(s);case"fill-extrusion":return new E2(s);case"heatmap":return new a2(s);case"hillshade":return new o2(s);case"line":return new O2(s);case"raster":return new uT(s);case"symbol":return new ep(s)}},m.bw=Vn,m.bx=function(s,n){if(!s)return[{command:"setStyle",args:[n]}];let a=[];try{if(!te(s.version,n.version))return[{command:"setStyle",args:[n]}];te(s.center,n.center)||a.push({command:"setCenter",args:[n.center]}),te(s.centerAltitude,n.centerAltitude)||a.push({command:"setCenterAltitude",args:[n.centerAltitude]}),te(s.zoom,n.zoom)||a.push({command:"setZoom",args:[n.zoom]}),te(s.bearing,n.bearing)||a.push({command:"setBearing",args:[n.bearing]}),te(s.pitch,n.pitch)||a.push({command:"setPitch",args:[n.pitch]}),te(s.roll,n.roll)||a.push({command:"setRoll",args:[n.roll]}),te(s.sprite,n.sprite)||a.push({command:"setSprite",args:[n.sprite]}),te(s.glyphs,n.glyphs)||a.push({command:"setGlyphs",args:[n.glyphs]}),te(s.transition,n.transition)||a.push({command:"setTransition",args:[n.transition]}),te(s.light,n.light)||a.push({command:"setLight",args:[n.light]}),te(s.terrain,n.terrain)||a.push({command:"setTerrain",args:[n.terrain]}),te(s.sky,n.sky)||a.push({command:"setSky",args:[n.sky]}),te(s.projection,n.projection)||a.push({command:"setProjection",args:[n.projection]});const c={},f=[];(function(b,w,C,I){let R;for(R in w=w||{},b=b||{})Object.prototype.hasOwnProperty.call(b,R)&&(Object.prototype.hasOwnProperty.call(w,R)||Ve(R,C,I));for(R in w)Object.prototype.hasOwnProperty.call(w,R)&&(Object.prototype.hasOwnProperty.call(b,R)?te(b[R],w[R])||(b[R].type==="geojson"&&w[R].type==="geojson"&&Oe(b,w,R)?me(C,{command:"setGeoJSONSourceData",args:[R,w[R].data]}):qe(R,w,C,I)):Ae(R,w,C))})(s.sources,n.sources,f,c);const v=[];s.layers&&s.layers.forEach(b=>{"source"in b&&c[b.source]?a.push({command:"removeLayer",args:[b.id]}):v.push(b)}),a=a.concat(f),function(b,w,C){w=w||[];const I=(b=b||[]).map(Je),R=w.map(Je),L=b.reduce(Ue,{}),$=w.reduce(Ue,{}),G=I.slice(),Z=Object.create(null);let K,ie,he,ze,ge;for(let U=0,ne=0;U<I.length;U++)K=I[U],Object.prototype.hasOwnProperty.call($,K)?ne++:(me(C,{command:"removeLayer",args:[K]}),G.splice(G.indexOf(K,ne),1));for(let U=0,ne=0;U<R.length;U++)K=R[R.length-1-U],G[G.length-1-U]!==K&&(Object.prototype.hasOwnProperty.call(L,K)?(me(C,{command:"removeLayer",args:[K]}),G.splice(G.lastIndexOf(K,G.length-ne),1)):ne++,ze=G[G.length-U],me(C,{command:"addLayer",args:[$[K],ze]}),G.splice(G.length-U,0,K),Z[K]=!0);for(let U=0;U<R.length;U++)if(K=R[U],ie=L[K],he=$[K],!Z[K]&&!te(ie,he))if(te(ie.source,he.source)&&te(ie["source-layer"],he["source-layer"])&&te(ie.type,he.type)){for(ge in it(ie.layout,he.layout,C,K,null,"setLayoutProperty"),it(ie.paint,he.paint,C,K,null,"setPaintProperty"),te(ie.filter,he.filter)||me(C,{command:"setFilter",args:[K,he.filter]}),te(ie.minzoom,he.minzoom)&&te(ie.maxzoom,he.maxzoom)||me(C,{command:"setLayerZoomRange",args:[K,he.minzoom,he.maxzoom]}),ie)Object.prototype.hasOwnProperty.call(ie,ge)&&ge!=="layout"&&ge!=="paint"&&ge!=="filter"&&ge!=="metadata"&&ge!=="minzoom"&&ge!=="maxzoom"&&(ge.indexOf("paint.")===0?it(ie[ge],he[ge],C,K,ge.slice(6),"setPaintProperty"):te(ie[ge],he[ge])||me(C,{command:"setLayerProperty",args:[K,ge,he[ge]]}));for(ge in he)Object.prototype.hasOwnProperty.call(he,ge)&&!Object.prototype.hasOwnProperty.call(ie,ge)&&ge!=="layout"&&ge!=="paint"&&ge!=="filter"&&ge!=="metadata"&&ge!=="minzoom"&&ge!=="maxzoom"&&(ge.indexOf("paint.")===0?it(ie[ge],he[ge],C,K,ge.slice(6),"setPaintProperty"):te(ie[ge],he[ge])||me(C,{command:"setLayerProperty",args:[K,ge,he[ge]]}))}else me(C,{command:"removeLayer",args:[K]}),ze=G[G.lastIndexOf(K)+1],me(C,{command:"addLayer",args:[he,ze]})}(v,n.layers,a)}catch(c){console.warn("Unable to compute style diff:",c),a=[{command:"setStyle",args:[n]}]}return a},m.by=function(s){const n=[],a=s.id;return a===void 0&&n.push({message:`layers.${a}: missing required property "id"`}),s.render===void 0&&n.push({message:`layers.${a}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&n.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),n},m.bz=function s(n,a){if(Array.isArray(n)){if(!Array.isArray(a)||n.length!==a.length)return!1;for(let c=0;c<n.length;c++)if(!s(n[c],a[c]))return!1;return!0}if(typeof n=="object"&&n!==null&&a!==null){if(typeof a!="object"||Object.keys(n).length!==Object.keys(a).length)return!1;for(const c in n)if(!s(n[c],a[c]))return!1;return!0}return n===a},m.c=wt,m.c0=s=>s.type==="fill",m.c1=s=>s.type==="fill-extrusion",m.c2=s=>s.type==="hillshade",m.c3=s=>s.type==="raster",m.c4=s=>s.type==="background",m.c5=s=>s.type==="custom",m.c6=ct,m.c7=function(s,n,a){const c=ht(n.x-a.x,n.y-a.y),f=ht(s.x-a.x,s.y-a.y);var v,b;return It(Math.atan2(c[0]*f[1]-c[1]*f[0],(v=c)[0]*(b=f)[0]+v[1]*b[1]))},m.c8=Dt,m.c9=function(s,n,a){var c=n[0],f=n[1];return s[0]=a[0]*c+a[4]*f+a[12],s[1]=a[1]*c+a[5]*f+a[13],s},m.cA=Xv,m.cB=xc,m.cC=Za,m.ca=function(s,n){const{x:a,y:c}=Nh.fromLngLat(n);return!(s<0||s>25||c<0||c>=1||a<0||a>=1)},m.cb=function(s,n){return s[0]=n[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=n[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=n[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},m.cc=class extends Cl{},m.cd=xT,m.cf=function(s){return s.message===At},m.cg=un,m.ch=function(s,n){en.REGISTERED_PROTOCOLS[s]=n},m.ci=function(s){delete en.REGISTERED_PROTOCOLS[s]},m.cj=function(s,n){const a={};for(let f=0;f<s.length;f++){const v=n&&n[s[f].id]||rh(s[f]);n&&(n[s[f].id]=v);let b=a[v];b||(b=a[v]=[]),b.push(s[f])}const c=[];for(const f in a)c.push(a[f]);return c},m.ck=Bt,m.cl=b0,m.cm=w0,m.cn=Yv,m.co=function(s){s.bucket.createArrays(),s.bucket.tilePixelRatio=Ne/(512*s.bucket.overscaling),s.bucket.compareText={},s.bucket.iconsNeedLinear=!1;const n=s.bucket.layers[0],a=n.layout,c=n._unevaluatedLayout._values,f={layoutIconSize:c["icon-size"].possiblyEvaluate(new fi(s.bucket.zoom+1),s.canonical),layoutTextSize:c["text-size"].possiblyEvaluate(new fi(s.bucket.zoom+1),s.canonical),textMaxSize:c["text-size"].possiblyEvaluate(new fi(18))};if(s.bucket.textSizeData.kind==="composite"){const{minZoom:I,maxZoom:R}=s.bucket.textSizeData;f.compositeTextSizes=[c["text-size"].possiblyEvaluate(new fi(I),s.canonical),c["text-size"].possiblyEvaluate(new fi(R),s.canonical)]}if(s.bucket.iconSizeData.kind==="composite"){const{minZoom:I,maxZoom:R}=s.bucket.iconSizeData;f.compositeIconSizes=[c["icon-size"].possiblyEvaluate(new fi(I),s.canonical),c["icon-size"].possiblyEvaluate(new fi(R),s.canonical)]}const v=a.get("text-line-height")*Ki,b=a.get("text-rotation-alignment")!=="viewport"&&a.get("symbol-placement")!=="point",w=a.get("text-keep-upright"),C=a.get("text-size");for(const I of s.bucket.features){const R=a.get("text-font").evaluate(I,{},s.canonical).join(","),L=C.evaluate(I,{},s.canonical),$=f.layoutTextSize.evaluate(I,{},s.canonical),G=f.layoutIconSize.evaluate(I,{},s.canonical),Z={horizontal:{},vertical:void 0},K=I.text;let ie,he=[0,0];if(K){const U=K.toString(),ne=a.get("text-letter-spacing").evaluate(I,{},s.canonical)*Ki,ve=Ef(U)?ne:0,He=a.get("text-anchor").evaluate(I,{},s.canonical),dt=z0(n,I,s.canonical);if(!dt){const pt=a.get("text-radial-offset").evaluate(I,{},s.canonical);he=pt?D0(He,[pt*Ki,Lg]):a.get("text-offset").evaluate(I,{},s.canonical).map(bt=>bt*Ki)}let Xe=b?"center":a.get("text-justify").evaluate(I,{},s.canonical);const nt=a.get("symbol-placement")==="point"?a.get("text-max-width").evaluate(I,{},s.canonical)*Ki:1/0,yt=()=>{s.bucket.allowVerticalPlacement&&Io(U)&&(Z.vertical=Yf(K,s.glyphMap,s.glyphPositions,s.imagePositions,R,nt,v,He,"left",ve,he,m.ai.vertical,!0,$,L))};if(!b&&dt){const pt=new Set;if(Xe==="auto")for(let at=0;at<dt.values.length;at+=2)pt.add(Bg(dt.values[at]));else pt.add(Xe);let bt=!1;for(const at of pt)if(!Z.horizontal[at])if(bt)Z.horizontal[at]=Z.horizontal[0];else{const $t=Yf(K,s.glyphMap,s.glyphPositions,s.imagePositions,R,nt,v,"center",at,ve,he,m.ai.horizontal,!1,$,L);$t&&(Z.horizontal[at]=$t,bt=$t.positionedLines.length===1)}yt()}else{Xe==="auto"&&(Xe=Bg(He));const pt=Yf(K,s.glyphMap,s.glyphPositions,s.imagePositions,R,nt,v,He,Xe,ve,he,m.ai.horizontal,!1,$,L);pt&&(Z.horizontal[Xe]=pt),yt(),Io(U)&&b&&w&&(Z.vertical=Yf(K,s.glyphMap,s.glyphPositions,s.imagePositions,R,nt,v,He,Xe,ve,he,m.ai.vertical,!1,$,L))}}let ze=!1;if(I.icon&&I.icon.name){const U=s.imageMap[I.icon.name];U&&(ie=iT(s.imagePositions[I.icon.name],a.get("icon-offset").evaluate(I,{},s.canonical),a.get("icon-anchor").evaluate(I,{},s.canonical)),ze=!!U.sdf,s.bucket.sdfIcons===void 0?s.bucket.sdfIcons=ze:s.bucket.sdfIcons!==ze&&ri("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(U.pixelRatio!==s.bucket.pixelRatio||a.get("icon-rotate").constantOr(1)!==0)&&(s.bucket.iconsNeedLinear=!0))}const ge=B0(Z.horizontal)||Z.vertical;s.bucket.iconsInText=!!ge&&ge.iconsInText,(ge||ie)&&vT(s.bucket,I,Z,ie,s.imageMap,f,$,G,he,ze,s.canonical,s.subdivisionGranularity)}s.showCollisionBoxes&&s.bucket.generateCollisionDebugBuffers()},m.cp=vg,m.cq=fg,m.cr=yg,m.cs=zh,m.ct=wg,m.cu=class{constructor(s){this._marks={start:[s.url,"start"].join("#"),end:[s.url,"end"].join("#"),measure:s.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let s=performance.getEntriesByName(this._marks.measure);return s.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),s=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),s}},m.cv=function(s,n,a,c,f){return o(this,void 0,void 0,function*(){if(pe())try{return yield mt(s,n,a,c,f)}catch{}return function(v,b,w,C,I){const R=v.width,L=v.height;vt&&Lt||(vt=new OffscreenCanvas(R,L),Lt=vt.getContext("2d",{willReadFrequently:!0})),vt.width=R,vt.height=L,Lt.drawImage(v,0,0,R,L);const $=Lt.getImageData(b,w,C,I);return Lt.clearRect(0,0,R,L),$.data}(s,n,a,c,f)})},m.cw=v0,m.cx=T,m.cy=D,m.cz=Fv,m.d=s=>o(void 0,void 0,void 0,function*(){if(s.byteLength===0)return createImageBitmap(new ImageData(1,1));const n=new Blob([new Uint8Array(s)],{type:"image/png"});try{return createImageBitmap(n)}catch(a){throw new Error(`Could not load image because of ${a.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),m.e=Kt,m.f=s=>new Promise((n,a)=>{const c=new Image;c.onload=()=>{n(c),URL.revokeObjectURL(c.src),c.onload=null,window.requestAnimationFrame(()=>{c.src=xt})},c.onerror=()=>a(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const f=new Blob([new Uint8Array(s)],{type:"image/png"});c.src=s.byteLength?URL.createObjectURL(f):xt}),m.g=Nt,m.h=(s,n)=>Dn(Kt(s,{type:"json"}),n),m.i=Pe,m.j=Zi,m.k=er,m.l=(s,n)=>Dn(Kt(s,{type:"arrayBuffer"}),n),m.m=Dn,m.n=function(s){return new wg(s).readFields(H2,[])},m.o=kh,m.p=Kv,m.q=Er,m.r=tg,m.s=An,m.t=Pf,m.u=ko,m.v=ae,m.w=ri,m.x=function([s,n,a]){return n+=90,n*=Math.PI/180,a*=Math.PI/180,{x:s*Math.cos(n)*Math.sin(a),y:s*Math.sin(n)*Math.sin(a),z:s*Math.cos(a)}},m.y=ua,m.z=fi}),p("worker",["./shared"],function(m){class o{constructor(W){this.keyCache={},W&&this.replace(W)}replace(W){this._layerConfigs={},this._layers={},this.update(W,[])}update(W,J){for(const me of W){this._layerConfigs[me.id]=me;const Ae=this._layers[me.id]=m.bv(me);Ae._featureFilter=m.a4(Ae.filter),this.keyCache[me.id]&&delete this.keyCache[me.id]}for(const me of J)delete this.keyCache[me],delete this._layerConfigs[me],delete this._layers[me];this.familiesBySource={};const te=m.cj(Object.values(this._layerConfigs),this.keyCache);for(const me of te){const Ae=me.map(Ue=>this._layers[Ue.id]),Ve=Ae[0];if(Ve.visibility==="none")continue;const qe=Ve.source||"";let Oe=this.familiesBySource[qe];Oe||(Oe=this.familiesBySource[qe]={});const it=Ve.sourceLayer||"_geojsonTileLayer";let Je=Oe[it];Je||(Je=Oe[it]=[]),Je.push(Ae)}}}class T{constructor(W){const J={},te=[];for(const qe in W){const Oe=W[qe],it=J[qe]={};for(const Je in Oe){const Ue=Oe[+Je];if(!Ue||Ue.bitmap.width===0||Ue.bitmap.height===0)continue;const Be={x:0,y:0,w:Ue.bitmap.width+2,h:Ue.bitmap.height+2};te.push(Be),it[Je]={rect:Be,metrics:Ue.metrics}}}const{w:me,h:Ae}=m.p(te),Ve=new m.o({width:me||1,height:Ae||1});for(const qe in W){const Oe=W[qe];for(const it in Oe){const Je=Oe[+it];if(!Je||Je.bitmap.width===0||Je.bitmap.height===0)continue;const Ue=J[qe][it].rect;m.o.copy(Je.bitmap,Ve,{x:0,y:0},{x:Ue.x+1,y:Ue.y+1},Je.bitmap)}}this.image=Ve,this.positions=J}}m.ck("GlyphAtlas",T);class k{constructor(W){this.tileID=new m.S(W.tileID.overscaledZ,W.tileID.wrap,W.tileID.canonical.z,W.tileID.canonical.x,W.tileID.canonical.y),this.uid=W.uid,this.zoom=W.zoom,this.pixelRatio=W.pixelRatio,this.tileSize=W.tileSize,this.source=W.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=W.showCollisionBoxes,this.collectResourceTiming=!!W.collectResourceTiming,this.returnDependencies=!!W.returnDependencies,this.promoteId=W.promoteId,this.inFlightDependencies=[]}parse(W,J,te,me,Ae){return m._(this,void 0,void 0,function*(){this.status="parsing",this.data=W,this.collisionBoxArray=new m.a2;const Ve=new m.cl(Object.keys(W.layers).sort()),qe=new m.cm(this.tileID,this.promoteId);qe.bucketLayerIDs=[];const Oe={},it={featureIndex:qe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:te,subdivisionGranularity:Ae},Je=J.familiesBySource[this.source];for(const on in Je){const Ot=W.layers[on];if(!Ot)continue;Ot.version===1&&m.w(`Vector tile source "${this.source}" layer "${on}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ki=Ve.encode(on),os=[];for(let qi=0;qi<Ot.length;qi++){const Vi=Ot.feature(qi),ui=qe.getId(Vi,on);os.push({feature:Vi,id:ui,index:qi,sourceLayerIndex:ki})}for(const qi of Je[on]){const Vi=qi[0];Vi.source!==this.source&&m.w(`layer.source = ${Vi.source} does not equal this.source = ${this.source}`),Vi.minzoom&&this.zoom<Math.floor(Vi.minzoom)||Vi.maxzoom&&this.zoom>=Vi.maxzoom||Vi.visibility!=="none"&&(M(qi,this.zoom,te),(Oe[Vi.id]=Vi.createBucket({index:qe.bucketLayerIDs.length,layers:qi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ki,sourceID:this.source})).populate(os,it,this.tileID.canonical),qe.bucketLayerIDs.push(qi.map(ui=>ui.id)))}}const Ue=m.bA(it.glyphDependencies,on=>Object.keys(on).map(Number));this.inFlightDependencies.forEach(on=>on==null?void 0:on.abort()),this.inFlightDependencies=[];let Be=Promise.resolve({});if(Object.keys(Ue).length){const on=new AbortController;this.inFlightDependencies.push(on),Be=me.sendAsync({type:"GG",data:{stacks:Ue,source:this.source,tileID:this.tileID,type:"glyphs"}},on)}const kt=Object.keys(it.iconDependencies);let Tt=Promise.resolve({});if(kt.length){const on=new AbortController;this.inFlightDependencies.push(on),Tt=me.sendAsync({type:"GI",data:{icons:kt,source:this.source,tileID:this.tileID,type:"icons"}},on)}const tn=Object.keys(it.patternDependencies);let pn=Promise.resolve({});if(tn.length){const on=new AbortController;this.inFlightDependencies.push(on),pn=me.sendAsync({type:"GI",data:{icons:tn,source:this.source,tileID:this.tileID,type:"patterns"}},on)}const[st,Et,jt]=yield Promise.all([Be,Tt,pn]),Cn=new T(st),zn=new m.cn(Et,jt);for(const on in Oe){const Ot=Oe[on];Ot instanceof m.a3?(M(Ot.layers,this.zoom,te),m.co({bucket:Ot,glyphMap:st,glyphPositions:Cn.positions,imageMap:Et,imagePositions:zn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:it.subdivisionGranularity})):Ot.hasPattern&&(Ot instanceof m.cp||Ot instanceof m.cq||Ot instanceof m.cr)&&(M(Ot.layers,this.zoom,te),Ot.addFeatures(it,this.tileID.canonical,zn.patternPositions))}return this.status="done",{buckets:Object.values(Oe).filter(on=>!on.isEmpty()),featureIndex:qe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Cn.image,imageAtlas:zn,glyphMap:this.returnDependencies?st:null,iconMap:this.returnDependencies?Et:null,glyphPositions:this.returnDependencies?Cn.positions:null}})}}function M(ae,W,J){const te=new m.z(W);for(const me of ae)me.recalculate(te,J)}class D{constructor(W,J,te){this.actor=W,this.layerIndex=J,this.availableImages=te,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(W,J){return m._(this,void 0,void 0,function*(){const te=yield m.l(W.request,J);try{return{vectorTile:new m.cs.VectorTile(new m.ct(te.data)),rawData:te.data,cacheControl:te.cacheControl,expires:te.expires}}catch(me){const Ae=new Uint8Array(te.data);let Ve=`Unable to parse the tile at ${W.request.url}, `;throw Ve+=Ae[0]===31&&Ae[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${me.message}`,new Error(Ve)}})}loadTile(W){return m._(this,void 0,void 0,function*(){const J=W.uid,te=!!(W&&W.request&&W.request.collectResourceTiming)&&new m.cu(W.request),me=new k(W);this.loading[J]=me;const Ae=new AbortController;me.abort=Ae;try{const Ve=yield this.loadVectorTile(W,Ae);if(delete this.loading[J],!Ve)return null;const qe=Ve.rawData,Oe={};Ve.expires&&(Oe.expires=Ve.expires),Ve.cacheControl&&(Oe.cacheControl=Ve.cacheControl);const it={};if(te){const Ue=te.finish();Ue&&(it.resourceTiming=JSON.parse(JSON.stringify(Ue)))}me.vectorTile=Ve.vectorTile;const Je=me.parse(Ve.vectorTile,this.layerIndex,this.availableImages,this.actor,W.subdivisionGranularity);this.loaded[J]=me,this.fetching[J]={rawTileData:qe,cacheControl:Oe,resourceTiming:it};try{const Ue=yield Je;return m.e({rawTileData:qe.slice(0)},Ue,Oe,it)}finally{delete this.fetching[J]}}catch(Ve){throw delete this.loading[J],me.status="done",this.loaded[J]=me,Ve}})}reloadTile(W){return m._(this,void 0,void 0,function*(){const J=W.uid;if(!this.loaded||!this.loaded[J])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const te=this.loaded[J];if(te.showCollisionBoxes=W.showCollisionBoxes,te.status==="parsing"){const me=yield te.parse(te.vectorTile,this.layerIndex,this.availableImages,this.actor,W.subdivisionGranularity);let Ae;if(this.fetching[J]){const{rawTileData:Ve,cacheControl:qe,resourceTiming:Oe}=this.fetching[J];delete this.fetching[J],Ae=m.e({rawTileData:Ve.slice(0)},me,qe,Oe)}else Ae=me;return Ae}if(te.status==="done"&&te.vectorTile)return te.parse(te.vectorTile,this.layerIndex,this.availableImages,this.actor,W.subdivisionGranularity)})}abortTile(W){return m._(this,void 0,void 0,function*(){const J=this.loading,te=W.uid;J&&J[te]&&J[te].abort&&(J[te].abort.abort(),delete J[te])})}removeTile(W){return m._(this,void 0,void 0,function*(){this.loaded&&this.loaded[W.uid]&&delete this.loaded[W.uid]})}}class O{constructor(){this.loaded={}}loadTile(W){return m._(this,void 0,void 0,function*(){const{uid:J,encoding:te,rawImageData:me,redFactor:Ae,greenFactor:Ve,blueFactor:qe,baseShift:Oe}=W,it=me.width+2,Je=me.height+2,Ue=m.b(me)?new m.R({width:it,height:Je},yield m.cv(me,-1,-1,it,Je)):me,Be=new m.cw(J,Ue,te,Ae,Ve,qe,Oe);return this.loaded=this.loaded||{},this.loaded[J]=Be,Be})}removeTile(W){const J=this.loaded,te=W.uid;J&&J[te]&&delete J[te]}}var z,F,N=function(){if(F)return z;function ae(J,te){if(J.length!==0){W(J[0],te);for(var me=1;me<J.length;me++)W(J[me],!te)}}function W(J,te){for(var me=0,Ae=0,Ve=0,qe=J.length,Oe=qe-1;Ve<qe;Oe=Ve++){var it=(J[Ve][0]-J[Oe][0])*(J[Oe][1]+J[Ve][1]),Je=me+it;Ae+=Math.abs(me)>=Math.abs(it)?me-Je+it:it-Je+me,me=Je}me+Ae>=0!=!!te&&J.reverse()}return F=1,z=function J(te,me){var Ae,Ve=te&&te.type;if(Ve==="FeatureCollection")for(Ae=0;Ae<te.features.length;Ae++)J(te.features[Ae],me);else if(Ve==="GeometryCollection")for(Ae=0;Ae<te.geometries.length;Ae++)J(te.geometries[Ae],me);else if(Ve==="Feature")J(te.geometry,me);else if(Ve==="Polygon")ae(te.coordinates,me);else if(Ve==="MultiPolygon")for(Ae=0;Ae<te.coordinates.length;Ae++)ae(te.coordinates[Ae],me);return te}}(),q=m.cx(N);const oe=m.cs.VectorTileFeature.prototype.toGeoJSON;class _e{constructor(W){this._feature=W,this.extent=m.X,this.type=W.type,this.properties=W.tags,"id"in W&&!isNaN(W.id)&&(this.id=parseInt(W.id,10))}loadGeometry(){if(this._feature.type===1){const W=[];for(const J of this._feature.geometry)W.push([new m.P(J[0],J[1])]);return W}{const W=[];for(const J of this._feature.geometry){const te=[];for(const me of J)te.push(new m.P(me[0],me[1]));W.push(te)}return W}}toGeoJSON(W,J,te){return oe.call(this,W,J,te)}}class Se{constructor(W){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=m.X,this.length=W.length,this._features=W}feature(W){return new _e(this._features[W])}}var pe,be,de,Ce={exports:{}},ye=function(){if(de)return Ce.exports;de=1;var ae=m.cA(),W=function(){if(be)return pe;be=1;var Je=m.cy(),Ue=m.cz().VectorTileFeature;function Be(Tt,tn){this.options=tn||{},this.features=Tt,this.length=Tt.length}function kt(Tt,tn){this.id=typeof Tt.id=="number"?Tt.id:void 0,this.type=Tt.type,this.rawGeometry=Tt.type===1?[Tt.geometry]:Tt.geometry,this.properties=Tt.tags,this.extent=tn||4096}return pe=Be,Be.prototype.feature=function(Tt){return new kt(this.features[Tt],this.options.extent)},kt.prototype.loadGeometry=function(){var Tt=this.rawGeometry;this.geometry=[];for(var tn=0;tn<Tt.length;tn++){for(var pn=Tt[tn],st=[],Et=0;Et<pn.length;Et++)st.push(new Je(pn[Et][0],pn[Et][1]));this.geometry.push(st)}return this.geometry},kt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Tt=this.geometry,tn=1/0,pn=-1/0,st=1/0,Et=-1/0,jt=0;jt<Tt.length;jt++)for(var Cn=Tt[jt],zn=0;zn<Cn.length;zn++){var on=Cn[zn];tn=Math.min(tn,on.x),pn=Math.max(pn,on.x),st=Math.min(st,on.y),Et=Math.max(Et,on.y)}return[tn,st,pn,Et]},kt.prototype.toGeoJSON=Ue.prototype.toGeoJSON,pe}();function J(Je){var Ue=new ae;return function(Be,kt){for(var Tt in Be.layers)kt.writeMessage(3,te,Be.layers[Tt])}(Je,Ue),Ue.finish()}function te(Je,Ue){var Be;Ue.writeVarintField(15,Je.version||1),Ue.writeStringField(1,Je.name||""),Ue.writeVarintField(5,Je.extent||4096);var kt={keys:[],values:[],keycache:{},valuecache:{}};for(Be=0;Be<Je.length;Be++)kt.feature=Je.feature(Be),Ue.writeMessage(2,me,kt);var Tt=kt.keys;for(Be=0;Be<Tt.length;Be++)Ue.writeStringField(3,Tt[Be]);var tn=kt.values;for(Be=0;Be<tn.length;Be++)Ue.writeMessage(4,it,tn[Be])}function me(Je,Ue){var Be=Je.feature;Be.id!==void 0&&Ue.writeVarintField(1,Be.id),Ue.writeMessage(2,Ae,Je),Ue.writeVarintField(3,Be.type),Ue.writeMessage(4,Oe,Be)}function Ae(Je,Ue){var Be=Je.feature,kt=Je.keys,Tt=Je.values,tn=Je.keycache,pn=Je.valuecache;for(var st in Be.properties){var Et=Be.properties[st],jt=tn[st];if(Et!==null){jt===void 0&&(kt.push(st),tn[st]=jt=kt.length-1),Ue.writeVarint(jt);var Cn=typeof Et;Cn!=="string"&&Cn!=="boolean"&&Cn!=="number"&&(Et=JSON.stringify(Et));var zn=Cn+":"+Et,on=pn[zn];on===void 0&&(Tt.push(Et),pn[zn]=on=Tt.length-1),Ue.writeVarint(on)}}}function Ve(Je,Ue){return(Ue<<3)+(7&Je)}function qe(Je){return Je<<1^Je>>31}function Oe(Je,Ue){for(var Be=Je.loadGeometry(),kt=Je.type,Tt=0,tn=0,pn=Be.length,st=0;st<pn;st++){var Et=Be[st],jt=1;kt===1&&(jt=Et.length),Ue.writeVarint(Ve(1,jt));for(var Cn=kt===3?Et.length-1:Et.length,zn=0;zn<Cn;zn++){zn===1&&kt!==1&&Ue.writeVarint(Ve(2,Cn-1));var on=Et[zn].x-Tt,Ot=Et[zn].y-tn;Ue.writeVarint(qe(on)),Ue.writeVarint(qe(Ot)),Tt+=on,tn+=Ot}kt===3&&Ue.writeVarint(Ve(7,1))}}function it(Je,Ue){var Be=typeof Je;Be==="string"?Ue.writeStringField(1,Je):Be==="boolean"?Ue.writeBooleanField(7,Je):Be==="number"&&(Je%1!=0?Ue.writeDoubleField(3,Je):Je<0?Ue.writeSVarintField(6,Je):Ue.writeVarintField(5,Je))}return Ce.exports=J,Ce.exports.fromVectorTileJs=J,Ce.exports.fromGeojsonVt=function(Je,Ue){Ue=Ue||{};var Be={};for(var kt in Je)Be[kt]=new W(Je[kt].features,Ue),Be[kt].name=kt,Be[kt].version=Ue.version,Be[kt].extent=Ue.extent;return J({layers:Be})},Ce.exports.GeoJSONWrapper=W,Ce.exports}(),Me=m.cx(ye);const ke={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ae=>ae},Ee=Math.fround||(xe=new Float32Array(1),ae=>(xe[0]=+ae,xe[0]));var xe;const Fe=3,We=5,ht=6;class Ne{constructor(W){this.options=Object.assign(Object.create(ke),W),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(W){const{log:J,minZoom:te,maxZoom:me}=this.options;J&&console.time("total time");const Ae=`prepare ${W.length} points`;J&&console.time(Ae),this.points=W;const Ve=[];for(let Oe=0;Oe<W.length;Oe++){const it=W[Oe];if(!it.geometry)continue;const[Je,Ue]=it.geometry.coordinates,Be=Ee(_t(Je)),kt=Ee(Qe(Ue));Ve.push(Be,kt,1/0,Oe,-1,1),this.options.reduce&&Ve.push(0)}let qe=this.trees[me+1]=this._createTree(Ve);J&&console.timeEnd(Ae);for(let Oe=me;Oe>=te;Oe--){const it=+Date.now();qe=this.trees[Oe]=this._createTree(this._cluster(qe,Oe)),J&&console.log("z%d: %d clusters in %dms",Oe,qe.numItems,+Date.now()-it)}return J&&console.timeEnd("total time"),this}getClusters(W,J){let te=((W[0]+180)%360+360)%360-180;const me=Math.max(-90,Math.min(90,W[1]));let Ae=W[2]===180?180:((W[2]+180)%360+360)%360-180;const Ve=Math.max(-90,Math.min(90,W[3]));if(W[2]-W[0]>=360)te=-180,Ae=180;else if(te>Ae){const Ue=this.getClusters([te,me,180,Ve],J),Be=this.getClusters([-180,me,Ae,Ve],J);return Ue.concat(Be)}const qe=this.trees[this._limitZoom(J)],Oe=qe.range(_t(te),Qe(Ve),_t(Ae),Qe(me)),it=qe.data,Je=[];for(const Ue of Oe){const Be=this.stride*Ue;Je.push(it[Be+We]>1?tt(it,Be,this.clusterProps):this.points[it[Be+Fe]])}return Je}getChildren(W){const J=this._getOriginId(W),te=this._getOriginZoom(W),me="No cluster with the specified id.",Ae=this.trees[te];if(!Ae)throw new Error(me);const Ve=Ae.data;if(J*this.stride>=Ve.length)throw new Error(me);const qe=this.options.radius/(this.options.extent*Math.pow(2,te-1)),Oe=Ae.within(Ve[J*this.stride],Ve[J*this.stride+1],qe),it=[];for(const Je of Oe){const Ue=Je*this.stride;Ve[Ue+4]===W&&it.push(Ve[Ue+We]>1?tt(Ve,Ue,this.clusterProps):this.points[Ve[Ue+Fe]])}if(it.length===0)throw new Error(me);return it}getLeaves(W,J,te){const me=[];return this._appendLeaves(me,W,J=J||10,te=te||0,0),me}getTile(W,J,te){const me=this.trees[this._limitZoom(W)],Ae=Math.pow(2,W),{extent:Ve,radius:qe}=this.options,Oe=qe/Ve,it=(te-Oe)/Ae,Je=(te+1+Oe)/Ae,Ue={features:[]};return this._addTileFeatures(me.range((J-Oe)/Ae,it,(J+1+Oe)/Ae,Je),me.data,J,te,Ae,Ue),J===0&&this._addTileFeatures(me.range(1-Oe/Ae,it,1,Je),me.data,Ae,te,Ae,Ue),J===Ae-1&&this._addTileFeatures(me.range(0,it,Oe/Ae,Je),me.data,-1,te,Ae,Ue),Ue.features.length?Ue:null}getClusterExpansionZoom(W){let J=this._getOriginZoom(W)-1;for(;J<=this.options.maxZoom;){const te=this.getChildren(W);if(J++,te.length!==1)break;W=te[0].properties.cluster_id}return J}_appendLeaves(W,J,te,me,Ae){const Ve=this.getChildren(J);for(const qe of Ve){const Oe=qe.properties;if(Oe&&Oe.cluster?Ae+Oe.point_count<=me?Ae+=Oe.point_count:Ae=this._appendLeaves(W,Oe.cluster_id,te,me,Ae):Ae<me?Ae++:W.push(qe),W.length===te)break}return Ae}_createTree(W){const J=new m.az(W.length/this.stride|0,this.options.nodeSize,Float32Array);for(let te=0;te<W.length;te+=this.stride)J.add(W[te],W[te+1]);return J.finish(),J.data=W,J}_addTileFeatures(W,J,te,me,Ae,Ve){for(const qe of W){const Oe=qe*this.stride,it=J[Oe+We]>1;let Je,Ue,Be;if(it)Je=Mt(J,Oe,this.clusterProps),Ue=J[Oe],Be=J[Oe+1];else{const tn=this.points[J[Oe+Fe]];Je=tn.properties;const[pn,st]=tn.geometry.coordinates;Ue=_t(pn),Be=Qe(st)}const kt={type:1,geometry:[[Math.round(this.options.extent*(Ue*Ae-te)),Math.round(this.options.extent*(Be*Ae-me))]],tags:Je};let Tt;Tt=it||this.options.generateId?J[Oe+Fe]:this.points[J[Oe+Fe]].id,Tt!==void 0&&(kt.id=Tt),Ve.features.push(kt)}}_limitZoom(W){return Math.max(this.options.minZoom,Math.min(Math.floor(+W),this.options.maxZoom+1))}_cluster(W,J){const{radius:te,extent:me,reduce:Ae,minPoints:Ve}=this.options,qe=te/(me*Math.pow(2,J)),Oe=W.data,it=[],Je=this.stride;for(let Ue=0;Ue<Oe.length;Ue+=Je){if(Oe[Ue+2]<=J)continue;Oe[Ue+2]=J;const Be=Oe[Ue],kt=Oe[Ue+1],Tt=W.within(Oe[Ue],Oe[Ue+1],qe),tn=Oe[Ue+We];let pn=tn;for(const st of Tt){const Et=st*Je;Oe[Et+2]>J&&(pn+=Oe[Et+We])}if(pn>tn&&pn>=Ve){let st,Et=Be*tn,jt=kt*tn,Cn=-1;const zn=((Ue/Je|0)<<5)+(J+1)+this.points.length;for(const on of Tt){const Ot=on*Je;if(Oe[Ot+2]<=J)continue;Oe[Ot+2]=J;const ki=Oe[Ot+We];Et+=Oe[Ot]*ki,jt+=Oe[Ot+1]*ki,Oe[Ot+4]=zn,Ae&&(st||(st=this._map(Oe,Ue,!0),Cn=this.clusterProps.length,this.clusterProps.push(st)),Ae(st,this._map(Oe,Ot)))}Oe[Ue+4]=zn,it.push(Et/pn,jt/pn,1/0,zn,-1,pn),Ae&&it.push(Cn)}else{for(let st=0;st<Je;st++)it.push(Oe[Ue+st]);if(pn>1)for(const st of Tt){const Et=st*Je;if(!(Oe[Et+2]<=J)){Oe[Et+2]=J;for(let jt=0;jt<Je;jt++)it.push(Oe[Et+jt])}}}}return it}_getOriginId(W){return W-this.points.length>>5}_getOriginZoom(W){return(W-this.points.length)%32}_map(W,J,te){if(W[J+We]>1){const Ve=this.clusterProps[W[J+ht]];return te?Object.assign({},Ve):Ve}const me=this.points[W[J+Fe]].properties,Ae=this.options.map(me);return te&&Ae===me?Object.assign({},Ae):Ae}}function tt(ae,W,J){return{type:"Feature",id:ae[W+Fe],properties:Mt(ae,W,J),geometry:{type:"Point",coordinates:[(te=ae[W],360*(te-.5)),ct(ae[W+1])]}};var te}function Mt(ae,W,J){const te=ae[W+We],me=te>=1e4?`${Math.round(te/1e3)}k`:te>=1e3?Math.round(te/100)/10+"k":te,Ae=ae[W+ht],Ve=Ae===-1?{}:Object.assign({},J[Ae]);return Object.assign(Ve,{cluster:!0,cluster_id:ae[W+Fe],point_count:te,point_count_abbreviated:me})}function _t(ae){return ae/360+.5}function Qe(ae){const W=Math.sin(ae*Math.PI/180),J=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return J<0?0:J>1?1:J}function ct(ae){const W=(180-360*ae)*Math.PI/180;return 360*Math.atan(Math.exp(W))/Math.PI-90}function Dt(ae,W,J,te){let me=te;const Ae=W+(J-W>>1);let Ve,qe=J-W;const Oe=ae[W],it=ae[W+1],Je=ae[J],Ue=ae[J+1];for(let Be=W+3;Be<J;Be+=3){const kt=Yt(ae[Be],ae[Be+1],Oe,it,Je,Ue);if(kt>me)Ve=Be,me=kt;else if(kt===me){const Tt=Math.abs(Be-Ae);Tt<qe&&(Ve=Be,qe=Tt)}}me>te&&(Ve-W>3&&Dt(ae,W,Ve,te),ae[Ve+2]=me,J-Ve>3&&Dt(ae,Ve,J,te))}function Yt(ae,W,J,te,me,Ae){let Ve=me-J,qe=Ae-te;if(Ve!==0||qe!==0){const Oe=((ae-J)*Ve+(W-te)*qe)/(Ve*Ve+qe*qe);Oe>1?(J=me,te=Ae):Oe>0&&(J+=Ve*Oe,te+=qe*Oe)}return Ve=ae-J,qe=W-te,Ve*Ve+qe*qe}function zt(ae,W,J,te){const me={id:ae??null,type:W,geometry:J,tags:te,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(W==="Point"||W==="MultiPoint"||W==="LineString")Kt(me,J);else if(W==="Polygon")Kt(me,J[0]);else if(W==="MultiLineString")for(const Ae of J)Kt(me,Ae);else if(W==="MultiPolygon")for(const Ae of J)Kt(me,Ae[0]);return me}function Kt(ae,W){for(let J=0;J<W.length;J+=3)ae.minX=Math.min(ae.minX,W[J]),ae.minY=Math.min(ae.minY,W[J+1]),ae.maxX=Math.max(ae.maxX,W[J]),ae.maxY=Math.max(ae.maxY,W[J+1])}function Zt(ae,W,J,te){if(!W.geometry)return;const me=W.geometry.coordinates;if(me&&me.length===0)return;const Ae=W.geometry.type,Ve=Math.pow(J.tolerance/((1<<J.maxZoom)*J.extent),2);let qe=[],Oe=W.id;if(J.promoteId?Oe=W.properties[J.promoteId]:J.generateId&&(Oe=te||0),Ae==="Point")_n(me,qe);else if(Ae==="MultiPoint")for(const it of me)_n(it,qe);else if(Ae==="LineString")bn(me,qe,Ve,!1);else if(Ae==="MultiLineString"){if(J.lineMetrics){for(const it of me)qe=[],bn(it,qe,Ve,!1),ae.push(zt(Oe,"LineString",qe,W.properties));return}Vn(me,qe,Ve,!1)}else if(Ae==="Polygon")Vn(me,qe,Ve,!0);else{if(Ae!=="MultiPolygon"){if(Ae==="GeometryCollection"){for(const it of W.geometry.geometries)Zt(ae,{id:Oe,geometry:it,properties:W.properties},J,te);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const it of me){const Je=[];Vn(it,Je,Ve,!0),qe.push(Je)}}ae.push(zt(Oe,Ae,qe,W.properties))}function _n(ae,W){W.push(On(ae[0]),ri(ae[1]),0)}function bn(ae,W,J,te){let me,Ae,Ve=0;for(let Oe=0;Oe<ae.length;Oe++){const it=On(ae[Oe][0]),Je=ri(ae[Oe][1]);W.push(it,Je,0),Oe>0&&(Ve+=te?(me*Je-it*Ae)/2:Math.sqrt(Math.pow(it-me,2)+Math.pow(Je-Ae,2))),me=it,Ae=Je}const qe=W.length-3;W[2]=1,Dt(W,0,qe,J),W[qe+2]=1,W.size=Math.abs(Ve),W.start=0,W.end=W.size}function Vn(ae,W,J,te){for(let me=0;me<ae.length;me++){const Ae=[];bn(ae[me],Ae,J,te),W.push(Ae)}}function On(ae){return ae/360+.5}function ri(ae){const W=Math.sin(ae*Math.PI/180),J=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return J<0?0:J>1?1:J}function En(ae,W,J,te,me,Ae,Ve,qe){if(te/=W,Ae>=(J/=W)&&Ve<te)return ae;if(Ve<J||Ae>=te)return null;const Oe=[];for(const it of ae){const Je=it.geometry;let Ue=it.type;const Be=me===0?it.minX:it.minY,kt=me===0?it.maxX:it.maxY;if(Be>=J&&kt<te){Oe.push(it);continue}if(kt<J||Be>=te)continue;let Tt=[];if(Ue==="Point"||Ue==="MultiPoint")Pe(Je,Tt,J,te,me);else if(Ue==="LineString")Le(Je,Tt,J,te,me,!1,qe.lineMetrics);else if(Ue==="MultiLineString")xt(Je,Tt,J,te,me,!1);else if(Ue==="Polygon")xt(Je,Tt,J,te,me,!0);else if(Ue==="MultiPolygon")for(const tn of Je){const pn=[];xt(tn,pn,J,te,me,!0),pn.length&&Tt.push(pn)}if(Tt.length){if(qe.lineMetrics&&Ue==="LineString"){for(const tn of Tt)Oe.push(zt(it.id,Ue,tn,it.tags));continue}Ue!=="LineString"&&Ue!=="MultiLineString"||(Tt.length===1?(Ue="LineString",Tt=Tt[0]):Ue="MultiLineString"),Ue!=="Point"&&Ue!=="MultiPoint"||(Ue=Tt.length===3?"Point":"MultiPoint"),Oe.push(zt(it.id,Ue,Tt,it.tags))}}return Oe.length?Oe:null}function Pe(ae,W,J,te,me){for(let Ae=0;Ae<ae.length;Ae+=3){const Ve=ae[Ae+me];Ve>=J&&Ve<=te&&mt(W,ae[Ae],ae[Ae+1],ae[Ae+2])}}function Le(ae,W,J,te,me,Ae,Ve){let qe=ot(ae);const Oe=me===0?vt:Lt;let it,Je,Ue=ae.start;for(let pn=0;pn<ae.length-3;pn+=3){const st=ae[pn],Et=ae[pn+1],jt=ae[pn+2],Cn=ae[pn+3],zn=ae[pn+4],on=me===0?st:Et,Ot=me===0?Cn:zn;let ki=!1;Ve&&(it=Math.sqrt(Math.pow(st-Cn,2)+Math.pow(Et-zn,2))),on<J?Ot>J&&(Je=Oe(qe,st,Et,Cn,zn,J),Ve&&(qe.start=Ue+it*Je)):on>te?Ot<te&&(Je=Oe(qe,st,Et,Cn,zn,te),Ve&&(qe.start=Ue+it*Je)):mt(qe,st,Et,jt),Ot<J&&on>=J&&(Je=Oe(qe,st,Et,Cn,zn,J),ki=!0),Ot>te&&on<=te&&(Je=Oe(qe,st,Et,Cn,zn,te),ki=!0),!Ae&&ki&&(Ve&&(qe.end=Ue+it*Je),W.push(qe),qe=ot(ae)),Ve&&(Ue+=it)}let Be=ae.length-3;const kt=ae[Be],Tt=ae[Be+1],tn=me===0?kt:Tt;tn>=J&&tn<=te&&mt(qe,kt,Tt,ae[Be+2]),Be=qe.length-3,Ae&&Be>=3&&(qe[Be]!==qe[0]||qe[Be+1]!==qe[1])&&mt(qe,qe[0],qe[1],qe[2]),qe.length&&W.push(qe)}function ot(ae){const W=[];return W.size=ae.size,W.start=ae.start,W.end=ae.end,W}function xt(ae,W,J,te,me,Ae){for(const Ve of ae)Le(Ve,W,J,te,me,Ae,!1)}function mt(ae,W,J,te){ae.push(W,J,te)}function vt(ae,W,J,te,me,Ae){const Ve=(Ae-W)/(te-W);return mt(ae,Ae,J+(me-J)*Ve,1),Ve}function Lt(ae,W,J,te,me,Ae){const Ve=(Ae-J)/(me-J);return mt(ae,W+(te-W)*Ve,Ae,1),Ve}function It(ae,W){const J=[];for(let te=0;te<ae.length;te++){const me=ae[te],Ae=me.type;let Ve;if(Ae==="Point"||Ae==="MultiPoint"||Ae==="LineString")Ve=At(me.geometry,W);else if(Ae==="MultiLineString"||Ae==="Polygon"){Ve=[];for(const qe of me.geometry)Ve.push(At(qe,W))}else if(Ae==="MultiPolygon"){Ve=[];for(const qe of me.geometry){const Oe=[];for(const it of qe)Oe.push(At(it,W));Ve.push(Oe)}}J.push(zt(me.id,Ae,Ve,me.tags))}return J}function At(ae,W){const J=[];J.size=ae.size,ae.start!==void 0&&(J.start=ae.start,J.end=ae.end);for(let te=0;te<ae.length;te+=3)J.push(ae[te]+W,ae[te+1],ae[te+2]);return J}function wt(ae,W){if(ae.transformed)return ae;const J=1<<ae.z,te=ae.x,me=ae.y;for(const Ae of ae.features){const Ve=Ae.geometry,qe=Ae.type;if(Ae.geometry=[],qe===1)for(let Oe=0;Oe<Ve.length;Oe+=2)Ae.geometry.push(en(Ve[Oe],Ve[Oe+1],W,J,te,me));else for(let Oe=0;Oe<Ve.length;Oe++){const it=[];for(let Je=0;Je<Ve[Oe].length;Je+=2)it.push(en(Ve[Oe][Je],Ve[Oe][Je+1],W,J,te,me));Ae.geometry.push(it)}}return ae.transformed=!0,ae}function en(ae,W,J,te,me,Ae){return[Math.round(J*(ae*te-me)),Math.round(J*(W*te-Ae))]}function Nt(ae,W,J,te,me){const Ae=W===me.maxZoom?0:me.tolerance/((1<<W)*me.extent),Ve={features:[],numPoints:0,numSimplified:0,numFeatures:ae.length,source:null,x:J,y:te,z:W,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const qe of ae)Wt(Ve,qe,Ae,me);return Ve}function Wt(ae,W,J,te){const me=W.geometry,Ae=W.type,Ve=[];if(ae.minX=Math.min(ae.minX,W.minX),ae.minY=Math.min(ae.minY,W.minY),ae.maxX=Math.max(ae.maxX,W.maxX),ae.maxY=Math.max(ae.maxY,W.maxY),Ae==="Point"||Ae==="MultiPoint")for(let qe=0;qe<me.length;qe+=3)Ve.push(me[qe],me[qe+1]),ae.numPoints++,ae.numSimplified++;else if(Ae==="LineString")un(Ve,me,ae,J,!1,!1);else if(Ae==="MultiLineString"||Ae==="Polygon")for(let qe=0;qe<me.length;qe++)un(Ve,me[qe],ae,J,Ae==="Polygon",qe===0);else if(Ae==="MultiPolygon")for(let qe=0;qe<me.length;qe++){const Oe=me[qe];for(let it=0;it<Oe.length;it++)un(Ve,Oe[it],ae,J,!0,it===0)}if(Ve.length){let qe=W.tags||null;if(Ae==="LineString"&&te.lineMetrics){qe={};for(const it in W.tags)qe[it]=W.tags[it];qe.mapbox_clip_start=me.start/me.size,qe.mapbox_clip_end=me.end/me.size}const Oe={geometry:Ve,type:Ae==="Polygon"||Ae==="MultiPolygon"?3:Ae==="LineString"||Ae==="MultiLineString"?2:1,tags:qe};W.id!==null&&(Oe.id=W.id),ae.features.push(Oe)}}function un(ae,W,J,te,me,Ae){const Ve=te*te;if(te>0&&W.size<(me?Ve:te))return void(J.numPoints+=W.length/3);const qe=[];for(let Oe=0;Oe<W.length;Oe+=3)(te===0||W[Oe+2]>Ve)&&(J.numSimplified++,qe.push(W[Oe],W[Oe+1])),J.numPoints++;me&&function(Oe,it){let Je=0;for(let Ue=0,Be=Oe.length,kt=Be-2;Ue<Be;kt=Ue,Ue+=2)Je+=(Oe[Ue]-Oe[kt])*(Oe[Ue+1]+Oe[kt+1]);if(Je>0===it)for(let Ue=0,Be=Oe.length;Ue<Be/2;Ue+=2){const kt=Oe[Ue],Tt=Oe[Ue+1];Oe[Ue]=Oe[Be-2-Ue],Oe[Ue+1]=Oe[Be-1-Ue],Oe[Be-2-Ue]=kt,Oe[Be-1-Ue]=Tt}}(qe,Ae),ae.push(qe)}const Sn={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Dn{constructor(W,J){const te=(J=this.options=function(Ae,Ve){for(const qe in Ve)Ae[qe]=Ve[qe];return Ae}(Object.create(Sn),J)).debug;if(te&&console.time("preprocess data"),J.maxZoom<0||J.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(J.promoteId&&J.generateId)throw new Error("promoteId and generateId cannot be used together.");let me=function(Ae,Ve){const qe=[];if(Ae.type==="FeatureCollection")for(let Oe=0;Oe<Ae.features.length;Oe++)Zt(qe,Ae.features[Oe],Ve,Oe);else Zt(qe,Ae.type==="Feature"?Ae:{geometry:Ae},Ve);return qe}(W,J);this.tiles={},this.tileCoords=[],te&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",J.indexMaxZoom,J.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),me=function(Ae,Ve){const qe=Ve.buffer/Ve.extent;let Oe=Ae;const it=En(Ae,1,-1-qe,qe,0,-1,2,Ve),Je=En(Ae,1,1-qe,2+qe,0,-1,2,Ve);return(it||Je)&&(Oe=En(Ae,1,-qe,1+qe,0,-1,2,Ve)||[],it&&(Oe=It(it,1).concat(Oe)),Je&&(Oe=Oe.concat(It(Je,-1)))),Oe}(me,J),me.length&&this.splitTile(me,0,0,0),te&&(me.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(W,J,te,me,Ae,Ve,qe){const Oe=[W,J,te,me],it=this.options,Je=it.debug;for(;Oe.length;){me=Oe.pop(),te=Oe.pop(),J=Oe.pop(),W=Oe.pop();const Ue=1<<J,Be=An(J,te,me);let kt=this.tiles[Be];if(!kt&&(Je>1&&console.time("creation"),kt=this.tiles[Be]=Nt(W,J,te,me,it),this.tileCoords.push({z:J,x:te,y:me}),Je)){Je>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",J,te,me,kt.numFeatures,kt.numPoints,kt.numSimplified),console.timeEnd("creation"));const ki=`z${J}`;this.stats[ki]=(this.stats[ki]||0)+1,this.total++}if(kt.source=W,Ae==null){if(J===it.indexMaxZoom||kt.numPoints<=it.indexMaxPoints)continue}else{if(J===it.maxZoom||J===Ae)continue;if(Ae!=null){const ki=Ae-J;if(te!==Ve>>ki||me!==qe>>ki)continue}}if(kt.source=null,W.length===0)continue;Je>1&&console.time("clipping");const Tt=.5*it.buffer/it.extent,tn=.5-Tt,pn=.5+Tt,st=1+Tt;let Et=null,jt=null,Cn=null,zn=null,on=En(W,Ue,te-Tt,te+pn,0,kt.minX,kt.maxX,it),Ot=En(W,Ue,te+tn,te+st,0,kt.minX,kt.maxX,it);W=null,on&&(Et=En(on,Ue,me-Tt,me+pn,1,kt.minY,kt.maxY,it),jt=En(on,Ue,me+tn,me+st,1,kt.minY,kt.maxY,it),on=null),Ot&&(Cn=En(Ot,Ue,me-Tt,me+pn,1,kt.minY,kt.maxY,it),zn=En(Ot,Ue,me+tn,me+st,1,kt.minY,kt.maxY,it),Ot=null),Je>1&&console.timeEnd("clipping"),Oe.push(Et||[],J+1,2*te,2*me),Oe.push(jt||[],J+1,2*te,2*me+1),Oe.push(Cn||[],J+1,2*te+1,2*me),Oe.push(zn||[],J+1,2*te+1,2*me+1)}}getTile(W,J,te){W=+W,J=+J,te=+te;const me=this.options,{extent:Ae,debug:Ve}=me;if(W<0||W>24)return null;const qe=1<<W,Oe=An(W,J=J+qe&qe-1,te);if(this.tiles[Oe])return wt(this.tiles[Oe],Ae);Ve>1&&console.log("drilling down to z%d-%d-%d",W,J,te);let it,Je=W,Ue=J,Be=te;for(;!it&&Je>0;)Je--,Ue>>=1,Be>>=1,it=this.tiles[An(Je,Ue,Be)];return it&&it.source?(Ve>1&&(console.log("found parent tile z%d-%d-%d",Je,Ue,Be),console.time("drilling down")),this.splitTile(it.source,Je,Ue,Be,W,J,te),Ve>1&&console.timeEnd("drilling down"),this.tiles[Oe]?wt(this.tiles[Oe],Ae):null):null}}function An(ae,W,J){return 32*((1<<ae)*J+W)+ae}function Ei(ae,W){return W?ae.properties[W]:ae.id}function Pi(ae,W){if(ae==null)return!0;if(ae.type==="Feature")return Ei(ae,W)!=null;if(ae.type==="FeatureCollection"){const J=new Set;for(const te of ae.features){const me=Ei(te,W);if(me==null||J.has(me))return!1;J.add(me)}return!0}return!1}function er(ae,W){const J=new Map;if(ae!=null)if(ae.type==="Feature")J.set(Ei(ae,W),ae);else for(const te of ae.features)J.set(Ei(te,W),te);return J}class Zi extends D{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(W,J){return m._(this,void 0,void 0,function*(){const te=W.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const me=this._geoJSONIndex.getTile(te.z,te.x,te.y);if(!me)return null;const Ae=new Se(me.features);let Ve=Me(Ae);return Ve.byteOffset===0&&Ve.byteLength===Ve.buffer.byteLength||(Ve=new Uint8Array(Ve)),{vectorTile:Ae,rawData:Ve.buffer}})}loadData(W){return m._(this,void 0,void 0,function*(){var J;(J=this._pendingRequest)===null||J===void 0||J.abort();const te=!!(W&&W.request&&W.request.collectResourceTiming)&&new m.cu(W.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(W,this._pendingRequest),this._geoJSONIndex=W.cluster?new Ne(function({superclusterOptions:Ve,clusterProperties:qe}){if(!qe||!Ve)return Ve;const Oe={},it={},Je={accumulated:null,zoom:0},Ue={properties:null},Be=Object.keys(qe);for(const kt of Be){const[Tt,tn]=qe[kt],pn=m.cB(tn),st=m.cB(typeof Tt=="string"?[Tt,["accumulated"],["get",kt]]:Tt);Oe[kt]=pn.value,it[kt]=st.value}return Ve.map=kt=>{Ue.properties=kt;const Tt={};for(const tn of Be)Tt[tn]=Oe[tn].evaluate(Je,Ue);return Tt},Ve.reduce=(kt,Tt)=>{Ue.properties=Tt;for(const tn of Be)Je.accumulated=kt[tn],kt[tn]=it[tn].evaluate(Je,Ue)},Ve}(W)).load((yield this._pendingData).features):(me=yield this._pendingData,new Dn(me,W.geojsonVtOptions)),this.loaded={};const Ae={};if(te){const Ve=te.finish();Ve&&(Ae.resourceTiming={},Ae.resourceTiming[W.source]=JSON.parse(JSON.stringify(Ve)))}return Ae}catch(Ae){if(delete this._pendingRequest,m.cf(Ae))return{abandoned:!0};throw Ae}var me})}getData(){return m._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(W){const J=this.loaded;return J&&J[W.uid]?super.reloadTile(W):this.loadTile(W)}loadAndProcessGeoJSON(W,J){return m._(this,void 0,void 0,function*(){let te=yield this.loadGeoJSON(W,J);if(delete this._pendingRequest,typeof te!="object")throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`);if(q(te,!0),W.filter){const me=m.cB(W.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(me.result==="error")throw new Error(me.value.map(Ve=>`${Ve.key}: ${Ve.message}`).join(", "));te={type:"FeatureCollection",features:te.features.filter(Ve=>me.value.evaluate({zoom:0},Ve))}}return te})}loadGeoJSON(W,J){return m._(this,void 0,void 0,function*(){const{promoteId:te}=W;if(W.request){const me=yield m.h(W.request,J);return this._dataUpdateable=Pi(me.data,te)?er(me.data,te):void 0,me.data}if(typeof W.data=="string")try{const me=JSON.parse(W.data);return this._dataUpdateable=Pi(me,te)?er(me,te):void 0,me}catch{throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`)}if(!W.dataDiff)throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${W.source}`);return function(me,Ae,Ve){var qe,Oe,it,Je;if(Ae.removeAll&&me.clear(),Ae.remove)for(const Ue of Ae.remove)me.delete(Ue);if(Ae.add)for(const Ue of Ae.add){const Be=Ei(Ue,Ve);Be!=null&&me.set(Be,Ue)}if(Ae.update)for(const Ue of Ae.update){let Be=me.get(Ue.id);if(Be==null)continue;const kt=!Ue.removeAllProperties&&(((qe=Ue.removeProperties)===null||qe===void 0?void 0:qe.length)>0||((Oe=Ue.addOrUpdateProperties)===null||Oe===void 0?void 0:Oe.length)>0);if((Ue.newGeometry||Ue.removeAllProperties||kt)&&(Be=Object.assign({},Be),me.set(Ue.id,Be),kt&&(Be.properties=Object.assign({},Be.properties))),Ue.newGeometry&&(Be.geometry=Ue.newGeometry),Ue.removeAllProperties)Be.properties={};else if(((it=Ue.removeProperties)===null||it===void 0?void 0:it.length)>0)for(const Tt of Ue.removeProperties)Object.prototype.hasOwnProperty.call(Be.properties,Tt)&&delete Be.properties[Tt];if(((Je=Ue.addOrUpdateProperties)===null||Je===void 0?void 0:Je.length)>0)for(const{key:Tt,value:tn}of Ue.addOrUpdateProperties)Be.properties[Tt]=tn}}(this._dataUpdateable,W.dataDiff,te),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(W){return m._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(W){return this._geoJSONIndex.getClusterExpansionZoom(W.clusterId)}getClusterChildren(W){return this._geoJSONIndex.getChildren(W.clusterId)}getClusterLeaves(W){return this._geoJSONIndex.getLeaves(W.clusterId,W.limit,W.offset)}}class Mr{constructor(W){this.self=W,this.actor=new m.F(W),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(J,te)=>{if(this.externalWorkerSourceTypes[J])throw new Error(`Worker source with name "${J}" already registered.`);this.externalWorkerSourceTypes[J]=te},this.self.addProtocol=m.ch,this.self.removeProtocol=m.ci,this.self.registerRTLTextPlugin=J=>{m.cC.setMethods(J)},this.actor.registerMessageHandler("LDT",(J,te)=>this._getDEMWorkerSource(J,te.source).loadTile(te)),this.actor.registerMessageHandler("RDT",(J,te)=>m._(this,void 0,void 0,function*(){this._getDEMWorkerSource(J,te.source).removeTile(te)})),this.actor.registerMessageHandler("GCEZ",(J,te)=>m._(this,void 0,void 0,function*(){return this._getWorkerSource(J,te.type,te.source).getClusterExpansionZoom(te)})),this.actor.registerMessageHandler("GCC",(J,te)=>m._(this,void 0,void 0,function*(){return this._getWorkerSource(J,te.type,te.source).getClusterChildren(te)})),this.actor.registerMessageHandler("GCL",(J,te)=>m._(this,void 0,void 0,function*(){return this._getWorkerSource(J,te.type,te.source).getClusterLeaves(te)})),this.actor.registerMessageHandler("LD",(J,te)=>this._getWorkerSource(J,te.type,te.source).loadData(te)),this.actor.registerMessageHandler("GD",(J,te)=>this._getWorkerSource(J,te.type,te.source).getData()),this.actor.registerMessageHandler("LT",(J,te)=>this._getWorkerSource(J,te.type,te.source).loadTile(te)),this.actor.registerMessageHandler("RT",(J,te)=>this._getWorkerSource(J,te.type,te.source).reloadTile(te)),this.actor.registerMessageHandler("AT",(J,te)=>this._getWorkerSource(J,te.type,te.source).abortTile(te)),this.actor.registerMessageHandler("RMT",(J,te)=>this._getWorkerSource(J,te.type,te.source).removeTile(te)),this.actor.registerMessageHandler("RS",(J,te)=>m._(this,void 0,void 0,function*(){if(!this.workerSources[J]||!this.workerSources[J][te.type]||!this.workerSources[J][te.type][te.source])return;const me=this.workerSources[J][te.type][te.source];delete this.workerSources[J][te.type][te.source],me.removeSource!==void 0&&me.removeSource(te)})),this.actor.registerMessageHandler("RM",J=>m._(this,void 0,void 0,function*(){delete this.layerIndexes[J],delete this.availableImages[J],delete this.workerSources[J],delete this.demWorkerSources[J]})),this.actor.registerMessageHandler("SR",(J,te)=>m._(this,void 0,void 0,function*(){this.referrer=te})),this.actor.registerMessageHandler("SRPS",(J,te)=>this._syncRTLPluginState(J,te)),this.actor.registerMessageHandler("IS",(J,te)=>m._(this,void 0,void 0,function*(){this.self.importScripts(te)})),this.actor.registerMessageHandler("SI",(J,te)=>this._setImages(J,te)),this.actor.registerMessageHandler("UL",(J,te)=>m._(this,void 0,void 0,function*(){this._getLayerIndex(J).update(te.layers,te.removedIds)})),this.actor.registerMessageHandler("SL",(J,te)=>m._(this,void 0,void 0,function*(){this._getLayerIndex(J).replace(te)}))}_setImages(W,J){return m._(this,void 0,void 0,function*(){this.availableImages[W]=J;for(const te in this.workerSources[W]){const me=this.workerSources[W][te];for(const Ae in me)me[Ae].availableImages=J}})}_syncRTLPluginState(W,J){return m._(this,void 0,void 0,function*(){return yield m.cC.syncState(J,this.self.importScripts)})}_getAvailableImages(W){let J=this.availableImages[W];return J||(J=[]),J}_getLayerIndex(W){let J=this.layerIndexes[W];return J||(J=this.layerIndexes[W]=new o),J}_getWorkerSource(W,J,te){if(this.workerSources[W]||(this.workerSources[W]={}),this.workerSources[W][J]||(this.workerSources[W][J]={}),!this.workerSources[W][J][te]){const me={sendAsync:(Ae,Ve)=>(Ae.targetMapId=W,this.actor.sendAsync(Ae,Ve))};switch(J){case"vector":this.workerSources[W][J][te]=new D(me,this._getLayerIndex(W),this._getAvailableImages(W));break;case"geojson":this.workerSources[W][J][te]=new Zi(me,this._getLayerIndex(W),this._getAvailableImages(W));break;default:this.workerSources[W][J][te]=new this.externalWorkerSourceTypes[J](me,this._getLayerIndex(W),this._getAvailableImages(W))}}return this.workerSources[W][J][te]}_getDEMWorkerSource(W,J){return this.demWorkerSources[W]||(this.demWorkerSources[W]={}),this.demWorkerSources[W][J]||(this.demWorkerSources[W][J]=new O),this.demWorkerSources[W][J]}}return m.i(self)&&(self.worker=new Mr(self)),Mr}),p("index",["exports","./shared"],function(m,o){var T="5.1.0";function k(){var g=new o.A(4);return o.A!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g}let M,D;const O={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(g,t,r){const u=requestAnimationFrame(t);g.signal.addEventListener("abort",()=>{cancelAnimationFrame(u),r(o.c())})},frameAsync(g){return new Promise((t,r)=>{this.frame(g,t,r)})},getImageData(g,t=0){return this.getImageCanvasContext(g).getImageData(-t,-t,g.width+2*t,g.height+2*t)},getImageCanvasContext(g){const t=window.document.createElement("canvas"),r=t.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("failed to create canvas 2d context");return t.width=g.width,t.height=g.height,r.drawImage(g,0,0,g.width,g.height),r},resolveURL:g=>(M||(M=document.createElement("a")),M.href=g,M.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(D==null&&(D=matchMedia("(prefers-reduced-motion: reduce)")),D.matches)}};class z{static testProp(t){if(!z.docStyle)return t[0];for(let r=0;r<t.length;r++)if(t[r]in z.docStyle)return t[r];return t[0]}static create(t,r,u){const d=window.document.createElement(t);return r!==void 0&&(d.className=r),u&&u.appendChild(d),d}static createNS(t,r){return window.document.createElementNS(t,r)}static disableDrag(){z.docStyle&&z.selectProp&&(z.userSelect=z.docStyle[z.selectProp],z.docStyle[z.selectProp]="none")}static enableDrag(){z.docStyle&&z.selectProp&&(z.docStyle[z.selectProp]=z.userSelect)}static setTransform(t,r){t.style[z.transformProp]=r}static addEventListener(t,r,u,d={}){t.addEventListener(r,u,"passive"in d?d:d.capture)}static removeEventListener(t,r,u,d={}){t.removeEventListener(r,u,"passive"in d?d:d.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",z.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",z.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",z.suppressClickInternal,!0)},0)}static getScale(t){const r=t.getBoundingClientRect();return{x:r.width/t.offsetWidth||1,y:r.height/t.offsetHeight||1,boundingClientRect:r}}static getPoint(t,r,u){const d=r.boundingClientRect;return new o.P((u.clientX-d.left)/r.x-t.clientLeft,(u.clientY-d.top)/r.y-t.clientTop)}static mousePos(t,r){const u=z.getScale(t);return z.getPoint(t,u,r)}static touchPos(t,r){const u=[],d=z.getScale(t);for(let y=0;y<r.length;y++)u.push(z.getPoint(t,d,r[y]));return u}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}static sanitize(t){const r=new DOMParser().parseFromString(t,"text/html").body||document.createElement("body"),u=r.querySelectorAll("script");for(const d of u)d.remove();return z.clean(r),r.innerHTML}static isPossiblyDangerous(t,r){const u=r.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(t)||!u.includes("javascript:")&&!u.includes("data:"))||!!t.startsWith("on")||void 0}static clean(t){const r=t.children;for(const u of r)z.removeAttributes(u),z.clean(u)}static removeAttributes(t){for(const{name:r,value:u}of t.attributes)z.isPossiblyDangerous(r,u)&&t.removeAttribute(r)}}z.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,z.selectProp=z.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),z.transformProp=z.testProp(["transform","WebkitTransform"]);const F={supported:!1,testSupport:function(g){!oe&&q&&(_e?Se(g):N=g)}};let N,q,oe=!1,_e=!1;function Se(g){const t=g.createTexture();g.bindTexture(g.TEXTURE_2D,t);try{if(g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,q),g.isContextLost())return;F.supported=!0}catch{}g.deleteTexture(t),oe=!0}var pe;typeof document<"u"&&(q=document.createElement("img"),q.onload=()=>{N&&Se(N),N=null,_e=!0},q.onerror=()=>{oe=!0,N=null},q.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(g){let t,r,u,d;g.resetRequestQueue=()=>{t=[],r=0,u=0,d={}},g.addThrottleControl=P=>{const E=u++;return d[E]=P,E},g.removeThrottleControl=P=>{delete d[P],x()},g.getImage=(P,E,B=!0)=>new Promise((V,j)=>{F.supported&&(P.headers||(P.headers={}),P.headers.accept="image/webp,*/*"),o.e(P,{type:"image"}),t.push({abortController:E,requestParameters:P,supportImageRefresh:B,state:"queued",onError:X=>{j(X)},onSuccess:X=>{V(X)}}),x()});const y=P=>o._(this,void 0,void 0,function*(){P.state="running";const{requestParameters:E,supportImageRefresh:B,onError:V,onSuccess:j,abortController:X}=P,Y=B===!1&&!o.i(self)&&!o.g(E.url)&&(!E.headers||Object.keys(E.headers).reduce((ce,fe)=>ce&&fe==="accept",!0));r++;const le=Y?S(E,X):o.m(E,X);try{const ce=yield le;delete P.abortController,P.state="completed",ce.data instanceof HTMLImageElement||o.b(ce.data)?j(ce):ce.data&&j({data:yield(se=ce.data,typeof createImageBitmap=="function"?o.d(se):o.f(se)),cacheControl:ce.cacheControl,expires:ce.expires})}catch(ce){delete P.abortController,V(ce)}finally{r--,x()}var se}),x=()=>{const P=(()=>{for(const E of Object.keys(d))if(d[E]())return!0;return!1})()?o.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let E=r;E<P&&t.length>0;E++){const B=t.shift();B.abortController.signal.aborted?E--:y(B)}},S=(P,E)=>new Promise((B,V)=>{const j=new Image,X=P.url,Y=P.credentials;Y&&Y==="include"?j.crossOrigin="use-credentials":(Y&&Y==="same-origin"||!o.s(X))&&(j.crossOrigin="anonymous"),E.signal.addEventListener("abort",()=>{j.src="",V(o.c())}),j.fetchPriority="high",j.onload=()=>{j.onerror=j.onload=null,B({data:j})},j.onerror=()=>{j.onerror=j.onload=null,E.signal.aborted||V(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},j.src=X})}(pe||(pe={})),pe.resetRequestQueue();class be{constructor(t){this._transformRequestFn=t}transformRequest(t,r){return this._transformRequestFn&&this._transformRequestFn(t,r)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function de(g){const t=[];if(typeof g=="string")t.push({id:"default",url:g});else if(g&&g.length>0){const r=[];for(const{id:u,url:d}of g){const y=`${u}${d}`;r.indexOf(y)===-1&&(r.push(y),t.push({id:u,url:d}))}}return t}function Ce(g,t,r){try{const u=new URL(g);return u.pathname+=`${t}${r}`,u.toString()}catch{throw new Error(`Invalid sprite URL "${g}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class ye{constructor(t,r,u,d){this.context=t,this.format=u,this.texture=t.gl.createTexture(),this.update(r,d)}update(t,r,u){const{width:d,height:y}=t,x=!(this.size&&this.size[0]===d&&this.size[1]===y||u),{context:S}=this,{gl:P}=S;if(this.useMipmap=!!(r&&r.useMipmap),P.bindTexture(P.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===P.RGBA&&(!r||r.premultiply!==!1)),x)this.size=[d,y],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||o.b(t)?P.texImage2D(P.TEXTURE_2D,0,this.format,this.format,P.UNSIGNED_BYTE,t):P.texImage2D(P.TEXTURE_2D,0,this.format,d,y,0,this.format,P.UNSIGNED_BYTE,t.data);else{const{x:E,y:B}=u||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||o.b(t)?P.texSubImage2D(P.TEXTURE_2D,0,E,B,P.RGBA,P.UNSIGNED_BYTE,t):P.texSubImage2D(P.TEXTURE_2D,0,E,B,d,y,P.RGBA,P.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&P.generateMipmap(P.TEXTURE_2D)}bind(t,r,u){const{context:d}=this,{gl:y}=d;y.bindTexture(y.TEXTURE_2D,this.texture),u!==y.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=y.LINEAR),t!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,t),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,u||t),this.filter=t),r!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,r),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function Me(g){const{userImage:t}=g;return!!(t&&t.render&&t.render())&&(g.data.replace(new Uint8Array(t.data.buffer)),!0)}class ke extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:r,promiseResolve:u}of this.requestors)u(this._getImagesForIds(r));this.requestors=[]}}getImage(t){const r=this.images[t];if(r&&!r.data&&r.spriteData){const u=r.spriteData;r.data=new o.R({width:u.width,height:u.height},u.context.getImageData(u.x,u.y,u.width,u.height).data),r.spriteData=null}return r}addImage(t,r){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,r)&&(this.images[t]=r)}_validate(t,r){let u=!0;const d=r.data||r.spriteData;return this._validateStretch(r.stretchX,d&&d.width)||(this.fire(new o.j(new Error(`Image "${t}" has invalid "stretchX" value`))),u=!1),this._validateStretch(r.stretchY,d&&d.height)||(this.fire(new o.j(new Error(`Image "${t}" has invalid "stretchY" value`))),u=!1),this._validateContent(r.content,r)||(this.fire(new o.j(new Error(`Image "${t}" has invalid "content" value`))),u=!1),u}_validateStretch(t,r){if(!t)return!0;let u=0;for(const d of t){if(d[0]<u||d[1]<d[0]||r<d[1])return!1;u=d[1]}return!0}_validateContent(t,r){if(!t)return!0;if(t.length!==4)return!1;const u=r.spriteData,d=u&&u.width||r.data.width,y=u&&u.height||r.data.height;return!(t[0]<0||d<t[0]||t[1]<0||y<t[1]||t[2]<0||d<t[2]||t[3]<0||y<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,r,u=!0){const d=this.getImage(t);if(u&&(d.data.width!==r.data.width||d.data.height!==r.data.height))throw new Error(`size mismatch between old image (${d.data.width}x${d.data.height}) and new image (${r.data.width}x${r.data.height}).`);r.version=d.version+1,this.images[t]=r,this.updatedImages[t]=!0}removeImage(t){const r=this.images[t];delete this.images[t],delete this.patterns[t],r.userImage&&r.userImage.onRemove&&r.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise((r,u)=>{let d=!0;if(!this.isLoaded())for(const y of t)this.images[y]||(d=!1);this.isLoaded()||d?r(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:r})})}_getImagesForIds(t){const r={};for(const u of t){let d=this.getImage(u);d||(this.fire(new o.k("styleimagemissing",{id:u})),d=this.getImage(u)),d?r[u]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,stretchX:d.stretchX,stretchY:d.stretchY,content:d.content,textFitWidth:d.textFitWidth,textFitHeight:d.textFitHeight,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:o.w(`Image "${u}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return r}getPixelSize(){const{width:t,height:r}=this.atlasImage;return{width:t,height:r}}getPattern(t){const r=this.patterns[t],u=this.getImage(t);if(!u)return null;if(r&&r.position.version===u.version)return r.position;if(r)r.position.version=u.version;else{const d={w:u.data.width+2,h:u.data.height+2,x:0,y:0},y=new o.I(d,u);this.patterns[t]={bin:d,position:y}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const r=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ye(t,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const y in this.patterns)t.push(this.patterns[y].bin);const{w:r,h:u}=o.p(t),d=this.atlasImage;d.resize({width:r||1,height:u||1});for(const y in this.patterns){const{bin:x}=this.patterns[y],S=x.x+1,P=x.y+1,E=this.getImage(y).data,B=E.width,V=E.height;o.R.copy(E,d,{x:0,y:0},{x:S,y:P},{width:B,height:V}),o.R.copy(E,d,{x:0,y:V-1},{x:S,y:P-1},{width:B,height:1}),o.R.copy(E,d,{x:0,y:0},{x:S,y:P+V},{width:B,height:1}),o.R.copy(E,d,{x:B-1,y:0},{x:S-1,y:P},{width:1,height:V}),o.R.copy(E,d,{x:0,y:0},{x:S+B,y:P},{width:1,height:V})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const r of t){if(this.callbackDispatchedThisFrame[r])continue;this.callbackDispatchedThisFrame[r]=!0;const u=this.getImage(r);u||o.w(`Image with ID: "${r}" was not found`),Me(u)&&this.updateImage(r,u)}}}const Ee=1e20;function xe(g,t,r,u,d,y,x,S,P){for(let E=t;E<t+u;E++)Fe(g,r*y+E,y,d,x,S,P);for(let E=r;E<r+d;E++)Fe(g,E*y+t,1,u,x,S,P)}function Fe(g,t,r,u,d,y,x){y[0]=0,x[0]=-1e20,x[1]=Ee,d[0]=g[t];for(let S=1,P=0,E=0;S<u;S++){d[S]=g[t+S*r];const B=S*S;do{const V=y[P];E=(d[S]-d[V]+B-V*V)/(S-V)/2}while(E<=x[P]&&--P>-1);P++,y[P]=S,x[P]=E,x[P+1]=Ee}for(let S=0,P=0;S<u;S++){for(;x[P+1]<S;)P++;const E=y[P],B=S-E;g[t+S*r]=d[E]+B*B}}class We{constructor(t,r){this.requestManager=t,this.localIdeographFontFamily=r,this.entries={}}setURL(t){this.url=t}getGlyphs(t){return o._(this,void 0,void 0,function*(){const r=[];for(const y in t)for(const x of t[y])r.push(this._getAndCacheGlyphsPromise(y,x));const u=yield Promise.all(r),d={};for(const{stack:y,id:x,glyph:S}of u)d[y]||(d[y]={}),d[y][x]=S&&{id:S.id,bitmap:S.bitmap.clone(),metrics:S.metrics};return d})}_getAndCacheGlyphsPromise(t,r){return o._(this,void 0,void 0,function*(){let u=this.entries[t];u||(u=this.entries[t]={glyphs:{},requests:{},ranges:{}});let d=u.glyphs[r];if(d!==void 0)return{stack:t,id:r,glyph:d};if(d=this._tinySDF(u,t,r),d)return u.glyphs[r]=d,{stack:t,id:r,glyph:d};const y=Math.floor(r/256);if(256*y>65535)throw new Error("glyphs > 65535 not supported");if(u.ranges[y])return{stack:t,id:r,glyph:d};if(!this.url)throw new Error("glyphsUrl is not set");if(!u.requests[y]){const S=We.loadGlyphRange(t,y,this.url,this.requestManager);u.requests[y]=S}const x=yield u.requests[y];for(const S in x)this._doesCharSupportLocalGlyph(+S)||(u.glyphs[+S]=x[+S]);return u.ranges[y]=!0,{stack:t,id:r,glyph:x[r]||null}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&/\p{Ideo}|\p{sc=Hang}|\p{sc=Hira}|\p{sc=Kana}/u.test(String.fromCodePoint(t))}_tinySDF(t,r,u){const d=this.localIdeographFontFamily;if(!d||!this._doesCharSupportLocalGlyph(u))return;let y=t.tinySDF;if(!y){let S="400";/bold/i.test(r)?S="900":/medium/i.test(r)?S="500":/light/i.test(r)&&(S="200"),y=t.tinySDF=new We.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:d,fontWeight:S})}const x=y.draw(String.fromCharCode(u));return{id:u,bitmap:new o.o({width:x.width||60,height:x.height||60},x.data),metrics:{width:x.glyphWidth/2||24,height:x.glyphHeight/2||24,left:x.glyphLeft/2+.5||0,top:x.glyphTop/2-27.5||-8,advance:x.glyphAdvance/2||24,isDoubleResolution:!0}}}}We.loadGlyphRange=function(g,t,r,u){return o._(this,void 0,void 0,function*(){const d=256*t,y=d+255,x=u.transformRequest(r.replace("{fontstack}",g).replace("{range}",`${d}-${y}`),"Glyphs"),S=yield o.l(x,new AbortController);if(!S||!S.data)throw new Error(`Could not load glyph range. range: ${t}, ${d}-${y}`);const P={};for(const E of o.n(S.data))P[E.id]=E;return P})},We.TinySDF=class{constructor({fontSize:g=24,buffer:t=3,radius:r=8,cutoff:u=.25,fontFamily:d="sans-serif",fontWeight:y="normal",fontStyle:x="normal"}={}){this.buffer=t,this.cutoff=u,this.radius=r;const S=this.size=g+4*t,P=this._createCanvas(S),E=this.ctx=P.getContext("2d",{willReadFrequently:!0});E.font=`${x} ${y} ${g}px ${d}`,E.textBaseline="alphabetic",E.textAlign="left",E.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(g){const t=document.createElement("canvas");return t.width=t.height=g,t}draw(g){const{width:t,actualBoundingBoxAscent:r,actualBoundingBoxDescent:u,actualBoundingBoxLeft:d,actualBoundingBoxRight:y}=this.ctx.measureText(g),x=Math.ceil(r),S=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-d))),P=Math.min(this.size-this.buffer,x+Math.ceil(u)),E=S+2*this.buffer,B=P+2*this.buffer,V=Math.max(E*B,0),j=new Uint8ClampedArray(V),X={data:j,width:E,height:B,glyphWidth:S,glyphHeight:P,glyphTop:x,glyphLeft:0,glyphAdvance:t};if(S===0||P===0)return X;const{ctx:Y,buffer:le,gridInner:se,gridOuter:ce}=this;Y.clearRect(le,le,S,P),Y.fillText(g,le,le+x);const fe=Y.getImageData(le,le,S,P);ce.fill(Ee,0,V),se.fill(0,0,V);for(let we=0;we<P;we++)for(let Te=0;Te<S;Te++){const Ie=fe.data[4*(we*S+Te)+3]/255;if(Ie===0)continue;const De=(we+le)*E+Te+le;if(Ie===1)ce[De]=0,se[De]=Ee;else{const Re=.5-Ie;ce[De]=Re>0?Re*Re:0,se[De]=Re<0?Re*Re:0}}xe(ce,0,0,E,B,E,this.f,this.v,this.z),xe(se,le,le,S,P,E,this.f,this.v,this.z);for(let we=0;we<V;we++){const Te=Math.sqrt(ce[we])-Math.sqrt(se[we]);j[we]=Math.round(255-255*(Te/this.radius+this.cutoff))}return X}};class ht{constructor(){this.specification=o.v.light.position}possiblyEvaluate(t,r){return o.x(t.expression.evaluate(r))}interpolate(t,r,u){return{x:o.y.number(t.x,r.x,u),y:o.y.number(t.y,r.y,u),z:o.y.number(t.z,r.z,u)}}}let Ne;class tt extends o.E{constructor(t){super(),Ne=Ne||new o.q({anchor:new o.D(o.v.light.anchor),position:new ht,color:new o.D(o.v.light.color),intensity:new o.D(o.v.light.intensity)}),this._transitionable=new o.T(Ne),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,r={}){if(!this._validate(o.r,t,r))for(const u in t){const d=t[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),d):this._transitionable.setValue(u,d)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,r,u){return(!u||u.validate!==!1)&&o.t(this,t.call(o.u,{value:r,style:{glyphs:!0,sprite:!0},styleSpec:o.v}))}}const Mt=new o.q({"sky-color":new o.D(o.v.sky["sky-color"]),"horizon-color":new o.D(o.v.sky["horizon-color"]),"fog-color":new o.D(o.v.sky["fog-color"]),"fog-ground-blend":new o.D(o.v.sky["fog-ground-blend"]),"horizon-fog-blend":new o.D(o.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new o.D(o.v.sky["sky-horizon-blend"]),"atmosphere-blend":new o.D(o.v.sky["atmosphere-blend"])});class _t extends o.E{constructor(t){super(),this._transitionable=new o.T(Mt),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.z(0))}setSky(t,r={}){if(!this._validate(o.B,t,r)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const u in t){const d=t[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),d):this._transitionable.setValue(u,d)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,r,u={}){return(u==null?void 0:u.validate)!==!1&&o.t(this,t.call(o.u,o.e({value:r,style:{glyphs:!0,sprite:!0},styleSpec:o.v})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class Qe{constructor(t,r){this.width=t,this.height=r,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,r){const u=t.join(",")+String(r);return this.dashEntry[u]||(this.dashEntry[u]=this.addDash(t,r)),this.dashEntry[u]}getDashRanges(t,r,u){const d=[];let y=t.length%2==1?-t[t.length-1]*u:0,x=t[0]*u,S=!0;d.push({left:y,right:x,isDash:S,zeroLength:t[0]===0});let P=t[0];for(let E=1;E<t.length;E++){S=!S;const B=t[E];y=P*u,P+=B,x=P*u,d.push({left:y,right:x,isDash:S,zeroLength:B===0})}return d}addRoundDash(t,r,u){const d=r/2;for(let y=-u;y<=u;y++){const x=this.width*(this.nextRow+u+y);let S=0,P=t[S];for(let E=0;E<this.width;E++){E/P.right>1&&(P=t[++S]);const B=Math.abs(E-P.left),V=Math.abs(E-P.right),j=Math.min(B,V);let X;const Y=y/u*(d+1);if(P.isDash){const le=d-Math.abs(Y);X=Math.sqrt(j*j+le*le)}else X=d-Math.sqrt(j*j+Y*Y);this.data[x+E]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(t){for(let S=t.length-1;S>=0;--S){const P=t[S],E=t[S+1];P.zeroLength?t.splice(S,1):E&&E.isDash===P.isDash&&(E.left=P.left,t.splice(S,1))}const r=t[0],u=t[t.length-1];r.isDash===u.isDash&&(r.left=u.left-this.width,u.right=r.right+this.width);const d=this.width*this.nextRow;let y=0,x=t[y];for(let S=0;S<this.width;S++){S/x.right>1&&(x=t[++y]);const P=Math.abs(S-x.left),E=Math.abs(S-x.right),B=Math.min(P,E);this.data[d+S]=Math.max(0,Math.min(255,(x.isDash?B:-B)+128))}}addDash(t,r){const u=r?7:0,d=2*u+1;if(this.nextRow+d>this.height)return o.w("LineAtlas out of space"),null;let y=0;for(let S=0;S<t.length;S++)y+=t[S];if(y!==0){const S=this.width/y,P=this.getDashRanges(t,this.width,S);r?this.addRoundDash(P,S,u):this.addRegularDash(P)}const x={y:(this.nextRow+u+.5)/this.height,height:2*u/this.height,width:y};return this.nextRow+=d,this.dirty=!0,x}bind(t){const r=t.gl;this.texture?(r.bindTexture(r.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,r.texSubImage2D(r.TEXTURE_2D,0,0,0,this.width,this.height,r.ALPHA,r.UNSIGNED_BYTE,this.data))):(this.texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,this.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.ALPHA,this.width,this.height,0,r.ALPHA,r.UNSIGNED_BYTE,this.data))}}const ct="maplibre_preloaded_worker_pool";class Dt{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Dt.workerCount;)this.workers.push(new Worker(o.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(r=>{r.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ct]}numActive(){return Object.keys(this.active).length}}const Yt=Math.floor(O.hardwareConcurrency/2);let zt,Kt;function Zt(){return zt||(zt=new Dt),zt}Dt.workerCount=o.C(globalThis)?Math.max(Math.min(Yt,3),1):1;class _n{constructor(t,r){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=r;const u=this.workerPool.acquire(r);for(let d=0;d<u.length;d++){const y=new o.F(u[d],r);y.name=`Worker ${d}`,this.actors.push(y)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,r){const u=[];for(const d of this.actors)u.push(d.sendAsync({type:t,data:r}));return Promise.all(u)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach(r=>{r.remove()}),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,r){for(const u of this.actors)u.registerMessageHandler(t,r)}}function bn(){return Kt||(Kt=new _n(Zt(),o.G),Kt.registerMessageHandler("GR",(g,t,r)=>o.m(t,r))),Kt}function Vn(g,t){const r=o.H();return o.J(r,r,[1,1,0]),o.K(r,r,[.5*g.width,.5*g.height,1]),g.calculatePosMatrix?o.L(r,r,g.calculatePosMatrix(t.toUnwrapped())):r}function On(g,t,r,u,d,y){var x;const S=function(V,j,X){if(V)for(const Y of V){const le=j[Y];if(le&&le.source===X&&le.type==="fill-extrusion")return!0}else for(const Y in j){const le=j[Y];if(le.source===X&&le.type==="fill-extrusion")return!0}return!1}((x=d==null?void 0:d.layers)!==null&&x!==void 0?x:null,t,g.id),P=y.maxPitchScaleFactor(),E=g.tilesIn(u,P,S);E.sort(ri);const B=[];for(const V of E)B.push({wrappedTileID:V.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(t,r,g._state,V.queryGeometry,V.cameraQueryGeometry,V.scale,d,y,P,Vn(g.transform,V.tileID))});return function(V,j){for(const X in V)for(const Y of V[X])En(Y,j);return V}(function(V){const j={},X={};for(const Y of V){const le=Y.queryResults,se=Y.wrappedTileID,ce=X[se]=X[se]||{};for(const fe in le){const we=le[fe],Te=ce[fe]=ce[fe]||{},Ie=j[fe]=j[fe]||[];for(const De of we)Te[De.featureIndex]||(Te[De.featureIndex]=!0,Ie.push(De))}}return j}(B),g)}function ri(g,t){const r=g.tileID,u=t.tileID;return r.overscaledZ-u.overscaledZ||r.canonical.y-u.canonical.y||r.wrap-u.wrap||r.canonical.x-u.canonical.x}function En(g,t){const r=g.feature,u=t.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=u}function Pe(g,t,r){return o._(this,void 0,void 0,function*(){let u=g;if(g.url?u=(yield o.h(t.transformRequest(g.url,"Source"),r)).data:yield O.frameAsync(r),!u)return null;const d=o.M(o.e(u,g),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in u&&u.vector_layers&&(d.vectorLayerIds=u.vector_layers.map(y=>y.id)),d})}class Le{constructor(t,r){t&&(r?this.setSouthWest(t).setNorthEast(r):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof o.N?new o.N(t.lng,t.lat):o.N.convert(t),this}setSouthWest(t){return this._sw=t instanceof o.N?new o.N(t.lng,t.lat):o.N.convert(t),this}extend(t){const r=this._sw,u=this._ne;let d,y;if(t instanceof o.N)d=t,y=t;else{if(!(t instanceof Le))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Le.convert(t)):this.extend(o.N.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(o.N.convert(t)):this;if(d=t._sw,y=t._ne,!d||!y)return this}return r||u?(r.lng=Math.min(d.lng,r.lng),r.lat=Math.min(d.lat,r.lat),u.lng=Math.max(y.lng,u.lng),u.lat=Math.max(y.lat,u.lat)):(this._sw=new o.N(d.lng,d.lat),this._ne=new o.N(y.lng,y.lat)),this}getCenter(){return new o.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.N(this.getWest(),this.getNorth())}getSouthEast(){return new o.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:r,lat:u}=o.N.convert(t);let d=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&d}static convert(t){return t instanceof Le?t:t&&new Le(t)}static fromLngLat(t,r=0){const u=360*r/40075017,d=u/Math.cos(Math.PI/180*t.lat);return new Le(new o.N(t.lng-d,t.lat-u),new o.N(t.lng+d,t.lat+u))}adjustAntiMeridian(){const t=new o.N(this._sw.lng,this._sw.lat),r=new o.N(this._ne.lng,this._ne.lat);return new Le(t,t.lng>r.lng?new o.N(r.lng+360,r.lat):r)}}class ot{constructor(t,r,u){this.bounds=Le.convert(this.validateBounds(t)),this.minzoom=r||0,this.maxzoom=u||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const r=Math.pow(2,t.z),u=Math.floor(o.O(this.bounds.getWest())*r),d=Math.floor(o.Q(this.bounds.getNorth())*r),y=Math.ceil(o.O(this.bounds.getEast())*r),x=Math.ceil(o.Q(this.bounds.getSouth())*r);return t.x>=u&&t.x<y&&t.y>=d&&t.y<x}}class xt extends o.E{constructor(t,r,u,d){if(super(),this.id=t,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.M(r,["url","scheme","tileSize","promoteId"])),this._options=o.e({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d)}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield Pe(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(o.e(this,t),t.bounds&&(this.tileBounds=new ot(t.bounds,this.minzoom,this.maxzoom)),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new o.j(t))}})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(t){return o._(this,void 0,void 0,function*(){const r=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u={request:this.map._requestManager.transformRequest(r,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};u.request.collectResourceTiming=this._collectResourceTiming;let d="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise((y,x)=>{t.reloadPromise={resolve:y,reject:x}})}else t.actor=this.dispatcher.getActor(),d="LT";t.abortController=new AbortController;try{const y=yield t.actor.sendAsync({type:d,data:u},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,y)}catch(y){if(delete t.abortController,t.aborted)return;if(y&&y.status!==404)throw y;this._afterTileLoadWorkerResponse(t,null)}})}_afterTileLoadWorkerResponse(t,r){if(r&&r.resourceTiming&&(t.resourceTiming=r.resourceTiming),r&&this.map._refreshExpiredTiles&&t.setExpiryData(r),t.loadVectorData(r,this.map.painter),t.reloadPromise){const u=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(u.resolve).catch(u.reject)}}abortTile(t){return o._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))})}unloadTile(t){return o._(this,void 0,void 0,function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class mt extends o.E{constructor(t,r,u,d){super(),this.id=t,this.dispatcher=u,this.setEventedParent(d),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},r),o.e(this,o.M(r,["url","scheme","tileSize"]))}load(){return o._(this,arguments,void 0,function*(t=!1){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield Pe(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,r&&(o.e(this,r),r.bounds&&(this.tileBounds=new ot(r.bounds,this.minzoom,this.maxzoom)),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:t})))}catch(r){this._tileJSONRequest=null,this.fire(new o.j(r))}})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}serialize(){return o.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return o._(this,void 0,void 0,function*(){const r=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const u=yield pe.getImage(this.map._requestManager.transformRequest(r,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(u&&u.data){this.map._refreshExpiredTiles&&u.cacheControl&&u.expires&&t.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});const d=this.map.painter.context,y=d.gl,x=u.data;t.texture=this.map.painter.getTileTexture(x.width),t.texture?t.texture.update(x,{useMipmap:!0}):(t.texture=new ye(d,x,y.RGBA,{useMipmap:!0}),t.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(u){if(delete t.abortController,t.aborted)t.state="unloaded";else if(u)throw t.state="errored",u}})}abortTile(t){return o._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)})}unloadTile(t){return o._(this,void 0,void 0,function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)})}hasTransition(){return!1}}class vt extends mt{constructor(t,r,u,d){super(t,r,u,d),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox",this.redFactor=r.redFactor,this.greenFactor=r.greenFactor,this.blueFactor=r.blueFactor,this.baseShift=r.baseShift}loadTile(t){return o._(this,void 0,void 0,function*(){const r=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u=this.map._requestManager.transformRequest(r,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const d=yield pe.getImage(u,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(d&&d.data){const y=d.data;this.map._refreshExpiredTiles&&d.cacheControl&&d.expires&&t.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const x=o.b(y)&&o.U()?y:yield this.readImageNow(y),S={type:this.type,uid:t.uid,source:this.id,rawImageData:x,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const P=yield t.actor.sendAsync({type:"LDT",data:S});t.dem=P,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(d){if(delete t.abortController,t.aborted)t.state="unloaded";else if(d)throw t.state="errored",d}})}readImageNow(t){return o._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&o.V()){const r=t.width+2,u=t.height+2;try{return new o.R({width:r,height:u},yield o.W(t,-1,-1,r,u))}catch{}}return O.getImageData(t,1)})}_getNeighboringTiles(t){const r=t.canonical,u=Math.pow(2,r.z),d=(r.x-1+u)%u,y=r.x===0?t.wrap-1:t.wrap,x=(r.x+1+u)%u,S=r.x+1===u?t.wrap+1:t.wrap,P={};return P[new o.S(t.overscaledZ,y,r.z,d,r.y).key]={backfilled:!1},P[new o.S(t.overscaledZ,S,r.z,x,r.y).key]={backfilled:!1},r.y>0&&(P[new o.S(t.overscaledZ,y,r.z,d,r.y-1).key]={backfilled:!1},P[new o.S(t.overscaledZ,t.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},P[new o.S(t.overscaledZ,S,r.z,x,r.y-1).key]={backfilled:!1}),r.y+1<u&&(P[new o.S(t.overscaledZ,y,r.z,d,r.y+1).key]={backfilled:!1},P[new o.S(t.overscaledZ,t.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},P[new o.S(t.overscaledZ,S,r.z,x,r.y+1).key]={backfilled:!1}),P}unloadTile(t){return o._(this,void 0,void 0,function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))})}}class Lt extends o.E{constructor(t,r,u,d){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=u.getActor(),this.setEventedParent(d),this._data=r.data,this._options=o.e({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId,r.clusterMaxZoom!==void 0&&this.maxzoom<=r.clusterMaxZoom&&o.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${r.clusterMaxZoom}".`),this.workerOptions=o.e({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(r.buffer!==void 0?r.buffer:128),tolerance:this._pixelsToTileUnits(r.tolerance!==void 0?r.tolerance:.375),extent:o.X,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:o.X,radius:this._pixelsToTileUnits(r.clusterRadius||50),log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(t){return t*(o.X/this.tileSize)}load(){return o._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}getData(){return o._(this,void 0,void 0,function*(){const t=o.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})})}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(t.clusterRadius)),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=t.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,r,u){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:r,offset:u}})}_updateWorkerData(t){return o._(this,void 0,void 0,function*(){const r=o.e({type:this.type},this.workerOptions);t?r.dataDiff=t:typeof this._data=="string"?(r.request=this.map._requestManager.transformRequest(O.resolveURL(this._data),"Source"),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new o.k("dataloading",{dataType:"source"}));try{const u=yield this.actor.sendAsync({type:"LD",data:r});if(this._pendingLoads--,this._removed||u.abandoned)return void this.fire(new o.k("dataabort",{dataType:"source"}));let d=null;u.resourceTiming&&u.resourceTiming[this.id]&&(d=u.resourceTiming[this.id].slice(0));const y={dataType:"source"};this._collectResourceTiming&&d&&d.length>0&&o.e(y,{resourceTiming:d}),this.fire(new o.k("data",Object.assign(Object.assign({},y),{sourceDataType:"metadata"}))),this.fire(new o.k("data",Object.assign(Object.assign({},y),{sourceDataType:"content"})))}catch(u){if(this._pendingLoads--,this._removed)return void this.fire(new o.k("dataabort",{dataType:"source"}));this.fire(new o.j(u))}})}loaded(){return this._pendingLoads===0}loadTile(t){return o._(this,void 0,void 0,function*(){const r=t.actor?"RT":"LT";t.actor=this.actor;const u={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};t.abortController=new AbortController;const d=yield this.actor.sendAsync({type:r,data:u},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(d,this.map.painter,r==="RT")})}abortTile(t){return o._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0})}unloadTile(t){return o._(this,void 0,void 0,function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class It extends o.E{constructor(t,r,u,d){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=u,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(d),this.options=r}load(t){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const r=yield pe.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,r&&r.data&&(this.image=r.data,t&&(this.coordinates=t),this._finishLoading())}catch(r){this._request=null,this._loaded=!0,this.fire(new o.j(r))}})}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const r=t.map(o.Y.fromLngLat);var u;return this.tileID=function(d){let y=1/0,x=1/0,S=-1/0,P=-1/0;for(const j of d)y=Math.min(y,j.x),x=Math.min(x,j.y),S=Math.max(S,j.x),P=Math.max(P,j.y);const E=Math.max(S-y,P-x),B=Math.max(0,Math.floor(-Math.log(E)/Math.LN2)),V=Math.pow(2,B);return new o.Z(B,Math.floor((y+S)/2*V),Math.floor((x+P)/2*V))}(r),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=r.map(d=>this.tileID.getTilePoint(d)._round()),this.flippedWindingOrder=((u=this.tileCoords)[1].x-u[0].x)*(u[2].y-u[0].y)-(u[1].y-u[0].y)*(u[2].x-u[0].x)<0,this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,r=t.gl;this.texture||(this.texture=new ye(t,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let u=!1;for(const d in this.tiles){const y=this.tiles[d];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,u=!0)}u&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return o._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class At extends It{constructor(t,r,u,d){super(t,r,u,d),this.roundZoom=!0,this.type="video",this.options=r}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const r of t.urls)this.urls.push(this.map._requestManager.transformRequest(r,"Source").url);try{const r=yield o.a0(this.urls);if(this._loaded=!0,!r)return;this.video=r,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(r){this.fire(new o.j(r))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const r=this.video.seekable;t<r.start(0)||t>r.end(0)?this.fire(new o.j(new o.$(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,r=t.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new ye(t,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let u=!1;for(const d in this.tiles){const y=this.tiles[d];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,u=!0)}u&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class wt extends It{constructor(t,r,u,d){super(t,r,u,d),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(x=>typeof x!="number"))||this.fire(new o.j(new o.$(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.j(new o.$(`sources.${t}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new o.j(new o.$(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new o.j(new o.$(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.j(new o.$(`sources.${t}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){return o._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context,u=r.gl;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ye(r,this.canvas,u.RGBA,{premultiply:!0});let d=!1;for(const y in this.tiles){const x=this.tiles[y];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,d=!0)}d&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const en={},Nt=g=>{switch(g){case"geojson":return Lt;case"image":return It;case"raster":return mt;case"raster-dem":return vt;case"vector":return xt;case"video":return At;case"canvas":return wt}return en[g]},Wt="RTLPluginLoaded";class un extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=bn()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch(r=>{throw this.status="error",r})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return o._(this,arguments,void 0,function*(r,u=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=O.resolveURL(r),!this.url)throw new Error(`requested url ${r} is invalid`);if(this.status==="unavailable"){if(!u)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return o._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.k(Wt))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Sn=null;function Dn(){return Sn||(Sn=new un),Sn}class An{constructor(t,r){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=o.a1(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const r=t+this.timeAdded;r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,r,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(d,y){const x={};if(!y)return x;for(const S of d){const P=S.layerIds.map(E=>y.getLayer(E)).filter(Boolean);if(P.length!==0){S.layers=P,S.stateDependentLayerIds&&(S.stateDependentLayers=S.stateDependentLayerIds.map(E=>P.filter(B=>B.id===E)[0]));for(const E of P)x[E.id]=S}}return x}(t.buckets,r==null?void 0:r.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const y=this.buckets[d];if(y instanceof o.a3){if(this.hasSymbolBuckets=!0,!u)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const y=this.buckets[d];if(y instanceof o.a3&&y.hasRTLText){this.hasRTLText=!0,Dn().lazyLoad();break}}this.queryPadding=0;for(const d in this.buckets){const y=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(d).queryRadius(y))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new o.a2}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const u in this.buckets){const d=this.buckets[u];d.uploadPending()&&d.upload(t)}const r=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ye(t,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ye(t,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,r,u,d,y,x,S,P,E,B){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:d,cameraQueryGeometry:y,scale:x,tileSize:this.tileSize,pixelPosMatrix:B,transform:P,params:S,queryPadding:this.queryPadding*E},t,r,u):{}}querySourceFeatures(t,r){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const d=u.loadVTLayers(),y=r&&r.sourceLayer?r.sourceLayer:"",x=d._geojsonTileLayer||d[y];if(!x)return;const S=o.a4(r&&r.filter),{z:P,x:E,y:B}=this.tileID.canonical,V={z:P,x:E,y:B};for(let j=0;j<x.length;j++){const X=x.feature(j);if(S.needGeometry){const se=o.a5(X,!0);if(!S.filter(new o.z(this.tileID.overscaledZ),se,this.tileID.canonical))continue}else if(!S.filter(new o.z(this.tileID.overscaledZ),X))continue;const Y=u.getId(X,y),le=new o.a6(X,P,E,B,Y);le.tile=V,t.push(le)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const r=this.expirationTime;if(t.cacheControl){const u=o.a7(t.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const u=Date.now();let d=!1;if(this.expirationTime>u)d=!1;else if(r)if(this.expirationTime<r)d=!0;else{const y=this.expirationTime-r;y?this.expirationTime=u+Math.max(y,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const u=this.latestFeatureIndex.loadVTLayers();for(const d in this.buckets){if(!r.style.hasLayer(d))continue;const y=this.buckets[d],x=y.layers[0].sourceLayer||"_geojsonTileLayer",S=u[x],P=t[x];if(!S||!P||Object.keys(P).length===0)continue;y.update(P,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});const E=r&&r.style&&r.style.getLayer(d);E&&(this.queryPadding=Math.max(this.queryPadding,E.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<O.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=O.now()+t}setDependencies(t,r){const u={};for(const d of r)u[d]=!0;this.dependencies[t]=u}hasDependency(t,r){for(const u of t){const d=this.dependencies[u];if(d){for(const y of r)if(d[y])return!0}}return!1}}class Ei{constructor(t,r){this.max=t,this.onRemove=r,this.reset()}reset(){for(const t in this.data)for(const r of this.data[t])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(t,r,u){const d=t.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);const y={value:r,timeout:void 0};if(u!==void 0&&(y.timeout=setTimeout(()=>{this.remove(t,y)},u)),this.data[d].push(y),this.order.push(d),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const r=this.data[t].shift();return r.timeout&&clearTimeout(r.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),r.value}getByKey(t){const r=this.data[t];return r?r[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,r){if(!this.has(t))return this;const u=t.wrapped().key,d=r===void 0?0:this.data[u].indexOf(r),y=this.data[u][d];return this.data[u].splice(d,1),y.timeout&&clearTimeout(y.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(y.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(t){const r=[];for(const u in this.data)for(const d of this.data[u])t(d.value)||r.push(d);for(const u of r)this.remove(u.value.tileID,u)}}class Pi{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,r,u){const d=String(r);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][d]=this.stateChanges[t][d]||{},o.e(this.stateChanges[t][d],u),this.deletedStates[t]===null){this.deletedStates[t]={};for(const y in this.state[t])y!==d&&(this.deletedStates[t][y]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][d]===null){this.deletedStates[t][d]={};for(const y in this.state[t][d])u[y]||(this.deletedStates[t][d][y]=null)}else for(const y in u)this.deletedStates[t]&&this.deletedStates[t][d]&&this.deletedStates[t][d][y]===null&&delete this.deletedStates[t][d][y]}removeFeatureState(t,r,u){if(this.deletedStates[t]===null)return;const d=String(r);if(this.deletedStates[t]=this.deletedStates[t]||{},u&&r!==void 0)this.deletedStates[t][d]!==null&&(this.deletedStates[t][d]=this.deletedStates[t][d]||{},this.deletedStates[t][d][u]=null);else if(r!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][d])for(u in this.deletedStates[t][d]={},this.stateChanges[t][d])this.deletedStates[t][d][u]=null;else this.deletedStates[t][d]=null;else this.deletedStates[t]=null}getState(t,r){const u=String(r),d=o.e({},(this.state[t]||{})[u],(this.stateChanges[t]||{})[u]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const y=this.deletedStates[t][r];if(y===null)return{};for(const x in y)delete d[x]}return d}initializeTileState(t,r){t.setFeatureState(this.state,r)}coalesceChanges(t,r){const u={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const y={};for(const x in this.stateChanges[d])this.state[d][x]||(this.state[d][x]={}),o.e(this.state[d][x],this.stateChanges[d][x]),y[x]=this.state[d][x];u[d]=y}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const y={};if(this.deletedStates[d]===null)for(const x in this.state[d])y[x]={},this.state[d][x]={};else for(const x in this.deletedStates[d]){if(this.deletedStates[d][x]===null)this.state[d][x]={};else for(const S of Object.keys(this.deletedStates[d][x]))delete this.state[d][x][S];y[x]=this.state[d][x]}u[d]=u[d]||{},o.e(u[d],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(const d in t)t[d].setFeatureState(u,r)}}function er(g,t,r){const u=t.intersectsFrustum(g);if(!r)return u;const d=t.intersectsPlane(r);return u===0||d===0?0:u===2&&d===2?2:1}function Zi(g,t,r,u,d){let y=g;const x=Math.atan(t/r),S=Math.hypot(t,r);return y=g+o.a8(u/S/Math.max(.5,Math.cos(o.aa(d/2)))),y+=1*o.a8(Math.cos(x))/2,y+=o.ab(g-y,-0,0),y}function Mr(g,t){const r=(t.roundZoom?Math.round:Math.floor)(g.zoom+o.a8(g.tileSize/t.tileSize));return Math.max(0,r)}function ae(g,t){const r=g.getCameraFrustum(),u=g.getClippingPlane(),d=g.screenPointToMercatorCoordinate(g.getCameraPoint()),y=o.Y.fromLngLat(g.center,g.elevation);d.z=y.z+Math.cos(g.pitchInRadians)*g.cameraToCenterDistance/g.worldSize;const x=g.getCoveringTilesDetailsProvider(),S=x.allowVariableZoom(g,t),P=Mr(g,t),E=t.minzoom||0,B=t.maxzoom!==void 0?t.maxzoom:g.maxZoom,V=Math.min(Math.max(0,P),B),j=Math.pow(2,V),X=[j*d.x,j*d.y,0],Y=[j*y.x,j*y.y,0],le=Math.hypot(y.x-d.x,y.y-d.y),se=Math.abs(y.z-d.z),ce=Math.hypot(le,se),fe=Ie=>({zoom:0,x:0,y:0,wrap:Ie,fullyVisible:!1}),we=[],Te=[];if(g.renderWorldCopies&&x.allowWorldCopies())for(let Ie=1;Ie<=3;Ie++)we.push(fe(-Ie)),we.push(fe(Ie));for(we.push(fe(0));we.length>0;){const Ie=we.pop(),De=Ie.x,Re=Ie.y;let Ge=Ie.fullyVisible;const Ze={x:De,y:Re,z:Ie.zoom},rt=x.getTileAABB(Ze,Ie.wrap,g.elevation,t);if(!Ge){const St=er(r,rt,u);if(St===0)continue;Ge=St===2}const lt=x.distanceToTile2d(d.x,d.y,Ze,rt);let et=P;S&&(et=(t.calculateTileZoom||Zi)(g.zoom+o.a8(g.tileSize/t.tileSize),lt,se,ce,g.fov)),et=(t.roundZoom?Math.round:Math.floor)(et),et=Math.max(0,et);const Pt=Math.min(et,B);if(Ie.wrap=x.getWrap(y,Ze,Ie.wrap),Ie.zoom>=Pt){if(Ie.zoom<E)continue;const St=V-Ie.zoom,ft=X[0]-.5-(De<<St),Rt=X[1]-.5-(Re<<St),vn=t.reparseOverscaled?Math.max(Ie.zoom,et):Ie.zoom;Te.push({tileID:new o.S(Ie.zoom===B?vn:Ie.zoom,Ie.wrap,Ie.zoom,De,Re),distanceSq:o.a9([Y[0]-.5-De,Y[1]-.5-Re]),tileDistanceToCamera:Math.sqrt(ft*ft+Rt*Rt)})}else for(let St=0;St<4;St++)we.push({zoom:Ie.zoom+1,x:(De<<1)+St%2,y:(Re<<1)+(St>>1),wrap:Ie.wrap,fullyVisible:Ge})}return Te.sort((Ie,De)=>Ie.distanceSq-De.distanceSq).map(Ie=>Ie.tileID)}class W extends o.E{constructor(t,r,u){super(),this.id=t,this.dispatcher=u,this.on("data",d=>this._dataHandler(d)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((d,y,x,S)=>{const P=new(Nt(y.type))(d,y,x,S);if(P.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${P.id}`);return P})(t,r,u,this),this._tiles={},this._cache=new Ei(0,d=>this._unloadTile(d)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Pi,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const r=this._tiles[t];if(r.state!=="loaded"&&r.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,r,u){return o._(this,void 0,void 0,function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,r,u)}catch(d){t.state="errored",d.status!==404?this._source.fire(new o.j(d,{tile:t})):this.update(this.transform,this.terrain)}})}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new o.k("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){const u=this._tiles[r];u.upload(t),u.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(J).map(t=>t.key)}getRenderableIds(t){const r=[];for(const u in this._tiles)this._isIdRenderable(u,t)&&r.push(this._tiles[u]);return t?r.sort((u,d)=>{const y=u.tileID,x=d.tileID,S=new o.P(y.canonical.x,y.canonical.y)._rotate(-this.transform.bearingInRadians),P=new o.P(x.canonical.x,x.canonical.y)._rotate(-this.transform.bearingInRadians);return y.overscaledZ-x.overscaledZ||P.y-S.y||P.x-S.x}).map(u=>u.tileID.key):r.map(u=>u.tileID).sort(J).map(u=>u.key)}hasRenderableParent(t){const r=this.findLoadedParent(t,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(t,r){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(r||!this._tiles[t].holdingForFade())}reload(t){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)(t||this._tiles[r].state!=="errored")&&this._reloadTile(r,"reloading")}}_reloadTile(t,r){return o._(this,void 0,void 0,function*(){const u=this._tiles[t];u&&(u.state!=="loading"&&(u.state=r),yield this._loadTile(u,t,r))})}_tileLoaded(t,r,u){t.timeAdded=O.now(),u==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(r,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new o.k("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const r=this.getRenderableIds();for(let d=0;d<r.length;d++){const y=r[d];if(t.neighboringTiles&&t.neighboringTiles[y]){const x=this.getTileByID(y);u(t,x),u(x,t)}}function u(d,y){d.needsHillshadePrepare=!0,d.needsTerrainPrepare=!0;let x=y.tileID.canonical.x-d.tileID.canonical.x;const S=y.tileID.canonical.y-d.tileID.canonical.y,P=Math.pow(2,d.tileID.canonical.z),E=y.tileID.key;x===0&&S===0||Math.abs(S)>1||(Math.abs(x)>1&&(Math.abs(x+P)===1?x+=P:Math.abs(x-P)===1&&(x-=P)),y.dem&&d.dem&&(d.dem.backfillBorder(y.dem,x,S),d.neighboringTiles&&d.neighboringTiles[E]&&(d.neighboringTiles[E].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,r,u,d){for(const y in this._tiles){let x=this._tiles[y];if(d[y]||!x.hasData()||x.tileID.overscaledZ<=r||x.tileID.overscaledZ>u)continue;let S=x.tileID;for(;x&&x.tileID.overscaledZ>r+1;){const E=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[E.key],x&&x.hasData()&&(S=E)}let P=S;for(;P.overscaledZ>r;)if(P=P.scaledTo(P.overscaledZ-1),t[P.key]||t[P.canonical.key]){d[S.key]=S;break}}}findLoadedParent(t,r){if(t.key in this._loadedParentTiles){const u=this._loadedParentTiles[t.key];return u&&u.tileID.overscaledZ>=r?u:null}for(let u=t.overscaledZ-1;u>=r;u--){const d=t.scaledTo(u),y=this._getLoadedTile(d);if(y)return y}}findLoadedSibling(t){return this._getLoadedTile(t)}_getLoadedTile(t){const r=this._tiles[t.key];return r&&r.hasData()?r:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const r=Math.ceil(t.width/this._source.tileSize)+1,u=Math.ceil(t.height/this._source.tileSize)+1,d=Math.floor(r*u*(this._maxTileCacheZoomLevels===null?o.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._cache.setMaxSize(y)}handleWrapJump(t){const r=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,r){const u={};for(const d in this._tiles){const y=this._tiles[d];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+r),u[y.tileID.key]=y}this._tiles=u;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(d,this._tiles[d])}}_updateCoveredAndRetainedTiles(t,r,u,d,y,x){const S={},P={},E=Object.keys(t),B=O.now();for(const V of E){const j=t[V],X=this._tiles[V];if(!X||X.fadeEndTime!==0&&X.fadeEndTime<=B)continue;const Y=this.findLoadedParent(j,r),le=this.findLoadedSibling(j),se=Y||le||null;se&&(this._addTile(se.tileID),S[se.tileID.key]=se.tileID),P[V]=j}this._retainLoadedChildren(P,d,u,t);for(const V in S)t[V]||(this._coveredTiles[V]=!0,t[V]=S[V]);if(x){const V={},j={};for(const X of y)this._tiles[X.key].hasData()?V[X.key]=X:j[X.key]=X;for(const X in j){const Y=j[X].children(this._source.maxzoom);this._tiles[Y[0].key]&&this._tiles[Y[1].key]&&this._tiles[Y[2].key]&&this._tiles[Y[3].key]&&(V[Y[0].key]=t[Y[0].key]=Y[0],V[Y[1].key]=t[Y[1].key]=Y[1],V[Y[2].key]=t[Y[2].key]=Y[2],V[Y[3].key]=t[Y[3].key]=Y[3],delete j[X])}for(const X in j){const Y=j[X],le=this.findLoadedParent(Y,this._source.minzoom),se=this.findLoadedSibling(Y),ce=le||se||null;if(ce){V[ce.tileID.key]=t[ce.tileID.key]=ce.tileID;for(const fe in V)V[fe].isChildOf(ce.tileID)&&delete V[fe]}}for(const X in this._tiles)V[X]||(this._coveredTiles[X]=!0)}}update(t,r){if(!this._sourceLoaded||this._paused)return;let u;this.transform=t,this.terrain=r,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(B=>new o.S(B.canonical.z,B.wrap,B.canonical.z,B.canonical.x,B.canonical.y)):(u=ae(t,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:r,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(u=u.filter(B=>this._source.hasTile(B)))):u=[];const d=Mr(t,this._source),y=Math.max(d-W.maxOverzooming,this._source.minzoom),x=Math.max(d+W.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const B={};for(const V of u)if(V.canonical.z>this._source.minzoom){const j=V.scaledTo(V.canonical.z-1);B[j.key]=j;const X=V.scaledTo(Math.max(this._source.minzoom,Math.min(V.canonical.z,5)));B[X.key]=X}u=u.concat(Object.values(B))}const S=u.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,S&&this.fire(new o.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const P=this._updateRetainedTiles(u,d);te(this._source.type)&&this._updateCoveredAndRetainedTiles(P,y,x,d,u,r);for(const B in P)this._tiles[B].clearFadeHold();const E=o.ac(this._tiles,P);for(const B of E){const V=this._tiles[B];V.hasSymbolBuckets&&!V.holdingForFade()?V.setHoldDuration(this.map._fadeDuration):V.hasSymbolBuckets&&!V.symbolFadeFinished()||this._removeTile(B)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,r){var u;const d={},y={},x=Math.max(r-W.maxOverzooming,this._source.minzoom),S=Math.max(r+W.maxUnderzooming,this._source.minzoom),P={};for(const E of t){const B=this._addTile(E);d[E.key]=E,B.hasData()||r<this._source.maxzoom&&(P[E.key]=E)}this._retainLoadedChildren(P,r,S,d);for(const E of t){let B=this._tiles[E.key];if(B.hasData())continue;if(r+1>this._source.maxzoom){const j=E.children(this._source.maxzoom)[0],X=this.getTile(j);if(X&&X.hasData()){d[j.key]=j;continue}}else{const j=E.children(this._source.maxzoom);if(d[j[0].key]&&d[j[1].key]&&d[j[2].key]&&d[j[3].key])continue}let V=B.wasRequested();for(let j=E.overscaledZ-1;j>=x;--j){const X=E.scaledTo(j);if(y[X.key])break;if(y[X.key]=!0,B=this.getTile(X),!B&&V&&(B=this._addTile(X)),B){const Y=B.hasData();if((Y||!(!((u=this.map)===null||u===void 0)&&u.cancelPendingTileRequestsWhileZooming)||V)&&(d[X.key]=X),V=B.wasRequested(),Y)break}}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const r=[];let u,d=this._tiles[t].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){u=this._loadedParentTiles[d.key];break}r.push(d.key);const y=d.scaledTo(d.overscaledZ-1);if(u=this._getLoadedTile(y),u)break;d=y}for(const y of r)this._loadedParentTiles[y]=u}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const t in this._tiles){const r=this._tiles[t].tileID,u=this._getLoadedTile(r);this._loadedSiblingTiles[r.key]=u}}_addTile(t){let r=this._tiles[t.key];if(r)return r;r=this._cache.getAndRemove(t),r&&(this._setTileReloadTimer(t.key,r),r.tileID=t,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,r)));const u=r;return r||(r=new An(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(r,t.key,r.state)),r.uses++,this._tiles[t.key]=r,u||this._source.fire(new o.k("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r}_setTileReloadTimer(t,r){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const u=r.getExpiryTimeout();u&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},u))}_removeTile(t){const r=this._tiles[t];r&&(r.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),r.uses>0||(r.hasData()&&r.state!=="reloading"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}_dataHandler(t){const r=t.sourceDataType;t.dataType==="source"&&r==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&t.dataType==="source"&&r==="content"&&(this.reload(t.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,r,u){const d=[],y=this.transform;if(!y)return d;const x=u?y.getCameraQueryGeometry(t):t,S=t.map(Y=>y.screenPointToMercatorCoordinate(Y,this.terrain)),P=x.map(Y=>y.screenPointToMercatorCoordinate(Y,this.terrain)),E=this.getIds();let B=1/0,V=1/0,j=-1/0,X=-1/0;for(const Y of P)B=Math.min(B,Y.x),V=Math.min(V,Y.y),j=Math.max(j,Y.x),X=Math.max(X,Y.y);for(let Y=0;Y<E.length;Y++){const le=this._tiles[E[Y]];if(le.holdingForFade())continue;const se=le.tileID,ce=Math.pow(2,y.zoom-le.tileID.overscaledZ),fe=r*le.queryPadding*o.X/le.tileSize/ce,we=[se.getTilePoint(new o.Y(B,V)),se.getTilePoint(new o.Y(j,X))];if(we[0].x-fe<o.X&&we[0].y-fe<o.X&&we[1].x+fe>=0&&we[1].y+fe>=0){const Te=S.map(De=>se.getTilePoint(De)),Ie=P.map(De=>se.getTilePoint(De));d.push({tile:le,tileID:se,queryGeometry:Te,cameraQueryGeometry:Ie,scale:ce})}}return d}getVisibleCoordinates(t){const r=this.getRenderableIds(t).map(u=>this._tiles[u].tileID);return this.transform&&this.transform.populateCache(r),r}hasTransition(){if(this._source.hasTransition())return!0;if(te(this._source.type)){const t=O.now();for(const r in this._tiles)if(this._tiles[r].fadeEndTime>=t)return!0}return!1}setFeatureState(t,r,u){this._state.updateState(t=t||"_geojsonTileLayer",r,u)}removeFeatureState(t,r,u){this._state.removeFeatureState(t=t||"_geojsonTileLayer",r,u)}getFeatureState(t,r){return this._state.getState(t=t||"_geojsonTileLayer",r)}setDependencies(t,r,u){const d=this._tiles[t];d&&d.setDependencies(r,u)}reloadTilesForDependencies(t,r){for(const u in this._tiles)this._tiles[u].hasDependency(t,r)&&this._reloadTile(u,"reloading");this._cache.filter(u=>!u.hasDependency(t,r))}}function J(g,t){const r=Math.abs(2*g.wrap)-+(g.wrap<0),u=Math.abs(2*t.wrap)-+(t.wrap<0);return g.overscaledZ-t.overscaledZ||u-r||t.canonical.y-g.canonical.y||t.canonical.x-g.canonical.x}function te(g){return g==="raster"||g==="image"||g==="video"}W.maxOverzooming=10,W.maxUnderzooming=3;class me{constructor(t,r){this.reset(t,r)}reset(t,r){this.points=t||[],this._distances=[0];for(let u=1;u<this.points.length;u++)this._distances[u]=this._distances[u-1]+this.points[u].dist(this.points[u-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(r||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=o.ab(t,0,1);let r=1,u=this._distances[r];const d=t*this.paddedLength+this.padding;for(;u<d&&r<this._distances.length;)u=this._distances[++r];const y=r-1,x=this._distances[y],S=u-x,P=S>0?(d-x)/S:0;return this.points[y].mult(1-P).add(this.points[r].mult(P))}}function Ae(g,t){let r=!0;return g==="always"||g!=="never"&&t!=="never"||(r=!1),r}class Ve{constructor(t,r,u){const d=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(t/u),this.yCellCount=Math.ceil(r/u);for(let x=0;x<this.xCellCount*this.yCellCount;x++)d.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=r,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,r,u,d,y){this._forEachCell(r,u,d,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(r),this.bboxes.push(u),this.bboxes.push(d),this.bboxes.push(y)}insertCircle(t,r,u,d){this._forEachCell(r-d,u-d,r+d,u+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(r),this.circles.push(u),this.circles.push(d)}_insertBoxCell(t,r,u,d,y,x){this.boxCells[y].push(x)}_insertCircleCell(t,r,u,d,y,x){this.circleCells[y].push(x)}_query(t,r,u,d,y,x,S){if(u<0||t>this.width||d<0||r>this.height)return[];const P=[];if(t<=0&&r<=0&&this.width<=u&&this.height<=d){if(y)return[{key:null,x1:t,y1:r,x2:u,y2:d}];for(let E=0;E<this.boxKeys.length;E++)P.push({key:this.boxKeys[E],x1:this.bboxes[4*E],y1:this.bboxes[4*E+1],x2:this.bboxes[4*E+2],y2:this.bboxes[4*E+3]});for(let E=0;E<this.circleKeys.length;E++){const B=this.circles[3*E],V=this.circles[3*E+1],j=this.circles[3*E+2];P.push({key:this.circleKeys[E],x1:B-j,y1:V-j,x2:B+j,y2:V+j})}}else this._forEachCell(t,r,u,d,this._queryCell,P,{hitTest:y,overlapMode:x,seenUids:{box:{},circle:{}}},S);return P}query(t,r,u,d){return this._query(t,r,u,d,!1,null)}hitTest(t,r,u,d,y,x){return this._query(t,r,u,d,!0,y,x).length>0}hitTestCircle(t,r,u,d,y){const x=t-u,S=t+u,P=r-u,E=r+u;if(S<0||x>this.width||E<0||P>this.height)return!1;const B=[];return this._forEachCell(x,P,S,E,this._queryCellCircle,B,{hitTest:!0,overlapMode:d,circle:{x:t,y:r,radius:u},seenUids:{box:{},circle:{}}},y),B.length>0}_queryCell(t,r,u,d,y,x,S,P){const{seenUids:E,hitTest:B,overlapMode:V}=S,j=this.boxCells[y];if(j!==null){const Y=this.bboxes;for(const le of j)if(!E.box[le]){E.box[le]=!0;const se=4*le,ce=this.boxKeys[le];if(t<=Y[se+2]&&r<=Y[se+3]&&u>=Y[se+0]&&d>=Y[se+1]&&(!P||P(ce))&&(!B||!Ae(V,ce.overlapMode))&&(x.push({key:ce,x1:Y[se],y1:Y[se+1],x2:Y[se+2],y2:Y[se+3]}),B))return!0}}const X=this.circleCells[y];if(X!==null){const Y=this.circles;for(const le of X)if(!E.circle[le]){E.circle[le]=!0;const se=3*le,ce=this.circleKeys[le];if(this._circleAndRectCollide(Y[se],Y[se+1],Y[se+2],t,r,u,d)&&(!P||P(ce))&&(!B||!Ae(V,ce.overlapMode))){const fe=Y[se],we=Y[se+1],Te=Y[se+2];if(x.push({key:ce,x1:fe-Te,y1:we-Te,x2:fe+Te,y2:we+Te}),B)return!0}}}return!1}_queryCellCircle(t,r,u,d,y,x,S,P){const{circle:E,seenUids:B,overlapMode:V}=S,j=this.boxCells[y];if(j!==null){const Y=this.bboxes;for(const le of j)if(!B.box[le]){B.box[le]=!0;const se=4*le,ce=this.boxKeys[le];if(this._circleAndRectCollide(E.x,E.y,E.radius,Y[se+0],Y[se+1],Y[se+2],Y[se+3])&&(!P||P(ce))&&!Ae(V,ce.overlapMode))return x.push(!0),!0}}const X=this.circleCells[y];if(X!==null){const Y=this.circles;for(const le of X)if(!B.circle[le]){B.circle[le]=!0;const se=3*le,ce=this.circleKeys[le];if(this._circlesCollide(Y[se],Y[se+1],Y[se+2],E.x,E.y,E.radius)&&(!P||P(ce))&&!Ae(V,ce.overlapMode))return x.push(!0),!0}}}_forEachCell(t,r,u,d,y,x,S,P){const E=this._convertToXCellCoord(t),B=this._convertToYCellCoord(r),V=this._convertToXCellCoord(u),j=this._convertToYCellCoord(d);for(let X=E;X<=V;X++)for(let Y=B;Y<=j;Y++)if(y.call(this,t,r,u,d,this.xCellCount*Y+X,x,S,P))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,r,u,d,y,x){const S=d-t,P=y-r,E=u+x;return E*E>S*S+P*P}_circleAndRectCollide(t,r,u,d,y,x,S){const P=(x-d)/2,E=Math.abs(t-(d+P));if(E>P+u)return!1;const B=(S-y)/2,V=Math.abs(r-(y+B));if(V>B+u)return!1;if(E<=P||V<=B)return!0;const j=E-P,X=V-B;return j*j+X*X<=u*u}}function qe(g,t,r){const u=o.H();if(!g){const{vecSouth:V,vecEast:j}=it(t),X=k();X[0]=j[0],X[1]=j[1],X[2]=V[0],X[3]=V[1],d=X,(B=(x=(y=X)[0])*(E=y[3])-(P=y[2])*(S=y[1]))&&(d[0]=E*(B=1/B),d[1]=-S*B,d[2]=-P*B,d[3]=x*B),u[0]=X[0],u[1]=X[1],u[4]=X[2],u[5]=X[3]}var d,y,x,S,P,E,B;return o.K(u,u,[1/r,1/r,1]),u}function Oe(g,t,r,u){if(g){const d=o.H();if(!t){const{vecSouth:y,vecEast:x}=it(r);d[0]=x[0],d[1]=x[1],d[4]=y[0],d[5]=y[1]}return o.K(d,d,[u,u,1]),d}return r.pixelsToClipSpaceMatrix}function it(g){const t=Math.cos(g.rollInRadians),r=Math.sin(g.rollInRadians),u=Math.cos(g.pitchInRadians),d=Math.cos(g.bearingInRadians),y=Math.sin(g.bearingInRadians),x=o.ad();x[0]=-d*u*r-y*t,x[1]=-y*u*r+d*t;const S=o.ae(x);S<1e-9?o.af(x):o.ag(x,x,1/S);const P=o.ad();P[0]=d*u*t-y*r,P[1]=y*u*t+d*r;const E=o.ae(P);return E<1e-9?o.af(P):o.ag(P,P,1/E),{vecEast:P,vecSouth:x}}function Je(g,t,r,u){let d;u?(d=[g,t,u(g,t),1],o.al(d,d,r)):(d=[g,t,0,1],Vi(d,d,r));const y=d[3];return{point:new o.P(d[0]/y,d[1]/y),signedDistanceFromCamera:y,isOccluded:!1}}function Ue(g,t){return .5+g/t*.5}function Be(g,t){return g.x>=-t[0]&&g.x<=t[0]&&g.y>=-t[1]&&g.y<=t[1]}function kt(g,t,r,u,d,y,x,S,P,E,B,V,j){const X=r?g.textSizeData:g.iconSizeData,Y=o.ah(X,t.transform.zoom),le=[256/t.width*2+1,256/t.height*2+1],se=r?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;se.clear();const ce=g.lineVertexArray,fe=r?g.text.placedSymbolArray:g.icon.placedSymbolArray,we=t.transform.width/t.transform.height;let Te=!1;for(let Ie=0;Ie<fe.length;Ie++){const De=fe.get(Ie);if(De.hidden||De.writingMode===o.ai.vertical&&!Te){qi(De.numGlyphs,se);continue}Te=!1;const Re=new o.P(De.anchorX,De.anchorY),Ge={getElevation:j,pitchedLabelPlaneMatrix:u,lineVertexArray:ce,pitchWithMap:y,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:t.transform,tileAnchorPoint:Re,unwrappedTileID:P,width:E,height:B,translation:V},Ze=zn(De.anchorX,De.anchorY,Ge);if(!Be(Ze.point,le)){qi(De.numGlyphs,se);continue}const rt=Ue(t.transform.cameraToCenterDistance,Ze.signedDistanceFromCamera),lt=o.aj(X,Y,De),et=y?lt*t.transform.getPitchedTextCorrection(De.anchorX,De.anchorY,P)/rt:lt*rt,Pt=pn({projectionContext:Ge,pitchedLabelPlaneMatrixInverse:d,symbol:De,fontSize:et,flip:!1,keepUpright:x,glyphOffsetArray:g.glyphOffsetArray,dynamicLayoutVertexArray:se,aspectRatio:we,rotateToLine:S});Te=Pt.useVertical,(Pt.notEnoughRoom||Te||Pt.needsFlipping&&pn({projectionContext:Ge,pitchedLabelPlaneMatrixInverse:d,symbol:De,fontSize:et,flip:!0,keepUpright:x,glyphOffsetArray:g.glyphOffsetArray,dynamicLayoutVertexArray:se,aspectRatio:we,rotateToLine:S}).notEnoughRoom)&&qi(De.numGlyphs,se)}r?g.text.dynamicLayoutVertexBuffer.updateData(se):g.icon.dynamicLayoutVertexBuffer.updateData(se)}function Tt(g,t,r,u,d,y,x,S){const P=y.glyphStartIndex+y.numGlyphs,E=y.lineStartIndex,B=y.lineStartIndex+y.lineLength,V=t.getoffsetX(y.glyphStartIndex),j=t.getoffsetX(P-1),X=ki(g*V,r,u,d,y.segment,E,B,S,x);if(!X)return null;const Y=ki(g*j,r,u,d,y.segment,E,B,S,x);return Y?S.projectionCache.anyProjectionOccluded?null:{first:X,last:Y}:null}function tn(g,t,r,u){return g===o.ai.horizontal&&Math.abs(r.y-t.y)>Math.abs(r.x-t.x)*u?{useVertical:!0}:(g===o.ai.vertical?t.y<r.y:t.x>r.x)?{needsFlipping:!0}:null}function pn(g){const{projectionContext:t,pitchedLabelPlaneMatrixInverse:r,symbol:u,fontSize:d,flip:y,keepUpright:x,glyphOffsetArray:S,dynamicLayoutVertexArray:P,aspectRatio:E,rotateToLine:B}=g,V=d/24,j=u.lineOffsetX*V,X=u.lineOffsetY*V;let Y;if(u.numGlyphs>1){const le=u.glyphStartIndex+u.numGlyphs,se=u.lineStartIndex,ce=u.lineStartIndex+u.lineLength,fe=Tt(V,S,j,X,y,u,B,t);if(!fe)return{notEnoughRoom:!0};const we=Cn(fe.first.point.x,fe.first.point.y,t,r),Te=Cn(fe.last.point.x,fe.last.point.y,t,r);if(x&&!y){const Ie=tn(u.writingMode,we,Te,E);if(Ie)return Ie}Y=[fe.first];for(let Ie=u.glyphStartIndex+1;Ie<le-1;Ie++)Y.push(ki(V*S.getoffsetX(Ie),j,X,y,u.segment,se,ce,t,B));Y.push(fe.last)}else{if(x&&!y){const se=jt(t.tileAnchorPoint.x,t.tileAnchorPoint.y,t).point,ce=u.lineStartIndex+u.segment+1,fe=new o.P(t.lineVertexArray.getx(ce),t.lineVertexArray.gety(ce)),we=jt(fe.x,fe.y,t),Te=we.signedDistanceFromCamera>0?we.point:st(t.tileAnchorPoint,fe,se,1,t),Ie=Cn(se.x,se.y,t,r),De=Cn(Te.x,Te.y,t,r),Re=tn(u.writingMode,Ie,De,E);if(Re)return Re}const le=ki(V*S.getoffsetX(u.glyphStartIndex),j,X,y,u.segment,u.lineStartIndex,u.lineStartIndex+u.lineLength,t,B);if(!le||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Y=[le]}for(const le of Y)o.ak(P,le.point,le.angle);return{}}function st(g,t,r,u,d){const y=g.add(g.sub(t)._unit()),x=jt(y.x,y.y,d).point,S=r.sub(x);return r.add(S._mult(u/S.mag()))}function Et(g,t,r){const u=t.projectionCache;if(u.projections[g])return u.projections[g];const d=new o.P(t.lineVertexArray.getx(g),t.lineVertexArray.gety(g)),y=jt(d.x,d.y,t);if(y.signedDistanceFromCamera>0)return u.projections[g]=y.point,u.anyProjectionOccluded=u.anyProjectionOccluded||y.isOccluded,y.point;const x=g-r.direction;return st(r.distanceFromAnchor===0?t.tileAnchorPoint:new o.P(t.lineVertexArray.getx(x),t.lineVertexArray.gety(x)),d,r.previousVertex,r.absOffsetX-r.distanceFromAnchor+1,t)}function jt(g,t,r){const u=g+r.translation[0],d=t+r.translation[1];let y;return r.pitchWithMap?(y=Je(u,d,r.pitchedLabelPlaneMatrix,r.getElevation),y.isOccluded=!1):(y=r.transform.projectTileCoordinates(u,d,r.unwrappedTileID,r.getElevation),y.point.x=(.5*y.point.x+.5)*r.width,y.point.y=(.5*-y.point.y+.5)*r.height),y}function Cn(g,t,r,u){if(r.pitchWithMap){const d=[g,t,0,1];return o.al(d,d,u),r.transform.projectTileCoordinates(d[0]/d[3],d[1]/d[3],r.unwrappedTileID,r.getElevation).point}return{x:g/r.width*2-1,y:t/r.height*2-1}}function zn(g,t,r){return r.transform.projectTileCoordinates(g,t,r.unwrappedTileID,r.getElevation)}function on(g,t,r){return g._unit()._perp()._mult(t*r)}function Ot(g,t,r,u,d,y,x,S,P){if(S.projectionCache.offsets[g])return S.projectionCache.offsets[g];const E=r.add(t);if(g+P.direction<u||g+P.direction>=d)return S.projectionCache.offsets[g]=E,E;const B=Et(g+P.direction,S,P),V=on(B.sub(r),x,P.direction),j=r.add(V),X=B.add(V);return S.projectionCache.offsets[g]=o.am(y,E,j,X)||E,S.projectionCache.offsets[g]}function ki(g,t,r,u,d,y,x,S,P){const E=u?g-t:g+t;let B=E>0?1:-1,V=0;u&&(B*=-1,V=Math.PI),B<0&&(V+=Math.PI);let j,X=B>0?y+d:y+d+1;S.projectionCache.cachedAnchorPoint?j=S.projectionCache.cachedAnchorPoint:(j=jt(S.tileAnchorPoint.x,S.tileAnchorPoint.y,S).point,S.projectionCache.cachedAnchorPoint=j);let Y,le,se=j,ce=j,fe=0,we=0;const Te=Math.abs(E),Ie=[];let De;for(;fe+we<=Te;){if(X+=B,X<y||X>=x)return null;fe+=we,ce=se,le=Y;const Ze={absOffsetX:Te,direction:B,distanceFromAnchor:fe,previousVertex:ce};if(se=Et(X,S,Ze),r===0)Ie.push(ce),De=se.sub(ce);else{let rt;const lt=se.sub(ce);rt=lt.mag()===0?on(Et(X+B,S,Ze).sub(se),r,B):on(lt,r,B),le||(le=ce.add(rt)),Y=Ot(X,rt,se,y,x,le,r,S,Ze),Ie.push(le),De=Y.sub(le)}we=De.mag()}const Re=De._mult((Te-fe)/we)._add(le||ce),Ge=V+Math.atan2(se.y-ce.y,se.x-ce.x);return Ie.push(Re),{point:Re,angle:P?Ge:0,path:Ie}}const os=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function qi(g,t){for(let r=0;r<g;r++){const u=t.length;t.resize(u+4),t.float32.set(os,3*u)}}function Vi(g,t,r){const u=t[0],d=t[1];return g[0]=r[0]*u+r[4]*d+r[12],g[1]=r[1]*u+r[5]*d+r[13],g[3]=r[3]*u+r[7]*d+r[15],g}const ui=100;class Or{constructor(t,r=new Ve(t.width+200,t.height+200,25),u=new Ve(t.width+200,t.height+200,25)){this.transform=t,this.grid=r,this.ignoredGrid=u,this.pitchFactor=Math.cos(t.pitch*Math.PI/180)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+ui,this.screenBottomBoundary=t.height+ui,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,r,u,d,y,x,S,P,E,B,V,j){const X=this.projectAndGetPerspectiveRatio(t.anchorPointX+P[0],t.anchorPointY+P[1],y,B,j),Y=u*X.perspectiveRatio;let le;if(x||S)le=this._projectCollisionBox(t,Y,d,y,x,S,P,X,B,V,j);else{const De=X.x+(V?V.x*Y:0),Re=X.y+(V?V.y*Y:0);le={allPointsOccluded:!1,box:[De+t.x1*Y,Re+t.y1*Y,De+t.x2*Y,Re+t.y2*Y]}}const[se,ce,fe,we]=le.box,Te=x?le.allPointsOccluded:X.isOccluded;let Ie=Te;return Ie||(Ie=X.perspectiveRatio<this.perspectiveRatioCutoff),Ie||(Ie=!this.isInsideGrid(se,ce,fe,we)),Ie||r!=="always"&&this.grid.hitTest(se,ce,fe,we,r,E)?{box:[se,ce,fe,we],placeable:!1,offscreen:!1,occluded:Te}:{box:[se,ce,fe,we],placeable:!0,offscreen:this.isOffscreen(se,ce,fe,we),occluded:Te}}placeCollisionCircles(t,r,u,d,y,x,S,P,E,B,V,j,X,Y){const le=[],se=new o.P(r.anchorX,r.anchorY),ce=this.getPerspectiveRatio(se.x,se.y,x,Y),fe=(E?y*this.transform.getPitchedTextCorrection(r.anchorX,r.anchorY,x)/ce:y*ce)/o.as,we={getElevation:Y,pitchedLabelPlaneMatrix:S,lineVertexArray:u,pitchWithMap:E,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:se,unwrappedTileID:x,width:this.transform.width,height:this.transform.height,translation:X},Te=Tt(fe,d,r.lineOffsetX*fe,r.lineOffsetY*fe,!1,r,!1,we);let Ie=!1,De=!1,Re=!0;if(Te){const Ge=.5*V*ce+j,Ze=new o.P(-100,-100),rt=new o.P(this.screenRightBoundary,this.screenBottomBoundary),lt=new me,et=Te.first,Pt=Te.last;let St=[];for(let vn=et.path.length-1;vn>=1;vn--)St.push(et.path[vn]);for(let vn=1;vn<Pt.path.length;vn++)St.push(Pt.path[vn]);const ft=2.5*Ge;if(E){const vn=this.projectPathToScreenSpace(St,we);St=vn.some(Bn=>Bn.signedDistanceFromCamera<=0)?[]:vn.map(Bn=>Bn.point)}let Rt=[];if(St.length>0){const vn=St[0].clone(),Bn=St[0].clone();for(let pi=1;pi<St.length;pi++)vn.x=Math.min(vn.x,St[pi].x),vn.y=Math.min(vn.y,St[pi].y),Bn.x=Math.max(Bn.x,St[pi].x),Bn.y=Math.max(Bn.y,St[pi].y);Rt=vn.x>=Ze.x&&Bn.x<=rt.x&&vn.y>=Ze.y&&Bn.y<=rt.y?[St]:Bn.x<Ze.x||vn.x>rt.x||Bn.y<Ze.y||vn.y>rt.y?[]:o.ao([St],Ze.x,Ze.y,rt.x,rt.y)}for(const vn of Rt){lt.reset(vn,.25*Ge);let Bn=0;Bn=lt.length<=.5*Ge?1:Math.ceil(lt.paddedLength/ft)+1;for(let pi=0;pi<Bn;pi++){const qn=pi/Math.max(Bn-1,1),mi=lt.lerp(qn),Wn=mi.x+ui,Gn=mi.y+ui;le.push(Wn,Gn,Ge,0);const Xn=Wn-Ge,or=Gn-Ge,Ni=Wn+Ge,$i=Gn+Ge;if(Re=Re&&this.isOffscreen(Xn,or,Ni,$i),De=De||this.isInsideGrid(Xn,or,Ni,$i),t!=="always"&&this.grid.hitTestCircle(Wn,Gn,Ge,t,B)&&(Ie=!0,!P))return{circles:[],offscreen:!1,collisionDetected:Ie}}}}return{circles:!P&&Ie||!De||ce<this.perspectiveRatioCutoff?[]:le,offscreen:Re,collisionDetected:Ie}}projectPathToScreenSpace(t,r){const u=function(d,y){const x=o.H();return o.an(x,y.pitchedLabelPlaneMatrix),d.map(S=>{const P=Je(S.x,S.y,x,y.getElevation),E=y.transform.projectTileCoordinates(P.point.x,P.point.y,y.unwrappedTileID,y.getElevation);return E.point.x=(.5*E.point.x+.5)*y.width,E.point.y=(.5*-E.point.y+.5)*y.height,E})}(t,r);return function(d){let y=0,x=0,S=0,P=0;for(let E=0;E<d.length;E++)d[E].isOccluded?(S=E+1,P=0):(P++,P>x&&(x=P,y=S));return d.slice(y,y+x)}(u)}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const r=[];let u=1/0,d=1/0,y=-1/0,x=-1/0;for(const B of t){const V=new o.P(B.x+ui,B.y+ui);u=Math.min(u,V.x),d=Math.min(d,V.y),y=Math.max(y,V.x),x=Math.max(x,V.y),r.push(V)}const S=this.grid.query(u,d,y,x).concat(this.ignoredGrid.query(u,d,y,x)),P={},E={};for(const B of S){const V=B.key;if(P[V.bucketInstanceId]===void 0&&(P[V.bucketInstanceId]={}),P[V.bucketInstanceId][V.featureIndex])continue;const j=[new o.P(B.x1,B.y1),new o.P(B.x2,B.y1),new o.P(B.x2,B.y2),new o.P(B.x1,B.y2)];o.ap(r,j)&&(P[V.bucketInstanceId][V.featureIndex]=!0,E[V.bucketInstanceId]===void 0&&(E[V.bucketInstanceId]=[]),E[V.bucketInstanceId].push(V.featureIndex))}return E}insertCollisionBox(t,r,u,d,y,x){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:y,collisionGroupID:x,overlapMode:r},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,r,u,d,y,x){const S=u?this.ignoredGrid:this.grid,P={bucketInstanceId:d,featureIndex:y,collisionGroupID:x,overlapMode:r};for(let E=0;E<t.length;E+=4)S.insertCircle(P,t[E],t[E+1],t[E+2])}projectAndGetPerspectiveRatio(t,r,u,d,y){if(y){let x;d?(x=[t,r,d(t,r),1],o.al(x,x,y)):(x=[t,r,0,1],Vi(x,x,y));const S=x[3];return{x:(x[0]/S+1)/2*this.transform.width+ui,y:(-x[1]/S+1)/2*this.transform.height+ui,perspectiveRatio:.5+this.transform.cameraToCenterDistance/S*.5,isOccluded:!1,signedDistanceFromCamera:S}}{const x=this.transform.projectTileCoordinates(t,r,u,d);return{x:(x.point.x+1)/2*this.transform.width+ui,y:(1-x.point.y)/2*this.transform.height+ui,perspectiveRatio:.5+this.transform.cameraToCenterDistance/x.signedDistanceFromCamera*.5,isOccluded:x.isOccluded,signedDistanceFromCamera:x.signedDistanceFromCamera}}}getPerspectiveRatio(t,r,u,d){const y=this.transform.projectTileCoordinates(t,r,u,d);return .5+this.transform.cameraToCenterDistance/y.signedDistanceFromCamera*.5}isOffscreen(t,r,u,d){return u<ui||t>=this.screenRightBoundary||d<ui||r>this.screenBottomBoundary}isInsideGrid(t,r,u,d){return u>=0&&t<this.gridRightBoundary&&d>=0&&r<this.gridBottomBoundary}getViewportMatrix(){const t=o.aq([]);return o.J(t,t,[-100,-100,0]),t}_projectCollisionBox(t,r,u,d,y,x,S,P,E,B,V){let j=1,X=0,Y=0,le=1;const se=t.anchorPointX+S[0],ce=t.anchorPointY+S[1];if(x&&!y){const St=this.projectAndGetPerspectiveRatio(se+1,ce,d,E,V),ft=St.x-P.x,Rt=Math.atan((St.y-P.y)/ft)+(ft<0?Math.PI:0),vn=Math.sin(Rt),Bn=Math.cos(Rt);j=Bn,X=vn,Y=-vn,le=Bn}else if(!x&&y){const St=it(this.transform);j=St.vecEast[0],X=St.vecEast[1],Y=St.vecSouth[0],le=St.vecSouth[1]}let fe=P.x,we=P.y,Te=r;y&&(fe=se,we=ce,Te=Math.pow(2,-(this.transform.zoom-u.overscaledZ)),Te*=this.transform.getPitchedTextCorrection(se,ce,d),B||(Te*=o.ab(.5+P.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),B&&(fe+=j*B.x*Te+Y*B.y*Te,we+=X*B.x*Te+le*B.y*Te);const Ie=t.x1*Te,De=t.x2*Te,Re=(Ie+De)/2,Ge=t.y1*Te,Ze=t.y2*Te,rt=(Ge+Ze)/2,lt=[{offsetX:Ie,offsetY:Ge},{offsetX:Re,offsetY:Ge},{offsetX:De,offsetY:Ge},{offsetX:De,offsetY:rt},{offsetX:De,offsetY:Ze},{offsetX:Re,offsetY:Ze},{offsetX:Ie,offsetY:Ze},{offsetX:Ie,offsetY:rt}];let et=[];for(const{offsetX:St,offsetY:ft}of lt)et.push(new o.P(fe+j*St+Y*ft,we+X*St+le*ft));let Pt=!1;if(y){const St=et.map(ft=>this.projectAndGetPerspectiveRatio(ft.x,ft.y,d,E,V));Pt=St.some(ft=>!ft.isOccluded),et=St.map(ft=>new o.P(ft.x,ft.y))}else Pt=!0;return{box:o.ar(et),allPointsOccluded:!Pt}}}class hi{constructor(t,r,u,d){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?r:-r))):d&&u?1:0,this.placed=u}isHidden(){return this.opacity===0&&!this.placed}}class el{constructor(t,r,u,d,y){this.text=new hi(t?t.text:null,r,u,y),this.icon=new hi(t?t.icon:null,r,d,y)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ho{constructor(t,r,u){this.text=t,this.icon=r,this.skipFade=u}}class Su{constructor(t,r,u,d,y){this.bucketInstanceId=t,this.featureIndex=r,this.sourceLayerIndex=u,this.bucketIndex=d,this.tileID=y}}class Is{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const r=++this.maxGroupID;this.collisionGroups[t]={ID:r,predicate:u=>u.collisionGroupID===r}}return this.collisionGroups[t]}}function Ms(g,t,r,u,d){const{horizontalAlign:y,verticalAlign:x}=o.ay(g);return new o.P(-(y-.5)*t+u[0]*d,-(x-.5)*r+u[1]*d)}class $d{constructor(t,r,u,d,y){this.transform=t.clone(),this.terrain=r,this.collisionIndex=new Or(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new Is(d),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const r=this.terrain;return r?(u,d)=>r.getElevation(t,u,d):null}getBucketParts(t,r,u,d){const y=u.getBucket(r),x=u.latestFeatureIndex;if(!y||!x||r.id!==y.layerIds[0])return;const S=u.collisionBoxArray,P=y.layers[0].layout,E=y.layers[0].paint,B=Math.pow(2,this.transform.zoom-u.tileID.overscaledZ),V=u.tileSize/o.X,j=u.tileID.toUnwrapped(),X=P.get("text-rotation-alignment")==="map",Y=o.at(u,1,this.transform.zoom),le=o.au(this.collisionIndex.transform,u,E.get("text-translate"),E.get("text-translate-anchor")),se=o.au(this.collisionIndex.transform,u,E.get("icon-translate"),E.get("icon-translate-anchor")),ce=qe(X,this.transform,Y);this.retainedQueryData[y.bucketInstanceId]=new Su(y.bucketInstanceId,x,y.sourceLayerIndex,y.index,u.tileID);const fe={bucket:y,layout:P,translationText:le,translationIcon:se,unwrappedTileID:j,pitchedLabelPlaneMatrix:ce,scale:B,textPixelRatio:V,holdingForFade:u.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:o.ah(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(d)for(const we of y.sortKeyRanges){const{sortKey:Te,symbolInstanceStart:Ie,symbolInstanceEnd:De}=we;t.push({sortKey:Te,symbolInstanceStart:Ie,symbolInstanceEnd:De,parameters:fe})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:fe})}attemptAnchorPlacement(t,r,u,d,y,x,S,P,E,B,V,j,X,Y,le,se,ce,fe,we,Te){const Ie=o.av[t.textAnchor],De=[t.textOffset0,t.textOffset1],Re=Ms(Ie,u,d,De,y),Ge=this.collisionIndex.placeCollisionBox(r,j,P,E,B,S,x,se,V.predicate,we,Re,Te);if((!fe||this.collisionIndex.placeCollisionBox(fe,j,P,E,B,S,x,ce,V.predicate,we,Re,Te).placeable)&&Ge.placeable){let Ze;if(this.prevPlacement&&this.prevPlacement.variableOffsets[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID].text&&(Ze=this.prevPlacement.variableOffsets[X.crossTileID].anchor),X.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[X.crossTileID]={textOffset:De,width:u,height:d,anchor:Ie,textBoxScale:y,prevAnchor:Ze},this.markUsedJustification(Y,Ie,X,le),Y.allowVerticalPlacement&&(this.markUsedOrientation(Y,le,X),this.placedOrientations[X.crossTileID]=le),{shift:Re,placedGlyphBoxes:Ge}}}placeLayerBucketPart(t,r,u){const{bucket:d,layout:y,translationText:x,translationIcon:S,unwrappedTileID:P,pitchedLabelPlaneMatrix:E,textPixelRatio:B,holdingForFade:V,collisionBoxArray:j,partiallyEvaluatedTextSize:X,collisionGroup:Y}=t.parameters,le=y.get("text-optional"),se=y.get("icon-optional"),ce=o.aw(y,"text-overlap","text-allow-overlap"),fe=ce==="always",we=o.aw(y,"icon-overlap","icon-allow-overlap"),Te=we==="always",Ie=y.get("text-rotation-alignment")==="map",De=y.get("text-pitch-alignment")==="map",Re=y.get("icon-text-fit")!=="none",Ge=y.get("symbol-z-order")==="viewport-y",Ze=fe&&(Te||!d.hasIconData()||se),rt=Te&&(fe||!d.hasTextData()||le);!d.collisionArrays&&j&&d.deserializeCollisionBoxes(j);const lt=this.retainedQueryData[d.bucketInstanceId].tileID,et=this._getTerrainElevationFunc(lt),Pt=this.transform.getFastPathSimpleProjectionMatrix(lt),St=(ft,Rt,vn)=>{var Bn,pi;if(r[ft.crossTileID])return;if(V)return void(this.placements[ft.crossTileID]=new ho(!1,!1,!1));let qn=!1,mi=!1,Wn=!0,Gn=null,Xn={box:null,placeable:!1,offscreen:null,occluded:!1},or={box:null,placeable:!1,offscreen:null},Ni=null,$i=null,wr=null,Wa=0,Ea=0,Nr=0;Rt.textFeatureIndex?Wa=Rt.textFeatureIndex:ft.useRuntimeCollisionCircles&&(Wa=ft.featureIndex),Rt.verticalTextFeatureIndex&&(Ea=Rt.verticalTextFeatureIndex);const Xa=Rt.textBox;if(Xa){const Ar=Kn=>{let gi=o.ai.horizontal;if(d.allowVerticalPlacement&&!Kn&&this.prevPlacement){const jr=this.prevPlacement.placedOrientations[ft.crossTileID];jr&&(this.placedOrientations[ft.crossTileID]=jr,gi=jr,this.markUsedOrientation(d,gi,ft))}return gi},na=(Kn,gi)=>{if(d.allowVerticalPlacement&&ft.numVerticalGlyphVertices>0&&Rt.verticalTextBox){for(const jr of d.writingModes)if(jr===o.ai.vertical?(Xn=gi(),or=Xn):Xn=Kn(),Xn&&Xn.placeable)break}else Xn=Kn()},ia=ft.textAnchorOffsetStartIndex,$r=ft.textAnchorOffsetEndIndex;if($r===ia){const Kn=(gi,jr)=>{const xi=this.collisionIndex.placeCollisionBox(gi,ce,B,lt,P,De,Ie,x,Y.predicate,et,void 0,Pt);return xi&&xi.placeable&&(this.markUsedOrientation(d,jr,ft),this.placedOrientations[ft.crossTileID]=jr),xi};na(()=>Kn(Xa,o.ai.horizontal),()=>{const gi=Rt.verticalTextBox;return d.allowVerticalPlacement&&ft.numVerticalGlyphVertices>0&&gi?Kn(gi,o.ai.vertical):{box:null,offscreen:null}}),Ar(Xn&&Xn.placeable)}else{let Kn=o.av[(pi=(Bn=this.prevPlacement)===null||Bn===void 0?void 0:Bn.variableOffsets[ft.crossTileID])===null||pi===void 0?void 0:pi.anchor];const gi=(xi,ig,Nf)=>{const xh=xi.x2-xi.x1,$f=xi.y2-xi.y1,Hs=ft.textBoxScale,Zs=Re&&we==="never"?ig:null;let fs=null,jf=ce==="never"?1:2,Nc="never";Kn&&jf++;for(let wh=0;wh<jf;wh++){for(let Sh=ia;Sh<$r;Sh++){const Ch=d.textAnchorOffsets.get(Sh);if(Kn&&Ch.textAnchor!==Kn)continue;const Th=this.attemptAnchorPlacement(Ch,xi,xh,$f,Hs,Ie,De,B,lt,P,Y,Nc,ft,d,Nf,x,S,Zs,et);if(Th&&(fs=Th.placedGlyphBoxes,fs&&fs.placeable))return qn=!0,Gn=Th.shift,fs}Kn?Kn=null:Nc=ce}return u&&!fs&&(fs={box:this.collisionIndex.placeCollisionBox(Xa,"always",B,lt,P,De,Ie,x,Y.predicate,et,void 0,Pt).box,offscreen:!1,placeable:!1,occluded:!1}),fs};na(()=>gi(Xa,Rt.iconBox,o.ai.horizontal),()=>{const xi=Rt.verticalTextBox;return d.allowVerticalPlacement&&(!Xn||!Xn.placeable)&&ft.numVerticalGlyphVertices>0&&xi?gi(xi,Rt.verticalIconBox,o.ai.vertical):{box:null,occluded:!0,offscreen:null}}),Xn&&(qn=Xn.placeable,Wn=Xn.offscreen);const jr=Ar(Xn&&Xn.placeable);if(!qn&&this.prevPlacement){const xi=this.prevPlacement.variableOffsets[ft.crossTileID];xi&&(this.variableOffsets[ft.crossTileID]=xi,this.markUsedJustification(d,xi.anchor,ft,jr))}}}if(Ni=Xn,qn=Ni&&Ni.placeable,Wn=Ni&&Ni.offscreen,ft.useRuntimeCollisionCircles){const Ar=d.text.placedSymbolArray.get(ft.centerJustifiedTextSymbolIndex),na=o.aj(d.textSizeData,X,Ar),ia=y.get("text-padding");$i=this.collisionIndex.placeCollisionCircles(ce,Ar,d.lineVertexArray,d.glyphOffsetArray,na,P,E,u,De,Y.predicate,ft.collisionCircleDiameter,ia,x,et),$i.circles.length&&$i.collisionDetected&&!u&&o.w("Collisions detected, but collision boxes are not shown"),qn=fe||$i.circles.length>0&&!$i.collisionDetected,Wn=Wn&&$i.offscreen}if(Rt.iconFeatureIndex&&(Nr=Rt.iconFeatureIndex),Rt.iconBox){const Ar=na=>this.collisionIndex.placeCollisionBox(na,we,B,lt,P,De,Ie,S,Y.predicate,et,Re&&Gn?Gn:void 0,Pt);or&&or.placeable&&Rt.verticalIconBox?(wr=Ar(Rt.verticalIconBox),mi=wr.placeable):(wr=Ar(Rt.iconBox),mi=wr.placeable),Wn=Wn&&wr.offscreen}const Il=le||ft.numHorizontalGlyphVertices===0&&ft.numVerticalGlyphVertices===0,Ml=se||ft.numIconVertices===0;Il||Ml?Ml?Il||(mi=mi&&qn):qn=mi&&qn:mi=qn=mi&&qn;const Ro=mi&&wr.placeable;if(qn&&Ni.placeable&&this.collisionIndex.insertCollisionBox(Ni.box,ce,y.get("text-ignore-placement"),d.bucketInstanceId,or&&or.placeable&&Ea?Ea:Wa,Y.ID),Ro&&this.collisionIndex.insertCollisionBox(wr.box,we,y.get("icon-ignore-placement"),d.bucketInstanceId,Nr,Y.ID),$i&&qn&&this.collisionIndex.insertCollisionCircles($i.circles,ce,y.get("text-ignore-placement"),d.bucketInstanceId,Wa,Y.ID),u&&this.storeCollisionData(d.bucketInstanceId,vn,Rt,Ni,wr,$i),ft.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(d.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ft.crossTileID]=new ho((qn||Ze)&&!(Ni!=null&&Ni.occluded),(mi||rt)&&!(wr!=null&&wr.occluded),Wn||d.justReloaded),r[ft.crossTileID]=!0};if(Ge){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const ft=d.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Rt=ft.length-1;Rt>=0;--Rt){const vn=ft[Rt];St(d.symbolInstances.get(vn),d.collisionArrays[vn],vn)}}else for(let ft=t.symbolInstanceStart;ft<t.symbolInstanceEnd;ft++)St(d.symbolInstances.get(ft),d.collisionArrays[ft],ft);d.justReloaded=!1}storeCollisionData(t,r,u,d,y,x){if(u.textBox||u.iconBox){let S,P;this.collisionBoxArrays.has(t)?S=this.collisionBoxArrays.get(t):(S=new Map,this.collisionBoxArrays.set(t,S)),S.has(r)?P=S.get(r):(P={text:null,icon:null},S.set(r,P)),u.textBox&&(P.text=d.box),u.iconBox&&(P.icon=y.box)}if(x){let S=this.collisionCircleArrays[t];S===void 0&&(S=this.collisionCircleArrays[t]=[]);for(let P=0;P<x.circles.length;P+=4)S.push(x.circles[P+0]-ui),S.push(x.circles[P+1]-ui),S.push(x.circles[P+2]),S.push(x.collisionDetected?1:0)}}markUsedJustification(t,r,u,d){let y;y=d===o.ai.vertical?u.verticalPlacedTextSymbolIndex:{left:u.leftJustifiedTextSymbolIndex,center:u.centerJustifiedTextSymbolIndex,right:u.rightJustifiedTextSymbolIndex}[o.ax(r)];const x=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex,u.verticalPlacedTextSymbolIndex];for(const S of x)S>=0&&(t.text.placedSymbolArray.get(S).crossTileID=y>=0&&S!==y?0:u.crossTileID)}markUsedOrientation(t,r,u){const d=r===o.ai.horizontal||r===o.ai.horizontalOnly?r:0,y=r===o.ai.vertical?r:0,x=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex];for(const S of x)t.text.placedSymbolArray.get(S).placedOrientation=d;u.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(u.verticalPlacedTextSymbolIndex).placedOrientation=y)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const r=this.prevPlacement;let u=!1;this.prevZoomAdjustment=r?r.zoomAdjustment(this.transform.zoom):0;const d=r?r.symbolFadeChange(t):1,y=r?r.opacities:{},x=r?r.variableOffsets:{},S=r?r.placedOrientations:{};for(const P in this.placements){const E=this.placements[P],B=y[P];B?(this.opacities[P]=new el(B,d,E.text,E.icon),u=u||E.text!==B.text.placed||E.icon!==B.icon.placed):(this.opacities[P]=new el(null,d,E.text,E.icon,E.skipFade),u=u||E.text||E.icon)}for(const P in y){const E=y[P];if(!this.opacities[P]){const B=new el(E,d,!1,!1);B.isHidden()||(this.opacities[P]=B,u=u||E.text.placed||E.icon.placed)}}for(const P in x)this.variableOffsets[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.variableOffsets[P]=x[P]);for(const P in S)this.placedOrientations[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.placedOrientations[P]=S[P]);if(r&&r.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");u?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:t)}updateLayerOpacities(t,r){const u={};for(const d of r){const y=d.getBucket(t);y&&d.latestFeatureIndex&&t.id===y.layerIds[0]&&this.updateBucketOpacities(y,d.tileID,u,d.collisionBoxArray)}}updateBucketOpacities(t,r,u,d){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const y=t.layers[0],x=y.layout,S=new el(null,0,!1,!1,!0),P=x.get("text-allow-overlap"),E=x.get("icon-allow-overlap"),B=y._unevaluatedLayout.hasValue("text-variable-anchor")||y._unevaluatedLayout.hasValue("text-variable-anchor-offset"),V=x.get("text-rotation-alignment")==="map",j=x.get("text-pitch-alignment")==="map",X=x.get("icon-text-fit")!=="none",Y=new el(null,0,P&&(E||!t.hasIconData()||x.get("icon-optional")),E&&(P||!t.hasTextData()||x.get("text-optional")),!0);!t.collisionArrays&&d&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(d);const le=(ce,fe,we)=>{for(let Te=0;Te<fe/4;Te++)ce.opacityVertexArray.emplaceBack(we);ce.hasVisibleVertices=ce.hasVisibleVertices||we!==Es},se=this.collisionBoxArrays.get(t.bucketInstanceId);for(let ce=0;ce<t.symbolInstances.length;ce++){const fe=t.symbolInstances.get(ce),{numHorizontalGlyphVertices:we,numVerticalGlyphVertices:Te,crossTileID:Ie}=fe;let De=this.opacities[Ie];u[Ie]?De=S:De||(De=Y,this.opacities[Ie]=De),u[Ie]=!0;const Re=fe.numIconVertices>0,Ge=this.placedOrientations[fe.crossTileID],Ze=Ge===o.ai.vertical,rt=Ge===o.ai.horizontal||Ge===o.ai.horizontalOnly;if(we>0||Te>0){const et=Tu(De.text);le(t.text,we,Ze?Es:et),le(t.text,Te,rt?Es:et);const Pt=De.text.isHidden();[fe.rightJustifiedTextSymbolIndex,fe.centerJustifiedTextSymbolIndex,fe.leftJustifiedTextSymbolIndex].forEach(Rt=>{Rt>=0&&(t.text.placedSymbolArray.get(Rt).hidden=Pt||Ze?1:0)}),fe.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(fe.verticalPlacedTextSymbolIndex).hidden=Pt||rt?1:0);const St=this.variableOffsets[fe.crossTileID];St&&this.markUsedJustification(t,St.anchor,fe,Ge);const ft=this.placedOrientations[fe.crossTileID];ft&&(this.markUsedJustification(t,"left",fe,ft),this.markUsedOrientation(t,ft,fe))}if(Re){const et=Tu(De.icon),Pt=!(X&&fe.verticalPlacedIconSymbolIndex&&Ze);fe.placedIconSymbolIndex>=0&&(le(t.icon,fe.numIconVertices,Pt?et:Es),t.icon.placedSymbolArray.get(fe.placedIconSymbolIndex).hidden=De.icon.isHidden()),fe.verticalPlacedIconSymbolIndex>=0&&(le(t.icon,fe.numVerticalIconVertices,Pt?Es:et),t.icon.placedSymbolArray.get(fe.verticalPlacedIconSymbolIndex).hidden=De.icon.isHidden())}const lt=se&&se.has(ce)?se.get(ce):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const et=t.collisionArrays[ce];if(et){let Pt=new o.P(0,0);if(et.textBox||et.verticalTextBox){let St=!0;if(B){const ft=this.variableOffsets[Ie];ft?(Pt=Ms(ft.anchor,ft.width,ft.height,ft.textOffset,ft.textBoxScale),V&&Pt._rotate(j?-this.transform.bearingInRadians:this.transform.bearingInRadians)):St=!1}if(et.textBox||et.verticalTextBox){let ft;et.textBox&&(ft=Ze),et.verticalTextBox&&(ft=rt),Cu(t.textCollisionBox.collisionVertexArray,De.text.placed,!St||ft,lt.text,Pt.x,Pt.y)}}if(et.iconBox||et.verticalIconBox){const St=!!(!rt&&et.verticalIconBox);let ft;et.iconBox&&(ft=St),et.verticalIconBox&&(ft=!St),Cu(t.iconCollisionBox.collisionVertexArray,De.icon.placed,ft,lt.icon,X?Pt.x:0,X?Pt.y:0)}}}}if(t.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);t.bucketInstanceId in this.collisionCircleArrays&&(t.collisionCircleArray=this.collisionCircleArrays[t.bucketInstanceId],delete this.collisionCircleArrays[t.bucketInstanceId])}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,r){const u=this.zoomAtLastRecencyCheck===r?1-this.zoomAdjustment(r):1;return this.zoomAtLastRecencyCheck=r,this.commitTime+this.fadeDuration*u>t}setStale(){this.stale=!0}}function Cu(g,t,r,u,d,y){u&&u.length!==0||(u=[0,0,0,0]);const x=u[0]-ui,S=u[1]-ui,P=u[2]-ui,E=u[3]-ui;g.emplaceBack(t?1:0,r?1:0,d||0,y||0,x,S),g.emplaceBack(t?1:0,r?1:0,d||0,y||0,P,S),g.emplaceBack(t?1:0,r?1:0,d||0,y||0,P,E),g.emplaceBack(t?1:0,r?1:0,d||0,y||0,x,E)}const jd=Math.pow(2,25),fo=Math.pow(2,24),Ud=Math.pow(2,17),Fm=Math.pow(2,16),Om=Math.pow(2,9),Vm=Math.pow(2,8),Gd=Math.pow(2,1);function Tu(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const t=g.placed?1:0,r=Math.floor(127*g.opacity);return r*jd+t*fo+r*Ud+t*Fm+r*Om+t*Vm+r*Gd+t}const Es=0;class Pu{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,r,u,d,y){const x=this._bucketParts;for(;this._currentTileIndex<t.length;)if(r.getBucketParts(x,d,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort((S,P)=>S.sortKey-P.sortKey));this._currentPartIndex<x.length;)if(r.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,u),this._currentPartIndex++,y())return!0;return!1}}class Hd{constructor(t,r,u,d,y,x,S,P){this.placement=new $d(t,r,x,S,P),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(t,r,u){const d=O.now(),y=()=>!this._forceFullPlacement&&O.now()-d>2;for(;this._currentPlacementIndex>=0;){const x=r[t[this._currentPlacementIndex]],S=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=S)&&(!x.maxzoom||x.maxzoom>S)){if(this._inProgressLayer||(this._inProgressLayer=new Pu(x)),this._inProgressLayer.continuePlacement(u[x.source],this.placement,this._showCollisionBoxes,x,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const As=512/o.X/2;class ku{constructor(t,r,u){this.tileID=t,this.bucketInstanceId=u,this._symbolsByKey={};const d=new Map;for(let y=0;y<r.length;y++){const x=r.get(y),S=x.key,P=d.get(S);P?P.push(x):d.set(S,[x])}for(const[y,x]of d){const S={positions:x.map(P=>({x:Math.floor(P.anchorX*As),y:Math.floor(P.anchorY*As)})),crossTileIDs:x.map(P=>P.crossTileID)};if(S.positions.length>128){const P=new o.az(S.positions.length,16,Uint16Array);for(const{x:E,y:B}of S.positions)P.add(E,B);P.finish(),delete S.positions,S.index=P}this._symbolsByKey[y]=S}}getScaledCoordinates(t,r){const{x:u,y:d,z:y}=this.tileID.canonical,{x,y:S,z:P}=r.canonical,E=As/Math.pow(2,P-y),B=(S*o.X+t.anchorY)*E,V=d*o.X*As;return{x:Math.floor((x*o.X+t.anchorX)*E-u*o.X*As),y:Math.floor(B-V)}}findMatches(t,r,u){const d=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z);for(let y=0;y<t.length;y++){const x=t.get(y);if(x.crossTileID)continue;const S=this._symbolsByKey[x.key];if(!S)continue;const P=this.getScaledCoordinates(x,r);if(S.index){const E=S.index.range(P.x-d,P.y-d,P.x+d,P.y+d).sort();for(const B of E){const V=S.crossTileIDs[B];if(!u[V]){u[V]=!0,x.crossTileID=V;break}}}else if(S.positions)for(let E=0;E<S.positions.length;E++){const B=S.positions[E],V=S.crossTileIDs[E];if(Math.abs(B.x-P.x)<=d&&Math.abs(B.y-P.y)<=d&&!u[V]){u[V]=!0,x.crossTileID=V;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:t})=>t)}}class ic{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Zd{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const r=Math.round((t-this.lng)/360);if(r!==0)for(const u in this.indexes){const d=this.indexes[u],y={};for(const x in d){const S=d[x];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+r),y[S.tileID.key]=S}this.indexes[u]=y}this.lng=t}addBucket(t,r,u){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===r.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let y=0;y<r.symbolInstances.length;y++)r.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const d=this.usedCrossTileIDs[t.overscaledZ];for(const y in this.indexes){const x=this.indexes[y];if(Number(y)>t.overscaledZ)for(const S in x){const P=x[S];P.tileID.isChildOf(t)&&P.findMatches(r.symbolInstances,t,d)}else{const S=x[t.scaledTo(Number(y)).key];S&&S.findMatches(r.symbolInstances,t,d)}}for(let y=0;y<r.symbolInstances.length;y++){const x=r.symbolInstances.get(y);x.crossTileID||(x.crossTileID=u.generate(),d[x.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new ku(t,r.symbolInstances,r.bucketInstanceId),!0}removeBucketCrossTileIDs(t,r){for(const u of r.getCrossTileIDsLists())for(const d of u)delete this.usedCrossTileIDs[t][d]}removeStaleBuckets(t){let r=!1;for(const u in this.indexes){const d=this.indexes[u];for(const y in d)t[d[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(u,d[y]),delete d[y],r=!0)}return r}}class Rs{constructor(){this.layerIndexes={},this.crossTileIDs=new ic,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,r,u){let d=this.layerIndexes[t.id];d===void 0&&(d=this.layerIndexes[t.id]=new Zd);let y=!1;const x={};d.handleWrapJump(u);for(const S of r){const P=S.getBucket(t);P&&t.id===P.layerIds[0]&&(P.bucketInstanceId||(P.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(S.tileID,P,this.crossTileIDs)&&(y=!0),x[P.bucketInstanceId]=!0)}return d.removeStaleBuckets(x)&&(y=!0),y}pruneUnusedLayers(t){const r={};t.forEach(u=>{r[u]=!0});for(const u in this.layerIndexes)r[u]||delete this.layerIndexes[u]}}var Iu="void main() {fragColor=vec4(1.0);}";const Ta={prelude:Tn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Tn("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Tn("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Tn(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Tn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Tn(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Tn(Iu,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Tn(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Tn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Tn("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Tn("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Tn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Tn(Iu,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Tn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Tn(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Tn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Tn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Tn(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Tn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Tn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));fragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Tn(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Tn(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Tn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Tn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Tn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Tn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Tn(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Tn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Tn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Tn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Tn("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Tn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Tn("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Tn(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Tn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Tn(g,t){const r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=t.match(/in ([\w]+) ([\w]+)/g),d=g.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=y?y.concat(d):d,S={};return{fragmentSource:g=g.replace(r,(P,E,B,V,j)=>(S[j]=!0,E==="define"?`
#ifndef HAS_UNIFORM_u_${j}
in ${B} ${V} ${j};
#else
uniform ${B} ${V} u_${j};
#endif
`:`
#ifdef HAS_UNIFORM_u_${j}
    ${B} ${V} ${j} = u_${j};
#endif
`)),vertexSource:t=t.replace(r,(P,E,B,V,j)=>{const X=V==="float"?"vec2":"vec4",Y=j.match(/color/)?"color":X;return S[j]?E==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
in ${B} ${X} a_${j};
out ${B} ${V} ${j};
#else
uniform ${B} ${V} u_${j};
#endif
`:Y==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = a_${j};
#else
    ${B} ${V} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = unpack_mix_${Y}(a_${j}, u_${j}_t);
#else
    ${B} ${V} ${j} = u_${j};
#endif
`:E==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
in ${B} ${X} a_${j};
#else
uniform ${B} ${V} u_${j};
#endif
`:Y==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${B} ${V} ${j} = a_${j};
#else
    ${B} ${V} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${B} ${V} ${j} = unpack_mix_${Y}(a_${j}, u_${j}_t);
#else
    ${B} ${V} ${j} = u_${j};
#endif
`}),staticAttributes:u,staticUniforms:x}}class Pa{constructor(t,r,u){this.vertexBuffer=t,this.indexBuffer=r,this.segments=u}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Pn=o.aA([{name:"a_pos",type:"Int16",components:2}]);const rc="#define PROJECTION_MERCATOR",qd="mercator";class tl{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return qd}get shaderDefine(){return rc}get shaderPreludeCode(){return Ta.projectionMercator}get vertexShaderPreludeCode(){return Ta.projectionMercator.vertexSource}get subdivisionGranularity(){return o.aB.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,r,u,d,y){if(this._cachedMesh)return this._cachedMesh;const x=new o.aC;x.emplaceBack(0,0),x.emplaceBack(o.X,0),x.emplaceBack(0,o.X),x.emplaceBack(o.X,o.X);const S=t.createVertexBuffer(x,Pn.members),P=o.aD.simpleSegment(0,0,4,2),E=new o.aE;E.emplaceBack(1,0,2),E.emplaceBack(1,2,3);const B=t.createIndexBuffer(E);return this._cachedMesh=new Pa(S,B,P),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}}function Ai(g,t){const r=o.ab(t.lat,-85.051129,o.aF);return new o.P(o.O(t.lng)*g,o.Q(r)*g)}function Wi(g,t){return new o.Y(t.x/g,t.y/g).toLngLat()}function bi(g){return g.cameraToCenterDistance*Math.min(.85*Math.tan(o.aa(90-g.pitch)),Math.tan(o.aa(89.25-g.pitch)))}function Mu(g,t){const r=g.canonical,u=t/o.aG(r.z),d=r.x+Math.pow(2,r.z)*g.wrap,y=o.aq(new Float64Array(16));return o.J(y,y,[d*u,r.y*u,0]),o.K(y,y,[u/o.X,u/o.X,1]),y}function fr(g,t,r,u,d){const y=o.Y.fromLngLat(g,t),x=d*o.aH(1,g.lat),S=x*Math.cos(o.aa(r)),P=Math.sqrt(x*x-S*S),E=P*Math.sin(o.aa(-u)),B=P*Math.cos(o.aa(-u));return new o.Y(y.x+E,y.y+B,y.z+S)}class pr{constructor(t=0,r=0,u=0,d=0){if(isNaN(t)||t<0||isNaN(r)||r<0||isNaN(u)||u<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=r,this.left=u,this.right=d}interpolate(t,r,u){return r.top!=null&&t.top!=null&&(this.top=o.y.number(t.top,r.top,u)),r.bottom!=null&&t.bottom!=null&&(this.bottom=o.y.number(t.bottom,r.bottom,u)),r.left!=null&&t.left!=null&&(this.left=o.y.number(t.left,r.left,u)),r.right!=null&&t.right!=null&&(this.right=o.y.number(t.right,r.right,u)),this}getCenter(t,r){const u=o.ab((this.left+t-this.right)/2,0,t),d=o.ab((this.top+r-this.bottom)/2,0,r);return new o.P(u,d)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new pr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function mr(g,t){if(!g.renderWorldCopies||g.lngRange)return;const r=t.lng-g.center.lng;t.lng+=r>180?-360:r<-180?360:0}function Eu(g){return Math.max(0,Math.floor(g))}class Ds{constructor(t,r,u,d,y,x){this._callbacks=t,this._tileSize=512,this._renderWorldCopies=x===void 0||!!x,this._minZoom=r||0,this._maxZoom=u||22,this._minPitch=d??0,this._maxPitch=y??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new o.N(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Eu(this._zoom),this._scale=o.aG(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new pr,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,r,u){this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=Eu(this._zoom),this._scale=o.aG(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new pr(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!u&&t.autoCalculateNearFarZ,r&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){const r=o.aI(t,-180,180)*Math.PI/180;var u,d,y,x,S,P,E,B,V;this._bearingInRadians!==r&&(this._unmodified=!1,this._bearingInRadians=r,this._calcMatrices(),this._rotationMatrix=k(),u=this._rotationMatrix,y=-this._bearingInRadians,x=(d=this._rotationMatrix)[0],S=d[1],P=d[2],E=d[3],B=Math.sin(y),V=Math.cos(y),u[0]=x*V+P*B,u[1]=S*V+E*B,u[2]=x*-B+P*V,u[3]=S*-B+E*V)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){const r=o.ab(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==r&&(this._unmodified=!1,this._pitchInRadians=r,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){const r=t/180*Math.PI;this._rollInRadians!==r&&(this._unmodified=!1,this._rollInRadians=r,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return o.aJ(this._fovInRadians)}setFov(t){t=o.ab(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=o.aa(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){const r=this.getConstrained(this._center,t).zoom;this._zoom!==r&&(this._unmodified=!1,this._zoom=r,this._tileZoom=Math.max(0,Math.floor(r)),this._scale=o.aG(r),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,r){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=r,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,r,u){this._unmodified=!1,this._edgeInsets.interpolate(t,r,u),this._constrain(),this._calcMatrices()}resize(t,r,u=!0){this._width=t,this._height=r,u&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Le([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,o.aF])}getConstrained(t,r){return this._callbacks.getConstrained(t,r)}getCameraQueryGeometry(t,r){if(r.length===1)return[r[0],t];{let u=t.x,d=t.y,y=t.x,x=t.y;for(const S of r)u=Math.min(u,S.x),d=Math.min(d,S.y),y=Math.max(y,S.x),x=Math.max(x,S.y);return[new o.P(u,d),new o.P(y,d),new o.P(y,x),new o.P(u,x),new o.P(u,d)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:r,zoom:u}=this.getConstrained(this.center,this.zoom);this.setCenter(r),this.setZoom(u),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=o.aq(new Float64Array(16));o.K(t,t,[this._width/2,-this._height/2,1]),o.J(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=o.aq(new Float64Array(16)),o.K(t,t,[1,-1,1]),o.J(t,t,[-1,-1,0]),o.K(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,r,u,d){const y=u!==void 0?u:this.bearing,x=d=d!==void 0?d:this.pitch,S=o.Y.fromLngLat(t,r),P=-Math.cos(o.aa(x)),E=Math.sin(o.aa(x)),B=E*Math.sin(o.aa(y)),V=-E*Math.cos(o.aa(y));let j=this.elevation;const X=r-j;let Y;P*X>=0||Math.abs(P)<.1?(Y=1e4,j=r+Y*P):Y=-X/P;let le,se,ce=o.aK(1,S.y),fe=0;do{if(fe+=1,fe>10)break;se=Y/ce,le=new o.Y(S.x+B*se,S.y+V*se),ce=1/le.meterInMercatorCoordinateUnits()}while(Math.abs(Y-se*ce)>1e-12);return{center:le.toLngLat(),elevation:j,zoom:o.a8(this.height/2/Math.tan(this.fovInRadians/2)/se/this.tileSize)}}recalculateZoomAndCenter(t){if(this.elevation-t==0)return;const r=o.aH(1,this.center.lat)*this.worldSize,u=this.cameraToCenterDistance/r,d=o.Y.fromLngLat(this.center,this.elevation),y=fr(this.center,this.elevation,this.pitch,this.bearing,u);this._elevation=t;const x=this.calculateCenterFromCameraLngLatAlt(y.toLngLat(),o.aK(y.z,d.y),this.bearing,this.pitch);this._elevation=x.elevation,this._center=x.center,this.setZoom(x.zoom)}getCameraPoint(){const t=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(t*Math.sin(this.rollInRadians),t*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const t=o.aH(1,this.center.lat)*this.worldSize;return fr(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/t).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];const r=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/r,t.canonical.y/r,1/r/o.X,1/r/o.X]}}class ai{constructor(t,r){this.min=t,this.max=r,this.center=o.aL([],o.aM([],this.min,this.max),.5)}quadrant(t){const r=[t%2==0,t<2],u=o.aN(this.min),d=o.aN(this.max);for(let y=0;y<r.length;y++)u[y]=r[y]?this.min[y]:this.center[y],d[y]=r[y]?this.center[y]:this.max[y];return d[2]=this.max[2],new ai(u,d)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersectsFrustum(t){let r=!0;for(let u=0;u<t.planes.length;u++){const d=this.intersectsPlane(t.planes[u]);if(d===0)return 0;d===1&&(r=!1)}return r?2:t.aabb.min[0]>this.max[0]||t.aabb.min[1]>this.max[1]||t.aabb.min[2]>this.max[2]||t.aabb.max[0]<this.min[0]||t.aabb.max[1]<this.min[1]||t.aabb.max[2]<this.min[2]?0:1}intersectsPlane(t){let r=t[3],u=t[3];for(let d=0;d<3;d++)t[d]>0?(r+=t[d]*this.min[d],u+=t[d]*this.max[d]):(u+=t[d]*this.min[d],r+=t[d]*this.max[d]);return r>=0?2:u<0?0:1}}class nl{distanceToTile2d(t,r,u,d){const y=d.distanceX([t,r]),x=d.distanceY([t,r]);return Math.hypot(y,x)}getWrap(t,r,u){return u}getTileAABB(t,r,u,d){var y,x;let S=u,P=u;if(d.terrain){const B=new o.S(t.z,r,t.z,t.x,t.y),V=d.terrain.getMinMaxElevation(B);S=(y=V.minElevation)!==null&&y!==void 0?y:u,P=(x=V.maxElevation)!==null&&x!==void 0?x:u}const E=1<<t.z;return new ai([r+t.x/E,t.y/E,S],[r+(t.x+1)/E,(t.y+1)/E,P])}allowVariableZoom(t,r){const u=t.fov*(Math.abs(Math.cos(t.rollInRadians))*t.height+Math.abs(Math.sin(t.rollInRadians))*t.width)/t.height,d=o.ab(78.5-u/2,0,60);return!!r.terrain||t.pitch>d||t.padding.top>=.1}allowWorldCopies(){return!0}recalculateCache(){}}class ka{constructor(t,r,u){this.points=t,this.planes=r,this.aabb=u}static fromInvProjectionMatrix(t,r=1,u=0){const d=Math.pow(2,u),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{const B=1/(E=o.al([],E,t))[3]/r*d;return o.aO(E,E,[B,B,1/E[3],B])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{const B=o.aP([],y[E[0]],y[E[1]]),V=o.aP([],y[E[2]],y[E[1]]),j=o.aQ([],o.aR([],B,V)),X=-o.aS(j,y[E[1]]);return j.concat(X)}),S=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],P=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const E of y)for(let B=0;B<3;B++)S[B]=Math.min(S[B],E[B]),P[B]=Math.max(P[B],E[B]);return new ka(y,x,new ai(S,P))}}class ja{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,r,u){return this._helper.interpolatePadding(t,r,u)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,r,u=!0){this._helper.resize(t,r,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,r){this._helper.overrideNearFarZ(t,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t,r){}constructor(t,r,u,d,y){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Ds({calcMatrices:()=>{this._calcMatrices()},getConstrained:(x,S)=>this.getConstrained(x,S)},t,r,u,d,y),this._coveringTilesDetailsProvider=new nl}clone(){const t=new ja;return t.apply(this),t}apply(t,r,u){this._helper.apply(t,r,u)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(t){const r=[new o.aT(0,t)];if(this._helper._renderWorldCopies){const u=this.screenPointToMercatorCoordinate(new o.P(0,0)),d=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,0)),y=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,this._helper._height)),x=this.screenPointToMercatorCoordinate(new o.P(0,this._helper._height)),S=Math.floor(Math.min(u.x,d.x,y.x,x.x)),P=Math.floor(Math.max(u.x,d.x,y.x,x.x)),E=1;for(let B=S-E;B<=P+E;B++)B!==0&&r.push(new o.aT(B,t))}return r}getCameraFrustum(){return ka.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){const r=this.screenPointToLocation(this.centerPoint,t),u=t?t.getElevationForLngLatZoom(r,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(u)}setLocationAtPoint(t,r){const u=o.aH(this.elevation,this.center.lat),d=this.screenPointToMercatorCoordinateAtZ(r,u),y=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,u),x=o.Y.fromLngLat(t),S=new o.Y(x.x-(d.x-y.x),x.y-(d.y-y.y));this.setCenter(S==null?void 0:S.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(t,r){return r?this.coordinatePoint(o.Y.fromLngLat(t),r.getElevationForLngLatZoom(t,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(o.Y.fromLngLat(t))}screenPointToLocation(t,r){var u;return(u=this.screenPointToMercatorCoordinate(t,r))===null||u===void 0?void 0:u.toLngLat()}screenPointToMercatorCoordinate(t,r){if(r){const u=r.pointCoordinate(t);if(u!=null)return u}return this.screenPointToMercatorCoordinateAtZ(t)}screenPointToMercatorCoordinateAtZ(t,r){const u=r||0,d=[t.x,t.y,0,1],y=[t.x,t.y,1,1];o.al(d,d,this._pixelMatrixInverse),o.al(y,y,this._pixelMatrixInverse);const x=d[3],S=y[3],P=d[1]/x,E=y[1]/S,B=d[2]/x,V=y[2]/S,j=B===V?0:(u-B)/(V-B);return new o.Y(o.y.number(d[0]/x,y[0]/S,j)/this.worldSize,o.y.number(P,E,j)/this.worldSize,u)}coordinatePoint(t,r=0,u=this._pixelMatrix){const d=[t.x*this.worldSize,t.y*this.worldSize,r,1];return o.al(d,d,u),new o.P(d[0]/d[3],d[1]/d[3])}getBounds(){const t=Math.max(0,this._helper._height/2-bi(this));return new Le().extend(this.screenPointToLocation(new o.P(0,t))).extend(this.screenPointToLocation(new o.P(this._helper._width,t))).extend(this.screenPointToLocation(new o.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new o.P(0,this._helper._height)))}isPointOnMapSurface(t,r){return r?r.pointCoordinate(t)!=null:t.y>this.height/2-bi(this)}calculatePosMatrix(t,r=!1,u){var d;const y=(d=t.key)!==null&&d!==void 0?d:o.aU(t.wrap,t.canonical.z,t.canonical.z,t.canonical.x,t.canonical.y),x=r?this._alignedPosMatrixCache:this._posMatrixCache;if(x.has(y)){const E=x.get(y);return u?E.f32:E.f64}const S=Mu(t,this.worldSize);o.L(S,r?this._alignedProjMatrix:this._viewProjMatrix,S);const P={f64:S,f32:new Float32Array(S)};return x.set(y,P),u?P.f32:P.f64}calculateFogMatrix(t){const r=t.key,u=this._fogMatrixCacheF32;if(u.has(r))return u.get(r);const d=Mu(t,this.worldSize);return o.L(d,this._fogMatrix,d),u.set(r,new Float32Array(d)),u.get(r)}getConstrained(t,r){r=o.ab(+r,this.minZoom,this.maxZoom);const u={center:new o.N(t.lng,t.lat),zoom:r};let d=this._helper._lngRange;this._helper._renderWorldCopies||d!==null||(d=[-179.9999999999,180-1e-10]);const y=this.tileSize*o.aG(u.zoom);let x=0,S=y,P=0,E=y,B=0,V=0;const{x:j,y:X}=this.size;if(this._helper._latRange){const we=this._helper._latRange;x=o.Q(we[1])*y,S=o.Q(we[0])*y,S-x<X&&(B=X/(S-x))}d&&(P=o.aI(o.O(d[0])*y,0,y),E=o.aI(o.O(d[1])*y,0,y),E<P&&(E+=y),E-P<j&&(V=j/(E-P)));const{x:Y,y:le}=Ai(y,t);let se,ce;const fe=Math.max(V||0,B||0);if(fe){const we=new o.P(V?(E+P)/2:Y,B?(S+x)/2:le);return u.center=Wi(y,we).wrap(),u.zoom+=o.a8(fe),u}if(this._helper._latRange){const we=X/2;le-we<x&&(ce=x+we),le+we>S&&(ce=S-we)}if(d){const we=(P+E)/2;let Te=Y;this._helper._renderWorldCopies&&(Te=o.aI(Y,we-y/2,we+y/2));const Ie=j/2;Te-Ie<P&&(se=P+Ie),Te+Ie>E&&(se=E-Ie)}if(se!==void 0||ce!==void 0){const we=new o.P(se??Y,ce??le);u.center=Wi(y,we).wrap()}return u}calculateCenterFromCameraLngLatAlt(t,r,u,d){return this._helper.calculateCenterFromCameraLngLatAlt(t,r,u,d)}_calculateNearFarZIfNeeded(t,r,u){if(!this._helper.autoCalculateNearFarZ)return;const d=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),y=t-d*this._helper._pixelPerMeter/Math.cos(r),x=d<0?y:t,S=Math.PI/2+this.pitchInRadians,P=o.aa(this.fov)*(Math.abs(Math.cos(o.aa(this.roll)))*this.height+Math.abs(Math.sin(o.aa(this.roll)))*this.width)/this.height*(.5+u.y/this.height),E=Math.sin(P)*x/Math.sin(o.ab(Math.PI-S-P,.01,Math.PI-.01)),B=bi(this),V=Math.atan(B/this._helper.cameraToCenterDistance),j=o.aa(.75),X=V>j?2*V*(.5+u.y/(2*B)):j,Y=Math.sin(X)*x/Math.sin(o.ab(Math.PI-S-X,.01,Math.PI-.01)),le=Math.min(E,Y);this._helper._farZ=1.01*(Math.cos(Math.PI/2-r)*le+x),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const t=this.centerOffset,r=Ai(this.worldSize,this.center),u=r.x,d=r.y;this._helper._pixelPerMeter=o.aH(1,this.center.lat)*this.worldSize;const y=o.aa(Math.min(this.pitch,89.25)),x=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(y));let S;this._calculateNearFarZIfNeeded(x,y,t),S=new Float64Array(16),o.aV(S,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),o.an(this._invProjMatrix,S),S[8]=2*-t.x/this._helper._width,S[9]=2*t.y/this._helper._height,this._projectionMatrix=o.aW(S),o.K(S,S,[1,-1,1]),o.J(S,S,[0,0,-this._helper.cameraToCenterDistance]),o.aX(S,S,-this.rollInRadians),o.aY(S,S,this.pitchInRadians),o.aX(S,S,-this.bearingInRadians),o.J(S,S,[-u,-d,0]),this._mercatorMatrix=o.K([],S,[this.worldSize,this.worldSize,this.worldSize]),o.K(S,S,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=o.L(new Float64Array(16),this.clipSpaceToPixelsMatrix,S),o.J(S,S,[0,0,-this.elevation]),this._viewProjMatrix=S,this._invViewProjMatrix=o.an([],S);const P=[0,0,-1,1];o.al(P,P,this._invViewProjMatrix),this._cameraPosition=[P[0]/P[3],P[1]/P[3],P[2]/P[3]],this._fogMatrix=new Float64Array(16),o.aV(this._fogMatrix,this.fovInRadians,this.width/this.height,x,this._helper._farZ),this._fogMatrix[8]=2*-t.x/this.width,this._fogMatrix[9]=2*t.y/this.height,o.K(this._fogMatrix,this._fogMatrix,[1,-1,1]),o.J(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),o.aX(this._fogMatrix,this._fogMatrix,-this.rollInRadians),o.aY(this._fogMatrix,this._fogMatrix,this.pitchInRadians),o.aX(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),o.J(this._fogMatrix,this._fogMatrix,[-u,-d,0]),o.K(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),o.J(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=o.L(new Float64Array(16),this.clipSpaceToPixelsMatrix,S);const E=this._helper._width%2/2,B=this._helper._height%2/2,V=Math.cos(this.bearingInRadians),j=Math.sin(-this.bearingInRadians),X=u-Math.round(u)+V*E+j*B,Y=d-Math.round(d)+V*B+j*E,le=new Float64Array(S);if(o.J(le,le,[X>.5?X-1:X,Y>.5?Y-1:Y,0]),this._alignedProjMatrix=le,S=o.an(new Float64Array(16),this._pixelMatrix),!S)throw new Error("failed to invert matrix");this._pixelMatrixInverse=S,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const t=this.screenPointToMercatorCoordinate(new o.P(0,0)),r=[t.x*this.worldSize,t.y*this.worldSize,0,1];return o.al(r,r,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const t=o.aH(1,this.center.lat)*this.worldSize;return fr(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/t).toLngLat()}lngLatToCameraDepth(t,r){const u=o.Y.fromLngLat(t),d=[u.x*this.worldSize,u.y*this.worldSize,r,1];return o.al(d,d,this._viewProjMatrix),d[2]/d[3]}getProjectionData(t){const{overscaledTileID:r,aligned:u,applyTerrainMatrix:d}=t,y=this._helper.getMercatorTileCoordinates(r),x=r?this.calculatePosMatrix(r,u,!0):null;let S;return S=r&&r.terrainRttPosMatrix32f&&d?r.terrainRttPosMatrix32f:x||o.aZ(),{mainMatrix:S,tileMercatorCoords:y,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:S}}isLocationOccluded(t){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(t,r,u){return 1}transformLightDirection(t){return o.aN(t)}getRayDirectionFromPixel(t){throw new Error("Not implemented.")}projectTileCoordinates(t,r,u,d){const y=this.calculatePosMatrix(u);let x;d?(x=[t,r,d(t,r),1],o.al(x,x,y)):(x=[t,r,0,1],Vi(x,x,y));const S=x[3];return{point:new o.P(x[0]/S,x[1]/S),signedDistanceFromCamera:S,isOccluded:!1}}populateCache(t){for(const r of t)this.calculatePosMatrix(r)}getMatrixForModel(t,r){const u=o.Y.fromLngLat(t,r),d=u.meterInMercatorCoordinateUnits(),y=o.a_();return o.J(y,y,[u.x,u.y,u.z]),o.aX(y,y,Math.PI),o.aY(y,y,Math.PI/2),o.K(y,y,[-d,d,d]),y}getProjectionDataForCustomLayer(t=!0){const r=new o.S(0,0,0,0,0),u=this.getProjectionData({overscaledTileID:r,applyGlobeMatrix:t}),d=Mu(r,this.worldSize);o.L(d,this._viewProjMatrix,d),u.tileMercatorCoords=[0,0,1,1];const y=[o.X,o.X,this.worldSize/this._helper.pixelsPerMeter],x=o.a$();return o.K(x,d,y),u.fallbackMatrix=x,u.mainMatrix=x,u}getFastPathSimpleProjectionMatrix(t){return this.calculatePosMatrix(t)}}function Jr(){o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Au(g){if(g.useSlerp)if(g.k<1){const t=o.b0(g.startEulerAngles.roll,g.startEulerAngles.pitch,g.startEulerAngles.bearing),r=o.b0(g.endEulerAngles.roll,g.endEulerAngles.pitch,g.endEulerAngles.bearing),u=new Float64Array(4);o.b1(u,t,r,g.k);const d=o.b2(u);g.tr.setRoll(d.roll),g.tr.setPitch(d.pitch),g.tr.setBearing(d.bearing)}else g.tr.setRoll(g.endEulerAngles.roll),g.tr.setPitch(g.endEulerAngles.pitch),g.tr.setBearing(g.endEulerAngles.bearing);else g.tr.setRoll(o.y.number(g.startEulerAngles.roll,g.endEulerAngles.roll,g.k)),g.tr.setPitch(o.y.number(g.startEulerAngles.pitch,g.endEulerAngles.pitch,g.k)),g.tr.setBearing(o.y.number(g.startEulerAngles.bearing,g.endEulerAngles.bearing,g.k))}function Ua(g,t,r,u,d){const y=d.padding,x=Ai(d.worldSize,r.getNorthWest()),S=Ai(d.worldSize,r.getNorthEast()),P=Ai(d.worldSize,r.getSouthEast()),E=Ai(d.worldSize,r.getSouthWest()),B=o.aa(-u),V=x.rotate(B),j=S.rotate(B),X=P.rotate(B),Y=E.rotate(B),le=new o.P(Math.max(V.x,j.x,Y.x,X.x),Math.max(V.y,j.y,Y.y,X.y)),se=new o.P(Math.min(V.x,j.x,Y.x,X.x),Math.min(V.y,j.y,Y.y,X.y)),ce=le.sub(se),fe=(d.width-(y.left+y.right+t.left+t.right))/ce.x,we=(d.height-(y.top+y.bottom+t.top+t.bottom))/ce.y;if(we<0||fe<0)return void Jr();const Te=Math.min(o.a8(d.scale*Math.min(fe,we)),g.maxZoom),Ie=o.P.convert(g.offset),De=new o.P((t.left-t.right)/2,(t.top-t.bottom)/2).rotate(o.aa(u)),Re=Ie.add(De).mult(d.scale/o.aG(Te));return{center:Wi(d.worldSize,x.add(P).div(2).sub(Re)),zoom:Te,bearing:u}}class ac{get useGlobeControls(){return!1}handlePanInertia(t,r){return{easingOffset:t,easingCenter:r.center}}handleMapControlsRollPitchBearingZoom(t,r){t.bearingDelta&&r.setBearing(r.bearing+t.bearingDelta),t.pitchDelta&&r.setPitch(r.pitch+t.pitchDelta),t.rollDelta&&r.setRoll(r.roll+t.rollDelta),t.zoomDelta&&r.setZoom(r.zoom+t.zoomDelta)}handleMapControlsPan(t,r,u){t.around.distSqr(r.centerPoint)<.01||r.setLocationAtPoint(u,t.around)}cameraForBoxAndBearing(t,r,u,d,y){return Ua(t,r,u,d,y)}handleJumpToCenterZoom(t,r){t.zoom!==(r.zoom!==void 0?+r.zoom:t.zoom)&&t.setZoom(+r.zoom),r.center!==void 0&&t.setCenter(o.N.convert(r.center))}handleEaseTo(t,r){const u=t.zoom,d=t.padding,y={roll:t.roll,pitch:t.pitch,bearing:t.bearing},x={roll:r.roll===void 0?t.roll:r.roll,pitch:r.pitch===void 0?t.pitch:r.pitch,bearing:r.bearing===void 0?t.bearing:r.bearing},S=r.zoom!==void 0,P=!t.isPaddingEqual(r.padding);let E=!1;const B=S?+r.zoom:t.zoom;let V=t.centerPoint.add(r.offsetAsPoint);const j=t.screenPointToLocation(V),{center:X,zoom:Y}=t.getConstrained(o.N.convert(r.center||j),B??u);mr(t,X);const le=Ai(t.worldSize,j),se=Ai(t.worldSize,X).sub(le),ce=o.aG(Y-u);return E=Y!==u,{easeFunc:fe=>{if(E&&t.setZoom(o.y.number(u,Y,fe)),o.b3(y,x)||Au({startEulerAngles:y,endEulerAngles:x,tr:t,k:fe,useSlerp:y.roll!=x.roll}),P&&(t.interpolatePadding(d,r.padding,fe),V=t.centerPoint.add(r.offsetAsPoint)),r.around)t.setLocationAtPoint(r.around,r.aroundPoint);else{const we=o.aG(t.zoom-u),Te=Y>u?Math.min(2,ce):Math.max(.5,ce),Ie=Math.pow(Te,1-fe),De=Wi(t.worldSize,le.add(se.mult(fe*Ie)).mult(we));t.setLocationAtPoint(t.renderWorldCopies?De.wrap():De,V)}},isZooming:E,elevationCenter:X}}handleFlyTo(t,r){const u=r.zoom!==void 0,d=t.zoom,y=t.getConstrained(o.N.convert(r.center||r.locationAtOffset),u?+r.zoom:d),x=y.center,S=y.zoom;mr(t,x);const P=Ai(t.worldSize,r.locationAtOffset),E=Ai(t.worldSize,x).sub(P),B=E.mag(),V=o.aG(S-d);let j;if(r.minZoom!==void 0){const X=Math.min(+r.minZoom,d,S),Y=t.getConstrained(x,X).zoom;j=o.aG(Y-d)}return{easeFunc:(X,Y,le,se)=>{t.setZoom(X===1?S:d+o.a8(Y));const ce=X===1?x:Wi(t.worldSize,P.add(E.mult(le)).mult(Y));t.setLocationAtPoint(t.renderWorldCopies?ce.wrap():ce,se)},scaleOfZoom:V,targetCenter:x,scaleOfMinZoom:j,pixelPathLength:B}}}class si{constructor(t,r,u){this.blendFunction=t,this.blendColor=r,this.mask=u}}si.Replace=[1,0],si.disabled=new si(si.Replace,o.b4.transparent,[!1,!1,!1,!1]),si.unblended=new si(si.Replace,o.b4.transparent,[!0,!0,!0,!0]),si.alphaBlended=new si([1,771],o.b4.transparent,[!0,!0,!0,!0]);const po=2305;class Rn{constructor(t,r,u){this.enable=t,this.mode=r,this.frontFace=u}}Rn.disabled=new Rn(!1,1029,po),Rn.backCCW=new Rn(!0,1029,po),Rn.frontCCW=new Rn(!0,1028,po);class yn{constructor(t,r,u){this.func=t,this.mask=r,this.range=u}}yn.ReadOnly=!1,yn.ReadWrite=!0,yn.disabled=new yn(519,yn.ReadOnly,[0,1]);const il=7680;class Ln{constructor(t,r,u,d,y,x){this.test=t,this.ref=r,this.mask=u,this.fail=d,this.depthFail=y,this.pass=x}}Ln.disabled=new Ln({func:519,mask:0},0,0,il,il,il);const mo=new WeakMap;function ca(g){var t;if(mo.has(g))return mo.get(g);{const r=(t=g.getParameter(g.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return mo.set(g,r),r}}class rl{get awaitingQuery(){return!!this._readbackQueue}constructor(t){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=t;const r=t.context,u=r.gl;this._texFormat=u.RGBA,this._texType=u.UNSIGNED_BYTE;const d=new o.aC;d.emplaceBack(-1,-1),d.emplaceBack(2,-1),d.emplaceBack(-1,2);const y=new o.aE;y.emplaceBack(0,1,2),this._fullscreenTriangle=new Pa(r.createVertexBuffer(d,Pn.members),r.createIndexBuffer(y),o.aD.simpleSegment(0,0,d.length,y.length)),this._resultBuffer=new Uint8Array(4),r.activeTexture.set(u.TEXTURE1);const x=u.createTexture();u.bindTexture(u.TEXTURE_2D,x),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.NEAREST),u.texImage2D(u.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=r.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(x),ca(u)&&(this._pbo=u.createBuffer(),u.bindBuffer(u.PIXEL_PACK_BUFFER,this._pbo),u.bufferData(u.PIXEL_PACK_BUFFER,4,u.STREAM_READ),u.bindBuffer(u.PIXEL_PACK_BUFFER,null))}destroy(){const t=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),t.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(t,r){const u=this._updateCount;return this._readbackQueue?u>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():u>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(t,r),this._updateCount++,this._measuredError}_bindFramebuffer(){const t=this._cachedRenderContext.context,r=t.gl;t.activeTexture.set(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,this._fbo.colorAttachment.get()),t.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(t,r){const u=this._cachedRenderContext.context,d=u.gl;if(this._bindFramebuffer(),u.viewport.set([0,0,this._texWidth,this._texHeight]),u.clear({color:o.b4.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(u,d.TRIANGLES,yn.disabled,Ln.disabled,si.unblended,Rn.disabled,((y,x)=>({u_input:y,u_output_expected:x}))(t,r),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&ca(d)){d.bindBuffer(d.PIXEL_PACK_BUFFER,this._pbo),d.readBuffer(d.COLOR_ATTACHMENT0),d.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),d.bindBuffer(d.PIXEL_PACK_BUFFER,null);const y=d.fenceSync(d.SYNC_GPU_COMMANDS_COMPLETE,0);d.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:y}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const t=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&ca(t)){const r=t.clientWaitSync(this._readbackQueue.sync,0,0);if(r===t.WAIT_FAILED)return o.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(r===t.TIMEOUT_EXPIRED)return;t.bindBuffer(t.PIXEL_PACK_BUFFER,this._pbo),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),t.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=rl._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(t){let r=0;return r+=t[0]/256,r+=t[1]/65536,r+=t[2]/16777216,t[3]<127&&(r=-r),r/128}}const al=o.X/128;function sl(g,t){const r=g.granularity!==void 0?Math.max(g.granularity,1):1,u=r+(g.generateBorders?2:0),d=r+(g.extendToNorthPole||g.generateBorders?1:0)+(g.extendToSouthPole||g.generateBorders?1:0),y=u+1,x=d+1,S=g.generateBorders?-1:0,P=g.generateBorders||g.extendToNorthPole?-1:0,E=r+(g.generateBorders?1:0),B=r+(g.generateBorders||g.extendToSouthPole?1:0),V=y*x,j=u*d*6,X=y*x>65536;if(X&&t==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Y=X||t==="32bit",le=new Int16Array(2*V);let se=0;for(let we=P;we<=B;we++)for(let Te=S;Te<=E;Te++){let Ie=Te/r*o.X;Te===-1&&(Ie=-64),Te===r+1&&(Ie=o.X+al);let De=we/r*o.X;we===-1&&(De=g.extendToNorthPole?o.b6:-64),we===r+1&&(De=g.extendToSouthPole?o.b7:o.X+al),le[se++]=Ie,le[se++]=De}const ce=Y?new Uint32Array(j):new Uint16Array(j);let fe=0;for(let we=0;we<d;we++)for(let Te=0;Te<u;Te++){const Ie=Te+1+we*y,De=Te+(we+1)*y,Re=Te+1+(we+1)*y;ce[fe++]=Te+we*y,ce[fe++]=De,ce[fe++]=Ie,ce[fe++]=Ie,ce[fe++]=De,ce[fe++]=Re}return{vertices:le.buffer.slice(0),indices:ce.buffer.slice(0),uses32bitIndices:Y}}const zs=new o.aB({fill:new o.b8(128,2),line:new o.b8(512,0),tile:new o.b8(128,32),stencil:new o.b8(128,1),circle:3});class Wd{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Ta.projectionGlobe}get vertexShaderPreludeCode(){return Ta.projectionMercator.vertexSource}get subdivisionGranularity(){return zs}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(t){this._errorMeasurement||(this._errorMeasurement=new rl(t));const r=o.Q(this._errorQueryLatitudeDegrees),u=2*Math.atan(Math.exp(Math.PI-r*Math.PI*2))-.5*Math.PI,d=this._errorMeasurement.updateErrorLoop(r,u),y=O.now();d!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=d,this._errorMeasurementLastChangeTime=y);const x=Math.min(Math.max((y-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=o.b9(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,o.ba(x))}_getMeshKey(t){return`${t.granularity.toString(36)}_${t.generateBorders?"b":""}${t.extendToNorthPole?"n":""}${t.extendToSouthPole?"s":""}`}getMeshFromTileID(t,r,u,d,y){const x=(y==="stencil"?zs.stencil:zs.tile).getGranularityForZoomLevel(r.z);return this._getMesh(t,{granularity:x,generateBorders:u,extendToNorthPole:r.y===0&&d,extendToSouthPole:r.y===(1<<r.z)-1&&d})}_getMesh(t,r){const u=this._getMeshKey(r);if(u in this._tileMeshCache)return this._tileMeshCache[u];const d=function(y,x){const S=sl(x,"16bit"),P=o.aC.deserialize({arrayBuffer:S.vertices,length:S.vertices.byteLength/2/2}),E=o.aE.deserialize({arrayBuffer:S.indices,length:S.indices.byteLength/2/3});return new Pa(y.createVertexBuffer(P,Pn.members),y.createIndexBuffer(E),o.aD.simpleSegment(0,0,P.length,E.length))}(t,r);return this._tileMeshCache[u]=d,d}recalculate(t){}hasTransition(){const t=O.now();let r=!1;return r=r||(t-this._errorMeasurementLastChangeTime)/1e3<.7,r=r||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,r}setErrorQueryLatitudeDegrees(t){this._errorQueryLatitudeDegrees=t}}const Ru=new o.q({type:new o.D(o.v.projection.type)});class Du extends o.E{constructor(t){super(),this._transitionable=new o.T(Ru),this.setProjection(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.z(0)),this._mercatorProjection=new tl,this._verticalPerspectiveProjection=new Wd}get transitionState(){const t=this.properties.get("type");if(typeof t=="string"&&t==="mercator")return 0;if(typeof t=="string"&&t==="vertical-perspective")return 1;if(t instanceof o.bb){if(t.from==="vertical-perspective"&&t.to==="mercator")return 1-t.transition;if(t.from==="mercator"&&t.to==="vertical-perspective")return t.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(t){this._mercatorProjection.updateGPUdependent(t),this._verticalPerspectiveProjection.updateGPUdependent(t)}getMeshFromTileID(t,r,u,d,y){return this.currentProjection.getMeshFromTileID(t,r,u,d,y)}setProjection(t){this._transitionable.setValue("type",(t==null?void 0:t.type)||"mercator")}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}setErrorQueryLatitudeDegrees(t){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(t),this._mercatorProjection.setErrorQueryLatitudeDegrees(t)}}function Xd(g){const t=go(g.worldSize,g.center.lat);return 2*Math.PI*t}function ol(g,t,r,u,d){const y=1/(1<<d),x=t/o.X*y+u*y,S=o.bd((g/o.X*y+r*y)*Math.PI*2+Math.PI,2*Math.PI),P=2*Math.atan(Math.exp(Math.PI-x*Math.PI*2))-.5*Math.PI,E=Math.cos(P),B=new Float64Array(3);return B[0]=Math.sin(S)*E,B[1]=Math.sin(P),B[2]=Math.cos(S)*E,B}function Jn(g){return function(t,r){const u=Math.cos(r),d=new Float64Array(3);return d[0]=Math.sin(t)*u,d[1]=Math.sin(r),d[2]=Math.cos(t)*u,d}(g.lng*Math.PI/180,g.lat*Math.PI/180)}function go(g,t){return g/(2*Math.PI)/Math.cos(t*Math.PI/180)}function ua(g){const t=Math.asin(g[1])/Math.PI*180,r=Math.sqrt(g[0]*g[0]+g[2]*g[2]);if(r>1e-6){const u=g[0]/r,d=Math.acos(g[2]/r),y=(u>0?d:-d)/Math.PI*180;return new o.N(o.aI(y,-180,180),t)}return new o.N(0,t)}function Ls(g){return Math.cos(g*Math.PI/180)}function Xi(g,t){const r=Ls(g),u=Ls(t);return o.a8(u/r)}function zu(g,t){const r=g.rotate(t.bearingInRadians),u=t.zoom+Xi(t.center.lat,0),d=o.b9(1/Ls(t.center.lat),1/Ls(Math.min(Math.abs(t.center.lat),60)),o.bc(u,7,3,0,1)),y=360/Xd({worldSize:t.worldSize,center:{lat:t.center.lat}});return new o.N(t.center.lng-r.x*y*d,o.ab(t.center.lat+r.y*y,-85.051129,o.aF))}function ls(g){const t=.5*g,r=Math.sin(t),u=Math.cos(t);return Math.log(r+u)-Math.log(u-r)}function Kd(g,t,r,u){const d=g.lat+r*u;if(Math.abs(r)>1){const y=(Math.sign(g.lat+r)!==Math.sign(g.lat)?-Math.abs(g.lat):Math.abs(g.lat))*Math.PI/180,x=Math.abs(g.lat+r)*Math.PI/180,S=ls(y+u*(x-y)),P=ls(y),E=ls(x);return new o.N(g.lng+t*((S-P)/(E-P)),d)}return new o.N(g.lng+t*u,d)}class Nm{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=t}recalculateCache(){if(!this._hadAnyChanges)return;const t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(t,r,u,d){const y=`${t.z}_${t.x}_${t.y}`,x=this._cache.get(y);if(x)return x;const S=this._cachePrevious.get(y);if(S)return this._cache.set(y,S),S;const P=this._aabbFactory(t,r,u,d);return this._cache.set(y,P),this._hadAnyChanges=!0,P}}function sc(g,t,r){const u=g-t;return u<0?-u:Math.max(0,u-r)}function Lu(g,t,r,u,d){const y=g-r;let x;return x=y<0?Math.min(-y,1+y-d):y>1?Math.min(Math.max(y-d,0),1-y):0,Math.max(x,sc(t,u,d))}class $m{constructor(){this._aabbCache=new Nm(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(t,r,u,d){const y=1<<u.z,x=1/y,S=u.x/y,P=u.y/y;let E=2;return E=Math.min(E,Lu(t,r,S,P,x)),E=Math.min(E,Lu(t,r,S+.5,-P-x,x)),E=Math.min(E,Lu(t,r,S+.5,2-P-x,x)),E}getWrap(t,r,u){const d=1<<r.z,y=1/d,x=r.x/d,S=sc(t.x,x,y),P=sc(t.x,x-1,y),E=sc(t.x,x+1,y),B=Math.min(S,P,E);return B===E?1:B===P?-1:0}allowVariableZoom(t,r){return Mr(t,r)>4}allowWorldCopies(){return!1}getTileAABB(t,r,u,d){return this._aabbCache.getTileAABB(t,r,u,d)}_computeTileAABB(t,r,u,d){if(t.z<=0)return new ai([-1,-1,-1],[1,1,1]);if(t.z===1)return new ai([t.x===0?-1:0,t.y===0?0:-1,-1],[t.x===0?0:1,t.y===0?1:0,1]);{const y=[ol(0,0,t.x,t.y,t.z),ol(o.X,0,t.x,t.y,t.z),ol(o.X,o.X,t.x,t.y,t.z),ol(0,o.X,t.x,t.y,t.z)],x=[1,1,1],S=[-1,-1,-1];for(const P of y)for(let E=0;E<3;E++)x[E]=Math.min(x[E],P[E]),S[E]=Math.max(S[E],P[E]);if(t.y===0||t.y===(1<<t.z)-1){const P=[0,t.y===0?1:-1,0];for(let E=0;E<3;E++)x[E]=Math.min(x[E],P[E]),S[E]=Math.max(S[E],P[E])}return new ai(x,S)}}}class oc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,r,u){return this._helper.interpolatePadding(t,r,u)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,r){this._helper.resize(t,r)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,r){this._helper.overrideNearFarZ(t,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t){}constructor(){this._cachedClippingPlane=o.be(),this._projectionMatrix=o.a_(),this._globeViewProjMatrix32f=o.aZ(),this._globeViewProjMatrixNoCorrection=o.a_(),this._globeViewProjMatrixNoCorrectionInverted=o.a_(),this._globeProjMatrixInverted=o.a_(),this._cameraPosition=o.bf(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Ds({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,r)=>this.getConstrained(t,r)}),this._coveringTilesDetailsProvider=new $m}clone(){const t=new oc;return t.apply(this),t}apply(t,r){this._globeLatitudeErrorCorrectionRadians=r||0,this._helper.apply(t)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const t=o.bf();return t[0]=this._cameraPosition[0],t[1]=this._cameraPosition[1],t[2]=this._cameraPosition[2],t}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(t){const{overscaledTileID:r,applyGlobeMatrix:u}=t,d=this._helper.getMercatorTileCoordinates(r);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:d,clippingPlane:this._cachedClippingPlane,projectionTransition:u?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(t){const r=this.pitchInRadians,u=this.cameraToCenterDistance/t,d=Math.sin(r)*u,y=Math.cos(r)*u+1,x=1/Math.sqrt(d*d+y*y)*1;let S=-d,P=y;const E=Math.sqrt(S*S+P*P);S/=E,P/=E;const B=[0,S,P];return o.bg(B,B,[0,0,0],-this.bearingInRadians),o.bh(B,B,[0,0,0],-1*this.center.lat*Math.PI/180),o.bi(B,B,[0,0,0],this.center.lng*Math.PI/180),o.aL(B,B,.25),[...B,.25*-x]}isLocationOccluded(t){return!this.isSurfacePointVisible(Jn(t))}transformLightDirection(t){const r=this._helper._center.lng*Math.PI/180,u=this._helper._center.lat*Math.PI/180,d=Math.cos(u),y=[Math.sin(r)*d,Math.sin(u),Math.cos(r)*d],x=[y[2],0,-y[0]],S=[0,0,0];o.aR(S,x,y),o.aQ(x,x),o.aQ(S,S);const P=[0,0,0];return o.aQ(P,[x[0]*t[0]+S[0]*t[1]+y[0]*t[2],x[1]*t[0]+S[1]*t[1]+y[1]*t[2],x[2]*t[0]+S[2]*t[1]+y[2]*t[2]]),P}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(t,r,u){const d=function(S,P,E){const B=1/(1<<E.z);return new o.Y(S/o.X*B+E.x*B,P/o.X*B+E.y*B)}(t,r,u.canonical),y=(x=d.y,[o.bd(d.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-x*Math.PI*2))-.5*Math.PI]);var x;return this.getCircleRadiusCorrection()/Math.cos(y[1])}projectTileCoordinates(t,r,u,d){const y=u.canonical,x=ol(t,r,y.x,y.y,y.z),S=1+(d?d(t,r):0)/o.bo,P=[x[0]*S,x[1]*S,x[2]*S,1];o.al(P,P,this._globeViewProjMatrixNoCorrection);const E=this._cachedClippingPlane,B=E[0]*x[0]+E[1]*x[1]+E[2]*x[2]+E[3]<0;return{point:new o.P(P[0]/P[3],P[1]/P[3]),signedDistanceFromCamera:P[3],isOccluded:B}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const t=go(this.worldSize,this.center.lat),r=o.a$(),u=o.a$();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*t),o.aV(r,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const d=this.centerOffset;r[8]=2*-d.x/this._helper._width,r[9]=2*d.y/this._helper._height,this._projectionMatrix=o.aW(r),this._globeProjMatrixInverted=o.a$(),o.an(this._globeProjMatrixInverted,r),o.J(r,r,[0,0,-this.cameraToCenterDistance]),o.aX(r,r,this.rollInRadians),o.aY(r,r,-this.pitchInRadians),o.aX(r,r,this.bearingInRadians),o.J(r,r,[0,0,-t]);const y=o.bf();y[0]=t,y[1]=t,y[2]=t,o.aY(u,r,this.center.lat*Math.PI/180),o.bj(u,u,-this.center.lng*Math.PI/180),o.K(u,u,y),this._globeViewProjMatrixNoCorrection=u,o.aY(r,r,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),o.bj(r,r,-this.center.lng*Math.PI/180),o.K(r,r,y),this._globeViewProjMatrix32f=new Float32Array(r),this._globeViewProjMatrixNoCorrectionInverted=o.a$(),o.an(this._globeViewProjMatrixNoCorrectionInverted,u);const x=o.bf();this._cameraPosition=o.bf(),this._cameraPosition[2]=this.cameraToCenterDistance/t,o.bg(this._cameraPosition,this._cameraPosition,x,-this.rollInRadians),o.bh(this._cameraPosition,this._cameraPosition,x,this.pitchInRadians),o.bg(this._cameraPosition,this._cameraPosition,x,-this.bearingInRadians),o.aM(this._cameraPosition,this._cameraPosition,[0,0,1]),o.bh(this._cameraPosition,this._cameraPosition,x,-this.center.lat*Math.PI/180),o.bi(this._cameraPosition,this._cameraPosition,x,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(t);const S=o.aW(this._globeViewProjMatrixNoCorrectionInverted);o.K(S,S,[1,1,-1]),this._cachedFrustum=ka.fromInvProjectionMatrix(S)}calculateFogMatrix(t){o.w("calculateFogMatrix is not supported on globe projection.");const r=o.a$();return o.aq(r),r}getVisibleUnwrappedCoordinates(t){return[new o.aT(0,t)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){t&&o.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,r){if(!this._globeViewProjMatrixNoCorrection)return 1;const u=Jn(t);o.aL(u,u,1+r/o.bo);const d=o.be();return o.al(d,[u[0],u[1],u[2],1],this._globeViewProjMatrixNoCorrection),d[2]/d[3]}populateCache(t){}getBounds(){const t=.5*this.width,r=.5*this.height,u=[new o.P(0,0),new o.P(t,0),new o.P(this.width,0),new o.P(this.width,r),new o.P(this.width,this.height),new o.P(t,this.height),new o.P(0,this.height),new o.P(0,r)],d=[];for(const V of u)d.push(this.unprojectScreenPoint(V));let y=0,x=0,S=0,P=0;const E=this.center;for(const V of d){const j=o.bk(E.lng,V.lng),X=o.bk(E.lat,V.lat);j<x&&(x=j),j>y&&(y=j),X<P&&(P=X),X>S&&(S=X)}const B=[E.lng+x,E.lat+P,E.lng+y,E.lat+S];return this.isSurfacePointOnScreen([0,1,0])&&(B[3]=90,B[0]=-180,B[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(B[1]=-90,B[0]=-180,B[2]=180),new Le(B)}getConstrained(t,r){const u=o.ab(t.lat,-85.051129,o.aF),d=o.ab(+r,this.minZoom+Xi(0,u),this.maxZoom);return{center:new o.N(t.lng,u),zoom:d}}calculateCenterFromCameraLngLatAlt(t,r,u,d){return this._helper.calculateCenterFromCameraLngLatAlt(t,r,u,d)}setLocationAtPoint(t,r){const u=Jn(this.unprojectScreenPoint(r)),d=Jn(t),y=o.bf();o.bl(y);const x=o.bf();o.bi(x,u,y,-this.center.lng*Math.PI/180),o.bh(x,x,y,this.center.lat*Math.PI/180);const S=d[0]*d[0]+d[2]*d[2],P=x[0]*x[0];if(S<P)return;const E=Math.sqrt(S-P),B=-E,V=o.bm(d[0],d[2],x[0],E),j=o.bm(d[0],d[2],x[0],B),X=o.bf();o.bi(X,d,y,-V);const Y=o.bm(X[1],X[2],x[1],x[2]),le=o.bf();o.bi(le,d,y,-j);const se=o.bm(le[1],le[2],x[1],x[2]),ce=.5*Math.PI,fe=Y>=-ce&&Y<=ce,we=se>=-ce&&se<=ce;let Te,Ie;if(fe&&we){const Ze=this.center.lng*Math.PI/180,rt=this.center.lat*Math.PI/180;o.bp(V,Ze)+o.bp(Y,rt)<o.bp(j,Ze)+o.bp(se,rt)?(Te=V,Ie=Y):(Te=j,Ie=se)}else if(fe)Te=V,Ie=Y;else{if(!we)return;Te=j,Ie=se}const De=Te/Math.PI*180,Re=Ie/Math.PI*180,Ge=this.center.lat;this.setCenter(new o.N(De,o.ab(Re,-90,90))),this.setZoom(this.zoom+Xi(Ge,this.center.lat))}locationToScreenPoint(t,r){const u=Jn(t);if(r){const d=r.getElevationForLngLatZoom(t,this._helper._tileZoom);o.aL(u,u,1+d/o.bo)}return this._projectSurfacePointToScreen(u)}_projectSurfacePointToScreen(t){const r=o.be();return o.al(r,[...t,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],new o.P((.5*r[0]+.5)*this.width,(.5*-r[1]+.5)*this.height)}screenPointToMercatorCoordinate(t,r){if(r){const u=r.pointCoordinate(t);if(u)return u}return o.Y.fromLngLat(this.unprojectScreenPoint(t))}screenPointToLocation(t,r){var u;return(u=this.screenPointToMercatorCoordinate(t,r))===null||u===void 0?void 0:u.toLngLat()}isPointOnMapSurface(t,r){const u=this._cameraPosition,d=this.getRayDirectionFromPixel(t);return!!this.rayPlanetIntersection(u,d)}getRayDirectionFromPixel(t){const r=o.be();r[0]=t.x/this.width*2-1,r[1]=-1*(t.y/this.height*2-1),r[2]=1,r[3]=1,o.al(r,r,this._globeViewProjMatrixNoCorrectionInverted),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3];const u=o.bf();u[0]=r[0]-this._cameraPosition[0],u[1]=r[1]-this._cameraPosition[1],u[2]=r[2]-this._cameraPosition[2];const d=o.bf();return o.aQ(d,u),d}isSurfacePointVisible(t){const r=this._cachedClippingPlane;return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]>=0}isSurfacePointOnScreen(t){if(!this.isSurfacePointVisible(t))return!1;const r=o.be();return o.al(r,[...t,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3],r[0]>-1&&r[0]<1&&r[1]>-1&&r[1]<1&&r[2]>-1&&r[2]<1}rayPlanetIntersection(t,r){const u=o.aS(t,r),d=o.bf(),y=o.bf();o.aL(y,r,u),o.aP(d,t,y);const x=1-o.aS(d,d);if(x<0)return null;const S=o.aS(t,t)-1,P=-u+(u<0?1:-1)*Math.sqrt(x),E=S/P,B=P;return{tMin:Math.min(E,B),tMax:Math.max(E,B)}}unprojectScreenPoint(t){const r=this._cameraPosition,u=this.getRayDirectionFromPixel(t),d=this.rayPlanetIntersection(r,u);if(d){const E=o.bf();o.aM(E,r,[u[0]*d.tMin,u[1]*d.tMin,u[2]*d.tMin]);const B=o.bf();return o.aQ(B,E),ua(B)}const y=this._cachedClippingPlane[0]*u[0]+this._cachedClippingPlane[1]*u[1]+this._cachedClippingPlane[2]*u[2],x=-o.bn(this._cachedClippingPlane,r)/y,S=o.bf();if(x>0)o.aM(S,r,[u[0]*x,u[1]*x,u[2]*x]);else{const E=o.bf();o.aM(E,r,[2*u[0],2*u[1],2*u[2]]);const B=o.bn(this._cachedClippingPlane,E);o.aP(S,E,[this._cachedClippingPlane[0]*B,this._cachedClippingPlane[1]*B,this._cachedClippingPlane[2]*B])}const P=o.bf();return o.aQ(P,S),ua(P)}getMatrixForModel(t,r){const u=o.N.convert(t),d=1/o.bo,y=o.a_();return o.bj(y,y,u.lng/180*Math.PI),o.aY(y,y,-u.lat/180*Math.PI),o.J(y,y,[0,0,1+r/o.bo]),o.aY(y,y,.5*Math.PI),o.K(y,y,[d,d,d]),y}getProjectionDataForCustomLayer(t=!0){const r=this.getProjectionData({overscaledTileID:new o.S(0,0,0,0,0),applyGlobeMatrix:t});return r.tileMercatorCoords=[0,0,1,1],r}getFastPathSimpleProjectionMatrix(t){}}class Bs{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,r,u){return this._helper.interpolatePadding(t,r,u)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,r,u=!0){this._helper.resize(t,r,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,r){this._helper.overrideNearFarZ(t,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(t,r){this._globeness=t,this._globeLatitudeErrorCorrectionRadians=r,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Ds({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,r)=>this.getConstrained(t,r)}),this._globeness=1,this._mercatorTransform=new ja,this._verticalPerspectiveTransform=new oc}clone(){const t=new Bs;return t._globeness=this._globeness,t._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,t.apply(this),t}apply(t){this._helper.apply(t),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(t){const r=this._mercatorTransform.getProjectionData(t),u=this._verticalPerspectiveTransform.getProjectionData(t);return{mainMatrix:this.isGlobeRendering?u.mainMatrix:r.mainMatrix,clippingPlane:u.clippingPlane,tileMercatorCoords:u.tileMercatorCoords,projectionTransition:t.applyGlobeMatrix?this._globeness:0,fallbackMatrix:r.fallbackMatrix}}isLocationOccluded(t){return this.currentTransform.isLocationOccluded(t)}transformLightDirection(t){return this.currentTransform.transformLightDirection(t)}getPixelScale(){return o.b9(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return o.b9(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(t,r,u){const d=this._mercatorTransform.getPitchedTextCorrection(t,r,u),y=this._verticalPerspectiveTransform.getPitchedTextCorrection(t,r,u);return o.b9(d,y,this._globeness)}projectTileCoordinates(t,r,u,d){return this.currentTransform.projectTileCoordinates(t,r,u,d)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(t){return this.currentTransform.calculateFogMatrix(t)}getVisibleUnwrappedCoordinates(t){return this.currentTransform.getVisibleUnwrappedCoordinates(t)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(t){this._mercatorTransform.recalculateZoomAndCenter(t),this._verticalPerspectiveTransform.recalculateZoomAndCenter(t)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,r){return this.currentTransform.lngLatToCameraDepth(t,r)}populateCache(t){this._mercatorTransform.populateCache(t),this._verticalPerspectiveTransform.populateCache(t)}getBounds(){return this.currentTransform.getBounds()}getConstrained(t,r){return this.currentTransform.getConstrained(t,r)}calculateCenterFromCameraLngLatAlt(t,r,u,d){return this._helper.calculateCenterFromCameraLngLatAlt(t,r,u,d)}setLocationAtPoint(t,r){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(t,r),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(t,r),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(t,r){return this.currentTransform.locationToScreenPoint(t,r)}screenPointToMercatorCoordinate(t,r){return this.currentTransform.screenPointToMercatorCoordinate(t,r)}screenPointToLocation(t,r){return this.currentTransform.screenPointToLocation(t,r)}isPointOnMapSurface(t,r){return this.currentTransform.isPointOnMapSurface(t,r)}getRayDirectionFromPixel(t){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(t)}getMatrixForModel(t,r){return this.currentTransform.getMatrixForModel(t,r)}getProjectionDataForCustomLayer(t=!0){const r=this._mercatorTransform.getProjectionDataForCustomLayer(t);if(!this.isGlobeRendering)return r;const u=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(t);return u.fallbackMatrix=r.mainMatrix,u}getFastPathSimpleProjectionMatrix(t){return this.currentTransform.getFastPathSimpleProjectionMatrix(t)}}class Vr{get useGlobeControls(){return!0}handlePanInertia(t,r){const u=zu(t,r);return Math.abs(u.lng-r.center.lng)>180&&(u.lng=r.center.lng+179.5*Math.sign(u.lng-r.center.lng)),{easingCenter:u,easingOffset:new o.P(0,0)}}handleMapControlsRollPitchBearingZoom(t,r){const u=t.around,d=r.screenPointToLocation(u);t.bearingDelta&&r.setBearing(r.bearing+t.bearingDelta),t.pitchDelta&&r.setPitch(r.pitch+t.pitchDelta),t.rollDelta&&r.setRoll(r.roll+t.rollDelta);const y=r.zoom;t.zoomDelta&&r.setZoom(r.zoom+t.zoomDelta);const x=r.zoom-y;if(x===0)return;const S=o.bk(r.center.lng,d.lng),P=S/(Math.abs(S/180)+1),E=o.bk(r.center.lat,d.lat),B=r.getRayDirectionFromPixel(u),V=r.cameraPosition,j=-1*o.aS(V,B),X=o.bf();o.aM(X,V,[B[0]*j,B[1]*j,B[2]*j]);const Y=o.bq(X)-1,le=Math.exp(.5*-Math.max(Y-.3,0)),se=go(r.worldSize,r.center.lat)/Math.min(r.width,r.height),ce=o.bc(se,.9,.5,1,.25),fe=(1-o.aG(-x))*Math.min(le,ce),we=r.center.lat,Te=r.zoom,Ie=new o.N(r.center.lng+P*fe,o.ab(r.center.lat+E*fe,-85.051129,o.aF));r.setLocationAtPoint(d,u);const De=r.center,Re=o.bc(Math.abs(S),45,85,0,1),Ge=o.bc(se,.75,.35,0,1),Ze=Math.pow(Math.max(Re,Ge),.25),rt=o.bk(De.lng,Ie.lng),lt=o.bk(De.lat,Ie.lat);r.setCenter(new o.N(De.lng+rt*Ze,De.lat+lt*Ze).wrap()),r.setZoom(Te+Xi(we,r.center.lat))}handleMapControlsPan(t,r,u){if(!t.panDelta)return;const d=r.center.lat,y=r.zoom;r.setCenter(zu(t.panDelta,r).wrap()),r.setZoom(y+Xi(d,r.center.lat))}cameraForBoxAndBearing(t,r,u,d,y){const x=Ua(t,r,u,d,y),S=r.left/y.width*2-1,P=(y.width-r.right)/y.width*2-1,E=r.top/y.height*-2+1,B=(y.height-r.bottom)/y.height*-2+1,V=o.bk(u.getWest(),u.getEast())<0,j=V?u.getEast():u.getWest(),X=V?u.getWest():u.getEast(),Y=Math.max(u.getNorth(),u.getSouth()),le=Math.min(u.getNorth(),u.getSouth()),se=j+.5*o.bk(j,X),ce=Y+.5*o.bk(Y,le),fe=y.clone();fe.setCenter(x.center),fe.setBearing(x.bearing),fe.setPitch(0),fe.setRoll(0),fe.setZoom(x.zoom);const we=fe.modelViewProjectionMatrix,Te=[Jn(u.getNorthWest()),Jn(u.getNorthEast()),Jn(u.getSouthWest()),Jn(u.getSouthEast()),Jn(new o.N(X,ce)),Jn(new o.N(j,ce)),Jn(new o.N(se,Y)),Jn(new o.N(se,le))],Ie=Jn(x.center);let De=Number.POSITIVE_INFINITY;for(const Re of Te)S<0&&(De=Vr.getLesserNonNegativeNonNull(De,Vr.solveVectorScale(Re,Ie,we,"x",S))),P>0&&(De=Vr.getLesserNonNegativeNonNull(De,Vr.solveVectorScale(Re,Ie,we,"x",P))),E>0&&(De=Vr.getLesserNonNegativeNonNull(De,Vr.solveVectorScale(Re,Ie,we,"y",E))),B<0&&(De=Vr.getLesserNonNegativeNonNull(De,Vr.solveVectorScale(Re,Ie,we,"y",B)));if(Number.isFinite(De)&&De!==0)return x.zoom=fe.zoom+o.a8(De),x;Jr()}handleJumpToCenterZoom(t,r){const u=t.center.lat,d=t.getConstrained(r.center?o.N.convert(r.center):t.center,t.zoom).center;t.setCenter(d.wrap());const y=r.zoom!==void 0?+r.zoom:t.zoom+Xi(u,d.lat);t.zoom!==y&&t.setZoom(y)}handleEaseTo(t,r){const u=t.zoom,d=t.center,y=t.padding,x={roll:t.roll,pitch:t.pitch,bearing:t.bearing},S={roll:r.roll===void 0?t.roll:r.roll,pitch:r.pitch===void 0?t.pitch:r.pitch,bearing:r.bearing===void 0?t.bearing:r.bearing},P=r.zoom!==void 0,E=!t.isPaddingEqual(r.padding);let B=!1;const V=r.center?o.N.convert(r.center):d,j=t.getConstrained(V,u).center;mr(t,j);const X=t.clone();X.setCenter(j),X.setZoom(P?+r.zoom:u+Xi(d.lat,V.lat)),X.setBearing(r.bearing);const Y=new o.P(o.ab(t.centerPoint.x+r.offsetAsPoint.x,0,t.width),o.ab(t.centerPoint.y+r.offsetAsPoint.y,0,t.height));X.setLocationAtPoint(j,Y);const le=(r.offset&&r.offsetAsPoint.mag())>0?X.center:j,se=P?+r.zoom:u+Xi(d.lat,le.lat),ce=u+Xi(d.lat,0),fe=se+Xi(le.lat,0),we=o.bk(d.lng,le.lng),Te=o.bk(d.lat,le.lat),Ie=o.aG(fe-ce);return B=se!==u,{easeFunc:De=>{if(o.b3(x,S)||Au({startEulerAngles:x,endEulerAngles:S,tr:t,k:De,useSlerp:x.roll!=S.roll}),E&&t.interpolatePadding(y,r.padding,De),r.around)o.w("Easing around a point is not supported under globe projection."),t.setLocationAtPoint(r.around,r.aroundPoint);else{const Re=fe>ce?Math.min(2,Ie):Math.max(.5,Ie),Ge=Math.pow(Re,1-De),Ze=Kd(d,we,Te,De*Ge);t.setCenter(Ze.wrap())}if(B){const Re=o.y.number(ce,fe,De)+Xi(0,t.center.lat);t.setZoom(Re)}},isZooming:B,elevationCenter:le}}handleFlyTo(t,r){const u=r.zoom!==void 0,d=t.center,y=t.zoom,x=!t.isPaddingEqual(r.padding),S=t.getConstrained(o.N.convert(r.center||r.locationAtOffset),y).center,P=u?+r.zoom:t.zoom+Xi(t.center.lat,S.lat),E=t.clone();E.setCenter(S),x&&E.setPadding(r.padding),E.setZoom(P),E.setBearing(r.bearing);const B=new o.P(o.ab(t.centerPoint.x+r.offsetAsPoint.x,0,t.width),o.ab(t.centerPoint.y+r.offsetAsPoint.y,0,t.height));E.setLocationAtPoint(S,B);const V=E.center;mr(t,V);const j=function(we,Te,Ie){const De=Jn(Te),Re=Jn(Ie),Ge=o.aS(De,Re),Ze=Math.acos(Ge),rt=Xd(we);return Ze/(2*Math.PI)*rt}(t,d,V),X=y+Xi(d.lat,0),Y=P+Xi(V.lat,0),le=o.aG(Y-X);let se;if(typeof r.minZoom=="number"){const we=+r.minZoom+Xi(V.lat,0),Te=Math.min(we,X,Y)+Xi(0,V.lat),Ie=t.getConstrained(V,Te).zoom+Xi(V.lat,0);se=o.aG(Ie-X)}const ce=o.bk(d.lng,V.lng),fe=o.bk(d.lat,V.lat);return{easeFunc:(we,Te,Ie,De)=>{const Re=Kd(d,ce,fe,Ie),Ge=we===1?V:Re;t.setCenter(Ge.wrap());const Ze=X+o.a8(Te);t.setZoom(we===1?P:Ze+Xi(0,Ge.lat))},scaleOfZoom:le,targetCenter:V,scaleOfMinZoom:se,pixelPathLength:j}}static solveVectorScale(t,r,u,d,y){const x=d==="x"?[u[0],u[4],u[8],u[12]]:[u[1],u[5],u[9],u[13]],S=[u[3],u[7],u[11],u[15]],P=t[0]*x[0]+t[1]*x[1]+t[2]*x[2],E=t[0]*S[0]+t[1]*S[1]+t[2]*S[2],B=r[0]*x[0]+r[1]*x[1]+r[2]*x[2],V=r[0]*S[0]+r[1]*S[1]+r[2]*S[2];return B+y*E===P+y*V||S[3]*(P-B)+x[3]*(V-E)+P*V==B*E?null:(B+x[3]-y*V-y*S[3])/(B-P-y*V+y*E)}static getLesserNonNegativeNonNull(t,r){return r!==null&&r>=0&&r<t?r:t}}class ll{constructor(t){this._globe=t,this._mercatorCameraHelper=new ac,this._verticalPerspectiveCameraHelper=new Vr}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(t,r){return this.currentHelper.handlePanInertia(t,r)}handleMapControlsRollPitchBearingZoom(t,r){return this.currentHelper.handleMapControlsRollPitchBearingZoom(t,r)}handleMapControlsPan(t,r,u){this.currentHelper.handleMapControlsPan(t,r,u)}cameraForBoxAndBearing(t,r,u,d,y){return this.currentHelper.cameraForBoxAndBearing(t,r,u,d,y)}handleJumpToCenterZoom(t,r){this.currentHelper.handleJumpToCenterZoom(t,r)}handleEaseTo(t,r){return this.currentHelper.handleEaseTo(t,r)}handleFlyTo(t,r){return this.currentHelper.handleFlyTo(t,r)}}const _o=(g,t)=>o.t(g,t&&t.filter(r=>r.identifier!=="source.canvas")),Bu=o.br();class Qr extends o.E{constructor(t,r={}){super(),this._rtlPluginLoaded=()=>{for(const u in this.sourceCaches){const d=this.sourceCaches[u].getSource().type;d!=="vector"&&d!=="geojson"||this.sourceCaches[u].reload()}},this.map=t,this.dispatcher=new _n(Zt(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",(u,d)=>this.getGlyphs(u,d)),this.dispatcher.registerMessageHandler("GI",(u,d)=>this.getImages(u,d)),this.imageManager=new ke,this.imageManager.setEventedParent(this),this.glyphManager=new We(t._requestManager,r.localIdeographFontFamily),this.lineAtlas=new Qe(256,512),this.crossTileSymbolIndex=new Rs,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.bs,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",o.bt()),Dn().on(Wt,this._rtlPluginLoaded),this.on("data",u=>{if(u.dataType!=="source"||u.sourceDataType!=="metadata")return;const d=this.sourceCaches[u.sourceId];if(!d)return;const y=d.getSource();if(y&&y.vectorLayerIds)for(const x in this._layers){const S=this._layers[x];S.source===y.id&&this._validateLayer(S)}})}loadURL(t,r={},u){this.fire(new o.k("dataloading",{dataType:"style"})),r.validate=typeof r.validate!="boolean"||r.validate;const d=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const y=this._loadStyleRequest;o.h(d,this._loadStyleRequest).then(x=>{this._loadStyleRequest=null,this._load(x.data,r,u)}).catch(x=>{this._loadStyleRequest=null,x&&!y.signal.aborted&&this.fire(new o.j(x))})}loadJSON(t,r={},u){this.fire(new o.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,O.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,r.validate=r.validate!==!1,this._load(t,r,u)}).catch(()=>{})}loadEmpty(){this.fire(new o.k("dataloading",{dataType:"style"})),this._load(Bu,{validate:!1})}_load(t,r,u){var d,y;const x=r.transformStyle?r.transformStyle(u,t):t;if(!r.validate||!_o(this,o.u(x))){this._loaded=!0,this.stylesheet=x;for(const S in x.sources)this.addSource(S,x.sources[S],{validate:!1});x.sprite?this._loadSprite(x.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(x.glyphs),this._createLayers(),this.light=new tt(this.stylesheet.light),this._setProjectionInternal(((d=this.stylesheet.projection)===null||d===void 0?void 0:d.type)||"mercator"),this.sky=new _t(this.stylesheet.sky),this.map.setTerrain((y=this.stylesheet.terrain)!==null&&y!==void 0?y:null),this.fire(new o.k("data",{dataType:"style"})),this.fire(new o.k("style.load"))}}_createLayers(){const t=o.bu(this.stylesheet.layers);this.dispatcher.broadcast("SL",t),this._order=t.map(r=>r.id),this._layers={},this._serializedLayers=null;for(const r of t){const u=o.bv(r);u.setEventedParent(this,{layer:{id:r.id}}),this._layers[r.id]=u}}_loadSprite(t,r=!1,u=void 0){let d;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(y,x,S,P){return o._(this,void 0,void 0,function*(){const E=de(y),B=S>1?"@2x":"",V={},j={};for(const{id:X,url:Y}of E){const le=x.transformRequest(Ce(Y,B,".json"),"SpriteJSON");V[X]=o.h(le,P);const se=x.transformRequest(Ce(Y,B,".png"),"SpriteImage");j[X]=pe.getImage(se,P)}return yield Promise.all([...Object.values(V),...Object.values(j)]),function(X,Y){return o._(this,void 0,void 0,function*(){const le={};for(const se in X){le[se]={};const ce=O.getImageCanvasContext((yield Y[se]).data),fe=(yield X[se]).data;for(const we in fe){const{width:Te,height:Ie,x:De,y:Re,sdf:Ge,pixelRatio:Ze,stretchX:rt,stretchY:lt,content:et,textFitWidth:Pt,textFitHeight:St}=fe[we];le[se][we]={data:null,pixelRatio:Ze,sdf:Ge,stretchX:rt,stretchY:lt,content:et,textFitWidth:Pt,textFitHeight:St,spriteData:{width:Te,height:Ie,x:De,y:Re,context:ce}}}}return le})}(V,j)})}(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(y=>{if(this._spriteRequest=null,y)for(const x in y){this._spritesImagesIds[x]=[];const S=this._spritesImagesIds[x]?this._spritesImagesIds[x].filter(P=>!(P in y)):[];for(const P of S)this.imageManager.removeImage(P),this._changedImages[P]=!0;for(const P in y[x]){const E=x==="default"?P:`${x}:${P}`;this._spritesImagesIds[x].push(E),E in this.imageManager.images?this.imageManager.updateImage(E,y[x][P],!1):this.imageManager.addImage(E,y[x][P]),r&&(this._changedImages[E]=!0)}}}).catch(y=>{this._spriteRequest=null,d=y,this.fire(new o.j(d))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),r&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"})),u&&u(d)})}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}_validateLayer(t){const r=this.sourceCaches[t.source];if(!r)return;const u=t.sourceLayer;if(!u)return;const d=r.getSource();(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(u)===-1)&&this.fire(new o.j(new Error(`Source layer "${u}" does not exist on source "${d.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,r=!1){const u=this._serializedAllLayers();if(!t||t.length===0)return Object.values(r?o.bw(u):u);const d=[];for(const y of t)if(u[y]){const x=r?o.bw(u[y]):u[y];d.push(x)}return d}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const r=Object.keys(this._layers);for(const u of r){const d=this._layers[u];d.type!=="custom"&&(t[u]=d.serialize())}return t}hasTransitions(){var t,r,u;if(!((t=this.light)===null||t===void 0)&&t.hasTransition()||!((r=this.sky)===null||r===void 0)&&r.hasTransition()||!((u=this.projection)===null||u===void 0)&&u.hasTransition())return!0;for(const d in this.sourceCaches)if(this.sourceCaches[d].hasTransition())return!0;for(const d in this._layers)if(this._layers[d].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const r=this._changed;if(r){const d=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(d.length||y.length)&&this._updateWorkerLayers(d,y);for(const x in this._updatedSources){const S=this._updatedSources[x];if(S==="reload")this._reloadSource(x);else{if(S!=="clear")throw new Error(`Invalid action ${S}`);this._clearSource(x)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const x in this._updatedPaintProps)this._layers[x].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const u={};for(const d in this.sourceCaches){const y=this.sourceCaches[d];u[d]=y.used,y.used=!1}for(const d of this._order){const y=this._layers[d];y.recalculate(t,this._availableImages),!y.isHidden(t.zoom)&&y.source&&(this.sourceCaches[y.source].used=!0)}for(const d in u){const y=this.sourceCaches[d];!!u[d]!=!!y.used&&y.fire(new o.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:d}))}this.light.recalculate(t),this.sky.recalculate(t),this.projection.recalculate(t),this.z=t.zoom,r&&this.fire(new o.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,r){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:r})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,r={}){var u;this._checkLoaded();const d=this.serialize();if(t=r.transformStyle?r.transformStyle(d,t):t,((u=r.validate)===null||u===void 0||u)&&_o(this,o.u(t)))return!1;(t=o.bw(t)).layers=o.bu(t.layers);const y=o.bx(d,t),x=this._getOperationsToPerform(y);if(x.unimplemented.length>0)throw new Error(`Unimplemented: ${x.unimplemented.join(", ")}.`);if(x.operations.length===0)return!1;for(const S of x.operations)S();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const r=[],u=[];for(const d of t)switch(d.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":r.push(()=>this.addLayer.apply(this,d.args));break;case"removeLayer":r.push(()=>this.removeLayer.apply(this,d.args));break;case"setPaintProperty":r.push(()=>this.setPaintProperty.apply(this,d.args));break;case"setLayoutProperty":r.push(()=>this.setLayoutProperty.apply(this,d.args));break;case"setFilter":r.push(()=>this.setFilter.apply(this,d.args));break;case"addSource":r.push(()=>this.addSource.apply(this,d.args));break;case"removeSource":r.push(()=>this.removeSource.apply(this,d.args));break;case"setLayerZoomRange":r.push(()=>this.setLayerZoomRange.apply(this,d.args));break;case"setLight":r.push(()=>this.setLight.apply(this,d.args));break;case"setGeoJSONSourceData":r.push(()=>this.setGeoJSONSourceData.apply(this,d.args));break;case"setGlyphs":r.push(()=>this.setGlyphs.apply(this,d.args));break;case"setSprite":r.push(()=>this.setSprite.apply(this,d.args));break;case"setTerrain":r.push(()=>this.map.setTerrain.apply(this,d.args));break;case"setSky":r.push(()=>this.setSky.apply(this,d.args));break;case"setProjection":this.setProjection.apply(this,d.args);break;case"setTransition":r.push(()=>{});break;default:u.push(d.command)}return{operations:r,unimplemented:u}}addImage(t,r){if(this.getImage(t))return this.fire(new o.j(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,r),this._afterImageUpdated(t)}updateImage(t,r){this.imageManager.updateImage(t,r)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new o.j(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,r,u={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(o.u.source,`sources.${t}`,r,null,u))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const d=this.sourceCaches[t]=new W(t,r,this.dispatcher);d.style=this,d.setEventedParent(this,()=>({isSourceLoaded:d.loaded(),source:d.serialize(),sourceId:t})),d.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const u in this._layers)if(this._layers[u].source===t)return this.fire(new o.j(new Error(`Source "${t}" cannot be removed while layer "${u}" is using it.`)));const r=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],r.fire(new o.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),r.setEventedParent(null),r.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,r){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const u=this.sourceCaches[t].getSource();if(u.type!=="geojson")throw new Error(`geojsonSource.type is ${u.type}, which is !== 'geojson`);u.setData(r),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,r,u={}){this._checkLoaded();const d=t.id;if(this.getLayer(d))return void this.fire(new o.j(new Error(`Layer "${d}" already exists on this map.`)));let y;if(t.type==="custom"){if(_o(this,o.by(t)))return;y=o.bv(t)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(d,t.source),t=o.bw(t),t=o.e(t,{source:d})),this._validate(o.u.layer,`layers.${d}`,t,{arrayIndex:-1},u))return;y=o.bv(t),this._validateLayer(y),y.setEventedParent(this,{layer:{id:d}})}const x=r?this._order.indexOf(r):this._order.length;if(r&&x===-1)this.fire(new o.j(new Error(`Cannot add layer "${d}" before non-existing layer "${r}".`)));else{if(this._order.splice(x,0,d),this._layerOrderChanged=!0,this._layers[d]=y,this._removedLayers[d]&&y.source&&y.type!=="custom"){const S=this._removedLayers[d];delete this._removedLayers[d],S.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.sourceCaches[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}moveLayer(t,r){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new o.j(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===r)return;const u=this._order.indexOf(t);this._order.splice(u,1);const d=r?this._order.indexOf(r):this._order.length;r&&d===-1?this.fire(new o.j(new Error(`Cannot move layer "${t}" before non-existing layer "${r}".`))):(this._order.splice(d,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const r=this._layers[t];if(!r)return void this.fire(new o.j(new Error(`Cannot remove non-existing layer "${t}".`)));r.setEventedParent(null);const u=this._order.indexOf(t);this._order.splice(u,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=r,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],r.onRemove&&r.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,r,u){this._checkLoaded();const d=this.getLayer(t);d?d.minzoom===r&&d.maxzoom===u||(r!=null&&(d.minzoom=r),u!=null&&(d.maxzoom=u),this._updateLayer(d)):this.fire(new o.j(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,r,u={}){this._checkLoaded();const d=this.getLayer(t);if(d){if(!o.bz(d.filter,r))return r==null?(d.filter=void 0,void this._updateLayer(d)):void(this._validate(o.u.filter,`layers.${d.id}.filter`,r,null,u)||(d.filter=o.bw(r),this._updateLayer(d)))}else this.fire(new o.j(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return o.bw(this.getLayer(t).filter)}setLayoutProperty(t,r,u,d={}){this._checkLoaded();const y=this.getLayer(t);y?o.bz(y.getLayoutProperty(r),u)||(y.setLayoutProperty(r,u,d),this._updateLayer(y)):this.fire(new o.j(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,r){const u=this.getLayer(t);if(u)return u.getLayoutProperty(r);this.fire(new o.j(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,r,u,d={}){this._checkLoaded();const y=this.getLayer(t);y?o.bz(y.getPaintProperty(r),u)||(y.setPaintProperty(r,u,d)&&this._updateLayer(y),this._changed=!0,this._updatedPaintProps[t]=!0,this._serializedLayers=null):this.fire(new o.j(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,r){return this.getLayer(t).getPaintProperty(r)}setFeatureState(t,r){this._checkLoaded();const u=t.source,d=t.sourceLayer,y=this.sourceCaches[u];if(y===void 0)return void this.fire(new o.j(new Error(`The source '${u}' does not exist in the map's style.`)));const x=y.getSource().type;x==="geojson"&&d?this.fire(new o.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||d?(t.id===void 0&&this.fire(new o.j(new Error("The feature id parameter must be provided."))),y.setFeatureState(d,t.id,r)):this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,r){this._checkLoaded();const u=t.source,d=this.sourceCaches[u];if(d===void 0)return void this.fire(new o.j(new Error(`The source '${u}' does not exist in the map's style.`)));const y=d.getSource().type,x=y==="vector"?t.sourceLayer:void 0;y!=="vector"||x?r&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new o.j(new Error("A feature id is required to remove its specific state property."))):d.removeFeatureState(x,t.id,r):this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const r=t.source,u=t.sourceLayer,d=this.sourceCaches[r];if(d!==void 0)return d.getSource().type!=="vector"||u?(t.id===void 0&&this.fire(new o.j(new Error("The feature id parameter must be provided."))),d.getFeatureState(u,t.id)):void this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.j(new Error(`The source '${r}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=o.bA(this.sourceCaches,y=>y.serialize()),r=this._serializeByIds(this._order,!0),u=this.map.getTerrain()||void 0,d=this.stylesheet;return o.bB({version:d.version,name:d.name,metadata:d.metadata,light:d.light,sky:d.sky,center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,sprite:d.sprite,glyphs:d.glyphs,transition:d.transition,projection:d.projection,sources:t,layers:r,terrain:u},y=>y!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const r=x=>this._layers[x].type==="fill-extrusion",u={},d=[];for(let x=this._order.length-1;x>=0;x--){const S=this._order[x];if(r(S)){u[S]=x;for(const P of t){const E=P[S];if(E)for(const B of E)d.push(B)}}}d.sort((x,S)=>S.intersectionZ-x.intersectionZ);const y=[];for(let x=this._order.length-1;x>=0;x--){const S=this._order[x];if(r(S))for(let P=d.length-1;P>=0;P--){const E=d[P].feature;if(u[E.layer.id]<x)break;y.push(E),d.pop()}else for(const P of t){const E=P[S];if(E)for(const B of E)y.push(B.feature)}}return y}queryRenderedFeatures(t,r,u){r&&r.filter&&this._validate(o.u.filter,"queryRenderedFeatures.filter",r.filter,null,r);const d={};if(r&&r.layers){if(!(Array.isArray(r.layers)||r.layers instanceof Set))return this.fire(new o.j(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const E of r.layers){const B=this._layers[E];if(!B)return this.fire(new o.j(new Error(`The layer '${E}' does not exist in the map's style and cannot be queried for features.`))),[];d[B.source]=!0}}const y=[];r.availableImages=this._availableImages;const x=this._serializedAllLayers(),S=r.layers instanceof Set?r.layers:Array.isArray(r.layers)?new Set(r.layers):null,P=Object.assign(Object.assign({},r),{layers:S});for(const E in this.sourceCaches)r.layers&&!d[E]||y.push(On(this.sourceCaches[E],this._layers,x,t,P,u));return this.placement&&y.push(function(E,B,V,j,X,Y,le){const se={},ce=Y.queryRenderedSymbols(j),fe=[];for(const we of Object.keys(ce).map(Number))fe.push(le[we]);fe.sort(ri);for(const we of fe){const Te=we.featureIndex.lookupSymbolFeatures(ce[we.bucketInstanceId],B,we.bucketIndex,we.sourceLayerIndex,X.filter,X.layers,X.availableImages,E);for(const Ie in Te){const De=se[Ie]=se[Ie]||[],Re=Te[Ie];Re.sort((Ge,Ze)=>{const rt=we.featureSortOrder;if(rt){const lt=rt.indexOf(Ge.featureIndex);return rt.indexOf(Ze.featureIndex)-lt}return Ze.featureIndex-Ge.featureIndex});for(const Ge of Re)De.push(Ge)}}return function(we,Te,Ie){for(const De in we)for(const Re of we[De])En(Re,Ie[Te[De].source]);return we}(se,E,V)}(this._layers,x,this.sourceCaches,t,P,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(t,r){r&&r.filter&&this._validate(o.u.filter,"querySourceFeatures.filter",r.filter,null,r);const u=this.sourceCaches[t];return u?function(d,y){const x=d.getRenderableIds().map(E=>d.getTileByID(E)),S=[],P={};for(let E=0;E<x.length;E++){const B=x[E],V=B.tileID.canonical.key;P[V]||(P[V]=!0,B.querySourceFeatures(S,y))}return S}(u,r):[]}getLight(){return this.light.getLight()}setLight(t,r={}){this._checkLoaded();const u=this.light.getLight();let d=!1;for(const x in t)if(!o.bz(t[x],u[x])){d=!0;break}if(!d)return;const y={now:O.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,r),this.light.updateTransitions(y)}getProjection(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.projection}setProjection(t){if(this._checkLoaded(),this.projection){if(this.projection.name===t.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=t,this._setProjectionInternal(t.type)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,r={}){this._checkLoaded();const u=this.getSky();let d=!1;if(!t&&!u)return;if(t&&!u)d=!0;else if(!t&&u)d=!0;else for(const x in t)if(!o.bz(t[x],u[x])){d=!0;break}if(!d)return;const y={now:O.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,r),this.sky.updateTransitions(y)}_setProjectionInternal(t){const r=function(u){if(Array.isArray(u)){const d=new Du({type:u});return{projection:d,transform:new Bs,cameraHelper:new ll(d)}}switch(u){case"mercator":return{projection:new tl,transform:new ja,cameraHelper:new ac};case"globe":{const d=new Du({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:d,transform:new Bs,cameraHelper:new ll(d)}}case"vertical-perspective":return{projection:new Wd,transform:new oc,cameraHelper:new Vr};default:return o.w(`Unknown projection name: ${u}. Falling back to mercator projection.`),{projection:new tl,transform:new ja,cameraHelper:new ac}}}(t);this.projection=r.projection,this.map.migrateProjection(r.transform,r.cameraHelper);for(const u in this.sourceCaches)this.sourceCaches[u].reload()}_validate(t,r,u,d,y={}){return(!y||y.validate!==!1)&&_o(this,t.call(o.u,o.e({key:r,style:this.serialize(),value:u,styleSpec:o.v},d)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Dn().off(Wt,this._rtlPluginLoaded);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this.sourceCaches){const u=this.sourceCaches[r];u.setEventedParent(null),u.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const r in this.sourceCaches)this.sourceCaches[r].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,r,u,d,y=!1){let x=!1,S=!1;const P={};for(const E of this._order){const B=this._layers[E];if(B.type!=="symbol")continue;if(!P[B.source]){const j=this.sourceCaches[B.source];P[B.source]=j.getRenderableIds(!0).map(X=>j.getTileByID(X)).sort((X,Y)=>Y.tileID.overscaledZ-X.tileID.overscaledZ||(X.tileID.isLessThan(Y.tileID)?-1:1))}const V=this.crossTileSymbolIndex.addLayer(B,P[B.source],t.center.lng);x=x||V}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||u===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(O.now(),t.zoom))&&(this.pauseablePlacement=new Hd(t,this.map.terrain,this._order,y,r,u,d,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,P),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(O.now()),S=!0),x&&this.pauseablePlacement.placement.setStale()),S||x)for(const E of this._order){const B=this._layers[E];B.type==="symbol"&&this.placement.updateLayerOpacities(B,P[B.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(O.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,r){return o._(this,void 0,void 0,function*(){const u=yield this.imageManager.getImages(r.icons);this._updateTilesForChangedImages();const d=this.sourceCaches[r.source];return d&&d.setDependencies(r.tileID.key,r.type,r.icons),u})}getGlyphs(t,r){return o._(this,void 0,void 0,function*(){const u=yield this.glyphManager.getGlyphs(r.stacks),d=this.sourceCaches[r.source];return d&&d.setDependencies(r.tileID.key,r.type,[""]),u})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,r={}){this._checkLoaded(),t&&this._validate(o.u.glyphs,"glyphs",t,null,r)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,r,u={},d){this._checkLoaded();const y=[{id:t,url:r}],x=[...de(this.stylesheet.sprite),...y];this._validate(o.u.sprite,"sprite",x,null,u)||(this.stylesheet.sprite=x,this._loadSprite(y,!0,d))}removeSprite(t){this._checkLoaded();const r=de(this.stylesheet.sprite);if(r.find(u=>u.id===t)){if(this._spritesImagesIds[t])for(const u of this._spritesImagesIds[t])this.imageManager.removeImage(u),this._changedImages[u]=!0;r.splice(r.findIndex(u=>u.id===t),1),this.stylesheet.sprite=r.length>0?r:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}else this.fire(new o.j(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return de(this.stylesheet.sprite)}setSprite(t,r={},u){this._checkLoaded(),t&&this._validate(o.u.sprite,"sprite",t,null,r)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,u):(this._unloadSprite(),u&&u(null)))}}var jm=o.aA([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Fu{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,r,u,d,y,x,S,P,E){this.context=t;let B=this.boundPaintVertexBuffers.length!==d.length;for(let V=0;!B&&V<d.length;V++)this.boundPaintVertexBuffers[V]!==d[V]&&(B=!0);!this.vao||this.boundProgram!==r||this.boundLayoutVertexBuffer!==u||B||this.boundIndexBuffer!==y||this.boundVertexOffset!==x||this.boundDynamicVertexBuffer!==S||this.boundDynamicVertexBuffer2!==P||this.boundDynamicVertexBuffer3!==E?this.freshBind(r,u,d,y,x,S,P,E):(t.bindVertexArray.set(this.vao),S&&S.bind(),y&&y.dynamicDraw&&y.bind(),P&&P.bind(),E&&E.bind())}freshBind(t,r,u,d,y,x,S,P){const E=t.numAttributes,B=this.context,V=B.gl;this.vao&&this.destroy(),this.vao=B.createVertexArray(),B.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=r,this.boundPaintVertexBuffers=u,this.boundIndexBuffer=d,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=S,this.boundDynamicVertexBuffer3=P,r.enableAttributes(V,t);for(const j of u)j.enableAttributes(V,t);x&&x.enableAttributes(V,t),S&&S.enableAttributes(V,t),P&&P.enableAttributes(V,t),r.bind(),r.setVertexAttribPointers(V,t,y);for(const j of u)j.bind(),j.setVertexAttribPointers(V,t,y);x&&(x.bind(),x.setVertexAttribPointers(V,t,y)),d&&d.bind(),S&&(S.bind(),S.setVertexAttribPointers(V,t,y)),P&&(P.bind(),P.setVertexAttribPointers(V,t,y)),B.currentNumAttributes=E}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const cl=(g,t,r,u,d)=>({u_texture:0,u_ele_delta:g,u_fog_matrix:t,u_fog_color:r?r.properties.get("fog-color"):o.b4.white,u_fog_ground_blend:r?r.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:d?0:r?r.calculateFogBlendOpacity(u):0,u_horizon_color:r?r.properties.get("horizon-color"):o.b4.white,u_horizon_fog_blend:r?r.properties.get("horizon-fog-blend"):1,u_is_globe_mode:d?1:0}),ul={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function lc(g){const t=[];for(let r=0;r<g.length;r++){if(g[r]===null)continue;const u=g[r].split(" ");t.push(u.pop())}return t}class cc{constructor(t,r,u,d,y,x,S,P){const E=t.gl;this.program=E.createProgram();const B=lc(r.staticAttributes),V=u?u.getBinderAttributes():[],j=B.concat(V),X=Ta.prelude.staticUniforms?lc(Ta.prelude.staticUniforms):[],Y=S.staticUniforms?lc(S.staticUniforms):[],le=r.staticUniforms?lc(r.staticUniforms):[],se=u?u.getBinderUniforms():[],ce=X.concat(Y).concat(le).concat(se),fe=[];for(const Ze of ce)fe.indexOf(Ze)<0&&fe.push(Ze);const we=u?u.defines():[];ca(E)&&we.unshift("#version 300 es"),y&&we.push("#define OVERDRAW_INSPECTOR;"),x&&we.push("#define TERRAIN3D;"),P&&we.push(P);let Te=we.concat(Ta.prelude.fragmentSource,S.fragmentSource,r.fragmentSource).join(`
`),Ie=we.concat(Ta.prelude.vertexSource,S.vertexSource,r.vertexSource).join(`
`);ca(E)||(Te=function(Ze){return Ze.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(Te),Ie=function(Ze){return Ze.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Ie));const De=E.createShader(E.FRAGMENT_SHADER);if(E.isContextLost())return void(this.failedToCreate=!0);if(E.shaderSource(De,Te),E.compileShader(De),!E.getShaderParameter(De,E.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${E.getShaderInfoLog(De)}`);E.attachShader(this.program,De);const Re=E.createShader(E.VERTEX_SHADER);if(E.isContextLost())return void(this.failedToCreate=!0);if(E.shaderSource(Re,Ie),E.compileShader(Re),!E.getShaderParameter(Re,E.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${E.getShaderInfoLog(Re)}`);E.attachShader(this.program,Re),this.attributes={};const Ge={};this.numAttributes=j.length;for(let Ze=0;Ze<this.numAttributes;Ze++)j[Ze]&&(E.bindAttribLocation(this.program,Ze,j[Ze]),this.attributes[j[Ze]]=Ze);if(E.linkProgram(this.program),!E.getProgramParameter(this.program,E.LINK_STATUS))throw new Error(`Program failed to link: ${E.getProgramInfoLog(this.program)}`);E.deleteShader(Re),E.deleteShader(De);for(let Ze=0;Ze<fe.length;Ze++){const rt=fe[Ze];if(rt&&!Ge[rt]){const lt=E.getUniformLocation(this.program,rt);lt&&(Ge[rt]=lt)}}this.fixedUniforms=d(t,Ge),this.terrainUniforms=((Ze,rt)=>({u_depth:new o.bC(Ze,rt.u_depth),u_terrain:new o.bC(Ze,rt.u_terrain),u_terrain_dim:new o.b5(Ze,rt.u_terrain_dim),u_terrain_matrix:new o.bD(Ze,rt.u_terrain_matrix),u_terrain_unpack:new o.bE(Ze,rt.u_terrain_unpack),u_terrain_exaggeration:new o.b5(Ze,rt.u_terrain_exaggeration)}))(t,Ge),this.projectionUniforms=((Ze,rt)=>({u_projection_matrix:new o.bD(Ze,rt.u_projection_matrix),u_projection_tile_mercator_coords:new o.bE(Ze,rt.u_projection_tile_mercator_coords),u_projection_clipping_plane:new o.bE(Ze,rt.u_projection_clipping_plane),u_projection_transition:new o.b5(Ze,rt.u_projection_transition),u_projection_fallback_matrix:new o.bD(Ze,rt.u_projection_fallback_matrix)}))(t,Ge),this.binderUniforms=u?u.getUniforms(t,Ge):[]}draw(t,r,u,d,y,x,S,P,E,B,V,j,X,Y,le,se,ce,fe,we){const Te=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(u),t.setStencilMode(d),t.setColorMode(y),t.setCullFace(x),P){t.activeTexture.set(Te.TEXTURE2),Te.bindTexture(Te.TEXTURE_2D,P.depthTexture),t.activeTexture.set(Te.TEXTURE3),Te.bindTexture(Te.TEXTURE_2D,P.texture);for(const De in this.terrainUniforms)this.terrainUniforms[De].set(P[De])}if(E)for(const De in E)this.projectionUniforms[ul[De]].set(E[De]);if(S)for(const De in this.fixedUniforms)this.fixedUniforms[De].set(S[De]);se&&se.setUniforms(t,this.binderUniforms,Y,{zoom:le});let Ie=0;switch(r){case Te.LINES:Ie=2;break;case Te.TRIANGLES:Ie=3;break;case Te.LINE_STRIP:Ie=1}for(const De of X.get()){const Re=De.vaos||(De.vaos={});(Re[B]||(Re[B]=new Fu)).bind(t,this,V,se?se.getPaintVertexBuffers():[],j,De.vertexOffset,ce,fe,we),Te.drawElements(r,De.primitiveLength*Ie,Te.UNSIGNED_SHORT,De.primitiveOffset*Ie*2)}}}function Yd(g,t,r){const u=1/o.at(r,1,t.transform.tileZoom),d=Math.pow(2,r.tileID.overscaledZ),y=r.tileSize*Math.pow(2,t.transform.tileZoom)/d,x=y*(r.tileID.canonical.x+r.tileID.wrap*d),S=y*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[u,g.fromScale,g.toScale],u_fade:g.t,u_pixel_coord_upper:[x>>16,S>>16],u_pixel_coord_lower:[65535&x,65535&S]}}const Fs=(g,t,r,u)=>{const d=g.style.light,y=d.properties.get("position"),x=[y.x,y.y,y.z],S=o.bI();d.properties.get("anchor")==="viewport"&&o.bJ(S,g.transform.bearingInRadians),o.bK(x,x,S);const P=g.transform.transformLightDirection(x),E=d.properties.get("color");return{u_lightpos:x,u_lightpos_globe:P,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[E.r,E.g,E.b],u_vertical_gradient:+t,u_opacity:r,u_fill_translate:u}},Um=(g,t,r,u,d,y,x)=>o.e(Fs(g,t,r,u),Yd(y,g,x),{u_height_factor:-Math.pow(2,d.overscaledZ)/x.tileSize/8}),Ou=(g,t,r,u)=>o.e(Yd(t,g,r),{u_fill_translate:u}),Gm=(g,t)=>({u_world:g,u_fill_translate:t}),Jd=(g,t,r,u,d)=>o.e(Ou(g,t,r,d),{u_world:u}),Vu=(g,t,r,u,d)=>{const y=g.transform;let x,S,P=0;if(r.paint.get("circle-pitch-alignment")==="map"){const E=o.at(t,1,y.zoom);x=!0,S=[E,E],P=E/(o.X*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*d}else x=!1,S=y.pixelsToGLUnits;return{u_camera_to_center_distance:y.cameraToCenterDistance,u_scale_with_map:+(r.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+x,u_device_pixel_ratio:g.pixelRatio,u_extrude_scale:S,u_globe_extrude_scale:P,u_translate:u}},Qd=g=>({u_pixel_extrude_scale:[1/g.width,1/g.height]}),ef=g=>({u_viewport_size:[g.width,g.height]}),Nu=(g,t=1)=>({u_color:g,u_overlay:0,u_overlay_scale:t}),$u=(g,t,r,u)=>{const d=o.at(g,1,t)/(o.X*Math.pow(2,g.tileID.overscaledZ))*2*Math.PI*u;return{u_extrude_scale:o.at(g,1,t),u_intensity:r,u_globe_extrude_scale:d}},cs=(g,t,r,u)=>{const d=o.H();o.bL(d,0,g.width,g.height,0,0,1);const y=g.context.gl;return{u_matrix:d,u_world:[y.drawingBufferWidth,y.drawingBufferHeight],u_image:r,u_color_ramp:u,u_opacity:t.paint.get("heatmap-opacity")}},tf=(g,t,r)=>{const u=r.paint.get("hillshade-shadow-color"),d=r.paint.get("hillshade-highlight-color"),y=r.paint.get("hillshade-accent-color");let x=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);return r.paint.get("hillshade-illumination-anchor")==="viewport"&&(x+=g.transform.bearingInRadians),{u_image:0,u_latrange:hl(0,t.tileID),u_light:[r.paint.get("hillshade-exaggeration"),x],u_shadow:u,u_highlight:d,u_accent:y}},nf=(g,t)=>{const r=t.stride,u=o.H();return o.bL(u,0,o.X,-8192,0,0,1),o.J(u,u,[0,-8192,0]),{u_matrix:u,u_image:1,u_dimension:[r,r],u_zoom:g.overscaledZ,u_unpack:t.getUnpackVector()}};function hl(g,t){const r=Math.pow(2,t.canonical.z),u=t.canonical.y;return[new o.Y(0,u/r).toLngLat().lat,new o.Y(0,(u+1)/r).toLngLat().lat]}const ju=(g,t,r,u)=>{const d=g.transform;return{u_translation:Gu(g,t,r),u_ratio:u/o.at(t,1,d.zoom),u_device_pixel_ratio:g.pixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},uc=(g,t,r,u,d)=>o.e(ju(g,t,r,u),{u_image:0,u_image_height:d}),Hm=(g,t,r,u,d)=>{const y=g.transform,x=Uu(t,y);return{u_translation:Gu(g,t,r),u_texsize:t.imageAtlasTexture.size,u_ratio:u/o.at(t,1,y.zoom),u_device_pixel_ratio:g.pixelRatio,u_image:0,u_scale:[x,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},Zm=(g,t,r,u,d,y)=>{const x=g.lineAtlas,S=Uu(t,g.transform),P=r.layout.get("line-cap")==="round",E=x.getDash(d.from,P),B=x.getDash(d.to,P),V=E.width*y.fromScale,j=B.width*y.toScale;return o.e(ju(g,t,r,u),{u_patternscale_a:[S/V,-E.height/2],u_patternscale_b:[S/j,-B.height/2],u_sdfgamma:x.width/(256*Math.min(V,j)*g.pixelRatio)/2,u_image:0,u_tex_y_a:E.y,u_tex_y_b:B.y,u_mix:y.t})};function Uu(g,t){return 1/o.at(g,1,t.tileZoom)}function Gu(g,t,r){return o.au(g.transform,t,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}const rf=(g,t,r,u,d)=>{return{u_tl_parent:g,u_scale_parent:t,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*u.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:u.paint.get("raster-brightness-min"),u_brightness_high:u.paint.get("raster-brightness-max"),u_saturation_factor:(x=u.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(y=u.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:Hu(u.paint.get("raster-hue-rotate")),u_coords_top:[d[0].x,d[0].y,d[1].x,d[1].y],u_coords_bottom:[d[3].x,d[3].y,d[2].x,d[2].y]};var y,x};function Hu(g){g*=Math.PI/180;const t=Math.sin(g),r=Math.cos(g);return[(2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3]}const Zu=(g,t,r,u,d,y,x,S,P,E,B,V,j)=>{const X=x.transform;return{u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:X.cameraToCenterDistance,u_pitch:X.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:X.width/X.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_label_plane_matrix:S,u_coord_matrix:P,u_is_text:+B,u_pitch_with_map:+u,u_is_along_line:d,u_is_variable_anchor:y,u_texsize:V,u_texture:0,u_translation:E,u_pitched_scale:j}},dl=(g,t,r,u,d,y,x,S,P,E,B,V,j,X)=>{const Y=x.transform;return o.e(Zu(g,t,r,u,d,y,x,S,P,E,B,V,X),{u_gamma_scale:u?Math.cos(Y.pitch*Math.PI/180)*Y.cameraToCenterDistance:1,u_device_pixel_ratio:x.pixelRatio,u_is_halo:1})},Ga=(g,t,r,u,d,y,x,S,P,E,B,V,j)=>o.e(dl(g,t,r,u,d,y,x,S,P,E,!0,B,0,j),{u_texsize_icon:V,u_texture_icon:1}),qu=(g,t)=>({u_opacity:g,u_color:t}),Wu=(g,t,r,u,d)=>o.e(function(y,x,S,P){const E=S.imageManager.getPattern(y.from.toString()),B=S.imageManager.getPattern(y.to.toString()),{width:V,height:j}=S.imageManager.getPixelSize(),X=Math.pow(2,P.tileID.overscaledZ),Y=P.tileSize*Math.pow(2,S.transform.tileZoom)/X,le=Y*(P.tileID.canonical.x+P.tileID.wrap*X),se=Y*P.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:E.tl,u_pattern_br_a:E.br,u_pattern_tl_b:B.tl,u_pattern_br_b:B.br,u_texsize:[V,j],u_mix:x.t,u_pattern_size_a:E.displaySize,u_pattern_size_b:B.displaySize,u_scale_a:x.fromScale,u_scale_b:x.toScale,u_tile_units_to_pixels:1/o.at(P,1,S.transform.tileZoom),u_pixel_coord_upper:[le>>16,se>>16],u_pixel_coord_lower:[65535&le,65535&se]}}(r,d,t,u),{u_opacity:g}),hc=(g,t)=>{},af={fillExtrusion:(g,t)=>({u_lightpos:new o.bG(g,t.u_lightpos),u_lightpos_globe:new o.bG(g,t.u_lightpos_globe),u_lightintensity:new o.b5(g,t.u_lightintensity),u_lightcolor:new o.bG(g,t.u_lightcolor),u_vertical_gradient:new o.b5(g,t.u_vertical_gradient),u_opacity:new o.b5(g,t.u_opacity),u_fill_translate:new o.bH(g,t.u_fill_translate)}),fillExtrusionPattern:(g,t)=>({u_lightpos:new o.bG(g,t.u_lightpos),u_lightpos_globe:new o.bG(g,t.u_lightpos_globe),u_lightintensity:new o.b5(g,t.u_lightintensity),u_lightcolor:new o.bG(g,t.u_lightcolor),u_vertical_gradient:new o.b5(g,t.u_vertical_gradient),u_height_factor:new o.b5(g,t.u_height_factor),u_opacity:new o.b5(g,t.u_opacity),u_fill_translate:new o.bH(g,t.u_fill_translate),u_image:new o.bC(g,t.u_image),u_texsize:new o.bH(g,t.u_texsize),u_pixel_coord_upper:new o.bH(g,t.u_pixel_coord_upper),u_pixel_coord_lower:new o.bH(g,t.u_pixel_coord_lower),u_scale:new o.bG(g,t.u_scale),u_fade:new o.b5(g,t.u_fade)}),fill:(g,t)=>({u_fill_translate:new o.bH(g,t.u_fill_translate)}),fillPattern:(g,t)=>({u_image:new o.bC(g,t.u_image),u_texsize:new o.bH(g,t.u_texsize),u_pixel_coord_upper:new o.bH(g,t.u_pixel_coord_upper),u_pixel_coord_lower:new o.bH(g,t.u_pixel_coord_lower),u_scale:new o.bG(g,t.u_scale),u_fade:new o.b5(g,t.u_fade),u_fill_translate:new o.bH(g,t.u_fill_translate)}),fillOutline:(g,t)=>({u_world:new o.bH(g,t.u_world),u_fill_translate:new o.bH(g,t.u_fill_translate)}),fillOutlinePattern:(g,t)=>({u_world:new o.bH(g,t.u_world),u_image:new o.bC(g,t.u_image),u_texsize:new o.bH(g,t.u_texsize),u_pixel_coord_upper:new o.bH(g,t.u_pixel_coord_upper),u_pixel_coord_lower:new o.bH(g,t.u_pixel_coord_lower),u_scale:new o.bG(g,t.u_scale),u_fade:new o.b5(g,t.u_fade),u_fill_translate:new o.bH(g,t.u_fill_translate)}),circle:(g,t)=>({u_camera_to_center_distance:new o.b5(g,t.u_camera_to_center_distance),u_scale_with_map:new o.bC(g,t.u_scale_with_map),u_pitch_with_map:new o.bC(g,t.u_pitch_with_map),u_extrude_scale:new o.bH(g,t.u_extrude_scale),u_device_pixel_ratio:new o.b5(g,t.u_device_pixel_ratio),u_globe_extrude_scale:new o.b5(g,t.u_globe_extrude_scale),u_translate:new o.bH(g,t.u_translate)}),collisionBox:(g,t)=>({u_pixel_extrude_scale:new o.bH(g,t.u_pixel_extrude_scale)}),collisionCircle:(g,t)=>({u_viewport_size:new o.bH(g,t.u_viewport_size)}),debug:(g,t)=>({u_color:new o.bF(g,t.u_color),u_overlay:new o.bC(g,t.u_overlay),u_overlay_scale:new o.b5(g,t.u_overlay_scale)}),depth:hc,clippingMask:hc,heatmap:(g,t)=>({u_extrude_scale:new o.b5(g,t.u_extrude_scale),u_intensity:new o.b5(g,t.u_intensity),u_globe_extrude_scale:new o.b5(g,t.u_globe_extrude_scale)}),heatmapTexture:(g,t)=>({u_matrix:new o.bD(g,t.u_matrix),u_world:new o.bH(g,t.u_world),u_image:new o.bC(g,t.u_image),u_color_ramp:new o.bC(g,t.u_color_ramp),u_opacity:new o.b5(g,t.u_opacity)}),hillshade:(g,t)=>({u_image:new o.bC(g,t.u_image),u_latrange:new o.bH(g,t.u_latrange),u_light:new o.bH(g,t.u_light),u_shadow:new o.bF(g,t.u_shadow),u_highlight:new o.bF(g,t.u_highlight),u_accent:new o.bF(g,t.u_accent)}),hillshadePrepare:(g,t)=>({u_matrix:new o.bD(g,t.u_matrix),u_image:new o.bC(g,t.u_image),u_dimension:new o.bH(g,t.u_dimension),u_zoom:new o.b5(g,t.u_zoom),u_unpack:new o.bE(g,t.u_unpack)}),line:(g,t)=>({u_translation:new o.bH(g,t.u_translation),u_ratio:new o.b5(g,t.u_ratio),u_device_pixel_ratio:new o.b5(g,t.u_device_pixel_ratio),u_units_to_pixels:new o.bH(g,t.u_units_to_pixels)}),lineGradient:(g,t)=>({u_translation:new o.bH(g,t.u_translation),u_ratio:new o.b5(g,t.u_ratio),u_device_pixel_ratio:new o.b5(g,t.u_device_pixel_ratio),u_units_to_pixels:new o.bH(g,t.u_units_to_pixels),u_image:new o.bC(g,t.u_image),u_image_height:new o.b5(g,t.u_image_height)}),linePattern:(g,t)=>({u_translation:new o.bH(g,t.u_translation),u_texsize:new o.bH(g,t.u_texsize),u_ratio:new o.b5(g,t.u_ratio),u_device_pixel_ratio:new o.b5(g,t.u_device_pixel_ratio),u_image:new o.bC(g,t.u_image),u_units_to_pixels:new o.bH(g,t.u_units_to_pixels),u_scale:new o.bG(g,t.u_scale),u_fade:new o.b5(g,t.u_fade)}),lineSDF:(g,t)=>({u_translation:new o.bH(g,t.u_translation),u_ratio:new o.b5(g,t.u_ratio),u_device_pixel_ratio:new o.b5(g,t.u_device_pixel_ratio),u_units_to_pixels:new o.bH(g,t.u_units_to_pixels),u_patternscale_a:new o.bH(g,t.u_patternscale_a),u_patternscale_b:new o.bH(g,t.u_patternscale_b),u_sdfgamma:new o.b5(g,t.u_sdfgamma),u_image:new o.bC(g,t.u_image),u_tex_y_a:new o.b5(g,t.u_tex_y_a),u_tex_y_b:new o.b5(g,t.u_tex_y_b),u_mix:new o.b5(g,t.u_mix)}),raster:(g,t)=>({u_tl_parent:new o.bH(g,t.u_tl_parent),u_scale_parent:new o.b5(g,t.u_scale_parent),u_buffer_scale:new o.b5(g,t.u_buffer_scale),u_fade_t:new o.b5(g,t.u_fade_t),u_opacity:new o.b5(g,t.u_opacity),u_image0:new o.bC(g,t.u_image0),u_image1:new o.bC(g,t.u_image1),u_brightness_low:new o.b5(g,t.u_brightness_low),u_brightness_high:new o.b5(g,t.u_brightness_high),u_saturation_factor:new o.b5(g,t.u_saturation_factor),u_contrast_factor:new o.b5(g,t.u_contrast_factor),u_spin_weights:new o.bG(g,t.u_spin_weights),u_coords_top:new o.bE(g,t.u_coords_top),u_coords_bottom:new o.bE(g,t.u_coords_bottom)}),symbolIcon:(g,t)=>({u_is_size_zoom_constant:new o.bC(g,t.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bC(g,t.u_is_size_feature_constant),u_size_t:new o.b5(g,t.u_size_t),u_size:new o.b5(g,t.u_size),u_camera_to_center_distance:new o.b5(g,t.u_camera_to_center_distance),u_pitch:new o.b5(g,t.u_pitch),u_rotate_symbol:new o.bC(g,t.u_rotate_symbol),u_aspect_ratio:new o.b5(g,t.u_aspect_ratio),u_fade_change:new o.b5(g,t.u_fade_change),u_label_plane_matrix:new o.bD(g,t.u_label_plane_matrix),u_coord_matrix:new o.bD(g,t.u_coord_matrix),u_is_text:new o.bC(g,t.u_is_text),u_pitch_with_map:new o.bC(g,t.u_pitch_with_map),u_is_along_line:new o.bC(g,t.u_is_along_line),u_is_variable_anchor:new o.bC(g,t.u_is_variable_anchor),u_texsize:new o.bH(g,t.u_texsize),u_texture:new o.bC(g,t.u_texture),u_translation:new o.bH(g,t.u_translation),u_pitched_scale:new o.b5(g,t.u_pitched_scale)}),symbolSDF:(g,t)=>({u_is_size_zoom_constant:new o.bC(g,t.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bC(g,t.u_is_size_feature_constant),u_size_t:new o.b5(g,t.u_size_t),u_size:new o.b5(g,t.u_size),u_camera_to_center_distance:new o.b5(g,t.u_camera_to_center_distance),u_pitch:new o.b5(g,t.u_pitch),u_rotate_symbol:new o.bC(g,t.u_rotate_symbol),u_aspect_ratio:new o.b5(g,t.u_aspect_ratio),u_fade_change:new o.b5(g,t.u_fade_change),u_label_plane_matrix:new o.bD(g,t.u_label_plane_matrix),u_coord_matrix:new o.bD(g,t.u_coord_matrix),u_is_text:new o.bC(g,t.u_is_text),u_pitch_with_map:new o.bC(g,t.u_pitch_with_map),u_is_along_line:new o.bC(g,t.u_is_along_line),u_is_variable_anchor:new o.bC(g,t.u_is_variable_anchor),u_texsize:new o.bH(g,t.u_texsize),u_texture:new o.bC(g,t.u_texture),u_gamma_scale:new o.b5(g,t.u_gamma_scale),u_device_pixel_ratio:new o.b5(g,t.u_device_pixel_ratio),u_is_halo:new o.bC(g,t.u_is_halo),u_translation:new o.bH(g,t.u_translation),u_pitched_scale:new o.b5(g,t.u_pitched_scale)}),symbolTextAndIcon:(g,t)=>({u_is_size_zoom_constant:new o.bC(g,t.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bC(g,t.u_is_size_feature_constant),u_size_t:new o.b5(g,t.u_size_t),u_size:new o.b5(g,t.u_size),u_camera_to_center_distance:new o.b5(g,t.u_camera_to_center_distance),u_pitch:new o.b5(g,t.u_pitch),u_rotate_symbol:new o.bC(g,t.u_rotate_symbol),u_aspect_ratio:new o.b5(g,t.u_aspect_ratio),u_fade_change:new o.b5(g,t.u_fade_change),u_label_plane_matrix:new o.bD(g,t.u_label_plane_matrix),u_coord_matrix:new o.bD(g,t.u_coord_matrix),u_is_text:new o.bC(g,t.u_is_text),u_pitch_with_map:new o.bC(g,t.u_pitch_with_map),u_is_along_line:new o.bC(g,t.u_is_along_line),u_is_variable_anchor:new o.bC(g,t.u_is_variable_anchor),u_texsize:new o.bH(g,t.u_texsize),u_texsize_icon:new o.bH(g,t.u_texsize_icon),u_texture:new o.bC(g,t.u_texture),u_texture_icon:new o.bC(g,t.u_texture_icon),u_gamma_scale:new o.b5(g,t.u_gamma_scale),u_device_pixel_ratio:new o.b5(g,t.u_device_pixel_ratio),u_is_halo:new o.bC(g,t.u_is_halo),u_translation:new o.bH(g,t.u_translation),u_pitched_scale:new o.b5(g,t.u_pitched_scale)}),background:(g,t)=>({u_opacity:new o.b5(g,t.u_opacity),u_color:new o.bF(g,t.u_color)}),backgroundPattern:(g,t)=>({u_opacity:new o.b5(g,t.u_opacity),u_image:new o.bC(g,t.u_image),u_pattern_tl_a:new o.bH(g,t.u_pattern_tl_a),u_pattern_br_a:new o.bH(g,t.u_pattern_br_a),u_pattern_tl_b:new o.bH(g,t.u_pattern_tl_b),u_pattern_br_b:new o.bH(g,t.u_pattern_br_b),u_texsize:new o.bH(g,t.u_texsize),u_mix:new o.b5(g,t.u_mix),u_pattern_size_a:new o.bH(g,t.u_pattern_size_a),u_pattern_size_b:new o.bH(g,t.u_pattern_size_b),u_scale_a:new o.b5(g,t.u_scale_a),u_scale_b:new o.b5(g,t.u_scale_b),u_pixel_coord_upper:new o.bH(g,t.u_pixel_coord_upper),u_pixel_coord_lower:new o.bH(g,t.u_pixel_coord_lower),u_tile_units_to_pixels:new o.b5(g,t.u_tile_units_to_pixels)}),terrain:(g,t)=>({u_texture:new o.bC(g,t.u_texture),u_ele_delta:new o.b5(g,t.u_ele_delta),u_fog_matrix:new o.bD(g,t.u_fog_matrix),u_fog_color:new o.bF(g,t.u_fog_color),u_fog_ground_blend:new o.b5(g,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new o.b5(g,t.u_fog_ground_blend_opacity),u_horizon_color:new o.bF(g,t.u_horizon_color),u_horizon_fog_blend:new o.b5(g,t.u_horizon_fog_blend),u_is_globe_mode:new o.b5(g,t.u_is_globe_mode)}),terrainDepth:(g,t)=>({u_ele_delta:new o.b5(g,t.u_ele_delta)}),terrainCoords:(g,t)=>({u_texture:new o.bC(g,t.u_texture),u_terrain_coords_id:new o.b5(g,t.u_terrain_coords_id),u_ele_delta:new o.b5(g,t.u_ele_delta)}),projectionErrorMeasurement:(g,t)=>({u_input:new o.b5(g,t.u_input),u_output_expected:new o.b5(g,t.u_output_expected)}),atmosphere:(g,t)=>({u_sun_pos:new o.bG(g,t.u_sun_pos),u_atmosphere_blend:new o.b5(g,t.u_atmosphere_blend),u_globe_position:new o.bG(g,t.u_globe_position),u_globe_radius:new o.b5(g,t.u_globe_radius),u_inv_proj_matrix:new o.bD(g,t.u_inv_proj_matrix)}),sky:(g,t)=>({u_sky_color:new o.bF(g,t.u_sky_color),u_horizon_color:new o.bF(g,t.u_horizon_color),u_horizon:new o.bH(g,t.u_horizon),u_horizon_normal:new o.bH(g,t.u_horizon_normal),u_sky_horizon_blend:new o.b5(g,t.u_sky_horizon_blend),u_sky_blend:new o.b5(g,t.u_sky_blend)})};class Xu{constructor(t,r,u){this.context=t;const d=t.gl;this.buffer=d.createBuffer(),this.dynamicDraw=!!u,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const r=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Os={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ku{constructor(t,r,u,d){this.length=r.length,this.attributes=u,this.itemSize=r.bytesPerElement,this.dynamicDraw=d,this.context=t;const y=t.gl;this.buffer=y.createBuffer(),t.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const r=this.context.gl;this.bind(),r.bufferSubData(r.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,r){for(let u=0;u<this.attributes.length;u++){const d=r.attributes[this.attributes[u].name];d!==void 0&&t.enableVertexAttribArray(d)}}setVertexAttribPointers(t,r,u){for(let d=0;d<this.attributes.length;d++){const y=this.attributes[d],x=r.attributes[y.name];x!==void 0&&t.vertexAttribPointer(x,y.components,t[Os[y.type]],!1,this.itemSize,y.offset+this.itemSize*(u||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Nn{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class qm extends Nn{getDefault(){return o.b4.transparent}set(t){const r=this.current;(t.r!==r.r||t.g!==r.g||t.b!==r.b||t.a!==r.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Wm extends Nn{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Xm extends Nn{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class sf extends Nn{getDefault(){return[!0,!0,!0,!0]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||t[3]!==r[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Km extends Nn{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class of extends Nn{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class dc extends Nn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const r=this.current;(t.func!==r.func||t.ref!==r.ref||t.mask!==r.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class fc extends Nn{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class pc extends Nn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST),this.current=t,this.dirty=!1}}class Yu extends Nn{getDefault(){return[0,1]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Vs extends Nn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST),this.current=t,this.dirty=!1}}class yo extends Nn{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class ea extends Nn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.BLEND):r.disable(r.BLEND),this.current=t,this.dirty=!1}}class lf extends Nn{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class cf extends Nn{getDefault(){return o.b4.transparent}set(t){const r=this.current;(t.r!==r.r||t.g!==r.g||t.b!==r.b||t.a!==r.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Ju extends Nn{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class Ns extends Nn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),this.current=t,this.dirty=!1}}class mc extends Nn{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class gc extends Nn{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class fl extends Nn{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class _c extends Nn{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class uf extends Nn{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||t[3]!==r[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class vo extends Nn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class bo extends Nn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class hf extends Nn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindTexture(r.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Qu extends Nn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Fn extends Nn{getDefault(){return null}set(t){const r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class yc extends Nn{getDefault(){return null}set(t){var r;if(t===this.current&&!this.dirty)return;const u=this.gl;ca(u)?u.bindVertexArray(t):(r=u.getExtension("OES_vertex_array_object"))===null||r===void 0||r.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class Ym extends Nn{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class df extends Nn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class pl extends Nn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class eh extends Nn{constructor(t,r){super(t),this.context=t,this.parent=r}getDefault(){return null}}class Jm extends eh{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class ff extends eh{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Qm extends eh{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,t),this.current=t,this.dirty=!1}}const vc="Framebuffer is not complete";class bc{constructor(t,r,u,d,y){this.context=t,this.width=r,this.height=u;const x=t.gl,S=this.framebuffer=x.createFramebuffer();if(this.colorAttachment=new Jm(t,S),d)this.depthAttachment=y?new Qm(t,S):new ff(t,S);else if(y)throw new Error("Stencil cannot be set without depth");if(x.checkFramebufferStatus(x.FRAMEBUFFER)!==x.FRAMEBUFFER_COMPLETE)throw new Error(vc)}destroy(){const t=this.context.gl,r=this.colorAttachment.get();if(r&&t.deleteTexture(r),this.depthAttachment){const u=this.depthAttachment.get();u&&t.deleteRenderbuffer(u)}t.deleteFramebuffer(this.framebuffer)}}class xc{constructor(t){var r,u;if(this.gl=t,this.clearColor=new qm(this),this.clearDepth=new Wm(this),this.clearStencil=new Xm(this),this.colorMask=new sf(this),this.depthMask=new Km(this),this.stencilMask=new of(this),this.stencilFunc=new dc(this),this.stencilOp=new fc(this),this.stencilTest=new pc(this),this.depthRange=new Yu(this),this.depthTest=new Vs(this),this.depthFunc=new yo(this),this.blend=new ea(this),this.blendFunc=new lf(this),this.blendColor=new cf(this),this.blendEquation=new Ju(this),this.cullFace=new Ns(this),this.cullFaceSide=new mc(this),this.frontFace=new gc(this),this.program=new fl(this),this.activeTexture=new _c(this),this.viewport=new uf(this),this.bindFramebuffer=new vo(this),this.bindRenderbuffer=new bo(this),this.bindTexture=new hf(this),this.bindVertexBuffer=new Qu(this),this.bindElementBuffer=new Fn(this),this.bindVertexArray=new yc(this),this.pixelStoreUnpack=new Ym(this),this.pixelStoreUnpackPremultiplyAlpha=new df(this),this.pixelStoreUnpackFlipY=new pl(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),ca(t)){this.HALF_FLOAT=t.HALF_FLOAT;const d=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(r=t.RGBA16F)!==null&&r!==void 0?r:d==null?void 0:d.RGBA16F_EXT,this.RGB16F=(u=t.RGB16F)!==null&&u!==void 0?u:d==null?void 0:d.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const d=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=d==null?void 0:d.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,r){return new Xu(this,t,r)}createVertexBuffer(t,r,u){return new Ku(this,t,r,u)}createRenderbuffer(t,r,u){const d=this.gl,y=d.createRenderbuffer();return this.bindRenderbuffer.set(y),d.renderbufferStorage(d.RENDERBUFFER,t,r,u),this.bindRenderbuffer.set(null),y}createFramebuffer(t,r,u,d){return new bc(this,t,r,u,d)}clear({color:t,depth:r,stencil:u}){const d=this.gl;let y=0;t&&(y|=d.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),r!==void 0&&(y|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),u!==void 0&&(y|=d.STENCIL_BUFFER_BIT,this.clearStencil.set(u),this.stencilMask.set(255)),d.clear(y)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){o.bz(t.blendFunction,si.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return ca(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var r;return ca(this.gl)?this.gl.deleteVertexArray(t):(r=this.gl.getExtension("OES_vertex_array_object"))===null||r===void 0?void 0:r.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}let xo;function wc(g,t,r,u,d){const y=g.context,x=g.transform,S=y.gl,P=g.useProgram("collisionBox"),E=[];let B=0,V=0;for(let ce=0;ce<u.length;ce++){const fe=u[ce],we=t.getTile(fe).getBucket(r);if(!we)continue;const Te=d?we.textCollisionBox:we.iconCollisionBox,Ie=we.collisionCircleArray;Ie.length>0&&(E.push({circleArray:Ie,circleOffset:V,coord:fe}),B+=Ie.length/4,V=B),Te&&P.draw(y,S.LINES,yn.disabled,Ln.disabled,g.colorModeForRenderPass(),Rn.disabled,Qd(g.transform),g.style.map.terrain&&g.style.map.terrain.getTerrainData(fe),x.getProjectionData({overscaledTileID:fe,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),r.id,Te.layoutVertexBuffer,Te.indexBuffer,Te.segments,null,g.transform.zoom,null,null,Te.collisionVertexBuffer)}if(!d||!E.length)return;const j=g.useProgram("collisionCircle"),X=new o.bM;X.resize(4*B),X._trim();let Y=0;for(const ce of E)for(let fe=0;fe<ce.circleArray.length/4;fe++){const we=4*fe,Te=ce.circleArray[we+0],Ie=ce.circleArray[we+1],De=ce.circleArray[we+2],Re=ce.circleArray[we+3];X.emplace(Y++,Te,Ie,De,Re,0),X.emplace(Y++,Te,Ie,De,Re,1),X.emplace(Y++,Te,Ie,De,Re,2),X.emplace(Y++,Te,Ie,De,Re,3)}(!xo||xo.length<2*B)&&(xo=function(ce){const fe=2*ce,we=new o.bO;we.resize(fe),we._trim();for(let Te=0;Te<fe;Te++){const Ie=6*Te;we.uint16[Ie+0]=4*Te+0,we.uint16[Ie+1]=4*Te+1,we.uint16[Ie+2]=4*Te+2,we.uint16[Ie+3]=4*Te+2,we.uint16[Ie+4]=4*Te+3,we.uint16[Ie+5]=4*Te+0}return we}(B));const le=y.createIndexBuffer(xo,!0),se=y.createVertexBuffer(X,o.bN.members,!0);for(const ce of E){const fe=ef(g.transform);j.draw(y,S.TRIANGLES,yn.disabled,Ln.disabled,g.colorModeForRenderPass(),Rn.disabled,fe,g.style.map.terrain&&g.style.map.terrain.getTerrainData(ce.coord),null,r.id,se,le,o.aD.simpleSegment(0,2*ce.circleOffset,ce.circleArray.length,ce.circleArray.length/2),null,g.transform.zoom,null,null,null)}se.destroy(),le.destroy()}const pf=o.aq(new Float32Array(16));function Sc(g,t,r,u,d,y){const{horizontalAlign:x,verticalAlign:S}=o.ay(g);return new o.P((-(x-.5)*t/d+u[0])*y,(-(S-.5)*r/d+u[1])*y)}function Cc(g,t,r,u,d,y){const x=t.tileAnchorPoint.add(new o.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let S=u.mult(y);r||(S=S.rotate(-d));const P=x.add(S);return Je(P.x,P.y,t.pitchedLabelPlaneMatrix,t.getElevation).point}if(r){const S=jt(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(g),P=Math.atan(S.y/S.x)+(S.x<0?Math.PI:0);return g.add(u.rotate(P))}return g.add(u)}function th(g,t,r,u,d,y,x,S,P,E,B,V){const j=g.text.placedSymbolArray,X=g.text.dynamicLayoutVertexArray,Y=g.icon.dynamicLayoutVertexArray,le={};X.clear();for(let se=0;se<j.length;se++){const ce=j.get(se),fe=ce.hidden||!ce.crossTileID||g.allowVerticalPlacement&&!ce.placedOrientation?null:u[ce.crossTileID];if(fe){const we=new o.P(ce.anchorX,ce.anchorY),Te={getElevation:V,width:d.width,height:d.height,pitchedLabelPlaneMatrix:y,lineVertexArray:null,pitchWithMap:r,transform:d,projectionCache:null,tileAnchorPoint:we,translation:E,unwrappedTileID:B},Ie=r?zn(we.x,we.y,Te):jt(we.x,we.y,Te),De=Ue(d.cameraToCenterDistance,Ie.signedDistanceFromCamera);let Re=o.aj(g.textSizeData,S,ce)*De/o.as;r&&(Re*=g.tilePixelRatio/x);const{width:Ge,height:Ze,anchor:rt,textOffset:lt,textBoxScale:et}=fe,Pt=Sc(rt,Ge,Ze,lt,et,Re),St=d.getPitchedTextCorrection(we.x+E[0],we.y+E[1],B),ft=Cc(Ie.point,Te,t,Pt,-d.bearingInRadians,St),Rt=g.allowVerticalPlacement&&ce.placedOrientation===o.ai.vertical?Math.PI/2:0;for(let vn=0;vn<ce.numGlyphs;vn++)o.ak(X,ft,Rt);P&&ce.associatedIconIndex>=0&&(le[ce.associatedIconIndex]={shiftedAnchor:ft,angle:Rt})}else qi(ce.numGlyphs,X)}if(P){Y.clear();const se=g.icon.placedSymbolArray;for(let ce=0;ce<se.length;ce++){const fe=se.get(ce);if(fe.hidden)qi(fe.numGlyphs,Y);else{const we=le[ce];if(we)for(let Te=0;Te<fe.numGlyphs;Te++)o.ak(Y,we.shiftedAnchor,we.angle);else qi(fe.numGlyphs,Y)}}g.icon.dynamicLayoutVertexBuffer.updateData(Y)}g.text.dynamicLayoutVertexBuffer.updateData(X)}function eg(g,t,r){return r.iconsInText&&t?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function Tc(g,t,r,u,d,y,x,S,P,E,B,V,j){const X=g.context,Y=X.gl,le=g.transform,se=S==="map",ce=P==="map",fe=S!=="viewport"&&r.layout.get("symbol-placement")!=="point",we=se&&!ce&&!fe,Te=!r.layout.get("symbol-sort-key").isConstant();let Ie=!1;const De=g.getDepthModeForSublayer(0,yn.ReadOnly),Re=r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ge=[],Ze=le.getCircleRadiusCorrection();for(const rt of u){const lt=t.getTile(rt),et=lt.getBucket(r);if(!et)continue;const Pt=d?et.text:et.icon;if(!Pt||!Pt.segments.get().length||!Pt.hasVisibleVertices)continue;const St=Pt.programConfigurations.get(r.id),ft=d||et.sdfIcons,Rt=d?et.textSizeData:et.iconSizeData,vn=ce||le.pitch!==0,Bn=g.useProgram(eg(ft,d,et),St),pi=o.ah(Rt,le.zoom),qn=g.style.map.terrain&&g.style.map.terrain.getTerrainData(rt);let mi,Wn,Gn,Xn,or=[0,0],Ni=null;if(d)Wn=lt.glyphAtlasTexture,Gn=Y.LINEAR,mi=lt.glyphAtlasTexture.size,et.iconsInText&&(or=lt.imageAtlasTexture.size,Ni=lt.imageAtlasTexture,Xn=vn||g.options.rotating||g.options.zooming||Rt.kind==="composite"||Rt.kind==="camera"?Y.LINEAR:Y.NEAREST);else{const Kn=r.layout.get("icon-size").constantOr(0)!==1||et.iconsNeedLinear;Wn=lt.imageAtlasTexture,Gn=ft||g.options.rotating||g.options.zooming||Kn||vn?Y.LINEAR:Y.NEAREST,mi=lt.imageAtlasTexture.size}const $i=o.at(lt,1,g.transform.zoom),wr=qe(se,g.transform,$i),Wa=o.H();o.an(Wa,wr);const Ea=Oe(ce,se,g.transform,$i),Nr=o.au(le,lt,y,x),Xa=le.getProjectionData({overscaledTileID:rt,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),Il=Re&&et.hasTextData(),Ml=r.layout.get("icon-text-fit")!=="none"&&Il&&et.hasIconData();if(fe){const Kn=g.style.map.terrain?(jr,xi)=>g.style.map.terrain.getElevation(rt,jr,xi):null,gi=r.layout.get("text-rotation-alignment")==="map";kt(et,g,d,wr,Wa,ce,E,gi,rt.toUnwrapped(),le.width,le.height,Nr,Kn)}const Ro=d&&Re||Ml,Ar=fe||Ro?pf:ce?wr:g.transform.clipSpaceToPixelsMatrix,na=ft&&r.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ia;ia=ft?et.iconsInText?Ga(Rt.kind,pi,we,ce,fe,Ro,g,Ar,Ea,Nr,mi,or,Ze):dl(Rt.kind,pi,we,ce,fe,Ro,g,Ar,Ea,Nr,d,mi,0,Ze):Zu(Rt.kind,pi,we,ce,fe,Ro,g,Ar,Ea,Nr,d,mi,Ze);const $r={program:Bn,buffers:Pt,uniformValues:ia,projectionData:Xa,atlasTexture:Wn,atlasTextureIcon:Ni,atlasInterpolation:Gn,atlasInterpolationIcon:Xn,isSDF:ft,hasHalo:na};if(Te&&et.canOverlap){Ie=!0;const Kn=Pt.segments.get();for(const gi of Kn)Ge.push({segments:new o.aD([gi]),sortKey:gi.sortKey,state:$r,terrainData:qn})}else Ge.push({segments:Pt.segments,sortKey:0,state:$r,terrainData:qn})}Ie&&Ge.sort((rt,lt)=>rt.sortKey-lt.sortKey);for(const rt of Ge){const lt=rt.state;if(X.activeTexture.set(Y.TEXTURE0),lt.atlasTexture.bind(lt.atlasInterpolation,Y.CLAMP_TO_EDGE),lt.atlasTextureIcon&&(X.activeTexture.set(Y.TEXTURE1),lt.atlasTextureIcon&&lt.atlasTextureIcon.bind(lt.atlasInterpolationIcon,Y.CLAMP_TO_EDGE)),lt.isSDF){const et=lt.uniformValues;lt.hasHalo&&(et.u_is_halo=1,mf(lt.buffers,rt.segments,r,g,lt.program,De,B,V,et,lt.projectionData,rt.terrainData)),et.u_is_halo=0}mf(lt.buffers,rt.segments,r,g,lt.program,De,B,V,lt.uniformValues,lt.projectionData,rt.terrainData)}}function mf(g,t,r,u,d,y,x,S,P,E,B){const V=u.context;d.draw(V,V.gl.TRIANGLES,y,x,S,Rn.backCCW,P,B,E,r.id,g.layoutVertexBuffer,g.indexBuffer,t,r.paint,u.transform.zoom,g.programConfigurations.get(r.id),g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer)}function gf(g,t,r,u,d){const y=g.context,x=y.gl,S=Ln.disabled,P=new si([x.ONE,x.ONE],o.b4.transparent,[!0,!0,!0,!0]),E=t.getBucket(r);if(!E)return;const B=u.key;let V=r.heatmapFbos.get(B);V||(V=kc(y,t.tileSize,t.tileSize),r.heatmapFbos.set(B,V)),y.bindFramebuffer.set(V.framebuffer),y.viewport.set([0,0,t.tileSize,t.tileSize]),y.clear({color:o.b4.transparent});const j=E.programConfigurations.get(r.id),X=g.useProgram("heatmap",j,!d),Y=g.transform.getProjectionData({overscaledTileID:t.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),le=g.style.map.terrain.getTerrainData(u);X.draw(y,x.TRIANGLES,yn.disabled,S,P,Rn.disabled,$u(t,g.transform.zoom,r.paint.get("heatmap-intensity"),1),le,Y,r.id,E.layoutVertexBuffer,E.indexBuffer,E.segments,r.paint,g.transform.zoom,j)}function Pc(g,t,r,u,d){const y=g.context,x=y.gl,S=g.transform;y.setColorMode(g.colorModeForRenderPass());const P=nh(y,t),E=r.key,B=t.heatmapFbos.get(E);if(!B)return;y.activeTexture.set(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,B.colorAttachment.get()),y.activeTexture.set(x.TEXTURE1),P.bind(x.LINEAR,x.CLAMP_TO_EDGE);const V=S.getProjectionData({overscaledTileID:r,applyTerrainMatrix:d,applyGlobeMatrix:!u});g.useProgram("heatmapTexture").draw(y,x.TRIANGLES,yn.disabled,Ln.disabled,g.colorModeForRenderPass(),Rn.disabled,cs(g,t,0,1),null,V,t.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments,t.paint,S.zoom),B.destroy(),t.heatmapFbos.delete(E)}function kc(g,t,r){var u,d;const y=g.gl,x=y.createTexture();y.bindTexture(y.TEXTURE_2D,x),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.LINEAR);const S=(u=g.HALF_FLOAT)!==null&&u!==void 0?u:y.UNSIGNED_BYTE,P=(d=g.RGBA16F)!==null&&d!==void 0?d:y.RGBA;y.texImage2D(y.TEXTURE_2D,0,P,t,r,0,y.RGBA,S,null);const E=g.createFramebuffer(t,r,!1,!1);return E.colorAttachment.set(x),E}function nh(g,t){return t.colorRampTexture||(t.colorRampTexture=new ye(g,t.colorRamp,g.gl.RGBA)),t.colorRampTexture}function ih(g,t,r,u,d){if(!r||!u||!u.imageAtlas)return;const y=u.imageAtlas.patternPositions;let x=y[r.to.toString()],S=y[r.from.toString()];if(!x&&S&&(x=S),!S&&x&&(S=x),!x||!S){const P=d.getPaintProperty(t);x=y[P],S=y[P]}x&&S&&g.setConstantPatternPositions(x,S)}function ml(g,t,r,u,d,y,x,S){const P=g.context.gl,E="fill-pattern",B=r.paint.get(E),V=B&&B.constantOr(1),j=r.getCrossfadeParameters();let X,Y,le,se,ce;const fe=g.transform,we=r.paint.get("fill-translate"),Te=r.paint.get("fill-translate-anchor");x?(Y=V&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",X=P.LINES):(Y=V?"fillPattern":"fill",X=P.TRIANGLES);const Ie=B.constantOr(null);for(const De of u){const Re=t.getTile(De);if(V&&!Re.patternsLoaded())continue;const Ge=Re.getBucket(r);if(!Ge)continue;const Ze=Ge.programConfigurations.get(r.id),rt=g.useProgram(Y,Ze),lt=g.style.map.terrain&&g.style.map.terrain.getTerrainData(De);V&&(g.context.activeTexture.set(P.TEXTURE0),Re.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),Ze.updatePaintBuffers(j)),ih(Ze,E,Ie,Re,r);const et=fe.getProjectionData({overscaledTileID:De,applyGlobeMatrix:!S,applyTerrainMatrix:!0}),Pt=o.au(fe,Re,we,Te);if(x){se=Ge.indexBuffer2,ce=Ge.segments2;const ft=[P.drawingBufferWidth,P.drawingBufferHeight];le=Y==="fillOutlinePattern"&&V?Jd(g,j,Re,ft,Pt):Gm(ft,Pt)}else se=Ge.indexBuffer,ce=Ge.segments,le=V?Ou(g,j,Re,Pt):{u_fill_translate:Pt};let St;if(g.renderPass==="translucent"&&S){const[ft]=g.getStencilConfigForOverlapAndUpdateStencilID(u);St=ft[De.overscaledZ]}else St=g.stencilModeForClipping(De);rt.draw(g.context,X,d,St,y,Rn.backCCW,le,lt,et,r.id,Ge.layoutVertexBuffer,se,ce,r.paint,g.transform.zoom,Ze)}}function gl(g,t,r,u,d,y,x,S){const P=g.context,E=P.gl,B="fill-extrusion-pattern",V=r.paint.get(B),j=V.constantOr(1),X=r.getCrossfadeParameters(),Y=r.paint.get("fill-extrusion-opacity"),le=V.constantOr(null),se=g.transform;for(const ce of u){const fe=t.getTile(ce),we=fe.getBucket(r);if(!we)continue;const Te=g.style.map.terrain&&g.style.map.terrain.getTerrainData(ce),Ie=we.programConfigurations.get(r.id),De=g.useProgram(j?"fillExtrusionPattern":"fillExtrusion",Ie);j&&(g.context.activeTexture.set(E.TEXTURE0),fe.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),Ie.updatePaintBuffers(X));const Re=se.getProjectionData({overscaledTileID:ce,applyGlobeMatrix:!S,applyTerrainMatrix:!0});ih(Ie,B,le,fe,r);const Ge=o.au(se,fe,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),Ze=r.paint.get("fill-extrusion-vertical-gradient"),rt=j?Um(g,Ze,Y,Ge,ce,X,fe):Fs(g,Ze,Y,Ge);De.draw(P,P.gl.TRIANGLES,d,y,x,Rn.backCCW,rt,Te,Re,r.id,we.layoutVertexBuffer,we.indexBuffer,we.segments,r.paint,g.transform.zoom,Ie,g.style.map.terrain&&we.centroidVertexBuffer)}}function rh(g,t,r,u,d,y,x,S,P){var E;const B=g.style.projection,V=g.context,j=g.transform,X=V.gl,Y=g.useProgram("hillshade"),le=!g.options.moving;for(const se of u){const ce=t.getTile(se),fe=ce.fbo;if(!fe)continue;const we=B.getMeshFromTileID(V,se.canonical,S,!0,"raster"),Te=(E=g.style.map.terrain)===null||E===void 0?void 0:E.getTerrainData(se);V.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,fe.colorAttachment.get());const Ie=j.getProjectionData({overscaledTileID:se,aligned:le,applyGlobeMatrix:!P,applyTerrainMatrix:!0});Y.draw(V,X.TRIANGLES,y,d[se.overscaledZ],x,Rn.backCCW,tf(g,ce,r),Te,Ie,r.id,we.vertexBuffer,we.indexBuffer,we.segments)}}const Ic=[new o.P(0,0),new o.P(o.X,0),new o.P(o.X,o.X),new o.P(0,o.X)];function di(g,t,r,u,d,y,x,S,P=!1,E=!1){const B=u[u.length-1].overscaledZ,V=g.context,j=V.gl,X=g.useProgram("raster"),Y=g.transform,le=g.style.projection,se=g.colorModeForRenderPass(),ce=!g.options.moving;for(const fe of u){const we=g.getDepthModeForSublayer(fe.overscaledZ-B,r.paint.get("raster-opacity")===1?yn.ReadWrite:yn.ReadOnly,j.LESS),Te=t.getTile(fe);Te.registerFadeDuration(r.paint.get("raster-fade-duration"));const Ie=t.findLoadedParent(fe,0),De=t.findLoadedSibling(fe),Re=$s(Te,Ie||De||null,t,r,g.transform,g.style.map.terrain);let Ge,Ze;const rt=r.paint.get("raster-resampling")==="nearest"?j.NEAREST:j.LINEAR;V.activeTexture.set(j.TEXTURE0),Te.texture.bind(rt,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),V.activeTexture.set(j.TEXTURE1),Ie?(Ie.texture.bind(rt,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),Ge=Math.pow(2,Ie.tileID.overscaledZ-Te.tileID.overscaledZ),Ze=[Te.tileID.canonical.x*Ge%1,Te.tileID.canonical.y*Ge%1]):Te.texture.bind(rt,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),Te.texture.useMipmap&&V.extTextureFilterAnisotropic&&g.transform.pitch>20&&j.texParameterf(j.TEXTURE_2D,V.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,V.extTextureFilterAnisotropicMax);const lt=g.style.map.terrain&&g.style.map.terrain.getTerrainData(fe),et=Y.getProjectionData({overscaledTileID:fe,aligned:ce,applyGlobeMatrix:!E,applyTerrainMatrix:!0}),Pt=rf(Ze||[0,0],Ge||1,Re,r,S),St=le.getMeshFromTileID(V,fe.canonical,y,x,"raster");X.draw(V,j.TRIANGLES,we,d?d[fe.overscaledZ]:Ln.disabled,se,P?Rn.frontCCW:Rn.backCCW,Pt,lt,et,r.id,St.vertexBuffer,St.indexBuffer,St.segments)}}function $s(g,t,r,u,d,y){const x=u.paint.get("raster-fade-duration");if(!y&&x>0){const S=O.now(),P=(S-g.timeAdded)/x,E=t?(S-t.timeAdded)/x:-1,B=r.getSource(),V=Mr(d,{tileSize:B.tileSize,roundZoom:B.roundZoom}),j=!t||Math.abs(t.tileID.overscaledZ-V)>Math.abs(g.tileID.overscaledZ-V),X=j&&g.refreshedUponExpiration?1:o.ab(j?P:1-E,0,1);return g.refreshedUponExpiration&&P>=1&&(g.refreshedUponExpiration=!1),t?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}const ta=new o.b4(1,0,0,1),ah=new o.b4(0,1,0,1),sh=new o.b4(0,0,1,1),_f=new o.b4(1,0,1,1),wo=new o.b4(0,1,1,1);function So(g,t,r,u){_l(g,0,t+r/2,g.transform.width,r,u)}function Mc(g,t,r,u){_l(g,t-r/2,0,r,g.transform.height,u)}function _l(g,t,r,u,d,y){const x=g.context,S=x.gl;S.enable(S.SCISSOR_TEST),S.scissor(t*g.pixelRatio,r*g.pixelRatio,u*g.pixelRatio,d*g.pixelRatio),x.clear({color:y}),S.disable(S.SCISSOR_TEST)}function yf(g,t,r){const u=g.context,d=u.gl,y=g.useProgram("debug"),x=yn.disabled,S=Ln.disabled,P=g.colorModeForRenderPass(),E="$debug",B=g.style.map.terrain&&g.style.map.terrain.getTerrainData(r);u.activeTexture.set(d.TEXTURE0);const V=t.getTileByID(r.key).latestRawTileData,j=Math.floor((V&&V.byteLength||0)/1024),X=t.getTile(r).tileSize,Y=512/Math.min(X,512)*(r.overscaledZ/g.transform.zoom)*.5;let le=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(le+=` => ${r.overscaledZ}`),function(ce,fe){ce.initDebugOverlayCanvas();const we=ce.debugOverlayCanvas,Te=ce.context.gl,Ie=ce.debugOverlayCanvas.getContext("2d");Ie.clearRect(0,0,we.width,we.height),Ie.shadowColor="white",Ie.shadowBlur=2,Ie.lineWidth=1.5,Ie.strokeStyle="white",Ie.textBaseline="top",Ie.font="bold 36px Open Sans, sans-serif",Ie.fillText(fe,5,5),Ie.strokeText(fe,5,5),ce.debugOverlayTexture.update(we),ce.debugOverlayTexture.bind(Te.LINEAR,Te.CLAMP_TO_EDGE)}(g,`${le} ${j}kB`);const se=g.transform.getProjectionData({overscaledTileID:r,applyGlobeMatrix:!0,applyTerrainMatrix:!0});y.draw(u,d.TRIANGLES,x,S,si.alphaBlended,Rn.disabled,Nu(o.b4.transparent,Y),null,se,E,g.debugBuffer,g.quadTriangleIndexBuffer,g.debugSegments),y.draw(u,d.LINE_STRIP,x,S,P,Rn.disabled,Nu(o.b4.red),B,se,E,g.debugBuffer,g.tileBorderIndexBuffer,g.debugSegments)}function oh(g,t,r,u){const{isRenderingGlobe:d}=u,y=g.context,x=y.gl,S=g.transform,P=g.colorModeForRenderPass(),E=g.getDepthModeFor3D(),B=g.useProgram("terrain");y.bindFramebuffer.set(null),y.viewport.set([0,0,g.width,g.height]);for(const V of r){const j=t.getTerrainMesh(V.tileID),X=g.renderToTexture.getTexture(V),Y=t.getTerrainData(V.tileID);y.activeTexture.set(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,X.texture);const le=t.getMeshFrameDelta(S.zoom),se=S.calculateFogMatrix(V.tileID.toUnwrapped()),ce=cl(le,se,g.style.sky,S.pitch,d),fe=S.getProjectionData({overscaledTileID:V.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});B.draw(y,x.TRIANGLES,E,Ln.disabled,P,Rn.backCCW,ce,Y,fe,"terrain",j.vertexBuffer,j.indexBuffer,j.segments)}}function lh(g,t){if(!t.mesh){const r=new o.aC;r.emplaceBack(-1,-1),r.emplaceBack(1,-1),r.emplaceBack(1,1),r.emplaceBack(-1,1);const u=new o.aE;u.emplaceBack(0,1,2),u.emplaceBack(0,2,3),t.mesh=new Pa(g.createVertexBuffer(r,Pn.members),g.createIndexBuffer(u),o.aD.simpleSegment(0,0,r.length,u.length))}return t.mesh}class vf{constructor(t,r){this.context=new xc(t),this.transform=r,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.aq(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=W.maxUnderzooming+W.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Rs}resize(t,r,u){if(this.width=Math.floor(t*u),this.height=Math.floor(r*u),this.pixelRatio=u,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const d of this.style._order)this.style._layers[d].resize()}setup(){const t=this.context,r=new o.aC;r.emplaceBack(0,0),r.emplaceBack(o.X,0),r.emplaceBack(0,o.X),r.emplaceBack(o.X,o.X),this.tileExtentBuffer=t.createVertexBuffer(r,Pn.members),this.tileExtentSegments=o.aD.simpleSegment(0,0,4,2);const u=new o.aC;u.emplaceBack(0,0),u.emplaceBack(o.X,0),u.emplaceBack(0,o.X),u.emplaceBack(o.X,o.X),this.debugBuffer=t.createVertexBuffer(u,Pn.members),this.debugSegments=o.aD.simpleSegment(0,0,4,5);const d=new o.bT;d.emplaceBack(0,0,0,0),d.emplaceBack(o.X,0,o.X,0),d.emplaceBack(0,o.X,0,o.X),d.emplaceBack(o.X,o.X,o.X,o.X),this.rasterBoundsBuffer=t.createVertexBuffer(d,jm.members),this.rasterBoundsSegments=o.aD.simpleSegment(0,0,4,2);const y=new o.aC;y.emplaceBack(0,0),y.emplaceBack(o.X,0),y.emplaceBack(0,o.X),y.emplaceBack(o.X,o.X),this.rasterBoundsBufferPosOnly=t.createVertexBuffer(y,Pn.members),this.rasterBoundsSegmentsPosOnly=o.aD.simpleSegment(0,0,4,5);const x=new o.aC;x.emplaceBack(0,0),x.emplaceBack(1,0),x.emplaceBack(0,1),x.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(x,Pn.members),this.viewportSegments=o.aD.simpleSegment(0,0,4,2);const S=new o.bU;S.emplaceBack(0),S.emplaceBack(1),S.emplaceBack(3),S.emplaceBack(2),S.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(S);const P=new o.aE;P.emplaceBack(1,0,2),P.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(P);const E=this.context.gl;this.stencilClearMode=new Ln({func:E.ALWAYS,mask:0},0,255,E.ZERO,E.ZERO,E.ZERO),this.tileExtentMesh=new Pa(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const t=this.context,r=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const u=o.H();o.bL(u,0,this.width,this.height,0,0,1),o.K(u,u,[r.drawingBufferWidth,r.drawingBufferHeight,0]);const d={mainMatrix:u,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:u};this.useProgram("clippingMask",null,!0).draw(t,r.TRIANGLES,yn.disabled,this.stencilClearMode,si.disabled,Rn.disabled,null,null,d,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,r,u){if(this.currentStencilSource===t.source||!t.isTileClipped()||!r||!r.length)return;this.currentStencilSource=t.source,this.nextStencilID+r.length>256&&this.clearStencil();const d=this.context;d.setColorMode(si.disabled),d.setDepthMode(yn.disabled);const y={};for(const x of r)y[x.key]=this.nextStencilID++;this._renderTileMasks(y,r,u,!0),this._renderTileMasks(y,r,u,!1),this._tileClippingMaskIDs=y}_renderTileMasks(t,r,u,d){const y=this.context,x=y.gl,S=this.style.projection,P=this.transform,E=this.useProgram("clippingMask");for(const B of r){const V=t[B.key],j=this.style.map.terrain&&this.style.map.terrain.getTerrainData(B),X=S.getMeshFromTileID(this.context,B.canonical,d,!0,"stencil"),Y=P.getProjectionData({overscaledTileID:B,applyGlobeMatrix:!0,applyTerrainMatrix:!0});E.draw(y,x.TRIANGLES,yn.disabled,new Ln({func:x.ALWAYS,mask:0},V,255,x.KEEP,x.KEEP,x.REPLACE),si.disabled,u?Rn.disabled:Rn.backCCW,null,j,Y,"$clipping",X.vertexBuffer,X.indexBuffer,X.segments)}}_renderTilesDepthBuffer(){const t=this.context,r=t.gl,u=this.style.projection,d=this.transform,y=this.useProgram("depth"),x=this.getDepthModeFor3D(),S=ae(d,{tileSize:d.tileSize});for(const P of S){const E=this.style.map.terrain&&this.style.map.terrain.getTerrainData(P),B=u.getMeshFromTileID(this.context,P.canonical,!0,!0,"raster"),V=d.getProjectionData({overscaledTileID:P,applyGlobeMatrix:!0,applyTerrainMatrix:!0});y.draw(t,r.TRIANGLES,x,Ln.disabled,si.disabled,Rn.backCCW,null,E,V,"$clipping",B.vertexBuffer,B.indexBuffer,B.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,r=this.context.gl;return new Ln({func:r.NOTEQUAL,mask:255},t,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(t){const r=this.context.gl;return new Ln({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,r.KEEP,r.KEEP,r.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(t){const r=this.context.gl,u=t.sort((x,S)=>S.overscaledZ-x.overscaledZ),d=u[u.length-1].overscaledZ,y=u[0].overscaledZ-d+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const x={};for(let S=0;S<y;S++)x[S+d]=new Ln({func:r.GEQUAL,mask:255},S+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=y,[x,u]}return[{[d]:Ln.disabled},u]}stencilConfigForOverlapTwoPass(t){const r=this.context.gl,u=t.sort((x,S)=>S.overscaledZ-x.overscaledZ),d=u[u.length-1].overscaledZ,y=u[0].overscaledZ-d+1;if(this.clearStencil(),y>1){const x={},S={};for(let P=0;P<y;P++)x[P+d]=new Ln({func:r.GREATER,mask:255},y+1+P,255,r.KEEP,r.KEEP,r.REPLACE),S[P+d]=new Ln({func:r.GREATER,mask:255},1+P,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID=2*y+1,[x,S,u]}return this.nextStencilID=3,[{[d]:new Ln({func:r.GREATER,mask:255},2,255,r.KEEP,r.KEEP,r.REPLACE)},{[d]:new Ln({func:r.GREATER,mask:255},1,255,r.KEEP,r.KEEP,r.REPLACE)},u]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new si([t.CONSTANT_COLOR,t.ONE],new o.b4(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?si.unblended:si.alphaBlended}getDepthModeForSublayer(t,r,u){if(!this.opaquePassEnabledForLayer())return yn.disabled;const d=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new yn(u||this.context.gl.LEQUAL,r,[d,d])}getDepthModeFor3D(){return new yn(this.context.gl.LEQUAL,yn.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,r){var u,d;this.style=t,this.options=r,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(O.now()),this.imageManager.beginFrame();const y=this.style._order,x=this.style.sourceCaches,S={},P={},E={},B={isRenderingToTexture:!1,isRenderingGlobe:((u=t.projection)===null||u===void 0?void 0:u.transitionState)>0};for(const j in x){const X=x[j];X.used&&X.prepare(this.context),S[j]=X.getVisibleCoordinates(!1),P[j]=S[j].slice().reverse(),E[j]=X.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let j=0;j<y.length;j++)if(this.style._layers[y[j]].is3D()){this.opaquePassCutoff=j;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const j of y){const X=this.style._layers[j];if(!X.hasOffscreenPass()||X.isHidden(this.transform.zoom))continue;const Y=P[X.source];(X.type==="custom"||Y.length)&&this.renderLayer(this,x[X.source],X,Y,B)}if((d=this.style.projection)===null||d===void 0||d.updateGPUdependent({context:this.context,useProgram:j=>this.useProgram(j)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?o.b4.black:o.b4.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(j,X){const Y=j.context,le=Y.gl,se=((De,Re,Ge)=>{const Ze=Math.cos(Re.rollInRadians),rt=Math.sin(Re.rollInRadians),lt=bi(Re),et=Re.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:De.properties.get("sky-color"),u_horizon_color:De.properties.get("horizon-color"),u_horizon:[(Re.width/2-lt*rt)*Ge,(Re.height/2+lt*Ze)*Ge],u_horizon_normal:[-rt,Ze],u_sky_horizon_blend:De.properties.get("sky-horizon-blend")*Re.height/2*Ge,u_sky_blend:et}})(X,j.style.map.transform,j.pixelRatio),ce=new yn(le.LEQUAL,yn.ReadWrite,[0,1]),fe=Ln.disabled,we=j.colorModeForRenderPass(),Te=j.useProgram("sky"),Ie=lh(Y,X);Te.draw(Y,le.TRIANGLES,ce,fe,we,Rn.disabled,se,null,void 0,"sky",Ie.vertexBuffer,Ie.indexBuffer,Ie.segments)}(this,this.style.sky),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const j=this.style._layers[y[this.currentLayer]],X=x[j.source],Y=S[j.source];this._renderTileClippingMasks(j,Y,!1),this.renderLayer(this,X,j,Y,B)}this.renderPass="translucent";let V=!1;for(this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const j=this.style._layers[y[this.currentLayer]],X=x[j.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(j,B))continue;this.opaquePassEnabledForLayer()||V||(V=!0,B.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Y=(j.type==="symbol"?E:P)[j.source];this._renderTileClippingMasks(j,S[j.source],!1),this.renderLayer(this,X,j,Y,B)}if(B.isRenderingGlobe&&function(j,X,Y){const le=j.context,se=le.gl,ce=j.useProgram("atmosphere"),fe=new yn(se.LEQUAL,yn.ReadOnly,[0,1]),we=j.transform,Te=function(et,Pt){const St=et.properties.get("position"),ft=[-St.x,-St.y,-St.z],Rt=o.aq(new Float64Array(16));return et.properties.get("anchor")==="map"&&(o.aX(Rt,Rt,Pt.rollInRadians),o.aY(Rt,Rt,-Pt.pitchInRadians),o.aX(Rt,Rt,Pt.bearingInRadians),o.aY(Rt,Rt,Pt.center.lat*Math.PI/180),o.bj(Rt,Rt,-Pt.center.lng*Math.PI/180)),o.bS(ft,ft,Rt),ft}(Y,j.transform),Ie=we.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),De=X.properties.get("atmosphere-blend")*Ie.projectionTransition;if(De===0)return;const Re=go(we.worldSize,we.center.lat),Ge=we.inverseProjectionMatrix,Ze=new Float64Array(4);Ze[3]=1,o.al(Ze,Ze,we.modelViewProjectionMatrix),Ze[0]/=Ze[3],Ze[1]/=Ze[3],Ze[2]/=Ze[3],Ze[3]=1,o.al(Ze,Ze,Ge),Ze[0]/=Ze[3],Ze[1]/=Ze[3],Ze[2]/=Ze[3],Ze[3]=1;const rt=((et,Pt,St,ft,Rt)=>({u_sun_pos:et,u_atmosphere_blend:Pt,u_globe_position:St,u_globe_radius:ft,u_inv_proj_matrix:Rt}))(Te,De,[Ze[0],Ze[1],Ze[2]],Re,Ge),lt=lh(le,X);ce.draw(le,se.TRIANGLES,fe,Ln.disabled,si.alphaBlended,Rn.disabled,rt,null,null,"atmosphere",lt.vertexBuffer,lt.indexBuffer,lt.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const j=function(X,Y){let le=null;const se=Object.values(X._layers).flatMap(Te=>Te.source&&!Te.isHidden(Y)?[X.sourceCaches[Te.source]]:[]),ce=se.filter(Te=>Te.getSource().type==="vector"),fe=se.filter(Te=>Te.getSource().type!=="vector"),we=Te=>{(!le||le.getSource().maxzoom<Te.getSource().maxzoom)&&(le=Te)};return ce.forEach(Te=>we(Te)),le||fe.forEach(Te=>we(Te)),le}(this.style,this.transform.zoom);j&&function(X,Y,le){for(let se=0;se<le.length;se++)yf(X,Y,le[se])}(this,j,j.getVisibleCoordinates())}this.options.showPadding&&function(j){const X=j.transform.padding;So(j,j.transform.height-(X.top||0),3,ta),So(j,X.bottom||0,3,ah),Mc(j,X.left||0,3,sh),Mc(j,j.transform.width-(X.right||0),3,_f);const Y=j.transform.centerPoint;(function(le,se,ce,fe){_l(le,se-1,ce-10,2,20,fe),_l(le,se-10,ce-1,20,2,fe)})(j,Y.x,j.transform.height-Y.y,wo)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const r=this.terrainFacilitator.matrix,u=this.transform.modelViewProjectionMatrix;let d=this.terrainFacilitator.dirty;d||(d=t?!o.bV(r,u):!o.bW(r,u)),d||(d=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),d&&(o.bX(r,u),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(y,x){const S=y.context,P=S.gl,E=y.transform,B=si.unblended,V=new yn(P.LEQUAL,yn.ReadWrite,[0,1]),j=x.sourceCache.getRenderableTiles(),X=y.useProgram("terrainDepth");S.bindFramebuffer.set(x.getFramebuffer("depth").framebuffer),S.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),S.clear({color:o.b4.transparent,depth:1});for(const Y of j){const le=x.getTerrainMesh(Y.tileID),se=x.getTerrainData(Y.tileID),ce=E.getProjectionData({overscaledTileID:Y.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),fe={u_ele_delta:x.getMeshFrameDelta(E.zoom)};X.draw(S,P.TRIANGLES,V,Ln.disabled,B,Rn.backCCW,fe,se,ce,"terrain",le.vertexBuffer,le.indexBuffer,le.segments)}S.bindFramebuffer.set(null),S.viewport.set([0,0,y.width,y.height])}(this,this.style.map.terrain),function(y,x){const S=y.context,P=S.gl,E=y.transform,B=si.unblended,V=new yn(P.LEQUAL,yn.ReadWrite,[0,1]),j=x.getCoordsTexture(),X=x.sourceCache.getRenderableTiles(),Y=y.useProgram("terrainCoords");S.bindFramebuffer.set(x.getFramebuffer("coords").framebuffer),S.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),S.clear({color:o.b4.transparent,depth:1}),x.coordsIndex=[];for(const le of X){const se=x.getTerrainMesh(le.tileID),ce=x.getTerrainData(le.tileID);S.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,j.texture);const fe={u_terrain_coords_id:(255-x.coordsIndex.length)/255,u_texture:0,u_ele_delta:x.getMeshFrameDelta(E.zoom)},we=E.getProjectionData({overscaledTileID:le.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Y.draw(S,P.TRIANGLES,V,Ln.disabled,B,Rn.backCCW,fe,ce,we,"terrain",se.vertexBuffer,se.indexBuffer,se.segments),x.coordsIndex.push(le.tileID.key)}S.bindFramebuffer.set(null),S.viewport.set([0,0,y.width,y.height])}(this,this.style.map.terrain))}renderLayer(t,r,u,d,y){u.isHidden(this.transform.zoom)||(u.type==="background"||u.type==="custom"||(d||[]).length)&&(this.id=u.id,o.bY(u)?function(x,S,P,E,B,V){if(x.renderPass!=="translucent")return;const{isRenderingToTexture:j}=V,X=Ln.disabled,Y=x.colorModeForRenderPass();(P._unevaluatedLayout.hasValue("text-variable-anchor")||P._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(le,se,ce,fe,we,Te,Ie,De,Re){const Ge=se.transform,Ze=se.style.map.terrain,rt=we==="map",lt=Te==="map";for(const et of le){const Pt=fe.getTile(et),St=Pt.getBucket(ce);if(!St||!St.text||!St.text.segments.get().length)continue;const ft=o.ah(St.textSizeData,Ge.zoom),Rt=o.at(Pt,1,se.transform.zoom),vn=qe(rt,se.transform,Rt),Bn=ce.layout.get("icon-text-fit")!=="none"&&St.hasIconData();{const pi=Math.pow(2,Ge.zoom-Pt.tileID.overscaledZ),qn=Ze?(mi,Wn)=>Ze.getElevation(et,mi,Wn):null;th(St,rt,lt,Re,Ge,vn,pi,ft,Bn,o.au(Ge,Pt,Ie,De),et.toUnwrapped(),qn)}}}(E,x,P,S,P.layout.get("text-rotation-alignment"),P.layout.get("text-pitch-alignment"),P.paint.get("text-translate"),P.paint.get("text-translate-anchor"),B),P.paint.get("icon-opacity").constantOr(1)!==0&&Tc(x,S,P,E,!1,P.paint.get("icon-translate"),P.paint.get("icon-translate-anchor"),P.layout.get("icon-rotation-alignment"),P.layout.get("icon-pitch-alignment"),P.layout.get("icon-keep-upright"),X,Y,j),P.paint.get("text-opacity").constantOr(1)!==0&&Tc(x,S,P,E,!0,P.paint.get("text-translate"),P.paint.get("text-translate-anchor"),P.layout.get("text-rotation-alignment"),P.layout.get("text-pitch-alignment"),P.layout.get("text-keep-upright"),X,Y,j),S.map.showCollisionBoxes&&(wc(x,S,P,E,!0),wc(x,S,P,E,!1))}(t,r,u,d,this.style.placement.variableOffsets,y):o.bZ(u)?function(x,S,P,E,B){if(x.renderPass!=="translucent")return;const{isRenderingToTexture:V}=B,j=P.paint.get("circle-opacity"),X=P.paint.get("circle-stroke-width"),Y=P.paint.get("circle-stroke-opacity"),le=!P.layout.get("circle-sort-key").isConstant();if(j.constantOr(1)===0&&(X.constantOr(1)===0||Y.constantOr(1)===0))return;const se=x.context,ce=se.gl,fe=x.transform,we=x.getDepthModeForSublayer(0,yn.ReadOnly),Te=Ln.disabled,Ie=x.colorModeForRenderPass(),De=[],Re=fe.getCircleRadiusCorrection();for(let Ge=0;Ge<E.length;Ge++){const Ze=E[Ge],rt=S.getTile(Ze),lt=rt.getBucket(P);if(!lt)continue;const et=P.paint.get("circle-translate"),Pt=P.paint.get("circle-translate-anchor"),St=o.au(fe,rt,et,Pt),ft=lt.programConfigurations.get(P.id),Rt=x.useProgram("circle",ft),vn=lt.layoutVertexBuffer,Bn=lt.indexBuffer,pi=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Ze),qn={programConfiguration:ft,program:Rt,layoutVertexBuffer:vn,indexBuffer:Bn,uniformValues:Vu(x,rt,P,St,Re),terrainData:pi,projectionData:fe.getProjectionData({overscaledTileID:Ze,applyGlobeMatrix:!V,applyTerrainMatrix:!0})};if(le){const mi=lt.segments.get();for(const Wn of mi)De.push({segments:new o.aD([Wn]),sortKey:Wn.sortKey,state:qn})}else De.push({segments:lt.segments,sortKey:0,state:qn})}le&&De.sort((Ge,Ze)=>Ge.sortKey-Ze.sortKey);for(const Ge of De){const{programConfiguration:Ze,program:rt,layoutVertexBuffer:lt,indexBuffer:et,uniformValues:Pt,terrainData:St,projectionData:ft}=Ge.state;rt.draw(se,ce.TRIANGLES,we,Te,Ie,Rn.backCCW,Pt,St,ft,P.id,lt,et,Ge.segments,P.paint,x.transform.zoom,Ze)}}(t,r,u,d,y):o.b_(u)?function(x,S,P,E,B){if(P.paint.get("heatmap-opacity")===0)return;const V=x.context,{isRenderingToTexture:j,isRenderingGlobe:X}=B;if(x.style.map.terrain){for(const Y of E){const le=S.getTile(Y);S.hasRenderableParent(Y)||(x.renderPass==="offscreen"?gf(x,le,P,Y,X):x.renderPass==="translucent"&&Pc(x,P,Y,j,X))}V.viewport.set([0,0,x.width,x.height])}else x.renderPass==="offscreen"?function(Y,le,se,ce){const fe=Y.context,we=fe.gl,Te=Y.transform,Ie=Ln.disabled,De=new si([we.ONE,we.ONE],o.b4.transparent,[!0,!0,!0,!0]);(function(Re,Ge,Ze){const rt=Re.gl;Re.activeTexture.set(rt.TEXTURE1),Re.viewport.set([0,0,Ge.width/4,Ge.height/4]);let lt=Ze.heatmapFbos.get(o.bP);lt?(rt.bindTexture(rt.TEXTURE_2D,lt.colorAttachment.get()),Re.bindFramebuffer.set(lt.framebuffer)):(lt=kc(Re,Ge.width/4,Ge.height/4),Ze.heatmapFbos.set(o.bP,lt))})(fe,Y,se),fe.clear({color:o.b4.transparent});for(let Re=0;Re<ce.length;Re++){const Ge=ce[Re];if(le.hasRenderableParent(Ge))continue;const Ze=le.getTile(Ge),rt=Ze.getBucket(se);if(!rt)continue;const lt=rt.programConfigurations.get(se.id),et=Y.useProgram("heatmap",lt),Pt=Te.getProjectionData({overscaledTileID:Ge,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),St=Te.getCircleRadiusCorrection();et.draw(fe,we.TRIANGLES,yn.disabled,Ie,De,Rn.backCCW,$u(Ze,Te.zoom,se.paint.get("heatmap-intensity"),St),null,Pt,se.id,rt.layoutVertexBuffer,rt.indexBuffer,rt.segments,se.paint,Te.zoom,lt)}fe.viewport.set([0,0,Y.width,Y.height])}(x,S,P,E):x.renderPass==="translucent"&&function(Y,le){const se=Y.context,ce=se.gl;se.setColorMode(Y.colorModeForRenderPass());const fe=le.heatmapFbos.get(o.bP);fe&&(se.activeTexture.set(ce.TEXTURE0),ce.bindTexture(ce.TEXTURE_2D,fe.colorAttachment.get()),se.activeTexture.set(ce.TEXTURE1),nh(se,le).bind(ce.LINEAR,ce.CLAMP_TO_EDGE),Y.useProgram("heatmapTexture").draw(se,ce.TRIANGLES,yn.disabled,Ln.disabled,Y.colorModeForRenderPass(),Rn.disabled,cs(Y,le,0,1),null,null,le.id,Y.viewportBuffer,Y.quadTriangleIndexBuffer,Y.viewportSegments,le.paint,Y.transform.zoom))}(x,P)}(t,r,u,d,y):o.b$(u)?function(x,S,P,E,B){if(x.renderPass!=="translucent")return;const{isRenderingToTexture:V}=B,j=P.paint.get("line-opacity"),X=P.paint.get("line-width");if(j.constantOr(1)===0||X.constantOr(1)===0)return;const Y=x.getDepthModeForSublayer(0,yn.ReadOnly),le=x.colorModeForRenderPass(),se=P.paint.get("line-dasharray"),ce=P.paint.get("line-pattern"),fe=ce.constantOr(1),we=P.paint.get("line-gradient"),Te=P.getCrossfadeParameters(),Ie=fe?"linePattern":se?"lineSDF":we?"lineGradient":"line",De=x.context,Re=De.gl,Ge=x.transform;let Ze=!0;for(const rt of E){const lt=S.getTile(rt);if(fe&&!lt.patternsLoaded())continue;const et=lt.getBucket(P);if(!et)continue;const Pt=et.programConfigurations.get(P.id),St=x.context.program.get(),ft=x.useProgram(Ie,Pt),Rt=Ze||ft.program!==St,vn=x.style.map.terrain&&x.style.map.terrain.getTerrainData(rt),Bn=ce.constantOr(null);if(Bn&&lt.imageAtlas){const Gn=lt.imageAtlas,Xn=Gn.patternPositions[Bn.to.toString()],or=Gn.patternPositions[Bn.from.toString()];Xn&&or&&Pt.setConstantPatternPositions(Xn,or)}const pi=Ge.getProjectionData({overscaledTileID:rt,applyGlobeMatrix:!V,applyTerrainMatrix:!0}),qn=Ge.getPixelScale(),mi=fe?Hm(x,lt,P,qn,Te):se?Zm(x,lt,P,qn,se,Te):we?uc(x,lt,P,qn,et.lineClipsArray.length):ju(x,lt,P,qn);if(fe)De.activeTexture.set(Re.TEXTURE0),lt.imageAtlasTexture.bind(Re.LINEAR,Re.CLAMP_TO_EDGE),Pt.updatePaintBuffers(Te);else if(se&&(Rt||x.lineAtlas.dirty))De.activeTexture.set(Re.TEXTURE0),x.lineAtlas.bind(De);else if(we){const Gn=et.gradients[P.id];let Xn=Gn.texture;if(P.gradientVersion!==Gn.version){let or=256;if(P.stepInterpolant){const Ni=S.getSource().maxzoom,$i=rt.canonical.z===Ni?Math.ceil(1<<x.transform.maxZoom-rt.canonical.z):1;or=o.ab(o.bQ(et.maxLineLength/o.X*1024*$i),256,De.maxTextureSize)}Gn.gradient=o.bR({expression:P.gradientExpression(),evaluationKey:"lineProgress",resolution:or,image:Gn.gradient||void 0,clips:et.lineClipsArray}),Gn.texture?Gn.texture.update(Gn.gradient):Gn.texture=new ye(De,Gn.gradient,Re.RGBA),Gn.version=P.gradientVersion,Xn=Gn.texture}De.activeTexture.set(Re.TEXTURE0),Xn.bind(P.stepInterpolant?Re.NEAREST:Re.LINEAR,Re.CLAMP_TO_EDGE)}let Wn;if(V){const[Gn]=x.getStencilConfigForOverlapAndUpdateStencilID(E);Wn=Gn[rt.overscaledZ]}else Wn=x.stencilModeForClipping(rt);ft.draw(De,Re.TRIANGLES,Y,Wn,le,Rn.disabled,mi,vn,pi,P.id,et.layoutVertexBuffer,et.indexBuffer,et.segments,P.paint,x.transform.zoom,Pt,et.layoutVertexBuffer2),Ze=!1}}(t,r,u,d,y):o.c0(u)?function(x,S,P,E,B){const V=P.paint.get("fill-color"),j=P.paint.get("fill-opacity");if(j.constantOr(1)===0)return;const{isRenderingToTexture:X}=B,Y=x.colorModeForRenderPass(),le=P.paint.get("fill-pattern"),se=x.opaquePassEnabledForLayer()&&!le.constantOr(1)&&V.constantOr(o.b4.transparent).a===1&&j.constantOr(0)===1?"opaque":"translucent";if(x.renderPass===se){const ce=x.getDepthModeForSublayer(1,x.renderPass==="opaque"?yn.ReadWrite:yn.ReadOnly);ml(x,S,P,E,ce,Y,!1,X)}if(x.renderPass==="translucent"&&P.paint.get("fill-antialias")){const ce=x.getDepthModeForSublayer(P.getPaintProperty("fill-outline-color")?2:0,yn.ReadOnly);ml(x,S,P,E,ce,Y,!0,X)}}(t,r,u,d,y):o.c1(u)?function(x,S,P,E,B){const V=P.paint.get("fill-extrusion-opacity");if(V===0)return;const{isRenderingToTexture:j}=B;if(x.renderPass==="translucent"){const X=new yn(x.context.gl.LEQUAL,yn.ReadWrite,x.depthRangeFor3D);if(V!==1||P.paint.get("fill-extrusion-pattern").constantOr(1))gl(x,S,P,E,X,Ln.disabled,si.disabled,j),gl(x,S,P,E,X,x.stencilModeFor3D(),x.colorModeForRenderPass(),j);else{const Y=x.colorModeForRenderPass();gl(x,S,P,E,X,Ln.disabled,Y,j)}}}(t,r,u,d,y):o.c2(u)?function(x,S,P,E,B){if(x.renderPass!=="offscreen"&&x.renderPass!=="translucent")return;const{isRenderingToTexture:V}=B,j=x.context,X=x.style.projection.useSubdivision,Y=x.getDepthModeForSublayer(0,yn.ReadOnly),le=x.colorModeForRenderPass();if(x.renderPass==="offscreen")(function(se,ce,fe,we,Te,Ie,De){const Re=se.context,Ge=Re.gl;for(const Ze of fe){const rt=ce.getTile(Ze),lt=rt.dem;if(!lt||!lt.data||!rt.needsHillshadePrepare)continue;const et=lt.dim,Pt=lt.stride,St=lt.getPixels();if(Re.activeTexture.set(Ge.TEXTURE1),Re.pixelStoreUnpackPremultiplyAlpha.set(!1),rt.demTexture=rt.demTexture||se.getTileTexture(Pt),rt.demTexture){const Rt=rt.demTexture;Rt.update(St,{premultiply:!1}),Rt.bind(Ge.NEAREST,Ge.CLAMP_TO_EDGE)}else rt.demTexture=new ye(Re,St,Ge.RGBA,{premultiply:!1}),rt.demTexture.bind(Ge.NEAREST,Ge.CLAMP_TO_EDGE);Re.activeTexture.set(Ge.TEXTURE0);let ft=rt.fbo;if(!ft){const Rt=new ye(Re,{width:et,height:et,data:null},Ge.RGBA);Rt.bind(Ge.LINEAR,Ge.CLAMP_TO_EDGE),ft=rt.fbo=Re.createFramebuffer(et,et,!0,!1),ft.colorAttachment.set(Rt.texture)}Re.bindFramebuffer.set(ft.framebuffer),Re.viewport.set([0,0,et,et]),se.useProgram("hillshadePrepare").draw(Re,Ge.TRIANGLES,Te,Ie,De,Rn.disabled,nf(rt.tileID,lt),null,null,we.id,se.rasterBoundsBuffer,se.quadTriangleIndexBuffer,se.rasterBoundsSegments),rt.needsHillshadePrepare=!1}})(x,S,E,P,Y,Ln.disabled,le),j.viewport.set([0,0,x.width,x.height]);else if(x.renderPass==="translucent")if(X){const[se,ce,fe]=x.stencilConfigForOverlapTwoPass(E);rh(x,S,P,fe,se,Y,le,!1,V),rh(x,S,P,fe,ce,Y,le,!0,V)}else{const[se,ce]=x.getStencilConfigForOverlapAndUpdateStencilID(E);rh(x,S,P,ce,se,Y,le,!1,V)}}(t,r,u,d,y):o.c3(u)?function(x,S,P,E,B){if(x.renderPass!=="translucent"||P.paint.get("raster-opacity")===0||!E.length)return;const{isRenderingToTexture:V}=B,j=S.getSource(),X=x.style.projection.useSubdivision;if(j instanceof It)di(x,S,P,E,null,!1,!1,j.tileCoords,j.flippedWindingOrder,V);else if(X){const[Y,le,se]=x.stencilConfigForOverlapTwoPass(E);di(x,S,P,se,Y,!1,!0,Ic,!1,V),di(x,S,P,se,le,!0,!0,Ic,!1,V)}else{const[Y,le]=x.getStencilConfigForOverlapAndUpdateStencilID(E);di(x,S,P,le,Y,!1,!0,Ic,!1,V)}}(t,r,u,d,y):o.c4(u)?function(x,S,P,E,B){const V=P.paint.get("background-color"),j=P.paint.get("background-opacity");if(j===0)return;const{isRenderingToTexture:X}=B,Y=x.context,le=Y.gl,se=x.style.projection,ce=x.transform,fe=ce.tileSize,we=P.paint.get("background-pattern");if(x.isPatternMissing(we))return;const Te=!we&&V.a===1&&j===1&&x.opaquePassEnabledForLayer()?"opaque":"translucent";if(x.renderPass!==Te)return;const Ie=Ln.disabled,De=x.getDepthModeForSublayer(0,Te==="opaque"?yn.ReadWrite:yn.ReadOnly),Re=x.colorModeForRenderPass(),Ge=x.useProgram(we?"backgroundPattern":"background"),Ze=E||ae(ce,{tileSize:fe,terrain:x.style.map.terrain});we&&(Y.activeTexture.set(le.TEXTURE0),x.imageManager.bind(x.context));const rt=P.getCrossfadeParameters();for(const lt of Ze){const et=ce.getProjectionData({overscaledTileID:lt,applyGlobeMatrix:!X,applyTerrainMatrix:!0}),Pt=we?Wu(j,x,we,{tileID:lt,tileSize:fe},rt):qu(j,V),St=x.style.map.terrain&&x.style.map.terrain.getTerrainData(lt),ft=se.getMeshFromTileID(Y,lt.canonical,!1,!0,"raster");Ge.draw(Y,le.TRIANGLES,De,Ie,Re,Rn.backCCW,Pt,St,et,P.id,ft.vertexBuffer,ft.indexBuffer,ft.segments)}}(t,0,u,d,y):o.c5(u)&&function(x,S,P,E){const{isRenderingGlobe:B}=E,V=x.context,j=P.implementation,X=x.style.projection,Y=x.transform,le=Y.getProjectionDataForCustomLayer(B),se={farZ:Y.farZ,nearZ:Y.nearZ,fov:Y.fov*Math.PI/180,modelViewProjectionMatrix:Y.modelViewProjectionMatrix,projectionMatrix:Y.projectionMatrix,shaderData:{variantName:X.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${X.shaderPreludeCode.vertexSource}`,define:X.shaderDefine},defaultProjectionData:le},ce=j.renderingMode?j.renderingMode:"2d";if(x.renderPass==="offscreen"){const fe=j.prerender;fe&&(x.setCustomLayerDefaults(),V.setColorMode(x.colorModeForRenderPass()),fe.call(j,V.gl,se),V.setDirty(),x.setBaseState())}else if(x.renderPass==="translucent"){x.setCustomLayerDefaults(),V.setColorMode(x.colorModeForRenderPass()),V.setStencilMode(Ln.disabled);const fe=ce==="3d"?x.getDepthModeFor3D():x.getDepthModeForSublayer(0,yn.ReadOnly);V.setDepthMode(fe),j.render(V.gl,se),V.setDirty(),x.setBaseState(),V.bindFramebuffer.set(null)}}(t,0,u,y))}saveTileTexture(t){const r=this._tileTextures[t.size[0]];r?r.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const r=this._tileTextures[t];return r&&r.length>0?r.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const r=this.imageManager.getPattern(t.from.toString()),u=this.imageManager.getPattern(t.to.toString());return!r||!u}useProgram(t,r,u=!1){this.cache=this.cache||{};const d=!!this.style.map.terrain,y=this.style.projection,x=t+(r?r.cacheKey:"")+`/${u?qd:y.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(d?"/terrain":"");return this.cache[x]||(this.cache[x]=new cc(this.context,Ta[t],r,af[t],this._showOverdrawInspector,d,u?Ta.projectionMercator:y.shaderPreludeCode,u?rc:y.shaderDefine)),this.cache[x]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ye(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:r}=this.context.gl;return this.width!==t||this.height!==r}}function us(g,t){let r,u=!1,d=null,y=null;const x=()=>{d=null,u&&(g.apply(y,r),d=setTimeout(x,t),u=!1)};return(...S)=>(u=!0,y=this,r=S,d||x(),d)}class ch{constructor(t){this._getCurrentHash=()=>{const r=window.location.hash.replace("#","");if(this._hashName){let u;return r.split("&").map(d=>d.split("=")).forEach(d=>{d[0]===this._hashName&&(u=d)}),(u&&u[1]||"").split("/")}return r.split("/")},this._onHashChange=()=>{const r=this._getCurrentHash();if(!this._isValidHash(r))return!1;const u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:u,pitch:+(r[4]||0)}),!0},this._updateHashUnthrottled=()=>{const r=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,r)},this._removeHash=()=>{const r=this._getCurrentHash();if(r.length===0)return;const u=r.join("/");let d=u;d.split("&").length>0&&(d=d.split("&")[0]),this._hashName&&(d=`${this._hashName}=${u}`);let y=window.location.hash.replace(d,"");y.startsWith("#&")?y=y.slice(0,1)+y.slice(2):y==="#"&&(y="");let x=window.location.href.replace(/(#.+)?$/,y);x=x.replace("&&","&"),window.history.replaceState(window.history.state,null,x)},this._updateHash=us(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const r=this._map.getCenter(),u=Math.round(100*this._map.getZoom())/100,d=Math.ceil((u*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,d),x=Math.round(r.lng*y)/y,S=Math.round(r.lat*y)/y,P=this._map.getBearing(),E=this._map.getPitch();let B="";if(B+=t?`/${x}/${S}/${u}`:`${u}/${S}/${x}`,(P||E)&&(B+="/"+Math.round(10*P)/10),E&&(B+=`/${Math.round(E)}`),this._hashName){const V=this._hashName;let j=!1;const X=window.location.hash.slice(1).split("&").map(Y=>{const le=Y.split("=")[0];return le===V?(j=!0,`${le}=${B}`):Y}).filter(Y=>Y);return j||X.push(`${V}=${B}`),`#${X.join("&")}`}return`#${B}`}_isValidHash(t){if(t.length<3||t.some(isNaN))return!1;try{new o.N(+t[2],+t[1])}catch{return!1}const r=+t[0],u=+(t[3]||0),d=+(t[4]||0);return r>=this._map.getMinZoom()&&r<=this._map.getMaxZoom()&&u>=0&&u<=180&&d>=this._map.getMinPitch()&&d<=this._map.getMaxPitch()}}const Co={linearity:.3,easing:o.c6(0,0,.3,1)},bf=o.e({deceleration:2500,maxSpeed:1400},Co),xf=o.e({deceleration:20,maxSpeed:1400},Co),wf=o.e({deceleration:1e3,maxSpeed:360},Co),Sf=o.e({deceleration:1e3,maxSpeed:90},Co),Cf=o.e({deceleration:1e3,maxSpeed:360},Co);class yl{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:O.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,r=O.now();for(;t.length>0&&r-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const r={zoom:0,bearing:0,pitch:0,roll:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)r.zoom+=y.zoomDelta||0,r.bearing+=y.bearingDelta||0,r.pitch+=y.pitchDelta||0,r.roll+=y.rollDelta||0,y.panDelta&&r.pan._add(y.panDelta),y.around&&(r.around=y.around),y.pinchAround&&(r.pinchAround=y.pinchAround);const u=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,d={};if(r.pan.mag()){const y=xr(r.pan.mag(),u,o.e({},bf,t||{})),x=r.pan.mult(y.amount/r.pan.mag()),S=this._map.cameraHelper.handlePanInertia(x,this._map.transform);d.center=S.easingCenter,d.offset=S.easingOffset,To(d,y)}if(r.zoom){const y=xr(r.zoom,u,xf);d.zoom=this._map.transform.zoom+y.amount,To(d,y)}if(r.bearing){const y=xr(r.bearing,u,wf);d.bearing=this._map.transform.bearing+o.ab(y.amount,-179,179),To(d,y)}if(r.pitch){const y=xr(r.pitch,u,Sf);d.pitch=this._map.transform.pitch+y.amount,To(d,y)}if(r.roll){const y=xr(r.roll,u,Cf);d.roll=this._map.transform.roll+o.ab(y.amount,-179,179),To(d,y)}if(d.zoom||d.bearing){const y=r.pinchAround===void 0?r.around:r.pinchAround;d.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),o.e(d,{noMoveStart:!0})}}function To(g,t){(!g.duration||g.duration<t.duration)&&(g.duration=t.duration,g.easing=t.easing)}function xr(g,t,r){const{maxSpeed:u,linearity:d,deceleration:y}=r,x=o.ab(g*d/(t/1e3),-u,u),S=Math.abs(x)/(y*d);return{easing:r.easing,duration:1e3*S,amount:x*(S/2)}}class Ri extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,u,d={}){const y=z.mousePos(r.getCanvas(),u),x=r.unproject(y);super(t,o.e({point:y,lngLat:x,originalEvent:u},d)),this._defaultPrevented=!1,this.target=r}}class Po extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,u){const d=t==="touchend"?u.changedTouches:u.touches,y=z.touchPos(r.getCanvasContainer(),d),x=y.map(P=>r.unproject(P)),S=y.reduce((P,E,B,V)=>P.add(E.div(V.length)),new o.P(0,0));super(t,{points:y,point:S,lngLats:x,lngLat:r.unproject(S),originalEvent:u}),this._defaultPrevented=!1}}class ha extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,u){super(t,{originalEvent:u}),this._defaultPrevented=!1}}class ko{constructor(t,r){this._map=t,this._clickTolerance=r.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new ha(t.type,this._map,t))}mousedown(t,r){return this._mousedownPos=r,this._firePreventable(new Ri(t.type,this._map,t))}mouseup(t){this._map.fire(new Ri(t.type,this._map,t))}click(t,r){this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance||this._map.fire(new Ri(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Ri(t.type,this._map,t))}mouseover(t){this._map.fire(new Ri(t.type,this._map,t))}mouseout(t){this._map.fire(new Ri(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Po(t.type,this._map,t))}touchmove(t){this._map.fire(new Po(t.type,this._map,t))}touchend(t){this._map.fire(new Po(t.type,this._map,t))}touchcancel(t){this._map.fire(new Po(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class tg{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Ri(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ri("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Ri(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class vl{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.screenPointToLocation(o.P.convert(t),this._map.terrain)}}class Tf{constructor(t,r){this._map=t,this._tr=new vl(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=r.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,r){this.isEnabled()&&t.shiftKey&&t.button===0&&(z.disableDrag(),this._startPos=this._lastPos=r,this._active=!0)}mousemoveWindow(t,r){if(!this._active)return;const u=r;if(this._lastPos.equals(u)||!this._box&&u.dist(this._startPos)<this._clickTolerance)return;const d=this._startPos;this._lastPos=u,this._box||(this._box=z.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const y=Math.min(d.x,u.x),x=Math.max(d.x,u.x),S=Math.min(d.y,u.y),P=Math.max(d.y,u.y);z.setTransform(this._box,`translate(${y}px,${S}px)`),this._box.style.width=x-y+"px",this._box.style.height=P-S+"px"}mouseupWindow(t,r){if(!this._active||t.button!==0)return;const u=this._startPos,d=r;if(this.reset(),z.suppressClick(),u.x!==d.x||u.y!==d.y)return this._map.fire(new o.k("boxzoomend",{originalEvent:t})),{cameraAnimation:y=>y.fitScreenCoordinates(u,d,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(z.remove(this._box),this._box=null),z.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,r){return this._map.fire(new o.k(t,{originalEvent:r}))}}function uh(g,t){if(g.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${g.length}, points ${t.length}`);const r={};for(let u=0;u<g.length;u++)r[g[u].identifier]=t[u];return r}class Pf{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,r,u){(this.centroid||u.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),u.length===this.numTouches&&(this.centroid=function(d){const y=new o.P(0,0);for(const x of d)y._add(x);return y.div(d.length)}(r),this.touches=uh(u,r)))}touchmove(t,r,u){if(this.aborted||!this.centroid)return;const d=uh(u,r);for(const y in this.touches){const x=d[y];(!x||x.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(t,r,u){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),u.length===0){const d=!this.aborted&&this.centroid;if(this.reset(),d)return d}}}class js{constructor(t){this.singleTap=new Pf(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,r,u){this.singleTap.touchstart(t,r,u)}touchmove(t,r,u){this.singleTap.touchmove(t,r,u)}touchend(t,r,u){const d=this.singleTap.touchend(t,r,u);if(d){const y=t.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(d)<30;if(y&&x||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}}}class Ha{constructor(t){this._tr=new vl(t),this._zoomIn=new js({numTouches:1,numTaps:2}),this._zoomOut=new js({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,r,u){this._zoomIn.touchstart(t,r,u),this._zoomOut.touchstart(t,r,u)}touchmove(t,r,u){this._zoomIn.touchmove(t,r,u),this._zoomOut.touchmove(t,r,u)}touchend(t,r,u){const d=this._zoomIn.touchend(t,r,u),y=this._zoomOut.touchend(t,r,u),x=this._tr;return d?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:x.zoom+1,around:x.unproject(d)},{originalEvent:t})}):y?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:x.zoom-1,around:x.unproject(y)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Bt{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const r=this._moveFunction(...t);if(r.bearingDelta||r.pitchDelta||r.rollDelta||r.around||r.panDelta)return this._active=!0,r}dragStart(t,r){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(r)?r[0]:r,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,r){if(!this.isEnabled())return;const u=this._lastPoint;if(!u)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const d=Array.isArray(r)?r[0]:r;return!this._moved&&d.dist(u)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=d,this._move(u,d))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&z.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const kf={0:1,2:2};class Us{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const r=z.mouseButton(t);this._eventButton=r}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(r,u){const d=kf[u];return r.buttons===void 0||(r.buttons&d)!==d}(t,this._eventButton)}isValidEndEvent(t){return z.mouseButton(t)===this._eventButton}}class If{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}class bl{constructor(t=new Us({checkCorrectEvent:()=>!0}),r=new If){this.mouseMoveStateManager=t,this.oneFingerTouchMoveStateManager=r}_executeRelevantHandler(t,r,u){return t instanceof MouseEvent?r(t):typeof TouchEvent<"u"&&t instanceof TouchEvent?u(t):void 0}startMove(t){this._executeRelevantHandler(t,r=>this.mouseMoveStateManager.startMove(r),r=>this.oneFingerTouchMoveStateManager.startMove(r))}endMove(t){this._executeRelevantHandler(t,r=>this.mouseMoveStateManager.endMove(r),r=>this.oneFingerTouchMoveStateManager.endMove(r))}isValidStartEvent(t){return this._executeRelevantHandler(t,r=>this.mouseMoveStateManager.isValidStartEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidStartEvent(r))}isValidMoveEvent(t){return this._executeRelevantHandler(t,r=>this.mouseMoveStateManager.isValidMoveEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(r))}isValidEndEvent(t){return this._executeRelevantHandler(t,r=>this.mouseMoveStateManager.isValidEndEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidEndEvent(r))}}const hs=g=>{g.mousedown=g.dragStart,g.mousemoveWindow=g.dragMove,g.mouseup=g.dragEnd,g.contextmenu=t=>{t.preventDefault()}};class Mf{constructor(t,r){this._clickTolerance=t.clickTolerance||1,this._map=r,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,r,u){return this._calculateTransform(t,r,u)}touchmove(t,r,u){if(this._active){if(!this._shouldBePrevented(u.length))return t.preventDefault(),this._calculateTransform(t,r,u);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,r,u){this._calculateTransform(t,r,u),this._active&&this._shouldBePrevented(u.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,r,u){u.length>0&&(this._active=!0);const d=uh(u,r),y=new o.P(0,0),x=new o.P(0,0);let S=0;for(const E in d){const B=d[E],V=this._touches[E];V&&(y._add(B),x._add(B.sub(V)),S++,d[E]=B)}if(this._touches=d,this._shouldBePrevented(S)||!x.mag())return;const P=x.div(S);return this._sum._add(P),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(S),panDelta:P}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class kn{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,r,u){this._firstTwoTouches||u.length<2||(this._firstTwoTouches=[u[0].identifier,u[1].identifier],this._start([r[0],r[1]]))}touchmove(t,r,u){if(!this._firstTwoTouches)return;t.preventDefault();const[d,y]=this._firstTwoTouches,x=Io(u,r,d),S=Io(u,r,y);if(!x||!S)return;const P=this._aroundCenter?null:x.add(S).div(2);return this._move([x,S],P,t)}touchend(t,r,u){if(!this._firstTwoTouches)return;const[d,y]=this._firstTwoTouches,x=Io(u,r,d),S=Io(u,r,y);x&&S||(this._active&&z.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Io(g,t,r){for(let u=0;u<g.length;u++)if(g[u].identifier===r)return t[u]}function Ef(g,t){return Math.log(g/t)/Math.LN2}class Ec extends kn{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,r){const u=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Ef(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ef(this._distance,u),pinchAround:r}}}function Af(g,t){return 180*g.angleWith(t)/Math.PI}class Rf extends kn{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,r,u){const d=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Af(this._vector,d),pinchAround:r}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const r=25/(Math.PI*this._minDiameter)*360,u=Af(t,this._startVector);return Math.abs(u)<r}}function Ac(g){return Math.abs(g.y)>Math.abs(g.x)}class Rc extends kn{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,r,u){super.touchstart(t,r,u),this._currentTouchCount=u.length}_start(t){this._lastPoints=t,Ac(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,r,u){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const d=t[0].sub(this._lastPoints[0]),y=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(d,y,u.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(d.y+y.y)/2*-.5}):void 0}gestureBeginsVertically(t,r,u){if(this._valid!==void 0)return this._valid;const d=t.mag()>=2,y=r.mag()>=2;if(!d&&!y)return;if(!d||!y)return this._firstMove===void 0&&(this._firstMove=u),u-this._firstMove<100&&void 0;const x=t.y>0==r.y>0;return Ac(t)&&Ac(r)&&x}}const Df={panStep:100,bearingStep:15,pitchStep:10};class zf{constructor(t){this._tr=new vl(t);const r=Df;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let r=0,u=0,d=0,y=0,x=0;switch(t.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:t.shiftKey?u=-1:(t.preventDefault(),y=-1);break;case 39:t.shiftKey?u=1:(t.preventDefault(),y=1);break;case 38:t.shiftKey?d=1:(t.preventDefault(),x=-1);break;case 40:t.shiftKey?d=-1:(t.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(u=0,d=0),{cameraAnimation:S=>{const P=this._tr;S.easeTo({duration:300,easeId:"keyboardHandler",easing:Lf,zoom:r?Math.round(P.zoom)+r*(t.shiftKey?2:1):P.zoom,bearing:P.bearing+u*this._bearingStep,pitch:P.pitch+d*this._pitchStep,offset:[-y*this._panStep,-x*this._panStep],center:P.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Lf(g){return g*(2-g)}const Bf=4.000244140625;class Ff{constructor(t,r){this._onTimeout=u=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)},this._map=t,this._tr=new vl(t),this._triggerRenderFrame=r,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let r=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const u=O.now(),d=u-(this._lastWheelEventTime||0);this._lastWheelEventTime=u,r!==0&&r%Bf==0?this._type="wheel":r!==0&&Math.abs(r)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(d*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),t.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=t,this._delta-=r,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=z.mousePos(this._map.getCanvas(),t),u=this._tr;this._aroundPoint=this._aroundCenter?u.transform.locationToScreenPoint(o.N.convert(u.center)):r,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const S=t.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=S),typeof this._targetZoom=="number"&&(this._targetZoom+=S)}if(this._delta!==0){const S=this._type==="wheel"&&Math.abs(this._delta)>Bf?this._wheelZoomRate:this._defaultZoomRate;let P=2/(1+Math.exp(-Math.abs(this._delta*S)));this._delta<0&&P!==0&&(P=1/P);const E=typeof this._targetZoom!="number"?t.scale:o.aG(this._targetZoom);this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,o.a8(E*P))),this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const r=typeof this._targetZoom!="number"?t.zoom:this._targetZoom,u=this._startZoom,d=this._easing;let y,x=!1;if(this._type==="wheel"&&u&&d){const S=O.now()-this._lastWheelEventTime,P=Math.min((S+5)/200,1),E=d(P);y=o.y.number(u,r,E),P<1?this._frameId||(this._frameId=!0):x=!0}else y=r,x=!0;return this._active=!0,x&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=y,{noInertia:!0,needsRenderFrame:!x,zoomDelta:y-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let r=o.c8;if(this._prevEase){const u=this._prevEase,d=(O.now()-u.start)/u.duration,y=u.easing(d+.01)-u.easing(d),x=.27/Math.sqrt(y*y+1e-4)*.01,S=Math.sqrt(.0729-x*x);r=o.c6(x,S,.25,1)}return this._prevEase={start:O.now(),duration:t,easing:r},r}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Za{constructor(t,r){this._clickZoom=t,this._tapZoom=r}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class fi{constructor(t){this._tr=new vl(t),this.reset()}reset(){this._active=!1}dblclick(t,r){return t.preventDefault(),{cameraAnimation:u=>{u.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(r)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Dc{constructor(){this._tap=new js({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,r,u){if(!this._swipePoint)if(this._tapTime){const d=r[0],y=t.timeStamp-this._tapTime<500,x=this._tapPoint.dist(d)<30;y&&x?u.length>0&&(this._swipePoint=d,this._swipeTouch=u[0].identifier):this.reset()}else this._tap.touchstart(t,r,u)}touchmove(t,r,u){if(this._tapTime){if(this._swipePoint){if(u[0].identifier!==this._swipeTouch)return;const d=r[0],y=d.y-this._swipePoint.y;return this._swipePoint=d,t.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(t,r,u)}touchend(t,r,u){if(this._tapTime)this._swipePoint&&u.length===0&&this.reset();else{const d=this._tap.touchend(t,r,u);d&&(this._tapTime=t.timeStamp,this._tapPoint=d)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zc{constructor(t,r,u){this._el=t,this._mousePan=r,this._touchPan=u}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class hh{constructor(t,r,u,d){this._pitchWithRotate=t.pitchWithRotate,this._rollEnabled=t.rollEnabled,this._mouseRotate=r,this._mousePitch=u,this._mouseRoll=d}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class dh{constructor(t,r,u,d){this._el=t,this._touchZoom=r,this._touchRotate=u,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class fh{constructor(t,r){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=r,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=z.create("div","maplibregl-cooperative-gesture-screen",t);let r=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(r=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const u=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),d=document.createElement("div");d.className="maplibregl-desktop-message",d.textContent=r,this._container.appendChild(d);const y=document.createElement("div");y.className="maplibregl-mobile-message",y.textContent=u,this._container.appendChild(y),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(z.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,r){this._enabled&&(this._map.fire(new o.k("cooperativegestureprevented",{gestureType:t,originalEvent:r})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Lc=g=>g.zoom||g.drag||g.roll||g.pitch||g.rotate;class Ia extends o.k{}function Mo(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta||g.rollDelta}class Ht{constructor(t,r){this.handleWindowEvent=d=>{this.handleEvent(d,`${d.type}Window`)},this.handleEvent=(d,y)=>{if(d.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const x=d.type==="renderFrame"?void 0:d,S={needsRenderFrame:!1},P={},E={},B=d.touches,V=B?this._getMapTouches(B):void 0,j=V?z.touchPos(this._map.getCanvas(),V):z.mousePos(this._map.getCanvas(),d);for(const{handlerName:le,handler:se,allowed:ce}of this._handlers){if(!se.isEnabled())continue;let fe;this._blockedByActive(E,ce,le)?se.reset():se[y||d.type]&&(fe=se[y||d.type](d,j,V),this.mergeHandlerResult(S,P,fe,le,x),fe&&fe.needsRenderFrame&&this._triggerRenderFrame()),(fe||se.isActive())&&(E[le]=se)}const X={};for(const le in this._previousActiveHandlers)E[le]||(X[le]=x);this._previousActiveHandlers=E,(Object.keys(X).length||Mo(S))&&(this._changes.push([S,P,X]),this._triggerRenderFrame()),(Object.keys(E).length||Mo(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Y}=S;Y&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Y(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new yl(t),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r);const u=this._el;this._listeners=[[u,"touchstart",{passive:!0}],[u,"touchmove",{passive:!1}],[u,"touchend",void 0],[u,"touchcancel",void 0],[u,"mousedown",void 0],[u,"mousemove",void 0],[u,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[u,"mouseover",void 0],[u,"mouseout",void 0],[u,"dblclick",void 0],[u,"click",void 0],[u,"keydown",{capture:!1}],[u,"keyup",void 0],[u,"wheel",{passive:!1}],[u,"contextmenu",void 0],[window,"blur",void 0]];for(const[d,y,x]of this._listeners)z.addEventListener(d,y,d===document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[t,r,u]of this._listeners)z.removeEventListener(t,r,t===document?this.handleWindowEvent:this.handleEvent,u)}_addDefaultHandlers(t){const r=this._map,u=r.getCanvasContainer();this._add("mapEvent",new ko(r,t));const d=r.boxZoom=new Tf(r,t);this._add("boxZoom",d),t.interactive&&t.boxZoom&&d.enable();const y=r.cooperativeGestures=new fh(r,t.cooperativeGestures);this._add("cooperativeGestures",y),t.cooperativeGestures&&y.enable();const x=new Ha(r),S=new fi(r);r.doubleClickZoom=new Za(S,x),this._add("tapZoom",x),this._add("clickZoom",S),t.interactive&&t.doubleClickZoom&&r.doubleClickZoom.enable();const P=new Dc;this._add("tapDragZoom",P);const E=r.touchPitch=new Rc(r);this._add("touchPitch",E),t.interactive&&t.touchPitch&&r.touchPitch.enable(t.touchPitch);const B=()=>r.project(r.getCenter()),V=function({enable:Te,clickTolerance:Ie,aroundCenter:De=!0,minPixelCenterThreshold:Re=100,rotateDegreesPerPixelMoved:Ge=.8},Ze){const rt=new Us({checkCorrectEvent:lt=>z.mouseButton(lt)===0&&lt.ctrlKey||z.mouseButton(lt)===2&&!lt.ctrlKey});return new Bt({clickTolerance:Ie,move:(lt,et)=>{const Pt=Ze();if(De&&Math.abs(Pt.y-lt.y)>Re)return{bearingDelta:o.c7(new o.P(lt.x,et.y),et,Pt)};let St=(et.x-lt.x)*Ge;return De&&et.y<Pt.y&&(St=-St),{bearingDelta:St}},moveStateManager:rt,enable:Te,assignEvents:hs})}(t,B),j=function({enable:Te,clickTolerance:Ie,pitchDegreesPerPixelMoved:De=-.5}){const Re=new Us({checkCorrectEvent:Ge=>z.mouseButton(Ge)===0&&Ge.ctrlKey||z.mouseButton(Ge)===2});return new Bt({clickTolerance:Ie,move:(Ge,Ze)=>({pitchDelta:(Ze.y-Ge.y)*De}),moveStateManager:Re,enable:Te,assignEvents:hs})}(t),X=function({enable:Te,clickTolerance:Ie,rollDegreesPerPixelMoved:De=.3},Re){const Ge=new Us({checkCorrectEvent:Ze=>z.mouseButton(Ze)===2&&Ze.ctrlKey});return new Bt({clickTolerance:Ie,move:(Ze,rt)=>{const lt=Re();let et=(rt.x-Ze.x)*De;return rt.y<lt.y&&(et=-et),{rollDelta:et}},moveStateManager:Ge,enable:Te,assignEvents:hs})}(t,B);r.dragRotate=new hh(t,V,j,X),this._add("mouseRotate",V,["mousePitch"]),this._add("mousePitch",j,["mouseRotate","mouseRoll"]),this._add("mouseRoll",X,["mousePitch"]),t.interactive&&t.dragRotate&&r.dragRotate.enable();const Y=function({enable:Te,clickTolerance:Ie}){const De=new Us({checkCorrectEvent:Re=>z.mouseButton(Re)===0&&!Re.ctrlKey});return new Bt({clickTolerance:Ie,move:(Re,Ge)=>({around:Ge,panDelta:Ge.sub(Re)}),activateOnStart:!0,moveStateManager:De,enable:Te,assignEvents:hs})}(t),le=new Mf(t,r);r.dragPan=new zc(u,Y,le),this._add("mousePan",Y),this._add("touchPan",le,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&r.dragPan.enable(t.dragPan);const se=new Rf,ce=new Ec;r.touchZoomRotate=new dh(u,ce,se,P),this._add("touchRotate",se,["touchPan","touchZoom"]),this._add("touchZoom",ce,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&r.touchZoomRotate.enable(t.touchZoomRotate);const fe=r.scrollZoom=new Ff(r,()=>this._triggerRenderFrame());this._add("scrollZoom",fe,["mousePan"]),t.interactive&&t.scrollZoom&&r.scrollZoom.enable(t.scrollZoom);const we=r.keyboard=new zf(r);this._add("keyboard",we),t.interactive&&t.keyboard&&r.keyboard.enable(),this._add("blockableMapEvent",new tg(r))}_add(t,r,u){this._handlers.push({handlerName:t,handler:r,allowed:u}),this._handlersById[t]=r}stop(t){if(!this._updatingCamera){for(const{handler:r}of this._handlers)r.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Lc(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,r,u){for(const d in t)if(d!==u&&(!r||r.indexOf(d)<0))return!0;return!1}_getMapTouches(t){const r=[];for(const u of t)this._el.contains(u.target)&&r.push(u);return r}mergeHandlerResult(t,r,u,d,y){if(!u)return;o.e(t,u);const x={handlerName:d,originalEvent:u.originalEvent||y};u.zoomDelta!==void 0&&(r.zoom=x),u.panDelta!==void 0&&(r.drag=x),u.rollDelta!==void 0&&(r.roll=x),u.pitchDelta!==void 0&&(r.pitch=x),u.bearingDelta!==void 0&&(r.rotate=x)}_applyChanges(){const t={},r={},u={};for(const[d,y,x]of this._changes)d.panDelta&&(t.panDelta=(t.panDelta||new o.P(0,0))._add(d.panDelta)),d.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+d.zoomDelta),d.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+d.bearingDelta),d.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+d.pitchDelta),d.rollDelta&&(t.rollDelta=(t.rollDelta||0)+d.rollDelta),d.around!==void 0&&(t.around=d.around),d.pinchAround!==void 0&&(t.pinchAround=d.pinchAround),d.noInertia&&(t.noInertia=d.noInertia),o.e(r,y),o.e(u,x);this._updateMapTransform(t,r,u),this._changes=[]}_updateMapTransform(t,r,u){const d=this._map,y=d._getTransformForUpdate(),x=d.terrain;if(!(Mo(t)||x&&this._terrainMovement))return this._fireEvents(r,u,!0);d._stop(!0);let{panDelta:S,zoomDelta:P,bearingDelta:E,pitchDelta:B,rollDelta:V,around:j,pinchAround:X}=t;X!==void 0&&(j=X),j=j||d.transform.centerPoint,x&&!y.isPointOnMapSurface(j)&&(j=y.centerPoint);const Y={panDelta:S,zoomDelta:P,rollDelta:V,pitchDelta:B,bearingDelta:E,around:j};this._map.cameraHelper.useGlobeControls&&!y.isPointOnMapSurface(j)&&(j=y.centerPoint);const le=j.distSqr(y.centerPoint)<.01?y.center:y.screenPointToLocation(S?j.sub(S):j);x?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Y,y),this._terrainMovement||!r.drag&&!r.zoom?r.drag&&this._terrainMovement?y.setCenter(y.screenPointToLocation(y.centerPoint.sub(S))):this._map.cameraHelper.handleMapControlsPan(Y,y,le):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(Y,y,le))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Y,y),this._map.cameraHelper.handleMapControlsPan(Y,y,le)),d._applyUpdatedTransform(y),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(r,u,!0)}_fireEvents(t,r,u){const d=Lc(this._eventsInProgress),y=Lc(t),x={};for(const V in t){const{originalEvent:j}=t[V];this._eventsInProgress[V]||(x[`${V}start`]=j),this._eventsInProgress[V]=t[V]}!d&&y&&this._fireEvent("movestart",y.originalEvent);for(const V in x)this._fireEvent(V,x[V]);y&&this._fireEvent("move",y.originalEvent);for(const V in t){const{originalEvent:j}=t[V];this._fireEvent(V,j)}const S={};let P;for(const V in this._eventsInProgress){const{handlerName:j,originalEvent:X}=this._eventsInProgress[V];this._handlersById[j].isActive()||(delete this._eventsInProgress[V],P=r[j]||X,S[`${V}end`]=P)}for(const V in S)this._fireEvent(V,S[V]);const E=Lc(this._eventsInProgress),B=(d||y)&&!E;if(B&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const V=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&V.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(V)}if(u&&B){this._updatingCamera=!0;const V=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),j=X=>X!==0&&-this._bearingSnap<X&&X<this._bearingSnap;!V||!V.essential&&O.prefersReducedMotion?(this._map.fire(new o.k("moveend",{originalEvent:P})),j(this._map.getBearing())&&this._map.resetNorth()):(j(V.bearing||this._map.getBearing())&&(V.bearing=0),V.freezeElevation=!0,this._map.easeTo(V,{originalEvent:P})),this._updatingCamera=!1}}_fireEvent(t,r){this._map.fire(new o.k(t,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new Ia("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class rn extends o.E{constructor(t,r,u){super(),this._renderFrameCallback=()=>{const d=Math.min((O.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(d)),d<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=u.bearingSnap,this.cameraHelper=r,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(t,r){t.apply(this.transform),this.transform=t,this.cameraHelper=r}getCenter(){return new o.N(this.transform.center.lng,this.transform.center.lat)}setCenter(t,r){return this.jumpTo({center:t},r)}getCenterElevation(){return this.transform.elevation}setCenterElevation(t,r){return this.jumpTo({elevation:t},r),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(t){this._centerClampedToGround=t}panBy(t,r,u){return t=o.P.convert(t).mult(-1),this.panTo(this.transform.center,o.e({offset:t},r),u)}panTo(t,r,u){return this.easeTo(o.e({center:t},r),u)}getZoom(){return this.transform.zoom}setZoom(t,r){return this.jumpTo({zoom:t},r),this}zoomTo(t,r,u){return this.easeTo(o.e({zoom:t},r),u)}zoomIn(t,r){return this.zoomTo(this.getZoom()+1,t,r),this}zoomOut(t,r){return this.zoomTo(this.getZoom()-1,t,r),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(t,r){return t!=this.transform.fov&&(this.transform.setFov(t),this.fire(new o.k("movestart",r)).fire(new o.k("move",r)).fire(new o.k("moveend",r))),this}getBearing(){return this.transform.bearing}setBearing(t,r){return this.jumpTo({bearing:t},r),this}getPadding(){return this.transform.padding}setPadding(t,r){return this.jumpTo({padding:t},r),this}rotateTo(t,r,u){return this.easeTo(o.e({bearing:t},r),u)}resetNorth(t,r){return this.rotateTo(0,o.e({duration:1e3},t),r),this}resetNorthPitch(t,r){return this.easeTo(o.e({bearing:0,pitch:0,roll:0,duration:1e3},t),r),this}snapToNorth(t,r){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,r):this}getPitch(){return this.transform.pitch}setPitch(t,r){return this.jumpTo({pitch:t},r),this}getRoll(){return this.transform.roll}setRoll(t,r){return this.jumpTo({roll:t},r),this}cameraForBounds(t,r){t=Le.convert(t).adjustAntiMeridian();const u=r&&r.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),u,r)}_cameraForBoxAndBearing(t,r,u,d){const y={top:0,bottom:0,right:0,left:0};if(typeof(d=o.e({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){const E=d.padding;d.padding={top:E,bottom:E,right:E,left:E}}const x=o.e(y,d.padding);d.padding=x;const S=this.transform,P=new Le(t,r);return this.cameraHelper.cameraForBoxAndBearing(d,x,P,u,S)}fitBounds(t,r,u){return this._fitInternal(this.cameraForBounds(t,r),r,u)}fitScreenCoordinates(t,r,u,d,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(o.P.convert(t)),this.transform.screenPointToLocation(o.P.convert(r)),u,d),d,y)}_fitInternal(t,r,u){return t?(delete(r=o.e(t,r)).padding,r.linear?this.easeTo(r,u):this.flyTo(r,u)):this}jumpTo(t,r){this.stop();const u=this._getTransformForUpdate();let d=!1,y=!1,x=!1;const S=u.zoom;this.cameraHelper.handleJumpToCenterZoom(u,t);const P=u.zoom!==S;return"elevation"in t&&u.elevation!==+t.elevation&&u.setElevation(+t.elevation),"bearing"in t&&u.bearing!==+t.bearing&&(d=!0,u.setBearing(+t.bearing)),"pitch"in t&&u.pitch!==+t.pitch&&(y=!0,u.setPitch(+t.pitch)),"roll"in t&&u.roll!==+t.roll&&(x=!0,u.setRoll(+t.roll)),t.padding==null||u.isPaddingEqual(t.padding)||u.setPadding(t.padding),this._applyUpdatedTransform(u),this.fire(new o.k("movestart",r)).fire(new o.k("move",r)),P&&this.fire(new o.k("zoomstart",r)).fire(new o.k("zoom",r)).fire(new o.k("zoomend",r)),d&&this.fire(new o.k("rotatestart",r)).fire(new o.k("rotate",r)).fire(new o.k("rotateend",r)),y&&this.fire(new o.k("pitchstart",r)).fire(new o.k("pitch",r)).fire(new o.k("pitchend",r)),x&&this.fire(new o.k("rollstart",r)).fire(new o.k("roll",r)).fire(new o.k("rollend",r)),this.fire(new o.k("moveend",r))}calculateCameraOptionsFromTo(t,r,u,d=0){const y=o.Y.fromLngLat(t,r),x=o.Y.fromLngLat(u,d),S=x.x-y.x,P=x.y-y.y,E=x.z-y.z,B=Math.hypot(S,P,E);if(B===0)throw new Error("Can't calculate camera options with same From and To");const V=Math.hypot(S,P),j=o.a8(this.transform.cameraToCenterDistance/B/this.transform.tileSize),X=180*Math.atan2(S,-P)/Math.PI;let Y=180*Math.acos(V/B)/Math.PI;return Y=E<0?90-Y:90+Y,{center:x.toLngLat(),elevation:d,zoom:j,pitch:Y,bearing:X}}calculateCameraOptionsFromCameraLngLatAltRotation(t,r,u,d,y){const x=this.transform.calculateCenterFromCameraLngLatAlt(t,r,u,d);return{center:x.center,elevation:x.elevation,zoom:x.zoom,bearing:u,pitch:d,roll:y}}easeTo(t,r){this._stop(!1,t.easeId),((t=o.e({offset:[0,0],duration:500,easing:o.c8},t)).animate===!1||!t.essential&&O.prefersReducedMotion)&&(t.duration=0);const u=this._getTransformForUpdate(),d=this.getBearing(),y=u.pitch,x=u.roll,S="bearing"in t?this._normalizeBearing(t.bearing,d):d,P="pitch"in t?+t.pitch:y,E="roll"in t?this._normalizeBearing(t.roll,x):x,B="padding"in t?t.padding:u.padding,V=o.P.convert(t.offset);let j,X;t.around&&(j=o.N.convert(t.around),X=u.locationToScreenPoint(j));const Y={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},le=this.cameraHelper.handleEaseTo(u,{bearing:S,pitch:P,roll:E,padding:B,around:j,aroundPoint:X,offsetAsPoint:V,offset:t.offset,zoom:t.zoom,center:t.center});return this._rotating=this._rotating||d!==S,this._pitching=this._pitching||P!==y,this._rolling=this._rolling||E!==x,this._padding=!u.isPaddingEqual(B),this._zooming=this._zooming||le.isZooming,this._easeId=t.easeId,this._prepareEase(r,t.noMoveStart,Y),this.terrain&&this._prepareElevation(le.elevationCenter),this._ease(se=>{le.easeFunc(se),this.terrain&&!t.freezeElevation&&this._updateElevation(se),this._applyUpdatedTransform(u),this._fireMoveEvents(r)},se=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(r,se)},t),this}_prepareEase(t,r,u={}){this._moving=!0,r||u.moving||this.fire(new o.k("movestart",t)),this._zooming&&!u.zooming&&this.fire(new o.k("zoomstart",t)),this._rotating&&!u.rotating&&this.fire(new o.k("rotatestart",t)),this._pitching&&!u.pitching&&this.fire(new o.k("pitchstart",t)),this._rolling&&!u.rolling&&this.fire(new o.k("rollstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const r=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&r!==this._elevationTarget){const u=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(u-(r-(u*t+this._elevationStart))/(1-t)),this._elevationTarget=r}this.transform.setElevation(o.y.number(this._elevationStart,this._elevationTarget,t))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){if(!this.terrain&&t.elevation>=0&&t.pitch<=90)return{};const r=t.getCameraLngLat(),u=t.getCameraAltitude(),d=this.terrain?this.terrain.getElevationForLngLatZoom(r,t.zoom):0;if(u<d){const y=this.calculateCameraOptionsFromTo(r,d,t.center,t.elevation);return{pitch:y.pitch,zoom:y.zoom}}return{}}_applyUpdatedTransform(t){const r=[];if(r.push(d=>this._elevateCameraIfInsideTerrain(d)),this.transformCameraUpdate&&r.push(d=>this.transformCameraUpdate(d)),!r.length)return;const u=t.clone();for(const d of r){const y=u.clone(),{center:x,zoom:S,roll:P,pitch:E,bearing:B,elevation:V}=d(y);x&&y.setCenter(x),V!==void 0&&y.setElevation(V),S!==void 0&&y.setZoom(S),P!==void 0&&y.setRoll(P),E!==void 0&&y.setPitch(E),B!==void 0&&y.setBearing(B),u.apply(y)}this.transform.apply(u)}_fireMoveEvents(t){this.fire(new o.k("move",t)),this._zooming&&this.fire(new o.k("zoom",t)),this._rotating&&this.fire(new o.k("rotate",t)),this._pitching&&this.fire(new o.k("pitch",t)),this._rolling&&this.fire(new o.k("roll",t))}_afterEase(t,r){if(this._easeId&&r&&this._easeId===r)return;delete this._easeId;const u=this._zooming,d=this._rotating,y=this._pitching,x=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,u&&this.fire(new o.k("zoomend",t)),d&&this.fire(new o.k("rotateend",t)),y&&this.fire(new o.k("pitchend",t)),x&&this.fire(new o.k("rollend",t)),this.fire(new o.k("moveend",t))}flyTo(t,r){if(!t.essential&&O.prefersReducedMotion){const et=o.M(t,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(et,r)}this.stop(),t=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.c8},t);const u=this._getTransformForUpdate(),d=u.bearing,y=u.pitch,x=u.roll,S=u.padding,P="bearing"in t?this._normalizeBearing(t.bearing,d):d,E="pitch"in t?+t.pitch:y,B="roll"in t?this._normalizeBearing(t.roll,x):x,V="padding"in t?t.padding:u.padding,j=o.P.convert(t.offset);let X=u.centerPoint.add(j);const Y=u.screenPointToLocation(X),le=this.cameraHelper.handleFlyTo(u,{bearing:P,pitch:E,roll:B,padding:V,locationAtOffset:Y,offsetAsPoint:j,center:t.center,minZoom:t.minZoom,zoom:t.zoom});let se=t.curve;const ce=Math.max(u.width,u.height),fe=ce/le.scaleOfZoom,we=le.pixelPathLength;typeof le.scaleOfMinZoom=="number"&&(se=Math.sqrt(ce/le.scaleOfMinZoom/we*2));const Te=se*se;function Ie(et){const Pt=(fe*fe-ce*ce+(et?-1:1)*Te*Te*we*we)/(2*(et?fe:ce)*Te*we);return Math.log(Math.sqrt(Pt*Pt+1)-Pt)}function De(et){return(Math.exp(et)-Math.exp(-et))/2}function Re(et){return(Math.exp(et)+Math.exp(-et))/2}const Ge=Ie(!1);let Ze=function(et){return Re(Ge)/Re(Ge+se*et)},rt=function(et){return ce*((Re(Ge)*(De(Pt=Ge+se*et)/Re(Pt))-De(Ge))/Te)/we;var Pt},lt=(Ie(!0)-Ge)/se;if(Math.abs(we)<2e-6||!isFinite(lt)){if(Math.abs(ce-fe)<1e-6)return this.easeTo(t,r);const et=fe<ce?-1:1;lt=Math.abs(Math.log(fe/ce))/se,rt=()=>0,Ze=Pt=>Math.exp(et*se*Pt)}return t.duration="duration"in t?+t.duration:1e3*lt/("screenSpeed"in t?+t.screenSpeed/se:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=d!==P,this._pitching=E!==y,this._rolling=B!==x,this._padding=!u.isPaddingEqual(V),this._prepareEase(r,!1),this.terrain&&this._prepareElevation(le.targetCenter),this._ease(et=>{const Pt=et*lt,St=1/Ze(Pt),ft=rt(Pt);this._rotating&&u.setBearing(o.y.number(d,P,et)),this._pitching&&u.setPitch(o.y.number(y,E,et)),this._rolling&&u.setRoll(o.y.number(x,B,et)),this._padding&&(u.interpolatePadding(S,V,et),X=u.centerPoint.add(j)),le.easeFunc(et,St,ft,X),this.terrain&&!t.freezeElevation&&this._updateElevation(et),this._applyUpdatedTransform(u),this._fireMoveEvents(r)},()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(r)},t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,r){var u;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,r)}return t||(u=this.handlers)===null||u===void 0||u.stop(!1),this}_ease(t,r,u){u.animate===!1||u.duration===0?(t(1),r()):(this._easeStart=O.now(),this._easeOptions=u,this._onEaseFrame=t,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,r){t=o.aI(t,-180,180);const u=Math.abs(t-r);return Math.abs(t-360-r)<u&&(t-=360),Math.abs(t+360-r)<u&&(t+=360),t}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(o.N.convert(t),this.transform.tileZoom):null}}const xl={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Bc{constructor(t=xl){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=r=>{!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"&&r.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=z.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=z.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=z.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){z.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._sanitizedAttributionHTML=void 0}_setElementTitle(t,r){const u=this._map._getUIString(`AttributionControl.${r}`);t.title=u,t.setAttribute("aria-label",u)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(d=>typeof d!="string"?"":d)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}const r=this._map.style.sourceCaches;for(const d in r){const y=r[d];if(y.used||y.usedForTerrain){const x=y.getSource();x.attribution&&t.indexOf(x.attribution)<0&&t.push(x.attribution)}}t=t.filter(d=>String(d).trim()),t.sort((d,y)=>d.length-y.length),t=t.filter((d,y)=>{for(let x=y+1;x<t.length;x++)if(t[x].indexOf(d)>=0)return!1;return!0});const u=t.join(" | ");u!==this._sanitizedAttributionHTML&&(this._sanitizedAttributionHTML=z.sanitize(u),t.length?(this._innerContainer.innerHTML=this._sanitizedAttributionHTML,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Fc{constructor(t={}){this._updateCompact=()=>{const r=this._container.children;if(r.length){const u=r[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&u.classList.add("maplibregl-compact"):u.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=z.create("div","maplibregl-ctrl");const r=z.create("a","maplibregl-ctrl-logo");return r.target="_blank",r.rel="noopener nofollow",r.href="https://maplibre.org/",r.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),r.setAttribute("rel","noopener nofollow"),this._container.appendChild(r),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){z.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Er{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const r=++this._id;return this._queue.push({callback:t,id:r,cancelled:!1}),r}remove(t){const r=this._currentlyRunning,u=r?this._queue.concat(r):this._queue;for(const d of u)if(d.id===t)return void(d.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const r=this._currentlyRunning=this._queue;this._queue=[];for(const u of r)if(!u.cancelled&&(u.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Of=o.aA([{name:"a_pos3d",type:"Int16",components:3}]);class Ma extends o.E{constructor(t){super(),this._lastTilesetChange=O.now(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=t._source.tileSize*2**this.deltaZoom,t.usedForTerrain=!0,t.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,r){this.sourceCache.update(t,r),this._renderableTilesKeys=[];const u={};for(const d of ae(t,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:r,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))u[d.key]=!0,this._renderableTilesKeys.push(d.key),this._tiles[d.key]||(d.terrainRttPosMatrix32f=new Float64Array(16),o.bL(d.terrainRttPosMatrix32f,0,o.X,o.X,0,0,1),this._tiles[d.key]=new An(d,this.tileSize),this._lastTilesetChange=O.now());for(const d in this._tiles)u[d]||delete this._tiles[d]}freeRtt(t){for(const r in this._tiles){const u=this._tiles[r];(!t||u.tileID.equals(t)||u.tileID.isChildOf(t)||t.isChildOf(u.tileID))&&(u.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const r={};for(const u of this._renderableTilesKeys){const d=this._tiles[u].tileID,y=t.clone(),x=o.a$();if(d.canonical.equals(t.canonical))o.bL(x,0,o.X,o.X,0,0,1);else if(d.canonical.isChildOf(t.canonical)){const S=d.canonical.z-t.canonical.z,P=d.canonical.x-(d.canonical.x>>S<<S),E=d.canonical.y-(d.canonical.y>>S<<S),B=o.X>>S;o.bL(x,0,B,B,0,0,1),o.J(x,x,[-P*B,-E*B,0])}else{if(!t.canonical.isChildOf(d.canonical))continue;{const S=t.canonical.z-d.canonical.z,P=t.canonical.x-(t.canonical.x>>S<<S),E=t.canonical.y-(t.canonical.y>>S<<S),B=o.X>>S;o.bL(x,0,o.X,o.X,0,0,1),o.J(x,x,[P*B,E*B,0]),o.K(x,x,[1/2**S,1/2**S,0])}}y.terrainRttPosMatrix32f=new Float32Array(x),r[u]=y}return r}getSourceTile(t,r){const u=this.sourceCache._source;let d=t.overscaledZ-this.deltaZoom;if(d>u.maxzoom&&(d=u.maxzoom),d<u.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(d).key);let y=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!y||!y.dem)&&r)for(;d>=u.minzoom&&(!y||!y.dem);)y=this.sourceCache.getTileByID(t.scaledTo(d--).key);return y}anyTilesAfterTime(t=Date.now()){return this._lastTilesetChange>=t}}class ng{constructor(t,r,u){this._meshCache={},this.painter=t,this.sourceCache=new Ma(r),this.options=u,this.exaggeration=typeof u.exaggeration=="number"?u.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,r,u,d=o.X){var y;if(!(r>=0&&r<d&&u>=0&&u<d))return 0;const x=this.getTerrainData(t),S=(y=x.tile)===null||y===void 0?void 0:y.dem;if(!S)return 0;const P=o.c9([],[r/d*o.X,u/d*o.X],x.u_terrain_matrix),E=[P[0]*S.dim,P[1]*S.dim],B=Math.floor(E[0]),V=Math.floor(E[1]),j=E[0]-B,X=E[1]-V;return S.get(B,V)*(1-j)*(1-X)+S.get(B+1,V)*j*(1-X)+S.get(B,V+1)*(1-j)*X+S.get(B+1,V+1)*j*X}getElevationForLngLatZoom(t,r){if(!o.ca(r,t.wrap()))return 0;const{tileID:u,mercatorX:d,mercatorY:y}=this._getOverscaledTileIDFromLngLatZoom(t,r);return this.getElevation(u,d%o.X,y%o.X,o.X)}getElevation(t,r,u,d=o.X){return this.getDEMElevation(t,r,u,d)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const d=this.painter.context,y=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ye(d,y,d.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ye(d,new o.R({width:1,height:1}),d.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.aq([])}const r=this.sourceCache.getSourceTile(t,!0);if(r&&r.dem&&(!r.demTexture||r.needsTerrainPrepare)){const d=this.painter.context;r.demTexture=this.painter.getTileTexture(r.dem.stride),r.demTexture?r.demTexture.update(r.dem.getPixels(),{premultiply:!1}):r.demTexture=new ye(d,r.dem.getPixels(),d.gl.RGBA,{premultiply:!1}),r.demTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),r.needsTerrainPrepare=!1}const u=r&&r+r.tileID.key+t.key;if(u&&!this._demMatrixCache[u]){const d=this.sourceCache.sourceCache._source.maxzoom;let y=t.canonical.z-r.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=d?y=t.canonical.z-d:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const x=t.canonical.x-(t.canonical.x>>y<<y),S=t.canonical.y-(t.canonical.y>>y<<y),P=o.cb(new Float64Array(16),[1/(o.X<<y),1/(o.X<<y),0]);o.J(P,P,[x*o.X,S*o.X,0]),this._demMatrixCache[t.key]={matrix:P,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:r&&r.dem&&r.dem.dim||1,u_terrain_matrix:u?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:r&&r.dem&&r.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(r&&r.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:r}}getFramebuffer(t){const r=this.painter,u=r.width/devicePixelRatio,d=r.height/devicePixelRatio;return!this._fbo||this._fbo.width===u&&this._fbo.height===d||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ye(r.context,{width:u,height:d,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ye(r.context,{width:u,height:d,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=r.context.createFramebuffer(u,d,!0,!1),this._fbo.depthAttachment.set(r.context.createRenderbuffer(r.context.gl.DEPTH_COMPONENT16,u,d))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const r=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let y=0,x=0;y<this._coordsTextureSize;y++)for(let S=0;S<this._coordsTextureSize;S++,x+=4)r[x+0]=255&S,r[x+1]=255&y,r[x+2]=S>>8<<4|y>>8,r[x+3]=0;const u=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(r.buffer)),d=new ye(t,u,t.gl.RGBA,{premultiply:!1});return d.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=d,d}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const r=new Uint8Array(4),u=this.painter.context,d=u.gl,y=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),x=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),S=Math.round(this.painter.height/devicePixelRatio);u.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(y,S-x-1,1,1,d.RGBA,d.UNSIGNED_BYTE,r),u.bindFramebuffer.set(null);const P=r[0]+(r[2]>>4<<8),E=r[1]+((15&r[2])<<8),B=this.coordsIndex[255-r[3]],V=B&&this.sourceCache.getTileByID(B);if(!V)return null;const j=this._coordsTextureSize,X=(1<<V.tileID.canonical.z)*j;return new o.Y((V.tileID.canonical.x*j+P)/X+V.tileID.wrap,(V.tileID.canonical.y*j+E)/X,this.getElevation(V.tileID,P,E,j))}depthAtPoint(t){const r=new Uint8Array(4),u=this.painter.context,d=u.gl;return u.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),d.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,r),u.bindFramebuffer.set(null),(r[0]/16777216+r[1]/65536+r[2]/256+r[3])/256}getTerrainMesh(t){var r;const u=((r=this.painter.style.projection)===null||r===void 0?void 0:r.transitionState)>0,d=u&&t.canonical.y===0,y=u&&t.canonical.y===(1<<t.canonical.z)-1,x=`m_${d?"n":""}_${y?"s":""}`;if(this._meshCache[x])return this._meshCache[x];const S=this.painter.context,P=new o.cc,E=new o.aE,B=this.meshSize,V=o.X/B,j=B*B;for(let Re=0;Re<=B;Re++)for(let Ge=0;Ge<=B;Ge++)P.emplaceBack(Ge*V,Re*V,0);for(let Re=0;Re<j;Re+=B+1)for(let Ge=0;Ge<B;Ge++)E.emplaceBack(Ge+Re,B+Ge+Re+1,B+Ge+Re+2),E.emplaceBack(Ge+Re,B+Ge+Re+2,Ge+Re+1);const X=P.length,Y=X+(B+1),le=(B+1)*B,se=d?o.b6:0,ce=d?0:1,fe=y?o.b7:o.X,we=y?0:1;for(let Re=0;Re<=B;Re++)P.emplaceBack(Re*V,se,ce);for(let Re=0;Re<=B;Re++)P.emplaceBack(Re*V,fe,we);for(let Re=0;Re<B;Re++)E.emplaceBack(le+Re,Y+Re,Y+Re+1),E.emplaceBack(le+Re,Y+Re+1,le+Re+1),E.emplaceBack(0+Re,X+Re+1,X+Re),E.emplaceBack(0+Re,0+Re+1,X+Re+1);const Te=P.length,Ie=Te+2*(B+1);for(const Re of[0,1])for(let Ge=0;Ge<=B;Ge++)for(const Ze of[0,1])P.emplaceBack(Re*o.X,Ge*V,Ze);for(let Re=0;Re<2*B;Re+=2)E.emplaceBack(Te+Re,Te+Re+1,Te+Re+3),E.emplaceBack(Te+Re,Te+Re+3,Te+Re+2),E.emplaceBack(Ie+Re,Ie+Re+3,Ie+Re+1),E.emplaceBack(Ie+Re,Ie+Re+2,Ie+Re+3);const De=new Pa(S.createVertexBuffer(P,Of.members),S.createIndexBuffer(E),o.aD.simpleSegment(0,0,P.length,E.length));return this._meshCache[x]=De,De}getMeshFrameDelta(t){return 2*Math.PI*o.bo/Math.pow(2,Math.max(t,0))/5}getMinTileElevationForLngLatZoom(t,r){var u;const{tileID:d}=this._getOverscaledTileIDFromLngLatZoom(t,r);return(u=this.getMinMaxElevation(d).minElevation)!==null&&u!==void 0?u:0}getMinMaxElevation(t){const r=this.getTerrainData(t).tile,u={minElevation:null,maxElevation:null};return r&&r.dem&&(u.minElevation=r.dem.min*this.exaggeration,u.maxElevation=r.dem.max*this.exaggeration),u}_getOverscaledTileIDFromLngLatZoom(t,r){const u=o.Y.fromLngLat(t.wrap()),d=(1<<r)*o.X,y=u.x*d,x=u.y*d,S=Math.floor(y/o.X),P=Math.floor(x/o.X);return{tileID:new o.S(r,0,r,S,P),mercatorX:y,mercatorY:x}}}class wl{constructor(t,r,u){this._context=t,this._size=r,this._tileSize=u,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const r=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),u=new ye(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return u.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),r.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),r.colorAttachment.set(u.texture),{id:t,fbo:r,texture:u,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(r=>t.id!==r),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const r of this._recentlyUsed)if(!this._objects[r].inUse)return this._objects[r];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(t=>!t.inUse)===!1}}const Qn={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class zi{constructor(t,r){this.painter=t,this.terrain=r,this.pool=new wl(t.context,30,r.sourceCache.tileSize*r.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,r){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter(u=>!t._layers[u].isHidden(r)),this._coordsAscending={};for(const u in t.sourceCaches){this._coordsAscending[u]={};const d=t.sourceCaches[u].getVisibleCoordinates();for(const y of d){const x=this.terrain.sourceCache.getTerrainCoords(y);for(const S in x)this._coordsAscending[u][S]||(this._coordsAscending[u][S]=[]),this._coordsAscending[u][S].push(x[S])}}this._coordsAscendingStr={};for(const u of t._order){const d=t._layers[u],y=d.source;if(Qn[d.type]&&!this._coordsAscendingStr[y]){this._coordsAscendingStr[y]={};for(const x in this._coordsAscending[y])this._coordsAscendingStr[y][x]=this._coordsAscending[y][x].map(S=>S.key).sort().join()}}for(const u of this._renderableTiles)for(const d in this._coordsAscendingStr){const y=this._coordsAscendingStr[d][u.tileID.key];y&&y!==u.rttCoords[d]&&(u.rtt=[])}}renderLayer(t,r){if(t.isHidden(this.painter.transform.zoom))return!1;const u=Object.assign(Object.assign({},r),{isRenderingToTexture:!0}),d=t.type,y=this.painter,x=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(Qn[d]&&(this._prevType&&Qn[this._prevType]||this._stacks.push([]),this._prevType=d,this._stacks[this._stacks.length-1].push(t.id),!x))return!0;if(Qn[this._prevType]||Qn[d]&&x){this._prevType=d;const S=this._stacks.length-1,P=this._stacks[S]||[];for(const E of this._renderableTiles){if(this.pool.isFull()&&(oh(this.painter,this.terrain,this._rttTiles,u),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(E),E.rtt[S]){const V=this.pool.getObjectForId(E.rtt[S].id);if(V.stamp===E.rtt[S].stamp){this.pool.useObject(V);continue}}const B=this.pool.getOrCreateFreeObject();this.pool.useObject(B),this.pool.stampObject(B),E.rtt[S]={id:B.id,stamp:B.stamp},y.context.bindFramebuffer.set(B.fbo.framebuffer),y.context.clear({color:o.b4.transparent,stencil:0}),y.currentStencilSource=void 0;for(let V=0;V<P.length;V++){const j=y.style._layers[P[V]],X=j.source?this._coordsAscending[j.source][E.tileID.key]:[E.tileID];y.context.viewport.set([0,0,B.fbo.width,B.fbo.height]),y._renderTileClippingMasks(j,X,!0),y.renderLayer(y,y.style.sourceCaches[j.source],j,X,u),j.source&&(E.rttCoords[j.source]=this._coordsAscendingStr[j.source][E.tileID.key])}}return oh(this.painter,this.terrain,this._rttTiles,u),this._rttTiles=[],this.pool.freeAllObjects(),Qn[d]}return!1}}const Vf={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Sl=T,Cl={hash:!1,interactive:!0,bearingSnap:7,attributionControl:xl,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},ph={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class mh{constructor(t,r,u=!1){this.mousedown=y=>{this.startMove(y,z.mousePos(this.element,y)),z.addEventListener(window,"mousemove",this.mousemove),z.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=y=>{this.move(y,z.mousePos(this.element,y))},this.mouseup=y=>{this._rotatePitchHanlder.dragEnd(y),this.offTemp()},this.touchstart=y=>{y.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=z.touchPos(this.element,y.targetTouches)[0],this.startMove(y,this._startPos),z.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),z.addEventListener(window,"touchend",this.touchend))},this.touchmove=y=>{y.targetTouches.length!==1?this.reset():(this._lastPos=z.touchPos(this.element,y.targetTouches)[0],this.move(y,this._lastPos))},this.touchend=y=>{y.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=r;const d=new bl;this._rotatePitchHanlder=new Bt({clickTolerance:3,move:(y,x)=>{const S=r.getBoundingClientRect(),P=new o.P((S.bottom-S.top)/2,(S.right-S.left)/2);return{bearingDelta:o.c7(new o.P(y.x,x.y),x,P),pitchDelta:u?-.5*(x.y-y.y):void 0}},moveStateManager:d,enable:!0,assignEvents:()=>{}}),this.map=t,z.addEventListener(r,"mousedown",this.mousedown),z.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),z.addEventListener(r,"touchcancel",this.reset)}startMove(t,r){this._rotatePitchHanlder.dragStart(t,r),z.disableDrag()}move(t,r){const u=this.map,{bearingDelta:d,pitchDelta:y}=this._rotatePitchHanlder.dragMove(t,r)||{};d&&u.setBearing(u.getBearing()+d),y&&u.setPitch(u.getPitch()+y)}off(){const t=this.element;z.removeEventListener(t,"mousedown",this.mousedown),z.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),z.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),z.removeEventListener(window,"touchend",this.touchend),z.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){z.enableDrag(),z.removeEventListener(window,"mousemove",this.mousemove),z.removeEventListener(window,"mouseup",this.mouseup),z.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),z.removeEventListener(window,"touchend",this.touchend)}}let qa;function Eo(g,t,r){const u=new o.N(g.lng,g.lat);if(g=new o.N(g.lng,g.lat),t){const d=new o.N(g.lng-360,g.lat),y=new o.N(g.lng+360,g.lat),x=r.locationToScreenPoint(g).distSqr(t);r.locationToScreenPoint(d).distSqr(t)<x?g=d:r.locationToScreenPoint(y).distSqr(t)<x&&(g=y)}for(;Math.abs(g.lng-r.center.lng)>180;){const d=r.locationToScreenPoint(g);if(d.x>=0&&d.y>=0&&d.x<=r.width&&d.y<=r.height)break;g.lng>r.center.lng?g.lng-=360:g.lng+=360}return g.lng!==u.lng&&r.isPointOnMapSurface(r.locationToScreenPoint(g))?g:u}const Tl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Oc(g,t,r){const u=g.classList;for(const d in Tl)u.remove(`maplibregl-${r}-anchor-${d}`);u.add(`maplibregl-${r}-anchor-${t}`)}class Pl extends o.E{constructor(t){if(super(),this._onKeyPress=r=>{const u=r.code,d=r.charCode||r.keyCode;u!=="Space"&&u!=="Enter"&&d!==32&&d!==13||this.togglePopup()},this._onMapClick=r=>{const u=r.originalEvent.target,d=this._element;this._popup&&(u===d||d.contains(u))&&this.togglePopup()},this._update=r=>{var u;if(!this._map)return;const d=this._map.loaded()&&!this._map.isMoving();((r==null?void 0:r.type)==="terrain"||(r==null?void 0:r.type)==="render"&&!d)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Eo(this._lngLat,this._flatPos,this._map.transform):(u=this._lngLat)===null||u===void 0?void 0:u.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let y="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?y=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(y=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let x="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?x="rotateX(0deg)":this._pitchAlignment==="map"&&(x=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||r&&r.type!=="moveend"||(this._pos=this._pos.round()),z.setTransform(this._element,`${Tl[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${x} ${y}`),O.frameAsync(new AbortController).then(()=>{this._updateOpacity(r&&r.type==="moveend")}).catch(()=>{})},this._onMove=r=>{if(!this._isDragging){const u=this._clickTolerance||this._map._clickTolerance;this._isDragging=r.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=r.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.k("dragstart"))),this.fire(new o.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.k("dragend")),this._state="inactive"},this._addDragHandler=r=>{this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos).add(this._offset),this._pointerdownPos=r.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(t==null?void 0:t.opacity,t==null?void 0:t.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=o.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=z.create("div");const r=z.createNS("http://www.w3.org/2000/svg","svg"),u=41,d=27;r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height",`${u}px`),r.setAttributeNS(null,"width",`${d}px`),r.setAttributeNS(null,"viewBox",`0 0 ${d} ${u}`);const y=z.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"stroke","none"),y.setAttributeNS(null,"stroke-width","1"),y.setAttributeNS(null,"fill","none"),y.setAttributeNS(null,"fill-rule","evenodd");const x=z.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"fill-rule","nonzero");const S=z.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"transform","translate(3.0, 29.0)"),S.setAttributeNS(null,"fill","#000000");const P=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ce of P){const fe=z.createNS("http://www.w3.org/2000/svg","ellipse");fe.setAttributeNS(null,"opacity","0.04"),fe.setAttributeNS(null,"cx","10.5"),fe.setAttributeNS(null,"cy","5.80029008"),fe.setAttributeNS(null,"rx",ce.rx),fe.setAttributeNS(null,"ry",ce.ry),S.appendChild(fe)}const E=z.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill",this._color);const B=z.createNS("http://www.w3.org/2000/svg","path");B.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),E.appendChild(B);const V=z.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"opacity","0.25"),V.setAttributeNS(null,"fill","#000000");const j=z.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),V.appendChild(j);const X=z.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"transform","translate(6.0, 7.0)"),X.setAttributeNS(null,"fill","#FFFFFF");const Y=z.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(8.0, 8.0)");const le=z.createNS("http://www.w3.org/2000/svg","circle");le.setAttributeNS(null,"fill","#000000"),le.setAttributeNS(null,"opacity","0.25"),le.setAttributeNS(null,"cx","5.5"),le.setAttributeNS(null,"cy","5.5"),le.setAttributeNS(null,"r","5.4999962");const se=z.createNS("http://www.w3.org/2000/svg","circle");se.setAttributeNS(null,"fill","#FFFFFF"),se.setAttributeNS(null,"cx","5.5"),se.setAttributeNS(null,"cy","5.5"),se.setAttributeNS(null,"r","5.4999962"),Y.appendChild(le),Y.appendChild(se),x.appendChild(S),x.appendChild(E),x.appendChild(V),x.appendChild(X),x.appendChild(Y),r.appendChild(x),r.setAttributeNS(null,"height",u*this._scale+"px"),r.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(r),this._offset=o.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",r=>{r.preventDefault()}),this._element.addEventListener("mousedown",r=>{r.preventDefault()}),Oc(this._element,this._anchor,"marker"),t&&t.className)for(const r of t.className.split(" "))this._element.classList.add(r);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),t.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),z.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=o.N.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const d=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(38.1-13.5+d)],"bottom-right":[-d,-1*(38.1-13.5+d)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var r,u;if(!(!((r=this._map)===null||r===void 0)&&r.terrain)){const V=this._map.transform.isLocationOccluded(this._lngLat)?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==V&&(this._element.style.opacity=V))}if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const d=this._map,y=d.terrain.depthAtPoint(this._pos),x=d.terrain.getElevationForLngLatZoom(this._lngLat,d.transform.tileZoom);if(d.transform.lngLatToCameraDepth(this._lngLat,x)-y<.006)return void(this._element.style.opacity=this._opacity);const S=-this._offset.y/d.transform.pixelsPerMeter,P=Math.sin(d.getPitch()*Math.PI/180)*S,E=d.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),B=d.transform.lngLatToCameraDepth(this._lngLat,x+P)-E>.006;!((u=this._popup)===null||u===void 0)&&u.isOpen()&&B&&this._popup.remove(),this._element.style.opacity=B?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=o.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,r){return t===void 0&&r===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),r!==void 0&&(this._opacityWhenCovered=r),this._map&&this._updateOpacity(!0),this}}const gh={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ao=0,Gs=!1;const _h={maxWidth:100,unit:"metric"};function Vc(g,t,r){const u=r&&r.maxWidth||100,d=g._container.clientHeight/2,y=g._container.clientWidth/2,x=g.unproject([y-u/2,d]),S=g.unproject([y+u/2,d]),P=Math.round(g.project(S).x-g.project(x).x),E=Math.min(u,P,g._container.clientWidth),B=x.distanceTo(S);if(r&&r.unit==="imperial"){const V=3.2808*B;V>5280?ds(t,E,V/5280,g._getUIString("ScaleControl.Miles")):ds(t,E,V,g._getUIString("ScaleControl.Feet"))}else r&&r.unit==="nautical"?ds(t,E,B/1852,g._getUIString("ScaleControl.NauticalMiles")):B>=1e3?ds(t,E,B/1e3,g._getUIString("ScaleControl.Kilometers")):ds(t,E,B,g._getUIString("ScaleControl.Meters"))}function ds(g,t,r,u){const d=function(y){const x=Math.pow(10,`${Math.floor(y)}`.length-1);let S=y/x;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(P){const E=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*E)/E}(S),x*S}(r);g.style.width=t*(d/r)+"px",g.innerHTML=`${d}&nbsp;${u}`}const yh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},vh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function kl(g){if(g){if(typeof g=="number"){const t=Math.round(Math.abs(g)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,g),"top-left":new o.P(t,t),"top-right":new o.P(-t,t),bottom:new o.P(0,-g),"bottom-left":new o.P(t,-t),"bottom-right":new o.P(-t,-t),left:new o.P(g,0),right:new o.P(-g,0)}}if(g instanceof o.P||Array.isArray(g)){const t=o.P.convert(g);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:o.P.convert(g.center||[0,0]),top:o.P.convert(g.top||[0,0]),"top-left":o.P.convert(g["top-left"]||[0,0]),"top-right":o.P.convert(g["top-right"]||[0,0]),bottom:o.P.convert(g.bottom||[0,0]),"bottom-left":o.P.convert(g["bottom-left"]||[0,0]),"bottom-right":o.P.convert(g["bottom-right"]||[0,0]),left:o.P.convert(g.left||[0,0]),right:o.P.convert(g.right||[0,0])}}return kl(new o.P(0,0))}const bh=T;m.AJAXError=o.cg,m.Event=o.k,m.Evented=o.E,m.LngLat=o.N,m.MercatorCoordinate=o.Y,m.Point=o.P,m.addProtocol=o.ch,m.config=o.a,m.removeProtocol=o.ci,m.AttributionControl=Bc,m.BoxZoomHandler=Tf,m.CanvasSource=wt,m.CooperativeGesturesHandler=fh,m.DoubleClickZoomHandler=Za,m.DragPanHandler=zc,m.DragRotateHandler=hh,m.EdgeInsets=pr,m.FullscreenControl=class extends o.E{constructor(g={}){super(),this._onFullscreenChange=()=>{var t;let r=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=r==null?void 0:r.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)r=r.shadowRoot.fullscreenElement;r===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=z.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){z.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const g=this._fullscreenButton=z.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);z.create("span","maplibregl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.title=g}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},m.GeoJSONSource=Lt,m.GeolocateControl=class extends o.E{constructor(g){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new o.k("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.k("geolocate",t)),this._finish()}},this._updateCamera=t=>{const r=new o.N(t.coords.longitude,t.coords.latitude),u=t.coords.accuracy,d=this._map.getBearing(),y=o.e({bearing:d},this.options.fitBoundsOptions),x=Le.fromLngLat(r,u);this._map.fitBounds(x,y,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const r=new o.N(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(this.options.trackUserLocation)if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&Gs)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.k("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=z.create("button","maplibregl-ctrl-geolocate",this._container),z.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=z.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Pl({element:this._dotElement}),this._circleElement=z.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Pl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.k("trackuserlocationend")),this.fire(new o.k("userlocationlostfocus")))})}},this.options=o.e({},gh,g)}onAdd(g){return this._map=g,this._container=z.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return o._(this,arguments,void 0,function*(t=!1){if(qa!==void 0&&!t)return qa;if(window.navigator.permissions===void 0)return qa=!!window.navigator.geolocation,qa;try{qa=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{qa=!!window.navigator.geolocation}return qa})}().then(t=>this._finishSetupUI(t)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),z.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ao=0,Gs=!1}_isOutOfMapMaxBounds(g){const t=this._map.getMaxBounds(),r=g.coords;return t&&(r.longitude<t.getWest()||r.longitude>t.getEast()||r.latitude<t.getSouth()||r.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const g=this._map.getBounds(),t=g.getSouthEast(),r=g.getNorthEast(),u=t.distanceTo(r),d=Math.ceil(this._accuracy/(u/this._map._container.clientHeight)*2);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ao--,Gs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.k("trackuserlocationstart")),this.fire(new o.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ao++,Ao>1?(g={maximumAge:6e5,timeout:0},Gs=!0):(g=this.options.positionOptions,Gs=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,g)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},m.GlobeControl=class{constructor(){this._toggleProjection=()=>{var g;const t=(g=this._map.getProjection())===null||g===void 0?void 0:g.type;this._map.setProjection(t!=="mercator"&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var g;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((g=this._map.getProjection())===null||g===void 0?void 0:g.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(g){return this._map=g,this._container=z.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=z.create("button","maplibregl-ctrl-globe",this._container),z.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){z.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},m.Hash=ch,m.ImageSource=It,m.KeyboardHandler=zf,m.LngLatBounds=Le,m.LogoControl=Fc,m.Map=class extends rn{constructor(g){var t,r;o.cd.mark(o.ce.create);const u=Object.assign(Object.assign(Object.assign({},Cl),g),{canvasContextAttributes:Object.assign(Object.assign({},Cl.canvasContextAttributes),g.canvasContextAttributes)});if(u.minZoom!=null&&u.maxZoom!=null&&u.minZoom>u.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(u.minPitch!=null&&u.maxPitch!=null&&u.minPitch>u.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(u.minPitch!=null&&u.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(u.maxPitch!=null&&u.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const d=new ja,y=new ac;if(u.minZoom!==void 0&&d.setMinZoom(u.minZoom),u.maxZoom!==void 0&&d.setMaxZoom(u.maxZoom),u.minPitch!==void 0&&d.setMinPitch(u.minPitch),u.maxPitch!==void 0&&d.setMaxPitch(u.maxPitch),u.renderWorldCopies!==void 0&&d.setRenderWorldCopies(u.renderWorldCopies),super(d,y,{bearingSnap:u.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Er,this._controls=[],this._mapId=o.a1(),this._contextLost=S=>{S.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new o.k("webglcontextlost",{originalEvent:S}))},this._contextRestored=S=>{this._setupPainter(),this.resize(),this._update(),this.fire(new o.k("webglcontextrestored",{originalEvent:S}))},this._onMapScroll=S=>{if(S.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=u.interactive,this._maxTileCacheSize=u.maxTileCacheSize,this._maxTileCacheZoomLevels=u.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},u.canvasContextAttributes),this._trackResize=u.trackResize===!0,this._bearingSnap=u.bearingSnap,this._centerClampedToGround=u.centerClampedToGround,this._refreshExpiredTiles=u.refreshExpiredTiles===!0,this._fadeDuration=u.fadeDuration,this._crossSourceCollisions=u.crossSourceCollisions===!0,this._collectResourceTiming=u.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Vf),u.locale),this._clickTolerance=u.clickTolerance,this._overridePixelRatio=u.pixelRatio,this._maxCanvasSize=u.maxCanvasSize,this.transformCameraUpdate=u.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=u.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=pe.addThrottleControl(()=>this.isMoving()),this._requestManager=new be(u.transformRequest),typeof u.container=="string"){if(this._container=document.getElementById(u.container),!this._container)throw new Error(`Container '${u.container}' not found.`)}else{if(!(u.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=u.container}if(u.maxBounds&&this.setMaxBounds(u.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let S=!1;const P=us(E=>{this._trackResize&&!this._removed&&(this.resize(E),this.redraw())},50);this._resizeObserver=new ResizeObserver(E=>{S?P(E):S=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Ht(this,u),this._hash=u.hash&&new ch(typeof u.hash=="string"&&u.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:u.center,elevation:u.elevation,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch,roll:u.roll}),u.bounds&&(this.resize(),this.fitBounds(u.bounds,o.e({},u.fitBoundsOptions,{duration:0}))));const x=typeof u.style=="string"||((r=(t=u.style)===null||t===void 0?void 0:t.projection)===null||r===void 0?void 0:r.type)!=="globe";this.resize(null,x),this._localIdeographFontFamily=u.localIdeographFontFamily,this._validateStyle=u.validateStyle,u.style&&this.setStyle(u.style,{localIdeographFontFamily:u.localIdeographFontFamily}),u.attributionControl&&this.addControl(new Bc(typeof u.attributionControl=="boolean"?void 0:u.attributionControl)),u.maplibreLogo&&this.addControl(new Fc,u.logoPosition),this.on("style.load",()=>{if(x||this._resizeTransform(),this.transform.unmodified){const S=o.M(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(S)}}),this.on("data",S=>{this._update(S.dataType==="style"),this.fire(new o.k(`${S.dataType}data`,S))}),this.on("dataloading",S=>{this.fire(new o.k(`${S.dataType}dataloading`,S))}),this.on("dataabort",S=>{this.fire(new o.k("sourcedataabort",S))})}_getMapId(){return this._mapId}addControl(g,t){if(t===void 0&&(t=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new o.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=g.onAdd(this);this._controls.push(g);const u=this._controlPositions[t];return t.indexOf("bottom")!==-1?u.insertBefore(r,u.firstChild):u.appendChild(r),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new o.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(g);return t>-1&&this._controls.splice(t,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}calculateCameraOptionsFromTo(g,t,r,u){return u==null&&this.terrain&&(u=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(g,t,r,u)}resize(g,t=!0){const[r,u]=this._containerDimensions(),d=this._getClampedPixelRatio(r,u);if(this._resizeCanvas(r,u,d),this.painter.resize(r,u,d),this.painter.overLimit()){const x=this.painter.context.gl;this._maxCanvasSize=[x.drawingBufferWidth,x.drawingBufferHeight];const S=this._getClampedPixelRatio(r,u);this._resizeCanvas(r,u,S),this.painter.resize(r,u,S)}this._resizeTransform(t);const y=!this._moving;return y&&(this.stop(),this.fire(new o.k("movestart",g)).fire(new o.k("move",g))),this.fire(new o.k("resize",g)),y&&this.fire(new o.k("moveend",g)),this}_resizeTransform(g=!0){var t;const[r,u]=this._containerDimensions();this.transform.resize(r,u,g),(t=this._requestedCameraState)===null||t===void 0||t.resize(r,u,g)}_getClampedPixelRatio(g,t){const{0:r,1:u}=this._maxCanvasSize,d=this.getPixelRatio(),y=g*d,x=t*d;return Math.min(y>r?r/y:1,x>u?u/x:1)*d}getPixelRatio(){var g;return(g=this._overridePixelRatio)!==null&&g!==void 0?g:devicePixelRatio}setPixelRatio(g){this._overridePixelRatio=g,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(g){return this.transform.setMaxBounds(Le.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.setMinZoom(g),this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.setMaxZoom(g),this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.setMinPitch(g),this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(g>=this.transform.minPitch)return this.transform.setMaxPitch(g),this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.setRenderWorldCopies(g),this._update()}project(g){return this.transform.locationToScreenPoint(o.N.convert(g),this.style&&this.terrain)}unproject(g){return this.transform.screenPointToLocation(o.P.convert(g),this.terrain)}isMoving(){var g;return this._moving||((g=this.handlers)===null||g===void 0?void 0:g.isMoving())}isZooming(){var g;return this._zooming||((g=this.handlers)===null||g===void 0?void 0:g.isZooming())}isRotating(){var g;return this._rotating||((g=this.handlers)===null||g===void 0?void 0:g.isRotating())}_createDelegatedListener(g,t,r){if(g==="mouseenter"||g==="mouseover"){let u=!1;return{layers:t,listener:r,delegates:{mousemove:y=>{const x=t.filter(P=>this.getLayer(P)),S=x.length!==0?this.queryRenderedFeatures(y.point,{layers:x}):[];S.length?u||(u=!0,r.call(this,new Ri(g,this,y.originalEvent,{features:S}))):u=!1},mouseout:()=>{u=!1}}}}if(g==="mouseleave"||g==="mouseout"){let u=!1;return{layers:t,listener:r,delegates:{mousemove:x=>{const S=t.filter(P=>this.getLayer(P));(S.length!==0?this.queryRenderedFeatures(x.point,{layers:S}):[]).length?u=!0:u&&(u=!1,r.call(this,new Ri(g,this,x.originalEvent)))},mouseout:x=>{u&&(u=!1,r.call(this,new Ri(g,this,x.originalEvent)))}}}}{const u=d=>{const y=t.filter(S=>this.getLayer(S)),x=y.length!==0?this.queryRenderedFeatures(d.point,{layers:y}):[];x.length&&(d.features=x,r.call(this,d),delete d.features)};return{layers:t,listener:r,delegates:{[g]:u}}}}_saveDelegatedListener(g,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(t)}_removeDelegatedListener(g,t,r){if(!this._delegatedListeners||!this._delegatedListeners[g])return;const u=this._delegatedListeners[g];for(let d=0;d<u.length;d++){const y=u[d];if(y.listener===r&&y.layers.length===t.length&&y.layers.every(x=>t.includes(x))){for(const x in y.delegates)this.off(x,y.delegates[x]);return void u.splice(d,1)}}}on(g,t,r){if(r===void 0)return super.on(g,t);const u=typeof t=="string"?[t]:t,d=this._createDelegatedListener(g,u,r);this._saveDelegatedListener(g,d);for(const y in d.delegates)this.on(y,d.delegates[y]);return{unsubscribe:()=>{this._removeDelegatedListener(g,u,r)}}}once(g,t,r){if(r===void 0)return super.once(g,t);const u=typeof t=="string"?[t]:t,d=this._createDelegatedListener(g,u,r);for(const y in d.delegates){const x=d.delegates[y];d.delegates[y]=(...S)=>{this._removeDelegatedListener(g,u,r),x(...S)}}this._saveDelegatedListener(g,d);for(const y in d.delegates)this.once(y,d.delegates[y]);return this}off(g,t,r){return r===void 0?super.off(g,t):(this._removeDelegatedListener(g,typeof t=="string"?[t]:t,r),this)}queryRenderedFeatures(g,t){if(!this.style)return[];let r;const u=g instanceof o.P||Array.isArray(g),d=u?g:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(u?{}:g)||{},d instanceof o.P||typeof d[0]=="number")r=[o.P.convert(d)];else{const y=o.P.convert(d[0]),x=o.P.convert(d[1]);r=[y,new o.P(x.x,y.y),x,new o.P(y.x,x.y),y]}return this.style.queryRenderedFeatures(r,t,this.transform)}querySourceFeatures(g,t){return this.style.querySourceFeatures(g,t)}setStyle(g,t){return(t=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(g,t))}setTransformRequest(g){return this._requestManager.setTransformRequest(g),this}_getUIString(g){const t=this._locale[g];if(t==null)throw new Error(`Missing UI string '${g}'`);return t}_updateStyle(g,t){var r,u;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(g,t));const d=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!g)),g?(this.style=new Qr(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g,t,d):this.style.loadJSON(g,t,d),this):((u=(r=this.style)===null||r===void 0?void 0:r.projection)===null||u===void 0||u.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Qr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,t){if(typeof g=="string"){const r=this._requestManager.transformRequest(g,"Style");o.h(r,new AbortController).then(u=>{this._updateDiff(u.data,t)}).catch(u=>{u&&this.fire(new o.j(u))})}else typeof g=="object"&&this._updateDiff(g,t)}_updateDiff(g,t){try{this.style.setState(g,t)&&this._update(!0)}catch(r){o.w(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(g,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(g,t){return this._lazyInitEmptyStyle(),this.style.addSource(g,t),this._update(!0)}isSourceLoaded(g){const t=this.style&&this.style.sourceCaches[g];if(t!==void 0)return t.loaded();this.fire(new o.j(new Error(`There is no source with ID '${g}'`)))}setTerrain(g){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),g){const t=this.style.sourceCaches[g.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${g.source}`);this.terrain===null&&t.reload();for(const r in this.style._layers){const u=this.style._layers[r];u.type==="hillshade"&&u.source===g.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new ng(this.painter,t,g),this.painter.renderToTexture=new zi(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=r=>{r.dataType==="style"?this.terrain.sourceCache.freeRtt():r.dataType==="source"&&r.tile&&(r.sourceId!==g.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),this.terrain.sourceCache.freeRtt(r.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new o.k("terrain",{terrain:g})),this}getTerrain(){var g,t;return(t=(g=this.terrain)===null||g===void 0?void 0:g.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const g=this.style&&this.style.sourceCaches;for(const t in g){const r=g[t]._tiles;for(const u in r){const d=r[u];if(d.state!=="loaded"&&d.state!=="errored")return!1}}return!0}removeSource(g){return this.style.removeSource(g),this._update(!0)}getSource(g){return this.style.getSource(g)}addImage(g,t,r={}){const{pixelRatio:u=1,sdf:d=!1,stretchX:y,stretchY:x,content:S,textFitWidth:P,textFitHeight:E}=r;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||o.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new o.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:B,height:V,data:j}=t,X=t;return this.style.addImage(g,{data:new o.R({width:B,height:V},new Uint8Array(j)),pixelRatio:u,stretchX:y,stretchY:x,content:S,textFitWidth:P,textFitHeight:E,sdf:d,version:0,userImage:X}),X.onAdd&&X.onAdd(this,g),this}}{const{width:B,height:V,data:j}=O.getImageData(t);this.style.addImage(g,{data:new o.R({width:B,height:V},j),pixelRatio:u,stretchX:y,stretchY:x,content:S,textFitWidth:P,textFitHeight:E,sdf:d,version:0})}}updateImage(g,t){const r=this.style.getImage(g);if(!r)return this.fire(new o.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const u=t instanceof HTMLImageElement||o.b(t)?O.getImageData(t):t,{width:d,height:y,data:x}=u;if(d===void 0||y===void 0)return this.fire(new o.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(d!==r.data.width||y!==r.data.height)return this.fire(new o.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const S=!(t instanceof HTMLImageElement||o.b(t));return r.data.replace(x,S),this.style.updateImage(g,r),this}getImage(g){return this.style.getImage(g)}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new o.j(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g){return pe.getImage(this._requestManager.transformRequest(g,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(g,t){return this._lazyInitEmptyStyle(),this.style.addLayer(g,t),this._update(!0)}moveLayer(g,t){return this.style.moveLayer(g,t),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(g,t,r){return this.style.setLayerZoomRange(g,t,r),this._update(!0)}setFilter(g,t,r={}){return this.style.setFilter(g,t,r),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,t,r,u={}){return this.style.setPaintProperty(g,t,r,u),this._update(!0)}getPaintProperty(g,t){return this.style.getPaintProperty(g,t)}setLayoutProperty(g,t,r,u={}){return this.style.setLayoutProperty(g,t,r,u),this._update(!0)}getLayoutProperty(g,t){return this.style.getLayoutProperty(g,t)}setGlyphs(g,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(g,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(g,t,r={}){return this._lazyInitEmptyStyle(),this.style.addSprite(g,t,r,u=>{u||this._update(!0)}),this}removeSprite(g){return this._lazyInitEmptyStyle(),this.style.removeSprite(g),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(g,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(g,t,r=>{r||this._update(!0)}),this}setLight(g,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(g,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(g,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(g,t){return this.style.setFeatureState(g,t),this._update()}removeFeatureState(g,t){return this.style.removeFeatureState(g,t),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let g=0,t=0;return this._container&&(g=this._container.clientWidth||400,t=this._container.clientHeight||300),[g,t]}_setupContainer(){const g=this._container;g.classList.add("maplibregl-map");const t=this._canvasContainer=z.create("div","maplibregl-canvas-container",g);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=z.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const r=this._containerDimensions(),u=this._getClampedPixelRatio(r[0],r[1]);this._resizeCanvas(r[0],r[1],u);const d=this._controlContainer=z.create("div","maplibregl-control-container",g),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{y[x]=z.create("div",`maplibregl-ctrl-${x} `,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,t,r){this._canvas.width=Math.floor(r*g),this._canvas.height=Math.floor(r*t),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const g=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",u=>{t={requestedAttributes:g},u&&(t.statusMessage=u.statusMessage,t.type=u.type)},{once:!0});let r=null;if(r=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,g):this._canvas.getContext("webgl2",g)||this._canvas.getContext("webgl",g),!r){const u="Failed to initialize WebGL";throw t?(t.message=u,new Error(JSON.stringify(t))):new Error(u)}this.painter=new vf(r,this.transform),F.testSupport(r)}migrateProjection(g,t){super.migrateProjection(g,t),this.painter.transform=g,this.fire(new o.k("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_render(g){var t,r,u,d,y;const x=this._idleTriggered?this._fadeDuration:0,S=((t=this.style.projection)===null||t===void 0?void 0:t.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),this._removed)return;let P=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const V=this.transform.zoom,j=O.now();this.style.zoomHistory.update(V,j);const X=new o.z(V,{now:j,fadeDuration:x,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Y=X.crossFadingFactor();Y===1&&Y===this._crossFadingFactor||(P=!0,this._crossFadingFactor=Y),this.style.update(X)}const E=((r=this.style.projection)===null||r===void 0?void 0:r.transitionState)>0!==S;(u=this.style.projection)===null||u===void 0||u.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((d=this.style.projection)===null||d===void 0?void 0:d.transitionState,(y=this.style.projection)===null||y===void 0?void 0:y.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||E)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,x,this._crossSourceCollisions,E),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:x,showPadding:this.showPadding}),this.fire(new o.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.cd.mark(o.ce.load),this.fire(new o.k("load"))),this.style&&(this.style.hasTransitions()||P)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const B=this._sourcesDirty||this._styleDirty||this._placementDirty;return B||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.k("idle")),!this._loaded||this._fullyLoaded||B||(this._fullyLoaded=!0,o.cd.mark(o.ce.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var g;this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),pe.removeThrottleControl(this._imageQueueHandle),(g=this._resizeObserver)===null||g===void 0||g.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t!=null&&t.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),z.remove(this._canvasContainer),z.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),o.cd.clearMetrics(),this._removed=!0,this.fire(new o.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,O.frame(this._frameRequest,g=>{o.cd.frame(g),this._frameRequest=null;try{this._render(g)}catch(t){if(!o.cf(t)&&!function(r){return r.message===vc}(t))throw t}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get version(){return Sl}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(g){return this._lazyInitEmptyStyle(),this.style.setProjection(g),this._update(!0)}},m.MapMouseEvent=Ri,m.MapTouchEvent=Po,m.MapWheelEvent=ha,m.Marker=Pl,m.NavigationControl=class{constructor(g){this._updateZoomButtons=()=>{const t=this._map.getZoom(),r=t===this._map.getMaxZoom(),u=t===this._map.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(t,r)=>{const u=this._map._getUIString(`NavigationControl.${r}`);t.title=u,t.setAttribute("aria-label",u)},this.options=o.e({},ph,g),this._container=z.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),z.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),z.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=z.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new mh(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){z.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(g,t){const r=z.create("button",g,this._container);return r.type="button",r.addEventListener("click",t),r}},m.Popup=class extends o.E{constructor(g){super(),this.remove=()=>(this._content&&z.remove(this._content),this._container&&(z.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.k("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{var r;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=z.create("div","maplibregl-popup",this._map.getContainer()),this._tip=z.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const S of this.options.className.split(" "))this._container.classList.add(S);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Eo(this._lngLat,this._flatPos,this._map.transform):(r=this._lngLat)===null||r===void 0?void 0:r.wrap(),this._trackPointer&&!t)return;const u=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationToScreenPoint(this._lngLat));let d=this.options.anchor;const y=kl(this.options.offset);if(!d){const S=this._container.offsetWidth,P=this._container.offsetHeight;let E;E=u.y+y.bottom.y<P?["top"]:u.y>this._map.transform.height-P?["bottom"]:[],u.x<S/2?E.push("left"):u.x>this._map.transform.width-S/2&&E.push("right"),d=E.length===0?"bottom":E.join("-")}let x=u.add(y[d]);this.options.subpixelPositioning||(x=x.round()),z.setTransform(this._container,`${Tl[d]} translate(${x.x}px,${x.y}px)`),Oc(this._container,d,"popup")},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(yh),g)}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(g){return this._lngLat=o.N.convert(g),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const t=document.createDocumentFragment(),r=document.createElement("body");let u;for(r.innerHTML=g;u=r.firstChild,u;)t.appendChild(u);return this.setDOMContent(t)}getMaxWidth(){var g;return(g=this._container)===null||g===void 0?void 0:g.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=z.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(g),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(g){return this._container&&this._container.classList.add(g),this}removeClassName(g){return this._container&&this._container.classList.remove(g),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){if(this._container)return this._container.classList.toggle(g)}setSubpixelPositioning(g){this.options.subpixelPositioning=g}_createCloseButton(){this.options.closeButton&&(this._closeButton=z.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(vh);g&&g.focus()}},m.RasterDEMTileSource=vt,m.RasterTileSource=mt,m.ScaleControl=class{constructor(g){this._onMove=()=>{Vc(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,Vc(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},_h),g)}getDefaultPosition(){return"bottom-left"}onAdd(g){return this._map=g,this._container=z.create("div","maplibregl-ctrl maplibregl-ctrl-scale",g.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){z.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},m.ScrollZoomHandler=Ff,m.Style=Qr,m.TerrainControl=class{constructor(g){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=g}onAdd(g){return this._map=g,this._container=z.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=z.create("button","maplibregl-ctrl-terrain",this._container),z.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){z.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},m.TwoFingersTouchPitchHandler=Rc,m.TwoFingersTouchRotateHandler=Rf,m.TwoFingersTouchZoomHandler=Ec,m.TwoFingersTouchZoomRotateHandler=dh,m.VectorTileSource=xt,m.VideoSource=At,m.addSourceType=(g,t)=>o._(void 0,void 0,void 0,function*(){if(Nt(g))throw new Error(`A source type called "${g}" already exists.`);((r,u)=>{en[r]=u})(g,t)}),m.clearPrewarmedResources=function(){const g=zt;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(ct),zt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},m.createTileMesh=sl,m.getMaxParallelImageRequests=function(){return o.a.MAX_PARALLEL_IMAGE_REQUESTS},m.getRTLTextPluginStatus=function(){return Dn().getRTLTextPluginStatus()},m.getVersion=function(){return bh},m.getWorkerCount=function(){return Dt.workerCount},m.getWorkerUrl=function(){return o.a.WORKER_URL},m.importScriptInWorkers=function(g){return bn().broadcast("IS",g)},m.prewarm=function(){Zt().acquire(ct)},m.setMaxParallelImageRequests=function(g){o.a.MAX_PARALLEL_IMAGE_REQUESTS=g},m.setRTLTextPlugin=function(g,t){return Dn().setRTLTextPlugin(g,t)},m.setWorkerCount=function(g){Dt.workerCount=g},m.setWorkerUrl=function(g){o.a.WORKER_URL=g}});var _=l;return _})})(ZC);var Ap=ZC.exports;const yp=Wz(Ap),Xz={class:"map-page-container"},Kz={class:"subheader"},Yz={class:"map-wrapper"},Jz="https://s.rsg.sc/sc/images/games/GTAV/map/game/{z}/{x}/{y}.jpg",Qz=4,eL=Un({__name:"RacingMapTab",setup(e){const i=Yw(),l=vi(),h=Ye(void 0),p=Ye(void 0),_=Ye(void 0),m=Ye(void 0),o=Ye(!1),T=Ye([]),k=Ye(void 0),M=Ye(void 0),D=Ye([]),O=[-100.43,.74],z=()=>{p.value&&be.value.forEach(ke=>{if(!p.value)return;const Ee=new yp.Marker({element:q(ke)}).setLngLat(_p(ke.Checkpoints[0].coords.x,ke.Checkpoints[0].coords.y)).addTo(p.value);Ee.getElement().addEventListener("click",()=>{oe(ke)}),D.value.push(Ee)})},F=()=>{setTimeout(()=>{D.value.forEach(ke=>ke.remove()),D.value=[],z()},100)},N=()=>{T.value.forEach(ke=>ke.remove()),T.value=[],k.value&&p.value&&(p.value.getLayer(k.value)&&p.value.removeLayer(k.value),p.value.getSource(k.value)&&p.value.removeSource(k.value),k.value=void 0),M.value&&(M.value.remove(),M.value=void 0)},q=ke=>{const Ee=document.createElement("div");Ee.className="marker",Ee.style.color=Se(ke);const xe="http://www.w3.org/2000/svg",Fe=document.createElementNS(xe,"svg");Fe.setAttribute("viewBox","0 0 24 24"),Fe.setAttribute("width","34"),Fe.setAttribute("height","34");const We=document.createElementNS(xe,"path");return We.setAttribute("d","M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"),We.setAttribute("fill","currentColor"),Fe.appendChild(We),Ee.appendChild(Fe),Ee},oe=ke=>{if(N(),_.value=ke,p.value){ke.Checkpoints.forEach((Fe,We)=>{if(!p.value)return;const ht=new yp.Marker({element:_e(We+1,`${ke.RaceId}-${We}`)}).setLngLat(_p(Fe.coords.x,Fe.coords.y)).addTo(p.value);T.value.push(ht)});const Ee=ke.Checkpoints.map(Fe=>_p(Fe.coords.x,Fe.coords.y)),xe=`polyline-${ke.RaceId}`;k.value=xe,p.value.addSource(xe,{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:Ee}}}),p.value.addLayer({id:xe,type:"line",source:xe,layout:{},paint:{"line-color":i.themes.value.dark.colors.primary,"line-width":3}}),M.value=new yp.Popup({closeOnClick:!1}).setLngLat(_p(ke.Checkpoints[0].coords.x,ke.Checkpoints[0].coords.y)).setHTML(`
        <div class="popup-content">
          <h2>${ke.RaceName}</h2>
          <h3>${re("creator")}: ${ke.CreatorName}</h3>
          <div class="popup-actions">
            <button 
              class="popup-button"
              ${ke.Waiting||ke.Started?"disabled":""}
              onclick="setWaypoint('${ke.RaceId}')"
            >
              ${re("set_waypoint")}
            </button>
            <button 
              class="popup-button"
              ${ke.Waiting||ke.Started?"disabled":""}
              onclick="selectTrack('${ke.RaceId}')"
            >
              ${re("setup_race")}
            </button>
          </div>
        </div>
      `).addTo(p.value)}},_e=(ke,Ee)=>{const xe=document.createElement("div");return xe.className="checkpoint-marker",xe.id=Ee,xe.innerText=ke.toString(),xe.onclick=()=>N(),xe},Se=ke=>ke.Started?i.themes.value.dark.colors.error:ke.Waiting?i.themes.value.dark.colors.success:i.themes.value.dark.colors.primary,pe=()=>{m.value=void 0},be=ue(()=>{let ke=l.$state.tracks;return!ke||ke.length===0?[]:(l.$state.showOnlyCurated&&(ke=ke.filter(Ee=>Ee.Curated)),ke.filter(Ee=>{var xe,Fe,We,ht,Ne,tt;return((We=(Fe=(xe=Ee.Checkpoints)==null?void 0:xe[0])==null?void 0:Fe.coords)==null?void 0:We.x)&&((tt=(Ne=(ht=Ee.Checkpoints)==null?void 0:ht[0])==null?void 0:Ne.coords)==null?void 0:tt.y)}))}),de=()=>{if(h.value){let ke=new Ap.LngLat(-168,-57.8),Ee=new Ap.LngLat(0,85.8002),xe=new Ap.LngLatBounds(ke,Ee);p.value=new yp.Map({container:h.value,style:{version:8,sources:{raster:{type:"raster",tiles:[Jz],tileSize:256}},layers:[{id:"raster-layer",type:"raster",source:"raster",minzoom:2,maxzoom:5}]},center:O,zoom:Qz,minZoom:3,maxZoom:5,bounds:xe}),p.value.on("click",Fe=>{if(!p.value)return;p.value.queryRenderedFeatures(Fe.point,{layers:["raster-layer"]}).length>0&&(N(),_.value=void 0),_.value=void 0}),p.value.on("load",()=>{z(),p.value&&p.value.resize()})}},Ce=async()=>{o.value=!0;const ke=await hn.post("UiGetAvailableTracks");ke&&(l.$state.tracks=ke.data),o.value=!1,de()},ye=ke=>{const Ee=be.value.find(xe=>xe.RaceId===ke);m.value=Ee},Me=ke=>{const Ee=be.value.find(xe=>xe.RaceId===ke);hn.post("UiSetWaypoint",JSON.stringify(Ee)),Fa()};return yi(()=>{Ce(),window.setWaypoint=ke=>{Me(ke)},window.selectTrack=ke=>{ye(ke)},de()}),(ke,Ee)=>($e(),Vt("div",Xz,[Ke("div",Kz,[A(ar),A(Ra,{color:"primary",modelValue:H(l).$state.showOnlyCurated,"onUpdate:modelValue":Ee[0]||(Ee[0]=xe=>H(l).$state.showOnlyCurated=xe),"hide-details":"",density:"compact",class:"mr-1",onClick:F},{label:Q(()=>[je(ee(H(l).$state.showOnlyCurated?H(re)("showing_curated"):H(re)("showing_all")),1)]),_:1},8,["modelValue"])]),A($n,{border:"",class:"fill-height"},{default:Q(()=>[A(ti,{class:"fill-height pa-0"},{default:Q(()=>[Ke("div",Yz,[Ke("div",{ref_key:"mapContainer",ref:h,class:"map"},null,512)])]),_:1})]),_:1}),m.value?($e(),gt(UC,{key:0,open:!!m.value,track:m.value,onGoBack:Ee[1]||(Ee[1]=xe=>pe())},null,8,["open","track"])):Ft("",!0)]))}});const uv=Symbol.for("vuetify:v-tabs"),tL=Ct({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...Ts(pC({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),dr=qt()({name:"VTab",props:tL(),setup(e,i){let{slots:l,attrs:h}=i;const{textColorClasses:p,textColorStyles:_}=as(e,"sliderColor"),m=Ye(),o=Ye(),T=ue(()=>e.direction==="horizontal"),k=ue(()=>{var D,O;return((O=(D=m.value)==null?void 0:D.group)==null?void 0:O.isSelected.value)??!1});function M(D){var z,F;let{value:O}=D;if(O){const N=(F=(z=m.value)==null?void 0:z.$el.parentElement)==null?void 0:F.querySelector(".v-tab--selected .v-tab__slider"),q=o.value;if(!N||!q)return;const oe=getComputedStyle(N).color,_e=N.getBoundingClientRect(),Se=q.getBoundingClientRect(),pe=T.value?"x":"y",be=T.value?"X":"Y",de=T.value?"right":"bottom",Ce=T.value?"width":"height",ye=_e[pe],Me=Se[pe],ke=ye>Me?_e[de]-Se[de]:_e[pe]-Se[pe],Ee=Math.sign(ke)>0?T.value?"right":"bottom":Math.sign(ke)<0?T.value?"left":"top":"center",Fe=(Math.abs(ke)+(Math.sign(ke)<0?_e[Ce]:Se[Ce]))/Math.max(_e[Ce],Se[Ce])||0,We=_e[Ce]/Se[Ce]||0,ht=1.5;jl(q,{backgroundColor:[oe,"currentcolor"],transform:[`translate${be}(${ke}px) scale${be}(${We})`,`translate${be}(${ke/ht}px) scale${be}(${(Fe-1)/ht+1})`,"none"],transformOrigin:Array(3).fill(Ee)},{duration:225,easing:md})}}return dn(()=>{const D=Gt.filterProps(e);return A(Gt,sn({symbol:uv,ref:m,class:["v-tab",e.class],style:e.style,tabindex:k.value?0:-1,role:"tab","aria-selected":String(k.value),active:!1},D,h,{block:e.fixed,maxWidth:e.fixed?300:void 0,"onGroup:selected":M}),{...l,default:()=>{var O;return A(cn,null,[((O=l.default)==null?void 0:O.call(l))??e.text,!e.hideSlider&&A("div",{ref:o,class:["v-tab__slider",p.value],style:_.value},null)])}})}),uo({},m)}});const nL=e=>{const{touchstartX:i,touchendX:l,touchstartY:h,touchendY:p}=e,_=.5,m=16;e.offsetX=l-i,e.offsetY=p-h,Math.abs(e.offsetY)<_*Math.abs(e.offsetX)&&(e.left&&l<i-m&&e.left(e),e.right&&l>i+m&&e.right(e)),Math.abs(e.offsetX)<_*Math.abs(e.offsetY)&&(e.up&&p<h-m&&e.up(e),e.down&&p>h+m&&e.down(e))};function iL(e,i){var h;const l=e.changedTouches[0];i.touchstartX=l.clientX,i.touchstartY=l.clientY,(h=i.start)==null||h.call(i,{originalEvent:e,...i})}function rL(e,i){var h;const l=e.changedTouches[0];i.touchendX=l.clientX,i.touchendY=l.clientY,(h=i.end)==null||h.call(i,{originalEvent:e,...i}),nL(i)}function aL(e,i){var h;const l=e.changedTouches[0];i.touchmoveX=l.clientX,i.touchmoveY=l.clientY,(h=i.move)==null||h.call(i,{originalEvent:e,...i})}function sL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const i={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:e.left,right:e.right,up:e.up,down:e.down,start:e.start,move:e.move,end:e.end};return{touchstart:l=>iL(l,i),touchend:l=>rL(l,i),touchmove:l=>aL(l,i)}}function oL(e,i){var o;const l=i.value,h=l!=null&&l.parent?e.parentElement:e,p=(l==null?void 0:l.options)??{passive:!0},_=(o=i.instance)==null?void 0:o.$.uid;if(!h||!_)return;const m=sL(i.value);h._touchHandlers=h._touchHandlers??Object.create(null),h._touchHandlers[_]=m,kw(m).forEach(T=>{h.addEventListener(T,m[T],p)})}function lL(e,i){var _,m;const l=(_=i.value)!=null&&_.parent?e.parentElement:e,h=(m=i.instance)==null?void 0:m.$.uid;if(!(l!=null&&l._touchHandlers)||!h)return;const p=l._touchHandlers[h];kw(p).forEach(o=>{l.removeEventListener(o,p[o])}),delete l._touchHandlers[h]}const WC={mounted:oL,unmounted:lL},cL=WC,XC=Symbol.for("vuetify:v-window"),KC=Symbol.for("vuetify:v-window-group"),YC=Ct({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||e==="hover"},touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},...xn(),...Ti(),...Di()},"VWindow"),Wo=qt()({name:"VWindow",directives:{Touch:WC},props:YC(),emits:{"update:modelValue":e=>!0},setup(e,i){let{slots:l}=i;const{themeClasses:h}=Hi(e),{isRtl:p}=$a(),{t:_}=Dd(),m=Sm(e,KC),o=Ye(),T=ue(()=>p.value?!e.reverse:e.reverse),k=an(!1),M=ue(()=>{const pe=e.direction==="vertical"?"y":"x",de=(T.value?!k.value:k.value)?"-reverse":"";return`v-window-${pe}${de}-transition`}),D=an(0),O=Ye(void 0),z=ue(()=>m.items.value.findIndex(pe=>m.selected.value.includes(pe.id)));Qt(z,(pe,be)=>{const de=m.items.value.length,Ce=de-1;de<=2?k.value=pe<be:pe===Ce&&be===0?k.value=!0:pe===0&&be===Ce?k.value=!1:k.value=pe<be}),Ir(XC,{transition:M,isReversed:k,transitionCount:D,transitionHeight:O,rootRef:o});const F=ue(()=>e.continuous||z.value!==0),N=ue(()=>e.continuous||z.value!==m.items.value.length-1);function q(){F.value&&m.prev()}function oe(){N.value&&m.next()}const _e=ue(()=>{const pe=[],be={icon:p.value?e.nextIcon:e.prevIcon,class:`v-window__${T.value?"right":"left"}`,onClick:m.prev,"aria-label":_("$vuetify.carousel.prev")};pe.push(F.value?l.prev?l.prev({props:be}):A(Gt,be,null):A("div",null,null));const de={icon:p.value?e.prevIcon:e.nextIcon,class:`v-window__${T.value?"left":"right"}`,onClick:m.next,"aria-label":_("$vuetify.carousel.next")};return pe.push(N.value?l.next?l.next({props:de}):A(Gt,de,null):A("div",null,null)),pe}),Se=ue(()=>e.touch===!1?e.touch:{...{left:()=>{T.value?q():oe()},right:()=>{T.value?oe():q()},start:be=>{let{originalEvent:de}=be;de.stopPropagation()}},...e.touch===!0?{}:e.touch});return dn(()=>Tr(A(e.tag,{ref:o,class:["v-window",{"v-window--show-arrows-on-hover":e.showArrows==="hover"},h.value,e.class],style:e.style},{default:()=>{var pe,be;return[A("div",{class:"v-window__container",style:{height:O.value}},[(pe=l.default)==null?void 0:pe.call(l,{group:m}),e.showArrows!==!1&&A("div",{class:"v-window__controls"},[_e.value])]),(be=l.additional)==null?void 0:be.call(l,{group:m})]}}),[[ao("touch"),Se.value]])),{group:m}}}),uL=Ct({...Ts(YC(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),JC=qt()({name:"VTabsWindow",props:uL(),emits:{"update:modelValue":e=>!0},setup(e,i){let{slots:l}=i;const h=ni(uv,null),p=ii(e,"modelValue"),_=ue({get(){var m;return p.value!=null||!h?p.value:(m=h.items.value.find(o=>h.selected.value.includes(o.id)))==null?void 0:m.value},set(m){p.value=m}});return dn(()=>{const m=Wo.filterProps(e);return A(Wo,sn({_as:"VTabsWindow"},m,{modelValue:_.value,"onUpdate:modelValue":o=>_.value=o,class:["v-tabs-window",e.class],style:e.style,mandatory:!1,touch:!1}),l)}),{}}}),QC=Ct({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...xn(),...jy(),...IC()},"VWindowItem"),br=qt()({name:"VWindowItem",directives:{Touch:cL},props:QC(),emits:{"group:selected":e=>!0},setup(e,i){let{slots:l}=i;const h=ni(XC),p=Uy(e,KC),{isBooted:_}=qy();if(!h||!p)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const m=an(!1),o=ue(()=>_.value&&(h.isReversed.value?e.reverseTransition!==!1:e.transition!==!1));function T(){!m.value||!h||(m.value=!1,h.transitionCount.value>0&&(h.transitionCount.value-=1,h.transitionCount.value===0&&(h.transitionHeight.value=void 0)))}function k(){var F;m.value||!h||(m.value=!0,h.transitionCount.value===0&&(h.transitionHeight.value=mn((F=h.rootRef.value)==null?void 0:F.clientHeight)),h.transitionCount.value+=1)}function M(){T()}function D(F){m.value&&Fi(()=>{!o.value||!m.value||!h||(h.transitionHeight.value=mn(F.clientHeight))})}const O=ue(()=>{const F=h.isReversed.value?e.reverseTransition:e.transition;return o.value?{name:typeof F!="string"?h.transition.value:F,onBeforeEnter:k,onAfterEnter:T,onEnterCancelled:M,onBeforeLeave:k,onAfterLeave:T,onLeaveCancelled:M,onEnter:D}:!1}),{hasContent:z}=MC(e,p.isSelected);return dn(()=>A(eo,{transition:O.value,disabled:!_.value},{default:()=>{var F;return[Tr(A("div",{class:["v-window-item",p.selectedClass.value,e.class],style:e.style},[z.value&&((F=l.default)==null?void 0:F.call(l))]),[[Ql,p.isSelected.value]])]}})),{groupItem:p}}}),hL=Ct({...QC()},"VTabsWindowItem"),Rp=qt()({name:"VTabsWindowItem",props:hL(),setup(e,i){let{slots:l}=i;return dn(()=>{const h=br.filterProps(e);return A(br,sn({_as:"VTabsWindowItem"},h,{class:["v-tabs-window-item",e.class],style:e.style}),l)}),{}}});function dL(e){return e?e.map(i=>Iy(i)?i:{text:i,value:i}):[]}const fL=Ct({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...Gy({mandatory:"force",selectedClass:"v-tab-item--selected"}),...Ca(),...Ti()},"VTabs"),wu=qt()({name:"VTabs",props:fL(),emits:{"update:modelValue":e=>!0},setup(e,i){let{attrs:l,slots:h}=i;const p=ii(e,"modelValue"),_=ue(()=>dL(e.items)),{densityClasses:m}=Na(e),{backgroundColorClasses:o,backgroundColorStyles:T}=La(nn(e,"bgColor")),{scopeId:k}=nc();return Qo({VTab:{color:nn(e,"color"),direction:nn(e,"direction"),stacked:nn(e,"stacked"),fixed:nn(e,"fixedTabs"),sliderColor:nn(e,"sliderColor"),hideSlider:nn(e,"hideSlider")}}),dn(()=>{const M=Wp.filterProps(e),D=!!(h.window||e.items.length>0);return A(cn,null,[A(Wp,sn(M,{modelValue:p.value,"onUpdate:modelValue":O=>p.value=O,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--stacked":e.stacked},m.value,o.value,e.class],style:[{"--v-tabs-height":mn(e.height)},T.value,e.style],role:"tablist",symbol:uv},k,l),{default:()=>{var O;return[((O=h.default)==null?void 0:O.call(h))??_.value.map(z=>{var F;return((F=h.tab)==null?void 0:F.call(h,{item:z}))??A(dr,sn(z,{key:z.text,value:z.value}),{default:h[`tab.${z.value}`]?()=>{var N;return(N=h[`tab.${z.value}`])==null?void 0:N.call(h,{item:z})}:void 0})})]}}),D&&A(JC,sn({modelValue:p.value,"onUpdate:modelValue":O=>p.value=O,key:"tabs-window"},k),{default:()=>{var O;return[_.value.map(z=>{var F;return((F=h.item)==null?void 0:F.call(h,{item:z}))??A(Rp,{value:z.value},{default:()=>{var N;return(N=h[`item.${z.value}`])==null?void 0:N.call(h,{item:z})}})}),(O=h.window)==null?void 0:O.call(h)]}})])}),{}}}),pL={id:"RacingPage",class:"pagecontent"},mL={class:"current-race-container"},gL={key:0,id:"current-race-selection"},_L={class:"mb-1",id:"subheader"},yL={class:"subheader mt-2"},vL={key:0,class:"loading-container",id:"available-races-loader"},bL={key:1,class:"available-races"},xL={class:"subheader"},wL={class:"header-text"},SL={key:0,class:"loading-container",id:"available-races-loader"},CL={key:1,class:"page-container available-tracks"},TL=Un({__name:"RacingPage",setup(e){const i=vi(),l=Ye(i.currentPage),h=Ye(!1),p=Ye([]),_=Ye(!1),m=Ye(""),o=Ye(void 0),T=Ye(void 0),k=ue(()=>{let pe=i.tracks;return i.showOnlyCurated&&(pe=pe==null?void 0:pe.filter(be=>!!be.Curated)),pe&&m.value!==""&&(pe=pe.filter(be=>be.RaceName.toLowerCase().includes(m.value.toLowerCase())||be.RaceId.toLowerCase().includes(m.value.toLowerCase())||be.CreatorName.toLocaleLowerCase().includes(m.value.toLowerCase()))),pe.sort((be,de)=>be.RaceName.toLowerCase()>de.RaceName.toLowerCase()?1:-1)}),M=()=>{l.value="setup",o.value=void 0},D=ue(()=>p.value.filter(pe=>!pe.RaceData.Started)),O=async()=>{h.value=!0;const pe=await hn.post("UiGetListedRaces");p.value=pe.data,h.value=!1},z=pe=>{_.value=!0,o.value=pe},F=async()=>{h.value=!0;const pe=await hn.post("UiGetAvailableTracks");i.$state.tracks=pe.data,h.value=!1},N=async()=>{const pe=await hn.post("UiFetchCurrentRace");pe.data.raceId?T.value=pe.data:T.value=void 0},q=async()=>{var pe;(pe=T==null?void 0:T.value)!=null&&pe.raceId&&(await hn.post("UiLeaveCurrentRace",JSON.stringify(T.value.raceId)),T.value=void 0)},oe=async()=>{var pe;(pe=T==null?void 0:T.value)!=null&&pe.raceId&&(await hn.post("UiStartCurrentRace",JSON.stringify(T.value.raceId)),T.value=void 0,Fa())},_e=()=>{l.value==="current"?(O(),N()):l.value==="setup"&&F()},Se=()=>{N(),O()};return yi(()=>{_e(),o.value=void 0}),(pe,be)=>($e(),Vt(cn,null,[Ke("div",pL,[l.value!=="setup2"?($e(),gt(wu,{key:0,color:"primary",modelValue:l.value,"onUpdate:modelValue":[be[0]||(be[0]=de=>l.value=de),be[1]||(be[1]=de=>_e())]},{default:Q(()=>[A(dr,{value:"current"},{default:Q(()=>[je(ee(H(re)("available_races")),1)]),_:1}),H(i).baseData.data.hideMap?Ft("",!0):($e(),gt(dr,{key:0,value:"map"},{default:Q(()=>[je(ee(H(re)("racing_map")),1)]),_:1})),A(dr,{value:"bounties"},{default:Q(()=>[je(ee(H(re)("bounties")),1)]),_:1}),H(i).baseData.data.auth.setup?($e(),gt(dr,{key:1,value:"setup"},{default:Q(()=>[je(ee(H(re)("setup")),1)]),_:1})):Ft("",!0)]),_:1},8,["modelValue"])):Ft("",!0),A(Wo,{modelValue:l.value,"onUpdate:modelValue":be[7]||(be[7]=de=>l.value=de),class:"page-container"},{default:Q(()=>[A(br,{value:"current",class:"tabcontent"},{default:Q(()=>[Ke("div",mL,[T.value?($e(),Vt("div",gL,[Ke("div",_L,[Ke("h3",null,ee(H(re)("active")),1)]),A(KD,{race:T.value,onLeave:be[2]||(be[2]=de=>q()),onStart:be[3]||(be[3]=de=>oe()),onCancel:be[4]||(be[4]=de=>Se())},null,8,["race"])])):Ft("",!0)]),Ke("div",yL,[Ke("h3",null,ee(H(re)("available_races")),1)]),h.value?($e(),Vt("div",vL,be[9]||(be[9]=[Ke("span",{class:"loader"},null,-1)]))):($e(),Vt("div",bL,[($e(!0),Vt(cn,null,sa(D.value,de=>($e(),gt(ZD,{key:de,race:de},null,8,["race"]))),128))])),p.value.length===0?($e(),gt(Cr,{key:2,title:H(re)("no_races")},null,8,["title"])):Ft("",!0)]),_:1}),A(br,{value:"map",class:"tabcontent"},{default:Q(()=>[A(eL)]),_:1}),A(br,{value:"bounties",class:"tabcontent"},{default:Q(()=>[A(Uz)]),_:1}),A(br,{value:"setup",class:"tabcontent"},{default:Q(()=>[Ke("div",xL,[Ke("h3",wL,ee(H(re)("pick_track")),1),A(Ra,{color:"primary",modelValue:H(i).showOnlyCurated,"onUpdate:modelValue":be[5]||(be[5]=de=>H(i).showOnlyCurated=de),"hide-details":"",density:"compact",class:"mr-1"},{label:Q(()=>[je(ee(H(i).showOnlyCurated?H(re)("showing_curated"):H(re)("showing_all")),1)]),_:1},8,["modelValue"]),A(hr,{color:"primary",class:"text-field",hideDetails:"",placeholder:H(re)("search_dot"),density:"compact",modelValue:m.value,"onUpdate:modelValue":be[6]||(be[6]=de=>m.value=de)},null,8,["placeholder","modelValue"])]),h.value?($e(),Vt("div",SL,be[10]||(be[10]=[Ke("span",{class:"loader"},null,-1)]))):($e(),Vt("div",CL,[($e(!0),Vt(cn,null,sa(k.value,de=>($e(),gt(XD,{key:de.RaceId,track:de,onSelect:Ce=>z(Ce)},null,8,["track","onSelect"]))),128))]))]),_:1})]),_:1},8,["modelValue"])]),o.value?($e(),gt(UC,{key:0,open:!!o.value,track:o.value,onGoBack:be[8]||(be[8]=de=>M())},null,8,["open","track"])):Ft("",!0)],64))}});const PL=Mi(TL,[["__scopeId","data-v-a568c45b"]]),kL={class:"results-container page-container"},IL={class:"inline standardGap header"},ML={key:0},EL={key:1},AL={class:"text-left"},RL={class:"text-left"},DL={key:0,class:"text-left"},zL={class:"text-left"},LL={class:"text-left"},BL={key:1,class:"text-left"},FL={key:0},OL={key:1},VL={key:1},NL=Un({__name:"RaceResults",props:{allResults:{}},setup(e){const i=e,l=Ye(void 0),h=ue(()=>l.value?l.value.Result.sort((_,m)=>_.TotalTime<m.TotalTime?-1:1):void 0);return(p,_)=>($e(),Vt("div",kL,[Ke("div",IL,[A(xs,{color:"primary",density:"compact","hide-details":"",items:Object.values(i.allResults),"return-object":"","item-title":"Data.RaceData.RaceName",modelValue:l.value,"onUpdate:modelValue":_[0]||(_[0]=m=>l.value=m),placeholder:H(re)("select_track"),class:"w-50"},null,8,["items","modelValue","placeholder"])]),l.value?($e(),Vt("div",EL,[l.value.Result.length>0?($e(),gt(Nd,{key:0},{default:Q(()=>[Ke("thead",null,[Ke("tr",null,[_[1]||(_[1]=Ke("th",{class:"text-left"},null,-1)),Ke("th",AL,ee(H(re)("rank")),1),Ke("th",RL,ee(H(re)("time")),1),l.value.Data.Laps>0?($e(),Vt("th",DL,ee(H(re)("best_lap")),1)):Ft("",!0),Ke("th",zL,ee(H(re)("vehicle")),1),Ke("th",LL,ee(H(re)("class")),1),l.value.Data.RaceData.Ranked?($e(),Vt("th",BL,ee(H(re)("rank_change")),1)):Ft("",!0)])]),Ke("tbody",null,[($e(!0),Vt(cn,null,sa(h.value,(m,o)=>($e(),Vt("tr",{key:m.RacerName},[Ke("td",null,ee(o+1)+". "+ee(m.RacerName)+" "+ee(m.RacingCrew?"["+m.RacingCrew+"]":""),1),Ke("td",null,ee(m.Ranking),1),Ke("td",null,ee(H(to)(m.TotalTime)),1),l.value.Data.Laps>0?($e(),Vt("td",FL,ee(H(to)(m.BestLap)),1)):Ft("",!0),Ke("td",null,ee(m.VehicleModel),1),Ke("td",null,ee(m.CarClass),1),l.value.Data.RaceData.Ranked?($e(),Vt("td",OL,ee(m.TotalChange),1)):Ft("",!0)]))),128))])]),_:1})):($e(),Vt("div",VL,[A(Cr,{title:H(re)("no_data")},null,8,["title"])]))])):($e(),Vt("div",ML,[A(Cr,{title:H(re)("select_track_to_view")},null,8,["title"])]))]))}});const $L=Mi(NL,[["__scopeId","data-v-a2025a16"]]),jL={class:"results-container page-container"},UL={class:"inline standardGap header"},GL={key:0},HL={key:1,class:"scrollable"},ZL={class:"text-left"},qL={class:"text-left"},WL={class:"text-left"},XL={class:"text-left"},KL={key:1},YL=Un({__name:"RaceRecords",props:{allRecords:{}},setup(e){const i=Ye(void 0),l=Ye(!1),h=ue(()=>{var _;return(_=i.value)==null?void 0:_.Records.filter(m=>m.Reversed===void 0?!l.value:m.Reversed===l.value)}),p=ue(()=>h.value?h.value.sort((m,o)=>m.Time<o.Time?-1:1):void 0);return(_,m)=>($e(),Vt("div",jL,[Ke("div",UL,[A(xs,{color:"primary",density:"compact","hide-details":"",items:Object.values(_.allRecords),"return-object":"","item-title":"RaceName",modelValue:i.value,"onUpdate:modelValue":m[0]||(m[0]=o=>i.value=o),placeholder:H(re)("select_track"),class:"w-50"},null,8,["items","modelValue","placeholder"]),A(Ra,{color:"primary",density:"compact",label:H(re)("reversed"),modelValue:l.value,"onUpdate:modelValue":m[1]||(m[1]=o=>l.value=o),"hide-details":""},null,8,["label","modelValue"])]),m[3]||(m[3]=Ke("div",{class:"loading-container",id:"results-items-loader"},[Ke("span",{class:"loader"})],-1)),i.value?($e(),Vt("div",HL,[p.value&&p.value.length>0?($e(),gt(Nd,{key:0},{default:Q(()=>[Ke("thead",null,[Ke("tr",null,[m[2]||(m[2]=Ke("th",{class:"text-left"},null,-1)),Ke("th",ZL,ee(H(re)("time")),1),Ke("th",qL,ee(H(re)("vehicle")),1),Ke("th",WL,ee(H(re)("class")),1),Ke("th",XL,ee(H(re)("type")),1)])]),Ke("tbody",null,[($e(!0),Vt(cn,null,sa(p.value,(o,T)=>($e(),Vt("tr",{key:`${o.Holder}-${o.Class}`},[Ke("td",null,ee(T+1)+". "+ee(o.Holder),1),Ke("td",null,ee(H(to)(o.Time)),1),Ke("td",null,ee(o.Vehicle),1),Ke("td",null,ee(o.Class),1),Ke("td",null,ee(o.RaceType),1)]))),128))])]),_:1})):($e(),Vt("div",KL,[A(Cr,{title:H(re)("no_data")},null,8,["title"])]))])):($e(),Vt("div",GL,[A(Cr,{title:H(re)("select_track_to_view")},null,8,["title"])]))]))}});const JL=Mi(YL,[["__scopeId","data-v-eb68fd06"]]),QL={class:"results-container page-container"},eB={class:"text-left"},tB={class:"text-left"},nB={class:"text-left"},iB={class:"text-left"},rB={key:1},aB=Un({__name:"CrewTable",setup(e){const i=Ye(void 0),l=async()=>{const h=await hn.post("UiGetAllCrews");if(h.data){let p=h.data;i.value=Object.values(p).sort((_,m)=>_.rank-m.rank)}};return yi(()=>{l()}),(h,p)=>($e(),Vt("div",QL,[i.value&&i.value.length>0?($e(),gt(Nd,{key:0,rounded:"lg",class:"scrollable"},{default:Q(()=>[Ke("thead",null,[Ke("tr",null,[p[0]||(p[0]=Ke("th",{class:"text-left"},null,-1)),Ke("th",eB,ee(H(re)("rank")),1),Ke("th",tB,ee(H(re)("wins")),1),Ke("th",nB,ee(H(re)("races")),1),Ke("th",iB,ee(H(re)("founder")),1)])]),Ke("tbody",null,[($e(!0),Vt(cn,null,sa(i.value,(_,m)=>($e(),Vt("tr",{key:_.crewName},[Ke("td",null,ee(m+1)+". "+ee(_.crewName),1),Ke("td",null,ee(_.rank),1),Ke("td",null,ee(_.wins),1),Ke("td",null,ee(_.races),1),Ke("td",null,ee(_.founderName),1)]))),128))])]),_:1})):($e(),Vt("div",rB,[A(Cr,{title:H(re)("no_data")},null,8,["title"])]))]))}});const sB=Mi(aB,[["__scopeId","data-v-f6cd4cf4"]]),oB={class:"results-container page-container"},lB={class:"text-left"},cB={class:"text-left"},uB={class:"text-left"},hB={key:1},dB=Un({__name:"RacersTable",setup(e){const i=Ye(void 0),l=async()=>{const h=await hn.post("UiGetAllRacers");if(h.data){let p=h.data;p.sort((_,m)=>m.ranking-_.ranking),i.value=p}};return yi(()=>{l()}),(h,p)=>($e(),Vt("div",oB,[i.value&&i.value.length>0?($e(),gt(Nd,{key:0,class:"scrollable"},{default:Q(()=>[Ke("thead",null,[Ke("tr",null,[p[0]||(p[0]=Ke("th",{class:"text-left"},null,-1)),Ke("th",lB,ee(H(re)("rank")),1),Ke("th",cB,ee(H(re)("wins")),1),Ke("th",uB,ee(H(re)("races")),1)])]),Ke("tbody",null,[($e(!0),Vt(cn,null,sa(i.value,(_,m)=>($e(),Vt("tr",{key:_.racername},[Ke("td",null,ee(m+1)+". "+ee(_.racername),1),Ke("td",null,ee(_.ranking),1),Ke("td",null,ee(_.wins),1),Ke("td",null,ee(_.races),1)]))),128))])]),_:1})):($e(),Vt("div",hB,[A(Cr,{title:H(re)("no_data")},null,8,["title"])]))]))}});const fB=Mi(dB,[["__scopeId","data-v-f232719f"]]),pB={id:"ResultsPage",class:"pagecontent"},mB=Un({__name:"ResultsPage",setup(e){const i=Ye(void 0),l=Ye(void 0),h=vi(),p=Ye(h.currentTab),_=async()=>{const o=await hn.post("UiGetRacingResults");o.data&&(i.value=o.data)},m=async()=>{const o=await hn.post("UiGetTracks");o.data&&(l.value=o.data)};return yi(()=>{_(),m()}),(o,T)=>($e(),Vt("div",pB,[A(wu,{color:"primary",modelValue:p.value,"onUpdate:modelValue":T[0]||(T[0]=k=>p.value=k)},{default:Q(()=>[A(dr,{value:"results"},{default:Q(()=>[je(ee(H(re)("race_results")),1)]),_:1}),A(dr,{value:"crewRank"},{default:Q(()=>[je(ee(H(re)("crew_rankings")),1)]),_:1}),A(dr,{value:"racerRank"},{default:Q(()=>[je(ee(H(re)("racer_rankings")),1)]),_:1}),A(dr,{value:"records"},{default:Q(()=>[je(ee(H(re)("track_records")),1)]),_:1})]),_:1},8,["modelValue"]),A(Wo,{modelValue:p.value,"onUpdate:modelValue":T[1]||(T[1]=k=>p.value=k)},{default:Q(()=>[A(br,{value:"results",class:"tabcontent"},{default:Q(()=>[i.value?($e(),gt($L,{key:0,allResults:i.value},null,8,["allResults"])):($e(),gt(Cr,{key:1,title:H(re)("no_data")},null,8,["title"]))]),_:1}),A(br,{value:"crewRank",class:"tabcontent"},{default:Q(()=>[A(sB)]),_:1}),A(br,{value:"racerRank",class:"tabcontent"},{default:Q(()=>[A(fB)]),_:1}),A(br,{value:"records",class:"tabcontent"},{default:Q(()=>[l.value?($e(),gt(JL,{key:0,allRecords:l.value},null,8,["allRecords"])):($e(),gt(Cr,{key:1,title:H(re)("no_data")},null,8,["title"]))]),_:1})]),_:1},8,["modelValue"])]))}});const gB=vm("v-alert-title"),_B=["success","info","warning","error"],yB=Ct({border:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["top","end","bottom","start"].includes(e)},borderColor:String,closable:Boolean,closeIcon:{type:jn,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:e=>_B.includes(e)},...xn(),...Ca(),...Oa(),...lo(),...vu(),...Bd(),...oa(),...Ti(),...Di(),...ks({variant:"flat"})},"VAlert"),du=qt()({name:"VAlert",props:yB(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0},setup(e,i){let{emit:l,slots:h}=i;const p=ii(e,"modelValue"),_=ue(()=>{if(e.icon!==!1)return e.type?e.icon??`$${e.type}`:e.icon}),m=ue(()=>({color:e.color??e.type,variant:e.variant})),{themeClasses:o}=Hi(e),{colorClasses:T,colorStyles:k,variantClasses:M}=tc(m),{densityClasses:D}=Na(e),{dimensionStyles:O}=Va(e),{elevationClasses:z}=co(e),{locationStyles:F}=Ld(e),{positionClasses:N}=Fd(e),{roundedClasses:q}=la(e),{textColorClasses:oe,textColorStyles:_e}=as(nn(e,"borderColor")),{t:Se}=Dd(),pe=ue(()=>({"aria-label":Se(e.closeLabel),onClick(be){p.value=!1,l("click:close",be)}}));return()=>{const be=!!(h.prepend||_.value),de=!!(h.title||e.title),Ce=!!(h.close||e.closable);return p.value&&A(e.tag,{class:["v-alert",e.border&&{"v-alert--border":!!e.border,[`v-alert--border-${e.border===!0?"start":e.border}`]:!0},{"v-alert--prominent":e.prominent},o.value,T.value,D.value,z.value,N.value,q.value,M.value,e.class],style:[k.value,O.value,F.value,e.style],role:"alert"},{default:()=>{var ye,Me;return[ec(!1,"v-alert"),e.border&&A("div",{key:"border",class:["v-alert__border",oe.value],style:_e.value},null),be&&A("div",{key:"prepend",class:"v-alert__prepend"},[h.prepend?A(Bi,{key:"prepend-defaults",disabled:!_.value,defaults:{VIcon:{density:e.density,icon:_.value,size:e.prominent?44:28}}},h.prepend):A(li,{key:"prepend-icon",density:e.density,icon:_.value,size:e.prominent?44:28},null)]),A("div",{class:"v-alert__content"},[de&&A(gB,{key:"title"},{default:()=>{var ke;return[((ke=h.title)==null?void 0:ke.call(h))??e.title]}}),((ye=h.text)==null?void 0:ye.call(h))??e.text,(Me=h.default)==null?void 0:Me.call(h)]),h.append&&A("div",{key:"append",class:"v-alert__append"},[h.append()]),Ce&&A("div",{key:"close",class:"v-alert__close"},[h.close?A(Bi,{key:"close-defaults",defaults:{VBtn:{icon:e.closeIcon,size:"x-small",variant:"text"}}},{default:()=>{var ke;return[(ke=h.close)==null?void 0:ke.call(h,{props:pe.value})]}}):A(Gt,sn({key:"close-btn",icon:e.closeIcon,size:"x-small",variant:"text"},pe.value),null)])]}})}}});const vB=Ct({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...Bm(),...lv()},"VTextarea"),bB=qt()({name:"VTextarea",directives:{Intersect:Oy},inheritAttrs:!1,props:vB(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,i){let{attrs:l,emit:h,slots:p}=i;const _=ii(e,"modelValue"),{isFocused:m,focus:o,blur:T}=Lm(e),k=ue(()=>typeof e.counterValue=="function"?e.counterValue(_.value):(_.value||"").toString().length),M=ue(()=>{if(l.maxlength)return l.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function D(Ee,xe){var Fe,We;!e.autofocus||!Ee||(We=(Fe=xe[0].target)==null?void 0:Fe.focus)==null||We.call(Fe)}const O=Ye(),z=Ye(),F=an(""),N=Ye(),q=ue(()=>e.persistentPlaceholder||m.value||e.active);function oe(){var Ee;N.value!==document.activeElement&&((Ee=N.value)==null||Ee.focus()),m.value||o()}function _e(Ee){oe(),h("click:control",Ee)}function Se(Ee){h("mousedown:control",Ee)}function pe(Ee){Ee.stopPropagation(),oe(),Fi(()=>{_.value="",Rw(e["onClick:clear"],Ee)})}function be(Ee){var Fe;const xe=Ee.target;if(_.value=xe.value,(Fe=e.modelModifiers)!=null&&Fe.trim){const We=[xe.selectionStart,xe.selectionEnd];Fi(()=>{xe.selectionStart=We[0],xe.selectionEnd=We[1]})}}const de=Ye(),Ce=Ye(+e.rows),ye=ue(()=>["plain","underlined"].includes(e.variant));xa(()=>{e.autoGrow||(Ce.value=+e.rows)});function Me(){e.autoGrow&&Fi(()=>{if(!de.value||!z.value)return;const Ee=getComputedStyle(de.value),xe=getComputedStyle(z.value.$el),Fe=parseFloat(Ee.getPropertyValue("--v-field-padding-top"))+parseFloat(Ee.getPropertyValue("--v-input-padding-top"))+parseFloat(Ee.getPropertyValue("--v-field-padding-bottom")),We=de.value.scrollHeight,ht=parseFloat(Ee.lineHeight),Ne=Math.max(parseFloat(e.rows)*ht+Fe,parseFloat(xe.getPropertyValue("--v-input-control-height"))),tt=parseFloat(e.maxRows)*ht+Fe||1/0,Mt=Ss(We??0,Ne,tt);Ce.value=Math.floor((Mt-Fe)/ht),F.value=mn(Mt)})}yi(Me),Qt(_,Me),Qt(()=>e.rows,Me),Qt(()=>e.maxRows,Me),Qt(()=>e.density,Me);let ke;return Qt(de,Ee=>{Ee?(ke=new ResizeObserver(Me),ke.observe(de.value)):ke==null||ke.disconnect()}),kr(()=>{ke==null||ke.disconnect()}),dn(()=>{const Ee=!!(p.counter||e.counter||e.counterValue),xe=!!(Ee||p.details),[Fe,We]=ym(l),{modelValue:ht,...Ne}=gu.filterProps(e),tt=$C(e);return A(gu,sn({ref:O,modelValue:_.value,"onUpdate:modelValue":Mt=>_.value=Mt,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":ye.value},e.class],style:e.style},Fe,Ne,{centerAffix:Ce.value===1&&!ye.value,focused:m.value}),{...p,default:Mt=>{let{id:_t,isDisabled:Qe,isDirty:ct,isReadonly:Dt,isValid:Yt}=Mt;return A(cv,sn({ref:z,style:{"--v-textarea-control-height":F.value},onClick:_e,onMousedown:Se,"onClick:clear":pe,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},tt,{id:_t.value,active:q.value||ct.value,centerAffix:Ce.value===1&&!ye.value,dirty:ct.value||e.dirty,disabled:Qe.value,focused:m.value,error:Yt.value===!1}),{...p,default:zt=>{let{props:{class:Kt,...Zt}}=zt;return A(cn,null,[e.prefix&&A("span",{class:"v-text-field__prefix"},[e.prefix]),Tr(A("textarea",sn({ref:N,class:Kt,value:_.value,onInput:be,autofocus:e.autofocus,readonly:Dt.value,disabled:Qe.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:oe,onBlur:T},Zt,We),null),[[ao("intersect"),{handler:D},null,{once:!0}]]),e.autoGrow&&Tr(A("textarea",{class:[Kt,"v-textarea__sizer"],id:`${Zt.id}-sizer`,"onUpdate:modelValue":_n=>_.value=_n,ref:de,readonly:!0,"aria-hidden":"true"},null),[[Wk,_.value]]),e.suffix&&A("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:xe?Mt=>{var _t;return A(cn,null,[(_t=p.details)==null?void 0:_t.call(p,Mt),Ee&&A(cn,null,[A("span",null,null),A(NC,{active:e.persistentCounter||m.value,value:k.value,max:M.value,disabled:e.disabled},p.counter)])])}:void 0})}),uo({},O,z,N)}}),xB={class:"d-inline-flex ga-1 align-xl-center"},wB=Un({__name:"MyTrackCard",props:{track:{}},emits:["update"],setup(e,{emit:i}){const l=[{value:"any",label:re("any")},{value:"circuit_only",label:re("circuit_only")},{value:"sprint_only",label:re("sprint_only")}],h=vi(),p=e,_=i,m=Ye(!1),o=Ye(!1),T=Ye(!1),k=Ye(!1),M=Ye(!1),D=Ye(!1),O=Ye(!1),z=Ye(void 0),F=Ye(!1),N=ht=>{z.value=ht,O.value=!0},q=()=>{z.value=void 0,O.value=!1},oe=async()=>{F.value=!0,z.value&&await hn.post("UiRemoveRecord",JSON.stringify({trackId:p.track.RaceId,record:z.value}))&&(_("update"),q(),F.value=!1)},_e=Ye({description:void 0,raceType:void 0}),Se=Ye(!1),pe=Ye(void 0),be=()=>{const ht=document.createElement("textarea");ht.value=JSON.stringify(p.track.Checkpoints),document.body.appendChild(ht),ht.select(),document.execCommand("copy"),document.body.removeChild(ht)},de=()=>{hn.post("UiClearLeaderboard",JSON.stringify({RaceName:p.track.RaceName,RaceId:p.track.RaceId})),o.value=!1},Ce=()=>{hn.post("UiEditTrack",JSON.stringify({RaceName:p.track.RaceName,RaceId:p.track.RaceId})),T.value=!1,Fa()},ye=async()=>{const ht=await hn.post("UiGetAccess",JSON.stringify({RaceName:p.track.RaceName,RaceId:p.track.RaceId}));pe.value=ht.data,k.value=!0},Me=async()=>{Object.keys(_e.value).forEach(ht=>{_e.value[ht]=p.track.Metadata[ht]||void 0}),M.value=!0},ke=()=>{hn.post("UiEditAccess",JSON.stringify({RaceName:p.track.RaceName,RaceId:p.track.RaceId,NewAccess:pe.value})),k.value=!1},Ee=async()=>{_e.value.raceType==="any"&&(_e.value.raceType=void 0),await hn.post("UiConfirmSettings",JSON.stringify({RaceId:p.track.RaceId,Metadata:_e.value})),M.value=!1,_("update")},xe=()=>{hn.post("UiDeleteTrack",JSON.stringify({RaceName:p.track.RaceName,RaceId:p.track.RaceId})),Se.value=!1},Fe=async ht=>{(await hn.post("UiSetCurated",JSON.stringify({curated:ht,trackId:p.track.RaceId}))).data&&(p.track.Curated=ht,m.value=!1)},We=async()=>{(await hn.post("UiShowTrack",JSON.stringify(p.track.RaceId))).data&&Fa()};return(ht,Ne)=>($e(),Vt(cn,null,[A($n,{border:"",class:"big-card",rounded:"xl"},{default:Q(()=>[A(Hn,{class:"title"},{default:Q(()=>[Ke("span",xB,ee(ht.track.RaceName),1),Ke("div",null,[A(Gt,{rounded:"xl",variant:"text",onClick:Ne[0]||(Ne[0]=tt=>We())},{default:Q(()=>[je(ee(H(re)("show_track")),1)]),_:1}),A(Gt,{rounded:"xl",small:"",variant:"text",onClick:Ne[1]||(Ne[1]=tt=>be())},{default:Q(()=>[je(ee(H(re)("copy_checkpoints")),1)]),_:1})])]),_:1}),A(ti,{class:"text"},{default:Q(()=>{var tt;return[ht.track.Curated?($e(),gt(ln,{key:0,color:"green","prepend-icon":"mdi-star"},{default:Q(()=>[je(ee(H(re)("curated")),1)]),_:1})):Ft("",!0),A(ln,{color:"primary",class:"allow-select"},{default:Q(()=>[je(ee(H(re)("track_id"))+": "+ee(ht.track.RaceId),1)]),_:1}),A(ln,{color:"primary"},{default:Q(()=>[je(ee(H(re)("length"))+": "+ee(ht.track.Distance)+"m ",1)]),_:1}),A(ln,{color:"primary"},{default:Q(()=>[je(ee(H(re)("checkpoints"))+": "+ee(ht.track.Checkpoints.length),1)]),_:1}),A(ln,{color:"primary"},{default:Q(()=>[je(ee(H(re)("created_by"))+": "+ee(ht.track.CreatorName),1)]),_:1}),(tt=ht.track.Access)!=null&&tt.race&&ht.track.Access.race.length>0?($e(),gt(ln,{key:1,color:"primary"},{default:Q(()=>[je(ee(H(re)("shared_with"))+": "+ee(ht.track.Access.race.length)+" "+ee(H(re)("racers")),1)]),_:1})):Ft("",!0)]}),_:1}),A(Yn,null,{default:Q(()=>[A(ar),H(h).baseData.data.auth.curateTracks?($e(),gt(Gt,{key:0,rounded:"xl",onClick:Ne[2]||(Ne[2]=tt=>m.value=!0)},{default:Q(()=>[je(ee(H(re)("curation")),1)]),_:1})):Ft("",!0),A(Gt,{rounded:"xl",onClick:Ne[3]||(Ne[3]=tt=>D.value=!0)},{default:Q(()=>[je(ee(H(re)("view_records")),1)]),_:1}),A(Gt,{rounded:"xl",onClick:Ne[4]||(Ne[4]=tt=>o.value=!0)},{default:Q(()=>[je(ee(H(re)("clear_lead")),1)]),_:1}),ht.track.Curated?Ft("",!0):($e(),gt(Gt,{key:1,rounded:"xl",onClick:Ne[5]||(Ne[5]=tt=>T.value=!0)},{default:Q(()=>[je(ee(H(re)("edit_track")),1)]),_:1})),A(Gt,{rounded:"xl",onClick:Ne[6]||(Ne[6]=tt=>Me())},{default:Q(()=>[je(ee(H(re)("edit_settings")),1)]),_:1}),A(Gt,{rounded:"xl",onClick:Ne[7]||(Ne[7]=tt=>ye())},{default:Q(()=>[je(ee(H(re)("edit_access")),1)]),_:1}),A(Gt,{rounded:"xl",onClick:Ne[8]||(Ne[8]=tt=>Se.value=!0)},{default:Q(()=>[je(ee(H(re)("delete_track")),1)]),_:1})]),_:1})]),_:1}),A(_a,{attach:".app-container",contained:"",modelValue:m.value,"onUpdate:modelValue":Ne[12]||(Ne[12]=tt=>m.value=tt),width:"auto"},{default:Q(()=>[A($n,{rounded:"lg"},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(H(re)("handle_curation_for"))+" "+ee(ht.track.RaceName)+"?",1)]),_:1}),A(Yn,null,{default:Q(()=>[A(ar),A(Gt,{rounded:"xl",onClick:Ne[9]||(Ne[9]=tt=>o.value=!1)},{default:Q(()=>[je(ee(H(re)("close")),1)]),_:1}),A(Gt,{rounded:"xl",variant:"flat",color:"red",onClick:Ne[10]||(Ne[10]=tt=>Fe(0))},{default:Q(()=>[je(ee(H(re)("set_uncurated")),1)]),_:1}),A(Gt,{rounded:"xl",variant:"flat",color:"success",onClick:Ne[11]||(Ne[11]=tt=>Fe(1))},{default:Q(()=>[je(ee(H(re)("set_curated")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),A(_a,{attach:".app-container",contained:"",modelValue:o.value,"onUpdate:modelValue":Ne[15]||(Ne[15]=tt=>o.value=tt),width:"auto"},{default:Q(()=>[A($n,{rounded:"lg"},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(H(re)("clear_lead_for"))+" "+ee(ht.track.RaceName)+"?",1)]),_:1}),A(ti,null,{default:Q(()=>[je(ee(H(re)("cant_be_reverted")),1)]),_:1}),A(Yn,null,{default:Q(()=>[A(ar),A(Gt,{rounded:"xl",onClick:Ne[13]||(Ne[13]=tt=>o.value=!1)},{default:Q(()=>[je(ee(H(re)("close")),1)]),_:1}),A(Gt,{rounded:"xl",variant:"flat",color:"red",onClick:Ne[14]||(Ne[14]=tt=>de())},{default:Q(()=>[je(ee(H(re)("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),A(_a,{attach:".app-container",contained:"",modelValue:T.value,"onUpdate:modelValue":Ne[18]||(Ne[18]=tt=>T.value=tt),width:"auto"},{default:Q(()=>[A($n,{rounded:"xl"},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(H(re)("open_track_editor_for"))+" "+ee(ht.track.RaceName)+"?",1)]),_:1}),A(Yn,null,{default:Q(()=>[A(ar),A(Gt,{rounded:"xl",onClick:Ne[16]||(Ne[16]=tt=>T.value=!1)},{default:Q(()=>[je(ee(H(re)("close")),1)]),_:1}),A(Gt,{rounded:"xl",variant:"flat",color:"success",onClick:Ne[17]||(Ne[17]=tt=>Ce())},{default:Q(()=>[je(ee(H(re)("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),A(_a,{attach:".app-container",contained:"",modelValue:k.value,"onUpdate:modelValue":Ne[22]||(Ne[22]=tt=>k.value=tt),width:"auto"},{default:Q(()=>[A($n,{rounded:"xl"},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(H(re)("editing_access_for"))+" "+ee(ht.track.RaceName),1)]),_:1}),A(ti,null,{default:Q(()=>[A(hr,{label:H(re)("access_list"),modelValue:pe.value.race,"onUpdate:modelValue":Ne[19]||(Ne[19]=tt=>pe.value.race=tt),hint:H(re)("editing_access_info")},null,8,["label","modelValue","hint"])]),_:1}),A(Yn,null,{default:Q(()=>[A(ar),A(Gt,{rounded:"xl",onClick:Ne[20]||(Ne[20]=tt=>k.value=!1)},{default:Q(()=>[je(ee(H(re)("close")),1)]),_:1}),A(Gt,{rounded:"xl",variant:"flat",color:"success",onClick:Ne[21]||(Ne[21]=tt=>ke())},{default:Q(()=>[je(ee(H(re)("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),A(_a,{attach:".app-container",contained:"",modelValue:M.value,"onUpdate:modelValue":Ne[27]||(Ne[27]=tt=>M.value=tt),width:"auto"},{default:Q(()=>[A($n,{rounded:"lg"},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(H(re)("edit_settings"))+" ",1),A(ln,null,{default:Q(()=>[je(ee(ht.track.RaceName),1)]),_:1})]),_:1}),A(ti,null,{default:Q(()=>[A(bB,{class:"text-area",maxlength:200,counter:200,label:H(re)("description"),hint:H(re)("description_hint"),color:"primary",density:"compact",modelValue:_e.value.description,"onUpdate:modelValue":Ne[23]||(Ne[23]=tt=>_e.value.description=tt)},null,8,["label","hint","modelValue"]),A(xs,{label:H(re)("race_type"),items:l,"item-value":"value","item-title":"label",color:"primary",density:"compact",modelValue:_e.value.raceType,"onUpdate:modelValue":Ne[24]||(Ne[24]=tt=>_e.value.raceType=tt),hideDetails:""},null,8,["label","modelValue"])]),_:1}),A(Yn,null,{default:Q(()=>[A(ar),A(Gt,{rounded:"xl",onClick:Ne[25]||(Ne[25]=tt=>M.value=!1)},{default:Q(()=>[je(ee(H(re)("close")),1)]),_:1}),A(Gt,{rounded:"xl",variant:"flat",color:"success",onClick:Ne[26]||(Ne[26]=tt=>Ee())},{default:Q(()=>[je(ee(H(re)("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),A(_a,{attach:".app-container",contained:"",modelValue:Se.value,"onUpdate:modelValue":Ne[30]||(Ne[30]=tt=>Se.value=tt),width:"auto"},{default:Q(()=>[A($n,{rounded:"lg"},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(H(re)("delete_track"))+" "+ee(ht.track.RaceName)+"?",1)]),_:1}),A(ti,null,{default:Q(()=>[je(ee(H(re)("cant_be_reverted")),1)]),_:1}),A(Yn,null,{default:Q(()=>[A(ar),A(Gt,{rounded:"xl",onClick:Ne[28]||(Ne[28]=tt=>Se.value=!1)},{default:Q(()=>[je(ee(H(re)("close")),1)]),_:1}),A(Gt,{rounded:"xl",variant:"flat",color:"red",onClick:Ne[29]||(Ne[29]=tt=>xe())},{default:Q(()=>[je(ee(H(re)("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),A(_a,{attach:".app-container",contained:"",modelValue:D.value,"onUpdate:modelValue":Ne[33]||(Ne[33]=tt=>D.value=tt),width:"auto"},{default:Q(()=>[A($n,{rounded:"lg"},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(H(re)("view_records"))+" "+ee(ht.track.RaceName)+"?",1)]),_:1}),A(iv,null,{default:Q(()=>[je(ee(H(re)("view_records_modal_desc")),1)]),_:1}),A(ti,null,{default:Q(()=>[A(du,{type:"warning"},{default:Q(()=>[je(ee(H(re)("changes_are_permanent")),1)]),_:1}),A(Wy,null,{default:Q(()=>[($e(!0),Vt(cn,null,sa(ht.track.Records,(tt,Mt)=>($e(),gt(es,{key:Mt,title:tt.Holder+" | "+H(to)(tt.Time),subtitle:tt.Vehicle+" | "+tt.Class},{append:Q(()=>[A(Gt,{variant:"text",color:"red",text:H(re)("remove_record"),onClick:_t=>N(tt)},null,8,["text","onClick"])]),_:2},1032,["title","subtitle"]))),128))]),_:1})]),_:1}),A(Yn,null,{default:Q(()=>[A(ar),A(Gt,{rounded:"xl",onClick:Ne[31]||(Ne[31]=tt=>D.value=!1)},{default:Q(()=>[je(ee(H(re)("close")),1)]),_:1})]),_:1})]),_:1}),A(_a,{attach:".app-container",contained:"",width:"auto",modelValue:O.value,"onUpdate:modelValue":Ne[32]||(Ne[32]=tt=>O.value=tt)},{default:Q(()=>[A($n,{rounded:"lg",title:H(re)("confirm_record_removal")},{default:Q(()=>[z.value?($e(),gt(ti,{key:0},{default:Q(()=>[Ke("p",null,ee(H(re)("racer_name"))+": "+ee(z.value.Holder),1),Ke("p",null,ee(H(re)("best_lap"))+": "+ee(z.value.Time),1),Ke("p",null,ee(H(re)("vehicle"))+": "+ee(z.value.Vehicle),1),Ke("p",null,ee(H(re)("class"))+": "+ee(z.value.Class),1),Ke("p",null,ee(H(re)("race_type"))+": "+ee(z.value.RaceType),1),Ke("p",null,ee(H(re)("reversed"))+": "+ee(z.value.Reversed),1)]),_:1})):Ft("",!0),A(Yn,null,{default:Q(()=>[A(Gt,{variant:"text",text:H(re)("close"),onClick:q},null,8,["text"]),A(Gt,{loading:F.value,variant:"text",color:"red",onClick:oe,text:H(re)("confirm")},null,8,["loading","text"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])],64))}});const Wx=Mi(wB,[["__scopeId","data-v-e11b39fd"]]),SB={id:"MyTracksPage",class:"pagecontent"},CB={class:"subheader inline"},TB={class:"header-text"},PB={key:0,class:"mytracks-items scrollable"},kB={key:2,class:"mytracks-items scrollable"},IB={class:"header-text"},MB=Un({__name:"MyTracksPage",setup(e){const i=vi(),l=Ye(""),h=Ye(i.currentPage),p=Ye(void 0),_=Ye(void 0),m=Ye(void 0),o=Ye(void 0),T=ue(()=>{var F;let z=(F=m==null?void 0:m.value)==null?void 0:F.filter(N=>N.CreatorName===i.baseData.data.currentRacerName);return z&&l.value!==""&&(z=z.filter(N=>N.RaceName.toLowerCase().includes(l.value.toLowerCase())||N.RaceId.toLowerCase().includes(l.value.toLowerCase()))),z}),k=ue(()=>{let z=m.value;return z&&l.value!==""&&(z=z.filter(F=>F.RaceName.toLowerCase().includes(l.value.toLowerCase())||F.RaceId.toLowerCase().includes(l.value.toLowerCase()))),z}),M=async()=>{const z=await hn.post("UiGetMyTracks");z.data&&(m.value=Object.values(z.data))},D=async()=>{(await hn.post("UiCreateTrack",JSON.stringify({name:p.value}))).data&&Fa()},O=async()=>{(await hn.post("UiCreateTrack",JSON.stringify({name:_.value,checkpoints:o.value}))).data&&Fa()};return yi(()=>{M()}),(z,F)=>($e(),Vt("div",SB,[A(wu,{color:"primary",modelValue:h.value,"onUpdate:modelValue":F[0]||(F[0]=N=>h.value=N)},{default:Q(()=>[A(dr,{value:"myTracks"},{default:Q(()=>[je(ee(H(re)("my_tracks")),1)]),_:1}),A(dr,{value:"create"},{default:Q(()=>[je(ee(H(re)("create_track")),1)]),_:1})]),_:1},8,["modelValue"]),A(Wo,{modelValue:h.value,"onUpdate:modelValue":F[7]||(F[7]=N=>h.value=N),class:"page-container"},{default:Q(()=>[A(br,{value:"myTracks",class:"tabcontent mt"},{default:Q(()=>[Ke("div",CB,[Ke("h3",TB,ee(H(re)("my_tracks")),1),A(hr,{class:"text-field",hideDetails:"",placeholder:H(re)("search_dot"),density:"compact",modelValue:l.value,"onUpdate:modelValue":F[1]||(F[1]=N=>l.value=N)},null,8,["placeholder","modelValue"])]),T.value&&T.value.length>0?($e(),Vt("div",PB,[($e(!0),Vt(cn,null,sa(T.value,N=>($e(),gt(Wx,{onUpdate:M,track:N},null,8,["track"]))),256))])):($e(),gt(Cr,{key:1,title:H(re)("no_data")},null,8,["title"])),H(i).baseData.data.auth.controlAll?($e(),Vt("div",kB,[Ke("h3",IB,ee(H(re)("tracks")),1),($e(!0),Vt(cn,null,sa(k.value,N=>($e(),gt(Wx,{onUpdate:M,track:N},null,8,["track"]))),256))])):Ft("",!0)]),_:1}),A(br,{value:"create",class:"tabcontent create mt"},{default:Q(()=>[A($n,{class:"card"},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(H(re)("create_with_editor")),1)]),_:1}),A(ti,null,{default:Q(()=>[A(hr,{density:"compact",placeholder:H(re)("track_name"),modelValue:p.value,"onUpdate:modelValue":F[2]||(F[2]=N=>p.value=N)},null,8,["placeholder","modelValue"])]),_:1}),A(Yn,null,{default:Q(()=>[A(Gt,{block:"",color:"success",variant:"elevated",type:"submit",onClick:F[3]||(F[3]=N=>D())},{default:Q(()=>[je(ee(H(re)("confirm")),1)]),_:1})]),_:1})]),_:1}),A($n,{class:"card"},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(H(re)("create_with_share")),1)]),_:1}),A(ti,null,{default:Q(()=>[A(hr,{density:"compact",placeholder:H(re)("track_name"),modelValue:_.value,"onUpdate:modelValue":F[4]||(F[4]=N=>_.value=N)},null,8,["placeholder","modelValue"]),A(hr,{density:"compact",placeholder:"Paste Checkpoints Here",modelValue:o.value,"onUpdate:modelValue":F[5]||(F[5]=N=>o.value=N)},null,8,["modelValue"])]),_:1}),A(Yn,null,{default:Q(()=>[A(Gt,{block:"",color:"success",variant:"elevated",type:"submit",onClick:F[6]||(F[6]=N=>O())},{default:Q(()=>[je(ee(H(re)("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}});const EB=Mi(MB,[["__scopeId","data-v-eb4190e3"]]),AB=Un({__name:"MyRacerCard",props:{racer:{}},emits:["triggerReload"],setup(e,{emit:i}){const l=e,h=vi(),p=Ye(!1),_=Ye(!1),m=i,o=ue(()=>l.racer.revoked==1),T=()=>{hn.post("UiRevokeRacer",JSON.stringify({racername:l.racer.racername,status:l.racer.revoked})),p.value=!1,setTimeout(()=>{m("triggerReload")},1e3)},k=async()=>{hn.post("UiRemoveRacer",JSON.stringify({racername:l.racer.racername})),_.value=!1,setTimeout(()=>{m("triggerReload")},1e3)};return(M,D)=>($e(),Vt(cn,null,[A($n,{border:"",rounded:"xl",class:"big-card"},{default:Q(()=>[A(Hn,{class:"title"},{default:Q(()=>[je(ee(M.racer.racername),1)]),_:1}),A(ti,{class:"text"},{default:Q(()=>[A(ln,{color:"primary",class:"allow-select"},{default:Q(()=>[je(ee(H(re)("citizen_id"))+" : "+ee(M.racer.citizenid),1)]),_:1}),A(ln,{color:"primary"},{default:Q(()=>[je(ee(H(re)("tracks"))+" : "+ee(M.racer.tracks),1)]),_:1}),A(ln,{color:"primary"},{default:Q(()=>[je(ee(H(re)("races"))+" : "+ee(M.racer.races),1)]),_:1}),A(ln,{color:"primary"},{default:Q(()=>[je(ee(H(re)("wins"))+" : "+ee(M.racer.wins),1)]),_:1}),A(ln,{color:"primary"},{default:Q(()=>[je(ee(H(re)("auth"))+" : "+ee(M.racer.auth),1)]),_:1}),A(ln,{color:"primary"},{default:Q(()=>[je(ee(H(re)("created_by"))+" : "+ee(M.racer.createdby?M.racer.createdby:H(re)("unknown")),1)]),_:1})]),_:1}),A(Yn,null,{default:Q(()=>[A(ar),A(Gt,{rounded:"xl",onClick:D[0]||(D[0]=O=>p.value=!0)},{default:Q(()=>[je(ee(o.value?H(re)("activate"):H(re)("revoke")),1)]),_:1}),H(h).baseData.data.auth.controlAll?($e(),gt(Gt,{key:0,rounded:"xl",onClick:D[1]||(D[1]=O=>_.value=!0)},{default:Q(()=>[je(ee(H(re)("delete_user")),1)]),_:1})):Ft("",!0)]),_:1})]),_:1}),A(_a,{attach:".app-container",contained:"",modelValue:p.value,"onUpdate:modelValue":D[4]||(D[4]=O=>p.value=O),width:"auto"},{default:Q(()=>[A($n,{rounded:"lg"},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(o.value?H(re)("activate"):H(re)("revoke"))+" "+ee(H(re)("access_for"))+" "+ee(M.racer.racername)+"?",1)]),_:1}),A(ti,null,{default:Q(()=>[je(ee(H(re)("can_be_reverted")),1)]),_:1}),A(Yn,null,{default:Q(()=>[A(ar),A(Gt,{rounded:"xl",onClick:D[2]||(D[2]=O=>p.value=!1)},{default:Q(()=>[je(ee(H(re)("close")),1)]),_:1}),A(Gt,{rounded:"xl",variant:"flat",color:"red",onClick:D[3]||(D[3]=O=>T())},{default:Q(()=>[je(ee(H(re)("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),A(_a,{attach:".app-container",contained:"",modelValue:_.value,"onUpdate:modelValue":D[7]||(D[7]=O=>_.value=O),width:"auto"},{default:Q(()=>[A($n,{rounded:"lg"},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(H(re)("delete_user"))+" "+ee(M.racer.racername)+"?",1)]),_:1}),A(ti,null,{default:Q(()=>[je(ee(H(re)("cant_be_reverted")),1)]),_:1}),A(Yn,null,{default:Q(()=>[A(ar),A(Gt,{rounded:"xl",onClick:D[5]||(D[5]=O=>_.value=!1)},{default:Q(()=>[je(ee(H(re)("close")),1)]),_:1}),A(Gt,{rounded:"xl",variant:"flat",color:"red",onClick:D[6]||(D[6]=O=>k())},{default:Q(()=>[je(ee(H(re)("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}});const RB=Mi(AB,[["__scopeId","data-v-8a0caccc"]]),DB={id:"RacersPage",class:"pagecontent"},zB={class:"subheader inline"},LB={key:0,class:"myRacers-items-container scrollable"},BB={key:0,class:"create-options"},FB=Un({__name:"RacersPage",setup(e){const i=vi(),l=Ye(i.currentPage),h=Ye(void 0),p=Ye(void 0),_=Ye(""),m=Ye(void 0),o=ue(()=>h.value&&_.value!==""?h.value.filter(z=>z.racername.toLowerCase().includes(_.value.toLowerCase())||z.citizenid.toLowerCase().includes(_.value.toLowerCase())):h.value),T=Ye({racerName:"",racerId:""}),k=Ye(!1),M=ue(()=>!!(k.value||T.value.racerName===""||!m.value)),D=async()=>{const z=await hn.post("UiGetRacersCreatedByUser");z.data&&(h.value=z.data);const F=await hn.post("UiGetPermissionedUserTypes");F.data&&(p.value=F.data)},O=async()=>{k.value=!0;const z=await hn.post("UiCreateUser",JSON.stringify({racerName:T.value.racerName,racerId:T.value.racerId,selectedAuth:m.value}));setTimeout(()=>{k.value=!1,z.data&&(T.value.racerName=""),T.value.racerId=""},1e3)};return yi(()=>{D()}),(z,F)=>($e(),Vt("div",DB,[A(wu,{color:"primary",modelValue:l.value,"onUpdate:modelValue":F[0]||(F[0]=N=>l.value=N)},{default:Q(()=>{var N,q,oe;return[A(dr,{value:"myRacers"},{default:Q(()=>[je(ee(H(re)("my_racers")),1)]),_:1}),(oe=(q=(N=H(i).baseData)==null?void 0:N.data)==null?void 0:q.auth)!=null&&oe.create?($e(),gt(dr,{key:0,value:"create"},{default:Q(()=>[je(ee(H(re)("create_racer")),1)]),_:1})):Ft("",!0)]}),_:1},8,["modelValue"]),A(Wo,{modelValue:l.value,"onUpdate:modelValue":F[7]||(F[7]=N=>l.value=N),class:"page-container"},{default:Q(()=>[A(br,{value:"myRacers",class:"tabcontent"},{default:Q(()=>[Ke("div",zB,[A(hr,{class:"text-field",hideDetails:"",density:"compact",color:"primary",placeholder:H(re)("search_dot"),modelValue:_.value,"onUpdate:modelValue":F[1]||(F[1]=N=>_.value=N)},null,8,["placeholder","modelValue"])]),h.value&&h.value.length>0?($e(),Vt("div",LB,[($e(!0),Vt(cn,null,sa(o.value,N=>($e(),gt(RB,{key:N.id,onTriggerReload:F[2]||(F[2]=q=>D()),racer:N},null,8,["racer"]))),128))])):Ft("",!0)]),_:1}),A(br,{value:"create",class:"tabcontent"},{default:Q(()=>{var N,q,oe;return[(oe=(q=(N=H(i).baseData)==null?void 0:N.data)==null?void 0:q.auth)!=null&&oe.create?($e(),Vt("div",BB,[A($n,{class:"card"},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(H(re)("create_racer")),1)]),_:1}),A(ti,null,{default:Q(()=>[A(hr,{color:"primary",density:"compact",placeholder:H(re)("racer_name"),modelValue:T.value.racerName,"onUpdate:modelValue":F[3]||(F[3]=_e=>T.value.racerName=_e)},null,8,["placeholder","modelValue"]),A(hr,{color:"primary",density:"compact",placeholder:H(re)("racer_id"),modelValue:T.value.racerId,"onUpdate:modelValue":F[4]||(F[4]=_e=>T.value.racerId=_e)},null,8,["placeholder","modelValue"]),p.value&&p.value.length>0?($e(),gt(xs,{key:0,color:"primary",density:"compact","hide-details":"",items:Object.values(p.value),"return-object":"","item-title":"label",modelValue:m.value,"onUpdate:modelValue":F[5]||(F[5]=_e=>m.value=_e)},null,8,["items","modelValue"])):($e(),gt(Cr,{key:1,title:H(re)("not_auth")},null,8,["title"]))]),_:1}),A(Yn,null,{default:Q(()=>[A(Gt,{block:"",color:"success",variant:"flat",type:"submit",onClick:F[6]||(F[6]=_e=>O()),loading:k.value,disabled:M.value},{default:Q(()=>[je(ee(H(re)("confirm")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})])):($e(),gt(Cr,{key:1,title:H(re)("not_auth")},null,8,["title"]))]}),_:1})]),_:1},8,["modelValue"])]))}});const OB=Mi(FB,[["__scopeId","data-v-ce4be085"]]),Ks=async()=>{const e=vi();e.isLoadingBaseData=!0;const i=await hn.post("GetBaseData");i&&(e.baseData=i),e.isLoadingBaseData=!1},VB={id:"RacingPage",class:"pagecontent"},NB=Un({__name:"SettingsPage",setup(e){const i=vi(),l=Ye({ShowGpsRoute:!1,IgnoreRoadsForGps:!1,UseUglyWaypoint:!1,CheckDistance:!1,UseDrawTextWaypoint:!1}),h=Ye(i.baseData.data.currentRacerName),p=Ye(!1),_=async T=>{await hn.post("UiUpdateSettings",JSON.stringify({setting:T,value:l.value[T]}))},m=async()=>{p.value=!0,await hn.post("UiChangeRacerName",JSON.stringify(h.value)),setTimeout(()=>{Ks(),p.value=!1},1e3)},o=async()=>{const T=await hn.post("UiGetSettings");l.value=T.data};return yi(()=>{o()}),(T,k)=>($e(),Vt("div",VB,[A(Wo,null,{default:Q(()=>[A(br,{value:"current",class:"tabcontent"},{default:Q(()=>[A(zC,null,{default:Q(()=>[A($n,null,{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(H(re)("settings")),1)]),_:1}),A(ti,null,{default:Q(()=>[A(rv,null,{default:Q(()=>[A(Go,null,{default:Q(()=>[A(Dr,{cols:"12",sm:"6"},{default:Q(()=>[A(Ra,{color:"primary",label:H(re)("show_gps"),modelValue:l.value.ShowGpsRoute,"onUpdate:modelValue":k[0]||(k[0]=M=>l.value.ShowGpsRoute=M),onChange:k[1]||(k[1]=M=>_("ShowGpsRoute"))},null,8,["label","modelValue"])]),_:1}),A(Dr,{cols:"12",sm:"6"},{default:Q(()=>[A(Ra,{color:"primary",label:H(re)("ignore_roads"),modelValue:l.value.IgnoreRoadsForGps,"onUpdate:modelValue":k[2]||(k[2]=M=>l.value.IgnoreRoadsForGps=M),onChange:k[3]||(k[3]=M=>_("IgnoreRoadsForGps"))},null,8,["label","modelValue"])]),_:1})]),_:1}),A(Go,null,{default:Q(()=>[A(Dr,{cols:"12",sm:"6"},{default:Q(()=>[A(Ra,{color:"primary",label:H(re)("base_wps"),modelValue:l.value.UseUglyWaypoint,"onUpdate:modelValue":k[4]||(k[4]=M=>l.value.UseUglyWaypoint=M),onChange:k[5]||(k[5]=M=>_("UseUglyWaypoint"))},null,8,["label","modelValue"])]),_:1}),A(Dr,{cols:"12",sm:"6"},{default:Q(()=>[A(Ra,{color:"primary",label:H(re)("distance_check"),modelValue:l.value.CheckDistance,"onUpdate:modelValue":k[6]||(k[6]=M=>l.value.CheckDistance=M),onChange:k[7]||(k[7]=M=>_("CheckDistance"))},null,8,["label","modelValue"]),A(tm,{location:"top",activator:"parent",text:H(re)("distance_info")},null,8,["text"])]),_:1})]),_:1}),A(Go,null,{default:Q(()=>[A(Dr,{cols:"12",sm:"6"},{default:Q(()=>[A(Ra,{color:"primary",label:H(re)("pillar_columns"),modelValue:l.value.UseDrawTextWaypoint,"onUpdate:modelValue":k[8]||(k[8]=M=>l.value.UseDrawTextWaypoint=M),onChange:k[9]||(k[9]=M=>_("UseDrawTextWaypoint"))},null,8,["label","modelValue"]),A(tm,{location:"top",activator:"parent",text:H(re)("distance_info")},null,8,["text"])]),_:1})]),_:1}),A(Go,null,{default:Q(()=>[A(Dr,{cols:"12",sm:"6"},{default:Q(()=>[A(xs,{color:"primary","hide-details":"",items:H(i).baseData.data.racerNames,"item-value":"racername","item-title":"racername",label:H(re)("user"),modelValue:h.value,"onUpdate:modelValue":[k[10]||(k[10]=M=>h.value=M),k[11]||(k[11]=M=>m())],loading:p.value,disabled:H(i).activeHudData.InRace},null,8,["items","label","modelValue","loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]))}});const $B=Mi(NB,[["__scopeId","data-v-54341e69"]]),jB=Un({__name:"MyCrewMemberCard",props:{member:{},memberIsFounder:{type:Boolean},isFounder:{type:Boolean}},emits:["triggerReload"],setup(e,{emit:i}){return(l,h)=>($e(),gt($n,{border:"",rounded:"xl",class:"big-card"},{default:Q(()=>[A(Hn,{class:"title"},{default:Q(()=>[je(ee(l.member.racername)+" "+ee(l.memberIsFounder?"⭐":""),1)]),_:1}),A(ti,{class:"text"},{default:Q(()=>[A(ln,{color:"primary"},{default:Q(()=>[je(ee(H(re)("citizen_id"))+": "+ee(l.member.citizenID),1)]),_:1})]),_:1})]),_:1}))}});const UB=Mi(jB,[["__scopeId","data-v-94275c56"]]),GB={id:"CrewPage",class:"pagecontent"},HB={class:"subheader inline mt-1"},ZB={class:"header-text"},qB={key:1,class:"myRacers-items-container"},WB={class:"subheader inline"},XB={class:"header-text"},KB={class:"w-100 invitations"},YB={class:"subheader inline"},JB={class:"header-text"},QB={class:"myRacers-items-container"},eF={class:"invitations"},tF=Un({__name:"CrewPage",setup(e){const i=vi(),l=Ye(i.currentTab),h=Ye(i.myCrew),p=Ye(void 0),_=Ye(!1),m=ue(()=>{var oe;return((oe=h==null?void 0:h.value)==null?void 0:oe.founderName)===i.baseData.data.currentRacerName}),o=Ye(""),T=Ye(""),k=async()=>{const oe=await hn.post("UiGetCrewData");oe.data&&(i.myCrew=oe.data.crew,h.value=oe.data.crew,p.value=oe.data.invites)},M=async()=>{_.value=!0,await hn.post("UiCreateCrew",JSON.stringify({crewName:o.value})),setTimeout(()=>{Ks(),k(),_.value=!1},1e3)},D=async()=>{_.value=!0,hn.post("UiLeaveCrew",JSON.stringify({crewName:i.baseData.data.currentCrewName})),setTimeout(()=>{Ks(),k(),_.value=!1},1e3)},O=async()=>{_.value=!0,hn.post("UiDisbandCrew",JSON.stringify({crewName:i.baseData.data.currentCrewName})),setTimeout(()=>{Ks(),k(),_.value=!1},1e3)},z=async()=>{_.value=!0,hn.post("UiAcceptInvite",JSON.stringify({crewName:p.value.crewName})),setTimeout(()=>{Ks(),k(),_.value=!1},1e3)},F=async()=>{_.value=!0,hn.post("UiDenyInvite",JSON.stringify({})),setTimeout(()=>{Ks(),k(),_.value=!1},1e3)},N=async()=>{_.value=!0;const oe=await hn.post("UiSendInvite",JSON.stringify({citizenId:T.value}));setTimeout(()=>{Ks(),k(),_.value=!1,oe.data&&(T.value="")},1e3)},q=async()=>{_.value=!0,await hn.post("UiSendInviteClosest",JSON.stringify({})),setTimeout(()=>{Ks(),k(),_.value=!1},1e3)};return yi(()=>{k()}),(oe,_e)=>($e(),Vt("div",GB,[A(wu,{color:"primary",modelValue:l.value,"onUpdate:modelValue":_e[0]||(_e[0]=Se=>l.value=Se)},{default:Q(()=>[A(dr,{value:"myCrew"},{default:Q(()=>[je(ee(H(re)("my_crew")),1)]),_:1}),A(dr,{value:"create"},{default:Q(()=>[je(ee(H(re)("manage")),1)]),_:1}),A(dr,{value:"invites"},{default:Q(()=>[je(ee(H(re)("invites")),1)]),_:1})]),_:1},8,["modelValue"]),A(Wo,{modelValue:l.value,"onUpdate:modelValue":_e[11]||(_e[11]=Se=>l.value=Se),class:"page-container"},{default:Q(()=>[A(br,{value:"myCrew",class:"tabcontent"},{default:Q(()=>{var Se,pe,be;return[h.value?($e(),gt($n,{key:0},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(H(re)("crew_stats")),1)]),_:1}),A(ti,{class:"text"},{default:Q(()=>[A(ln,{color:"primary"},{default:Q(()=>[je(ee(H(re)("rank"))+": "+ee(h.value.rank),1)]),_:1}),A(ln,{color:"primary"},{default:Q(()=>[je(ee(H(re)("races"))+": "+ee(h.value.races),1)]),_:1}),A(ln,{color:"primary"},{default:Q(()=>[je(ee(H(re)("wins"))+": "+ee(h.value.wins),1)]),_:1})]),_:1})]),_:1})):Ft("",!0),Ke("div",HB,[Ke("h3",ZB,ee(H(re)("my_crew"))+" "+ee((Se=h.value)==null?void 0:Se.crewName),1)]),h.value&&((be=(pe=h.value)==null?void 0:pe.members)==null?void 0:be.length)>0?($e(),Vt("div",qB,[($e(!0),Vt(cn,null,sa(h.value.members,de=>($e(),gt(UB,{isFounder:m.value,memberIsFounder:de.racername===h.value.founderName,onTriggerReload:_e[1]||(_e[1]=Ce=>k()),member:de,key:de.citizenID},null,8,["isFounder","memberIsFounder","member"]))),128))])):h.value?($e(),gt(Cr,{key:3,title:H(re)("no_members_in_crew")},null,8,["title"])):($e(),gt(Cr,{key:2,title:H(re)("not_in_crew")},null,8,["title"]))]}),_:1}),A(br,{value:"create",class:"tabcontent"},{default:Q(()=>{var Se,pe,be,de;return[Ke("div",WB,[Ke("h3",XB,ee(H(re)("manage")),1)]),Ke("div",KB,[(de=(be=(pe=(Se=H(i))==null?void 0:Se.baseData)==null?void 0:pe.data)==null?void 0:be.auth)!=null&&de.createCrew&&!m.value?($e(),gt($n,{key:0,class:"card"},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(H(re)("create_crew")),1)]),_:1}),A(ti,null,{default:Q(()=>[A(hr,{density:"compact",placeholder:"Crew Name",modelValue:o.value,"onUpdate:modelValue":_e[2]||(_e[2]=Ce=>o.value=Ce)},null,8,["modelValue"])]),_:1}),A(Yn,null,{default:Q(()=>[A(Gt,{block:"",color:"success",variant:"elevated",type:"submit",onClick:_e[3]||(_e[3]=Ce=>M()),loading:_.value},{default:Q(()=>[je(ee(H(re)("confirm")),1)]),_:1},8,["loading"])]),_:1})]),_:1})):Ft("",!0),H(i).baseData.data.currentCrewName&&!m.value?($e(),gt($n,{key:1,class:"card"},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(H(re)("leave_current_crew"))+" : "+ee(H(i).baseData.data.currentCrewName),1)]),_:1}),A(Yn,null,{default:Q(()=>[A(Gt,{block:"",color:"error",variant:"elevated",type:"submit",onClick:_e[4]||(_e[4]=Ce=>D()),loading:_.value},{default:Q(()=>[je(ee(H(re)("leave")),1)]),_:1},8,["loading"])]),_:1})]),_:1})):Ft("",!0),H(i).baseData.data.currentCrewName&&m.value?($e(),gt($n,{key:2,class:"card"},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(H(re)("disband_crew"))+" : "+ee(H(i).baseData.data.currentCrewName),1)]),_:1}),A(Yn,null,{default:Q(()=>[A(Gt,{block:"",color:"error",variant:"elevated",type:"submit",onClick:_e[5]||(_e[5]=Ce=>O()),loading:_.value},{default:Q(()=>[je(ee(H(re)("confirm")),1)]),_:1},8,["loading"])]),_:1})]),_:1})):Ft("",!0)])]}),_:1}),A(br,{value:"invites",class:"tabcontent"},{default:Q(()=>[Ke("div",YB,[Ke("h3",JB,ee(H(re)("invites")),1)]),Ke("div",QB,[p.value?($e(),gt($n,{key:0},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(H(re)("invite_from_crew"))+": "+ee(p.value.crewName),1)]),_:1}),A(Yn,null,{default:Q(()=>[A(Gt,{variant:"tonal",type:"submit",onClick:_e[6]||(_e[6]=Se=>F()),loading:_.value},{default:Q(()=>[je(ee(H(re)("deny")),1)]),_:1},8,["loading"]),A(Gt,{color:"success",variant:"elevated",type:"submit",onClick:_e[7]||(_e[7]=Se=>z()),loading:_.value},{default:Q(()=>[je(ee(H(re)("accept")),1)]),_:1},8,["loading"])]),_:1})]),_:1})):($e(),gt(Cr,{key:1,title:H(re)("no_invites")},null,8,["title"])),m.value?($e(),gt(PS,{key:2})):Ft("",!0),Ke("div",eF,[m.value?($e(),gt($n,{key:0,class:"card"},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(H(re)("invite")),1)]),_:1}),A(ti,null,{default:Q(()=>[A(hr,{density:"compact",placeholder:"CitizenID",modelValue:T.value,"onUpdate:modelValue":_e[8]||(_e[8]=Se=>T.value=Se)},null,8,["modelValue"])]),_:1}),A(Yn,null,{default:Q(()=>[A(Gt,{block:"",color:"success",variant:"elevated",type:"submit",onClick:_e[9]||(_e[9]=Se=>N()),loading:_.value},{default:Q(()=>[je(ee(H(re)("confirm")),1)]),_:1},8,["loading"])]),_:1})]),_:1})):Ft("",!0),m.value?($e(),gt($n,{key:1,class:"card"},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(H(re)("invite_closest")),1)]),_:1}),A(Yn,null,{default:Q(()=>[A(Gt,{block:"",color:"success",variant:"elevated",type:"submit",onClick:_e[10]||(_e[10]=Se=>q()),loading:_.value},{default:Q(()=>[je(ee(H(re)("confirm")),1)]),_:1},8,["loading"])]),_:1})]),_:1})):Ft("",!0)])])]),_:1})]),_:1},8,["modelValue"])]))}});const nF=Mi(tF,[["__scopeId","data-v-4944306a"]]),iF=Un({__name:"UserCreation",setup(e){const i=vi(),l=Ye({racerName:""}),h=Ye(!1),p=Ye(void 0),_=ue(()=>!!(h.value||l.value.racerName==="")),m=async()=>{h.value=!0;const T=await hn.post("UiCreateUser",JSON.stringify({racerName:l.value.racerName,racerId:void 0,selectedAuth:p.value}));setTimeout(()=>{h.value=!1,T.data&&(l.value.racerName="")},1e3)},o=async()=>{const T=await hn.post("UiGetPermissionedUserTypeFirstUser");T.data&&(p.value=T.data)};return yi(()=>{o()}),(T,k)=>($e(),gt($n,{class:"w-100 mt-3"},{default:Q(()=>[A(Hn,null,{default:Q(()=>[je(ee(H(re)("create_racer")),1)]),_:1}),A(ti,null,{default:Q(()=>[A(hr,{color:"primary",density:"compact",placeholder:H(re)("racer_name"),modelValue:l.value.racerName,"onUpdate:modelValue":k[0]||(k[0]=M=>l.value.racerName=M)},null,8,["placeholder","modelValue"]),H(i).baseData.data.isFirstUser?($e(),gt(du,{key:0,icon:"$info",color:"info"},{default:Q(()=>[je(ee(H(re)("is_first_user")),1)]),_:1})):Ft("",!0)]),_:1}),A(Yn,null,{default:Q(()=>[A(Gt,{block:"",color:"success",variant:"flat",type:"submit",onClick:k[1]||(k[1]=M=>m()),loading:h.value,disabled:_.value},{default:Q(()=>[je(ee(H(re)("confirm")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1}))}}),rF={class:"mt-1"},aF={class:"mt-1"},sF={class:"mt-1"},oF={class:"mt-1"},lF={class:"mt-1"},cF=Un({__name:"CryptoModal",setup(e){const i=vi(),l=i.baseData.data.allowBuyingCrypto?"buy":i.baseData.data.allowSellingCrypto?"sell":"transfer",h=Ye(l),p=Ye(0),_=Ye(0),m=Ye(0),o=Ye(""),T=Ye(void 0),k=Ye(void 0),M=Ye(void 0),D=Ye(!1),O=Ye(!1),z=Ye(!1),F=ue(()=>Math.floor(p.value/i.baseData.data.cryptoConversionRate)),N=ue(()=>Math.floor(_.value/i.baseData.data.cryptoConversionRate)),q=ue(()=>Math.floor(N.value-N.value*i.baseData.data.sellCharge)),oe=ue(()=>!(!(p.value>=1&&F.value>=1)||!Number.isInteger(p.value))),_e=ue(()=>!(_.value>i.baseData.data.currentCrypto||!(_.value>=1&&N.value>=1)||!Number.isInteger(_.value))),Se=ue(()=>!(m.value>i.baseData.data.currentCrypto||!(m.value>=1)||!Number.isInteger(m.value))),pe=ue(()=>o.value.length!==0),be=async()=>{D.value=!0;const ye=await hn.post("UiPurchaseCrypto",JSON.stringify({cryptoAmount:p.value}));ye.data!=="SUCCESS"?T.value=ye.data:T.value=void 0,D.value=!1},de=async()=>{O.value=!0;const ye=await hn.post("UiSellCrypto",JSON.stringify({cryptoAmount:_.value}));ye.data!=="SUCCESS"?k.value=ye.data:k.value=void 0,O.value=!1},Ce=async()=>{z.value=!0;const ye=await hn.post("UiTransferCrypto",JSON.stringify({cryptoAmount:m.value,recipient:o.value}));ye.data!=="SUCCESS"?M.value=ye.data:M.value=void 0,z.value=!1};return(ye,Me)=>($e(),gt(_a,{attach:".app-container",contained:"",width:"auto",modelValue:H(i).showCryptoModal,"onUpdate:modelValue":Me[7]||(Me[7]=ke=>H(i).showCryptoModal=ke)},{default:Q(()=>[A($n,{class:"mx-auto",rounded:"lg",title:H(re)("purchase")+" "+H(i).baseData.data.cryptoType,subtitle:H(re)("current_conversionrate")+": 1"+H(i).baseData.data.cryptoType+" = "+H(re)("currency_text")+1/H(i).baseData.data.cryptoConversionRate},{default:Q(()=>[A(wu,{modelValue:h.value,"onUpdate:modelValue":Me[0]||(Me[0]=ke=>h.value=ke)},{default:Q(()=>[H(i).baseData.data.allowBuyingCrypto?($e(),gt(dr,{key:0,value:"buy"},{default:Q(()=>[je(ee(H(re)("buy")),1)]),_:1})):Ft("",!0),H(i).baseData.data.allowSellingCrypto?($e(),gt(dr,{key:1,value:"sell"},{default:Q(()=>[je(ee(H(re)("sell")),1)]),_:1})):Ft("",!0),H(i).baseData.data.allowTransferCrypto?($e(),gt(dr,{key:2,value:"transfer"},{default:Q(()=>[je(ee(H(re)("transfer")),1)]),_:1})):Ft("",!0)]),_:1},8,["modelValue"]),A(ti,null,{default:Q(()=>[A(JC,{modelValue:h.value,"onUpdate:modelValue":Me[5]||(Me[5]=ke=>h.value=ke)},{default:Q(()=>[A(Rp,{value:"buy"},{default:Q(()=>[A(hr,{modelValue:p.value,"onUpdate:modelValue":Me[1]||(Me[1]=ke=>p.value=ke),modelModifiers:{number:!0},error:!oe.value,hint:H(re)("crypto_hint"),"hide-details":"auto",label:H(re)("crypto_amount"),"persistent-hint":"",type:"number"},null,8,["modelValue","error","hint","label"]),Ke("p",rF,ee(H(re)("total_cost"))+": "+ee(H(re)("currency_text"))+ee(F.value),1),T.value?($e(),gt(du,{key:0,class:"mt-1",type:"error"},{default:Q(()=>[je(ee(H(re)(T.value)),1)]),_:1})):Ft("",!0),Ke("p",aF,[A(Gt,{rounded:"xl",block:"",color:"success",variant:"flat",disabled:!oe.value,loading:D.value,text:H(re)("buy")+" "+p.value+" "+H(i).baseData.data.cryptoType,onClick:be},null,8,["disabled","loading","text"])])]),_:1}),A(Rp,{value:"sell"},{default:Q(()=>[A(hr,{modelValue:_.value,"onUpdate:modelValue":Me[2]||(Me[2]=ke=>_.value=ke),modelModifiers:{number:!0},error:!_e.value,hint:H(re)("crypto_hint"),"hide-details":"auto",label:H(re)("crypto_amount"),"persistent-hint":"",type:"number"},null,8,["modelValue","error","hint","label"]),Ke("p",sF,ee(H(re)("total"))+": "+ee(H(re)("currency_text"))+ee(N.value),1),Ke("p",null,ee(H(re)("fee"))+": "+ee(H(i).baseData.data.sellCharge*100)+"% ",1),Ke("p",null,ee(H(re)("you_get"))+": "+ee(H(re)("currency_text"))+ee(q.value),1),k.value?($e(),gt(du,{key:0,class:"mt-1",type:"error"},{default:Q(()=>[je(ee(H(re)(k.value)),1)]),_:1})):Ft("",!0),Ke("p",oF,[A(Gt,{block:"",rounded:"xl",color:"success",variant:"flat",disabled:!_e.value,loading:O.value,text:H(re)("sell")+" "+_.value+" "+H(i).baseData.data.cryptoType,onClick:de},null,8,["disabled","loading","text"])])]),_:1}),A(Rp,{value:"transfer"},{default:Q(()=>[A(hr,{modelValue:m.value,"onUpdate:modelValue":Me[3]||(Me[3]=ke=>m.value=ke),modelModifiers:{number:!0},error:!Se.value,"hide-details":"auto",label:H(re)("crypto_amount"),type:"number"},null,8,["modelValue","error","label"]),A(hr,{modelValue:o.value,"onUpdate:modelValue":Me[4]||(Me[4]=ke=>o.value=ke),error:!pe.value,hint:H(re)("crypto_hint"),"hide-details":"auto",label:H(re)("recipient_racer_name"),"persistent-hint":""},null,8,["modelValue","error","hint","label"]),M.value?($e(),gt(du,{key:0,class:"mt-1",type:"error"},{default:Q(()=>[je(ee(H(re)(M.value)),1)]),_:1})):Ft("",!0),Ke("p",lF,[A(Gt,{block:"",rounded:"xl",color:"success",variant:"flat",loading:z.value,disabled:!Se.value,text:H(re)("transfer")+" "+m.value+" "+H(i).baseData.data.cryptoType,onClick:Ce},null,8,["loading","disabled","text"])])]),_:1})]),_:1},8,["modelValue"])]),_:1}),A(Yn,null,{default:Q(()=>[A(ar),A(Gt,{variant:"text",text:H(re)("close"),onClick:Me[6]||(Me[6]=ke=>H(i).showCryptoModal=!1)},null,8,["text"])]),_:1})]),_:1},8,["title","subtitle"])]),_:1},8,["modelValue"]))}});const uF=Mi(cF,[["__scopeId","data-v-2fd83ae0"]]);const hF=Ct({...xn(),...Oa(),...LS()},"VLayout"),dF=qt()({name:"VLayout",props:hF(),setup(e,i){let{slots:l}=i;const{layoutClasses:h,layoutStyles:p,getLayoutItem:_,items:m,layoutRef:o}=BS(e),{dimensionStyles:T}=Va(e);return dn(()=>{var k;return A("div",{ref:o,class:[h.value,e.class],style:[T.value,p.value,e.style]},[(k=l.default)==null?void 0:k.call(l)])}),{getLayoutItem:_,items:m}}});function fF(e){const i=an(e());let l=-1;function h(){clearInterval(l)}function p(){h(),Fi(()=>i.value=e())}function _(m){const o=m?getComputedStyle(m):{transitionDuration:.2},T=parseFloat(o.transitionDuration)*1e3||200;if(h(),i.value<=0)return;const k=performance.now();l=window.setInterval(()=>{const M=performance.now()-k+T;i.value=Math.max(e()-M,0),i.value<=0&&h()},T)}return Pr(h),{clear:h,time:i,start:_,reset:p}}const pF=Ct({multiLine:Boolean,text:String,timer:[Boolean,String],timeout:{type:[Number,String],default:5e3},vertical:Boolean,...vu({location:"bottom"}),...Bd(),...oa(),...ks(),...Di(),...Ts(Vd({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},"VSnackbar"),mF=qt()({name:"VSnackbar",props:pF(),emits:{"update:modelValue":e=>!0},setup(e,i){let{slots:l}=i;const h=ii(e,"modelValue"),{positionClasses:p}=Fd(e),{scopeId:_}=nc(),{themeClasses:m}=Hi(e),{colorClasses:o,colorStyles:T,variantClasses:k}=tc(e),{roundedClasses:M}=la(e),D=fF(()=>Number(e.timeout)),O=Ye(),z=Ye(),F=an(!1),N=an(0),q=Ye(),oe=ni(xd,void 0);Ba(()=>!!oe,()=>{const Ee=gA();xa(()=>{q.value=Ee.mainStyles.value})}),Qt(h,Se),Qt(()=>e.timeout,Se),yi(()=>{h.value&&Se()});let _e=-1;function Se(){D.reset(),window.clearTimeout(_e);const Ee=Number(e.timeout);if(!h.value||Ee===-1)return;const xe=My(z.value);D.start(xe),_e=window.setTimeout(()=>{h.value=!1},Ee)}function pe(){D.reset(),window.clearTimeout(_e)}function be(){F.value=!0,pe()}function de(){F.value=!1,Se()}function Ce(Ee){N.value=Ee.touches[0].clientY}function ye(Ee){Math.abs(N.value-Ee.changedTouches[0].clientY)>50&&(h.value=!1)}function Me(){F.value&&de()}const ke=ue(()=>e.location.split(" ").reduce((Ee,xe)=>(Ee[`v-snackbar--${xe}`]=!0,Ee),{}));return dn(()=>{const Ee=qo.filterProps(e),xe=!!(l.default||l.text||e.text);return A(qo,sn({ref:O,class:["v-snackbar",{"v-snackbar--active":h.value,"v-snackbar--multi-line":e.multiLine&&!e.vertical,"v-snackbar--timer":!!e.timer,"v-snackbar--vertical":e.vertical},ke.value,p.value,e.class],style:[q.value,e.style]},Ee,{modelValue:h.value,"onUpdate:modelValue":Fe=>h.value=Fe,contentProps:sn({class:["v-snackbar__wrapper",m.value,o.value,M.value,k.value],style:[T.value],onPointerenter:be,onPointerleave:de},Ee.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0,onTouchstartPassive:Ce,onTouchend:ye,onAfterLeave:Me},_),{default:()=>{var Fe,We;return[ec(!1,"v-snackbar"),e.timer&&!F.value&&A("div",{key:"timer",class:"v-snackbar__timer"},[A(fC,{ref:z,color:typeof e.timer=="string"?e.timer:"info",max:e.timeout,"model-value":D.time.value},null)]),xe&&A("div",{key:"content",class:"v-snackbar__content",role:"status","aria-live":"polite"},[((Fe=l.text)==null?void 0:Fe.call(l))??e.text,(We=l.default)==null?void 0:We.call(l)]),l.actions&&A(Bi,{defaults:{VBtn:{variant:"text",ripple:!1,slim:!0}}},{default:()=>[A("div",{class:"v-snackbar__actions"},[l.actions({isActive:h})])]})]},activator:l.activator})}),uo({},O)}}),gF={class:"ui-container"},_F={key:0,class:"screen-container"},yF={class:"app-container"},vF={key:0,class:"text-subtitle-1 pt-2"},bF={key:0,class:"tabs-container"},xF={key:1,id:"revoked-message-container"},wF={class:"revoked-message-holder"},SF=Un({__name:"RaceAppView",setup(e){const i=vi(),l=Ye(!1),h=Ye(3e3),p=ue(()=>{var m;if(!i.baseData.data.currentRacerName&&i.baseData.data.racerNames&&i.baseData.data.racerNames.length===0)return{title:re("error_lacking_user"),text:re("error_lacking_user_desc"),color:"info",icon:"$info",type:"no_user"};if(i.baseData.data.currentRacerName){const o=(m=i.baseData.data.racerNames)==null?void 0:m.find(T=>i.baseData.data.currentRacerName===T.racername);if(o){if(o.revoked)return{title:re("error_revoked"),text:re("error_revoked_desc"),type:"revoked"}}else return{title:re("error_permanently_removed"),text:re("error_permanently_removed_desc"),type:"removed"}}else return{title:re("error_no_user"),text:re("error_no_user_desc"),color:"info",icon:"$info",type:"no_user"};return!1});document.onkeydown=function(m){(m==null?void 0:m.key)==="Escape"&&Fa()};const _=m=>{const o=m==null?void 0:m.data;o.type==="notify"&&(i.$state.notification=o.data,l.value=!0)};return yi(()=>{Ks(),window.addEventListener("message",_)}),(m,o)=>{var T;return $e(),Vt("div",gF,[H(i).baseData.data?($e(),Vt("div",_F,[A(KM),Ke("div",yF,[A(mF,{modelValue:l.value,"onUpdate:modelValue":o[1]||(o[1]=k=>l.value=k),attach:".app-container",transition:"slide-y-transition",location:"top",contained:"","multi-line":"",vertical:"",timeout:h.value,color:(T=H(i).notification)==null?void 0:T.type},{actions:Q(()=>[A(Gt,{variant:"text",onClick:o[0]||(o[0]=k=>l.value=!1)},{default:Q(()=>[je(ee(H(re)("close")),1)]),_:1})]),default:Q(()=>{var k,M;return[Ke("h3",null,ee((k=H(i).notification)==null?void 0:k.title),1),(M=H(i).notification)!=null&&M.text?($e(),Vt("p",vF,ee(H(i).notification.text),1)):Ft("",!0)]}),_:1},8,["modelValue","timeout","color"]),A(dF,null,{default:Q(()=>[A(SA),H(i).currentPage==="settings"||!p.value?($e(),Vt("div",bF,[H(i).currentPage==="racing"?($e(),gt(PL,{key:0})):Ft("",!0),H(i).currentPage==="results"?($e(),gt(mB,{key:1})):Ft("",!0),H(i).currentPage==="mytracks"?($e(),gt(EB,{key:2})):Ft("",!0),H(i).currentPage==="racers"?($e(),gt(OB,{key:3})):Ft("",!0),H(i).currentPage==="crew"?($e(),gt(nF,{key:4})):Ft("",!0),H(i).currentPage==="settings"?($e(),gt($B,{key:5})):Ft("",!0)])):($e(),Vt("div",xF,[Ke("div",wF,[A(du,{title:p.value.title,text:p.value.text,color:p.value.color?p.value.color:"error",icon:p.value.icon?p.value.icon:"$error"},null,8,["title","text","color","icon"]),H(i).baseData.data.anyoneCanCreate&&H(i).baseData.data.racerNames.length===0?($e(),gt(iF,{key:0})):Ft("",!0)])]))]),_:1}),A(uF)])])):Ft("",!0)])}}});const CF=Mi(SF,[["__scopeId","data-v-b205c58b"]]),TF={class:"editor"},PF={class:"blocks-container"},kF={class:"blocks"},IF={class:"box editor-holder"},MF={class:"editor-text",id:"editor-racename"},EF={class:"editor-text",id:"editor-checkpoints"},AF={class:"editor-text",id:"editor-checkpoints"},RF={class:"box editor-holder buttons"},DF={class:"editor-text",id:"editor-keys-add"},zF={id:"editor-keys-add-button",style:{color:"rgb(0, 201, 0)"}},LF={key:0,class:"editor-text",id:"editor-keys-delete"},BF={style:{color:"rgb(255, 43, 43)"}},FF={class:"editor-text",id:"editor-keys-edit"},OF={id:"editor-keys-edit-button",style:{color:"rgb(0, 201, 0)"}},VF={class:"editor-text",id:"editor-keys-tiredistance"},NF={style:{"margin-right":"0.5em",color:"rgb(255, 43, 43)"}},$F={style:{color:"rgb(0, 201, 0)"}},jF={class:"editor-text",id:"editor-keys-cancel"},UF={id:"editor-keys-cancel-button",style:{color:"rgb(255, 43, 43)"}},GF={class:"editor-text",id:"editor-keys-save"},HF={id:"editor-keys-save-button",style:{color:"rgb(0, 201, 0)"}},ZF=Un({__name:"EditorHud",setup(e){const i=vi();return(l,h)=>($e(),Vt("div",TF,[Ke("div",PF,[Ke("div",kF,[Ke("div",IF,[Ke("span",MF,ee(H(re)("track_name"))+" : "+ee(H(i).creatorData.RaceName),1),Ke("span",EF,ee(H(re)("checkpoints"))+" : "+ee(H(i).creatorData.Checkpoints?H(i).creatorData.Checkpoints.length:0),1),Ke("span",AF,ee(H(re)("closest_checkpoint"))+" : "+ee(H(i).creatorData.ClosestCheckpoint?H(i).creatorData.ClosestCheckpoint:"Unknown"),1)]),Ke("div",RF,[Ke("span",DF,[Ke("span",zF,ee(H(i).buttons.AddCheckpoint),1),je(" : "+ee(H(re)("add_checkpoint")),1)]),H(i).creatorData.ClosestCheckpoint?($e(),Vt("span",LF,[Ke("span",BF,"["+ee(H(i).buttons.DeleteCheckpoint)+"]",1),je(" : "+ee(H(re)("delete_checkpoint"))+" "+ee(H(i).creatorData.ClosestCheckpoint),1)])):Ft("",!0),Ke("span",FF,[Ke("span",OF,"["+ee(H(i).buttons.MoveCheckpoint)+"]",1),je(": "+ee(H(re)("modify_checkpoint")),1)]),Ke("span",VF,[Ke("span",NF,"["+ee(H(i).buttons.DecreaseDistance)+"]",1),Ke("span",$F," ["+ee(H(i).buttons.IncreaseDistance)+"] ",1),je(" "+ee(H(re)("tire_distance"))+" : ["+ee(H(i).creatorData.TireDistance)+"] ",1)]),Ke("span",jF,[Ke("span",UF,"["+ee(H(i).buttons.Exit)+"]",1),je(" : "+ee(H(re)("close_editor")),1)]),Ke("span",GF,[Ke("span",HF,"["+ee(H(i).buttons.SaveRace)+"]",1),je(" :"+ee(H(re)("save_track")),1)])])])])]))}});const qF=Mi(ZF,[["__scopeId","data-v-292afe78"]]),WF={class:"racers-holder"},XF={class:"number"},KF={class:"name"},YF={key:0,class:"difference"},JF={key:1,class:"difference"},QF={key:2,class:"difference"},eO=Un({__name:"RacerList",props:{racers:{}},setup(e){const i=e,l=vi(),h=ue(()=>{var m,o,T,k;return(k=i.racers)==null?void 0:k.slice(0,((T=(o=(m=l.baseData)==null?void 0:m.data)==null?void 0:o.hudSettings)==null?void 0:T.maxPositions)||10)}),p=m=>{if(m===0)return"0.000";const o=m>0,k=(Math.abs(m)/1e3).toFixed(3);return o?`+${k}`:`-${k}`},_=(m,o)=>{const T=m.CheckpointTimes.length,k=o.CheckpointTimes.length;if(T===0||k===0)return"";const M=Math.min(T,k)-1,D=m.CheckpointTimes[M].time,O=o.CheckpointTimes[M].time;return p(O-D)};return(m,o)=>($e(),Vt("div",WF,[($e(!0),Vt(cn,null,sa(h.value,(T,k)=>($e(),Vt("div",{class:om(["box",{me:k===H(l).activeRace.position-1}]),key:T.RacerSource},[Ke("div",XF,ee(k+1),1),Ke("span",KF,ee(T.RacerName),1),k===0&&T.Finished?($e(),Vt("span",YF,ee(H(re)("winner")),1)):T.Finished?($e(),Vt("span",JF,ee(H(re)("finished")),1)):k!==H(l).activeRace.position-1?($e(),Vt("span",QF,ee(_(m.racers[H(l).activeRace.position-1],T)),1)):Ft("",!0)],2))),128))]))}});const tO=Mi(eO,[["__scopeId","data-v-adc35222"]]),nO={class:"race"},iO={class:"boxes"},rO={class:"positions-container"},aO={class:"blocks-container"},sO={class:"blocks"},oO={id:"track-name"},lO={key:0,class:"position-container"},cO={id:"smaller"},uO={id:"position"},hO={class:"column"},dO={id:"smaller"},fO={id:"checkpoint"},pO={class:"row"},mO={id:"race-time"},gO={class:"row"},_O={id:"race-time"},yO={class:"row"},vO={id:"race-time"},bO={class:"row"},xO={id:"race-time"},wO={key:1,id:"race-ghosted-span"},SO=Un({__name:"RaceHud",setup(e){Ik(m=>({b2c08384:h.value,"0261b2d8":p.value}));const i=vi(),l={split:"space-between",left:"start",right:"end"},h=ue(()=>{var m,o,T,k,M,D;return(T=(o=(m=i.baseData)==null?void 0:m.data)==null?void 0:o.hudSettings)!=null&&T.location?l[(D=(M=(k=i.baseData)==null?void 0:k.data)==null?void 0:M.hudSettings)==null?void 0:D.location]:"space-between"}),p=ue(()=>{var m,o,T;return((T=(o=(m=i.baseData)==null?void 0:m.data)==null?void 0:o.hudSettings)==null?void 0:T.location)==="left"?"row-reverse":"row"}),_=ue(()=>i.activeRace.totalLaps===0?"Sprint":i.activeRace.totalLaps===-1?`${i.activeRace.currentLap}/-`:`${i.activeRace.currentLap}/${i.activeRace.totalLaps}`);return(m,o)=>($e(),Vt("div",nO,[Ke("div",iO,[Ke("div",rO,[A(tO,{racers:H(i).activeRace.positions},null,8,["racers"])]),Ke("div",aO,[Ke("div",sO,[Ke("span",oO,ee(H(i).activeRace.raceName),1),H(i).activeRace.totalRacers&&H(i).activeRace.totalRacers!==1?($e(),Vt("div",lO,[Ke("span",cO,ee(H(re)("pos")),1),Ke("span",uO,ee(`${H(i).activeRace.position}/${H(i).activeRace.totalRacers}`),1)])):Ft("",!0),Ke("div",hO,[Ke("span",dO,ee(H(re)("checkpoints")),1),Ke("span",fO,ee(`${H(i).activeRace.currentCheckpoint}/${H(i).activeRace.totalCheckpoints}`),1)]),Ke("div",pO,[Ke("span",mO,ee(_.value),1),A(li,{icon:"mdi-cached"})]),Ke("div",gO,[Ke("span",_O,ee(H(to)(H(i).activeRace.time)),1),A(li,{icon:"mdi-timer-sync-outline"})]),Ke("div",yO,[Ke("span",vO,ee(H(to)(H(i).activeRace.totalTime)),1),A(li,{icon:"mdi-timer-outline"})]),Ke("div",bO,[Ke("span",xO,ee(H(to)(H(i).activeRace.bestLap)),1),A(li,{icon:"mdi-timer-star-outline"})]),H(i).activeRace.ghosted?($e(),Vt("div",wO,[A(li,{icon:"mdi-ghost-outline"})])):Ft("",!0)])])])]))}});const CO=Mi(SO,[["__scopeId","data-v-1fa91d2c"]]),TO={class:"countdown-container"},PO={class:"countdown-holder"},kO={key:0,id:"countdown-text"},IO={key:1,id:"countdown-text"},MO={id:"countdown-number"},EO=Un({__name:"CountdownHud",props:{countdownNumber:{}},setup(e){return(i,l)=>($e(),Vt("div",TO,[Ke("div",PO,[A(Cs,{name:"scale",mode:"out-in"},{default:Q(()=>[i.countdownNumber===0?($e(),Vt("span",kO,ee(H(re)("go")),1)):i.countdownNumber===10?($e(),Vt("span",IO,ee(H(re)("get_ready")),1)):($e(),Vt("div",{key:i.countdownNumber,class:"number-holder"},[Ke("span",MO,ee(i.countdownNumber),1)]))]),_:1})])]))}});const AO=Mi(EO,[["__scopeId","data-v-8df4136b"]]),RO=Un({__name:"HudView",setup(e){const i=vi();return(l,h)=>($e(),gt(rv,{class:"d-flex fill-height"},{default:Q(()=>[H(i).creatorData&&H(i).activeHudData.InCreator?($e(),gt(qF,{key:0})):Ft("",!0),H(i).activeRace&&H(i).activeHudData.InRace?($e(),gt(CO,{key:1})):Ft("",!0),H(i).countdown>-1?($e(),gt(AO,{key:2,countdownNumber:H(i).countdown},null,8,["countdownNumber"])):Ft("",!0)]),_:1}))}});const DO=Ct({...xn(),...LS({fullHeight:!0}),...Di()},"VApp"),zO=qt()({name:"VApp",props:DO(),setup(e,i){let{slots:l}=i;const h=Hi(e),{layoutClasses:p,getLayoutItem:_,items:m,layoutRef:o}=BS(e),{rtlClasses:T}=$a();return dn(()=>{var k;return A("div",{ref:o,class:["v-application",h.themeClasses.value,p.value,T.value,e.class],style:[e.style]},[A("div",{class:"v-application__wrap"},[(k=l.default)==null?void 0:k.call(l)])])}),{getLayoutItem:_,items:m,theme:h}}}),LO=Un({__name:"App",setup(e){const i=Yw(),l=vi(),h=k=>{k&&T(),l.$state.appIsOpen=k},p=k=>{k.action=="update"?(l.$state.hudIsOpen=k,l.$state.activeRace=k.data,l.$state.activeHudData=k.racedata):(l.$state.countdown=k.data.value,k.data.value===0&&setTimeout(()=>{l.$state.countdown=-1},2e3))},_=k=>{k.action=="update"&&(l.$state.buttons=k.buttons,l.$state.creatorData=k.data,l.$state.activeHudData.InCreator=k.active)},m=k=>{switch(k.dataType){case"bounties":l.bounties=k.data;break;case"crypto":l.baseData.data.currentCrypto=k.data;break}},o=k=>{const M=k==null?void 0:k.data;if(M!=null&&M.type)switch(M.type){case"race":p(M);break;case"creator":_(M);break;case"toggleApp":h(M.open);break;case"notify":l.$state.notification=M.data;break;case"updateBaseData":T();break;case"dataUpdate":m(M);break}},T=async()=>{const k=await hn.post("GetBaseData");k&&(l.$state.baseData=k),k.data.primaryColor&&(i.themes.value.dark.colors.primary=k.data.primaryColor)};return yi(()=>{window.addEventListener("message",o)}),kd(()=>{window.removeEventListener("message",o,!1)}),(k,M)=>($e(),gt(zO,{theme:"dark"},{default:Q(()=>[A(Cs,{name:"scale",mode:"out-in"},{default:Q(()=>[H(l).appIsOpen?($e(),gt(CF,{key:0})):Ft("",!0)]),_:1}),A(RO)]),_:1}))}});const BO="modulepreload",FO=function(e,i){return new URL(e,i).href},Xx={},OO=function(i,l,h){if(!l||l.length===0)return i();const p=document.getElementsByTagName("link");return Promise.all(l.map(_=>{if(_=FO(_,h),_ in Xx)return;Xx[_]=!0;const m=_.endsWith(".css"),o=m?'[rel="stylesheet"]':"";if(!!h)for(let M=p.length-1;M>=0;M--){const D=p[M];if(D.href===_&&(!m||D.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${_}"]${o}`))return;const k=document.createElement("link");if(k.rel=m?"stylesheet":BO,m||(k.as="script",k.crossOrigin=""),k.href=_,document.head.appendChild(k),m)return new Promise((M,D)=>{k.addEventListener("load",M),k.addEventListener("error",()=>D(new Error(`Unable to preload CSS for ${_}`)))})})).then(()=>i()).catch(_=>{const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=_,window.dispatchEvent(m),!m.defaultPrevented)throw _})};async function VO(){(await OO(()=>import("./webfontloader-6c485f10.js").then(i=>i.w),[],import.meta.url)).load({google:{families:["Roboto:100,300,400,500,700,900&display=swap"]}})}const NO=HC({theme:{themes:{dark:{colors:{primary:"#e36a00",secondary:"#5CBBF6",surface:"#0e0e0e"}}}}}),$O=xw();function jO(e){VO(),e.use(NO).use($O)}const UO=xw(),hv=Yk(LO);hv.use(UO);jO(hv);hv.mount("#app");export{Wz as g};
