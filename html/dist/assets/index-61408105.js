(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))u(f);new MutationObserver(f=>{for(const g of f)if(g.type==="childList")for(const m of g.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&u(m)}).observe(document,{childList:!0,subtree:!0});function l(f){const g={};return f.integrity&&(g.integrity=f.integrity),f.referrerPolicy&&(g.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?g.credentials="include":f.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function u(f){if(f.ep)return;f.ep=!0;const g=l(f);fetch(f.href,g)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function sy(e){const i=Object.create(null);for(const l of e.split(","))i[l]=1;return l=>l in i}const vi={},cu=[],La=()=>{},BT=()=>!1,im=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),oy=e=>e.startsWith("onUpdate:"),er=Object.assign,ly=(e,i)=>{const l=e.indexOf(i);l>-1&&e.splice(l,1)},FT=Object.prototype.hasOwnProperty,ii=(e,i)=>FT.call(e,i),gn=Array.isArray,uu=e=>rm(e)==="[object Map]",Jx=e=>rm(e)==="[object Set]",wn=e=>typeof e=="function",Oi=e=>typeof e=="string",Xo=e=>typeof e=="symbol",Ci=e=>e!==null&&typeof e=="object",Qx=e=>(Ci(e)||wn(e))&&wn(e.then)&&wn(e.catch),e1=Object.prototype.toString,rm=e=>e1.call(e),OT=e=>rm(e).slice(8,-1),t1=e=>rm(e)==="[object Object]",cy=e=>Oi(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Yd=sy(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),am=e=>{const i=Object.create(null);return l=>i[l]||(i[l]=e(l))},VT=/-(\w)/g,oa=am(e=>e.replace(VT,(i,l)=>l?l.toUpperCase():"")),NT=/\B([A-Z])/g,Jl=am(e=>e.replace(NT,"-$1").toLowerCase()),ao=am(e=>e.charAt(0).toUpperCase()+e.slice(1)),qg=am(e=>e?`on${ao(e)}`:""),Zo=(e,i)=>!Object.is(e,i),vp=(e,...i)=>{for(let l=0;l<e.length;l++)e[l](...i)},n1=(e,i,l,u=!1)=>{Object.defineProperty(e,i,{configurable:!0,enumerable:!1,writable:u,value:l})},S_=e=>{const i=parseFloat(e);return isNaN(i)?e:i},$T=e=>{const i=Oi(e)?Number(e):NaN;return isNaN(i)?e:i};let X0;const sm=()=>X0||(X0=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function uy(e){if(gn(e)){const i={};for(let l=0;l<e.length;l++){const u=e[l],f=Oi(u)?HT(u):uy(u);if(f)for(const g in f)i[g]=f[g]}return i}else if(Oi(e)||Ci(e))return e}const jT=/;(?![^(]*\))/g,UT=/:([^]+)/,GT=/\/\*[^]*?\*\//g;function HT(e){const i={};return e.replace(GT,"").split(jT).forEach(l=>{if(l){const u=l.split(UT);u.length>1&&(i[u[0].trim()]=u[1].trim())}}),i}function om(e){let i="";if(Oi(e))i=e;else if(gn(e))for(let l=0;l<e.length;l++){const u=om(e[l]);u&&(i+=u+" ")}else if(Ci(e))for(const l in e)e[l]&&(i+=l+" ");return i.trim()}const ZT="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",qT=sy(ZT);function i1(e){return!!e||e===""}const r1=e=>!!(e&&e.__v_isRef===!0),ee=e=>Oi(e)?e:e==null?"":gn(e)||Ci(e)&&(e.toString===e1||!wn(e.toString))?r1(e)?ee(e.value):JSON.stringify(e,a1,2):String(e),a1=(e,i)=>r1(i)?a1(e,i.value):uu(i)?{[`Map(${i.size})`]:[...i.entries()].reduce((l,[u,f],g)=>(l[Wg(u,g)+" =>"]=f,l),{})}:Jx(i)?{[`Set(${i.size})`]:[...i.values()].map(l=>Wg(l))}:Xo(i)?Wg(i):Ci(i)&&!gn(i)&&!t1(i)?String(i):i,Wg=(e,i="")=>{var l;return Xo(e)?`Symbol(${(l=e.description)!=null?l:i})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Wr;class s1{constructor(i=!1){this.detached=i,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Wr,!i&&Wr&&(this.index=(Wr.scopes||(Wr.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let i,l;if(this.scopes)for(i=0,l=this.scopes.length;i<l;i++)this.scopes[i].pause();for(i=0,l=this.effects.length;i<l;i++)this.effects[i].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let i,l;if(this.scopes)for(i=0,l=this.scopes.length;i<l;i++)this.scopes[i].resume();for(i=0,l=this.effects.length;i<l;i++)this.effects[i].resume()}}run(i){if(this._active){const l=Wr;try{return Wr=this,i()}finally{Wr=l}}}on(){Wr=this}off(){Wr=this.parent}stop(i){if(this._active){this._active=!1;let l,u;for(l=0,u=this.effects.length;l<u;l++)this.effects[l].stop();for(this.effects.length=0,l=0,u=this.cleanups.length;l<u;l++)this.cleanups[l]();if(this.cleanups.length=0,this.scopes){for(l=0,u=this.scopes.length;l<u;l++)this.scopes[l].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!i){const f=this.parent.scopes.pop();f&&f!==this&&(this.parent.scopes[this.index]=f,f.index=this.index)}this.parent=void 0}}}function Sh(e){return new s1(e)}function o1(){return Wr}function kr(e,i=!1){Wr&&Wr.cleanups.push(e)}let Si;const Xg=new WeakSet;class l1{constructor(i){this.fn=i,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Wr&&Wr.active&&Wr.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Xg.has(this)&&(Xg.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||u1(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,K0(this),d1(this);const i=Si,l=is;Si=this,is=!0;try{return this.fn()}finally{h1(this),Si=i,is=l,this.flags&=-3}}stop(){if(this.flags&1){for(let i=this.deps;i;i=i.nextDep)fy(i);this.deps=this.depsTail=void 0,K0(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Xg.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){C_(this)&&this.run()}get dirty(){return C_(this)}}let c1=0,Jd,Qd;function u1(e,i=!1){if(e.flags|=8,i){e.next=Qd,Qd=e;return}e.next=Jd,Jd=e}function dy(){c1++}function hy(){if(--c1>0)return;if(Qd){let i=Qd;for(Qd=void 0;i;){const l=i.next;i.next=void 0,i.flags&=-9,i=l}}let e;for(;Jd;){let i=Jd;for(Jd=void 0;i;){const l=i.next;if(i.next=void 0,i.flags&=-9,i.flags&1)try{i.trigger()}catch(u){e||(e=u)}i=l}}if(e)throw e}function d1(e){for(let i=e.deps;i;i=i.nextDep)i.version=-1,i.prevActiveLink=i.dep.activeLink,i.dep.activeLink=i}function h1(e){let i,l=e.depsTail,u=l;for(;u;){const f=u.prevDep;u.version===-1?(u===l&&(l=f),fy(u),WT(u)):i=u,u.dep.activeLink=u.prevActiveLink,u.prevActiveLink=void 0,u=f}e.deps=i,e.depsTail=l}function C_(e){for(let i=e.deps;i;i=i.nextDep)if(i.dep.version!==i.version||i.dep.computed&&(f1(i.dep.computed)||i.dep.version!==i.version))return!0;return!!e._dirty}function f1(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===sh))return;e.globalVersion=sh;const i=e.dep;if(e.flags|=2,i.version>0&&!e.isSSR&&e.deps&&!C_(e)){e.flags&=-3;return}const l=Si,u=is;Si=e,is=!0;try{d1(e);const f=e.fn(e._value);(i.version===0||Zo(f,e._value))&&(e._value=f,i.version++)}catch(f){throw i.version++,f}finally{Si=l,is=u,h1(e),e.flags&=-3}}function fy(e,i=!1){const{dep:l,prevSub:u,nextSub:f}=e;if(u&&(u.nextSub=f,e.prevSub=void 0),f&&(f.prevSub=u,e.nextSub=void 0),l.subs===e&&(l.subs=u,!u&&l.computed)){l.computed.flags&=-5;for(let g=l.computed.deps;g;g=g.nextDep)fy(g,!0)}!i&&!--l.sc&&l.map&&l.map.delete(l.key)}function WT(e){const{prevDep:i,nextDep:l}=e;i&&(i.nextDep=l,e.prevDep=void 0),l&&(l.prevDep=i,e.nextDep=void 0)}let is=!0;const p1=[];function Ko(){p1.push(is),is=!1}function Yo(){const e=p1.pop();is=e===void 0?!0:e}function K0(e){const{cleanup:i}=e;if(e.cleanup=void 0,i){const l=Si;Si=void 0;try{i()}finally{Si=l}}}let sh=0;class XT{constructor(i,l){this.sub=i,this.dep=l,this.version=l.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class py{constructor(i){this.computed=i,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(i){if(!Si||!is||Si===this.computed)return;let l=this.activeLink;if(l===void 0||l.sub!==Si)l=this.activeLink=new XT(Si,this),Si.deps?(l.prevDep=Si.depsTail,Si.depsTail.nextDep=l,Si.depsTail=l):Si.deps=Si.depsTail=l,m1(l);else if(l.version===-1&&(l.version=this.version,l.nextDep)){const u=l.nextDep;u.prevDep=l.prevDep,l.prevDep&&(l.prevDep.nextDep=u),l.prevDep=Si.depsTail,l.nextDep=void 0,Si.depsTail.nextDep=l,Si.depsTail=l,Si.deps===l&&(Si.deps=u)}return l}trigger(i){this.version++,sh++,this.notify(i)}notify(i){dy();try{for(let l=this.subs;l;l=l.prevSub)l.sub.notify()&&l.sub.dep.notify()}finally{hy()}}}function m1(e){if(e.dep.sc++,e.sub.flags&4){const i=e.dep.computed;if(i&&!e.dep.subs){i.flags|=20;for(let u=i.deps;u;u=u.nextDep)m1(u)}const l=e.dep.subs;l!==e&&(e.prevSub=l,l&&(l.nextSub=e)),e.dep.subs=e}}const Dp=new WeakMap,Gl=Symbol(""),T_=Symbol(""),oh=Symbol("");function zr(e,i,l){if(is&&Si){let u=Dp.get(e);u||Dp.set(e,u=new Map);let f=u.get(l);f||(u.set(l,f=new py),f.map=u,f.key=l),f.track()}}function Js(e,i,l,u,f,g){const m=Dp.get(e);if(!m){sh++;return}const o=T=>{T&&T.trigger()};if(dy(),i==="clear")m.forEach(o);else{const T=gn(e),k=T&&cy(l);if(T&&l==="length"){const I=Number(u);m.forEach((z,O)=>{(O==="length"||O===oh||!Xo(O)&&O>=I)&&o(z)})}else switch((l!==void 0||m.has(void 0))&&o(m.get(l)),k&&o(m.get(oh)),i){case"add":T?k&&o(m.get("length")):(o(m.get(Gl)),uu(e)&&o(m.get(T_)));break;case"delete":T||(o(m.get(Gl)),uu(e)&&o(m.get(T_)));break;case"set":uu(e)&&o(m.get(Gl));break}}hy()}function KT(e,i){const l=Dp.get(e);return l&&l.get(i)}function eu(e){const i=fn(e);return i===e?i:(zr(i,"iterate",oh),Ba(e)?i:i.map(Lr))}function lm(e){return zr(e=fn(e),"iterate",oh),e}const YT={__proto__:null,[Symbol.iterator](){return Kg(this,Symbol.iterator,Lr)},concat(...e){return eu(this).concat(...e.map(i=>gn(i)?eu(i):i))},entries(){return Kg(this,"entries",e=>(e[1]=Lr(e[1]),e))},every(e,i){return Xs(this,"every",e,i,void 0,arguments)},filter(e,i){return Xs(this,"filter",e,i,l=>l.map(Lr),arguments)},find(e,i){return Xs(this,"find",e,i,Lr,arguments)},findIndex(e,i){return Xs(this,"findIndex",e,i,void 0,arguments)},findLast(e,i){return Xs(this,"findLast",e,i,Lr,arguments)},findLastIndex(e,i){return Xs(this,"findLastIndex",e,i,void 0,arguments)},forEach(e,i){return Xs(this,"forEach",e,i,void 0,arguments)},includes(...e){return Yg(this,"includes",e)},indexOf(...e){return Yg(this,"indexOf",e)},join(e){return eu(this).join(e)},lastIndexOf(...e){return Yg(this,"lastIndexOf",e)},map(e,i){return Xs(this,"map",e,i,void 0,arguments)},pop(){return Gd(this,"pop")},push(...e){return Gd(this,"push",e)},reduce(e,...i){return Y0(this,"reduce",e,i)},reduceRight(e,...i){return Y0(this,"reduceRight",e,i)},shift(){return Gd(this,"shift")},some(e,i){return Xs(this,"some",e,i,void 0,arguments)},splice(...e){return Gd(this,"splice",e)},toReversed(){return eu(this).toReversed()},toSorted(e){return eu(this).toSorted(e)},toSpliced(...e){return eu(this).toSpliced(...e)},unshift(...e){return Gd(this,"unshift",e)},values(){return Kg(this,"values",Lr)}};function Kg(e,i,l){const u=lm(e),f=u[i]();return u!==e&&!Ba(e)&&(f._next=f.next,f.next=()=>{const g=f._next();return g.value&&(g.value=l(g.value)),g}),f}const JT=Array.prototype;function Xs(e,i,l,u,f,g){const m=lm(e),o=m!==e&&!Ba(e),T=m[i];if(T!==JT[i]){const z=T.apply(e,g);return o?Lr(z):z}let k=l;m!==e&&(o?k=function(z,O){return l.call(this,Lr(z),O,e)}:l.length>2&&(k=function(z,O){return l.call(this,z,O,e)}));const I=T.call(m,k,u);return o&&f?f(I):I}function Y0(e,i,l,u){const f=lm(e);let g=l;return f!==e&&(Ba(e)?l.length>3&&(g=function(m,o,T){return l.call(this,m,o,T,e)}):g=function(m,o,T){return l.call(this,m,Lr(o),T,e)}),f[i](g,...u)}function Yg(e,i,l){const u=fn(e);zr(u,"iterate",oh);const f=u[i](...l);return(f===-1||f===!1)&&_y(l[0])?(l[0]=fn(l[0]),u[i](...l)):f}function Gd(e,i,l=[]){Ko(),dy();const u=fn(e)[i].apply(e,l);return hy(),Yo(),u}const QT=sy("__proto__,__v_isRef,__isVue"),g1=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Xo));function eP(e){Xo(e)||(e=String(e));const i=fn(this);return zr(i,"has",e),i.hasOwnProperty(e)}class _1{constructor(i=!1,l=!1){this._isReadonly=i,this._isShallow=l}get(i,l,u){if(l==="__v_skip")return i.__v_skip;const f=this._isReadonly,g=this._isShallow;if(l==="__v_isReactive")return!f;if(l==="__v_isReadonly")return f;if(l==="__v_isShallow")return g;if(l==="__v_raw")return u===(f?g?uP:x1:g?b1:v1).get(i)||Object.getPrototypeOf(i)===Object.getPrototypeOf(u)?i:void 0;const m=gn(i);if(!f){let T;if(m&&(T=YT[l]))return T;if(l==="hasOwnProperty")return eP}const o=Reflect.get(i,l,di(i)?i:u);return(Xo(l)?g1.has(l):QT(l))||(f||zr(i,"get",l),g)?o:di(o)?m&&cy(l)?o:o.value:Ci(o)?f?Ch(o):br(o):o}}class y1 extends _1{constructor(i=!1){super(!1,i)}set(i,l,u,f){let g=i[l];if(!this._isShallow){const T=Wl(g);if(!Ba(u)&&!Wl(u)&&(g=fn(g),u=fn(u)),!gn(i)&&di(g)&&!di(u))return T?!1:(g.value=u,!0)}const m=gn(i)&&cy(l)?Number(l)<i.length:ii(i,l),o=Reflect.set(i,l,u,di(i)?i:f);return i===fn(f)&&(m?Zo(u,g)&&Js(i,"set",l,u):Js(i,"add",l,u)),o}deleteProperty(i,l){const u=ii(i,l);i[l];const f=Reflect.deleteProperty(i,l);return f&&u&&Js(i,"delete",l,void 0),f}has(i,l){const u=Reflect.has(i,l);return(!Xo(l)||!g1.has(l))&&zr(i,"has",l),u}ownKeys(i){return zr(i,"iterate",gn(i)?"length":Gl),Reflect.ownKeys(i)}}class tP extends _1{constructor(i=!1){super(!0,i)}set(i,l){return!0}deleteProperty(i,l){return!0}}const nP=new y1,iP=new tP,rP=new y1(!0);const P_=e=>e,op=e=>Reflect.getPrototypeOf(e);function aP(e,i,l){return function(...u){const f=this.__v_raw,g=fn(f),m=uu(g),o=e==="entries"||e===Symbol.iterator&&m,T=e==="keys"&&m,k=f[e](...u),I=l?P_:i?k_:Lr;return!i&&zr(g,"iterate",T?T_:Gl),{next(){const{value:z,done:O}=k.next();return O?{value:z,done:O}:{value:o?[I(z[0]),I(z[1])]:I(z),done:O}},[Symbol.iterator](){return this}}}}function lp(e){return function(...i){return e==="delete"?!1:e==="clear"?void 0:this}}function sP(e,i){const l={get(f){const g=this.__v_raw,m=fn(g),o=fn(f);e||(Zo(f,o)&&zr(m,"get",f),zr(m,"get",o));const{has:T}=op(m),k=i?P_:e?k_:Lr;if(T.call(m,f))return k(g.get(f));if(T.call(m,o))return k(g.get(o));g!==m&&g.get(f)},get size(){const f=this.__v_raw;return!e&&zr(fn(f),"iterate",Gl),Reflect.get(f,"size",f)},has(f){const g=this.__v_raw,m=fn(g),o=fn(f);return e||(Zo(f,o)&&zr(m,"has",f),zr(m,"has",o)),f===o?g.has(f):g.has(f)||g.has(o)},forEach(f,g){const m=this,o=m.__v_raw,T=fn(o),k=i?P_:e?k_:Lr;return!e&&zr(T,"iterate",Gl),o.forEach((I,z)=>f.call(g,k(I),k(z),m))}};return er(l,e?{add:lp("add"),set:lp("set"),delete:lp("delete"),clear:lp("clear")}:{add(f){!i&&!Ba(f)&&!Wl(f)&&(f=fn(f));const g=fn(this);return op(g).has.call(g,f)||(g.add(f),Js(g,"add",f,f)),this},set(f,g){!i&&!Ba(g)&&!Wl(g)&&(g=fn(g));const m=fn(this),{has:o,get:T}=op(m);let k=o.call(m,f);k||(f=fn(f),k=o.call(m,f));const I=T.call(m,f);return m.set(f,g),k?Zo(g,I)&&Js(m,"set",f,g):Js(m,"add",f,g),this},delete(f){const g=fn(this),{has:m,get:o}=op(g);let T=m.call(g,f);T||(f=fn(f),T=m.call(g,f)),o&&o.call(g,f);const k=g.delete(f);return T&&Js(g,"delete",f,void 0),k},clear(){const f=fn(this),g=f.size!==0,m=f.clear();return g&&Js(f,"clear",void 0,void 0),m}}),["keys","values","entries",Symbol.iterator].forEach(f=>{l[f]=aP(f,e,i)}),l}function my(e,i){const l=sP(e,i);return(u,f,g)=>f==="__v_isReactive"?!e:f==="__v_isReadonly"?e:f==="__v_raw"?u:Reflect.get(ii(l,f)&&f in u?l:u,f,g)}const oP={get:my(!1,!1)},lP={get:my(!1,!0)},cP={get:my(!0,!1)};const v1=new WeakMap,b1=new WeakMap,x1=new WeakMap,uP=new WeakMap;function dP(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function hP(e){return e.__v_skip||!Object.isExtensible(e)?0:dP(OT(e))}function br(e){return Wl(e)?e:gy(e,!1,nP,oP,v1)}function fP(e){return gy(e,!1,rP,lP,b1)}function Ch(e){return gy(e,!0,iP,cP,x1)}function gy(e,i,l,u,f){if(!Ci(e)||e.__v_raw&&!(i&&e.__v_isReactive))return e;const g=f.get(e);if(g)return g;const m=hP(e);if(m===0)return e;const o=new Proxy(e,m===2?u:l);return f.set(e,o),o}function qo(e){return Wl(e)?qo(e.__v_raw):!!(e&&e.__v_isReactive)}function Wl(e){return!!(e&&e.__v_isReadonly)}function Ba(e){return!!(e&&e.__v_isShallow)}function _y(e){return e?!!e.__v_raw:!1}function fn(e){const i=e&&e.__v_raw;return i?fn(i):e}function cm(e){return!ii(e,"__v_skip")&&Object.isExtensible(e)&&n1(e,"__v_skip",!0),e}const Lr=e=>Ci(e)?br(e):e,k_=e=>Ci(e)?Ch(e):e;function di(e){return e?e.__v_isRef===!0:!1}function Ke(e){return w1(e,!1)}function ln(e){return w1(e,!0)}function w1(e,i){return di(e)?e:new pP(e,i)}class pP{constructor(i,l){this.dep=new py,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=l?i:fn(i),this._value=l?i:Lr(i),this.__v_isShallow=l}get value(){return this.dep.track(),this._value}set value(i){const l=this._rawValue,u=this.__v_isShallow||Ba(i)||Wl(i);i=u?i:fn(i),Zo(i,l)&&(this._rawValue=i,this._value=u?i:Lr(i),this.dep.trigger())}}function U(e){return di(e)?e.value:e}const mP={get:(e,i,l)=>i==="__v_raw"?e:U(Reflect.get(e,i,l)),set:(e,i,l,u)=>{const f=e[i];return di(f)&&!di(l)?(f.value=l,!0):Reflect.set(e,i,l,u)}};function S1(e){return qo(e)?e:new Proxy(e,mP)}function um(e){const i=gn(e)?new Array(e.length):{};for(const l in e)i[l]=C1(e,l);return i}class gP{constructor(i,l,u){this._object=i,this._key=l,this._defaultValue=u,this.__v_isRef=!0,this._value=void 0}get value(){const i=this._object[this._key];return this._value=i===void 0?this._defaultValue:i}set value(i){this._object[this._key]=i}get dep(){return KT(fn(this._object),this._key)}}class _P{constructor(i){this._getter=i,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function rn(e,i,l){return di(e)?e:wn(e)?new _P(e):Ci(e)&&arguments.length>1?C1(e,i,l):Ke(e)}function C1(e,i,l){const u=e[i];return di(u)?u:new gP(e,i,l)}class yP{constructor(i,l,u){this.fn=i,this.setter=l,this._value=void 0,this.dep=new py(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=sh-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!l,this.isSSR=u}notify(){if(this.flags|=16,!(this.flags&8)&&Si!==this)return u1(this,!0),!0}get value(){const i=this.dep.track();return f1(this),i&&(i.version=this.dep.version),this._value}set value(i){this.setter&&this.setter(i)}}function vP(e,i,l=!1){let u,f;return wn(e)?u=e:(u=e.get,f=e.set),new yP(u,f,l)}const cp={},zp=new WeakMap;let Nl;function bP(e,i=!1,l=Nl){if(l){let u=zp.get(l);u||zp.set(l,u=[]),u.push(e)}}function xP(e,i,l=vi){const{immediate:u,deep:f,once:g,scheduler:m,augmentJob:o,call:T}=l,k=me=>f?me:Ba(me)||f===!1||f===0?Qs(me,1):Qs(me);let I,z,O,D,B=!1,V=!1;if(di(e)?(z=()=>e.value,B=Ba(e)):qo(e)?(z=()=>k(e),B=!0):gn(e)?(V=!0,B=e.some(me=>qo(me)||Ba(me)),z=()=>e.map(me=>{if(di(me))return me.value;if(qo(me))return k(me);if(wn(me))return T?T(me,2):me()})):wn(e)?i?z=T?()=>T(e,2):e:z=()=>{if(O){Ko();try{O()}finally{Yo()}}const me=Nl;Nl=I;try{return T?T(e,3,[D]):e(D)}finally{Nl=me}}:z=La,i&&f){const me=z,be=f===!0?1/0:f;z=()=>Qs(me(),be)}const Z=o1(),oe=()=>{I.stop(),Z&&Z.active&&ly(Z.effects,I)};if(g&&i){const me=i;i=(...be)=>{me(...be),oe()}}let pe=V?new Array(e.length).fill(cp):cp;const Se=me=>{if(!(!(I.flags&1)||!I.dirty&&!me))if(i){const be=I.run();if(f||B||(V?be.some((he,Ce)=>Zo(he,pe[Ce])):Zo(be,pe))){O&&O();const he=Nl;Nl=I;try{const Ce=[be,pe===cp?void 0:V&&pe[0]===cp?[]:pe,D];T?T(i,3,Ce):i(...Ce),pe=be}finally{Nl=he}}}else I.run()};return o&&o(Se),I=new l1(z),I.scheduler=m?()=>m(Se,!1):Se,D=me=>bP(me,!1,I),O=I.onStop=()=>{const me=zp.get(I);if(me){if(T)T(me,4);else for(const be of me)be();zp.delete(I)}},i?u?Se(!0):pe=I.run():m?m(Se.bind(null,!0),!0):I.run(),oe.pause=I.pause.bind(I),oe.resume=I.resume.bind(I),oe.stop=oe,oe}function Qs(e,i=1/0,l){if(i<=0||!Ci(e)||e.__v_skip||(l=l||new Set,l.has(e)))return e;if(l.add(e),i--,di(e))Qs(e.value,i,l);else if(gn(e))for(let u=0;u<e.length;u++)Qs(e[u],i,l);else if(Jx(e)||uu(e))e.forEach(u=>{Qs(u,i,l)});else if(t1(e)){for(const u in e)Qs(e[u],i,l);for(const u of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,u)&&Qs(e[u],i,l)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Th(e,i,l,u){try{return u?e(...u):e()}catch(f){dm(f,i,l)}}function ss(e,i,l,u){if(wn(e)){const f=Th(e,i,l,u);return f&&Qx(f)&&f.catch(g=>{dm(g,i,l)}),f}if(gn(e)){const f=[];for(let g=0;g<e.length;g++)f.push(ss(e[g],i,l,u));return f}}function dm(e,i,l,u=!0){const f=i?i.vnode:null,{errorHandler:g,throwUnhandledErrorInProduction:m}=i&&i.appContext.config||vi;if(i){let o=i.parent;const T=i.proxy,k=`https://vuejs.org/error-reference/#runtime-${l}`;for(;o;){const I=o.ec;if(I){for(let z=0;z<I.length;z++)if(I[z](e,T,k)===!1)return}o=o.parent}if(g){Ko(),Th(g,null,10,[e,T,k]),Yo();return}}wP(e,l,f,u,m)}function wP(e,i,l,u=!0,f=!1){if(f)throw e;console.error(e)}const Xr=[];let xs=-1;const du=[];let Uo=null,su=0;const T1=Promise.resolve();let Lp=null;function Fi(e){const i=Lp||T1;return e?i.then(this?e.bind(this):e):i}function SP(e){let i=xs+1,l=Xr.length;for(;i<l;){const u=i+l>>>1,f=Xr[u],g=lh(f);g<e||g===e&&f.flags&2?i=u+1:l=u}return i}function yy(e){if(!(e.flags&1)){const i=lh(e),l=Xr[Xr.length-1];!l||!(e.flags&2)&&i>=lh(l)?Xr.push(e):Xr.splice(SP(i),0,e),e.flags|=1,P1()}}function P1(){Lp||(Lp=T1.then(M1))}function k1(e){gn(e)?du.push(...e):Uo&&e.id===-1?Uo.splice(su+1,0,e):e.flags&1||(du.push(e),e.flags|=1),P1()}function J0(e,i,l=xs+1){for(;l<Xr.length;l++){const u=Xr[l];if(u&&u.flags&2){if(e&&u.id!==e.uid)continue;Xr.splice(l,1),l--,u.flags&4&&(u.flags&=-2),u(),u.flags&4||(u.flags&=-2)}}}function I1(e){if(du.length){const i=[...new Set(du)].sort((l,u)=>lh(l)-lh(u));if(du.length=0,Uo){Uo.push(...i);return}for(Uo=i,su=0;su<Uo.length;su++){const l=Uo[su];l.flags&4&&(l.flags&=-2),l.flags&8||l(),l.flags&=-2}Uo=null,su=0}}const lh=e=>e.id==null?e.flags&2?-1:1/0:e.id;function M1(e){const i=La;try{for(xs=0;xs<Xr.length;xs++){const l=Xr[xs];l&&!(l.flags&8)&&(l.flags&4&&(l.flags&=-2),Th(l,l.i,l.i?15:14),l.flags&4||(l.flags&=-2))}}finally{for(;xs<Xr.length;xs++){const l=Xr[xs];l&&(l.flags&=-2)}xs=-1,Xr.length=0,I1(),Lp=null,(Xr.length||du.length)&&M1()}}let Yr=null,E1=null;function Bp(e){const i=Yr;return Yr=e,E1=e&&e.type.__scopeId||null,i}function K(e,i=Yr,l){if(!i||e._n)return e;const u=(...f)=>{u._d&&db(-1);const g=Bp(i);let m;try{m=e(...f)}finally{Bp(g),u._d&&db(1)}return m};return u._n=!0,u._c=!0,u._d=!0,u}function Pr(e,i){if(Yr===null)return e;const l=gm(Yr),u=e.dirs||(e.dirs=[]);for(let f=0;f<i.length;f++){let[g,m,o,T=vi]=i[f];g&&(wn(g)&&(g={mounted:g,updated:g}),g.deep&&Qs(m),u.push({dir:g,instance:l,value:m,oldValue:void 0,arg:o,modifiers:T}))}return e}function Ll(e,i,l,u){const f=e.dirs,g=i&&i.dirs;for(let m=0;m<f.length;m++){const o=f[m];g&&(o.oldValue=g[m].value);let T=o.dir[u];T&&(Ko(),ss(T,l,8,[e.el,o,e,i]),Yo())}}const A1=Symbol("_vte"),R1=e=>e.__isTeleport,eh=e=>e&&(e.disabled||e.disabled===""),Q0=e=>e&&(e.defer||e.defer===""),eb=e=>typeof SVGElement<"u"&&e instanceof SVGElement,tb=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,I_=(e,i)=>{const l=e&&e.to;return Oi(l)?i?i(l):null:l},D1={name:"Teleport",__isTeleport:!0,process(e,i,l,u,f,g,m,o,T,k){const{mc:I,pc:z,pbc:O,o:{insert:D,querySelector:B,createText:V,createComment:Z}}=k,oe=eh(i.props);let{shapeFlag:pe,children:Se,dynamicChildren:me}=i;if(e==null){const be=i.el=V(""),he=i.anchor=V("");D(be,l,u),D(he,l,u);const Ce=(Me,ke)=>{pe&16&&(f&&f.isCE&&(f.ce._teleportTarget=Me),I(Se,Me,ke,f,g,m,o,T))},ye=()=>{const Me=i.target=I_(i.props,B),ke=z1(Me,i,V,D);Me&&(m!=="svg"&&eb(Me)?m="svg":m!=="mathml"&&tb(Me)&&(m="mathml"),oe||(Ce(Me,ke),bp(i,!1)))};oe&&(Ce(l,he),bp(i,!0)),Q0(i.props)?qr(()=>{ye(),i.el.__isMounted=!0},g):ye()}else{if(Q0(i.props)&&!e.el.__isMounted){qr(()=>{D1.process(e,i,l,u,f,g,m,o,T,k),delete e.el.__isMounted},g);return}i.el=e.el,i.targetStart=e.targetStart;const be=i.anchor=e.anchor,he=i.target=e.target,Ce=i.targetAnchor=e.targetAnchor,ye=eh(e.props),Me=ye?l:he,ke=ye?be:Ce;if(m==="svg"||eb(he)?m="svg":(m==="mathml"||tb(he))&&(m="mathml"),me?(O(e.dynamicChildren,me,Me,f,g,m,o),Cy(e,i,!0)):T||z(e,i,Me,ke,f,g,m,o,!1),oe)ye?i.props&&e.props&&i.props.to!==e.props.to&&(i.props.to=e.props.to):up(i,l,be,k,1);else if((i.props&&i.props.to)!==(e.props&&e.props.to)){const Ee=i.target=I_(i.props,B);Ee&&up(i,Ee,null,k,0)}else ye&&up(i,he,Ce,k,1);bp(i,oe)}},remove(e,i,l,{um:u,o:{remove:f}},g){const{shapeFlag:m,children:o,anchor:T,targetStart:k,targetAnchor:I,target:z,props:O}=e;if(z&&(f(k),f(I)),g&&f(T),m&16){const D=g||!eh(O);for(let B=0;B<o.length;B++){const V=o[B];u(V,i,l,D,!!V.dynamicChildren)}}},move:up,hydrate:CP};function up(e,i,l,{o:{insert:u},m:f},g=2){g===0&&u(e.targetAnchor,i,l);const{el:m,anchor:o,shapeFlag:T,children:k,props:I}=e,z=g===2;if(z&&u(m,i,l),(!z||eh(I))&&T&16)for(let O=0;O<k.length;O++)f(k[O],i,l,2);z&&u(o,i,l)}function CP(e,i,l,u,f,g,{o:{nextSibling:m,parentNode:o,querySelector:T,insert:k,createText:I}},z){const O=i.target=I_(i.props,T);if(O){const D=eh(i.props),B=O._lpa||O.firstChild;if(i.shapeFlag&16)if(D)i.anchor=z(m(e),i,o(e),l,u,f,g),i.targetStart=B,i.targetAnchor=B&&m(B);else{i.anchor=m(e);let V=B;for(;V;){if(V&&V.nodeType===8){if(V.data==="teleport start anchor")i.targetStart=V;else if(V.data==="teleport anchor"){i.targetAnchor=V,O._lpa=i.targetAnchor&&m(i.targetAnchor);break}}V=m(V)}i.targetAnchor||z1(O,i,I,k),z(B&&m(B),i,O,l,u,f,g)}bp(i,D)}return i.anchor&&m(i.anchor)}const TP=D1;function bp(e,i){const l=e.ctx;if(l&&l.ut){let u,f;for(i?(u=e.el,f=e.anchor):(u=e.targetStart,f=e.targetAnchor);u&&u!==f;)u.nodeType===1&&u.setAttribute("data-v-owner",l.uid),u=u.nextSibling;l.ut()}}function z1(e,i,l,u){const f=i.targetStart=l(""),g=i.targetAnchor=l("");return f[A1]=g,e&&(u(f,e),u(g,e)),g}const Go=Symbol("_leaveCb"),dp=Symbol("_enterCb");function L1(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Qn(()=>{e.isMounted=!0}),Ir(()=>{e.isUnmounting=!0}),e}const Da=[Function,Array],B1={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Da,onEnter:Da,onAfterEnter:Da,onEnterCancelled:Da,onBeforeLeave:Da,onLeave:Da,onAfterLeave:Da,onLeaveCancelled:Da,onBeforeAppear:Da,onAppear:Da,onAfterAppear:Da,onAppearCancelled:Da},F1=e=>{const i=e.subTree;return i.component?F1(i.component):i},PP={name:"BaseTransition",props:B1,setup(e,{slots:i}){const l=mm(),u=L1();return()=>{const f=i.default&&vy(i.default(),!0);if(!f||!f.length)return;const g=O1(f),m=fn(e),{mode:o}=m;if(u.isLeaving)return Jg(g);const T=nb(g);if(!T)return Jg(g);let k=ch(T,m,u,l,z=>k=z);T.type!==Kr&&Xl(T,k);let I=l.subTree&&nb(l.subTree);if(I&&I.type!==Kr&&!$l(T,I)&&F1(l).type!==Kr){let z=ch(I,m,u,l);if(Xl(I,z),o==="out-in"&&T.type!==Kr)return u.isLeaving=!0,z.afterLeave=()=>{u.isLeaving=!1,l.job.flags&8||l.update(),delete z.afterLeave,I=void 0},Jg(g);o==="in-out"&&T.type!==Kr?z.delayLeave=(O,D,B)=>{const V=V1(u,I);V[String(I.key)]=I,O[Go]=()=>{D(),O[Go]=void 0,delete k.delayedLeave,I=void 0},k.delayedLeave=()=>{B(),delete k.delayedLeave,I=void 0}}:I=void 0}else I&&(I=void 0);return g}}};function O1(e){let i=e[0];if(e.length>1){for(const l of e)if(l.type!==Kr){i=l;break}}return i}const kP=PP;function V1(e,i){const{leavingVNodes:l}=e;let u=l.get(i.type);return u||(u=Object.create(null),l.set(i.type,u)),u}function ch(e,i,l,u,f){const{appear:g,mode:m,persisted:o=!1,onBeforeEnter:T,onEnter:k,onAfterEnter:I,onEnterCancelled:z,onBeforeLeave:O,onLeave:D,onAfterLeave:B,onLeaveCancelled:V,onBeforeAppear:Z,onAppear:oe,onAfterAppear:pe,onAppearCancelled:Se}=i,me=String(e.key),be=V1(l,e),he=(Me,ke)=>{Me&&ss(Me,u,9,ke)},Ce=(Me,ke)=>{const Ee=ke[1];he(Me,ke),gn(Me)?Me.every(xe=>xe.length<=1)&&Ee():Me.length<=1&&Ee()},ye={mode:m,persisted:o,beforeEnter(Me){let ke=T;if(!l.isMounted)if(g)ke=Z||T;else return;Me[Go]&&Me[Go](!0);const Ee=be[me];Ee&&$l(e,Ee)&&Ee.el[Go]&&Ee.el[Go](),he(ke,[Me])},enter(Me){let ke=k,Ee=I,xe=z;if(!l.isMounted)if(g)ke=oe||k,Ee=pe||I,xe=Se||z;else return;let Oe=!1;const We=Me[dp]=dt=>{Oe||(Oe=!0,dt?he(xe,[Me]):he(Ee,[Me]),ye.delayedLeave&&ye.delayedLeave(),Me[dp]=void 0)};ke?Ce(ke,[Me,We]):We()},leave(Me,ke){const Ee=String(e.key);if(Me[dp]&&Me[dp](!0),l.isUnmounting)return ke();he(O,[Me]);let xe=!1;const Oe=Me[Go]=We=>{xe||(xe=!0,ke(),We?he(V,[Me]):he(B,[Me]),Me[Go]=void 0,be[Ee]===e&&delete be[Ee])};be[Ee]=e,D?Ce(D,[Me,Oe]):Oe()},clone(Me){const ke=ch(Me,i,l,u,f);return f&&f(ke),ke}};return ye}function Jg(e){if(hm(e))return e=io(e),e.children=null,e}function nb(e){if(!hm(e))return R1(e.type)&&e.children?O1(e.children):e;const{shapeFlag:i,children:l}=e;if(l){if(i&16)return l[0];if(i&32&&wn(l.default))return l.default()}}function Xl(e,i){e.shapeFlag&6&&e.component?(e.transition=i,Xl(e.component.subTree,i)):e.shapeFlag&128?(e.ssContent.transition=i.clone(e.ssContent),e.ssFallback.transition=i.clone(e.ssFallback)):e.transition=i}function vy(e,i=!1,l){let u=[],f=0;for(let g=0;g<e.length;g++){let m=e[g];const o=l==null?m.key:String(l)+String(m.key!=null?m.key:g);m.type===un?(m.patchFlag&128&&f++,u=u.concat(vy(m.children,i,o))):(i||m.type!==Kr)&&u.push(o!=null?io(m,{key:o}):m)}if(f>1)for(let g=0;g<u.length;g++)u[g].patchFlag=-2;return u}/*! #__NO_SIDE_EFFECTS__ */function Vn(e,i){return wn(e)?(()=>er({name:e.name},i,{setup:e}))():e}function N1(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function Fp(e,i,l,u,f=!1){if(gn(e)){e.forEach((B,V)=>Fp(B,i&&(gn(i)?i[V]:i),l,u,f));return}if(th(u)&&!f){u.shapeFlag&512&&u.type.__asyncResolved&&u.component.subTree.component&&Fp(e,i,l,u.component.subTree);return}const g=u.shapeFlag&4?gm(u.component):u.el,m=f?null:g,{i:o,r:T}=e,k=i&&i.r,I=o.refs===vi?o.refs={}:o.refs,z=o.setupState,O=fn(z),D=z===vi?()=>!1:B=>ii(O,B);if(k!=null&&k!==T&&(Oi(k)?(I[k]=null,D(k)&&(z[k]=null)):di(k)&&(k.value=null)),wn(T))Th(T,o,12,[m,I]);else{const B=Oi(T),V=di(T);if(B||V){const Z=()=>{if(e.f){const oe=B?D(T)?z[T]:I[T]:T.value;f?gn(oe)&&ly(oe,g):gn(oe)?oe.includes(g)||oe.push(g):B?(I[T]=[g],D(T)&&(z[T]=I[T])):(T.value=[g],e.k&&(I[e.k]=T.value))}else B?(I[T]=m,D(T)&&(z[T]=m)):V&&(T.value=m,e.k&&(I[e.k]=m))};m?(Z.id=-1,qr(Z,l)):Z()}}}sm().requestIdleCallback;sm().cancelIdleCallback;const th=e=>!!e.type.__asyncLoader,hm=e=>e.type.__isKeepAlive;function $1(e,i){j1(e,"a",i)}function by(e,i){j1(e,"da",i)}function j1(e,i,l=xr){const u=e.__wdc||(e.__wdc=()=>{let f=l;for(;f;){if(f.isDeactivated)return;f=f.parent}return e()});if(fm(i,u,l),l){let f=l.parent;for(;f&&f.parent;)hm(f.parent.vnode)&&IP(u,i,l,f),f=f.parent}}function IP(e,i,l,u){const f=fm(i,e,u,!0);kh(()=>{ly(u[i],f)},l)}function fm(e,i,l=xr,u=!1){if(l){const f=l[e]||(l[e]=[]),g=i.__weh||(i.__weh=(...m)=>{Ko();const o=Mh(l),T=ss(i,l,e,m);return o(),Yo(),T});return u?f.unshift(g):f.push(g),g}}const so=e=>(i,l=xr)=>{(!hh||e==="sp")&&fm(e,(...u)=>i(...u),l)},Ph=so("bm"),Qn=so("m"),U1=so("bu"),xy=so("u"),Ir=so("bum"),kh=so("um"),MP=so("sp"),EP=so("rtg"),AP=so("rtc");function RP(e,i=xr){fm("ec",e,i)}const G1="components",DP="directives",H1=Symbol.for("v-ndc");function zP(e){return Oi(e)?Z1(G1,e,!1)||e:e||H1}function oo(e){return Z1(DP,e)}function Z1(e,i,l=!0,u=!1){const f=Yr||xr;if(f){const g=f.type;if(e===G1){const o=bk(g,!1);if(o&&(o===i||o===oa(i)||o===ao(oa(i))))return g}const m=ib(f[e]||g[e],i)||ib(f.appContext[e],i);return!m&&u?g:m}}function ib(e,i){return e&&(e[i]||e[oa(i)]||e[ao(oa(i))])}function la(e,i,l,u){let f;const g=l&&l[u],m=gn(e);if(m||Oi(e)){const o=m&&qo(e);let T=!1;o&&(T=!Ba(e),e=lm(e)),f=new Array(e.length);for(let k=0,I=e.length;k<I;k++)f[k]=i(T?Lr(e[k]):e[k],k,void 0,g&&g[k])}else if(typeof e=="number"){f=new Array(e);for(let o=0;o<e;o++)f[o]=i(o+1,o,void 0,g&&g[o])}else if(Ci(e))if(e[Symbol.iterator])f=Array.from(e,(o,T)=>i(o,T,void 0,g&&g[T]));else{const o=Object.keys(e);f=new Array(o.length);for(let T=0,k=o.length;T<k;T++){const I=o[T];f[T]=i(e[I],I,T,g&&g[T])}}else f=[];return l&&(l[u]=f),f}const M_=e=>e?uw(e)?gm(e):M_(e.parent):null,nh=er(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>M_(e.parent),$root:e=>M_(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>wy(e),$forceUpdate:e=>e.f||(e.f=()=>{yy(e.update)}),$nextTick:e=>e.n||(e.n=Fi.bind(e.proxy)),$watch:e=>nk.bind(e)}),Qg=(e,i)=>e!==vi&&!e.__isScriptSetup&&ii(e,i),LP={get({_:e},i){if(i==="__v_skip")return!0;const{ctx:l,setupState:u,data:f,props:g,accessCache:m,type:o,appContext:T}=e;let k;if(i[0]!=="$"){const D=m[i];if(D!==void 0)switch(D){case 1:return u[i];case 2:return f[i];case 4:return l[i];case 3:return g[i]}else{if(Qg(u,i))return m[i]=1,u[i];if(f!==vi&&ii(f,i))return m[i]=2,f[i];if((k=e.propsOptions[0])&&ii(k,i))return m[i]=3,g[i];if(l!==vi&&ii(l,i))return m[i]=4,l[i];E_&&(m[i]=0)}}const I=nh[i];let z,O;if(I)return i==="$attrs"&&zr(e.attrs,"get",""),I(e);if((z=o.__cssModules)&&(z=z[i]))return z;if(l!==vi&&ii(l,i))return m[i]=4,l[i];if(O=T.config.globalProperties,ii(O,i))return O[i]},set({_:e},i,l){const{data:u,setupState:f,ctx:g}=e;return Qg(f,i)?(f[i]=l,!0):u!==vi&&ii(u,i)?(u[i]=l,!0):ii(e.props,i)||i[0]==="$"&&i.slice(1)in e?!1:(g[i]=l,!0)},has({_:{data:e,setupState:i,accessCache:l,ctx:u,appContext:f,propsOptions:g}},m){let o;return!!l[m]||e!==vi&&ii(e,m)||Qg(i,m)||(o=g[0])&&ii(o,m)||ii(u,m)||ii(nh,m)||ii(f.config.globalProperties,m)},defineProperty(e,i,l){return l.get!=null?e._.accessCache[i]=0:ii(l,"value")&&this.set(e,i,l.value,null),Reflect.defineProperty(e,i,l)}};function rb(e){return gn(e)?e.reduce((i,l)=>(i[l]=null,i),{}):e}let E_=!0;function BP(e){const i=wy(e),l=e.proxy,u=e.ctx;E_=!1,i.beforeCreate&&ab(i.beforeCreate,e,"bc");const{data:f,computed:g,methods:m,watch:o,provide:T,inject:k,created:I,beforeMount:z,mounted:O,beforeUpdate:D,updated:B,activated:V,deactivated:Z,beforeDestroy:oe,beforeUnmount:pe,destroyed:Se,unmounted:me,render:be,renderTracked:he,renderTriggered:Ce,errorCaptured:ye,serverPrefetch:Me,expose:ke,inheritAttrs:Ee,components:xe,directives:Oe,filters:We}=i;if(k&&FP(k,u,null),m)for(const tt in m){const Et=m[tt];wn(Et)&&(u[tt]=Et.bind(l))}if(f){const tt=f.call(l,l);Ci(tt)&&(e.data=br(tt))}if(E_=!0,g)for(const tt in g){const Et=g[tt],_t=wn(Et)?Et.bind(l,l):wn(Et.get)?Et.get.bind(l,l):La,Qe=!wn(Et)&&wn(Et.set)?Et.set.bind(l):La,ct=ce({get:_t,set:Qe});Object.defineProperty(u,tt,{enumerable:!0,configurable:!0,get:()=>ct.value,set:zt=>ct.value=zt})}if(o)for(const tt in o)q1(o[tt],u,l,tt);if(T){const tt=wn(T)?T.call(l):T;Reflect.ownKeys(tt).forEach(Et=>{Mr(Et,tt[Et])})}I&&ab(I,e,"c");function je(tt,Et){gn(Et)?Et.forEach(_t=>tt(_t.bind(l))):Et&&tt(Et.bind(l))}if(je(Ph,z),je(Qn,O),je(U1,D),je(xy,B),je($1,V),je(by,Z),je(RP,ye),je(AP,he),je(EP,Ce),je(Ir,pe),je(kh,me),je(MP,Me),gn(ke))if(ke.length){const tt=e.exposed||(e.exposed={});ke.forEach(Et=>{Object.defineProperty(tt,Et,{get:()=>l[Et],set:_t=>l[Et]=_t})})}else e.exposed||(e.exposed={});be&&e.render===La&&(e.render=be),Ee!=null&&(e.inheritAttrs=Ee),xe&&(e.components=xe),Oe&&(e.directives=Oe),Me&&N1(e)}function FP(e,i,l=La){gn(e)&&(e=A_(e));for(const u in e){const f=e[u];let g;Ci(f)?"default"in f?g=ri(f.from||u,f.default,!0):g=ri(f.from||u):g=ri(f),di(g)?Object.defineProperty(i,u,{enumerable:!0,configurable:!0,get:()=>g.value,set:m=>g.value=m}):i[u]=g}}function ab(e,i,l){ss(gn(e)?e.map(u=>u.bind(i.proxy)):e.bind(i.proxy),i,l)}function q1(e,i,l,u){let f=u.includes(".")?aw(l,u):()=>l[u];if(Oi(e)){const g=i[e];wn(g)&&en(f,g)}else if(wn(e))en(f,e.bind(l));else if(Ci(e))if(gn(e))e.forEach(g=>q1(g,i,l,u));else{const g=wn(e.handler)?e.handler.bind(l):i[e.handler];wn(g)&&en(f,g,e)}}function wy(e){const i=e.type,{mixins:l,extends:u}=i,{mixins:f,optionsCache:g,config:{optionMergeStrategies:m}}=e.appContext,o=g.get(i);let T;return o?T=o:!f.length&&!l&&!u?T=i:(T={},f.length&&f.forEach(k=>Op(T,k,m,!0)),Op(T,i,m)),Ci(i)&&g.set(i,T),T}function Op(e,i,l,u=!1){const{mixins:f,extends:g}=i;g&&Op(e,g,l,!0),f&&f.forEach(m=>Op(e,m,l,!0));for(const m in i)if(!(u&&m==="expose")){const o=OP[m]||l&&l[m];e[m]=o?o(e[m],i[m]):i[m]}return e}const OP={data:sb,props:ob,emits:ob,methods:Kd,computed:Kd,beforeCreate:Zr,created:Zr,beforeMount:Zr,mounted:Zr,beforeUpdate:Zr,updated:Zr,beforeDestroy:Zr,beforeUnmount:Zr,destroyed:Zr,unmounted:Zr,activated:Zr,deactivated:Zr,errorCaptured:Zr,serverPrefetch:Zr,components:Kd,directives:Kd,watch:NP,provide:sb,inject:VP};function sb(e,i){return i?e?function(){return er(wn(e)?e.call(this,this):e,wn(i)?i.call(this,this):i)}:i:e}function VP(e,i){return Kd(A_(e),A_(i))}function A_(e){if(gn(e)){const i={};for(let l=0;l<e.length;l++)i[e[l]]=e[l];return i}return e}function Zr(e,i){return e?[...new Set([].concat(e,i))]:i}function Kd(e,i){return e?er(Object.create(null),e,i):i}function ob(e,i){return e?gn(e)&&gn(i)?[...new Set([...e,...i])]:er(Object.create(null),rb(e),rb(i??{})):i}function NP(e,i){if(!e)return i;if(!i)return e;const l=er(Object.create(null),e);for(const u in i)l[u]=Zr(e[u],i[u]);return l}function W1(){return{app:null,config:{isNativeTag:BT,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let $P=0;function jP(e,i){return function(u,f=null){wn(u)||(u=er({},u)),f!=null&&!Ci(f)&&(f=null);const g=W1(),m=new WeakSet,o=[];let T=!1;const k=g.app={_uid:$P++,_component:u,_props:f,_container:null,_context:g,_instance:null,version:wk,get config(){return g.config},set config(I){},use(I,...z){return m.has(I)||(I&&wn(I.install)?(m.add(I),I.install(k,...z)):wn(I)&&(m.add(I),I(k,...z))),k},mixin(I){return g.mixins.includes(I)||g.mixins.push(I),k},component(I,z){return z?(g.components[I]=z,k):g.components[I]},directive(I,z){return z?(g.directives[I]=z,k):g.directives[I]},mount(I,z,O){if(!T){const D=k._ceVNode||E(u,f);return D.appContext=g,O===!0?O="svg":O===!1&&(O=void 0),z&&i?i(D,I):e(D,I,O),T=!0,k._container=I,I.__vue_app__=k,gm(D.component)}},onUnmount(I){o.push(I)},unmount(){T&&(ss(o,k._instance,16),e(null,k._container),delete k._container.__vue_app__)},provide(I,z){return g.provides[I]=z,k},runWithContext(I){const z=Hl;Hl=k;try{return I()}finally{Hl=z}}};return k}}let Hl=null;function Mr(e,i){if(xr){let l=xr.provides;const u=xr.parent&&xr.parent.provides;u===l&&(l=xr.provides=Object.create(u)),l[e]=i}}function ri(e,i,l=!1){const u=xr||Yr;if(u||Hl){const f=Hl?Hl._context.provides:u?u.parent==null?u.vnode.appContext&&u.vnode.appContext.provides:u.parent.provides:void 0;if(f&&e in f)return f[e];if(arguments.length>1)return l&&wn(i)?i.call(u&&u.proxy):i}}function UP(){return!!(xr||Yr||Hl)}const X1={},K1=()=>Object.create(X1),Y1=e=>Object.getPrototypeOf(e)===X1;function GP(e,i,l,u=!1){const f={},g=K1();e.propsDefaults=Object.create(null),J1(e,i,f,g);for(const m in e.propsOptions[0])m in f||(f[m]=void 0);l?e.props=u?f:fP(f):e.type.props?e.props=f:e.props=g,e.attrs=g}function HP(e,i,l,u){const{props:f,attrs:g,vnode:{patchFlag:m}}=e,o=fn(f),[T]=e.propsOptions;let k=!1;if((u||m>0)&&!(m&16)){if(m&8){const I=e.vnode.dynamicProps;for(let z=0;z<I.length;z++){let O=I[z];if(pm(e.emitsOptions,O))continue;const D=i[O];if(T)if(ii(g,O))D!==g[O]&&(g[O]=D,k=!0);else{const B=oa(O);f[B]=R_(T,o,B,D,e,!1)}else D!==g[O]&&(g[O]=D,k=!0)}}}else{J1(e,i,f,g)&&(k=!0);let I;for(const z in o)(!i||!ii(i,z)&&((I=Jl(z))===z||!ii(i,I)))&&(T?l&&(l[z]!==void 0||l[I]!==void 0)&&(f[z]=R_(T,o,z,void 0,e,!0)):delete f[z]);if(g!==o)for(const z in g)(!i||!ii(i,z))&&(delete g[z],k=!0)}k&&Js(e.attrs,"set","")}function J1(e,i,l,u){const[f,g]=e.propsOptions;let m=!1,o;if(i)for(let T in i){if(Yd(T))continue;const k=i[T];let I;f&&ii(f,I=oa(T))?!g||!g.includes(I)?l[I]=k:(o||(o={}))[I]=k:pm(e.emitsOptions,T)||(!(T in u)||k!==u[T])&&(u[T]=k,m=!0)}if(g){const T=fn(l),k=o||vi;for(let I=0;I<g.length;I++){const z=g[I];l[z]=R_(f,T,z,k[z],e,!ii(k,z))}}return m}function R_(e,i,l,u,f,g){const m=e[l];if(m!=null){const o=ii(m,"default");if(o&&u===void 0){const T=m.default;if(m.type!==Function&&!m.skipFactory&&wn(T)){const{propsDefaults:k}=f;if(l in k)u=k[l];else{const I=Mh(f);u=k[l]=T.call(null,i),I()}}else u=T;f.ce&&f.ce._setProp(l,u)}m[0]&&(g&&!o?u=!1:m[1]&&(u===""||u===Jl(l))&&(u=!0))}return u}const ZP=new WeakMap;function Q1(e,i,l=!1){const u=l?ZP:i.propsCache,f=u.get(e);if(f)return f;const g=e.props,m={},o=[];let T=!1;if(!wn(e)){const I=z=>{T=!0;const[O,D]=Q1(z,i,!0);er(m,O),D&&o.push(...D)};!l&&i.mixins.length&&i.mixins.forEach(I),e.extends&&I(e.extends),e.mixins&&e.mixins.forEach(I)}if(!g&&!T)return Ci(e)&&u.set(e,cu),cu;if(gn(g))for(let I=0;I<g.length;I++){const z=oa(g[I]);lb(z)&&(m[z]=vi)}else if(g)for(const I in g){const z=oa(I);if(lb(z)){const O=g[I],D=m[z]=gn(O)||wn(O)?{type:O}:er({},O),B=D.type;let V=!1,Z=!0;if(gn(B))for(let oe=0;oe<B.length;++oe){const pe=B[oe],Se=wn(pe)&&pe.name;if(Se==="Boolean"){V=!0;break}else Se==="String"&&(Z=!1)}else V=wn(B)&&B.name==="Boolean";D[0]=V,D[1]=Z,(V||ii(D,"default"))&&o.push(z)}}const k=[m,o];return Ci(e)&&u.set(e,k),k}function lb(e){return e[0]!=="$"&&!Yd(e)}const ew=e=>e[0]==="_"||e==="$stable",Sy=e=>gn(e)?e.map(ws):[ws(e)],qP=(e,i,l)=>{if(i._n)return i;const u=K((...f)=>Sy(i(...f)),l);return u._c=!1,u},tw=(e,i,l)=>{const u=e._ctx;for(const f in e){if(ew(f))continue;const g=e[f];if(wn(g))i[f]=qP(f,g,u);else if(g!=null){const m=Sy(g);i[f]=()=>m}}},nw=(e,i)=>{const l=Sy(i);e.slots.default=()=>l},iw=(e,i,l)=>{for(const u in i)(l||u!=="_")&&(e[u]=i[u])},WP=(e,i,l)=>{const u=e.slots=K1();if(e.vnode.shapeFlag&32){const f=i._;f?(iw(u,i,l),l&&n1(u,"_",f,!0)):tw(i,u)}else i&&nw(e,i)},XP=(e,i,l)=>{const{vnode:u,slots:f}=e;let g=!0,m=vi;if(u.shapeFlag&32){const o=i._;o?l&&o===1?g=!1:iw(f,i,l):(g=!i.$stable,tw(i,f)),m=i}else i&&(nw(e,i),m={default:1});if(g)for(const o in f)!ew(o)&&m[o]==null&&delete f[o]},qr=ck;function KP(e){return YP(e)}function YP(e,i){const l=sm();l.__VUE__=!0;const{insert:u,remove:f,patchProp:g,createElement:m,createText:o,createComment:T,setText:k,setElementText:I,parentNode:z,nextSibling:O,setScopeId:D=La,insertStaticContent:B}=e,V=(Pe,Le,ot,xt=null,gt=null,vt=null,Bt=void 0,It=null,Rt=!!Le.dynamicChildren)=>{if(Pe===Le)return;Pe&&!$l(Pe,Le)&&(xt=_n(Pe),zt(Pe,gt,vt,!0),Pe=null),Le.patchFlag===-2&&(Rt=!1,Le.dynamicChildren=null);const{type:wt,ref:tn,shapeFlag:$t}=Le;switch(wt){case Ih:Z(Pe,Le,ot,xt);break;case Kr:oe(Pe,Le,ot,xt);break;case xp:Pe==null&&pe(Le,ot,xt,Bt);break;case un:xe(Pe,Le,ot,xt,gt,vt,Bt,It,Rt);break;default:$t&1?be(Pe,Le,ot,xt,gt,vt,Bt,It,Rt):$t&6?Oe(Pe,Le,ot,xt,gt,vt,Bt,It,Rt):($t&64||$t&128)&&wt.process(Pe,Le,ot,xt,gt,vt,Bt,It,Rt,Nn)}tn!=null&&gt&&Fp(tn,Pe&&Pe.ref,vt,Le||Pe,!Le)},Z=(Pe,Le,ot,xt)=>{if(Pe==null)u(Le.el=o(Le.children),ot,xt);else{const gt=Le.el=Pe.el;Le.children!==Pe.children&&k(gt,Le.children)}},oe=(Pe,Le,ot,xt)=>{Pe==null?u(Le.el=T(Le.children||""),ot,xt):Le.el=Pe.el},pe=(Pe,Le,ot,xt)=>{[Pe.el,Pe.anchor]=B(Pe.children,Le,ot,xt,Pe.el,Pe.anchor)},Se=({el:Pe,anchor:Le},ot,xt)=>{let gt;for(;Pe&&Pe!==Le;)gt=O(Pe),u(Pe,ot,xt),Pe=gt;u(Le,ot,xt)},me=({el:Pe,anchor:Le})=>{let ot;for(;Pe&&Pe!==Le;)ot=O(Pe),f(Pe),Pe=ot;f(Le)},be=(Pe,Le,ot,xt,gt,vt,Bt,It,Rt)=>{Le.type==="svg"?Bt="svg":Le.type==="math"&&(Bt="mathml"),Pe==null?he(Le,ot,xt,gt,vt,Bt,It,Rt):Me(Pe,Le,gt,vt,Bt,It,Rt)},he=(Pe,Le,ot,xt,gt,vt,Bt,It)=>{let Rt,wt;const{props:tn,shapeFlag:$t,transition:Xt,dirs:dn}=Pe;if(Rt=Pe.el=m(Pe.type,vt,tn&&tn.is,tn),$t&8?I(Rt,Pe.children):$t&16&&ye(Pe.children,Rt,null,xt,gt,e_(Pe,vt),Bt,It),dn&&Ll(Pe,null,xt,"created"),Ce(Rt,Pe,Pe.scopeId,Bt,xt),tn){for(const Dn in tn)Dn!=="value"&&!Yd(Dn)&&g(Rt,Dn,null,tn[Dn],vt,xt);"value"in tn&&g(Rt,"value",null,tn.value,vt),(wt=tn.onVnodeBeforeMount)&&ys(wt,xt,Pe)}dn&&Ll(Pe,null,xt,"beforeMount");const Sn=JP(gt,Xt);Sn&&Xt.beforeEnter(Rt),u(Rt,Le,ot),((wt=tn&&tn.onVnodeMounted)||Sn||dn)&&qr(()=>{wt&&ys(wt,xt,Pe),Sn&&Xt.enter(Rt),dn&&Ll(Pe,null,xt,"mounted")},gt)},Ce=(Pe,Le,ot,xt,gt)=>{if(ot&&D(Pe,ot),xt)for(let vt=0;vt<xt.length;vt++)D(Pe,xt[vt]);if(gt){let vt=gt.subTree;if(Le===vt||ow(vt.type)&&(vt.ssContent===Le||vt.ssFallback===Le)){const Bt=gt.vnode;Ce(Pe,Bt,Bt.scopeId,Bt.slotScopeIds,gt.parent)}}},ye=(Pe,Le,ot,xt,gt,vt,Bt,It,Rt=0)=>{for(let wt=Rt;wt<Pe.length;wt++){const tn=Pe[wt]=It?Ho(Pe[wt]):ws(Pe[wt]);V(null,tn,Le,ot,xt,gt,vt,Bt,It)}},Me=(Pe,Le,ot,xt,gt,vt,Bt)=>{const It=Le.el=Pe.el;let{patchFlag:Rt,dynamicChildren:wt,dirs:tn}=Le;Rt|=Pe.patchFlag&16;const $t=Pe.props||vi,Xt=Le.props||vi;let dn;if(ot&&Bl(ot,!1),(dn=Xt.onVnodeBeforeUpdate)&&ys(dn,ot,Le,Pe),tn&&Ll(Le,Pe,ot,"beforeUpdate"),ot&&Bl(ot,!0),($t.innerHTML&&Xt.innerHTML==null||$t.textContent&&Xt.textContent==null)&&I(It,""),wt?ke(Pe.dynamicChildren,wt,It,ot,xt,e_(Le,gt),vt):Bt||Et(Pe,Le,It,null,ot,xt,e_(Le,gt),vt,!1),Rt>0){if(Rt&16)Ee(It,$t,Xt,ot,gt);else if(Rt&2&&$t.class!==Xt.class&&g(It,"class",null,Xt.class,gt),Rt&4&&g(It,"style",$t.style,Xt.style,gt),Rt&8){const Sn=Le.dynamicProps;for(let Dn=0;Dn<Sn.length;Dn++){const An=Sn[Dn],Ei=$t[An],ki=Xt[An];(ki!==Ei||An==="value")&&g(It,An,Ei,ki,gt,ot)}}Rt&1&&Pe.children!==Le.children&&I(It,Le.children)}else!Bt&&wt==null&&Ee(It,$t,Xt,ot,gt);((dn=Xt.onVnodeUpdated)||tn)&&qr(()=>{dn&&ys(dn,ot,Le,Pe),tn&&Ll(Le,Pe,ot,"updated")},xt)},ke=(Pe,Le,ot,xt,gt,vt,Bt)=>{for(let It=0;It<Le.length;It++){const Rt=Pe[It],wt=Le[It],tn=Rt.el&&(Rt.type===un||!$l(Rt,wt)||Rt.shapeFlag&70)?z(Rt.el):ot;V(Rt,wt,tn,null,xt,gt,vt,Bt,!0)}},Ee=(Pe,Le,ot,xt,gt)=>{if(Le!==ot){if(Le!==vi)for(const vt in Le)!Yd(vt)&&!(vt in ot)&&g(Pe,vt,Le[vt],null,gt,xt);for(const vt in ot){if(Yd(vt))continue;const Bt=ot[vt],It=Le[vt];Bt!==It&&vt!=="value"&&g(Pe,vt,It,Bt,gt,xt)}"value"in ot&&g(Pe,"value",Le.value,ot.value,gt)}},xe=(Pe,Le,ot,xt,gt,vt,Bt,It,Rt)=>{const wt=Le.el=Pe?Pe.el:o(""),tn=Le.anchor=Pe?Pe.anchor:o("");let{patchFlag:$t,dynamicChildren:Xt,slotScopeIds:dn}=Le;dn&&(It=It?It.concat(dn):dn),Pe==null?(u(wt,ot,xt),u(tn,ot,xt),ye(Le.children||[],ot,tn,gt,vt,Bt,It,Rt)):$t>0&&$t&64&&Xt&&Pe.dynamicChildren?(ke(Pe.dynamicChildren,Xt,ot,gt,vt,Bt,It),(Le.key!=null||gt&&Le===gt.subTree)&&Cy(Pe,Le,!0)):Et(Pe,Le,ot,tn,gt,vt,Bt,It,Rt)},Oe=(Pe,Le,ot,xt,gt,vt,Bt,It,Rt)=>{Le.slotScopeIds=It,Pe==null?Le.shapeFlag&512?gt.ctx.activate(Le,ot,xt,Bt,Rt):We(Le,ot,xt,gt,vt,Bt,Rt):dt(Pe,Le,Rt)},We=(Pe,Le,ot,xt,gt,vt,Bt)=>{const It=Pe.component=mk(Pe,xt,gt);if(hm(Pe)&&(It.ctx.renderer=Nn),gk(It,!1,Bt),It.asyncDep){if(gt&&gt.registerDep(It,je,Bt),!Pe.el){const Rt=It.subTree=E(Kr);oe(null,Rt,Le,ot)}}else je(It,Pe,Le,ot,gt,vt,Bt)},dt=(Pe,Le,ot)=>{const xt=Le.component=Pe.component;if(ok(Pe,Le,ot))if(xt.asyncDep&&!xt.asyncResolved){tt(xt,Le,ot);return}else xt.next=Le,xt.update();else Le.el=Pe.el,xt.vnode=Le},je=(Pe,Le,ot,xt,gt,vt,Bt)=>{const It=()=>{if(Pe.isMounted){let{next:$t,bu:Xt,u:dn,parent:Sn,vnode:Dn}=Pe;{const Zi=rw(Pe);if(Zi){$t&&($t.el=Dn.el,tt(Pe,$t,Bt)),Zi.asyncDep.then(()=>{Pe.isUnmounted||It()});return}}let An=$t,Ei;Bl(Pe,!1),$t?($t.el=Dn.el,tt(Pe,$t,Bt)):$t=Dn,Xt&&vp(Xt),(Ei=$t.props&&$t.props.onVnodeBeforeUpdate)&&ys(Ei,Sn,$t,Dn),Bl(Pe,!0);const ki=t_(Pe),tr=Pe.subTree;Pe.subTree=ki,V(tr,ki,z(tr.el),_n(tr),Pe,gt,vt),$t.el=ki.el,An===null&&lk(Pe,ki.el),dn&&qr(dn,gt),(Ei=$t.props&&$t.props.onVnodeUpdated)&&qr(()=>ys(Ei,Sn,$t,Dn),gt)}else{let $t;const{el:Xt,props:dn}=Le,{bm:Sn,m:Dn,parent:An,root:Ei,type:ki}=Pe,tr=th(Le);if(Bl(Pe,!1),Sn&&vp(Sn),!tr&&($t=dn&&dn.onVnodeBeforeMount)&&ys($t,An,Le),Bl(Pe,!0),Xt&&En){const Zi=()=>{Pe.subTree=t_(Pe),En(Xt,Pe.subTree,Pe,gt,null)};tr&&ki.__asyncHydrate?ki.__asyncHydrate(Xt,Pe,Zi):Zi()}else{Ei.ce&&Ei.ce._injectChildStyle(ki);const Zi=Pe.subTree=t_(Pe);V(null,Zi,ot,xt,Pe,gt,vt),Le.el=Zi.el}if(Dn&&qr(Dn,gt),!tr&&($t=dn&&dn.onVnodeMounted)){const Zi=Le;qr(()=>ys($t,An,Zi),gt)}(Le.shapeFlag&256||An&&th(An.vnode)&&An.vnode.shapeFlag&256)&&Pe.a&&qr(Pe.a,gt),Pe.isMounted=!0,Le=ot=xt=null}};Pe.scope.on();const Rt=Pe.effect=new l1(It);Pe.scope.off();const wt=Pe.update=Rt.run.bind(Rt),tn=Pe.job=Rt.runIfDirty.bind(Rt);tn.i=Pe,tn.id=Pe.uid,Rt.scheduler=()=>yy(tn),Bl(Pe,!0),wt()},tt=(Pe,Le,ot)=>{Le.component=Pe;const xt=Pe.vnode.props;Pe.vnode=Le,Pe.next=null,HP(Pe,Le.props,xt,ot),XP(Pe,Le.children,ot),Ko(),J0(Pe),Yo()},Et=(Pe,Le,ot,xt,gt,vt,Bt,It,Rt=!1)=>{const wt=Pe&&Pe.children,tn=Pe?Pe.shapeFlag:0,$t=Le.children,{patchFlag:Xt,shapeFlag:dn}=Le;if(Xt>0){if(Xt&128){Qe(wt,$t,ot,xt,gt,vt,Bt,It,Rt);return}else if(Xt&256){_t(wt,$t,ot,xt,gt,vt,Bt,It,Rt);return}}dn&8?(tn&16&&qt(wt,gt,vt),$t!==wt&&I(ot,$t)):tn&16?dn&16?Qe(wt,$t,ot,xt,gt,vt,Bt,It,Rt):qt(wt,gt,vt,!0):(tn&8&&I(ot,""),dn&16&&ye($t,ot,xt,gt,vt,Bt,It,Rt))},_t=(Pe,Le,ot,xt,gt,vt,Bt,It,Rt)=>{Pe=Pe||cu,Le=Le||cu;const wt=Pe.length,tn=Le.length,$t=Math.min(wt,tn);let Xt;for(Xt=0;Xt<$t;Xt++){const dn=Le[Xt]=Rt?Ho(Le[Xt]):ws(Le[Xt]);V(Pe[Xt],dn,ot,null,gt,vt,Bt,It,Rt)}wt>tn?qt(Pe,gt,vt,!0,!1,$t):ye(Le,ot,xt,gt,vt,Bt,It,Rt,$t)},Qe=(Pe,Le,ot,xt,gt,vt,Bt,It,Rt)=>{let wt=0;const tn=Le.length;let $t=Pe.length-1,Xt=tn-1;for(;wt<=$t&&wt<=Xt;){const dn=Pe[wt],Sn=Le[wt]=Rt?Ho(Le[wt]):ws(Le[wt]);if($l(dn,Sn))V(dn,Sn,ot,null,gt,vt,Bt,It,Rt);else break;wt++}for(;wt<=$t&&wt<=Xt;){const dn=Pe[$t],Sn=Le[Xt]=Rt?Ho(Le[Xt]):ws(Le[Xt]);if($l(dn,Sn))V(dn,Sn,ot,null,gt,vt,Bt,It,Rt);else break;$t--,Xt--}if(wt>$t){if(wt<=Xt){const dn=Xt+1,Sn=dn<tn?Le[dn].el:xt;for(;wt<=Xt;)V(null,Le[wt]=Rt?Ho(Le[wt]):ws(Le[wt]),ot,Sn,gt,vt,Bt,It,Rt),wt++}}else if(wt>Xt)for(;wt<=$t;)zt(Pe[wt],gt,vt,!0),wt++;else{const dn=wt,Sn=wt,Dn=new Map;for(wt=Sn;wt<=Xt;wt++){const W=Le[wt]=Rt?Ho(Le[wt]):ws(Le[wt]);W.key!=null&&Dn.set(W.key,wt)}let An,Ei=0;const ki=Xt-Sn+1;let tr=!1,Zi=0;const Er=new Array(ki);for(wt=0;wt<ki;wt++)Er[wt]=0;for(wt=dn;wt<=$t;wt++){const W=Pe[wt];if(Ei>=ki){zt(W,gt,vt,!0);continue}let Q;if(W.key!=null)Q=Dn.get(W.key);else for(An=Sn;An<=Xt;An++)if(Er[An-Sn]===0&&$l(W,Le[An])){Q=An;break}Q===void 0?zt(W,gt,vt,!0):(Er[Q-Sn]=wt+1,Q>=Zi?Zi=Q:tr=!0,V(W,Le[Q],ot,null,gt,vt,Bt,It,Rt),Ei++)}const ae=tr?QP(Er):cu;for(An=ae.length-1,wt=ki-1;wt>=0;wt--){const W=Sn+wt,Q=Le[W],te=W+1<tn?Le[W+1].el:xt;Er[wt]===0?V(null,Q,ot,te,gt,vt,Bt,It,Rt):tr&&(An<0||wt!==ae[An]?ct(Q,ot,te,2):An--)}}},ct=(Pe,Le,ot,xt,gt=null)=>{const{el:vt,type:Bt,transition:It,children:Rt,shapeFlag:wt}=Pe;if(wt&6){ct(Pe.component.subTree,Le,ot,xt);return}if(wt&128){Pe.suspense.move(Le,ot,xt);return}if(wt&64){Bt.move(Pe,Le,ot,Nn);return}if(Bt===un){u(vt,Le,ot);for(let $t=0;$t<Rt.length;$t++)ct(Rt[$t],Le,ot,xt);u(Pe.anchor,Le,ot);return}if(Bt===xp){Se(Pe,Le,ot);return}if(xt!==2&&wt&1&&It)if(xt===0)It.beforeEnter(vt),u(vt,Le,ot),qr(()=>It.enter(vt),gt);else{const{leave:$t,delayLeave:Xt,afterLeave:dn}=It,Sn=()=>u(vt,Le,ot),Dn=()=>{$t(vt,()=>{Sn(),dn&&dn()})};Xt?Xt(vt,Sn,Dn):Dn()}else u(vt,Le,ot)},zt=(Pe,Le,ot,xt=!1,gt=!1)=>{const{type:vt,props:Bt,ref:It,children:Rt,dynamicChildren:wt,shapeFlag:tn,patchFlag:$t,dirs:Xt,cacheIndex:dn}=Pe;if($t===-2&&(gt=!1),It!=null&&Fp(It,null,ot,Pe,!0),dn!=null&&(Le.renderCache[dn]=void 0),tn&256){Le.ctx.deactivate(Pe);return}const Sn=tn&1&&Xt,Dn=!th(Pe);let An;if(Dn&&(An=Bt&&Bt.onVnodeBeforeUnmount)&&ys(An,Le,Pe),tn&6)Yt(Pe.component,ot,xt);else{if(tn&128){Pe.suspense.unmount(ot,xt);return}Sn&&Ll(Pe,null,Le,"beforeUnmount"),tn&64?Pe.type.remove(Pe,Le,ot,Nn,xt):wt&&!wt.hasOnce&&(vt!==un||$t>0&&$t&64)?qt(wt,Le,ot,!1,!0):(vt===un&&$t&384||!gt&&tn&16)&&qt(Rt,Le,ot),xt&&Jt(Pe)}(Dn&&(An=Bt&&Bt.onVnodeUnmounted)||Sn)&&qr(()=>{An&&ys(An,Le,Pe),Sn&&Ll(Pe,null,Le,"unmounted")},ot)},Jt=Pe=>{const{type:Le,el:ot,anchor:xt,transition:gt}=Pe;if(Le===un){Lt(ot,xt);return}if(Le===xp){me(Pe);return}const vt=()=>{f(ot),gt&&!gt.persisted&&gt.afterLeave&&gt.afterLeave()};if(Pe.shapeFlag&1&&gt&&!gt.persisted){const{leave:Bt,delayLeave:It}=gt,Rt=()=>Bt(ot,vt);It?It(Pe.el,vt,Rt):Rt()}else vt()},Lt=(Pe,Le)=>{let ot;for(;Pe!==Le;)ot=O(Pe),f(Pe),Pe=ot;f(Le)},Yt=(Pe,Le,ot)=>{const{bum:xt,scope:gt,job:vt,subTree:Bt,um:It,m:Rt,a:wt}=Pe;cb(Rt),cb(wt),xt&&vp(xt),gt.stop(),vt&&(vt.flags|=8,zt(Bt,Pe,Le,ot)),It&&qr(It,Le),qr(()=>{Pe.isUnmounted=!0},Le),Le&&Le.pendingBranch&&!Le.isUnmounted&&Pe.asyncDep&&!Pe.asyncResolved&&Pe.suspenseId===Le.pendingId&&(Le.deps--,Le.deps===0&&Le.resolve())},qt=(Pe,Le,ot,xt=!1,gt=!1,vt=0)=>{for(let Bt=vt;Bt<Pe.length;Bt++)zt(Pe[Bt],Le,ot,xt,gt)},_n=Pe=>{if(Pe.shapeFlag&6)return _n(Pe.component.subTree);if(Pe.shapeFlag&128)return Pe.suspense.next();const Le=O(Pe.anchor||Pe.el),ot=Le&&Le[A1];return ot?O(ot):Le};let bn=!1;const jn=(Pe,Le,ot)=>{Pe==null?Le._vnode&&zt(Le._vnode,null,null,!0):V(Le._vnode||null,Pe,Le,null,null,null,ot),Le._vnode=Pe,bn||(bn=!0,J0(),I1(),bn=!1)},Nn={p:V,um:zt,m:ct,r:Jt,mt:We,mc:ye,pc:Et,pbc:ke,n:_n,o:e};let si,En;return i&&([si,En]=i(Nn)),{render:jn,hydrate:si,createApp:jP(jn,si)}}function e_({type:e,props:i},l){return l==="svg"&&e==="foreignObject"||l==="mathml"&&e==="annotation-xml"&&i&&i.encoding&&i.encoding.includes("html")?void 0:l}function Bl({effect:e,job:i},l){l?(e.flags|=32,i.flags|=4):(e.flags&=-33,i.flags&=-5)}function JP(e,i){return(!e||e&&!e.pendingBranch)&&i&&!i.persisted}function Cy(e,i,l=!1){const u=e.children,f=i.children;if(gn(u)&&gn(f))for(let g=0;g<u.length;g++){const m=u[g];let o=f[g];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=f[g]=Ho(f[g]),o.el=m.el),!l&&o.patchFlag!==-2&&Cy(m,o)),o.type===Ih&&(o.el=m.el)}}function QP(e){const i=e.slice(),l=[0];let u,f,g,m,o;const T=e.length;for(u=0;u<T;u++){const k=e[u];if(k!==0){if(f=l[l.length-1],e[f]<k){i[u]=f,l.push(u);continue}for(g=0,m=l.length-1;g<m;)o=g+m>>1,e[l[o]]<k?g=o+1:m=o;k<e[l[g]]&&(g>0&&(i[u]=l[g-1]),l[g]=u)}}for(g=l.length,m=l[g-1];g-- >0;)l[g]=m,m=i[m];return l}function rw(e){const i=e.subTree.component;if(i)return i.asyncDep&&!i.asyncResolved?i:rw(i)}function cb(e){if(e)for(let i=0;i<e.length;i++)e[i].flags|=8}const ek=Symbol.for("v-scx"),tk=()=>ri(ek);function Sa(e,i){return Ty(e,null,i)}function en(e,i,l){return Ty(e,i,l)}function Ty(e,i,l=vi){const{immediate:u,deep:f,flush:g,once:m}=l,o=er({},l),T=i&&u||!i&&g!=="post";let k;if(hh){if(g==="sync"){const D=tk();k=D.__watcherHandles||(D.__watcherHandles=[])}else if(!T){const D=()=>{};return D.stop=La,D.resume=La,D.pause=La,D}}const I=xr;o.call=(D,B,V)=>ss(D,I,B,V);let z=!1;g==="post"?o.scheduler=D=>{qr(D,I&&I.suspense)}:g!=="sync"&&(z=!0,o.scheduler=(D,B)=>{B?D():yy(D)}),o.augmentJob=D=>{i&&(D.flags|=4),z&&(D.flags|=2,I&&(D.id=I.uid,D.i=I))};const O=xP(e,i,o);return hh&&(k?k.push(O):T&&O()),O}function nk(e,i,l){const u=this.proxy,f=Oi(e)?e.includes(".")?aw(u,e):()=>u[e]:e.bind(u,u);let g;wn(i)?g=i:(g=i.handler,l=i);const m=Mh(this),o=Ty(f,g.bind(u),l);return m(),o}function aw(e,i){const l=i.split(".");return()=>{let u=e;for(let f=0;f<l.length&&u;f++)u=u[l[f]];return u}}const ik=(e,i)=>i==="modelValue"||i==="model-value"?e.modelModifiers:e[`${i}Modifiers`]||e[`${oa(i)}Modifiers`]||e[`${Jl(i)}Modifiers`];function rk(e,i,...l){if(e.isUnmounted)return;const u=e.vnode.props||vi;let f=l;const g=i.startsWith("update:"),m=g&&ik(u,i.slice(7));m&&(m.trim&&(f=l.map(I=>Oi(I)?I.trim():I)),m.number&&(f=l.map(S_)));let o,T=u[o=qg(i)]||u[o=qg(oa(i))];!T&&g&&(T=u[o=qg(Jl(i))]),T&&ss(T,e,6,f);const k=u[o+"Once"];if(k){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,ss(k,e,6,f)}}function sw(e,i,l=!1){const u=i.emitsCache,f=u.get(e);if(f!==void 0)return f;const g=e.emits;let m={},o=!1;if(!wn(e)){const T=k=>{const I=sw(k,i,!0);I&&(o=!0,er(m,I))};!l&&i.mixins.length&&i.mixins.forEach(T),e.extends&&T(e.extends),e.mixins&&e.mixins.forEach(T)}return!g&&!o?(Ci(e)&&u.set(e,null),null):(gn(g)?g.forEach(T=>m[T]=null):er(m,g),Ci(e)&&u.set(e,m),m)}function pm(e,i){return!e||!im(i)?!1:(i=i.slice(2).replace(/Once$/,""),ii(e,i[0].toLowerCase()+i.slice(1))||ii(e,Jl(i))||ii(e,i))}function t_(e){const{type:i,vnode:l,proxy:u,withProxy:f,propsOptions:[g],slots:m,attrs:o,emit:T,render:k,renderCache:I,props:z,data:O,setupState:D,ctx:B,inheritAttrs:V}=e,Z=Bp(e);let oe,pe;try{if(l.shapeFlag&4){const me=f||u,be=me;oe=ws(k.call(be,me,I,z,D,O,B)),pe=o}else{const me=i;oe=ws(me.length>1?me(z,{attrs:o,slots:m,emit:T}):me(z,null)),pe=i.props?o:ak(o)}}catch(me){ih.length=0,dm(me,e,1),oe=E(Kr)}let Se=oe;if(pe&&V!==!1){const me=Object.keys(pe),{shapeFlag:be}=Se;me.length&&be&7&&(g&&me.some(oy)&&(pe=sk(pe,g)),Se=io(Se,pe,!1,!0))}return l.dirs&&(Se=io(Se,null,!1,!0),Se.dirs=Se.dirs?Se.dirs.concat(l.dirs):l.dirs),l.transition&&Xl(Se,l.transition),oe=Se,Bp(Z),oe}const ak=e=>{let i;for(const l in e)(l==="class"||l==="style"||im(l))&&((i||(i={}))[l]=e[l]);return i},sk=(e,i)=>{const l={};for(const u in e)(!oy(u)||!(u.slice(9)in i))&&(l[u]=e[u]);return l};function ok(e,i,l){const{props:u,children:f,component:g}=e,{props:m,children:o,patchFlag:T}=i,k=g.emitsOptions;if(i.dirs||i.transition)return!0;if(l&&T>=0){if(T&1024)return!0;if(T&16)return u?ub(u,m,k):!!m;if(T&8){const I=i.dynamicProps;for(let z=0;z<I.length;z++){const O=I[z];if(m[O]!==u[O]&&!pm(k,O))return!0}}}else return(f||o)&&(!o||!o.$stable)?!0:u===m?!1:u?m?ub(u,m,k):!0:!!m;return!1}function ub(e,i,l){const u=Object.keys(i);if(u.length!==Object.keys(e).length)return!0;for(let f=0;f<u.length;f++){const g=u[f];if(i[g]!==e[g]&&!pm(l,g))return!0}return!1}function lk({vnode:e,parent:i},l){for(;i;){const u=i.subTree;if(u.suspense&&u.suspense.activeBranch===e&&(u.el=e.el),u===e)(e=i.vnode).el=l,i=i.parent;else break}}const ow=e=>e.__isSuspense;function ck(e,i){i&&i.pendingBranch?gn(e)?i.effects.push(...e):i.effects.push(e):k1(e)}const un=Symbol.for("v-fgt"),Ih=Symbol.for("v-txt"),Kr=Symbol.for("v-cmt"),xp=Symbol.for("v-stc"),ih=[];let xa=null;function Fe(e=!1){ih.push(xa=e?null:[])}function uk(){ih.pop(),xa=ih[ih.length-1]||null}let uh=1;function db(e,i=!1){uh+=e,e<0&&xa&&i&&(xa.hasOnce=!0)}function lw(e){return e.dynamicChildren=uh>0?xa||cu:null,uk(),uh>0&&xa&&xa.push(e),e}function Ot(e,i,l,u,f,g){return lw(Xe(e,i,l,u,f,g,!0))}function ft(e,i,l,u,f){return lw(E(e,i,l,u,f,!0))}function dh(e){return e?e.__v_isVNode===!0:!1}function $l(e,i){return e.type===i.type&&e.key===i.key}const cw=({key:e})=>e??null,wp=({ref:e,ref_key:i,ref_for:l})=>(typeof e=="number"&&(e=""+e),e!=null?Oi(e)||di(e)||wn(e)?{i:Yr,r:e,k:i,f:!!l}:e:null);function Xe(e,i=null,l=null,u=0,f=null,g=e===un?0:1,m=!1,o=!1){const T={__v_isVNode:!0,__v_skip:!0,type:e,props:i,key:i&&cw(i),ref:i&&wp(i),scopeId:E1,slotScopeIds:null,children:l,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:g,patchFlag:u,dynamicProps:f,dynamicChildren:null,appContext:null,ctx:Yr};return o?(Py(T,l),g&128&&e.normalize(T)):l&&(T.shapeFlag|=Oi(l)?8:16),uh>0&&!m&&xa&&(T.patchFlag>0||g&6)&&T.patchFlag!==32&&xa.push(T),T}const E=dk;function dk(e,i=null,l=null,u=0,f=null,g=!1){if((!e||e===H1)&&(e=Kr),dh(e)){const o=io(e,i,!0);return l&&Py(o,l),uh>0&&!g&&xa&&(o.shapeFlag&6?xa[xa.indexOf(e)]=o:xa.push(o)),o.patchFlag=-2,o}if(xk(e)&&(e=e.__vccOpts),i){i=hk(i);let{class:o,style:T}=i;o&&!Oi(o)&&(i.class=om(o)),Ci(T)&&(_y(T)&&!gn(T)&&(T=er({},T)),i.style=uy(T))}const m=Oi(e)?1:ow(e)?128:R1(e)?64:Ci(e)?4:wn(e)?2:0;return Xe(e,i,l,u,f,m,g,!0)}function hk(e){return e?_y(e)||Y1(e)?er({},e):e:null}function io(e,i,l=!1,u=!1){const{props:f,ref:g,patchFlag:m,children:o,transition:T}=e,k=i?an(f||{},i):f,I={__v_isVNode:!0,__v_skip:!0,type:e.type,props:k,key:k&&cw(k),ref:i&&i.ref?l&&g?gn(g)?g.concat(wp(i)):[g,wp(i)]:wp(i):g,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:i&&e.type!==un?m===-1?16:m|16:m,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:T,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&io(e.ssContent),ssFallback:e.ssFallback&&io(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return T&&u&&Xl(I,T.clone(I)),I}function Ne(e=" ",i=0){return E(Ih,null,e,i)}function Mt(e="",i=!1){return i?(Fe(),ft(Kr,null,e)):E(Kr,null,e)}function ws(e){return e==null||typeof e=="boolean"?E(Kr):gn(e)?E(un,null,e.slice()):dh(e)?Ho(e):E(Ih,null,String(e))}function Ho(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:io(e)}function Py(e,i){let l=0;const{shapeFlag:u}=e;if(i==null)i=null;else if(gn(i))l=16;else if(typeof i=="object")if(u&65){const f=i.default;f&&(f._c&&(f._d=!1),Py(e,f()),f._c&&(f._d=!0));return}else{l=32;const f=i._;!f&&!Y1(i)?i._ctx=Yr:f===3&&Yr&&(Yr.slots._===1?i._=1:(i._=2,e.patchFlag|=1024))}else wn(i)?(i={default:i,_ctx:Yr},l=32):(i=String(i),u&64?(l=16,i=[Ne(i)]):l=8);e.children=i,e.shapeFlag|=l}function an(...e){const i={};for(let l=0;l<e.length;l++){const u=e[l];for(const f in u)if(f==="class")i.class!==u.class&&(i.class=om([i.class,u.class]));else if(f==="style")i.style=uy([i.style,u.style]);else if(im(f)){const g=i[f],m=u[f];m&&g!==m&&!(gn(g)&&g.includes(m))&&(i[f]=g?[].concat(g,m):m)}else f!==""&&(i[f]=u[f])}return i}function ys(e,i,l,u=null){ss(e,i,7,[l,u])}const fk=W1();let pk=0;function mk(e,i,l){const u=e.type,f=(i?i.appContext:e.appContext)||fk,g={uid:pk++,vnode:e,type:u,parent:i,appContext:f,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new s1(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:i?i.provides:Object.create(f.provides),ids:i?i.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Q1(u,f),emitsOptions:sw(u,f),emit:null,emitted:null,propsDefaults:vi,inheritAttrs:u.inheritAttrs,ctx:vi,data:vi,props:vi,attrs:vi,slots:vi,refs:vi,setupState:vi,setupContext:null,suspense:l,suspenseId:l?l.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return g.ctx={_:g},g.root=i?i.root:g,g.emit=rk.bind(null,g),e.ce&&e.ce(g),g}let xr=null;const mm=()=>xr||Yr;let Vp,D_;{const e=sm(),i=(l,u)=>{let f;return(f=e[l])||(f=e[l]=[]),f.push(u),g=>{f.length>1?f.forEach(m=>m(g)):f[0](g)}};Vp=i("__VUE_INSTANCE_SETTERS__",l=>xr=l),D_=i("__VUE_SSR_SETTERS__",l=>hh=l)}const Mh=e=>{const i=xr;return Vp(e),e.scope.on(),()=>{e.scope.off(),Vp(i)}},hb=()=>{xr&&xr.scope.off(),Vp(null)};function uw(e){return e.vnode.shapeFlag&4}let hh=!1;function gk(e,i=!1,l=!1){i&&D_(i);const{props:u,children:f}=e.vnode,g=uw(e);GP(e,u,g,i),WP(e,f,l);const m=g?_k(e,i):void 0;return i&&D_(!1),m}function _k(e,i){const l=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,LP);const{setup:u}=l;if(u){Ko();const f=e.setupContext=u.length>1?vk(e):null,g=Mh(e),m=Th(u,e,0,[e.props,f]),o=Qx(m);if(Yo(),g(),(o||e.sp)&&!th(e)&&N1(e),o){if(m.then(hb,hb),i)return m.then(T=>{fb(e,T,i)}).catch(T=>{dm(T,e,0)});e.asyncDep=m}else fb(e,m,i)}else dw(e,i)}function fb(e,i,l){wn(i)?e.type.__ssrInlineRender?e.ssrRender=i:e.render=i:Ci(i)&&(e.setupState=S1(i)),dw(e,l)}let pb;function dw(e,i,l){const u=e.type;if(!e.render){if(!i&&pb&&!u.render){const f=u.template||wy(e).template;if(f){const{isCustomElement:g,compilerOptions:m}=e.appContext.config,{delimiters:o,compilerOptions:T}=u,k=er(er({isCustomElement:g,delimiters:o},m),T);u.render=pb(f,k)}}e.render=u.render||La}{const f=Mh(e);Ko();try{BP(e)}finally{Yo(),f()}}}const yk={get(e,i){return zr(e,"get",""),e[i]}};function vk(e){const i=l=>{e.exposed=l||{}};return{attrs:new Proxy(e.attrs,yk),slots:e.slots,emit:e.emit,expose:i}}function gm(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(S1(cm(e.exposed)),{get(i,l){if(l in i)return i[l];if(l in nh)return nh[l](e)},has(i,l){return l in i||l in nh}})):e.proxy}function bk(e,i=!0){return wn(e)?e.displayName||e.name:e.name||i&&e.__name}function xk(e){return wn(e)&&"__vccOpts"in e}const ce=(e,i)=>vP(e,i,hh);function Jo(e,i,l){const u=arguments.length;return u===2?Ci(i)&&!gn(i)?dh(i)?E(e,null,[i]):E(e,i):E(e,null,i):(u>3?l=Array.prototype.slice.call(arguments,2):u===3&&dh(l)&&(l=[l]),E(e,i,l))}const wk="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let z_;const mb=typeof window<"u"&&window.trustedTypes;if(mb)try{z_=mb.createPolicy("vue",{createHTML:e=>e})}catch{}const hw=z_?e=>z_.createHTML(e):e=>e,Sk="http://www.w3.org/2000/svg",Ck="http://www.w3.org/1998/Math/MathML",Ks=typeof document<"u"?document:null,gb=Ks&&Ks.createElement("template"),Tk={insert:(e,i,l)=>{i.insertBefore(e,l||null)},remove:e=>{const i=e.parentNode;i&&i.removeChild(e)},createElement:(e,i,l,u)=>{const f=i==="svg"?Ks.createElementNS(Sk,e):i==="mathml"?Ks.createElementNS(Ck,e):l?Ks.createElement(e,{is:l}):Ks.createElement(e);return e==="select"&&u&&u.multiple!=null&&f.setAttribute("multiple",u.multiple),f},createText:e=>Ks.createTextNode(e),createComment:e=>Ks.createComment(e),setText:(e,i)=>{e.nodeValue=i},setElementText:(e,i)=>{e.textContent=i},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Ks.querySelector(e),setScopeId(e,i){e.setAttribute(i,"")},insertStaticContent(e,i,l,u,f,g){const m=l?l.previousSibling:i.lastChild;if(f&&(f===g||f.nextSibling))for(;i.insertBefore(f.cloneNode(!0),l),!(f===g||!(f=f.nextSibling)););else{gb.innerHTML=hw(u==="svg"?`<svg>${e}</svg>`:u==="mathml"?`<math>${e}</math>`:e);const o=gb.content;if(u==="svg"||u==="mathml"){const T=o.firstChild;for(;T.firstChild;)o.appendChild(T.firstChild);o.removeChild(T)}i.insertBefore(o,l)}return[m?m.nextSibling:i.firstChild,l?l.previousSibling:i.lastChild]}},No="transition",Hd="animation",fu=Symbol("_vtc"),fw={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},pw=er({},B1,fw),Pk=e=>(e.displayName="Transition",e.props=pw,e),Ts=Pk((e,{slots:i})=>Jo(kP,mw(e),i)),Fl=(e,i=[])=>{gn(e)?e.forEach(l=>l(...i)):e&&e(...i)},_b=e=>e?gn(e)?e.some(i=>i.length>1):e.length>1:!1;function mw(e){const i={};for(const xe in e)xe in fw||(i[xe]=e[xe]);if(e.css===!1)return i;const{name:l="v",type:u,duration:f,enterFromClass:g=`${l}-enter-from`,enterActiveClass:m=`${l}-enter-active`,enterToClass:o=`${l}-enter-to`,appearFromClass:T=g,appearActiveClass:k=m,appearToClass:I=o,leaveFromClass:z=`${l}-leave-from`,leaveActiveClass:O=`${l}-leave-active`,leaveToClass:D=`${l}-leave-to`}=e,B=kk(f),V=B&&B[0],Z=B&&B[1],{onBeforeEnter:oe,onEnter:pe,onEnterCancelled:Se,onLeave:me,onLeaveCancelled:be,onBeforeAppear:he=oe,onAppear:Ce=pe,onAppearCancelled:ye=Se}=i,Me=(xe,Oe,We,dt)=>{xe._enterCancelled=dt,$o(xe,Oe?I:o),$o(xe,Oe?k:m),We&&We()},ke=(xe,Oe)=>{xe._isLeaving=!1,$o(xe,z),$o(xe,D),$o(xe,O),Oe&&Oe()},Ee=xe=>(Oe,We)=>{const dt=xe?Ce:pe,je=()=>Me(Oe,xe,We);Fl(dt,[Oe,je]),yb(()=>{$o(Oe,xe?T:g),bs(Oe,xe?I:o),_b(dt)||vb(Oe,u,V,je)})};return er(i,{onBeforeEnter(xe){Fl(oe,[xe]),bs(xe,g),bs(xe,m)},onBeforeAppear(xe){Fl(he,[xe]),bs(xe,T),bs(xe,k)},onEnter:Ee(!1),onAppear:Ee(!0),onLeave(xe,Oe){xe._isLeaving=!0;const We=()=>ke(xe,Oe);bs(xe,z),xe._enterCancelled?(bs(xe,O),L_()):(L_(),bs(xe,O)),yb(()=>{xe._isLeaving&&($o(xe,z),bs(xe,D),_b(me)||vb(xe,u,Z,We))}),Fl(me,[xe,We])},onEnterCancelled(xe){Me(xe,!1,void 0,!0),Fl(Se,[xe])},onAppearCancelled(xe){Me(xe,!0,void 0,!0),Fl(ye,[xe])},onLeaveCancelled(xe){ke(xe),Fl(be,[xe])}})}function kk(e){if(e==null)return null;if(Ci(e))return[n_(e.enter),n_(e.leave)];{const i=n_(e);return[i,i]}}function n_(e){return $T(e)}function bs(e,i){i.split(/\s+/).forEach(l=>l&&e.classList.add(l)),(e[fu]||(e[fu]=new Set)).add(i)}function $o(e,i){i.split(/\s+/).forEach(u=>u&&e.classList.remove(u));const l=e[fu];l&&(l.delete(i),l.size||(e[fu]=void 0))}function yb(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let Ik=0;function vb(e,i,l,u){const f=e._endId=++Ik,g=()=>{f===e._endId&&u()};if(l!=null)return setTimeout(g,l);const{type:m,timeout:o,propCount:T}=gw(e,i);if(!m)return u();const k=m+"end";let I=0;const z=()=>{e.removeEventListener(k,O),g()},O=D=>{D.target===e&&++I>=T&&z()};setTimeout(()=>{I<T&&z()},o+1),e.addEventListener(k,O)}function gw(e,i){const l=window.getComputedStyle(e),u=B=>(l[B]||"").split(", "),f=u(`${No}Delay`),g=u(`${No}Duration`),m=bb(f,g),o=u(`${Hd}Delay`),T=u(`${Hd}Duration`),k=bb(o,T);let I=null,z=0,O=0;i===No?m>0&&(I=No,z=m,O=g.length):i===Hd?k>0&&(I=Hd,z=k,O=T.length):(z=Math.max(m,k),I=z>0?m>k?No:Hd:null,O=I?I===No?g.length:T.length:0);const D=I===No&&/\b(transform|all)(,|$)/.test(u(`${No}Property`).toString());return{type:I,timeout:z,propCount:O,hasTransform:D}}function bb(e,i){for(;e.length<i.length;)e=e.concat(e);return Math.max(...i.map((l,u)=>xb(l)+xb(e[u])))}function xb(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function L_(){return document.body.offsetHeight}function Mk(e,i,l){const u=e[fu];u&&(i=(i?[i,...u]:[...u]).join(" ")),i==null?e.removeAttribute("class"):l?e.setAttribute("class",i):e.className=i}const Np=Symbol("_vod"),_w=Symbol("_vsh"),Ql={beforeMount(e,{value:i},{transition:l}){e[Np]=e.style.display==="none"?"":e.style.display,l&&i?l.beforeEnter(e):Zd(e,i)},mounted(e,{value:i},{transition:l}){l&&i&&l.enter(e)},updated(e,{value:i,oldValue:l},{transition:u}){!i!=!l&&(u?i?(u.beforeEnter(e),Zd(e,!0),u.enter(e)):u.leave(e,()=>{Zd(e,!1)}):Zd(e,i))},beforeUnmount(e,{value:i}){Zd(e,i)}};function Zd(e,i){e.style.display=i?e[Np]:"none",e[_w]=!i}const yw=Symbol("");function Ek(e){const i=mm();if(!i)return;const l=i.ut=(f=e(i.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${i.uid}"]`)).forEach(g=>$p(g,f))},u=()=>{const f=e(i.proxy);i.ce?$p(i.ce,f):B_(i.subTree,f),l(f)};U1(()=>{k1(u)}),Qn(()=>{en(u,La,{flush:"post"});const f=new MutationObserver(u);f.observe(i.subTree.el.parentNode,{childList:!0}),kh(()=>f.disconnect())})}function B_(e,i){if(e.shapeFlag&128){const l=e.suspense;e=l.activeBranch,l.pendingBranch&&!l.isHydrating&&l.effects.push(()=>{B_(l.activeBranch,i)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)$p(e.el,i);else if(e.type===un)e.children.forEach(l=>B_(l,i));else if(e.type===xp){let{el:l,anchor:u}=e;for(;l&&($p(l,i),l!==u);)l=l.nextSibling}}function $p(e,i){if(e.nodeType===1){const l=e.style;let u="";for(const f in i)l.setProperty(`--${f}`,i[f]),u+=`--${f}: ${i[f]};`;l[yw]=u}}const Ak=/(^|;)\s*display\s*:/;function Rk(e,i,l){const u=e.style,f=Oi(l);let g=!1;if(l&&!f){if(i)if(Oi(i))for(const m of i.split(";")){const o=m.slice(0,m.indexOf(":")).trim();l[o]==null&&Sp(u,o,"")}else for(const m in i)l[m]==null&&Sp(u,m,"");for(const m in l)m==="display"&&(g=!0),Sp(u,m,l[m])}else if(f){if(i!==l){const m=u[yw];m&&(l+=";"+m),u.cssText=l,g=Ak.test(l)}}else i&&e.removeAttribute("style");Np in e&&(e[Np]=g?u.display:"",e[_w]&&(u.display="none"))}const wb=/\s*!important$/;function Sp(e,i,l){if(gn(l))l.forEach(u=>Sp(e,i,u));else if(l==null&&(l=""),i.startsWith("--"))e.setProperty(i,l);else{const u=Dk(e,i);wb.test(l)?e.setProperty(Jl(u),l.replace(wb,""),"important"):e[u]=l}}const Sb=["Webkit","Moz","ms"],i_={};function Dk(e,i){const l=i_[i];if(l)return l;let u=oa(i);if(u!=="filter"&&u in e)return i_[i]=u;u=ao(u);for(let f=0;f<Sb.length;f++){const g=Sb[f]+u;if(g in e)return i_[i]=g}return i}const Cb="http://www.w3.org/1999/xlink";function Tb(e,i,l,u,f,g=qT(i)){u&&i.startsWith("xlink:")?l==null?e.removeAttributeNS(Cb,i.slice(6,i.length)):e.setAttributeNS(Cb,i,l):l==null||g&&!i1(l)?e.removeAttribute(i):e.setAttribute(i,g?"":Xo(l)?String(l):l)}function Pb(e,i,l,u,f){if(i==="innerHTML"||i==="textContent"){l!=null&&(e[i]=i==="innerHTML"?hw(l):l);return}const g=e.tagName;if(i==="value"&&g!=="PROGRESS"&&!g.includes("-")){const o=g==="OPTION"?e.getAttribute("value")||"":e.value,T=l==null?e.type==="checkbox"?"on":"":String(l);(o!==T||!("_value"in e))&&(e.value=T),l==null&&e.removeAttribute(i),e._value=l;return}let m=!1;if(l===""||l==null){const o=typeof e[i];o==="boolean"?l=i1(l):l==null&&o==="string"?(l="",m=!0):o==="number"&&(l=0,m=!0)}try{e[i]=l}catch{}m&&e.removeAttribute(f||i)}function ou(e,i,l,u){e.addEventListener(i,l,u)}function zk(e,i,l,u){e.removeEventListener(i,l,u)}const kb=Symbol("_vei");function Lk(e,i,l,u,f=null){const g=e[kb]||(e[kb]={}),m=g[i];if(u&&m)m.value=u;else{const[o,T]=Bk(i);if(u){const k=g[i]=Vk(u,f);ou(e,o,k,T)}else m&&(zk(e,o,m,T),g[i]=void 0)}}const Ib=/(?:Once|Passive|Capture)$/;function Bk(e){let i;if(Ib.test(e)){i={};let u;for(;u=e.match(Ib);)e=e.slice(0,e.length-u[0].length),i[u[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Jl(e.slice(2)),i]}let r_=0;const Fk=Promise.resolve(),Ok=()=>r_||(Fk.then(()=>r_=0),r_=Date.now());function Vk(e,i){const l=u=>{if(!u._vts)u._vts=Date.now();else if(u._vts<=l.attached)return;ss(Nk(u,l.value),i,5,[u])};return l.value=e,l.attached=Ok(),l}function Nk(e,i){if(gn(i)){const l=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{l.call(e),e._stopped=!0},i.map(u=>f=>!f._stopped&&u&&u(f))}else return i}const Mb=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,$k=(e,i,l,u,f,g)=>{const m=f==="svg";i==="class"?Mk(e,u,m):i==="style"?Rk(e,l,u):im(i)?oy(i)||Lk(e,i,l,u,g):(i[0]==="."?(i=i.slice(1),!0):i[0]==="^"?(i=i.slice(1),!1):jk(e,i,u,m))?(Pb(e,i,u),!e.tagName.includes("-")&&(i==="value"||i==="checked"||i==="selected")&&Tb(e,i,u,m,g,i!=="value")):e._isVueCE&&(/[A-Z]/.test(i)||!Oi(u))?Pb(e,oa(i),u,g,i):(i==="true-value"?e._trueValue=u:i==="false-value"&&(e._falseValue=u),Tb(e,i,u,m))};function jk(e,i,l,u){if(u)return!!(i==="innerHTML"||i==="textContent"||i in e&&Mb(i)&&wn(l));if(i==="spellcheck"||i==="draggable"||i==="translate"||i==="form"||i==="list"&&e.tagName==="INPUT"||i==="type"&&e.tagName==="TEXTAREA")return!1;if(i==="width"||i==="height"){const f=e.tagName;if(f==="IMG"||f==="VIDEO"||f==="CANVAS"||f==="SOURCE")return!1}return Mb(i)&&Oi(l)?!1:i in e}const vw=new WeakMap,bw=new WeakMap,jp=Symbol("_moveCb"),Eb=Symbol("_enterCb"),Uk=e=>(delete e.props.mode,e),Gk=Uk({name:"TransitionGroup",props:er({},pw,{tag:String,moveClass:String}),setup(e,{slots:i}){const l=mm(),u=L1();let f,g;return xy(()=>{if(!f.length)return;const m=e.moveClass||`${e.name||"v"}-move`;if(!Wk(f[0].el,l.vnode.el,m))return;f.forEach(Hk),f.forEach(Zk);const o=f.filter(qk);L_(),o.forEach(T=>{const k=T.el,I=k.style;bs(k,m),I.transform=I.webkitTransform=I.transitionDuration="";const z=k[jp]=O=>{O&&O.target!==k||(!O||/transform$/.test(O.propertyName))&&(k.removeEventListener("transitionend",z),k[jp]=null,$o(k,m))};k.addEventListener("transitionend",z)})}),()=>{const m=fn(e),o=mw(m);let T=m.tag||un;if(f=[],g)for(let k=0;k<g.length;k++){const I=g[k];I.el&&I.el instanceof Element&&(f.push(I),Xl(I,ch(I,o,u,l)),vw.set(I,I.el.getBoundingClientRect()))}g=i.default?vy(i.default()):[];for(let k=0;k<g.length;k++){const I=g[k];I.key!=null&&Xl(I,ch(I,o,u,l))}return E(T,null,g)}}}),ky=Gk;function Hk(e){const i=e.el;i[jp]&&i[jp](),i[Eb]&&i[Eb]()}function Zk(e){bw.set(e,e.el.getBoundingClientRect())}function qk(e){const i=vw.get(e),l=bw.get(e),u=i.left-l.left,f=i.top-l.top;if(u||f){const g=e.el.style;return g.transform=g.webkitTransform=`translate(${u}px,${f}px)`,g.transitionDuration="0s",e}}function Wk(e,i,l){const u=e.cloneNode(),f=e[fu];f&&f.forEach(o=>{o.split(/\s+/).forEach(T=>T&&u.classList.remove(T))}),l.split(/\s+/).forEach(o=>o&&u.classList.add(o)),u.style.display="none";const g=i.nodeType===1?i:i.parentNode;g.appendChild(u);const{hasTransform:m}=gw(u);return g.removeChild(u),m}const Ab=e=>{const i=e.props["onUpdate:modelValue"]||!1;return gn(i)?l=>vp(i,l):i};function Xk(e){e.target.composing=!0}function Rb(e){const i=e.target;i.composing&&(i.composing=!1,i.dispatchEvent(new Event("input")))}const a_=Symbol("_assign"),Kk={created(e,{modifiers:{lazy:i,trim:l,number:u}},f){e[a_]=Ab(f);const g=u||f.props&&f.props.type==="number";ou(e,i?"change":"input",m=>{if(m.target.composing)return;let o=e.value;l&&(o=o.trim()),g&&(o=S_(o)),e[a_](o)}),l&&ou(e,"change",()=>{e.value=e.value.trim()}),i||(ou(e,"compositionstart",Xk),ou(e,"compositionend",Rb),ou(e,"change",Rb))},mounted(e,{value:i}){e.value=i??""},beforeUpdate(e,{value:i,oldValue:l,modifiers:{lazy:u,trim:f,number:g}},m){if(e[a_]=Ab(m),e.composing)return;const o=(g||e.type==="number")&&!/^0\d/.test(e.value)?S_(e.value):e.value,T=i??"";o!==T&&(document.activeElement===e&&e.type!=="range"&&(u&&i===l||f&&e.value.trim()===T)||(e.value=T))}},Yk=er({patchProp:$k},Tk);let Db;function Jk(){return Db||(Db=KP(Yk))}const Qk=(...e)=>{const i=Jk().createApp(...e),{mount:l}=i;return i.mount=u=>{const f=tI(u);if(!f)return;const g=i._component;!wn(g)&&!g.render&&!g.template&&(g.template=f.innerHTML),f.nodeType===1&&(f.textContent="");const m=l(f,!1,eI(f));return f instanceof Element&&(f.removeAttribute("v-cloak"),f.setAttribute("data-v-app","")),m},i};function eI(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function tI(e){return Oi(e)?document.querySelector(e):e}var nI=!1;/*!
 * pinia v2.3.0
 * (c) 2024 Eduardo San Martin Morote
 * @license MIT
 */let xw;const _m=e=>xw=e,ww=Symbol();function F_(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var rh;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(rh||(rh={}));function Sw(){const e=Sh(!0),i=e.run(()=>Ke({}));let l=[],u=[];const f=cm({install(g){_m(f),f._a=g,g.provide(ww,f),g.config.globalProperties.$pinia=f,u.forEach(m=>l.push(m)),u=[]},use(g){return!this._a&&!nI?u.push(g):l.push(g),this},_p:l,_a:null,_e:e,_s:new Map,state:i});return f}const Cw=()=>{};function zb(e,i,l,u=Cw){e.push(i);const f=()=>{const g=e.indexOf(i);g>-1&&(e.splice(g,1),u())};return!l&&o1()&&kr(f),f}function tu(e,...i){e.slice().forEach(l=>{l(...i)})}const iI=e=>e(),Lb=Symbol(),s_=Symbol();function O_(e,i){e instanceof Map&&i instanceof Map?i.forEach((l,u)=>e.set(u,l)):e instanceof Set&&i instanceof Set&&i.forEach(e.add,e);for(const l in i){if(!i.hasOwnProperty(l))continue;const u=i[l],f=e[l];F_(f)&&F_(u)&&e.hasOwnProperty(l)&&!di(u)&&!qo(u)?e[l]=O_(f,u):e[l]=u}return e}const rI=Symbol();function aI(e){return!F_(e)||!e.hasOwnProperty(rI)}const{assign:jo}=Object;function sI(e){return!!(di(e)&&e.effect)}function oI(e,i,l,u){const{state:f,actions:g,getters:m}=i,o=l.state.value[e];let T;function k(){o||(l.state.value[e]=f?f():{});const I=um(l.state.value[e]);return jo(I,g,Object.keys(m||{}).reduce((z,O)=>(z[O]=cm(ce(()=>{_m(l);const D=l._s.get(e);return m[O].call(D,D)})),z),{}))}return T=Tw(e,k,i,l,u,!0),T}function Tw(e,i,l={},u,f,g){let m;const o=jo({actions:{}},l),T={deep:!0};let k,I,z=[],O=[],D;const B=u.state.value[e];!g&&!B&&(u.state.value[e]={}),Ke({});let V;function Z(ye){let Me;k=I=!1,typeof ye=="function"?(ye(u.state.value[e]),Me={type:rh.patchFunction,storeId:e,events:D}):(O_(u.state.value[e],ye),Me={type:rh.patchObject,payload:ye,storeId:e,events:D});const ke=V=Symbol();Fi().then(()=>{V===ke&&(k=!0)}),I=!0,tu(z,Me,u.state.value[e])}const oe=g?function(){const{state:Me}=l,ke=Me?Me():{};this.$patch(Ee=>{jo(Ee,ke)})}:Cw;function pe(){m.stop(),z=[],O=[],u._s.delete(e)}const Se=(ye,Me="")=>{if(Lb in ye)return ye[s_]=Me,ye;const ke=function(){_m(u);const Ee=Array.from(arguments),xe=[],Oe=[];function We(tt){xe.push(tt)}function dt(tt){Oe.push(tt)}tu(O,{args:Ee,name:ke[s_],store:be,after:We,onError:dt});let je;try{je=ye.apply(this&&this.$id===e?this:be,Ee)}catch(tt){throw tu(Oe,tt),tt}return je instanceof Promise?je.then(tt=>(tu(xe,tt),tt)).catch(tt=>(tu(Oe,tt),Promise.reject(tt))):(tu(xe,je),je)};return ke[Lb]=!0,ke[s_]=Me,ke},me={_p:u,$id:e,$onAction:zb.bind(null,O),$patch:Z,$reset:oe,$subscribe(ye,Me={}){const ke=zb(z,ye,Me.detached,()=>Ee()),Ee=m.run(()=>en(()=>u.state.value[e],xe=>{(Me.flush==="sync"?I:k)&&ye({storeId:e,type:rh.direct,events:D},xe)},jo({},T,Me)));return ke},$dispose:pe},be=br(me);u._s.set(e,be);const Ce=(u._a&&u._a.runWithContext||iI)(()=>u._e.run(()=>(m=Sh()).run(()=>i({action:Se}))));for(const ye in Ce){const Me=Ce[ye];if(di(Me)&&!sI(Me)||qo(Me))g||(B&&aI(Me)&&(di(Me)?Me.value=B[ye]:O_(Me,B[ye])),u.state.value[e][ye]=Me);else if(typeof Me=="function"){const ke=Se(Me,ye);Ce[ye]=ke,o.actions[ye]=Me}}return jo(be,Ce),jo(fn(be),Ce),Object.defineProperty(be,"$state",{get:()=>u.state.value[e],set:ye=>{Z(Me=>{jo(Me,ye)})}}),u._p.forEach(ye=>{jo(be,m.run(()=>ye({store:be,app:u._a,pinia:u,options:o})))}),B&&g&&l.hydrate&&l.hydrate(be.$state,B),k=!0,I=!0,be}/*! #__NO_SIDE_EFFECTS__ */function lI(e,i,l){let u,f;const g=typeof i=="function";typeof e=="string"?(u=e,f=g?l:i):(f=e,u=e.id);function m(o,T){const k=UP();return o=o||(k?ri(ww,null):null),o&&_m(o),o=xw,o._s.has(u)||(g?Tw(u,i,f,o):oI(u,f,o)),o._s.get(u)}return m.$id=u,m}const ei=lI("global",{state:()=>({appIsOpen:!1,hudIsOpen:!1,currentPage:"racing",currentTab:"current",showOnlyCurated:!0,activeRace:{},activeHudData:{},countdown:-1,buttons:{},creatorData:{},baseData:{},isLoadingBaseData:!0,settings:{},tracks:[],races:[],results:{},myCrew:{},notification:void 0,bounties:[],showCryptoModal:!1,head2headData:{}})}),ne=e=>{var l,u;return((u=(l=ei().baseData.data)==null?void 0:l.translations)==null?void 0:u[e])||e};const Wn=typeof window<"u",Iy=Wn&&"IntersectionObserver"in window,cI=Wn&&("ontouchstart"in window||window.navigator.maxTouchPoints>0);function Bb(e,i,l){uI(e,i),i.set(e,l)}function uI(e,i){if(i.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dI(e,i,l){return e.set(Pw(e,i),l),l}function Ol(e,i){return e.get(Pw(e,i))}function Pw(e,i,l){if(typeof e=="function"?e===i:e.has(i))return arguments.length<3?i:l;throw new TypeError("Private element is not present on this object")}function kw(e,i,l){const u=i.length-1;if(u<0)return e===void 0?l:e;for(let f=0;f<u;f++){if(e==null)return l;e=e[i[f]]}return e==null||e[i[u]]===void 0?l:e[i[u]]}function _u(e,i){if(e===i)return!0;if(e instanceof Date&&i instanceof Date&&e.getTime()!==i.getTime()||e!==Object(e)||i!==Object(i))return!1;const l=Object.keys(e);return l.length!==Object.keys(i).length?!1:l.every(u=>_u(e[u],i[u]))}function V_(e,i,l){return e==null||!i||typeof i!="string"?l:e[i]!==void 0?e[i]:(i=i.replace(/\[(\w+)\]/g,".$1"),i=i.replace(/^\./,""),kw(e,i.split("."),l))}function eo(e,i,l){if(i===!0)return e===void 0?l:e;if(i==null||typeof i=="boolean")return l;if(e!==Object(e)){if(typeof i!="function")return l;const f=i(e,l);return typeof f>"u"?l:f}if(typeof i=="string")return V_(e,i,l);if(Array.isArray(i))return kw(e,i,l);if(typeof i!="function")return l;const u=i(e,l);return typeof u>"u"?l:u}function Iw(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Array.from({length:e},(l,u)=>i+u)}function mn(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"px";if(!(e==null||e===""))return isNaN(+e)?String(e):isFinite(+e)?`${Number(e)}${i}`:void 0}function My(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function Fb(e){let i;return e!==null&&typeof e=="object"&&((i=Object.getPrototypeOf(e))===Object.prototype||i===null)}function Ey(e){if(e&&"$el"in e){const i=e.$el;return(i==null?void 0:i.nodeType)===Node.TEXT_NODE?i.nextElementSibling:i}return e}const Ob=Object.freeze({enter:13,tab:9,delete:46,esc:27,space:32,up:38,down:40,left:37,right:39,end:35,home:36,del:46,backspace:8,insert:45,pageup:33,pagedown:34,shift:16});function Mw(e){return Object.keys(e)}function o_(e,i){return i.every(l=>e.hasOwnProperty(l))}function Ew(e,i){const l={},u=new Set(Object.keys(e));for(const f of i)u.has(f)&&(l[f]=e[f]);return l}function Vb(e,i,l){const u=Object.create(null),f=Object.create(null);for(const g in e)i.some(m=>m instanceof RegExp?m.test(g):m===g)&&!(l!=null&&l.some(m=>m===g))?u[g]=e[g]:f[g]=e[g];return[u,f]}function Ps(e,i){const l={...e};return i.forEach(u=>delete l[u]),l}function hI(e,i){const l={};return i.forEach(u=>l[u]=e[u]),l}const Aw=/^on[^a-z]/,Ay=e=>Aw.test(e),fI=["onAfterscriptexecute","onAnimationcancel","onAnimationend","onAnimationiteration","onAnimationstart","onAuxclick","onBeforeinput","onBeforescriptexecute","onChange","onClick","onCompositionend","onCompositionstart","onCompositionupdate","onContextmenu","onCopy","onCut","onDblclick","onFocusin","onFocusout","onFullscreenchange","onFullscreenerror","onGesturechange","onGestureend","onGesturestart","onGotpointercapture","onInput","onKeydown","onKeypress","onKeyup","onLostpointercapture","onMousedown","onMousemove","onMouseout","onMouseover","onMouseup","onMousewheel","onPaste","onPointercancel","onPointerdown","onPointerenter","onPointerleave","onPointermove","onPointerout","onPointerover","onPointerup","onReset","onSelect","onSubmit","onTouchcancel","onTouchend","onTouchmove","onTouchstart","onTransitioncancel","onTransitionend","onTransitionrun","onTransitionstart","onWheel"];function ym(e){const[i,l]=Vb(e,[Aw]),u=Ps(i,fI),[f,g]=Vb(l,["class","style","id",/^data-/]);return Object.assign(f,i),Object.assign(g,u),[f,g]}function rs(e){return e==null?[]:Array.isArray(e)?e:[e]}function pI(e,i){let l=0;const u=function(){for(var f=arguments.length,g=new Array(f),m=0;m<f;m++)g[m]=arguments[m];clearTimeout(l),l=setTimeout(()=>e(...g),U(i))};return u.clear=()=>{clearTimeout(l)},u.immediate=e,u}function Cs(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.max(i,Math.min(l,e))}function Nb(e,i){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0";return e+l.repeat(Math.max(0,i-e.length))}function $b(e,i){return(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0").repeat(Math.max(0,i-e.length))+e}function mI(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const l=[];let u=0;for(;u<e.length;)l.push(e.substr(u,i)),u+=i;return l}function Fr(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=arguments.length>2?arguments[2]:void 0;const u={};for(const f in e)u[f]=e[f];for(const f in i){const g=e[f],m=i[f];if(Fb(g)&&Fb(m)){u[f]=Fr(g,m,l);continue}if(l&&Array.isArray(g)&&Array.isArray(m)){u[f]=l(g,m);continue}u[f]=m}return u}function Rw(e){return e.map(i=>i.type===un?Rw(i.children):i).flat()}function Zl(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(Zl.cache.has(e))return Zl.cache.get(e);const i=e.replace(/[^a-z]/gi,"-").replace(/\B([A-Z])/g,"-$1").toLowerCase();return Zl.cache.set(e,i),i}Zl.cache=new Map;function lu(e,i){if(!i||typeof i!="object")return[];if(Array.isArray(i))return i.map(l=>lu(e,l)).flat(1);if(i.suspense)return lu(e,i.ssContent);if(Array.isArray(i.children))return i.children.map(l=>lu(e,l)).flat(1);if(i.component){if(Object.getOwnPropertySymbols(i.component.provides).includes(e))return[i.component];if(i.component.subTree)return lu(e,i.component.subTree).flat(1)}return[]}var hp=new WeakMap,nu=new WeakMap;class gI{constructor(i){Bb(this,hp,[]),Bb(this,nu,0),this.size=i}push(i){Ol(hp,this)[Ol(nu,this)]=i,dI(nu,this,(Ol(nu,this)+1)%this.size)}values(){return Ol(hp,this).slice(Ol(nu,this)).concat(Ol(hp,this).slice(0,Ol(nu,this)))}}function Ry(e){const i=br({}),l=ce(e);return Sa(()=>{for(const u in l.value)i[u]=l.value[u]},{flush:"sync"}),um(i)}function Up(e,i){return e.includes(i)}function Dw(e){return e[2].toLowerCase()+e.slice(3)}const sa=()=>[Function,Array];function jb(e,i){return i="on"+ao(i),!!(e[i]||e[`${i}Once`]||e[`${i}Capture`]||e[`${i}OnceCapture`]||e[`${i}CaptureOnce`])}function zw(e){for(var i=arguments.length,l=new Array(i>1?i-1:0),u=1;u<i;u++)l[u-1]=arguments[u];if(Array.isArray(e))for(const f of e)f(...l);else typeof e=="function"&&e(...l)}function fh(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const l=["button","[href]",'input:not([type="hidden"])',"select","textarea","[tabindex]"].map(u=>`${u}${i?':not([tabindex="-1"])':""}:not([disabled])`).join(", ");return[...e.querySelectorAll(l)]}function Lw(e,i,l){let u,f=e.indexOf(document.activeElement);const g=i==="next"?1:-1;do f+=g,u=e[f];while((!u||u.offsetParent==null||!((l==null?void 0:l(u))??!0))&&f<e.length&&f>=0);return u}function ah(e,i){var u,f,g,m;const l=fh(e);if(!i)(e===document.activeElement||!e.contains(document.activeElement))&&((u=l[0])==null||u.focus());else if(i==="first")(f=l[0])==null||f.focus();else if(i==="last")(g=l.at(-1))==null||g.focus();else if(typeof i=="number")(m=l[i])==null||m.focus();else{const o=Lw(l,i);o?o.focus():ah(e,i==="next"?"first":"last")}}function Gp(e,i){if(!(Wn&&typeof CSS<"u"&&typeof CSS.supports<"u"&&CSS.supports(`selector(${i})`)))return null;try{return!!e&&e.matches(i)}catch{return null}}function Bw(e){return e.some(i=>dh(i)?i.type===Kr?!1:i.type!==un||Bw(i.children):!0)?e:null}function _I(e,i){if(!Wn||e===0)return i(),()=>{};const l=window.setTimeout(i,e);return()=>window.clearTimeout(l)}function yI(e,i){const l=e.clientX,u=e.clientY,f=i.getBoundingClientRect(),g=f.left,m=f.top,o=f.right,T=f.bottom;return l>=g&&l<=o&&u>=m&&u<=T}function N_(){const e=ln(),i=l=>{e.value=l};return Object.defineProperty(i,"value",{enumerable:!0,get:()=>e.value,set:l=>e.value=l}),Object.defineProperty(i,"el",{enumerable:!0,get:()=>Ey(e.value)}),i}function Ub(e){const i=e.key.length===1,l=!e.ctrlKey&&!e.metaKey&&!e.altKey;return i&&l}const Fw=["top","bottom"],vI=["start","end","left","right"];function $_(e,i){let[l,u]=e.split(" ");return u||(u=Up(Fw,l)?"start":Up(vI,l)?"top":"center"),{side:j_(l,i),align:j_(u,i)}}function j_(e,i){return e==="start"?i?"right":"left":e==="end"?i?"left":"right":e}function l_(e){return{side:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[e.side],align:e.align}}function c_(e){return{side:e.side,align:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[e.align]}}function Gb(e){return{side:e.align,align:e.side}}function Hb(e){return Up(Fw,e.side)?"y":"x"}class ql{constructor(i){let{x:l,y:u,width:f,height:g}=i;this.x=l,this.y=u,this.width=f,this.height=g}get top(){return this.y}get bottom(){return this.y+this.height}get left(){return this.x}get right(){return this.x+this.width}}function Zb(e,i){return{x:{before:Math.max(0,i.left-e.left),after:Math.max(0,e.right-i.right)},y:{before:Math.max(0,i.top-e.top),after:Math.max(0,e.bottom-i.bottom)}}}function Ow(e){return Array.isArray(e)?new ql({x:e[0],y:e[1],width:0,height:0}):e.getBoundingClientRect()}function Dy(e){const i=e.getBoundingClientRect(),l=getComputedStyle(e),u=l.transform;if(u){let f,g,m,o,T;if(u.startsWith("matrix3d("))f=u.slice(9,-1).split(/, /),g=+f[0],m=+f[5],o=+f[12],T=+f[13];else if(u.startsWith("matrix("))f=u.slice(7,-1).split(/, /),g=+f[0],m=+f[3],o=+f[4],T=+f[5];else return new ql(i);const k=l.transformOrigin,I=i.x-o-(1-g)*parseFloat(k),z=i.y-T-(1-m)*parseFloat(k.slice(k.indexOf(" ")+1)),O=g?i.width/g:e.offsetWidth+1,D=m?i.height/m:e.offsetHeight+1;return new ql({x:I,y:z,width:O,height:D})}else return new ql(i)}function jl(e,i,l){if(typeof e.animate>"u")return{finished:Promise.resolve()};let u;try{u=e.animate(i,l)}catch{return{finished:Promise.resolve()}}return typeof u.finished>"u"&&(u.finished=new Promise(f=>{u.onfinish=()=>{f(u)}})),u}const Cp=new WeakMap;function bI(e,i){Object.keys(i).forEach(l=>{if(Ay(l)){const u=Dw(l),f=Cp.get(e);if(i[l]==null)f==null||f.forEach(g=>{const[m,o]=g;m===u&&(e.removeEventListener(u,o),f.delete(g))});else if(!f||![...f].some(g=>g[0]===u&&g[1]===i[l])){e.addEventListener(u,i[l]);const g=f||new Set;g.add([u,i[l]]),Cp.has(e)||Cp.set(e,g)}}else i[l]==null?e.removeAttribute(l):e.setAttribute(l,i[l])})}function xI(e,i){Object.keys(i).forEach(l=>{if(Ay(l)){const u=Dw(l),f=Cp.get(e);f==null||f.forEach(g=>{const[m,o]=g;m===u&&(e.removeEventListener(u,o),f.delete(g))})}else e.removeAttribute(l)})}const iu=2.4,qb=.2126729,Wb=.7151522,Xb=.072175,wI=.55,SI=.58,CI=.57,TI=.62,fp=.03,Kb=1.45,PI=5e-4,kI=1.25,II=1.25,Yb=.078,Jb=12.82051282051282,pp=.06,Qb=.001;function ex(e,i){const l=(e.r/255)**iu,u=(e.g/255)**iu,f=(e.b/255)**iu,g=(i.r/255)**iu,m=(i.g/255)**iu,o=(i.b/255)**iu;let T=l*qb+u*Wb+f*Xb,k=g*qb+m*Wb+o*Xb;if(T<=fp&&(T+=(fp-T)**Kb),k<=fp&&(k+=(fp-k)**Kb),Math.abs(k-T)<PI)return 0;let I;if(k>T){const z=(k**wI-T**SI)*kI;I=z<Qb?0:z<Yb?z-z*Jb*pp:z-pp}else{const z=(k**TI-T**CI)*II;I=z>-Qb?0:z>-Yb?z-z*Jb*pp:z+pp}return I*100}function MI(e,i){i=Array.isArray(i)?i.slice(0,-1).map(l=>`'${l}'`).join(", ")+` or '${i.at(-1)}'`:`'${i}'`}const Hp=.20689655172413793,EI=e=>e>Hp**3?Math.cbrt(e):e/(3*Hp**2)+4/29,AI=e=>e>Hp?e**3:3*Hp**2*(e-4/29);function Vw(e){const i=EI,l=i(e[1]);return[116*l-16,500*(i(e[0]/.95047)-l),200*(l-i(e[2]/1.08883))]}function Nw(e){const i=AI,l=(e[0]+16)/116;return[i(l+e[1]/500)*.95047,i(l),i(l-e[2]/200)*1.08883]}const RI=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]],DI=e=>e<=.0031308?e*12.92:1.055*e**(1/2.4)-.055,zI=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],LI=e=>e<=.04045?e/12.92:((e+.055)/1.055)**2.4;function $w(e){const i=Array(3),l=DI,u=RI;for(let f=0;f<3;++f)i[f]=Math.round(Cs(l(u[f][0]*e[0]+u[f][1]*e[1]+u[f][2]*e[2]))*255);return{r:i[0],g:i[1],b:i[2]}}function zy(e){let{r:i,g:l,b:u}=e;const f=[0,0,0],g=LI,m=zI;i=g(i/255),l=g(l/255),u=g(u/255);for(let o=0;o<3;++o)f[o]=m[o][0]*i+m[o][1]*l+m[o][2]*u;return f}function U_(e){return!!e&&/^(#|var\(--|(rgb|hsl)a?\()/.test(e)}function BI(e){return U_(e)&&!/^((rgb|hsl)a?\()?var\(--/.test(e)}const tx=/^(?<fn>(?:rgb|hsl)a?)\((?<values>.+)\)/,FI={rgb:(e,i,l,u)=>({r:e,g:i,b:l,a:u}),rgba:(e,i,l,u)=>({r:e,g:i,b:l,a:u}),hsl:(e,i,l,u)=>nx({h:e,s:i,l,a:u}),hsla:(e,i,l,u)=>nx({h:e,s:i,l,a:u}),hsv:(e,i,l,u)=>ph({h:e,s:i,v:l,a:u}),hsva:(e,i,l,u)=>ph({h:e,s:i,v:l,a:u})};function Ss(e){if(typeof e=="number")return{r:(e&16711680)>>16,g:(e&65280)>>8,b:e&255};if(typeof e=="string"&&tx.test(e)){const{groups:i}=e.match(tx),{fn:l,values:u}=i,f=u.split(/,\s*/).map(g=>g.endsWith("%")&&["hsl","hsla","hsv","hsva"].includes(l)?parseFloat(g)/100:parseFloat(g));return FI[l](...f)}else if(typeof e=="string"){let i=e.startsWith("#")?e.slice(1):e;return[3,4].includes(i.length)?i=i.split("").map(l=>l+l).join(""):[6,8].includes(i.length),VI(i)}else if(typeof e=="object"){if(o_(e,["r","g","b"]))return e;if(o_(e,["h","s","l"]))return ph(jw(e));if(o_(e,["h","s","v"]))return ph(e)}throw new TypeError(`Invalid color: ${e==null?e:String(e)||e.constructor.name}
Expected #hex, #hexa, rgb(), rgba(), hsl(), hsla(), object or number`)}function ph(e){const{h:i,s:l,v:u,a:f}=e,g=o=>{const T=(o+i/60)%6;return u-u*l*Math.max(Math.min(T,4-T,1),0)},m=[g(5),g(3),g(1)].map(o=>Math.round(o*255));return{r:m[0],g:m[1],b:m[2],a:f}}function nx(e){return ph(jw(e))}function jw(e){const{h:i,s:l,l:u,a:f}=e,g=u+l*Math.min(u,1-u),m=g===0?0:2-2*u/g;return{h:i,s:m,v:g,a:f}}function mp(e){const i=Math.round(e).toString(16);return("00".substr(0,2-i.length)+i).toUpperCase()}function OI(e){let{r:i,g:l,b:u,a:f}=e;return`#${[mp(i),mp(l),mp(u),f!==void 0?mp(Math.round(f*255)):""].join("")}`}function VI(e){e=NI(e);let[i,l,u,f]=mI(e,2).map(g=>parseInt(g,16));return f=f===void 0?f:f/255,{r:i,g:l,b:u,a:f}}function NI(e){return e.startsWith("#")&&(e=e.slice(1)),e=e.replace(/([^0-9a-f])/gi,"F"),(e.length===3||e.length===4)&&(e=e.split("").map(i=>i+i).join("")),e.length!==6&&(e=Nb(Nb(e,6),8,"F")),e}function $I(e,i){const l=Vw(zy(e));return l[0]=l[0]+i*10,$w(Nw(l))}function jI(e,i){const l=Vw(zy(e));return l[0]=l[0]-i*10,$w(Nw(l))}function UI(e){const i=Ss(e);return zy(i)[1]}function Uw(e){const i=Math.abs(ex(Ss(0),Ss(e)));return Math.abs(ex(Ss(16777215),Ss(e)))>Math.min(i,50)?"#fff":"#000"}function Ct(e,i){return l=>Object.keys(e).reduce((u,f)=>{const m=typeof e[f]=="object"&&e[f]!=null&&!Array.isArray(e[f])?e[f]:{type:e[f]};return l&&f in l?u[f]={...m,default:l[f]}:u[f]=m,i&&!u[f].source&&(u[f].source=i),u},{})}const xn=Ct({class:[String,Array,Object],style:{type:[String,Array,Object],default:null}},"component");function Gi(e,i){const l=mm();if(!l)throw new Error(`[Vuetify] ${e} ${i||"must be called from inside a setup function"}`);return l}function ks(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"composables";const i=Gi(e).type;return Zl((i==null?void 0:i.aliasName)||(i==null?void 0:i.name))}let Gw=0,Tp=new WeakMap;function Ca(){const e=Gi("getUid");if(Tp.has(e))return Tp.get(e);{const i=Gw++;return Tp.set(e,i),i}}Ca.reset=()=>{Gw=0,Tp=new WeakMap};function GI(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Gi("injectSelf");const{provides:l}=i;if(l&&e in l)return l[e]}const pu=Symbol.for("vuetify:defaults");function HI(e){return Ke(e)}function Ly(){const e=ri(pu);if(!e)throw new Error("[Vuetify] Could not find defaults instance");return e}function Qo(e,i){const l=Ly(),u=Ke(e),f=ce(()=>{if(U(i==null?void 0:i.disabled))return l.value;const m=U(i==null?void 0:i.scoped),o=U(i==null?void 0:i.reset),T=U(i==null?void 0:i.root);if(u.value==null&&!(m||o||T))return l.value;let k=Fr(u.value,{prev:l.value});if(m)return k;if(o||T){const I=Number(o||1/0);for(let z=0;z<=I&&!(!k||!("prev"in k));z++)k=k.prev;return k&&typeof T=="string"&&T in k&&(k=Fr(Fr(k,{prev:k}),k[T])),k}return k.prev?Fr(k.prev,k):k});return Mr(pu,f),f}function ZI(e,i){var l,u;return typeof((l=e.props)==null?void 0:l[i])<"u"||typeof((u=e.props)==null?void 0:u[Zl(i)])<"u"}function qI(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ly();const u=Gi("useDefaults");if(i=i??u.type.name??u.type.__name,!i)throw new Error("[Vuetify] Could not determine component name");const f=ce(()=>{var T;return(T=l.value)==null?void 0:T[e._as??i]}),g=new Proxy(e,{get(T,k){var z,O,D,B,V,Z,oe;const I=Reflect.get(T,k);return k==="class"||k==="style"?[(z=f.value)==null?void 0:z[k],I].filter(pe=>pe!=null):typeof k=="string"&&!ZI(u.vnode,k)?((O=f.value)==null?void 0:O[k])!==void 0?(D=f.value)==null?void 0:D[k]:((V=(B=l.value)==null?void 0:B.global)==null?void 0:V[k])!==void 0?(oe=(Z=l.value)==null?void 0:Z.global)==null?void 0:oe[k]:I:I}}),m=ln();Sa(()=>{if(f.value){const T=Object.entries(f.value).filter(k=>{let[I]=k;return I.startsWith(I[0].toUpperCase())});m.value=T.length?Object.fromEntries(T):void 0}else m.value=void 0});function o(){const T=GI(pu,u);Mr(pu,ce(()=>m.value?Fr((T==null?void 0:T.value)??{},m.value):T==null?void 0:T.value))}return{props:g,provideSubDefaults:o}}function yu(e){if(e._setup=e._setup??e.setup,!e.name)return e;if(e._setup){e.props=Ct(e.props??{},e.name)();const i=Object.keys(e.props).filter(l=>l!=="class"&&l!=="style");e.filterProps=function(u){return Ew(u,i)},e.props._as=String,e.setup=function(u,f){const g=Ly();if(!g.value)return e._setup(u,f);const{props:m,provideSubDefaults:o}=qI(u,u._as??e.name,g),T=e._setup(m,f);return o(),T}}return e}function Wt(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return i=>(e?yu:Vn)(i)}function vm(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"div",l=arguments.length>2?arguments[2]:void 0;return Wt()({name:l??ao(oa(e.replace(/__/g,"-"))),props:{tag:{type:String,default:i},...xn()},setup(u,f){let{slots:g}=f;return()=>{var m;return Jo(u.tag,{class:[e,u.class],style:u.style},(m=g.default)==null?void 0:m.call(g))}}})}function Hw(e){if(typeof e.getRootNode!="function"){for(;e.parentNode;)e=e.parentNode;return e!==document?null:document}const i=e.getRootNode();return i!==document&&i.getRootNode({composed:!0})!==document?null:i}const mh="cubic-bezier(0.4, 0, 0.2, 1)",WI="cubic-bezier(0.0, 0, 0.2, 1)",XI="cubic-bezier(0.4, 0, 1, 1)";function Zw(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;for(;e;){if(i?KI(e):By(e))return e;e=e.parentElement}return document.scrollingElement}function Zp(e,i){const l=[];if(i&&e&&!i.contains(e))return l;for(;e&&(By(e)&&l.push(e),e!==i);)e=e.parentElement;return l}function By(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const i=window.getComputedStyle(e);return i.overflowY==="scroll"||i.overflowY==="auto"&&e.scrollHeight>e.clientHeight}function KI(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const i=window.getComputedStyle(e);return["scroll","auto"].includes(i.overflowY)}function YI(e){for(;e;){if(window.getComputedStyle(e).position==="fixed")return!0;e=e.offsetParent}return!1}function hn(e){const i=Gi("useRender");i.render=e}const JI=Ct({disabled:Boolean,group:Boolean,hideOnLeave:Boolean,leaveAbsolute:Boolean,mode:String,origin:String},"transition");function Ta(e,i,l){return Wt()({name:e,props:JI({mode:l,origin:i}),setup(u,f){let{slots:g}=f;const m={onBeforeEnter(o){u.origin&&(o.style.transformOrigin=u.origin)},onLeave(o){if(u.leaveAbsolute){const{offsetTop:T,offsetLeft:k,offsetWidth:I,offsetHeight:z}=o;o._transitionInitialStyles={position:o.style.position,top:o.style.top,left:o.style.left,width:o.style.width,height:o.style.height},o.style.position="absolute",o.style.top=`${T}px`,o.style.left=`${k}px`,o.style.width=`${I}px`,o.style.height=`${z}px`}u.hideOnLeave&&o.style.setProperty("display","none","important")},onAfterLeave(o){if(u.leaveAbsolute&&(o!=null&&o._transitionInitialStyles)){const{position:T,top:k,left:I,width:z,height:O}=o._transitionInitialStyles;delete o._transitionInitialStyles,o.style.position=T||"",o.style.top=k||"",o.style.left=I||"",o.style.width=z||"",o.style.height=O||""}}};return()=>{const o=u.group?ky:Ts;return Jo(o,{name:u.disabled?"":e,css:!u.disabled,...u.group?void 0:{mode:u.mode},...u.disabled?{}:m},g.default)}}})}function qw(e,i){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"in-out";return Wt()({name:e,props:{mode:{type:String,default:l},disabled:Boolean,group:Boolean},setup(u,f){let{slots:g}=f;const m=u.group?ky:Ts;return()=>Jo(m,{name:u.disabled?"":e,css:!u.disabled,...u.disabled?{}:i},g.default)}})}function Ww(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const l=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?"width":"height",u=oa(`offset-${l}`);return{onBeforeEnter(m){m._parent=m.parentNode,m._initialStyle={transition:m.style.transition,overflow:m.style.overflow,[l]:m.style[l]}},onEnter(m){const o=m._initialStyle;m.style.setProperty("transition","none","important"),m.style.overflow="hidden";const T=`${m[u]}px`;m.style[l]="0",m.offsetHeight,m.style.transition=o.transition,e&&m._parent&&m._parent.classList.add(e),requestAnimationFrame(()=>{m.style[l]=T})},onAfterEnter:g,onEnterCancelled:g,onLeave(m){m._initialStyle={transition:"",overflow:m.style.overflow,[l]:m.style[l]},m.style.overflow="hidden",m.style[l]=`${m[u]}px`,m.offsetHeight,requestAnimationFrame(()=>m.style[l]="0")},onAfterLeave:f,onLeaveCancelled:f};function f(m){e&&m._parent&&m._parent.classList.remove(e),g(m)}function g(m){const o=m._initialStyle[l];m.style.overflow=m._initialStyle.overflow,o!=null&&(m.style[l]=o),delete m._initialStyle}}const QI=Ct({target:[Object,Array]},"v-dialog-transition"),Fy=Wt()({name:"VDialogTransition",props:QI(),setup(e,i){let{slots:l}=i;const u={onBeforeEnter(f){f.style.pointerEvents="none",f.style.visibility="hidden"},async onEnter(f,g){var O;await new Promise(D=>requestAnimationFrame(D)),await new Promise(D=>requestAnimationFrame(D)),f.style.visibility="";const{x:m,y:o,sx:T,sy:k,speed:I}=rx(e.target,f),z=jl(f,[{transform:`translate(${m}px, ${o}px) scale(${T}, ${k})`,opacity:0},{}],{duration:225*I,easing:WI});(O=ix(f))==null||O.forEach(D=>{jl(D,[{opacity:0},{opacity:0,offset:.33},{}],{duration:225*2*I,easing:mh})}),z.finished.then(()=>g())},onAfterEnter(f){f.style.removeProperty("pointer-events")},onBeforeLeave(f){f.style.pointerEvents="none"},async onLeave(f,g){var O;await new Promise(D=>requestAnimationFrame(D));const{x:m,y:o,sx:T,sy:k,speed:I}=rx(e.target,f);jl(f,[{},{transform:`translate(${m}px, ${o}px) scale(${T}, ${k})`,opacity:0}],{duration:125*I,easing:XI}).finished.then(()=>g()),(O=ix(f))==null||O.forEach(D=>{jl(D,[{},{opacity:0,offset:.2},{opacity:0}],{duration:125*2*I,easing:mh})})},onAfterLeave(f){f.style.removeProperty("pointer-events")}};return()=>e.target?E(Ts,an({name:"dialog-transition"},u,{css:!1}),l):E(Ts,{name:"dialog-transition"},l)}});function ix(e){var l;const i=(l=e.querySelector(":scope > .v-card, :scope > .v-sheet, :scope > .v-list"))==null?void 0:l.children;return i&&[...i]}function rx(e,i){const l=Ow(e),u=Dy(i),[f,g]=getComputedStyle(i).transformOrigin.split(" ").map(oe=>parseFloat(oe)),[m,o]=getComputedStyle(i).getPropertyValue("--v-overlay-anchor-origin").split(" ");let T=l.left+l.width/2;m==="left"||o==="left"?T-=l.width/2:(m==="right"||o==="right")&&(T+=l.width/2);let k=l.top+l.height/2;m==="top"||o==="top"?k-=l.height/2:(m==="bottom"||o==="bottom")&&(k+=l.height/2);const I=l.width/u.width,z=l.height/u.height,O=Math.max(1,I,z),D=I/O||0,B=z/O||0,V=u.width*u.height/(window.innerWidth*window.innerHeight),Z=V>.12?Math.min(1.5,(V-.12)*10+1):1;return{x:T-(f+u.left),y:k-(g+u.top),sx:D,sy:B,speed:Z}}Ta("fab-transition","center center","out-in");Ta("dialog-bottom-transition");Ta("dialog-top-transition");const ax=Ta("fade-transition"),eM=Ta("scale-transition");Ta("scroll-x-transition");Ta("scroll-x-reverse-transition");Ta("scroll-y-transition");Ta("scroll-y-reverse-transition");Ta("slide-x-transition");Ta("slide-x-reverse-transition");const Xw=Ta("slide-y-transition");Ta("slide-y-reverse-transition");const tM=qw("expand-transition",Ww()),Kw=qw("expand-x-transition",Ww("",!0));const nM=Ct({defaults:Object,disabled:Boolean,reset:[Number,String],root:[Boolean,String],scoped:Boolean},"VDefaultsProvider"),Bi=Wt(!1)({name:"VDefaultsProvider",props:nM(),setup(e,i){let{slots:l}=i;const{defaults:u,disabled:f,reset:g,root:m,scoped:o}=um(e);return Qo(u,{reset:g,root:m,scoped:o,disabled:f}),()=>{var T;return(T=l.default)==null?void 0:T.call(l)}}});function Oy(e){return Ry(()=>{const i=[],l={};if(e.value.background)if(U_(e.value.background)){if(l.backgroundColor=e.value.background,!e.value.text&&BI(e.value.background)){const u=Ss(e.value.background);if(u.a==null||u.a===1){const f=Uw(u);l.color=f,l.caretColor=f}}}else i.push(`bg-${e.value.background}`);return e.value.text&&(U_(e.value.text)?(l.color=e.value.text,l.caretColor=e.value.text):i.push(`text-${e.value.text}`)),{colorClasses:i,colorStyles:l}})}function os(e,i){const l=ce(()=>({text:di(e)?e.value:i?e[i]:null})),{colorClasses:u,colorStyles:f}=Oy(l);return{textColorClasses:u,textColorStyles:f}}function Fa(e,i){const l=ce(()=>({background:di(e)?e.value:i?e[i]:null})),{colorClasses:u,colorStyles:f}=Oy(l);return{backgroundColorClasses:u,backgroundColorStyles:f}}const iM={collapse:"mdi-chevron-up",complete:"mdi-check",cancel:"mdi-close-circle",close:"mdi-close",delete:"mdi-close-circle",clear:"mdi-close-circle",success:"mdi-check-circle",info:"mdi-information",warning:"mdi-alert-circle",error:"mdi-close-circle",prev:"mdi-chevron-left",next:"mdi-chevron-right",checkboxOn:"mdi-checkbox-marked",checkboxOff:"mdi-checkbox-blank-outline",checkboxIndeterminate:"mdi-minus-box",delimiter:"mdi-circle",sortAsc:"mdi-arrow-up",sortDesc:"mdi-arrow-down",expand:"mdi-chevron-down",menu:"mdi-menu",subgroup:"mdi-menu-down",dropdown:"mdi-menu-down",radioOn:"mdi-radiobox-marked",radioOff:"mdi-radiobox-blank",edit:"mdi-pencil",ratingEmpty:"mdi-star-outline",ratingFull:"mdi-star",ratingHalf:"mdi-star-half-full",loading:"mdi-cached",first:"mdi-page-first",last:"mdi-page-last",unfold:"mdi-unfold-more-horizontal",file:"mdi-paperclip",plus:"mdi-plus",minus:"mdi-minus",calendar:"mdi-calendar",treeviewCollapse:"mdi-menu-down",treeviewExpand:"mdi-menu-right",eyeDropper:"mdi-eyedropper",upload:"mdi-cloud-upload"},rM={component:e=>Jo(Jw,{...e,class:"mdi"})},Gn=[String,Function,Object,Array],G_=Symbol.for("vuetify:icons"),bm=Ct({icon:{type:Gn},tag:{type:String,required:!0}},"icon"),sx=Wt()({name:"VComponentIcon",props:bm(),setup(e,i){let{slots:l}=i;return()=>{const u=e.icon;return E(e.tag,null,{default:()=>{var f;return[e.icon?E(u,null,null):(f=l.default)==null?void 0:f.call(l)]}})}}}),Yw=yu({name:"VSvgIcon",inheritAttrs:!1,props:bm(),setup(e,i){let{attrs:l}=i;return()=>E(e.tag,an(l,{style:null}),{default:()=>[E("svg",{class:"v-icon__svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",role:"img","aria-hidden":"true"},[Array.isArray(e.icon)?e.icon.map(u=>Array.isArray(u)?E("path",{d:u[0],"fill-opacity":u[1]},null):E("path",{d:u},null)):E("path",{d:e.icon},null)])]})}});yu({name:"VLigatureIcon",props:bm(),setup(e){return()=>E(e.tag,null,{default:()=>[e.icon]})}});const Jw=yu({name:"VClassIcon",props:bm(),setup(e){return()=>E(e.tag,{class:e.icon},null)}});function aM(){return{svg:{component:Yw},class:{component:Jw}}}function sM(e){const i=aM(),l=(e==null?void 0:e.defaultSet)??"mdi";return l==="mdi"&&!i.mdi&&(i.mdi=rM),Fr({defaultSet:l,sets:i,aliases:{...iM,vuetify:["M8.2241 14.2009L12 21L22 3H14.4459L8.2241 14.2009Z",["M7.26303 12.4733L7.00113 12L2 3H12.5261C12.5261 3 12.5261 3 12.5261 3L7.26303 12.4733Z",.6]],"vuetify-outline":"svg:M7.26 12.47 12.53 3H2L7.26 12.47ZM14.45 3 8.22 14.2 12 21 22 3H14.45ZM18.6 5 12 16.88 10.51 14.2 15.62 5ZM7.26 8.35 5.4 5H9.13L7.26 8.35Z","vuetify-play":["m6.376 13.184-4.11-7.192C1.505 4.66 2.467 3 4.003 3h8.532l-.953 1.576-.006.01-.396.677c-.429.732-.214 1.507.194 2.015.404.503 1.092.878 1.869.806a3.72 3.72 0 0 1 1.005.022c.276.053.434.143.523.237.138.146.38.635-.25 2.09-.893 1.63-1.553 1.722-1.847 1.677-.213-.033-.468-.158-.756-.406a4.95 4.95 0 0 1-.8-.927c-.39-.564-1.04-.84-1.66-.846-.625-.006-1.316.27-1.693.921l-.478.826-.911 1.506Z",["M9.093 11.552c.046-.079.144-.15.32-.148a.53.53 0 0 1 .43.207c.285.414.636.847 1.046 1.2.405.35.914.662 1.516.754 1.334.205 2.502-.698 3.48-2.495l.014-.028.013-.03c.687-1.574.774-2.852-.005-3.675-.37-.391-.861-.586-1.333-.676a5.243 5.243 0 0 0-1.447-.044c-.173.016-.393-.073-.54-.257-.145-.18-.127-.316-.082-.392l.393-.672L14.287 3h5.71c1.536 0 2.499 1.659 1.737 2.992l-7.997 13.996c-.768 1.344-2.706 1.344-3.473 0l-3.037-5.314 1.377-2.278.004-.006.004-.007.481-.831Z",.6]]}},e)}const oM=e=>{const i=ri(G_);if(!i)throw new Error("Missing Vuetify Icons provide!");return{iconData:ce(()=>{var T;const u=U(e);if(!u)return{component:sx};let f=u;if(typeof f=="string"&&(f=f.trim(),f.startsWith("$")&&(f=(T=i.aliases)==null?void 0:T[f.slice(1)])),Array.isArray(f))return{component:Yw,icon:f};if(typeof f!="string")return{component:sx,icon:f};const g=Object.keys(i.sets).find(k=>typeof f=="string"&&f.startsWith(`${k}:`)),m=g?f.slice(g.length+1):f;return{component:i.sets[g??i.defaultSet].component,icon:m}})}},lM=["x-small","small","default","large","x-large"],Eh=Ct({size:{type:[String,Number],default:"default"}},"size");function Ah(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ks();return Ry(()=>{let l,u;return Up(lM,e.size)?l=`${i}--size-${e.size}`:e.size&&(u={width:mn(e.size),height:mn(e.size)}),{sizeClasses:l,sizeStyles:u}})}const Ti=Ct({tag:{type:String,default:"div"}},"tag"),gh=Symbol.for("vuetify:theme"),Di=Ct({theme:String},"theme");function ox(){return{defaultTheme:"light",variations:{colors:[],lighten:0,darken:0},themes:{light:{dark:!1,colors:{background:"#FFFFFF",surface:"#FFFFFF","surface-bright":"#FFFFFF","surface-light":"#EEEEEE","surface-variant":"#424242","on-surface-variant":"#EEEEEE",primary:"#1867C0","primary-darken-1":"#1F5592",secondary:"#48A9A6","secondary-darken-1":"#018786",error:"#B00020",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#000000","border-opacity":.12,"high-emphasis-opacity":.87,"medium-emphasis-opacity":.6,"disabled-opacity":.38,"idle-opacity":.04,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.12,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#F5F5F5","theme-on-code":"#000000"}},dark:{dark:!0,colors:{background:"#121212",surface:"#212121","surface-bright":"#ccbfd6","surface-light":"#424242","surface-variant":"#a3a3a3","on-surface-variant":"#424242",primary:"#2196F3","primary-darken-1":"#277CC1",secondary:"#54B6B2","secondary-darken-1":"#48A9A6",error:"#CF6679",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#FFFFFF","border-opacity":.12,"high-emphasis-opacity":1,"medium-emphasis-opacity":.7,"disabled-opacity":.5,"idle-opacity":.1,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.16,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#343434","theme-on-code":"#CCCCCC"}}}}}function cM(){var u,f;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ox();const i=ox();if(!e)return{...i,isDisabled:!0};const l={};for(const[g,m]of Object.entries(e.themes??{})){const o=m.dark||g==="dark"?(u=i.themes)==null?void 0:u.dark:(f=i.themes)==null?void 0:f.light;l[g]=Fr(o,m)}return Fr(i,{...e,themes:l})}function uM(e){const i=cM(e),l=Ke(i.defaultTheme),u=Ke(i.themes),f=ce(()=>{const I={};for(const[z,O]of Object.entries(u.value)){const D=I[z]={...O,colors:{...O.colors}};if(i.variations)for(const B of i.variations.colors){const V=D.colors[B];if(V)for(const Z of["lighten","darken"]){const oe=Z==="lighten"?$I:jI;for(const pe of Iw(i.variations[Z],1))D.colors[`${B}-${Z}-${pe}`]=OI(oe(Ss(V),pe))}}for(const B of Object.keys(D.colors)){if(/^on-[a-z]/.test(B)||D.colors[`on-${B}`])continue;const V=`on-${B}`,Z=Ss(D.colors[B]);D.colors[V]=Uw(Z)}}return I}),g=ce(()=>f.value[l.value]),m=ce(()=>{var B;const I=[];(B=g.value)!=null&&B.dark&&Vl(I,":root",["color-scheme: dark"]),Vl(I,":root",lx(g.value));for(const[V,Z]of Object.entries(f.value))Vl(I,`.v-theme--${V}`,[`color-scheme: ${Z.dark?"dark":"normal"}`,...lx(Z)]);const z=[],O=[],D=new Set(Object.values(f.value).flatMap(V=>Object.keys(V.colors)));for(const V of D)/^on-[a-z]/.test(V)?Vl(O,`.${V}`,[`color: rgb(var(--v-theme-${V})) !important`]):(Vl(z,`.bg-${V}`,[`--v-theme-overlay-multiplier: var(--v-theme-${V}-overlay-multiplier)`,`background-color: rgb(var(--v-theme-${V})) !important`,`color: rgb(var(--v-theme-on-${V})) !important`]),Vl(O,`.text-${V}`,[`color: rgb(var(--v-theme-${V})) !important`]),Vl(O,`.border-${V}`,[`--v-border-color: var(--v-theme-${V})`]));return I.push(...z,...O),I.map((V,Z)=>Z===0?V:`    ${V}`).join("")});function o(){return{style:[{children:m.value,id:"vuetify-theme-stylesheet",nonce:i.cspNonce||!1}]}}function T(I){if(i.isDisabled)return;const z=I._context.provides.usehead;if(z)if(z.push){const O=z.push(o);Wn&&en(m,()=>{O.patch(o)})}else Wn?(z.addHeadObjs(ce(o)),Sa(()=>z.updateDOM())):z.addHeadObjs(o());else{let D=function(){if(typeof document<"u"&&!O){const B=document.createElement("style");B.type="text/css",B.id="vuetify-theme-stylesheet",i.cspNonce&&B.setAttribute("nonce",i.cspNonce),O=B,document.head.appendChild(O)}O&&(O.innerHTML=m.value)},O=Wn?document.getElementById("vuetify-theme-stylesheet"):null;Wn?en(m,D,{immediate:!0}):D()}}const k=ce(()=>i.isDisabled?void 0:`v-theme--${l.value}`);return{install:T,isDisabled:i.isDisabled,name:l,themes:u,current:g,computedThemes:f,themeClasses:k,styles:m,global:{name:l,current:g}}}function Hi(e){Gi("provideTheme");const i=ri(gh,null);if(!i)throw new Error("Could not find Vuetify theme injection");const l=ce(()=>e.theme??i.name.value),u=ce(()=>i.themes.value[l.value]),f=ce(()=>i.isDisabled?void 0:`v-theme--${l.value}`),g={...i,name:l,current:u,themeClasses:f};return Mr(gh,g),g}function Qw(){Gi("useTheme");const e=ri(gh,null);if(!e)throw new Error("Could not find Vuetify theme injection");return e}function Vl(e,i,l){e.push(`${i} {
`,...l.map(u=>`  ${u};
`),`}
`)}function lx(e){const i=e.dark?2:1,l=e.dark?1:2,u=[];for(const[f,g]of Object.entries(e.colors)){const m=Ss(g);u.push(`--v-theme-${f}: ${m.r},${m.g},${m.b}`),f.startsWith("on-")||u.push(`--v-theme-${f}-overlay-multiplier: ${UI(g)>.18?i:l}`)}for(const[f,g]of Object.entries(e.variables)){const m=typeof g=="string"&&g.startsWith("#")?Ss(g):void 0,o=m?`${m.r}, ${m.g}, ${m.b}`:void 0;u.push(`--v-${f}: ${o??g}`)}return u}const dM=Ct({color:String,disabled:Boolean,start:Boolean,end:Boolean,icon:Gn,...xn(),...Eh(),...Ti({tag:"i"}),...Di()},"VIcon"),ui=Wt()({name:"VIcon",props:dM(),setup(e,i){let{attrs:l,slots:u}=i;const f=Ke(),{themeClasses:g}=Hi(e),{iconData:m}=oM(ce(()=>f.value||e.icon)),{sizeClasses:o}=Ah(e),{textColorClasses:T,textColorStyles:k}=os(rn(e,"color"));return hn(()=>{var O,D;const I=(O=u.default)==null?void 0:O.call(u);I&&(f.value=(D=Rw(I).filter(B=>B.type===Ih&&B.children&&typeof B.children=="string")[0])==null?void 0:D.children);const z=!!(l.onClick||l.onClickOnce);return E(m.value.component,{tag:e.tag,icon:m.value.icon,class:["v-icon","notranslate",g.value,o.value,T.value,{"v-icon--clickable":z,"v-icon--disabled":e.disabled,"v-icon--start":e.start,"v-icon--end":e.end},e.class],style:[o.value?void 0:{fontSize:mn(e.size),height:mn(e.size),width:mn(e.size)},k.value,e.style],role:z?"button":void 0,"aria-hidden":!z,tabindex:z?e.disabled?-1:0:void 0},{default:()=>[I]})}),{}}});const Va=Ct({height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],minHeight:[Number,String],minWidth:[Number,String],width:[Number,String]},"dimension");function Na(e){return{dimensionStyles:ce(()=>{const l={},u=mn(e.height),f=mn(e.maxHeight),g=mn(e.maxWidth),m=mn(e.minHeight),o=mn(e.minWidth),T=mn(e.width);return u!=null&&(l.height=u),f!=null&&(l.maxHeight=f),g!=null&&(l.maxWidth=g),m!=null&&(l.minHeight=m),o!=null&&(l.minWidth=o),T!=null&&(l.width=T),l})}}function hM(e){return{aspectStyles:ce(()=>{const i=Number(e.aspectRatio);return i?{paddingBottom:String(1/i*100)+"%"}:void 0})}}const eS=Ct({aspectRatio:[String,Number],contentClass:null,inline:Boolean,...xn(),...Va()},"VResponsive"),cx=Wt()({name:"VResponsive",props:eS(),setup(e,i){let{slots:l}=i;const{aspectStyles:u}=hM(e),{dimensionStyles:f}=Na(e);return hn(()=>{var g;return E("div",{class:["v-responsive",{"v-responsive--inline":e.inline},e.class],style:[f.value,e.style]},[E("div",{class:"v-responsive__sizer",style:u.value},null),(g=l.additional)==null?void 0:g.call(l),l.default&&E("div",{class:["v-responsive__content",e.contentClass]},[l.default()])])}),{}}}),ua=Ct({rounded:{type:[Boolean,Number,String],default:void 0},tile:Boolean},"rounded");function da(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ks();return{roundedClasses:ce(()=>{const u=di(e)?e.value:e.rounded,f=di(e)?e.value:e.tile,g=[];if(u===!0||u==="")g.push(`${i}--rounded`);else if(typeof u=="string"||u===0)for(const m of String(u).split(" "))g.push(`rounded-${m}`);else(f||u===!1)&&g.push("rounded-0");return g})}}const Rh=Ct({transition:{type:[Boolean,String,Object],default:"fade-transition",validator:e=>e!==!0}},"transition"),to=(e,i)=>{let{slots:l}=i;const{transition:u,disabled:f,group:g,...m}=e,{component:o=g?ky:Ts,...T}=typeof u=="object"?u:{};return Jo(o,an(typeof u=="string"?{name:f?"":u}:T,typeof u=="string"?{}:Object.fromEntries(Object.entries({disabled:f,group:g}).filter(k=>{let[I,z]=k;return z!==void 0})),m),l)};function fM(e,i){if(!Iy)return;const l=i.modifiers||{},u=i.value,{handler:f,options:g}=typeof u=="object"?u:{handler:u,options:{}},m=new IntersectionObserver(function(){var z;let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],T=arguments.length>1?arguments[1]:void 0;const k=(z=e._observe)==null?void 0:z[i.instance.$.uid];if(!k)return;const I=o.some(O=>O.isIntersecting);f&&(!l.quiet||k.init)&&(!l.once||I||k.init)&&f(I,o,T),I&&l.once?tS(e,i):k.init=!0},g);e._observe=Object(e._observe),e._observe[i.instance.$.uid]={init:!1,observer:m},m.observe(e)}function tS(e,i){var u;const l=(u=e._observe)==null?void 0:u[i.instance.$.uid];l&&(l.observer.unobserve(e),delete e._observe[i.instance.$.uid])}const pM={mounted:fM,unmounted:tS},Vy=pM,mM=Ct({absolute:Boolean,alt:String,cover:Boolean,color:String,draggable:{type:[Boolean,String],default:void 0},eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},sizes:String,src:{type:[String,Object],default:""},crossorigin:String,referrerpolicy:String,srcset:String,position:String,...eS(),...xn(),...ua(),...Rh()},"VImg"),Ny=Wt()({name:"VImg",directives:{intersect:Vy},props:mM(),emits:{loadstart:e=>!0,load:e=>!0,error:e=>!0},setup(e,i){let{emit:l,slots:u}=i;const{backgroundColorClasses:f,backgroundColorStyles:g}=Fa(rn(e,"color")),{roundedClasses:m}=da(e),o=Gi("VImg"),T=ln(""),k=Ke(),I=ln(e.eager?"loading":"idle"),z=ln(),O=ln(),D=ce(()=>e.src&&typeof e.src=="object"?{src:e.src.src,srcset:e.srcset||e.src.srcset,lazySrc:e.lazySrc||e.src.lazySrc,aspect:Number(e.aspectRatio||e.src.aspect||0)}:{src:e.src,srcset:e.srcset,lazySrc:e.lazySrc,aspect:Number(e.aspectRatio||0)}),B=ce(()=>D.value.aspect||z.value/O.value||0);en(()=>e.src,()=>{V(I.value!=="idle")}),en(B,(xe,Oe)=>{!xe&&Oe&&k.value&&me(k.value)}),Ph(()=>V());function V(xe){if(!(e.eager&&xe)&&!(Iy&&!xe&&!e.eager)){if(I.value="loading",D.value.lazySrc){const Oe=new Image;Oe.src=D.value.lazySrc,me(Oe,null)}D.value.src&&Fi(()=>{var Oe;l("loadstart",((Oe=k.value)==null?void 0:Oe.currentSrc)||D.value.src),setTimeout(()=>{var We;if(!o.isUnmounted)if((We=k.value)!=null&&We.complete){if(k.value.naturalWidth||oe(),I.value==="error")return;B.value||me(k.value,null),I.value==="loading"&&Z()}else B.value||me(k.value),pe()})})}}function Z(){var xe;o.isUnmounted||(pe(),me(k.value),I.value="loaded",l("load",((xe=k.value)==null?void 0:xe.currentSrc)||D.value.src))}function oe(){var xe;o.isUnmounted||(I.value="error",l("error",((xe=k.value)==null?void 0:xe.currentSrc)||D.value.src))}function pe(){const xe=k.value;xe&&(T.value=xe.currentSrc||xe.src)}let Se=-1;Ir(()=>{clearTimeout(Se)});function me(xe){let Oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;const We=()=>{if(clearTimeout(Se),o.isUnmounted)return;const{naturalHeight:dt,naturalWidth:je}=xe;dt||je?(z.value=je,O.value=dt):!xe.complete&&I.value==="loading"&&Oe!=null?Se=window.setTimeout(We,Oe):(xe.currentSrc.endsWith(".svg")||xe.currentSrc.startsWith("data:image/svg+xml"))&&(z.value=1,O.value=1)};We()}const be=ce(()=>({"v-img__img--cover":e.cover,"v-img__img--contain":!e.cover})),he=()=>{var We;if(!D.value.src||I.value==="idle")return null;const xe=E("img",{class:["v-img__img",be.value],style:{objectPosition:e.position},src:D.value.src,srcset:D.value.srcset,alt:e.alt,crossorigin:e.crossorigin,referrerpolicy:e.referrerpolicy,draggable:e.draggable,sizes:e.sizes,ref:k,onLoad:Z,onError:oe},null),Oe=(We=u.sources)==null?void 0:We.call(u);return E(to,{transition:e.transition,appear:!0},{default:()=>[Pr(Oe?E("picture",{class:"v-img__picture"},[Oe,xe]):xe,[[Ql,I.value==="loaded"]])]})},Ce=()=>E(to,{transition:e.transition},{default:()=>[D.value.lazySrc&&I.value!=="loaded"&&E("img",{class:["v-img__img","v-img__img--preload",be.value],style:{objectPosition:e.position},src:D.value.lazySrc,alt:e.alt,crossorigin:e.crossorigin,referrerpolicy:e.referrerpolicy,draggable:e.draggable},null)]}),ye=()=>u.placeholder?E(to,{transition:e.transition,appear:!0},{default:()=>[(I.value==="loading"||I.value==="error"&&!u.error)&&E("div",{class:"v-img__placeholder"},[u.placeholder()])]}):null,Me=()=>u.error?E(to,{transition:e.transition,appear:!0},{default:()=>[I.value==="error"&&E("div",{class:"v-img__error"},[u.error()])]}):null,ke=()=>e.gradient?E("div",{class:"v-img__gradient",style:{backgroundImage:`linear-gradient(${e.gradient})`}},null):null,Ee=ln(!1);{const xe=en(B,Oe=>{Oe&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{Ee.value=!0})}),xe())})}return hn(()=>{const xe=cx.filterProps(e);return Pr(E(cx,an({class:["v-img",{"v-img--absolute":e.absolute,"v-img--booting":!Ee.value},f.value,m.value,e.class],style:[{width:mn(e.width==="auto"?z.value:e.width)},g.value,e.style]},xe,{aspectRatio:B.value,"aria-label":e.alt,role:e.alt?"img":void 0}),{additional:()=>E(un,null,[E(he,null,null),E(Ce,null,null),E(ke,null,null),E(ye,null,null),E(Me,null,null)]),default:u.default}),[[oo("intersect"),{handler:V,options:e.options},null,{once:!0}]])}),{currentSrc:T,image:k,state:I,naturalWidth:z,naturalHeight:O}}}),lo=Ct({border:[Boolean,Number,String]},"border");function co(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ks();return{borderClasses:ce(()=>{const u=di(e)?e.value:e.border,f=[];if(u===!0||u==="")f.push(`${i}--border`);else if(typeof u=="string"||u===0)for(const g of String(u).split(" "))f.push(`border-${g}`);return f})}}const gM=[null,"default","comfortable","compact"],Pa=Ct({density:{type:String,default:"default",validator:e=>gM.includes(e)}},"density");function $a(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ks();return{densityClasses:ce(()=>`${i}--density-${e.density}`)}}const _M=["elevated","flat","tonal","outlined","text","plain"];function ec(e,i){return E(un,null,[e&&E("span",{key:"overlay",class:`${i}__overlay`},null),E("span",{key:"underlay",class:`${i}__underlay`},null)])}const Is=Ct({color:String,variant:{type:String,default:"elevated",validator:e=>_M.includes(e)}},"variant");function tc(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ks();const l=ce(()=>{const{variant:g}=U(e);return`${i}--variant-${g}`}),{colorClasses:u,colorStyles:f}=Oy(ce(()=>{const{variant:g,color:m}=U(e);return{[["elevated","flat"].includes(g)?"background":"text"]:m}}));return{colorClasses:u,colorStyles:f,variantClasses:l}}const yM=Ct({start:Boolean,end:Boolean,icon:Gn,image:String,text:String,...lo(),...xn(),...Pa(),...ua(),...Eh(),...Ti(),...Di(),...Is({variant:"flat"})},"VAvatar"),Kl=Wt()({name:"VAvatar",props:yM(),setup(e,i){let{slots:l}=i;const{themeClasses:u}=Hi(e),{borderClasses:f}=co(e),{colorClasses:g,colorStyles:m,variantClasses:o}=tc(e),{densityClasses:T}=$a(e),{roundedClasses:k}=da(e),{sizeClasses:I,sizeStyles:z}=Ah(e);return hn(()=>E(e.tag,{class:["v-avatar",{"v-avatar--start":e.start,"v-avatar--end":e.end},u.value,f.value,g.value,T.value,k.value,I.value,o.value,e.class],style:[m.value,z.value,e.style]},{default:()=>[l.default?E(Bi,{key:"content-defaults",defaults:{VImg:{cover:!0,src:e.image},VIcon:{icon:e.icon}}},{default:()=>[l.default()]}):e.image?E(Ny,{key:"image",src:e.image,alt:"",cover:!0},null):e.icon?E(ui,{key:"icon",icon:e.icon},null):e.text,ec(!1,"v-avatar")]})),{}}});const xm=["sm","md","lg","xl","xxl"],H_=Symbol.for("vuetify:display"),ux={mobileBreakpoint:"lg",thresholds:{xs:0,sm:600,md:960,lg:1280,xl:1920,xxl:2560}},vM=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ux;return Fr(ux,e)};function dx(e){return Wn&&!e?window.innerWidth:typeof e=="object"&&e.clientWidth||0}function hx(e){return Wn&&!e?window.innerHeight:typeof e=="object"&&e.clientHeight||0}function fx(e){const i=Wn&&!e?window.navigator.userAgent:"ssr";function l(B){return!!i.match(B)}const u=l(/android/i),f=l(/iphone|ipad|ipod/i),g=l(/cordova/i),m=l(/electron/i),o=l(/chrome/i),T=l(/edge/i),k=l(/firefox/i),I=l(/opera/i),z=l(/win/i),O=l(/mac/i),D=l(/linux/i);return{android:u,ios:f,cordova:g,electron:m,chrome:o,edge:T,firefox:k,opera:I,win:z,mac:O,linux:D,touch:cI,ssr:i==="ssr"}}function bM(e,i){const{thresholds:l,mobileBreakpoint:u}=vM(e),f=ln(hx(i)),g=ln(fx(i)),m=br({}),o=ln(dx(i));function T(){f.value=hx(),o.value=dx()}function k(){T(),g.value=fx()}return Sa(()=>{const I=o.value<l.sm,z=o.value<l.md&&!I,O=o.value<l.lg&&!(z||I),D=o.value<l.xl&&!(O||z||I),B=o.value<l.xxl&&!(D||O||z||I),V=o.value>=l.xxl,Z=I?"xs":z?"sm":O?"md":D?"lg":B?"xl":"xxl",oe=typeof u=="number"?u:l[u],pe=o.value<oe;m.xs=I,m.sm=z,m.md=O,m.lg=D,m.xl=B,m.xxl=V,m.smAndUp=!I,m.mdAndUp=!(I||z),m.lgAndUp=!(I||z||O),m.xlAndUp=!(I||z||O||D),m.smAndDown=!(O||D||B||V),m.mdAndDown=!(D||B||V),m.lgAndDown=!(B||V),m.xlAndDown=!V,m.name=Z,m.height=f.value,m.width=o.value,m.mobile=pe,m.mobileBreakpoint=u,m.platform=g.value,m.thresholds=l}),Wn&&window.addEventListener("resize",T,{passive:!0}),{...um(m),update:k,ssr:!!i}}const nS=Ct({mobile:{type:Boolean,default:!1},mobileBreakpoint:[Number,String]},"display");function wm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ks();const l=ri(H_);if(!l)throw new Error("Could not find Vuetify display injection");const u=ce(()=>{if(e.mobile!=null)return e.mobile;if(!e.mobileBreakpoint)return l.mobile.value;const g=typeof e.mobileBreakpoint=="number"?e.mobileBreakpoint:l.thresholds.value[e.mobileBreakpoint];return l.width.value<g}),f=ce(()=>i?{[`${i}--mobile`]:u.value}:{});return{...l,displayClasses:f,mobile:u}}function Oa(e,i){let l;function u(){l=Sh(),l.run(()=>i.length?i(()=>{l==null||l.stop(),u()}):i())}en(e,f=>{f&&!l?u():f||(l==null||l.stop(),l=void 0)},{immediate:!0}),kr(()=>{l==null||l.stop()})}function ai(e,i,l){let u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:z=>z,f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:z=>z;const g=Gi("useProxiedModel"),m=Ke(e[i]!==void 0?e[i]:l),o=Zl(i),k=ce(o!==i?()=>{var z,O,D,B;return e[i],!!(((z=g.vnode.props)!=null&&z.hasOwnProperty(i)||(O=g.vnode.props)!=null&&O.hasOwnProperty(o))&&((D=g.vnode.props)!=null&&D.hasOwnProperty(`onUpdate:${i}`)||(B=g.vnode.props)!=null&&B.hasOwnProperty(`onUpdate:${o}`)))}:()=>{var z,O;return e[i],!!((z=g.vnode.props)!=null&&z.hasOwnProperty(i)&&((O=g.vnode.props)!=null&&O.hasOwnProperty(`onUpdate:${i}`)))});Oa(()=>!k.value,()=>{en(()=>e[i],z=>{m.value=z})});const I=ce({get(){const z=e[i];return u(k.value?z:m.value)},set(z){const O=f(z),D=fn(k.value?e[i]:m.value);D===O||u(D)===z||(m.value=O,g==null||g.emit(`update:${i}`,O))}});return Object.defineProperty(I,"externalValue",{get:()=>k.value?e[i]:m.value}),I}const xM={badge:"Badge",open:"Open",close:"Close",dismiss:"Dismiss",confirmEdit:{ok:"OK",cancel:"Cancel"},dataIterator:{noResultsText:"No matching records found",loadingText:"Loading items..."},dataTable:{itemsPerPageText:"Rows per page:",ariaLabel:{sortDescending:"Sorted descending.",sortAscending:"Sorted ascending.",sortNone:"Not sorted.",activateNone:"Activate to remove sorting.",activateDescending:"Activate to sort descending.",activateAscending:"Activate to sort ascending."},sortBy:"Sort by"},dataFooter:{itemsPerPageText:"Items per page:",itemsPerPageAll:"All",nextPage:"Next page",prevPage:"Previous page",firstPage:"First page",lastPage:"Last page",pageText:"{0}-{1} of {2}"},dateRangeInput:{divider:"to"},datePicker:{itemsSelected:"{0} selected",range:{title:"Select dates",header:"Enter dates"},title:"Select date",header:"Enter date",input:{placeholder:"Enter date"}},noDataText:"No data available",carousel:{prev:"Previous visual",next:"Next visual",ariaLabel:{delimiter:"Carousel slide {0} of {1}"}},calendar:{moreEvents:"{0} more",today:"Today"},input:{clear:"Clear {0}",prependAction:"{0} prepended action",appendAction:"{0} appended action",otp:"Please enter OTP character {0}"},fileInput:{counter:"{0} files",counterSize:"{0} files ({1} in total)"},fileUpload:{title:"Drag and drop files here",divider:"or",browse:"Browse Files"},timePicker:{am:"AM",pm:"PM",title:"Select Time"},pagination:{ariaLabel:{root:"Pagination Navigation",next:"Next page",previous:"Previous page",page:"Go to page {0}",currentPage:"Page {0}, Current page",first:"First page",last:"Last page"}},stepper:{next:"Next",prev:"Previous"},rating:{ariaLabel:{item:"Rating {0} of {1}"}},loading:"Loading...",infiniteScroll:{loadMore:"Load more",empty:"No more"}},px="$vuetify.",mx=(e,i)=>e.replace(/\{(\d+)\}/g,(l,u)=>String(i[+u])),iS=(e,i,l)=>function(u){for(var f=arguments.length,g=new Array(f>1?f-1:0),m=1;m<f;m++)g[m-1]=arguments[m];if(!u.startsWith(px))return mx(u,g);const o=u.replace(px,""),T=e.value&&l.value[e.value],k=i.value&&l.value[i.value];let I=V_(T,o,null);return I||(`${u}${e.value}`,I=V_(k,o,null)),I||(I=u),typeof I!="string"&&(I=u),mx(I,g)};function rS(e,i){return(l,u)=>new Intl.NumberFormat([e.value,i.value],u).format(l)}function u_(e,i,l){const u=ai(e,i,e[i]??l.value);return u.value=e[i]??l.value,en(l,f=>{e[i]==null&&(u.value=l.value)}),u}function aS(e){return i=>{const l=u_(i,"locale",e.current),u=u_(i,"fallback",e.fallback),f=u_(i,"messages",e.messages);return{name:"vuetify",current:l,fallback:u,messages:f,t:iS(l,u,f),n:rS(l,u),provide:aS({current:l,fallback:u,messages:f})}}}function wM(e){const i=ln((e==null?void 0:e.locale)??"en"),l=ln((e==null?void 0:e.fallback)??"en"),u=Ke({en:xM,...e==null?void 0:e.messages});return{name:"vuetify",current:i,fallback:l,messages:u,t:iS(i,l,u),n:rS(i,l),provide:aS({current:i,fallback:l,messages:u})}}const qp=Symbol.for("vuetify:locale");function SM(e){return e.name!=null}function CM(e){const i=e!=null&&e.adapter&&SM(e==null?void 0:e.adapter)?e==null?void 0:e.adapter:wM(e),l=PM(i,e);return{...i,...l}}function Dh(){const e=ri(qp);if(!e)throw new Error("[Vuetify] Could not find injected locale instance");return e}function TM(){return{af:!1,ar:!0,bg:!1,ca:!1,ckb:!1,cs:!1,de:!1,el:!1,en:!1,es:!1,et:!1,fa:!0,fi:!1,fr:!1,hr:!1,hu:!1,he:!0,id:!1,it:!1,ja:!1,km:!1,ko:!1,lv:!1,lt:!1,nl:!1,no:!1,pl:!1,pt:!1,ro:!1,ru:!1,sk:!1,sl:!1,srCyrl:!1,srLatn:!1,sv:!1,th:!1,tr:!1,az:!1,uk:!1,vi:!1,zhHans:!1,zhHant:!1}}function PM(e,i){const l=Ke((i==null?void 0:i.rtl)??TM()),u=ce(()=>l.value[e.current.value]??!1);return{isRtl:u,rtl:l,rtlClasses:ce(()=>`v-locale--is-${u.value?"rtl":"ltr"}`)}}function ja(){const e=ri(qp);if(!e)throw new Error("[Vuetify] Could not find injected rtl instance");return{isRtl:e.isRtl,rtlClasses:e.rtlClasses}}const sS=Symbol.for("vuetify:goto");function oS(){return{container:void 0,duration:300,layout:!1,offset:0,easing:"easeInOutCubic",patterns:{linear:e=>e,easeInQuad:e=>e**2,easeOutQuad:e=>e*(2-e),easeInOutQuad:e=>e<.5?2*e**2:-1+(4-2*e)*e,easeInCubic:e=>e**3,easeOutCubic:e=>--e**3+1,easeInOutCubic:e=>e<.5?4*e**3:(e-1)*(2*e-2)*(2*e-2)+1,easeInQuart:e=>e**4,easeOutQuart:e=>1- --e**4,easeInOutQuart:e=>e<.5?8*e**4:1-8*--e**4,easeInQuint:e=>e**5,easeOutQuint:e=>1+--e**5,easeInOutQuint:e=>e<.5?16*e**5:1+16*--e**5}}}function kM(e){return $y(e)??(document.scrollingElement||document.body)}function $y(e){return typeof e=="string"?document.querySelector(e):Ey(e)}function d_(e,i,l){if(typeof e=="number")return i&&l?-e:e;let u=$y(e),f=0;for(;u;)f+=i?u.offsetLeft:u.offsetTop,u=u.offsetParent;return f}function IM(e,i){return{rtl:i.isRtl,options:Fr(oS(),e)}}async function gx(e,i,l,u){const f=l?"scrollLeft":"scrollTop",g=Fr((u==null?void 0:u.options)??oS(),i),m=u==null?void 0:u.rtl.value,o=(typeof e=="number"?e:$y(e))??0,T=g.container==="parent"&&o instanceof HTMLElement?o.parentElement:kM(g.container),k=typeof g.easing=="function"?g.easing:g.patterns[g.easing];if(!k)throw new TypeError(`Easing function "${g.easing}" not found.`);let I;if(typeof o=="number")I=d_(o,l,m);else if(I=d_(o,l,m)-d_(T,l,m),g.layout){const B=window.getComputedStyle(o).getPropertyValue("--v-layout-top");B&&(I-=parseInt(B,10))}I+=g.offset,I=EM(T,I,!!m,!!l);const z=T[f]??0;if(I===z)return Promise.resolve(I);const O=performance.now();return new Promise(D=>requestAnimationFrame(function B(V){const oe=(V-O)/g.duration,pe=Math.floor(z+(I-z)*k(Cs(oe,0,1)));if(T[f]=pe,oe>=1&&Math.abs(pe-T[f])<10)return D(I);if(oe>2)return D(T[f]);requestAnimationFrame(B)}))}function MM(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const i=ri(sS),{isRtl:l}=ja();if(!i)throw new Error("[Vuetify] Could not find injected goto instance");const u={...i,rtl:ce(()=>i.rtl.value||l.value)};async function f(g,m){return gx(g,Fr(e,m),!1,u)}return f.horizontal=async(g,m)=>gx(g,Fr(e,m),!0,u),f}function EM(e,i,l,u){const{scrollWidth:f,scrollHeight:g}=e,[m,o]=e===document.scrollingElement?[window.innerWidth,window.innerHeight]:[e.offsetWidth,e.offsetHeight];let T,k;return u?l?(T=-(f-m),k=0):(T=0,k=f-m):(T=0,k=g+-o),Math.max(Math.min(i,k),T)}const jy=Ct({modelValue:{type:null,default:void 0},multiple:Boolean,mandatory:[Boolean,String],max:Number,selectedClass:String,disabled:Boolean},"group"),Uy=Ct({value:null,disabled:Boolean,selectedClass:String},"group-item");function Gy(e,i){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const u=Gi("useGroupItem");if(!u)throw new Error("[Vuetify] useGroupItem composable must be used inside a component setup function");const f=Ca();Mr(Symbol.for(`${i.description}:id`),f);const g=ri(i,null);if(!g){if(!l)return g;throw new Error(`[Vuetify] Could not find useGroup injection with symbol ${i.description}`)}const m=rn(e,"value"),o=ce(()=>!!(g.disabled.value||e.disabled));g.register({id:f,value:m,disabled:o},u),Ir(()=>{g.unregister(f)});const T=ce(()=>g.isSelected(f)),k=ce(()=>g.items.value[0].id===f),I=ce(()=>g.items.value[g.items.value.length-1].id===f),z=ce(()=>T.value&&[g.selectedClass.value,e.selectedClass]);return en(T,O=>{u.emit("group:selected",{value:O})},{flush:"sync"}),{id:f,isSelected:T,isFirst:k,isLast:I,toggle:()=>g.select(f,!T.value),select:O=>g.select(f,O),selectedClass:z,value:m,disabled:o,group:g}}function Sm(e,i){let l=!1;const u=br([]),f=ai(e,"modelValue",[],O=>O==null?[]:lS(u,rs(O)),O=>{const D=RM(u,O);return e.multiple?D:D[0]}),g=Gi("useGroup");function m(O,D){const B=O,V=Symbol.for(`${i.description}:id`),oe=lu(V,g==null?void 0:g.vnode).indexOf(D);U(B.value)==null&&(B.value=oe,B.useIndexAsValue=!0),oe>-1?u.splice(oe,0,B):u.push(B)}function o(O){if(l)return;T();const D=u.findIndex(B=>B.id===O);u.splice(D,1)}function T(){const O=u.find(D=>!D.disabled);O&&e.mandatory==="force"&&!f.value.length&&(f.value=[O.id])}Qn(()=>{T()}),Ir(()=>{l=!0}),xy(()=>{for(let O=0;O<u.length;O++)u[O].useIndexAsValue&&(u[O].value=O)});function k(O,D){const B=u.find(V=>V.id===O);if(!(D&&(B!=null&&B.disabled)))if(e.multiple){const V=f.value.slice(),Z=V.findIndex(pe=>pe===O),oe=~Z;if(D=D??!oe,oe&&e.mandatory&&V.length<=1||!oe&&e.max!=null&&V.length+1>e.max)return;Z<0&&D?V.push(O):Z>=0&&!D&&V.splice(Z,1),f.value=V}else{const V=f.value.includes(O);if(e.mandatory&&V)return;f.value=D??!V?[O]:[]}}function I(O){if(e.multiple,f.value.length){const D=f.value[0],B=u.findIndex(oe=>oe.id===D);let V=(B+O)%u.length,Z=u[V];for(;Z.disabled&&V!==B;)V=(V+O)%u.length,Z=u[V];if(Z.disabled)return;f.value=[u[V].id]}else{const D=u.find(B=>!B.disabled);D&&(f.value=[D.id])}}const z={register:m,unregister:o,selected:f,select:k,disabled:rn(e,"disabled"),prev:()=>I(u.length-1),next:()=>I(1),isSelected:O=>f.value.includes(O),selectedClass:ce(()=>e.selectedClass),items:ce(()=>u),getItemIndex:O=>AM(u,O)};return Mr(i,z),z}function AM(e,i){const l=lS(e,[i]);return l.length?e.findIndex(u=>u.id===l[0]):-1}function lS(e,i){const l=[];return i.forEach(u=>{const f=e.find(m=>_u(u,m.value)),g=e[u];(f==null?void 0:f.value)!=null?l.push(f.id):g!=null&&l.push(g.id)}),l}function RM(e,i){const l=[];return i.forEach(u=>{const f=e.findIndex(g=>g.id===u);if(~f){const g=e[f];l.push(g.value!=null?g.value:f)}}),l}function mu(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"content";const l=N_(),u=Ke();if(Wn){const f=new ResizeObserver(g=>{e==null||e(g,f),g.length&&(i==="content"?u.value=g[0].contentRect:u.value=g[0].target.getBoundingClientRect())});Ir(()=>{f.disconnect()}),en(()=>l.el,(g,m)=>{m&&(f.unobserve(m),u.value=void 0),g&&f.observe(g)},{flush:"post"})}return{resizeRef:l,contentRect:Ch(u)}}function DM(e){let{selectedElement:i,containerElement:l,isRtl:u,isHorizontal:f}=e;const g=_h(f,l),m=cS(f,u,l),o=_h(f,i),T=uS(f,i),k=o*.4;return m>T?T-k:m+g<T+o?T-g+o+k:m}function zM(e){let{selectedElement:i,containerElement:l,isHorizontal:u}=e;const f=_h(u,l),g=uS(u,i),m=_h(u,i);return g-f/2+m/2}function _x(e,i){const l=e?"scrollWidth":"scrollHeight";return(i==null?void 0:i[l])||0}function LM(e,i){const l=e?"clientWidth":"clientHeight";return(i==null?void 0:i[l])||0}function cS(e,i,l){if(!l)return 0;const{scrollLeft:u,offsetWidth:f,scrollWidth:g}=l;return e?i?g-f+u:u:l.scrollTop}function _h(e,i){const l=e?"offsetWidth":"offsetHeight";return(i==null?void 0:i[l])||0}function uS(e,i){const l=e?"offsetLeft":"offsetTop";return(i==null?void 0:i[l])||0}const BM=Symbol.for("vuetify:v-slide-group"),Hy=Ct({centerActive:Boolean,direction:{type:String,default:"horizontal"},symbol:{type:null,default:BM},nextIcon:{type:Gn,default:"$next"},prevIcon:{type:Gn,default:"$prev"},showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["always","desktop","mobile"].includes(e)},...xn(),...nS({mobile:null}),...Ti(),...jy({selectedClass:"v-slide-group-item--active"})},"VSlideGroup"),Wp=Wt()({name:"VSlideGroup",props:Hy(),emits:{"update:modelValue":e=>!0},setup(e,i){let{slots:l}=i;const{isRtl:u}=ja(),{displayClasses:f,mobile:g}=wm(e),m=Sm(e,e.symbol),o=ln(!1),T=ln(0),k=ln(0),I=ln(0),z=ce(()=>e.direction==="horizontal"),{resizeRef:O,contentRect:D}=mu(),{resizeRef:B,contentRect:V}=mu(),Z=MM(),oe=ce(()=>({container:O.el,duration:200,easing:"easeOutQuart"})),pe=ce(()=>m.selected.value.length?m.items.value.findIndex(Qe=>Qe.id===m.selected.value[0]):-1),Se=ce(()=>m.selected.value.length?m.items.value.findIndex(Qe=>Qe.id===m.selected.value[m.selected.value.length-1]):-1);if(Wn){let Qe=-1;en(()=>[m.selected.value,D.value,V.value,z.value],()=>{cancelAnimationFrame(Qe),Qe=requestAnimationFrame(()=>{if(D.value&&V.value){const ct=z.value?"width":"height";k.value=D.value[ct],I.value=V.value[ct],o.value=k.value+1<I.value}if(pe.value>=0&&B.el){const ct=B.el.children[Se.value];be(ct,e.centerActive)}})})}const me=ln(!1);function be(Qe,ct){let zt=0;ct?zt=zM({containerElement:O.el,isHorizontal:z.value,selectedElement:Qe}):zt=DM({containerElement:O.el,isHorizontal:z.value,isRtl:u.value,selectedElement:Qe}),he(zt)}function he(Qe){if(!Wn||!O.el)return;const ct=_h(z.value,O.el),zt=cS(z.value,u.value,O.el);if(!(_x(z.value,O.el)<=ct||Math.abs(Qe-zt)<16)){if(z.value&&u.value&&O.el){const{scrollWidth:Lt,offsetWidth:Yt}=O.el;Qe=Lt-Yt-Qe}z.value?Z.horizontal(Qe,oe.value):Z(Qe,oe.value)}}function Ce(Qe){const{scrollTop:ct,scrollLeft:zt}=Qe.target;T.value=z.value?zt:ct}function ye(Qe){if(me.value=!0,!(!o.value||!B.el)){for(const ct of Qe.composedPath())for(const zt of B.el.children)if(zt===ct){be(zt);return}}}function Me(Qe){me.value=!1}let ke=!1;function Ee(Qe){var ct;!ke&&!me.value&&!(Qe.relatedTarget&&((ct=B.el)!=null&&ct.contains(Qe.relatedTarget)))&&We(),ke=!1}function xe(){ke=!0}function Oe(Qe){if(!B.el)return;function ct(zt){Qe.preventDefault(),We(zt)}z.value?Qe.key==="ArrowRight"?ct(u.value?"prev":"next"):Qe.key==="ArrowLeft"&&ct(u.value?"next":"prev"):Qe.key==="ArrowDown"?ct("next"):Qe.key==="ArrowUp"&&ct("prev"),Qe.key==="Home"?ct("first"):Qe.key==="End"&&ct("last")}function We(Qe){var zt,Jt;if(!B.el)return;let ct;if(!Qe)ct=fh(B.el)[0];else if(Qe==="next"){if(ct=(zt=B.el.querySelector(":focus"))==null?void 0:zt.nextElementSibling,!ct)return We("first")}else if(Qe==="prev"){if(ct=(Jt=B.el.querySelector(":focus"))==null?void 0:Jt.previousElementSibling,!ct)return We("last")}else Qe==="first"?ct=B.el.firstElementChild:Qe==="last"&&(ct=B.el.lastElementChild);ct&&ct.focus({preventScroll:!0})}function dt(Qe){const ct=z.value&&u.value?-1:1,zt=(Qe==="prev"?-ct:ct)*k.value;let Jt=T.value+zt;if(z.value&&u.value&&O.el){const{scrollWidth:Lt,offsetWidth:Yt}=O.el;Jt+=Lt-Yt}he(Jt)}const je=ce(()=>({next:m.next,prev:m.prev,select:m.select,isSelected:m.isSelected})),tt=ce(()=>{switch(e.showArrows){case"always":return!0;case"desktop":return!g.value;case!0:return o.value||Math.abs(T.value)>0;case"mobile":return g.value||o.value||Math.abs(T.value)>0;default:return!g.value&&(o.value||Math.abs(T.value)>0)}}),Et=ce(()=>Math.abs(T.value)>1),_t=ce(()=>{if(!O.value)return!1;const Qe=_x(z.value,O.el),ct=LM(z.value,O.el);return Qe-ct-Math.abs(T.value)>1});return hn(()=>E(e.tag,{class:["v-slide-group",{"v-slide-group--vertical":!z.value,"v-slide-group--has-affixes":tt.value,"v-slide-group--is-overflowing":o.value},f.value,e.class],style:e.style,tabindex:me.value||m.selected.value.length?-1:0,onFocus:Ee},{default:()=>{var Qe,ct,zt;return[tt.value&&E("div",{key:"prev",class:["v-slide-group__prev",{"v-slide-group__prev--disabled":!Et.value}],onMousedown:xe,onClick:()=>Et.value&&dt("prev")},[((Qe=l.prev)==null?void 0:Qe.call(l,je.value))??E(ax,null,{default:()=>[E(ui,{icon:u.value?e.nextIcon:e.prevIcon},null)]})]),E("div",{key:"container",ref:O,class:"v-slide-group__container",onScroll:Ce},[E("div",{ref:B,class:"v-slide-group__content",onFocusin:ye,onFocusout:Me,onKeydown:Oe},[(ct=l.default)==null?void 0:ct.call(l,je.value)])]),tt.value&&E("div",{key:"next",class:["v-slide-group__next",{"v-slide-group__next--disabled":!_t.value}],onMousedown:xe,onClick:()=>_t.value&&dt("next")},[((zt=l.next)==null?void 0:zt.call(l,je.value))??E(ax,null,{default:()=>[E(ui,{icon:u.value?e.prevIcon:e.nextIcon},null)]})])]}})),{selected:m.selected,scrollTo:dt,scrollOffset:T,focus:We,hasPrev:Et,hasNext:_t}}}),dS=Symbol.for("vuetify:v-chip-group"),FM=Ct({column:Boolean,filter:Boolean,valueComparator:{type:Function,default:_u},...Hy(),...xn(),...jy({selectedClass:"v-chip--selected"}),...Ti(),...Di(),...Is({variant:"tonal"})},"VChipGroup");Wt()({name:"VChipGroup",props:FM(),emits:{"update:modelValue":e=>!0},setup(e,i){let{slots:l}=i;const{themeClasses:u}=Hi(e),{isSelected:f,select:g,next:m,prev:o,selected:T}=Sm(e,dS);return Qo({VChip:{color:rn(e,"color"),disabled:rn(e,"disabled"),filter:rn(e,"filter"),variant:rn(e,"variant")}}),hn(()=>{const k=Wp.filterProps(e);return E(Wp,an(k,{class:["v-chip-group",{"v-chip-group--column":e.column},u.value,e.class],style:e.style}),{default:()=>{var I;return[(I=l.default)==null?void 0:I.call(l,{isSelected:f,select:g,next:m,prev:o,selected:T.value})]}})}),{}}});const uo=Ct({elevation:{type:[Number,String],validator(e){const i=parseInt(e);return!isNaN(i)&&i>=0&&i<=24}}},"elevation");function ho(e){return{elevationClasses:ce(()=>{const l=di(e)?e.value:e.elevation,u=[];return l==null||u.push(`elevation-${l}`),u})}}function OM(){const e=Gi("useRoute");return ce(()=>{var i;return(i=e==null?void 0:e.proxy)==null?void 0:i.$route})}function hS(){var e,i;return(i=(e=Gi("useRouter"))==null?void 0:e.proxy)==null?void 0:i.$router}function Cm(e,i){var z,O;const l=zP("RouterLink"),u=ce(()=>!!(e.href||e.to)),f=ce(()=>(u==null?void 0:u.value)||jb(i,"click")||jb(e,"click"));if(typeof l=="string"||!("useLink"in l)){const D=rn(e,"href");return{isLink:u,isClickable:f,href:D,linkProps:br({href:D})}}const g=ce(()=>({...e,to:rn(()=>e.to||"")})),m=l.useLink(g.value),o=ce(()=>e.to?m:void 0),T=OM(),k=ce(()=>{var D,B,V;return o.value?e.exact?T.value?((V=o.value.isExactActive)==null?void 0:V.value)&&_u(o.value.route.value.query,T.value.query):((B=o.value.isExactActive)==null?void 0:B.value)??!1:((D=o.value.isActive)==null?void 0:D.value)??!1:!1}),I=ce(()=>{var D;return e.to?(D=o.value)==null?void 0:D.route.value.href:e.href});return{isLink:u,isClickable:f,isActive:k,route:(z=o.value)==null?void 0:z.route,navigate:(O=o.value)==null?void 0:O.navigate,href:I,linkProps:br({href:I,"aria-current":ce(()=>k.value?"page":void 0)})}}const Tm=Ct({href:String,replace:Boolean,to:[String,Object],exact:Boolean},"router");let h_=!1;function VM(e,i){let l=!1,u,f;Wn&&(Fi(()=>{window.addEventListener("popstate",g),u=e==null?void 0:e.beforeEach((m,o,T)=>{h_?l?i(T):T():setTimeout(()=>l?i(T):T()),h_=!0}),f=e==null?void 0:e.afterEach(()=>{h_=!1})}),kr(()=>{window.removeEventListener("popstate",g),u==null||u(),f==null||f()}));function g(m){var o;(o=m.state)!=null&&o.replaced||(l=!0,setTimeout(()=>l=!1))}}const Z_=Symbol("rippleStop"),NM=80;function yx(e,i){e.style.transform=i,e.style.webkitTransform=i}function q_(e){return e.constructor.name==="TouchEvent"}function fS(e){return e.constructor.name==="KeyboardEvent"}const $M=function(e,i){var z;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},u=0,f=0;if(!fS(e)){const O=i.getBoundingClientRect(),D=q_(e)?e.touches[e.touches.length-1]:e;u=D.clientX-O.left,f=D.clientY-O.top}let g=0,m=.3;(z=i._ripple)!=null&&z.circle?(m=.15,g=i.clientWidth/2,g=l.center?g:g+Math.sqrt((u-g)**2+(f-g)**2)/4):g=Math.sqrt(i.clientWidth**2+i.clientHeight**2)/2;const o=`${(i.clientWidth-g*2)/2}px`,T=`${(i.clientHeight-g*2)/2}px`,k=l.center?o:`${u-g}px`,I=l.center?T:`${f-g}px`;return{radius:g,scale:m,x:k,y:I,centerX:o,centerY:T}},Xp={show(e,i){var D;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!((D=i==null?void 0:i._ripple)!=null&&D.enabled))return;const u=document.createElement("span"),f=document.createElement("span");u.appendChild(f),u.className="v-ripple__container",l.class&&(u.className+=` ${l.class}`);const{radius:g,scale:m,x:o,y:T,centerX:k,centerY:I}=$M(e,i,l),z=`${g*2}px`;f.className="v-ripple__animation",f.style.width=z,f.style.height=z,i.appendChild(u);const O=window.getComputedStyle(i);O&&O.position==="static"&&(i.style.position="relative",i.dataset.previousPosition="static"),f.classList.add("v-ripple__animation--enter"),f.classList.add("v-ripple__animation--visible"),yx(f,`translate(${o}, ${T}) scale3d(${m},${m},${m})`),f.dataset.activated=String(performance.now()),setTimeout(()=>{f.classList.remove("v-ripple__animation--enter"),f.classList.add("v-ripple__animation--in"),yx(f,`translate(${k}, ${I}) scale3d(1,1,1)`)},0)},hide(e){var g;if(!((g=e==null?void 0:e._ripple)!=null&&g.enabled))return;const i=e.getElementsByClassName("v-ripple__animation");if(i.length===0)return;const l=i[i.length-1];if(l.dataset.isHiding)return;l.dataset.isHiding="true";const u=performance.now()-Number(l.dataset.activated),f=Math.max(250-u,0);setTimeout(()=>{l.classList.remove("v-ripple__animation--in"),l.classList.add("v-ripple__animation--out"),setTimeout(()=>{var o;e.getElementsByClassName("v-ripple__animation").length===1&&e.dataset.previousPosition&&(e.style.position=e.dataset.previousPosition,delete e.dataset.previousPosition),((o=l.parentNode)==null?void 0:o.parentNode)===e&&e.removeChild(l.parentNode)},300)},f)}};function pS(e){return typeof e>"u"||!!e}function yh(e){const i={},l=e.currentTarget;if(!(!(l!=null&&l._ripple)||l._ripple.touched||e[Z_])){if(e[Z_]=!0,q_(e))l._ripple.touched=!0,l._ripple.isTouch=!0;else if(l._ripple.isTouch)return;if(i.center=l._ripple.centered||fS(e),l._ripple.class&&(i.class=l._ripple.class),q_(e)){if(l._ripple.showTimerCommit)return;l._ripple.showTimerCommit=()=>{Xp.show(e,l,i)},l._ripple.showTimer=window.setTimeout(()=>{var u;(u=l==null?void 0:l._ripple)!=null&&u.showTimerCommit&&(l._ripple.showTimerCommit(),l._ripple.showTimerCommit=null)},NM)}else Xp.show(e,l,i)}}function vx(e){e[Z_]=!0}function ba(e){const i=e.currentTarget;if(i!=null&&i._ripple){if(window.clearTimeout(i._ripple.showTimer),e.type==="touchend"&&i._ripple.showTimerCommit){i._ripple.showTimerCommit(),i._ripple.showTimerCommit=null,i._ripple.showTimer=window.setTimeout(()=>{ba(e)});return}window.setTimeout(()=>{i._ripple&&(i._ripple.touched=!1)}),Xp.hide(i)}}function mS(e){const i=e.currentTarget;i!=null&&i._ripple&&(i._ripple.showTimerCommit&&(i._ripple.showTimerCommit=null),window.clearTimeout(i._ripple.showTimer))}let vh=!1;function gS(e){!vh&&(e.keyCode===Ob.enter||e.keyCode===Ob.space)&&(vh=!0,yh(e))}function _S(e){vh=!1,ba(e)}function yS(e){vh&&(vh=!1,ba(e))}function vS(e,i,l){const{value:u,modifiers:f}=i,g=pS(u);if(g||Xp.hide(e),e._ripple=e._ripple??{},e._ripple.enabled=g,e._ripple.centered=f.center,e._ripple.circle=f.circle,My(u)&&u.class&&(e._ripple.class=u.class),g&&!l){if(f.stop){e.addEventListener("touchstart",vx,{passive:!0}),e.addEventListener("mousedown",vx);return}e.addEventListener("touchstart",yh,{passive:!0}),e.addEventListener("touchend",ba,{passive:!0}),e.addEventListener("touchmove",mS,{passive:!0}),e.addEventListener("touchcancel",ba),e.addEventListener("mousedown",yh),e.addEventListener("mouseup",ba),e.addEventListener("mouseleave",ba),e.addEventListener("keydown",gS),e.addEventListener("keyup",_S),e.addEventListener("blur",yS),e.addEventListener("dragstart",ba,{passive:!0})}else!g&&l&&bS(e)}function bS(e){e.removeEventListener("mousedown",yh),e.removeEventListener("touchstart",yh),e.removeEventListener("touchend",ba),e.removeEventListener("touchmove",mS),e.removeEventListener("touchcancel",ba),e.removeEventListener("mouseup",ba),e.removeEventListener("mouseleave",ba),e.removeEventListener("keydown",gS),e.removeEventListener("keyup",_S),e.removeEventListener("dragstart",ba),e.removeEventListener("blur",yS)}function jM(e,i){vS(e,i,!1)}function UM(e){delete e._ripple,bS(e)}function GM(e,i){if(i.value===i.oldValue)return;const l=pS(i.oldValue);vS(e,i,l)}const zh={mounted:jM,unmounted:UM,updated:GM},HM=Ct({activeClass:String,appendAvatar:String,appendIcon:Gn,closable:Boolean,closeIcon:{type:Gn,default:"$delete"},closeLabel:{type:String,default:"$vuetify.close"},draggable:Boolean,filter:Boolean,filterIcon:{type:Gn,default:"$complete"},label:Boolean,link:{type:Boolean,default:void 0},pill:Boolean,prependAvatar:String,prependIcon:Gn,ripple:{type:[Boolean,Object],default:!0},text:String,modelValue:{type:Boolean,default:!0},onClick:sa(),onClickOnce:sa(),...lo(),...xn(),...Pa(),...uo(),...Uy(),...ua(),...Tm(),...Eh(),...Ti({tag:"span"}),...Di(),...Is({variant:"tonal"})},"VChip"),on=Wt()({name:"VChip",directives:{Ripple:zh},props:HM(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0,"group:selected":e=>!0,click:e=>!0},setup(e,i){let{attrs:l,emit:u,slots:f}=i;const{t:g}=Dh(),{borderClasses:m}=co(e),{colorClasses:o,colorStyles:T,variantClasses:k}=tc(e),{densityClasses:I}=$a(e),{elevationClasses:z}=ho(e),{roundedClasses:O}=da(e),{sizeClasses:D}=Ah(e),{themeClasses:B}=Hi(e),V=ai(e,"modelValue"),Z=Gy(e,dS,!1),oe=Cm(e,l),pe=ce(()=>e.link!==!1&&oe.isLink.value),Se=ce(()=>!e.disabled&&e.link!==!1&&(!!Z||e.link||oe.isClickable.value)),me=ce(()=>({"aria-label":g(e.closeLabel),onClick(Ce){Ce.preventDefault(),Ce.stopPropagation(),V.value=!1,u("click:close",Ce)}}));function be(Ce){var ye;u("click",Ce),Se.value&&((ye=oe.navigate)==null||ye.call(oe,Ce),Z==null||Z.toggle())}function he(Ce){(Ce.key==="Enter"||Ce.key===" ")&&(Ce.preventDefault(),be(Ce))}return()=>{var dt;const Ce=oe.isLink.value?"a":e.tag,ye=!!(e.appendIcon||e.appendAvatar),Me=!!(ye||f.append),ke=!!(f.close||e.closable),Ee=!!(f.filter||e.filter)&&Z,xe=!!(e.prependIcon||e.prependAvatar),Oe=!!(xe||f.prepend),We=!Z||Z.isSelected.value;return V.value&&Pr(E(Ce,an({class:["v-chip",{"v-chip--disabled":e.disabled,"v-chip--label":e.label,"v-chip--link":Se.value,"v-chip--filter":Ee,"v-chip--pill":e.pill,[`${e.activeClass}`]:e.activeClass&&((dt=oe.isActive)==null?void 0:dt.value)},B.value,m.value,We?o.value:void 0,I.value,z.value,O.value,D.value,k.value,Z==null?void 0:Z.selectedClass.value,e.class],style:[We?T.value:void 0,e.style],disabled:e.disabled||void 0,draggable:e.draggable,tabindex:Se.value?0:void 0,onClick:be,onKeydown:Se.value&&!pe.value&&he},oe.linkProps),{default:()=>{var je;return[ec(Se.value,"v-chip"),Ee&&E(Kw,{key:"filter"},{default:()=>[Pr(E("div",{class:"v-chip__filter"},[f.filter?E(Bi,{key:"filter-defaults",disabled:!e.filterIcon,defaults:{VIcon:{icon:e.filterIcon}}},f.filter):E(ui,{key:"filter-icon",icon:e.filterIcon},null)]),[[Ql,Z.isSelected.value]])]}),Oe&&E("div",{key:"prepend",class:"v-chip__prepend"},[f.prepend?E(Bi,{key:"prepend-defaults",disabled:!xe,defaults:{VAvatar:{image:e.prependAvatar,start:!0},VIcon:{icon:e.prependIcon,start:!0}}},f.prepend):E(un,null,[e.prependIcon&&E(ui,{key:"prepend-icon",icon:e.prependIcon,start:!0},null),e.prependAvatar&&E(Kl,{key:"prepend-avatar",image:e.prependAvatar,start:!0},null)])]),E("div",{class:"v-chip__content","data-no-activator":""},[((je=f.default)==null?void 0:je.call(f,{isSelected:Z==null?void 0:Z.isSelected.value,selectedClass:Z==null?void 0:Z.selectedClass.value,select:Z==null?void 0:Z.select,toggle:Z==null?void 0:Z.toggle,value:Z==null?void 0:Z.value.value,disabled:e.disabled}))??e.text]),Me&&E("div",{key:"append",class:"v-chip__append"},[f.append?E(Bi,{key:"append-defaults",disabled:!ye,defaults:{VAvatar:{end:!0,image:e.appendAvatar},VIcon:{end:!0,icon:e.appendIcon}}},f.append):E(un,null,[e.appendIcon&&E(ui,{key:"append-icon",end:!0,icon:e.appendIcon},null),e.appendAvatar&&E(Kl,{key:"append-avatar",end:!0,image:e.appendAvatar},null)])]),ke&&E("button",an({key:"close",class:"v-chip__close",type:"button","data-testid":"close-chip"},me.value),[f.close?E(Bi,{key:"close-defaults",defaults:{VIcon:{icon:e.closeIcon,size:"x-small"}}},f.close):E(ui,{key:"close-icon",icon:e.closeIcon,size:"x-small"},null)])]}}),[[oo("ripple"),Se.value&&e.ripple,null]])}}});const bx={center:"center",top:"bottom",bottom:"top",left:"right",right:"left"},vu=Ct({location:String},"location");function Lh(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=arguments.length>2?arguments[2]:void 0;const{isRtl:u}=ja();return{locationStyles:ce(()=>{if(!e.location)return{};const{side:g,align:m}=$_(e.location.split(" ").length>1?e.location:`${e.location} center`,u.value);function o(k){return l?l(k):0}const T={};return g!=="center"&&(i?T[bx[g]]=`calc(100% - ${o(g)}px)`:T[g]=0),m!=="center"?i?T[bx[m]]=`calc(100% - ${o(m)}px)`:T[m]=0:(g==="center"?T.top=T.left="50%":T[{top:"left",bottom:"left",left:"top",right:"top"}[g]]="50%",T.transform={top:"translateX(-50%)",bottom:"translateX(-50%)",left:"translateY(-50%)",right:"translateY(-50%)",center:"translate(-50%, -50%)"}[g]),T})}}const ZM=["static","relative","fixed","absolute","sticky"],Bh=Ct({position:{type:String,validator:e=>ZM.includes(e)}},"position");function Fh(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ks();return{positionClasses:ce(()=>e.position?`${i}--${e.position}`:void 0)}}const qM=Ct({color:String,...lo(),...xn(),...Va(),...uo(),...vu(),...Bh(),...ua(),...Ti(),...Di()},"VSheet"),WM=Wt()({name:"VSheet",props:qM(),setup(e,i){let{slots:l}=i;const{themeClasses:u}=Hi(e),{backgroundColorClasses:f,backgroundColorStyles:g}=Fa(rn(e,"color")),{borderClasses:m}=co(e),{dimensionStyles:o}=Na(e),{elevationClasses:T}=ho(e),{locationStyles:k}=Lh(e),{positionClasses:I}=Fh(e),{roundedClasses:z}=da(e);return hn(()=>E(e.tag,{class:["v-sheet",u.value,f.value,m.value,T.value,I.value,z.value,e.class],style:[g.value,o.value,k.value,e.style]},l)),{}}}),XM={class:"d-flex ga-1"},KM={class:"inline"},YM=Vn({__name:"TopBar",setup(e){const i=ei(),l=ce(()=>i.baseData.data.allowBuyingCrypto||i.baseData.data.allowSellingCrypto||i.baseData.data.allowTransferCrypto);return(u,f)=>(Fe(),ft(WM,{class:"topbar"},{default:K(()=>{var g,m,o,T,k,I,z,O;return[Xe("div",XM,[E(on,null,{default:K(()=>{var D,B;return[Ne(ee(U(ne)("user"))+": "+ee((B=(D=U(i).baseData)==null?void 0:D.data)!=null&&B.currentRacerName?U(i).baseData.data.currentRacerName:U(ne)("user_no")),1)]}),_:1}),E(on,null,{default:K(()=>{var D,B;return[Ne(ee(U(ne)("auth"))+": "+ee((B=(D=U(i).baseData)==null?void 0:D.data)!=null&&B.currentRacerAuth?U(i).baseData.data.currentRacerAuth:U(ne)("auth_no")),1)]}),_:1}),(m=(g=U(i).baseData)==null?void 0:g.data)!=null&&m.currentCrewName?(Fe(),ft(on,{key:0},{default:K(()=>[Ne(ee(U(ne)("crew"))+": "+ee(U(i).baseData.data.currentCrewName),1)]),_:1})):Mt("",!0),(T=(o=U(i).baseData)==null?void 0:o.data)!=null&&T.currentRanking?(Fe(),ft(on,{key:1},{default:K(()=>[Ne(ee(U(ne)("rank"))+": "+ee(U(i).baseData.data.currentRanking),1)]),_:1})):Mt("",!0),(I=(k=U(i).baseData)==null?void 0:k.data)!=null&&I.currentVehicle?(Fe(),ft(on,{key:2},{default:K(()=>[Ne(ee(U(ne)("vehicle"))+": "+ee(U(i).baseData.data.currentVehicle.model)+" ["+ee(U(i).baseData.data.currentVehicle.class)+"] ",1)]),_:1})):Mt("",!0),U(i).baseData.data.currentRacerName&&((O=(z=U(i).baseData)==null?void 0:z.data)!=null&&O.isUsingRacingCrypto)?(Fe(),ft(on,{key:3,color:"orange",onClick:f[0]||(f[0]=D=>l.value?U(i).showCryptoModal=!0:void 0)},{default:K(()=>[Ne(ee(U(i).baseData.data.currentCrypto)+" "+ee(U(i).baseData.data.cryptoType),1)]),_:1})):Mt("",!0)]),Xe("div",KM,[E(ui,{icon:"mdi-signal"}),E(ui,{icon:"mdi-battery-70"}),f[1]||(f[1]=Ne(" 75% "))])]}),_:1}))}});const Pi=(e,i)=>{const l=e.__vccOpts||e;for(const[u,f]of i)l[u]=f;return l},JM=Pi(YM,[["__scopeId","data-v-66056fcd"]]);const W_=Symbol.for("vuetify:list");function xS(){const e=ri(W_,{hasPrepend:ln(!1),updateHasPrepend:()=>null}),i={hasPrepend:ln(!1),updateHasPrepend:l=>{l&&(i.hasPrepend.value=l)}};return Mr(W_,i),e}function wS(){return ri(W_,null)}const Zy=e=>{const i={activate:l=>{let{id:u,value:f,activated:g}=l;return u=fn(u),e&&!f&&g.size===1&&g.has(u)||(f?g.add(u):g.delete(u)),g},in:(l,u,f)=>{let g=new Set;if(l!=null)for(const m of rs(l))g=i.activate({id:m,value:!0,activated:new Set(g),children:u,parents:f});return g},out:l=>Array.from(l)};return i},SS=e=>{const i=Zy(e);return{activate:u=>{let{activated:f,id:g,...m}=u;g=fn(g);const o=f.has(g)?new Set([g]):new Set;return i.activate({...m,id:g,activated:o})},in:(u,f,g)=>{let m=new Set;if(u!=null){const o=rs(u);o.length&&(m=i.in(o.slice(0,1),f,g))}return m},out:(u,f,g)=>i.out(u,f,g)}},QM=e=>{const i=Zy(e);return{activate:u=>{let{id:f,activated:g,children:m,...o}=u;return f=fn(f),m.has(f)?g:i.activate({id:f,activated:g,children:m,...o})},in:i.in,out:i.out}},eE=e=>{const i=SS(e);return{activate:u=>{let{id:f,activated:g,children:m,...o}=u;return f=fn(f),m.has(f)?g:i.activate({id:f,activated:g,children:m,...o})},in:i.in,out:i.out}},tE={open:e=>{let{id:i,value:l,opened:u,parents:f}=e;if(l){const g=new Set;g.add(i);let m=f.get(i);for(;m!=null;)g.add(m),m=f.get(m);return g}else return u.delete(i),u},select:()=>null},CS={open:e=>{let{id:i,value:l,opened:u,parents:f}=e;if(l){let g=f.get(i);for(u.add(i);g!=null&&g!==i;)u.add(g),g=f.get(g);return u}else u.delete(i);return u},select:()=>null},nE={open:CS.open,select:e=>{let{id:i,value:l,opened:u,parents:f}=e;if(!l)return u;const g=[];let m=f.get(i);for(;m!=null;)g.push(m),m=f.get(m);return new Set(g)}},qy=e=>{const i={select:l=>{let{id:u,value:f,selected:g}=l;if(u=fn(u),e&&!f){const m=Array.from(g.entries()).reduce((o,T)=>{let[k,I]=T;return I==="on"&&o.push(k),o},[]);if(m.length===1&&m[0]===u)return g}return g.set(u,f?"on":"off"),g},in:(l,u,f)=>{let g=new Map;for(const m of l||[])g=i.select({id:m,value:!0,selected:new Map(g),children:u,parents:f});return g},out:l=>{const u=[];for(const[f,g]of l.entries())g==="on"&&u.push(f);return u}};return i},TS=e=>{const i=qy(e);return{select:u=>{let{selected:f,id:g,...m}=u;g=fn(g);const o=f.has(g)?new Map([[g,f.get(g)]]):new Map;return i.select({...m,id:g,selected:o})},in:(u,f,g)=>{let m=new Map;return u!=null&&u.length&&(m=i.in(u.slice(0,1),f,g)),m},out:(u,f,g)=>i.out(u,f,g)}},iE=e=>{const i=qy(e);return{select:u=>{let{id:f,selected:g,children:m,...o}=u;return f=fn(f),m.has(f)?g:i.select({id:f,selected:g,children:m,...o})},in:i.in,out:i.out}},rE=e=>{const i=TS(e);return{select:u=>{let{id:f,selected:g,children:m,...o}=u;return f=fn(f),m.has(f)?g:i.select({id:f,selected:g,children:m,...o})},in:i.in,out:i.out}},aE=e=>{const i={select:l=>{let{id:u,value:f,selected:g,children:m,parents:o}=l;u=fn(u);const T=new Map(g),k=[u];for(;k.length;){const z=k.shift();g.set(fn(z),f?"on":"off"),m.has(z)&&k.push(...m.get(z))}let I=fn(o.get(u));for(;I;){const z=m.get(I),O=z.every(B=>g.get(fn(B))==="on"),D=z.every(B=>!g.has(fn(B))||g.get(fn(B))==="off");g.set(I,O?"on":D?"off":"indeterminate"),I=fn(o.get(I))}return e&&!f&&Array.from(g.entries()).reduce((O,D)=>{let[B,V]=D;return V==="on"&&O.push(B),O},[]).length===0?T:g},in:(l,u,f)=>{let g=new Map;for(const m of l||[])g=i.select({id:m,value:!0,selected:new Map(g),children:u,parents:f});return g},out:(l,u)=>{const f=[];for(const[g,m]of l.entries())m==="on"&&!u.has(g)&&f.push(g);return f}};return i},bh=Symbol.for("vuetify:nested"),PS={id:ln(),root:{register:()=>null,unregister:()=>null,parents:Ke(new Map),children:Ke(new Map),open:()=>null,openOnSelect:()=>null,activate:()=>null,select:()=>null,activatable:Ke(!1),selectable:Ke(!1),opened:Ke(new Set),activated:Ke(new Set),selected:Ke(new Map),selectedValues:Ke([]),getPath:()=>[]}},sE=Ct({activatable:Boolean,selectable:Boolean,activeStrategy:[String,Function,Object],selectStrategy:[String,Function,Object],openStrategy:[String,Object],opened:null,activated:null,selected:null,mandatory:Boolean},"nested"),oE=e=>{let i=!1;const l=Ke(new Map),u=Ke(new Map),f=ai(e,"opened",e.opened,B=>new Set(B),B=>[...B.values()]),g=ce(()=>{if(typeof e.activeStrategy=="object")return e.activeStrategy;if(typeof e.activeStrategy=="function")return e.activeStrategy(e.mandatory);switch(e.activeStrategy){case"leaf":return QM(e.mandatory);case"single-leaf":return eE(e.mandatory);case"independent":return Zy(e.mandatory);case"single-independent":default:return SS(e.mandatory)}}),m=ce(()=>{if(typeof e.selectStrategy=="object")return e.selectStrategy;if(typeof e.selectStrategy=="function")return e.selectStrategy(e.mandatory);switch(e.selectStrategy){case"single-leaf":return rE(e.mandatory);case"leaf":return iE(e.mandatory);case"independent":return qy(e.mandatory);case"single-independent":return TS(e.mandatory);case"classic":default:return aE(e.mandatory)}}),o=ce(()=>{if(typeof e.openStrategy=="object")return e.openStrategy;switch(e.openStrategy){case"list":return nE;case"single":return tE;case"multiple":default:return CS}}),T=ai(e,"activated",e.activated,B=>g.value.in(B,l.value,u.value),B=>g.value.out(B,l.value,u.value)),k=ai(e,"selected",e.selected,B=>m.value.in(B,l.value,u.value),B=>m.value.out(B,l.value,u.value));Ir(()=>{i=!0});function I(B){const V=[];let Z=B;for(;Z!=null;)V.unshift(Z),Z=u.value.get(Z);return V}const z=Gi("nested"),O=new Set,D={id:ln(),root:{opened:f,activatable:rn(e,"activatable"),selectable:rn(e,"selectable"),activated:T,selected:k,selectedValues:ce(()=>{const B=[];for(const[V,Z]of k.value.entries())Z==="on"&&B.push(V);return B}),register:(B,V,Z)=>{if(O.has(B)){I(B).map(String).join(" -> "),I(V).concat(B).map(String).join(" -> ");return}else O.add(B);V&&B!==V&&u.value.set(B,V),Z&&l.value.set(B,[]),V!=null&&l.value.set(V,[...l.value.get(V)||[],B])},unregister:B=>{if(i)return;O.delete(B),l.value.delete(B);const V=u.value.get(B);if(V){const Z=l.value.get(V)??[];l.value.set(V,Z.filter(oe=>oe!==B))}u.value.delete(B)},open:(B,V,Z)=>{z.emit("click:open",{id:B,value:V,path:I(B),event:Z});const oe=o.value.open({id:B,value:V,opened:new Set(f.value),children:l.value,parents:u.value,event:Z});oe&&(f.value=oe)},openOnSelect:(B,V,Z)=>{const oe=o.value.select({id:B,value:V,selected:new Map(k.value),opened:new Set(f.value),children:l.value,parents:u.value,event:Z});oe&&(f.value=oe)},select:(B,V,Z)=>{z.emit("click:select",{id:B,value:V,path:I(B),event:Z});const oe=m.value.select({id:B,value:V,selected:new Map(k.value),children:l.value,parents:u.value,event:Z});oe&&(k.value=oe),D.root.openOnSelect(B,V,Z)},activate:(B,V,Z)=>{if(!e.activatable)return D.root.select(B,!0,Z);z.emit("click:activate",{id:B,value:V,path:I(B),event:Z});const oe=g.value.activate({id:B,value:V,activated:new Set(T.value),children:l.value,parents:u.value,event:Z});oe&&(T.value=oe)},children:l,parents:u,getPath:I}};return Mr(bh,D),D.root},kS=(e,i)=>{const l=ri(bh,PS),u=Symbol(Ca()),f=ce(()=>e.value!==void 0?e.value:u),g={...l,id:f,open:(m,o)=>l.root.open(f.value,m,o),openOnSelect:(m,o)=>l.root.openOnSelect(f.value,m,o),isOpen:ce(()=>l.root.opened.value.has(f.value)),parent:ce(()=>l.root.parents.value.get(f.value)),activate:(m,o)=>l.root.activate(f.value,m,o),isActivated:ce(()=>l.root.activated.value.has(fn(f.value))),select:(m,o)=>l.root.select(f.value,m,o),isSelected:ce(()=>l.root.selected.value.get(fn(f.value))==="on"),isIndeterminate:ce(()=>l.root.selected.value.get(f.value)==="indeterminate"),isLeaf:ce(()=>!l.root.children.value.get(f.value)),isGroupActivator:l.isGroupActivator};return Ph(()=>{!l.isGroupActivator&&l.root.register(f.value,l.id.value,i)}),Ir(()=>{!l.isGroupActivator&&l.root.unregister(f.value)}),i&&Mr(bh,g),g},lE=()=>{const e=ri(bh,PS);Mr(bh,{...e,isGroupActivator:!0})};function Wy(){const e=ln(!1);return Qn(()=>{window.requestAnimationFrame(()=>{e.value=!0})}),{ssrBootStyles:ce(()=>e.value?void 0:{transition:"none !important"}),isBooted:Ch(e)}}const cE=yu({name:"VListGroupActivator",setup(e,i){let{slots:l}=i;return lE(),()=>{var u;return(u=l.default)==null?void 0:u.call(l)}}}),uE=Ct({activeColor:String,baseColor:String,color:String,collapseIcon:{type:Gn,default:"$collapse"},expandIcon:{type:Gn,default:"$expand"},prependIcon:Gn,appendIcon:Gn,fluid:Boolean,subgroup:Boolean,title:String,value:null,...xn(),...Ti()},"VListGroup"),xx=Wt()({name:"VListGroup",props:uE(),setup(e,i){let{slots:l}=i;const{isOpen:u,open:f,id:g}=kS(rn(e,"value"),!0),m=ce(()=>`v-list-group--id-${String(g.value)}`),o=wS(),{isBooted:T}=Wy();function k(D){D.stopPropagation(),f(!u.value,D)}const I=ce(()=>({onClick:k,class:"v-list-group__header",id:m.value})),z=ce(()=>u.value?e.collapseIcon:e.expandIcon),O=ce(()=>({VListItem:{active:u.value,activeColor:e.activeColor,baseColor:e.baseColor,color:e.color,prependIcon:e.prependIcon||e.subgroup&&z.value,appendIcon:e.appendIcon||!e.subgroup&&z.value,title:e.title,value:e.value}}));return hn(()=>E(e.tag,{class:["v-list-group",{"v-list-group--prepend":o==null?void 0:o.hasPrepend.value,"v-list-group--fluid":e.fluid,"v-list-group--subgroup":e.subgroup,"v-list-group--open":u.value},e.class],style:e.style},{default:()=>[l.activator&&E(Bi,{defaults:O.value},{default:()=>[E(cE,null,{default:()=>[l.activator({props:I.value,isOpen:u.value})]})]}),E(to,{transition:{component:tM},disabled:!T.value},{default:()=>{var D;return[Pr(E("div",{class:"v-list-group__items",role:"group","aria-labelledby":m.value},[(D=l.default)==null?void 0:D.call(l)]),[[Ql,u.value]])]}})]})),{isOpen:u}}});const dE=Ct({opacity:[Number,String],...xn(),...Ti()},"VListItemSubtitle"),hE=Wt()({name:"VListItemSubtitle",props:dE(),setup(e,i){let{slots:l}=i;return hn(()=>E(e.tag,{class:["v-list-item-subtitle",e.class],style:[{"--v-list-item-subtitle-opacity":e.opacity},e.style]},l)),{}}}),fE=vm("v-list-item-title"),pE=Ct({active:{type:Boolean,default:void 0},activeClass:String,activeColor:String,appendAvatar:String,appendIcon:Gn,baseColor:String,disabled:Boolean,lines:[Boolean,String],link:{type:Boolean,default:void 0},nav:Boolean,prependAvatar:String,prependIcon:Gn,ripple:{type:[Boolean,Object],default:!0},slim:Boolean,subtitle:[String,Number],title:[String,Number],value:null,onClick:sa(),onClickOnce:sa(),...lo(),...xn(),...Pa(),...Va(),...uo(),...ua(),...Tm(),...Ti(),...Di(),...Is({variant:"text"})},"VListItem"),za=Wt()({name:"VListItem",directives:{Ripple:zh},props:pE(),emits:{click:e=>!0},setup(e,i){let{attrs:l,slots:u,emit:f}=i;const g=Cm(e,l),m=ce(()=>e.value===void 0?g.href.value:e.value),{activate:o,isActivated:T,select:k,isOpen:I,isSelected:z,isIndeterminate:O,isGroupActivator:D,root:B,parent:V,openOnSelect:Z,id:oe}=kS(m,!1),pe=wS(),Se=ce(()=>{var Lt;return e.active!==!1&&(e.active||((Lt=g.isActive)==null?void 0:Lt.value)||(B.activatable.value?T.value:z.value))}),me=ce(()=>e.link!==!1&&g.isLink.value),be=ce(()=>!!pe&&(B.selectable.value||B.activatable.value||e.value!=null)),he=ce(()=>!e.disabled&&e.link!==!1&&(e.link||g.isClickable.value||be.value)),Ce=ce(()=>e.rounded||e.nav),ye=ce(()=>e.color??e.activeColor),Me=ce(()=>({color:Se.value?ye.value??e.baseColor:e.baseColor,variant:e.variant}));en(()=>{var Lt;return(Lt=g.isActive)==null?void 0:Lt.value},Lt=>{Lt&&ke()}),Ph(()=>{var Lt;(Lt=g.isActive)!=null&&Lt.value&&ke()});function ke(){V.value!=null&&B.open(V.value,!0),Z(!0)}const{themeClasses:Ee}=Hi(e),{borderClasses:xe}=co(e),{colorClasses:Oe,colorStyles:We,variantClasses:dt}=tc(Me),{densityClasses:je}=$a(e),{dimensionStyles:tt}=Na(e),{elevationClasses:Et}=ho(e),{roundedClasses:_t}=da(Ce),Qe=ce(()=>e.lines?`v-list-item--${e.lines}-line`:void 0),ct=ce(()=>({isActive:Se.value,select:k,isOpen:I.value,isSelected:z.value,isIndeterminate:O.value}));function zt(Lt){var Yt;f("click",Lt),he.value&&((Yt=g.navigate)==null||Yt.call(g,Lt),!D&&(B.activatable.value?o(!T.value,Lt):(B.selectable.value||e.value!=null)&&k(!z.value,Lt)))}function Jt(Lt){(Lt.key==="Enter"||Lt.key===" ")&&(Lt.preventDefault(),Lt.target.dispatchEvent(new MouseEvent("click",Lt)))}return hn(()=>{const Lt=me.value?"a":e.tag,Yt=u.title||e.title!=null,qt=u.subtitle||e.subtitle!=null,_n=!!(e.appendAvatar||e.appendIcon),bn=!!(_n||u.append),jn=!!(e.prependAvatar||e.prependIcon),Nn=!!(jn||u.prepend);return pe==null||pe.updateHasPrepend(Nn),e.activeColor&&MI("active-color",["color","base-color"]),Pr(E(Lt,an({class:["v-list-item",{"v-list-item--active":Se.value,"v-list-item--disabled":e.disabled,"v-list-item--link":he.value,"v-list-item--nav":e.nav,"v-list-item--prepend":!Nn&&(pe==null?void 0:pe.hasPrepend.value),"v-list-item--slim":e.slim,[`${e.activeClass}`]:e.activeClass&&Se.value},Ee.value,xe.value,Oe.value,je.value,Et.value,Qe.value,_t.value,dt.value,e.class],style:[We.value,tt.value,e.style],tabindex:he.value?pe?-2:0:void 0,"aria-selected":be.value?B.activatable.value?T.value:B.selectable.value?z.value:Se.value:void 0,onClick:zt,onKeydown:he.value&&!me.value&&Jt},g.linkProps),{default:()=>{var si;return[ec(he.value||Se.value,"v-list-item"),Nn&&E("div",{key:"prepend",class:"v-list-item__prepend"},[u.prepend?E(Bi,{key:"prepend-defaults",disabled:!jn,defaults:{VAvatar:{density:e.density,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon},VListItemAction:{start:!0}}},{default:()=>{var En;return[(En=u.prepend)==null?void 0:En.call(u,ct.value)]}}):E(un,null,[e.prependAvatar&&E(Kl,{key:"prepend-avatar",density:e.density,image:e.prependAvatar},null),e.prependIcon&&E(ui,{key:"prepend-icon",density:e.density,icon:e.prependIcon},null)]),E("div",{class:"v-list-item__spacer"},null)]),E("div",{class:"v-list-item__content","data-no-activator":""},[Yt&&E(fE,{key:"title"},{default:()=>{var En;return[((En=u.title)==null?void 0:En.call(u,{title:e.title}))??e.title]}}),qt&&E(hE,{key:"subtitle"},{default:()=>{var En;return[((En=u.subtitle)==null?void 0:En.call(u,{subtitle:e.subtitle}))??e.subtitle]}}),(si=u.default)==null?void 0:si.call(u,ct.value)]),bn&&E("div",{key:"append",class:"v-list-item__append"},[u.append?E(Bi,{key:"append-defaults",disabled:!_n,defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon},VListItemAction:{end:!0}}},{default:()=>{var En;return[(En=u.append)==null?void 0:En.call(u,ct.value)]}}):E(un,null,[e.appendIcon&&E(ui,{key:"append-icon",density:e.density,icon:e.appendIcon},null),e.appendAvatar&&E(Kl,{key:"append-avatar",density:e.density,image:e.appendAvatar},null)]),E("div",{class:"v-list-item__spacer"},null)])]}}),[[oo("ripple"),he.value&&e.ripple]])}),{activate:o,isActivated:T,isGroupActivator:D,isSelected:z,list:pe,select:k,root:B,id:oe}}}),mE=Ct({color:String,inset:Boolean,sticky:Boolean,title:String,...xn(),...Ti()},"VListSubheader"),gE=Wt()({name:"VListSubheader",props:mE(),setup(e,i){let{slots:l}=i;const{textColorClasses:u,textColorStyles:f}=os(rn(e,"color"));return hn(()=>{const g=!!(l.default||e.title);return E(e.tag,{class:["v-list-subheader",{"v-list-subheader--inset":e.inset,"v-list-subheader--sticky":e.sticky},u.value,e.class],style:[{textColorStyles:f},e.style]},{default:()=>{var m;return[g&&E("div",{class:"v-list-subheader__text"},[((m=l.default)==null?void 0:m.call(l))??e.title])]}})}),{}}});const _E=Ct({color:String,inset:Boolean,length:[Number,String],opacity:[Number,String],thickness:[Number,String],vertical:Boolean,...xn(),...Di()},"VDivider"),IS=Wt()({name:"VDivider",props:_E(),setup(e,i){let{attrs:l,slots:u}=i;const{themeClasses:f}=Hi(e),{textColorClasses:g,textColorStyles:m}=os(rn(e,"color")),o=ce(()=>{const T={};return e.length&&(T[e.vertical?"height":"width"]=mn(e.length)),e.thickness&&(T[e.vertical?"borderRightWidth":"borderTopWidth"]=mn(e.thickness)),T});return hn(()=>{const T=E("hr",{class:[{"v-divider":!0,"v-divider--inset":e.inset,"v-divider--vertical":e.vertical},f.value,g.value,e.class],style:[o.value,m.value,{"--v-border-opacity":e.opacity},e.style],"aria-orientation":!l.role||l.role==="separator"?e.vertical?"vertical":"horizontal":void 0,role:`${l.role||"separator"}`},null);return u.default?E("div",{class:["v-divider__wrapper",{"v-divider__wrapper--vertical":e.vertical,"v-divider__wrapper--inset":e.inset}]},[T,E("div",{class:"v-divider__content"},[u.default()]),T]):T}),{}}}),yE=Ct({items:Array,returnObject:Boolean},"VListChildren"),MS=Wt()({name:"VListChildren",props:yE(),setup(e,i){let{slots:l}=i;return xS(),()=>{var u,f;return((u=l.default)==null?void 0:u.call(l))??((f=e.items)==null?void 0:f.map(g=>{var O,D;let{children:m,props:o,type:T,raw:k}=g;if(T==="divider")return((O=l.divider)==null?void 0:O.call(l,{props:o}))??E(IS,o,null);if(T==="subheader")return((D=l.subheader)==null?void 0:D.call(l,{props:o}))??E(gE,o,null);const I={subtitle:l.subtitle?B=>{var V;return(V=l.subtitle)==null?void 0:V.call(l,{...B,item:k})}:void 0,prepend:l.prepend?B=>{var V;return(V=l.prepend)==null?void 0:V.call(l,{...B,item:k})}:void 0,append:l.append?B=>{var V;return(V=l.append)==null?void 0:V.call(l,{...B,item:k})}:void 0,title:l.title?B=>{var V;return(V=l.title)==null?void 0:V.call(l,{...B,item:k})}:void 0},z=xx.filterProps(o);return m?E(xx,an({value:o==null?void 0:o.value},z),{activator:B=>{let{props:V}=B;const Z={...o,...V,value:e.returnObject?k:o.value};return l.header?l.header({props:Z}):E(za,Z,I)},default:()=>E(MS,{items:m,returnObject:e.returnObject},l)}):l.item?l.item({props:o}):E(za,an(o,{value:e.returnObject?k:o.value}),I)}))}}}),ES=Ct({items:{type:Array,default:()=>[]},itemTitle:{type:[String,Array,Function],default:"title"},itemValue:{type:[String,Array,Function],default:"value"},itemChildren:{type:[Boolean,String,Array,Function],default:"children"},itemProps:{type:[Boolean,String,Array,Function],default:"props"},returnObject:Boolean,valueComparator:{type:Function,default:_u}},"list-items");function X_(e,i){const l=eo(i,e.itemTitle,i),u=eo(i,e.itemValue,l),f=eo(i,e.itemChildren),g=e.itemProps===!0?typeof i=="object"&&i!=null&&!Array.isArray(i)?"children"in i?Ps(i,["children"]):i:void 0:eo(i,e.itemProps),m={title:l,value:u,...g};return{title:String(m.title??""),value:m.value,props:m,children:Array.isArray(f)?AS(e,f):void 0,raw:i}}function AS(e,i){const l=[];for(const u of i)l.push(X_(e,u));return l}function vE(e){const i=ce(()=>AS(e,e.items)),l=ce(()=>i.value.some(g=>g.value===null));function u(g){return l.value||(g=g.filter(m=>m!==null)),g.map(m=>e.returnObject&&typeof m=="string"?X_(e,m):i.value.find(o=>e.valueComparator(m,o.value))||X_(e,m))}function f(g){return e.returnObject?g.map(m=>{let{raw:o}=m;return o}):g.map(m=>{let{value:o}=m;return o})}return{items:i,transformIn:u,transformOut:f}}function bE(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"}function xE(e,i){const l=eo(i,e.itemType,"item"),u=bE(i)?i:eo(i,e.itemTitle),f=eo(i,e.itemValue,void 0),g=eo(i,e.itemChildren),m=e.itemProps===!0?Ps(i,["children"]):eo(i,e.itemProps),o={title:u,value:f,...m};return{type:l,title:o.title,value:o.value,props:o,children:l==="item"&&g?RS(e,g):void 0,raw:i}}function RS(e,i){const l=[];for(const u of i)l.push(xE(e,u));return l}function wE(e){return{items:ce(()=>RS(e,e.items))}}const SE=Ct({baseColor:String,activeColor:String,activeClass:String,bgColor:String,disabled:Boolean,expandIcon:Gn,collapseIcon:Gn,lines:{type:[Boolean,String],default:"one"},slim:Boolean,nav:Boolean,"onClick:open":sa(),"onClick:select":sa(),"onUpdate:opened":sa(),...sE({selectStrategy:"single-leaf",openStrategy:"list"}),...lo(),...xn(),...Pa(),...Va(),...uo(),itemType:{type:String,default:"type"},...ES(),...ua(),...Ti(),...Di(),...Is({variant:"text"})},"VList"),Xy=Wt()({name:"VList",props:SE(),emits:{"update:selected":e=>!0,"update:activated":e=>!0,"update:opened":e=>!0,"click:open":e=>!0,"click:activate":e=>!0,"click:select":e=>!0},setup(e,i){let{slots:l}=i;const{items:u}=wE(e),{themeClasses:f}=Hi(e),{backgroundColorClasses:g,backgroundColorStyles:m}=Fa(rn(e,"bgColor")),{borderClasses:o}=co(e),{densityClasses:T}=$a(e),{dimensionStyles:k}=Na(e),{elevationClasses:I}=ho(e),{roundedClasses:z}=da(e),{children:O,open:D,parents:B,select:V,getPath:Z}=oE(e),oe=ce(()=>e.lines?`v-list--${e.lines}-line`:void 0),pe=rn(e,"activeColor"),Se=rn(e,"baseColor"),me=rn(e,"color");xS(),Qo({VListGroup:{activeColor:pe,baseColor:Se,color:me,expandIcon:rn(e,"expandIcon"),collapseIcon:rn(e,"collapseIcon")},VListItem:{activeClass:rn(e,"activeClass"),activeColor:pe,baseColor:Se,color:me,density:rn(e,"density"),disabled:rn(e,"disabled"),lines:rn(e,"lines"),nav:rn(e,"nav"),slim:rn(e,"slim"),variant:rn(e,"variant")}});const be=ln(!1),he=Ke();function Ce(Oe){be.value=!0}function ye(Oe){be.value=!1}function Me(Oe){var We;!be.value&&!(Oe.relatedTarget&&((We=he.value)!=null&&We.contains(Oe.relatedTarget)))&&xe()}function ke(Oe){const We=Oe.target;if(!(!he.value||["INPUT","TEXTAREA"].includes(We.tagName))){if(Oe.key==="ArrowDown")xe("next");else if(Oe.key==="ArrowUp")xe("prev");else if(Oe.key==="Home")xe("first");else if(Oe.key==="End")xe("last");else return;Oe.preventDefault()}}function Ee(Oe){be.value=!0}function xe(Oe){if(he.value)return ah(he.value,Oe)}return hn(()=>E(e.tag,{ref:he,class:["v-list",{"v-list--disabled":e.disabled,"v-list--nav":e.nav,"v-list--slim":e.slim},f.value,g.value,o.value,T.value,I.value,oe.value,z.value,e.class],style:[m.value,k.value,e.style],tabindex:e.disabled||be.value?-1:0,role:"listbox","aria-activedescendant":void 0,onFocusin:Ce,onFocusout:ye,onFocus:Me,onKeydown:ke,onMousedown:Ee},{default:()=>[E(MS,{items:u.value,returnObject:e.returnObject},l)]})),{open:D,select:V,focus:xe,children:O,parents:B,getPath:Z}}});function CE(e){let{rootEl:i,isSticky:l,layoutItemStyles:u}=e;const f=ln(!1),g=ln(0),m=ce(()=>{const k=typeof f.value=="boolean"?"top":f.value;return[l.value?{top:"auto",bottom:"auto",height:void 0}:void 0,f.value?{[k]:mn(g.value)}:{top:u.value.top}]});Qn(()=>{en(l,k=>{k?window.addEventListener("scroll",T,{passive:!0}):window.removeEventListener("scroll",T)},{immediate:!0})}),Ir(()=>{window.removeEventListener("scroll",T)});let o=0;function T(){const k=o>window.scrollY?"up":"down",I=i.value.getBoundingClientRect(),z=parseFloat(u.value.top??0),O=window.scrollY-Math.max(0,g.value-z),D=I.height+Math.max(g.value,z)-window.scrollY-window.innerHeight,B=parseFloat(getComputedStyle(i.value).getPropertyValue("--v-body-scroll-y"))||0;I.height<window.innerHeight-z?(f.value="top",g.value=z):k==="up"&&f.value==="bottom"||k==="down"&&f.value==="top"?(g.value=window.scrollY+I.top-B,f.value=!0):k==="down"&&D<=0?(g.value=0,f.value="bottom"):k==="up"&&O<=0&&(B?f.value!=="top"&&(g.value=-O+B+z,f.value="top"):(g.value=I.top+O,f.value="top")),o=window.scrollY}return{isStuck:f,stickyStyles:m}}const TE=100,PE=20;function wx(e){const i=1.41421356237;return(e<0?-1:1)*Math.sqrt(Math.abs(e))*i}function Sx(e){if(e.length<2)return 0;if(e.length===2)return e[1].t===e[0].t?0:(e[1].d-e[0].d)/(e[1].t-e[0].t);let i=0;for(let l=e.length-1;l>0;l--){if(e[l].t===e[l-1].t)continue;const u=wx(i),f=(e[l].d-e[l-1].d)/(e[l].t-e[l-1].t);i+=(f-u)*Math.abs(f),l===e.length-1&&(i*=.5)}return wx(i)*1e3}function kE(){const e={};function i(f){Array.from(f.changedTouches).forEach(g=>{(e[g.identifier]??(e[g.identifier]=new gI(PE))).push([f.timeStamp,g])})}function l(f){Array.from(f.changedTouches).forEach(g=>{delete e[g.identifier]})}function u(f){var k;const g=(k=e[f])==null?void 0:k.values().reverse();if(!g)throw new Error(`No samples for touch id ${f}`);const m=g[0],o=[],T=[];for(const I of g){if(m[0]-I[0]>TE)break;o.push({t:I[0],d:I[1].clientX}),T.push({t:I[0],d:I[1].clientY})}return{x:Sx(o),y:Sx(T),get direction(){const{x:I,y:z}=this,[O,D]=[Math.abs(I),Math.abs(z)];return O>D&&I>=0?"right":O>D&&I<=0?"left":D>O&&z>=0?"down":D>O&&z<=0?"up":IE()}}}return{addMovement:i,endTouch:l,getVelocity:u}}function IE(){throw new Error}function ME(e){let{el:i,isActive:l,isTemporary:u,width:f,touchless:g,position:m}=e;Qn(()=>{window.addEventListener("touchstart",pe,{passive:!0}),window.addEventListener("touchmove",Se,{passive:!1}),window.addEventListener("touchend",me,{passive:!0})}),Ir(()=>{window.removeEventListener("touchstart",pe),window.removeEventListener("touchmove",Se),window.removeEventListener("touchend",me)});const o=ce(()=>["left","right"].includes(m.value)),{addMovement:T,endTouch:k,getVelocity:I}=kE();let z=!1;const O=ln(!1),D=ln(0),B=ln(0);let V;function Z(he,Ce){return(m.value==="left"?he:m.value==="right"?document.documentElement.clientWidth-he:m.value==="top"?he:m.value==="bottom"?document.documentElement.clientHeight-he:ru())-(Ce?f.value:0)}function oe(he){let Ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const ye=m.value==="left"?(he-B.value)/f.value:m.value==="right"?(document.documentElement.clientWidth-he-B.value)/f.value:m.value==="top"?(he-B.value)/f.value:m.value==="bottom"?(document.documentElement.clientHeight-he-B.value)/f.value:ru();return Ce?Math.max(0,Math.min(1,ye)):ye}function pe(he){if(g.value)return;const Ce=he.changedTouches[0].clientX,ye=he.changedTouches[0].clientY,Me=25,ke=m.value==="left"?Ce<Me:m.value==="right"?Ce>document.documentElement.clientWidth-Me:m.value==="top"?ye<Me:m.value==="bottom"?ye>document.documentElement.clientHeight-Me:ru(),Ee=l.value&&(m.value==="left"?Ce<f.value:m.value==="right"?Ce>document.documentElement.clientWidth-f.value:m.value==="top"?ye<f.value:m.value==="bottom"?ye>document.documentElement.clientHeight-f.value:ru());(ke||Ee||l.value&&u.value)&&(V=[Ce,ye],B.value=Z(o.value?Ce:ye,l.value),D.value=oe(o.value?Ce:ye),z=B.value>-20&&B.value<80,k(he),T(he))}function Se(he){const Ce=he.changedTouches[0].clientX,ye=he.changedTouches[0].clientY;if(z){if(!he.cancelable){z=!1;return}const ke=Math.abs(Ce-V[0]),Ee=Math.abs(ye-V[1]);(o.value?ke>Ee&&ke>3:Ee>ke&&Ee>3)?(O.value=!0,z=!1):(o.value?Ee:ke)>3&&(z=!1)}if(!O.value)return;he.preventDefault(),T(he);const Me=oe(o.value?Ce:ye,!1);D.value=Math.max(0,Math.min(1,Me)),Me>1?B.value=Z(o.value?Ce:ye,!0):Me<0&&(B.value=Z(o.value?Ce:ye,!1))}function me(he){if(z=!1,!O.value)return;T(he),O.value=!1;const Ce=I(he.changedTouches[0].identifier),ye=Math.abs(Ce.x),Me=Math.abs(Ce.y);(o.value?ye>Me&&ye>400:Me>ye&&Me>3)?l.value=Ce.direction===({left:"right",right:"left",top:"down",bottom:"up"}[m.value]||ru()):l.value=D.value>.5}const be=ce(()=>O.value?{transform:m.value==="left"?`translateX(calc(-100% + ${D.value*f.value}px))`:m.value==="right"?`translateX(calc(100% - ${D.value*f.value}px))`:m.value==="top"?`translateY(calc(-100% + ${D.value*f.value}px))`:m.value==="bottom"?`translateY(calc(100% - ${D.value*f.value}px))`:ru(),transition:"none"}:void 0);return Oa(O,()=>{var ye,Me;const he=((ye=i.value)==null?void 0:ye.style.transform)??null,Ce=((Me=i.value)==null?void 0:Me.style.transition)??null;Sa(()=>{var ke,Ee,xe,Oe;(Ee=i.value)==null||Ee.style.setProperty("transform",((ke=be.value)==null?void 0:ke.transform)||"none"),(Oe=i.value)==null||Oe.style.setProperty("transition",((xe=be.value)==null?void 0:xe.transition)||null)}),kr(()=>{var ke,Ee;(ke=i.value)==null||ke.style.setProperty("transform",he),(Ee=i.value)==null||Ee.style.setProperty("transition",Ce)})}),{isDragging:O,dragProgress:D,dragStyles:be}}function ru(){throw new Error}const Pm={"001":1,AD:1,AE:6,AF:6,AG:0,AI:1,AL:1,AM:1,AN:1,AR:1,AS:0,AT:1,AU:1,AX:1,AZ:1,BA:1,BD:0,BE:1,BG:1,BH:6,BM:1,BN:1,BR:0,BS:0,BT:0,BW:0,BY:1,BZ:0,CA:0,CH:1,CL:1,CM:1,CN:1,CO:0,CR:1,CY:1,CZ:1,DE:1,DJ:6,DK:1,DM:0,DO:0,DZ:6,EC:1,EE:1,EG:6,ES:1,ET:0,FI:1,FJ:1,FO:1,FR:1,GB:1,"GB-alt-variant":0,GE:1,GF:1,GP:1,GR:1,GT:0,GU:0,HK:0,HN:0,HR:1,HU:1,ID:0,IE:1,IL:0,IN:0,IQ:6,IR:6,IS:1,IT:1,JM:0,JO:6,JP:0,KE:0,KG:1,KH:0,KR:0,KW:6,KZ:1,LA:0,LB:1,LI:1,LK:1,LT:1,LU:1,LV:1,LY:6,MC:1,MD:1,ME:1,MH:0,MK:1,MM:0,MN:1,MO:0,MQ:1,MT:0,MV:5,MX:0,MY:1,MZ:0,NI:0,NL:1,NO:1,NP:0,NZ:1,OM:6,PA:0,PE:0,PH:0,PK:0,PL:1,PR:0,PT:0,PY:0,QA:6,RE:1,RO:1,RS:1,RU:1,SA:0,SD:6,SE:1,SG:0,SI:1,SK:1,SM:1,SV:0,SY:6,TH:0,TJ:1,TM:1,TR:1,TT:0,TW:0,UA:1,UM:0,US:0,UY:1,UZ:1,VA:1,VE:0,VI:0,VN:1,WS:0,XK:1,YE:0,ZA:0,ZW:0};function EE(e,i,l){const u=[];let f=[];const g=DS(e),m=zS(e),o=l??Pm[i.slice(-2).toUpperCase()]??0,T=(g.getDay()-o+7)%7,k=(m.getDay()-o+7)%7;for(let I=0;I<T;I++){const z=new Date(g);z.setDate(z.getDate()-(T-I)),f.push(z)}for(let I=1;I<=m.getDate();I++){const z=new Date(e.getFullYear(),e.getMonth(),I);f.push(z),f.length===7&&(u.push(f),f=[])}for(let I=1;I<7-k;I++){const z=new Date(m);z.setDate(z.getDate()+I),f.push(z)}return f.length>0&&u.push(f),u}function AE(e,i,l){const u=l??Pm[i.slice(-2).toUpperCase()]??0,f=new Date(e);for(;f.getDay()!==u;)f.setDate(f.getDate()-1);return f}function RE(e,i){const l=new Date(e),u=((Pm[i.slice(-2).toUpperCase()]??0)+6)%7;for(;l.getDay()!==u;)l.setDate(l.getDate()+1);return l}function DS(e){return new Date(e.getFullYear(),e.getMonth(),1)}function zS(e){return new Date(e.getFullYear(),e.getMonth()+1,0)}function DE(e){const i=e.split("-").map(Number);return new Date(i[0],i[1]-1,i[2])}const zE=/^([12]\d{3}-([1-9]|0[1-9]|1[0-2])-([1-9]|0[1-9]|[12]\d|3[01]))$/;function LS(e){if(e==null)return new Date;if(e instanceof Date)return e;if(typeof e=="string"){let i;if(zE.test(e))return DE(e);if(i=Date.parse(e),!isNaN(i))return new Date(i)}return null}const Cx=new Date(2e3,0,2);function LE(e,i){const l=i??Pm[e.slice(-2).toUpperCase()]??0;return Iw(7).map(u=>{const f=new Date(Cx);return f.setDate(Cx.getDate()+l+u),new Intl.DateTimeFormat(e,{weekday:"narrow"}).format(f)})}function BE(e,i,l,u){const f=LS(e)??new Date,g=u==null?void 0:u[i];if(typeof g=="function")return g(f,i,l);let m={};switch(i){case"fullDate":m={year:"numeric",month:"long",day:"numeric"};break;case"fullDateWithWeekday":m={weekday:"long",year:"numeric",month:"long",day:"numeric"};break;case"normalDate":const o=f.getDate(),T=new Intl.DateTimeFormat(l,{month:"long"}).format(f);return`${o} ${T}`;case"normalDateWithWeekday":m={weekday:"short",day:"numeric",month:"short"};break;case"shortDate":m={month:"short",day:"numeric"};break;case"year":m={year:"numeric"};break;case"month":m={month:"long"};break;case"monthShort":m={month:"short"};break;case"monthAndYear":m={month:"long",year:"numeric"};break;case"monthAndDate":m={month:"long",day:"numeric"};break;case"weekday":m={weekday:"long"};break;case"weekdayShort":m={weekday:"short"};break;case"dayOfMonth":return new Intl.NumberFormat(l).format(f.getDate());case"hours12h":m={hour:"numeric",hour12:!0};break;case"hours24h":m={hour:"numeric",hour12:!1};break;case"minutes":m={minute:"numeric"};break;case"seconds":m={second:"numeric"};break;case"fullTime":m={hour:"numeric",minute:"numeric",second:"numeric",hour12:!0};break;case"fullTime12h":m={hour:"numeric",minute:"numeric",second:"numeric",hour12:!0};break;case"fullTime24h":m={hour:"numeric",minute:"numeric",second:"numeric",hour12:!1};break;case"fullDateTime":m={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0};break;case"fullDateTime12h":m={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0};break;case"fullDateTime24h":m={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1};break;case"keyboardDate":m={year:"numeric",month:"2-digit",day:"2-digit"};break;case"keyboardDateTime":m={year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1};break;case"keyboardDateTime12h":m={year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0};break;case"keyboardDateTime24h":m={year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1};break;default:m=g??{timeZone:"UTC",timeZoneName:"short"}}return new Intl.DateTimeFormat(l,m).format(f)}function FE(e,i){const l=e.toJsDate(i),u=l.getFullYear(),f=$b(String(l.getMonth()+1),2,"0"),g=$b(String(l.getDate()),2,"0");return`${u}-${f}-${g}`}function OE(e){const[i,l,u]=e.split("-").map(Number);return new Date(i,l-1,u)}function VE(e,i){const l=new Date(e);return l.setMinutes(l.getMinutes()+i),l}function NE(e,i){const l=new Date(e);return l.setHours(l.getHours()+i),l}function $E(e,i){const l=new Date(e);return l.setDate(l.getDate()+i),l}function jE(e,i){const l=new Date(e);return l.setDate(l.getDate()+i*7),l}function UE(e,i){const l=new Date(e);return l.setDate(1),l.setMonth(l.getMonth()+i),l}function GE(e){return e.getFullYear()}function HE(e){return e.getMonth()}function ZE(e){return e.getDate()}function qE(e){return new Date(e.getFullYear(),e.getMonth()+1,1)}function WE(e){return new Date(e.getFullYear(),e.getMonth()-1,1)}function XE(e){return e.getHours()}function KE(e){return e.getMinutes()}function YE(e){return new Date(e.getFullYear(),0,1)}function JE(e){return new Date(e.getFullYear(),11,31)}function QE(e,i){return Kp(e,i[0])&&nA(e,i[1])}function eA(e){const i=new Date(e);return i instanceof Date&&!isNaN(i.getTime())}function Kp(e,i){return e.getTime()>i.getTime()}function tA(e,i){return Kp(K_(e),K_(i))}function nA(e,i){return e.getTime()<i.getTime()}function Tx(e,i){return e.getTime()===i.getTime()}function iA(e,i){return e.getDate()===i.getDate()&&e.getMonth()===i.getMonth()&&e.getFullYear()===i.getFullYear()}function rA(e,i){return e.getMonth()===i.getMonth()&&e.getFullYear()===i.getFullYear()}function aA(e,i){return e.getFullYear()===i.getFullYear()}function sA(e,i,l){const u=new Date(e),f=new Date(i);switch(l){case"years":return u.getFullYear()-f.getFullYear();case"quarters":return Math.floor((u.getMonth()-f.getMonth()+(u.getFullYear()-f.getFullYear())*12)/4);case"months":return u.getMonth()-f.getMonth()+(u.getFullYear()-f.getFullYear())*12;case"weeks":return Math.floor((u.getTime()-f.getTime())/(1e3*60*60*24*7));case"days":return Math.floor((u.getTime()-f.getTime())/(1e3*60*60*24));case"hours":return Math.floor((u.getTime()-f.getTime())/(1e3*60*60));case"minutes":return Math.floor((u.getTime()-f.getTime())/(1e3*60));case"seconds":return Math.floor((u.getTime()-f.getTime())/1e3);default:return u.getTime()-f.getTime()}}function oA(e,i){const l=new Date(e);return l.setHours(i),l}function lA(e,i){const l=new Date(e);return l.setMinutes(i),l}function cA(e,i){const l=new Date(e);return l.setMonth(i),l}function uA(e,i){const l=new Date(e);return l.setDate(i),l}function dA(e,i){const l=new Date(e);return l.setFullYear(i),l}function K_(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0)}function hA(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999)}class fA{constructor(i){this.locale=i.locale,this.formats=i.formats}date(i){return LS(i)}toJsDate(i){return i}toISO(i){return FE(this,i)}parseISO(i){return OE(i)}addMinutes(i,l){return VE(i,l)}addHours(i,l){return NE(i,l)}addDays(i,l){return $E(i,l)}addWeeks(i,l){return jE(i,l)}addMonths(i,l){return UE(i,l)}getWeekArray(i,l){return EE(i,this.locale,l?Number(l):void 0)}startOfWeek(i,l){return AE(i,this.locale,l?Number(l):void 0)}endOfWeek(i){return RE(i,this.locale)}startOfMonth(i){return DS(i)}endOfMonth(i){return zS(i)}format(i,l){return BE(i,l,this.locale,this.formats)}isEqual(i,l){return Tx(i,l)}isValid(i){return eA(i)}isWithinRange(i,l){return QE(i,l)}isAfter(i,l){return Kp(i,l)}isAfterDay(i,l){return tA(i,l)}isBefore(i,l){return!Kp(i,l)&&!Tx(i,l)}isSameDay(i,l){return iA(i,l)}isSameMonth(i,l){return rA(i,l)}isSameYear(i,l){return aA(i,l)}setMinutes(i,l){return lA(i,l)}setHours(i,l){return oA(i,l)}setMonth(i,l){return cA(i,l)}setDate(i,l){return uA(i,l)}setYear(i,l){return dA(i,l)}getDiff(i,l,u){return sA(i,l,u)}getWeekdays(i){return LE(this.locale,i?Number(i):void 0)}getYear(i){return GE(i)}getMonth(i){return HE(i)}getDate(i){return ZE(i)}getNextMonth(i){return qE(i)}getPreviousMonth(i){return WE(i)}getHours(i){return XE(i)}getMinutes(i){return KE(i)}startOfDay(i){return K_(i)}endOfDay(i){return hA(i)}startOfYear(i){return YE(i)}endOfYear(i){return JE(i)}}const pA=Symbol.for("vuetify:date-options"),Px=Symbol.for("vuetify:date-adapter");function mA(e,i){const l=Fr({adapter:fA,locale:{af:"af-ZA",bg:"bg-BG",ca:"ca-ES",ckb:"",cs:"cs-CZ",de:"de-DE",el:"el-GR",en:"en-US",et:"et-EE",fa:"fa-IR",fi:"fi-FI",hr:"hr-HR",hu:"hu-HU",he:"he-IL",id:"id-ID",it:"it-IT",ja:"ja-JP",ko:"ko-KR",lv:"lv-LV",lt:"lt-LT",nl:"nl-NL",no:"no-NO",pl:"pl-PL",pt:"pt-PT",ro:"ro-RO",ru:"ru-RU",sk:"sk-SK",sl:"sl-SI",srCyrl:"sr-SP",srLatn:"sr-SP",sv:"sv-SE",th:"th-TH",tr:"tr-TR",az:"az-AZ",uk:"uk-UA",vi:"vi-VN",zhHans:"zh-CN",zhHant:"zh-TW"}},e);return{options:l,instance:gA(l,i)}}function gA(e,i){const l=br(typeof e.adapter=="function"?new e.adapter({locale:e.locale[i.current.value]??i.current.value,formats:e.formats}):e.adapter);return en(i.current,u=>{l.locale=e.locale[u]??u??l.locale}),l}const xh=Symbol.for("vuetify:layout"),BS=Symbol.for("vuetify:layout-item"),kx=1e3,FS=Ct({overlaps:{type:Array,default:()=>[]},fullHeight:Boolean},"layout"),_A=Ct({name:{type:String},order:{type:[Number,String],default:0},absolute:Boolean},"layout-item");function yA(){const e=ri(xh);if(!e)throw new Error("[Vuetify] Could not find injected layout");return{getLayoutItem:e.getLayoutItem,mainRect:e.mainRect,mainStyles:e.mainStyles}}function vA(e){const i=ri(xh);if(!i)throw new Error("[Vuetify] Could not find injected layout");const l=e.id??`layout-item-${Ca()}`,u=Gi("useLayoutItem");Mr(BS,{id:l});const f=ln(!1);by(()=>f.value=!0),$1(()=>f.value=!1);const{layoutItemStyles:g,layoutItemScrimStyles:m}=i.register(u,{...e,active:ce(()=>f.value?!1:e.active.value),id:l});return Ir(()=>i.unregister(l)),{layoutItemStyles:g,layoutRect:i.layoutRect,layoutItemScrimStyles:m}}const bA=(e,i,l,u)=>{let f={top:0,left:0,right:0,bottom:0};const g=[{id:"",layer:{...f}}];for(const m of e){const o=i.get(m),T=l.get(m),k=u.get(m);if(!o||!T||!k)continue;const I={...f,[o.value]:parseInt(f[o.value],10)+(k.value?parseInt(T.value,10):0)};g.push({id:m,layer:I}),f=I}return g};function OS(e){const i=ri(xh,null),l=ce(()=>i?i.rootZIndex.value-100:kx),u=Ke([]),f=br(new Map),g=br(new Map),m=br(new Map),o=br(new Map),T=br(new Map),{resizeRef:k,contentRect:I}=mu(),z=ce(()=>{const he=new Map,Ce=e.overlaps??[];for(const ye of Ce.filter(Me=>Me.includes(":"))){const[Me,ke]=ye.split(":");if(!u.value.includes(Me)||!u.value.includes(ke))continue;const Ee=f.get(Me),xe=f.get(ke),Oe=g.get(Me),We=g.get(ke);!Ee||!xe||!Oe||!We||(he.set(ke,{position:Ee.value,amount:parseInt(Oe.value,10)}),he.set(Me,{position:xe.value,amount:-parseInt(We.value,10)}))}return he}),O=ce(()=>{const he=[...new Set([...m.values()].map(ye=>ye.value))].sort((ye,Me)=>ye-Me),Ce=[];for(const ye of he){const Me=u.value.filter(ke=>{var Ee;return((Ee=m.get(ke))==null?void 0:Ee.value)===ye});Ce.push(...Me)}return bA(Ce,f,g,o)}),D=ce(()=>!Array.from(T.values()).some(he=>he.value)),B=ce(()=>O.value[O.value.length-1].layer),V=ce(()=>({"--v-layout-left":mn(B.value.left),"--v-layout-right":mn(B.value.right),"--v-layout-top":mn(B.value.top),"--v-layout-bottom":mn(B.value.bottom),...D.value?void 0:{transition:"none"}})),Z=ce(()=>O.value.slice(1).map((he,Ce)=>{let{id:ye}=he;const{layer:Me}=O.value[Ce],ke=g.get(ye),Ee=f.get(ye);return{id:ye,...Me,size:Number(ke.value),position:Ee.value}})),oe=he=>Z.value.find(Ce=>Ce.id===he),pe=Gi("createLayout"),Se=ln(!1);Qn(()=>{Se.value=!0}),Mr(xh,{register:(he,Ce)=>{let{id:ye,order:Me,position:ke,layoutSize:Ee,elementSize:xe,active:Oe,disableTransitions:We,absolute:dt}=Ce;m.set(ye,Me),f.set(ye,ke),g.set(ye,Ee),o.set(ye,Oe),We&&T.set(ye,We);const tt=lu(BS,pe==null?void 0:pe.vnode).indexOf(he);tt>-1?u.value.splice(tt,0,ye):u.value.push(ye);const Et=ce(()=>Z.value.findIndex(zt=>zt.id===ye)),_t=ce(()=>l.value+O.value.length*2-Et.value*2),Qe=ce(()=>{const zt=ke.value==="left"||ke.value==="right",Jt=ke.value==="right",Lt=ke.value==="bottom",Yt=xe.value??Ee.value,qt=Yt===0?"%":"px",_n={[ke.value]:0,zIndex:_t.value,transform:`translate${zt?"X":"Y"}(${(Oe.value?0:-(Yt===0?100:Yt))*(Jt||Lt?-1:1)}${qt})`,position:dt.value||l.value!==kx?"absolute":"fixed",...D.value?void 0:{transition:"none"}};if(!Se.value)return _n;const bn=Z.value[Et.value];if(!bn)throw new Error(`[Vuetify] Could not find layout item "${ye}"`);const jn=z.value.get(ye);return jn&&(bn[jn.position]+=jn.amount),{..._n,height:zt?`calc(100% - ${bn.top}px - ${bn.bottom}px)`:xe.value?`${xe.value}px`:void 0,left:Jt?void 0:`${bn.left}px`,right:Jt?`${bn.right}px`:void 0,top:ke.value!=="bottom"?`${bn.top}px`:void 0,bottom:ke.value!=="top"?`${bn.bottom}px`:void 0,width:zt?xe.value?`${xe.value}px`:void 0:`calc(100% - ${bn.left}px - ${bn.right}px)`}}),ct=ce(()=>({zIndex:_t.value-1}));return{layoutItemStyles:Qe,layoutItemScrimStyles:ct,zIndex:_t}},unregister:he=>{m.delete(he),f.delete(he),g.delete(he),o.delete(he),T.delete(he),u.value=u.value.filter(Ce=>Ce!==he)},mainRect:B,mainStyles:V,getLayoutItem:oe,items:Z,layoutRect:I,rootZIndex:l});const me=ce(()=>["v-layout",{"v-layout--full-height":e.fullHeight}]),be=ce(()=>({zIndex:i?l.value:void 0,position:i?"relative":void 0,overflow:i?"hidden":void 0}));return{layoutClasses:me,layoutStyles:be,getLayoutItem:oe,items:Z,layoutRect:I,layoutRef:k}}const VS=Ct({closeDelay:[Number,String],openDelay:[Number,String]},"delay");function NS(e,i){let l=()=>{};function u(m){l==null||l();const o=Number(m?e.openDelay:e.closeDelay);return new Promise(T=>{l=_I(o,()=>{i==null||i(m),T(m)})})}function f(){return u(!0)}function g(){return u(!1)}return{clearDelay:l,runOpenDelay:f,runCloseDelay:g}}function nc(){const i=Gi("useScopeId").vnode.scopeId;return{scopeId:i?{[i]:""}:void 0}}const xA=["start","end","left","right","top","bottom"],wA=Ct({color:String,disableResizeWatcher:Boolean,disableRouteWatcher:Boolean,expandOnHover:Boolean,floating:Boolean,modelValue:{type:Boolean,default:null},permanent:Boolean,rail:{type:Boolean,default:null},railWidth:{type:[Number,String],default:56},scrim:{type:[Boolean,String],default:!0},image:String,temporary:Boolean,persistent:Boolean,touchless:Boolean,width:{type:[Number,String],default:256},location:{type:String,default:"start",validator:e=>xA.includes(e)},sticky:Boolean,...lo(),...xn(),...VS(),...nS({mobile:null}),...uo(),..._A(),...ua(),...Ti({tag:"nav"}),...Di()},"VNavigationDrawer"),SA=Wt()({name:"VNavigationDrawer",props:wA(),emits:{"update:modelValue":e=>!0,"update:rail":e=>!0},setup(e,i){let{attrs:l,emit:u,slots:f}=i;const{isRtl:g}=ja(),{themeClasses:m}=Hi(e),{borderClasses:o}=co(e),{backgroundColorClasses:T,backgroundColorStyles:k}=Fa(rn(e,"color")),{elevationClasses:I}=ho(e),{displayClasses:z,mobile:O}=wm(e),{roundedClasses:D}=da(e),B=hS(),V=ai(e,"modelValue",null,ct=>!!ct),{ssrBootStyles:Z}=Wy(),{scopeId:oe}=nc(),pe=Ke(),Se=ln(!1),{runOpenDelay:me,runCloseDelay:be}=NS(e,ct=>{Se.value=ct}),he=ce(()=>e.rail&&e.expandOnHover&&Se.value?Number(e.width):Number(e.rail?e.railWidth:e.width)),Ce=ce(()=>j_(e.location,g.value)),ye=ce(()=>e.persistent),Me=ce(()=>!e.permanent&&(O.value||e.temporary)),ke=ce(()=>e.sticky&&!Me.value&&Ce.value!=="bottom");Oa(()=>e.expandOnHover&&e.rail!=null,()=>{en(Se,ct=>u("update:rail",!ct))}),Oa(()=>!e.disableResizeWatcher,()=>{en(Me,ct=>!e.permanent&&Fi(()=>V.value=!ct))}),Oa(()=>!e.disableRouteWatcher&&!!B,()=>{en(B.currentRoute,()=>Me.value&&(V.value=!1))}),en(()=>e.permanent,ct=>{ct&&(V.value=!0)}),e.modelValue==null&&!Me.value&&(V.value=e.permanent||!O.value);const{isDragging:Ee,dragProgress:xe}=ME({el:pe,isActive:V,isTemporary:Me,width:he,touchless:rn(e,"touchless"),position:Ce}),Oe=ce(()=>{const ct=Me.value?0:e.rail&&e.expandOnHover?Number(e.railWidth):he.value;return Ee.value?ct*xe.value:ct}),We=ce(()=>["top","bottom"].includes(e.location)?0:he.value),{layoutItemStyles:dt,layoutItemScrimStyles:je}=vA({id:e.name,order:ce(()=>parseInt(e.order,10)),position:Ce,layoutSize:Oe,elementSize:We,active:ce(()=>V.value||Ee.value),disableTransitions:ce(()=>Ee.value),absolute:ce(()=>e.absolute||ke.value&&typeof tt.value!="string")}),{isStuck:tt,stickyStyles:Et}=CE({rootEl:pe,isSticky:ke,layoutItemStyles:dt}),_t=Fa(ce(()=>typeof e.scrim=="string"?e.scrim:null)),Qe=ce(()=>({...Ee.value?{opacity:xe.value*.2,transition:"none"}:void 0,...je.value}));return Qo({VList:{bgColor:"transparent"}}),hn(()=>{const ct=f.image||e.image;return E(un,null,[E(e.tag,an({ref:pe,onMouseenter:me,onMouseleave:be,class:["v-navigation-drawer",`v-navigation-drawer--${Ce.value}`,{"v-navigation-drawer--expand-on-hover":e.expandOnHover,"v-navigation-drawer--floating":e.floating,"v-navigation-drawer--is-hovering":Se.value,"v-navigation-drawer--rail":e.rail,"v-navigation-drawer--temporary":Me.value,"v-navigation-drawer--persistent":ye.value,"v-navigation-drawer--active":V.value,"v-navigation-drawer--sticky":ke.value},m.value,T.value,o.value,z.value,I.value,D.value,e.class],style:[k.value,dt.value,Z.value,Et.value,e.style,["top","bottom"].includes(Ce.value)?{height:"auto"}:{}]},oe,l),{default:()=>{var zt,Jt,Lt;return[ct&&E("div",{key:"image",class:"v-navigation-drawer__img"},[f.image?E(Bi,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{alt:"",cover:!0,height:"inherit",src:e.image}}},f.image):E(Ny,{key:"image-img",alt:"",cover:!0,height:"inherit",src:e.image},null)]),f.prepend&&E("div",{class:"v-navigation-drawer__prepend"},[(zt=f.prepend)==null?void 0:zt.call(f)]),E("div",{class:"v-navigation-drawer__content"},[(Jt=f.default)==null?void 0:Jt.call(f)]),f.append&&E("div",{class:"v-navigation-drawer__append"},[(Lt=f.append)==null?void 0:Lt.call(f)])]}}),E(Ts,{name:"fade-transition"},{default:()=>[Me.value&&(Ee.value||V.value)&&!!e.scrim&&E("div",an({class:["v-navigation-drawer__scrim",_t.backgroundColorClasses.value],style:[Qe.value,_t.backgroundColorStyles.value],onClick:()=>{ye.value||(V.value=!1)}},oe),null)]})])}),{isStuck:tt}}}),CA=Vn({__name:"SideBar",setup(e){const i=ei(),l=u=>{i.$state.currentPage=u};return(u,f)=>(Fe(),ft(SA,{"expand-on-hover":"",rail:""},{append:K(()=>[E(za,{"prepend-icon":"mdi-cog",title:U(ne)("settings"),value:"settings",onClick:f[6]||(f[6]=g=>l("settings"))},null,8,["title"])]),default:K(()=>[E(Xy,{density:"compact",nav:""},{default:K(()=>{var g,m,o,T,k,I;return[E(za,{color:"primary",active:U(i).currentPage==="racing",rounded:"lg","prepend-icon":"mdi-racing-helmet",title:U(ne)("racing"),value:"racing",onClick:f[0]||(f[0]=z=>l("racing"))},null,8,["active","title"]),E(za,{color:"primary",active:U(i).currentPage==="results",rounded:"lg","prepend-icon":"mdi-trophy",title:U(ne)("results"),value:"results",onClick:f[1]||(f[1]=z=>l("results"))},null,8,["active","title"]),E(za,{color:"primary",active:U(i).currentPage==="crew",rounded:"lg","prepend-icon":"mdi-account-group",title:U(ne)("crew"),value:"crew",onClick:f[2]||(f[2]=z=>l("crew"))},null,8,["active","title"]),(m=(g=U(i).baseData.data)==null?void 0:g.auth)!=null&&m.create?(Fe(),ft(za,{key:0,color:"primary",active:U(i).currentPage==="mytracks",rounded:"lg","prepend-icon":"mdi-go-kart-track",title:U(ne)("my_tracks"),value:"mytracks",onClick:f[3]||(f[3]=z=>l("mytracks"))},null,8,["active","title"])):Mt("",!0),(T=(o=U(i).baseData.data)==null?void 0:o.auth)!=null&&T.control?(Fe(),ft(za,{key:1,color:"primary",active:U(i).currentPage==="racers",rounded:"lg","prepend-icon":"mdi-account-multiple",title:U(ne)("racers"),value:"racers",onClick:f[4]||(f[4]=z=>l("racers"))},null,8,["active","title"])):Mt("",!0),(I=(k=U(i).baseData.data)==null?void 0:k.auth)!=null&&I.adminMenu?(Fe(),ft(za,{key:2,color:"primary",active:U(i).currentPage==="admin",rounded:"lg","prepend-icon":"mdi-shield-crown",title:U(ne)("race_admin"),value:"admin",onClick:f[5]||(f[5]=z=>l("admin"))},null,8,["active","title"])):Mt("",!0)]}),_:1})]),_:1}))}});const TA=Pi(CA,[["__scopeId","data-v-46e1f4d8"]]);function $S(e,i){return function(){return e.apply(i,arguments)}}const{toString:PA}=Object.prototype,{getPrototypeOf:Ky}=Object,km=(e=>i=>{const l=PA.call(i);return e[l]||(e[l]=l.slice(8,-1).toLowerCase())})(Object.create(null)),ls=e=>(e=e.toLowerCase(),i=>km(i)===e),Im=e=>i=>typeof i===e,{isArray:bu}=Array,wh=Im("undefined");function kA(e){return e!==null&&!wh(e)&&e.constructor!==null&&!wh(e.constructor)&&wa(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const jS=ls("ArrayBuffer");function IA(e){let i;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?i=ArrayBuffer.isView(e):i=e&&e.buffer&&jS(e.buffer),i}const MA=Im("string"),wa=Im("function"),US=Im("number"),Mm=e=>e!==null&&typeof e=="object",EA=e=>e===!0||e===!1,Pp=e=>{if(km(e)!=="object")return!1;const i=Ky(e);return(i===null||i===Object.prototype||Object.getPrototypeOf(i)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},AA=ls("Date"),RA=ls("File"),DA=ls("Blob"),zA=ls("FileList"),LA=e=>Mm(e)&&wa(e.pipe),BA=e=>{let i;return e&&(typeof FormData=="function"&&e instanceof FormData||wa(e.append)&&((i=km(e))==="formdata"||i==="object"&&wa(e.toString)&&e.toString()==="[object FormData]"))},FA=ls("URLSearchParams"),[OA,VA,NA,$A]=["ReadableStream","Request","Response","Headers"].map(ls),jA=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Oh(e,i,{allOwnKeys:l=!1}={}){if(e===null||typeof e>"u")return;let u,f;if(typeof e!="object"&&(e=[e]),bu(e))for(u=0,f=e.length;u<f;u++)i.call(null,e[u],u,e);else{const g=l?Object.getOwnPropertyNames(e):Object.keys(e),m=g.length;let o;for(u=0;u<m;u++)o=g[u],i.call(null,e[o],o,e)}}function GS(e,i){i=i.toLowerCase();const l=Object.keys(e);let u=l.length,f;for(;u-- >0;)if(f=l[u],i===f.toLowerCase())return f;return null}const Ul=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),HS=e=>!wh(e)&&e!==Ul;function Y_(){const{caseless:e}=HS(this)&&this||{},i={},l=(u,f)=>{const g=e&&GS(i,f)||f;Pp(i[g])&&Pp(u)?i[g]=Y_(i[g],u):Pp(u)?i[g]=Y_({},u):bu(u)?i[g]=u.slice():i[g]=u};for(let u=0,f=arguments.length;u<f;u++)arguments[u]&&Oh(arguments[u],l);return i}const UA=(e,i,l,{allOwnKeys:u}={})=>(Oh(i,(f,g)=>{l&&wa(f)?e[g]=$S(f,l):e[g]=f},{allOwnKeys:u}),e),GA=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),HA=(e,i,l,u)=>{e.prototype=Object.create(i.prototype,u),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:i.prototype}),l&&Object.assign(e.prototype,l)},ZA=(e,i,l,u)=>{let f,g,m;const o={};if(i=i||{},e==null)return i;do{for(f=Object.getOwnPropertyNames(e),g=f.length;g-- >0;)m=f[g],(!u||u(m,e,i))&&!o[m]&&(i[m]=e[m],o[m]=!0);e=l!==!1&&Ky(e)}while(e&&(!l||l(e,i))&&e!==Object.prototype);return i},qA=(e,i,l)=>{e=String(e),(l===void 0||l>e.length)&&(l=e.length),l-=i.length;const u=e.indexOf(i,l);return u!==-1&&u===l},WA=e=>{if(!e)return null;if(bu(e))return e;let i=e.length;if(!US(i))return null;const l=new Array(i);for(;i-- >0;)l[i]=e[i];return l},XA=(e=>i=>e&&i instanceof e)(typeof Uint8Array<"u"&&Ky(Uint8Array)),KA=(e,i)=>{const u=(e&&e[Symbol.iterator]).call(e);let f;for(;(f=u.next())&&!f.done;){const g=f.value;i.call(e,g[0],g[1])}},YA=(e,i)=>{let l;const u=[];for(;(l=e.exec(i))!==null;)u.push(l);return u},JA=ls("HTMLFormElement"),QA=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(l,u,f){return u.toUpperCase()+f}),Ix=(({hasOwnProperty:e})=>(i,l)=>e.call(i,l))(Object.prototype),eR=ls("RegExp"),ZS=(e,i)=>{const l=Object.getOwnPropertyDescriptors(e),u={};Oh(l,(f,g)=>{let m;(m=i(f,g,e))!==!1&&(u[g]=m||f)}),Object.defineProperties(e,u)},tR=e=>{ZS(e,(i,l)=>{if(wa(e)&&["arguments","caller","callee"].indexOf(l)!==-1)return!1;const u=e[l];if(wa(u)){if(i.enumerable=!1,"writable"in i){i.writable=!1;return}i.set||(i.set=()=>{throw Error("Can not rewrite read-only method '"+l+"'")})}})},nR=(e,i)=>{const l={},u=f=>{f.forEach(g=>{l[g]=!0})};return bu(e)?u(e):u(String(e).split(i)),l},iR=()=>{},rR=(e,i)=>e!=null&&Number.isFinite(e=+e)?e:i,f_="abcdefghijklmnopqrstuvwxyz",Mx="0123456789",qS={DIGIT:Mx,ALPHA:f_,ALPHA_DIGIT:f_+f_.toUpperCase()+Mx},aR=(e=16,i=qS.ALPHA_DIGIT)=>{let l="";const{length:u}=i;for(;e--;)l+=i[Math.random()*u|0];return l};function sR(e){return!!(e&&wa(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const oR=e=>{const i=new Array(10),l=(u,f)=>{if(Mm(u)){if(i.indexOf(u)>=0)return;if(!("toJSON"in u)){i[f]=u;const g=bu(u)?[]:{};return Oh(u,(m,o)=>{const T=l(m,f+1);!wh(T)&&(g[o]=T)}),i[f]=void 0,g}}return u};return l(e,0)},lR=ls("AsyncFunction"),cR=e=>e&&(Mm(e)||wa(e))&&wa(e.then)&&wa(e.catch),WS=((e,i)=>e?setImmediate:i?((l,u)=>(Ul.addEventListener("message",({source:f,data:g})=>{f===Ul&&g===l&&u.length&&u.shift()()},!1),f=>{u.push(f),Ul.postMessage(l,"*")}))(`axios@${Math.random()}`,[]):l=>setTimeout(l))(typeof setImmediate=="function",wa(Ul.postMessage)),uR=typeof queueMicrotask<"u"?queueMicrotask.bind(Ul):typeof process<"u"&&process.nextTick||WS,ut={isArray:bu,isArrayBuffer:jS,isBuffer:kA,isFormData:BA,isArrayBufferView:IA,isString:MA,isNumber:US,isBoolean:EA,isObject:Mm,isPlainObject:Pp,isReadableStream:OA,isRequest:VA,isResponse:NA,isHeaders:$A,isUndefined:wh,isDate:AA,isFile:RA,isBlob:DA,isRegExp:eR,isFunction:wa,isStream:LA,isURLSearchParams:FA,isTypedArray:XA,isFileList:zA,forEach:Oh,merge:Y_,extend:UA,trim:jA,stripBOM:GA,inherits:HA,toFlatObject:ZA,kindOf:km,kindOfTest:ls,endsWith:qA,toArray:WA,forEachEntry:KA,matchAll:YA,isHTMLForm:JA,hasOwnProperty:Ix,hasOwnProp:Ix,reduceDescriptors:ZS,freezeMethods:tR,toObjectSet:nR,toCamelCase:QA,noop:iR,toFiniteNumber:rR,findKey:GS,global:Ul,isContextDefined:HS,ALPHABET:qS,generateString:aR,isSpecCompliantForm:sR,toJSONObject:oR,isAsyncFn:lR,isThenable:cR,setImmediate:WS,asap:uR};function In(e,i,l,u,f){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",i&&(this.code=i),l&&(this.config=l),u&&(this.request=u),f&&(this.response=f,this.status=f.status?f.status:null)}ut.inherits(In,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ut.toJSONObject(this.config),code:this.code,status:this.status}}});const XS=In.prototype,KS={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{KS[e]={value:e}});Object.defineProperties(In,KS);Object.defineProperty(XS,"isAxiosError",{value:!0});In.from=(e,i,l,u,f,g)=>{const m=Object.create(XS);return ut.toFlatObject(e,m,function(T){return T!==Error.prototype},o=>o!=="isAxiosError"),In.call(m,e.message,i,l,u,f),m.cause=e,m.name=e.name,g&&Object.assign(m,g),m};const dR=null;function J_(e){return ut.isPlainObject(e)||ut.isArray(e)}function YS(e){return ut.endsWith(e,"[]")?e.slice(0,-2):e}function Ex(e,i,l){return e?e.concat(i).map(function(f,g){return f=YS(f),!l&&g?"["+f+"]":f}).join(l?".":""):i}function hR(e){return ut.isArray(e)&&!e.some(J_)}const fR=ut.toFlatObject(ut,{},null,function(i){return/^is[A-Z]/.test(i)});function Em(e,i,l){if(!ut.isObject(e))throw new TypeError("target must be an object");i=i||new FormData,l=ut.toFlatObject(l,{metaTokens:!0,dots:!1,indexes:!1},!1,function(V,Z){return!ut.isUndefined(Z[V])});const u=l.metaTokens,f=l.visitor||I,g=l.dots,m=l.indexes,T=(l.Blob||typeof Blob<"u"&&Blob)&&ut.isSpecCompliantForm(i);if(!ut.isFunction(f))throw new TypeError("visitor must be a function");function k(B){if(B===null)return"";if(ut.isDate(B))return B.toISOString();if(!T&&ut.isBlob(B))throw new In("Blob is not supported. Use a Buffer instead.");return ut.isArrayBuffer(B)||ut.isTypedArray(B)?T&&typeof Blob=="function"?new Blob([B]):Buffer.from(B):B}function I(B,V,Z){let oe=B;if(B&&!Z&&typeof B=="object"){if(ut.endsWith(V,"{}"))V=u?V:V.slice(0,-2),B=JSON.stringify(B);else if(ut.isArray(B)&&hR(B)||(ut.isFileList(B)||ut.endsWith(V,"[]"))&&(oe=ut.toArray(B)))return V=YS(V),oe.forEach(function(Se,me){!(ut.isUndefined(Se)||Se===null)&&i.append(m===!0?Ex([V],me,g):m===null?V:V+"[]",k(Se))}),!1}return J_(B)?!0:(i.append(Ex(Z,V,g),k(B)),!1)}const z=[],O=Object.assign(fR,{defaultVisitor:I,convertValue:k,isVisitable:J_});function D(B,V){if(!ut.isUndefined(B)){if(z.indexOf(B)!==-1)throw Error("Circular reference detected in "+V.join("."));z.push(B),ut.forEach(B,function(oe,pe){(!(ut.isUndefined(oe)||oe===null)&&f.call(i,oe,ut.isString(pe)?pe.trim():pe,V,O))===!0&&D(oe,V?V.concat(pe):[pe])}),z.pop()}}if(!ut.isObject(e))throw new TypeError("data must be an object");return D(e),i}function Ax(e){const i={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(u){return i[u]})}function Yy(e,i){this._pairs=[],e&&Em(e,this,i)}const JS=Yy.prototype;JS.append=function(i,l){this._pairs.push([i,l])};JS.toString=function(i){const l=i?function(u){return i.call(this,u,Ax)}:Ax;return this._pairs.map(function(f){return l(f[0])+"="+l(f[1])},"").join("&")};function pR(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function QS(e,i,l){if(!i)return e;const u=l&&l.encode||pR;ut.isFunction(l)&&(l={serialize:l});const f=l&&l.serialize;let g;if(f?g=f(i,l):g=ut.isURLSearchParams(i)?i.toString():new Yy(i,l).toString(u),g){const m=e.indexOf("#");m!==-1&&(e=e.slice(0,m)),e+=(e.indexOf("?")===-1?"?":"&")+g}return e}class mR{constructor(){this.handlers=[]}use(i,l,u){return this.handlers.push({fulfilled:i,rejected:l,synchronous:u?u.synchronous:!1,runWhen:u?u.runWhen:null}),this.handlers.length-1}eject(i){this.handlers[i]&&(this.handlers[i]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(i){ut.forEach(this.handlers,function(u){u!==null&&i(u)})}}const Rx=mR,eC={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},gR=typeof URLSearchParams<"u"?URLSearchParams:Yy,_R=typeof FormData<"u"?FormData:null,yR=typeof Blob<"u"?Blob:null,vR={isBrowser:!0,classes:{URLSearchParams:gR,FormData:_R,Blob:yR},protocols:["http","https","file","blob","url","data"]},Jy=typeof window<"u"&&typeof document<"u",Q_=typeof navigator=="object"&&navigator||void 0,bR=Jy&&(!Q_||["ReactNative","NativeScript","NS"].indexOf(Q_.product)<0),xR=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),wR=Jy&&window.location.href||"http://localhost",SR=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Jy,hasStandardBrowserEnv:bR,hasStandardBrowserWebWorkerEnv:xR,navigator:Q_,origin:wR},Symbol.toStringTag,{value:"Module"})),Br={...SR,...vR};function CR(e,i){return Em(e,new Br.classes.URLSearchParams,Object.assign({visitor:function(l,u,f,g){return Br.isNode&&ut.isBuffer(l)?(this.append(u,l.toString("base64")),!1):g.defaultVisitor.apply(this,arguments)}},i))}function TR(e){return ut.matchAll(/\w+|\[(\w*)]/g,e).map(i=>i[0]==="[]"?"":i[1]||i[0])}function PR(e){const i={},l=Object.keys(e);let u;const f=l.length;let g;for(u=0;u<f;u++)g=l[u],i[g]=e[g];return i}function tC(e){function i(l,u,f,g){let m=l[g++];if(m==="__proto__")return!0;const o=Number.isFinite(+m),T=g>=l.length;return m=!m&&ut.isArray(f)?f.length:m,T?(ut.hasOwnProp(f,m)?f[m]=[f[m],u]:f[m]=u,!o):((!f[m]||!ut.isObject(f[m]))&&(f[m]=[]),i(l,u,f[m],g)&&ut.isArray(f[m])&&(f[m]=PR(f[m])),!o)}if(ut.isFormData(e)&&ut.isFunction(e.entries)){const l={};return ut.forEachEntry(e,(u,f)=>{i(TR(u),f,l,0)}),l}return null}function kR(e,i,l){if(ut.isString(e))try{return(i||JSON.parse)(e),ut.trim(e)}catch(u){if(u.name!=="SyntaxError")throw u}return(l||JSON.stringify)(e)}const Qy={transitional:eC,adapter:["xhr","http","fetch"],transformRequest:[function(i,l){const u=l.getContentType()||"",f=u.indexOf("application/json")>-1,g=ut.isObject(i);if(g&&ut.isHTMLForm(i)&&(i=new FormData(i)),ut.isFormData(i))return f?JSON.stringify(tC(i)):i;if(ut.isArrayBuffer(i)||ut.isBuffer(i)||ut.isStream(i)||ut.isFile(i)||ut.isBlob(i)||ut.isReadableStream(i))return i;if(ut.isArrayBufferView(i))return i.buffer;if(ut.isURLSearchParams(i))return l.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),i.toString();let o;if(g){if(u.indexOf("application/x-www-form-urlencoded")>-1)return CR(i,this.formSerializer).toString();if((o=ut.isFileList(i))||u.indexOf("multipart/form-data")>-1){const T=this.env&&this.env.FormData;return Em(o?{"files[]":i}:i,T&&new T,this.formSerializer)}}return g||f?(l.setContentType("application/json",!1),kR(i)):i}],transformResponse:[function(i){const l=this.transitional||Qy.transitional,u=l&&l.forcedJSONParsing,f=this.responseType==="json";if(ut.isResponse(i)||ut.isReadableStream(i))return i;if(i&&ut.isString(i)&&(u&&!this.responseType||f)){const m=!(l&&l.silentJSONParsing)&&f;try{return JSON.parse(i)}catch(o){if(m)throw o.name==="SyntaxError"?In.from(o,In.ERR_BAD_RESPONSE,this,null,this.response):o}}return i}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Br.classes.FormData,Blob:Br.classes.Blob},validateStatus:function(i){return i>=200&&i<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ut.forEach(["delete","get","head","post","put","patch"],e=>{Qy.headers[e]={}});const ev=Qy,IR=ut.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),MR=e=>{const i={};let l,u,f;return e&&e.split(`
`).forEach(function(m){f=m.indexOf(":"),l=m.substring(0,f).trim().toLowerCase(),u=m.substring(f+1).trim(),!(!l||i[l]&&IR[l])&&(l==="set-cookie"?i[l]?i[l].push(u):i[l]=[u]:i[l]=i[l]?i[l]+", "+u:u)}),i},Dx=Symbol("internals");function qd(e){return e&&String(e).trim().toLowerCase()}function kp(e){return e===!1||e==null?e:ut.isArray(e)?e.map(kp):String(e)}function ER(e){const i=Object.create(null),l=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let u;for(;u=l.exec(e);)i[u[1]]=u[2];return i}const AR=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function p_(e,i,l,u,f){if(ut.isFunction(u))return u.call(this,i,l);if(f&&(i=l),!!ut.isString(i)){if(ut.isString(u))return i.indexOf(u)!==-1;if(ut.isRegExp(u))return u.test(i)}}function RR(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(i,l,u)=>l.toUpperCase()+u)}function DR(e,i){const l=ut.toCamelCase(" "+i);["get","set","has"].forEach(u=>{Object.defineProperty(e,u+l,{value:function(f,g,m){return this[u].call(this,i,f,g,m)},configurable:!0})})}class Am{constructor(i){i&&this.set(i)}set(i,l,u){const f=this;function g(o,T,k){const I=qd(T);if(!I)throw new Error("header name must be a non-empty string");const z=ut.findKey(f,I);(!z||f[z]===void 0||k===!0||k===void 0&&f[z]!==!1)&&(f[z||T]=kp(o))}const m=(o,T)=>ut.forEach(o,(k,I)=>g(k,I,T));if(ut.isPlainObject(i)||i instanceof this.constructor)m(i,l);else if(ut.isString(i)&&(i=i.trim())&&!AR(i))m(MR(i),l);else if(ut.isHeaders(i))for(const[o,T]of i.entries())g(T,o,u);else i!=null&&g(l,i,u);return this}get(i,l){if(i=qd(i),i){const u=ut.findKey(this,i);if(u){const f=this[u];if(!l)return f;if(l===!0)return ER(f);if(ut.isFunction(l))return l.call(this,f,u);if(ut.isRegExp(l))return l.exec(f);throw new TypeError("parser must be boolean|regexp|function")}}}has(i,l){if(i=qd(i),i){const u=ut.findKey(this,i);return!!(u&&this[u]!==void 0&&(!l||p_(this,this[u],u,l)))}return!1}delete(i,l){const u=this;let f=!1;function g(m){if(m=qd(m),m){const o=ut.findKey(u,m);o&&(!l||p_(u,u[o],o,l))&&(delete u[o],f=!0)}}return ut.isArray(i)?i.forEach(g):g(i),f}clear(i){const l=Object.keys(this);let u=l.length,f=!1;for(;u--;){const g=l[u];(!i||p_(this,this[g],g,i,!0))&&(delete this[g],f=!0)}return f}normalize(i){const l=this,u={};return ut.forEach(this,(f,g)=>{const m=ut.findKey(u,g);if(m){l[m]=kp(f),delete l[g];return}const o=i?RR(g):String(g).trim();o!==g&&delete l[g],l[o]=kp(f),u[o]=!0}),this}concat(...i){return this.constructor.concat(this,...i)}toJSON(i){const l=Object.create(null);return ut.forEach(this,(u,f)=>{u!=null&&u!==!1&&(l[f]=i&&ut.isArray(u)?u.join(", "):u)}),l}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([i,l])=>i+": "+l).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(i){return i instanceof this?i:new this(i)}static concat(i,...l){const u=new this(i);return l.forEach(f=>u.set(f)),u}static accessor(i){const u=(this[Dx]=this[Dx]={accessors:{}}).accessors,f=this.prototype;function g(m){const o=qd(m);u[o]||(DR(f,m),u[o]=!0)}return ut.isArray(i)?i.forEach(g):g(i),this}}Am.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ut.reduceDescriptors(Am.prototype,({value:e},i)=>{let l=i[0].toUpperCase()+i.slice(1);return{get:()=>e,set(u){this[l]=u}}});ut.freezeMethods(Am);const as=Am;function m_(e,i){const l=this||ev,u=i||l,f=as.from(u.headers);let g=u.data;return ut.forEach(e,function(o){g=o.call(l,g,f.normalize(),i?i.status:void 0)}),f.normalize(),g}function nC(e){return!!(e&&e.__CANCEL__)}function xu(e,i,l){In.call(this,e??"canceled",In.ERR_CANCELED,i,l),this.name="CanceledError"}ut.inherits(xu,In,{__CANCEL__:!0});function iC(e,i,l){const u=l.config.validateStatus;!l.status||!u||u(l.status)?e(l):i(new In("Request failed with status code "+l.status,[In.ERR_BAD_REQUEST,In.ERR_BAD_RESPONSE][Math.floor(l.status/100)-4],l.config,l.request,l))}function zR(e){const i=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return i&&i[1]||""}function LR(e,i){e=e||10;const l=new Array(e),u=new Array(e);let f=0,g=0,m;return i=i!==void 0?i:1e3,function(T){const k=Date.now(),I=u[g];m||(m=k),l[f]=T,u[f]=k;let z=g,O=0;for(;z!==f;)O+=l[z++],z=z%e;if(f=(f+1)%e,f===g&&(g=(g+1)%e),k-m<i)return;const D=I&&k-I;return D?Math.round(O*1e3/D):void 0}}function BR(e,i){let l=0,u=1e3/i,f,g;const m=(k,I=Date.now())=>{l=I,f=null,g&&(clearTimeout(g),g=null),e.apply(null,k)};return[(...k)=>{const I=Date.now(),z=I-l;z>=u?m(k,I):(f=k,g||(g=setTimeout(()=>{g=null,m(f)},u-z)))},()=>f&&m(f)]}const Yp=(e,i,l=3)=>{let u=0;const f=LR(50,250);return BR(g=>{const m=g.loaded,o=g.lengthComputable?g.total:void 0,T=m-u,k=f(T),I=m<=o;u=m;const z={loaded:m,total:o,progress:o?m/o:void 0,bytes:T,rate:k||void 0,estimated:k&&o&&I?(o-m)/k:void 0,event:g,lengthComputable:o!=null,[i?"download":"upload"]:!0};e(z)},l)},zx=(e,i)=>{const l=e!=null;return[u=>i[0]({lengthComputable:l,total:e,loaded:u}),i[1]]},Lx=e=>(...i)=>ut.asap(()=>e(...i)),FR=Br.hasStandardBrowserEnv?((e,i)=>l=>(l=new URL(l,Br.origin),e.protocol===l.protocol&&e.host===l.host&&(i||e.port===l.port)))(new URL(Br.origin),Br.navigator&&/(msie|trident)/i.test(Br.navigator.userAgent)):()=>!0,OR=Br.hasStandardBrowserEnv?{write(e,i,l,u,f,g){const m=[e+"="+encodeURIComponent(i)];ut.isNumber(l)&&m.push("expires="+new Date(l).toGMTString()),ut.isString(u)&&m.push("path="+u),ut.isString(f)&&m.push("domain="+f),g===!0&&m.push("secure"),document.cookie=m.join("; ")},read(e){const i=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return i?decodeURIComponent(i[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function VR(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function NR(e,i){return i?e.replace(/\/?\/$/,"")+"/"+i.replace(/^\/+/,""):e}function rC(e,i){return e&&!VR(i)?NR(e,i):i}const Bx=e=>e instanceof as?{...e}:e;function Yl(e,i){i=i||{};const l={};function u(k,I,z,O){return ut.isPlainObject(k)&&ut.isPlainObject(I)?ut.merge.call({caseless:O},k,I):ut.isPlainObject(I)?ut.merge({},I):ut.isArray(I)?I.slice():I}function f(k,I,z,O){if(ut.isUndefined(I)){if(!ut.isUndefined(k))return u(void 0,k,z,O)}else return u(k,I,z,O)}function g(k,I){if(!ut.isUndefined(I))return u(void 0,I)}function m(k,I){if(ut.isUndefined(I)){if(!ut.isUndefined(k))return u(void 0,k)}else return u(void 0,I)}function o(k,I,z){if(z in i)return u(k,I);if(z in e)return u(void 0,k)}const T={url:g,method:g,data:g,baseURL:m,transformRequest:m,transformResponse:m,paramsSerializer:m,timeout:m,timeoutMessage:m,withCredentials:m,withXSRFToken:m,adapter:m,responseType:m,xsrfCookieName:m,xsrfHeaderName:m,onUploadProgress:m,onDownloadProgress:m,decompress:m,maxContentLength:m,maxBodyLength:m,beforeRedirect:m,transport:m,httpAgent:m,httpsAgent:m,cancelToken:m,socketPath:m,responseEncoding:m,validateStatus:o,headers:(k,I,z)=>f(Bx(k),Bx(I),z,!0)};return ut.forEach(Object.keys(Object.assign({},e,i)),function(I){const z=T[I]||f,O=z(e[I],i[I],I);ut.isUndefined(O)&&z!==o||(l[I]=O)}),l}const aC=e=>{const i=Yl({},e);let{data:l,withXSRFToken:u,xsrfHeaderName:f,xsrfCookieName:g,headers:m,auth:o}=i;i.headers=m=as.from(m),i.url=QS(rC(i.baseURL,i.url),e.params,e.paramsSerializer),o&&m.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let T;if(ut.isFormData(l)){if(Br.hasStandardBrowserEnv||Br.hasStandardBrowserWebWorkerEnv)m.setContentType(void 0);else if((T=m.getContentType())!==!1){const[k,...I]=T?T.split(";").map(z=>z.trim()).filter(Boolean):[];m.setContentType([k||"multipart/form-data",...I].join("; "))}}if(Br.hasStandardBrowserEnv&&(u&&ut.isFunction(u)&&(u=u(i)),u||u!==!1&&FR(i.url))){const k=f&&g&&OR.read(g);k&&m.set(f,k)}return i},$R=typeof XMLHttpRequest<"u",jR=$R&&function(e){return new Promise(function(l,u){const f=aC(e);let g=f.data;const m=as.from(f.headers).normalize();let{responseType:o,onUploadProgress:T,onDownloadProgress:k}=f,I,z,O,D,B;function V(){D&&D(),B&&B(),f.cancelToken&&f.cancelToken.unsubscribe(I),f.signal&&f.signal.removeEventListener("abort",I)}let Z=new XMLHttpRequest;Z.open(f.method.toUpperCase(),f.url,!0),Z.timeout=f.timeout;function oe(){if(!Z)return;const Se=as.from("getAllResponseHeaders"in Z&&Z.getAllResponseHeaders()),be={data:!o||o==="text"||o==="json"?Z.responseText:Z.response,status:Z.status,statusText:Z.statusText,headers:Se,config:e,request:Z};iC(function(Ce){l(Ce),V()},function(Ce){u(Ce),V()},be),Z=null}"onloadend"in Z?Z.onloadend=oe:Z.onreadystatechange=function(){!Z||Z.readyState!==4||Z.status===0&&!(Z.responseURL&&Z.responseURL.indexOf("file:")===0)||setTimeout(oe)},Z.onabort=function(){Z&&(u(new In("Request aborted",In.ECONNABORTED,e,Z)),Z=null)},Z.onerror=function(){u(new In("Network Error",In.ERR_NETWORK,e,Z)),Z=null},Z.ontimeout=function(){let me=f.timeout?"timeout of "+f.timeout+"ms exceeded":"timeout exceeded";const be=f.transitional||eC;f.timeoutErrorMessage&&(me=f.timeoutErrorMessage),u(new In(me,be.clarifyTimeoutError?In.ETIMEDOUT:In.ECONNABORTED,e,Z)),Z=null},g===void 0&&m.setContentType(null),"setRequestHeader"in Z&&ut.forEach(m.toJSON(),function(me,be){Z.setRequestHeader(be,me)}),ut.isUndefined(f.withCredentials)||(Z.withCredentials=!!f.withCredentials),o&&o!=="json"&&(Z.responseType=f.responseType),k&&([O,B]=Yp(k,!0),Z.addEventListener("progress",O)),T&&Z.upload&&([z,D]=Yp(T),Z.upload.addEventListener("progress",z),Z.upload.addEventListener("loadend",D)),(f.cancelToken||f.signal)&&(I=Se=>{Z&&(u(!Se||Se.type?new xu(null,e,Z):Se),Z.abort(),Z=null)},f.cancelToken&&f.cancelToken.subscribe(I),f.signal&&(f.signal.aborted?I():f.signal.addEventListener("abort",I)));const pe=zR(f.url);if(pe&&Br.protocols.indexOf(pe)===-1){u(new In("Unsupported protocol "+pe+":",In.ERR_BAD_REQUEST,e));return}Z.send(g||null)})},UR=(e,i)=>{const{length:l}=e=e?e.filter(Boolean):[];if(i||l){let u=new AbortController,f;const g=function(k){if(!f){f=!0,o();const I=k instanceof Error?k:this.reason;u.abort(I instanceof In?I:new xu(I instanceof Error?I.message:I))}};let m=i&&setTimeout(()=>{m=null,g(new In(`timeout ${i} of ms exceeded`,In.ETIMEDOUT))},i);const o=()=>{e&&(m&&clearTimeout(m),m=null,e.forEach(k=>{k.unsubscribe?k.unsubscribe(g):k.removeEventListener("abort",g)}),e=null)};e.forEach(k=>k.addEventListener("abort",g));const{signal:T}=u;return T.unsubscribe=()=>ut.asap(o),T}},GR=UR,HR=function*(e,i){let l=e.byteLength;if(!i||l<i){yield e;return}let u=0,f;for(;u<l;)f=u+i,yield e.slice(u,f),u=f},ZR=async function*(e,i){for await(const l of qR(e))yield*HR(l,i)},qR=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const i=e.getReader();try{for(;;){const{done:l,value:u}=await i.read();if(l)break;yield u}}finally{await i.cancel()}},Fx=(e,i,l,u)=>{const f=ZR(e,i);let g=0,m,o=T=>{m||(m=!0,u&&u(T))};return new ReadableStream({async pull(T){try{const{done:k,value:I}=await f.next();if(k){o(),T.close();return}let z=I.byteLength;if(l){let O=g+=z;l(O)}T.enqueue(new Uint8Array(I))}catch(k){throw o(k),k}},cancel(T){return o(T),f.return()}},{highWaterMark:2})},Rm=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",sC=Rm&&typeof ReadableStream=="function",WR=Rm&&(typeof TextEncoder=="function"?(e=>i=>e.encode(i))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),oC=(e,...i)=>{try{return!!e(...i)}catch{return!1}},XR=sC&&oC(()=>{let e=!1;const i=new Request(Br.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!i}),Ox=64*1024,ey=sC&&oC(()=>ut.isReadableStream(new Response("").body)),Jp={stream:ey&&(e=>e.body)};Rm&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(i=>{!Jp[i]&&(Jp[i]=ut.isFunction(e[i])?l=>l[i]():(l,u)=>{throw new In(`Response type '${i}' is not supported`,In.ERR_NOT_SUPPORT,u)})})})(new Response);const KR=async e=>{if(e==null)return 0;if(ut.isBlob(e))return e.size;if(ut.isSpecCompliantForm(e))return(await new Request(Br.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(ut.isArrayBufferView(e)||ut.isArrayBuffer(e))return e.byteLength;if(ut.isURLSearchParams(e)&&(e=e+""),ut.isString(e))return(await WR(e)).byteLength},YR=async(e,i)=>{const l=ut.toFiniteNumber(e.getContentLength());return l??KR(i)},JR=Rm&&(async e=>{let{url:i,method:l,data:u,signal:f,cancelToken:g,timeout:m,onDownloadProgress:o,onUploadProgress:T,responseType:k,headers:I,withCredentials:z="same-origin",fetchOptions:O}=aC(e);k=k?(k+"").toLowerCase():"text";let D=GR([f,g&&g.toAbortSignal()],m),B;const V=D&&D.unsubscribe&&(()=>{D.unsubscribe()});let Z;try{if(T&&XR&&l!=="get"&&l!=="head"&&(Z=await YR(I,u))!==0){let be=new Request(i,{method:"POST",body:u,duplex:"half"}),he;if(ut.isFormData(u)&&(he=be.headers.get("content-type"))&&I.setContentType(he),be.body){const[Ce,ye]=zx(Z,Yp(Lx(T)));u=Fx(be.body,Ox,Ce,ye)}}ut.isString(z)||(z=z?"include":"omit");const oe="credentials"in Request.prototype;B=new Request(i,{...O,signal:D,method:l.toUpperCase(),headers:I.normalize().toJSON(),body:u,duplex:"half",credentials:oe?z:void 0});let pe=await fetch(B);const Se=ey&&(k==="stream"||k==="response");if(ey&&(o||Se&&V)){const be={};["status","statusText","headers"].forEach(Me=>{be[Me]=pe[Me]});const he=ut.toFiniteNumber(pe.headers.get("content-length")),[Ce,ye]=o&&zx(he,Yp(Lx(o),!0))||[];pe=new Response(Fx(pe.body,Ox,Ce,()=>{ye&&ye(),V&&V()}),be)}k=k||"text";let me=await Jp[ut.findKey(Jp,k)||"text"](pe,e);return!Se&&V&&V(),await new Promise((be,he)=>{iC(be,he,{data:me,headers:as.from(pe.headers),status:pe.status,statusText:pe.statusText,config:e,request:B})})}catch(oe){throw V&&V(),oe&&oe.name==="TypeError"&&/fetch/i.test(oe.message)?Object.assign(new In("Network Error",In.ERR_NETWORK,e,B),{cause:oe.cause||oe}):In.from(oe,oe&&oe.code,e,B)}}),ty={http:dR,xhr:jR,fetch:JR};ut.forEach(ty,(e,i)=>{if(e){try{Object.defineProperty(e,"name",{value:i})}catch{}Object.defineProperty(e,"adapterName",{value:i})}});const Vx=e=>`- ${e}`,QR=e=>ut.isFunction(e)||e===null||e===!1,lC={getAdapter:e=>{e=ut.isArray(e)?e:[e];const{length:i}=e;let l,u;const f={};for(let g=0;g<i;g++){l=e[g];let m;if(u=l,!QR(l)&&(u=ty[(m=String(l)).toLowerCase()],u===void 0))throw new In(`Unknown adapter '${m}'`);if(u)break;f[m||"#"+g]=u}if(!u){const g=Object.entries(f).map(([o,T])=>`adapter ${o} `+(T===!1?"is not supported by the environment":"is not available in the build"));let m=i?g.length>1?`since :
`+g.map(Vx).join(`
`):" "+Vx(g[0]):"as no adapter specified";throw new In("There is no suitable adapter to dispatch the request "+m,"ERR_NOT_SUPPORT")}return u},adapters:ty};function g_(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new xu(null,e)}function Nx(e){return g_(e),e.headers=as.from(e.headers),e.data=m_.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),lC.getAdapter(e.adapter||ev.adapter)(e).then(function(u){return g_(e),u.data=m_.call(e,e.transformResponse,u),u.headers=as.from(u.headers),u},function(u){return nC(u)||(g_(e),u&&u.response&&(u.response.data=m_.call(e,e.transformResponse,u.response),u.response.headers=as.from(u.response.headers))),Promise.reject(u)})}const cC="1.7.9",Dm={};["object","boolean","number","function","string","symbol"].forEach((e,i)=>{Dm[e]=function(u){return typeof u===e||"a"+(i<1?"n ":" ")+e}});const $x={};Dm.transitional=function(i,l,u){function f(g,m){return"[Axios v"+cC+"] Transitional option '"+g+"'"+m+(u?". "+u:"")}return(g,m,o)=>{if(i===!1)throw new In(f(m," has been removed"+(l?" in "+l:"")),In.ERR_DEPRECATED);return l&&!$x[m]&&($x[m]=!0,console.warn(f(m," has been deprecated since v"+l+" and will be removed in the near future"))),i?i(g,m,o):!0}};Dm.spelling=function(i){return(l,u)=>(console.warn(`${u} is likely a misspelling of ${i}`),!0)};function eD(e,i,l){if(typeof e!="object")throw new In("options must be an object",In.ERR_BAD_OPTION_VALUE);const u=Object.keys(e);let f=u.length;for(;f-- >0;){const g=u[f],m=i[g];if(m){const o=e[g],T=o===void 0||m(o,g,e);if(T!==!0)throw new In("option "+g+" must be "+T,In.ERR_BAD_OPTION_VALUE);continue}if(l!==!0)throw new In("Unknown option "+g,In.ERR_BAD_OPTION)}}const Ip={assertOptions:eD,validators:Dm},vs=Ip.validators;class Qp{constructor(i){this.defaults=i,this.interceptors={request:new Rx,response:new Rx}}async request(i,l){try{return await this._request(i,l)}catch(u){if(u instanceof Error){let f={};Error.captureStackTrace?Error.captureStackTrace(f):f=new Error;const g=f.stack?f.stack.replace(/^.+\n/,""):"";try{u.stack?g&&!String(u.stack).endsWith(g.replace(/^.+\n.+\n/,""))&&(u.stack+=`
`+g):u.stack=g}catch{}}throw u}}_request(i,l){typeof i=="string"?(l=l||{},l.url=i):l=i||{},l=Yl(this.defaults,l);const{transitional:u,paramsSerializer:f,headers:g}=l;u!==void 0&&Ip.assertOptions(u,{silentJSONParsing:vs.transitional(vs.boolean),forcedJSONParsing:vs.transitional(vs.boolean),clarifyTimeoutError:vs.transitional(vs.boolean)},!1),f!=null&&(ut.isFunction(f)?l.paramsSerializer={serialize:f}:Ip.assertOptions(f,{encode:vs.function,serialize:vs.function},!0)),Ip.assertOptions(l,{baseUrl:vs.spelling("baseURL"),withXsrfToken:vs.spelling("withXSRFToken")},!0),l.method=(l.method||this.defaults.method||"get").toLowerCase();let m=g&&ut.merge(g.common,g[l.method]);g&&ut.forEach(["delete","get","head","post","put","patch","common"],B=>{delete g[B]}),l.headers=as.concat(m,g);const o=[];let T=!0;this.interceptors.request.forEach(function(V){typeof V.runWhen=="function"&&V.runWhen(l)===!1||(T=T&&V.synchronous,o.unshift(V.fulfilled,V.rejected))});const k=[];this.interceptors.response.forEach(function(V){k.push(V.fulfilled,V.rejected)});let I,z=0,O;if(!T){const B=[Nx.bind(this),void 0];for(B.unshift.apply(B,o),B.push.apply(B,k),O=B.length,I=Promise.resolve(l);z<O;)I=I.then(B[z++],B[z++]);return I}O=o.length;let D=l;for(z=0;z<O;){const B=o[z++],V=o[z++];try{D=B(D)}catch(Z){V.call(this,Z);break}}try{I=Nx.call(this,D)}catch(B){return Promise.reject(B)}for(z=0,O=k.length;z<O;)I=I.then(k[z++],k[z++]);return I}getUri(i){i=Yl(this.defaults,i);const l=rC(i.baseURL,i.url);return QS(l,i.params,i.paramsSerializer)}}ut.forEach(["delete","get","head","options"],function(i){Qp.prototype[i]=function(l,u){return this.request(Yl(u||{},{method:i,url:l,data:(u||{}).data}))}});ut.forEach(["post","put","patch"],function(i){function l(u){return function(g,m,o){return this.request(Yl(o||{},{method:i,headers:u?{"Content-Type":"multipart/form-data"}:{},url:g,data:m}))}}Qp.prototype[i]=l(),Qp.prototype[i+"Form"]=l(!0)});const Mp=Qp;class tv{constructor(i){if(typeof i!="function")throw new TypeError("executor must be a function.");let l;this.promise=new Promise(function(g){l=g});const u=this;this.promise.then(f=>{if(!u._listeners)return;let g=u._listeners.length;for(;g-- >0;)u._listeners[g](f);u._listeners=null}),this.promise.then=f=>{let g;const m=new Promise(o=>{u.subscribe(o),g=o}).then(f);return m.cancel=function(){u.unsubscribe(g)},m},i(function(g,m,o){u.reason||(u.reason=new xu(g,m,o),l(u.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(i){if(this.reason){i(this.reason);return}this._listeners?this._listeners.push(i):this._listeners=[i]}unsubscribe(i){if(!this._listeners)return;const l=this._listeners.indexOf(i);l!==-1&&this._listeners.splice(l,1)}toAbortSignal(){const i=new AbortController,l=u=>{i.abort(u)};return this.subscribe(l),i.signal.unsubscribe=()=>this.unsubscribe(l),i.signal}static source(){let i;return{token:new tv(function(f){i=f}),cancel:i}}}const tD=tv;function nD(e){return function(l){return e.apply(null,l)}}function iD(e){return ut.isObject(e)&&e.isAxiosError===!0}const ny={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ny).forEach(([e,i])=>{ny[i]=e});const rD=ny;function uC(e){const i=new Mp(e),l=$S(Mp.prototype.request,i);return ut.extend(l,Mp.prototype,i,{allOwnKeys:!0}),ut.extend(l,i,null,{allOwnKeys:!0}),l.create=function(f){return uC(Yl(e,f))},l}const or=uC(ev);or.Axios=Mp;or.CanceledError=xu;or.CancelToken=tD;or.isCancel=nC;or.VERSION=cC;or.toFormData=Em;or.AxiosError=In;or.Cancel=or.CanceledError;or.all=function(i){return Promise.all(i)};or.spread=nD;or.isAxiosError=iD;or.mergeConfig=Yl;or.AxiosHeaders=as;or.formToJSON=e=>tC(ut.isHTMLForm(e)?new FormData(e):e);or.getAdapter=lC.getAdapter;or.HttpStatusCode=rD;or.default=or;const aD=or,Ht=aD.create({baseURL:"https://cw-racingapp/"}),ca=()=>{const e=ei();e.appIsOpen=!1,Ht.post("UiCloseUi")};const dC=Ct({baseColor:String,divided:Boolean,...lo(),...xn(),...Pa(),...uo(),...ua(),...Ti(),...Di(),...Is()},"VBtnGroup"),jx=Wt()({name:"VBtnGroup",props:dC(),setup(e,i){let{slots:l}=i;const{themeClasses:u}=Hi(e),{densityClasses:f}=$a(e),{borderClasses:g}=co(e),{elevationClasses:m}=ho(e),{roundedClasses:o}=da(e);Qo({VBtn:{height:"auto",baseColor:rn(e,"baseColor"),color:rn(e,"color"),density:rn(e,"density"),flat:!0,variant:rn(e,"variant")}}),hn(()=>E(e.tag,{class:["v-btn-group",{"v-btn-group--divided":e.divided},u.value,g.value,f.value,m.value,o.value,e.class],style:e.style},l))}}),hC=Symbol.for("vuetify:v-btn-toggle"),sD=Ct({...dC(),...jy()},"VBtnToggle");Wt()({name:"VBtnToggle",props:sD(),emits:{"update:modelValue":e=>!0},setup(e,i){let{slots:l}=i;const{isSelected:u,next:f,prev:g,select:m,selected:o}=Sm(e,hC);return hn(()=>{const T=jx.filterProps(e);return E(jx,an({class:["v-btn-toggle",e.class]},T,{style:e.style}),{default:()=>{var k;return[(k=l.default)==null?void 0:k.call(l,{isSelected:u,next:f,prev:g,select:m,selected:o})]}})}),{next:f,prev:g,select:m}}});function fC(e,i){const l=Ke(),u=ln(!1);if(Iy){const f=new IntersectionObserver(g=>{e==null||e(g,f),u.value=!!g.find(m=>m.isIntersecting)},i);Ir(()=>{f.disconnect()}),en(l,(g,m)=>{m&&(f.unobserve(m),u.value=!1),g&&f.observe(g)},{flush:"post"})}return{intersectionRef:l,isIntersecting:u}}const oD=Ct({bgColor:String,color:String,indeterminate:[Boolean,String],modelValue:{type:[Number,String],default:0},rotate:{type:[Number,String],default:0},width:{type:[Number,String],default:4},...xn(),...Eh(),...Ti({tag:"div"}),...Di()},"VProgressCircular"),pC=Wt()({name:"VProgressCircular",props:oD(),setup(e,i){let{slots:l}=i;const u=20,f=2*Math.PI*u,g=Ke(),{themeClasses:m}=Hi(e),{sizeClasses:o,sizeStyles:T}=Ah(e),{textColorClasses:k,textColorStyles:I}=os(rn(e,"color")),{textColorClasses:z,textColorStyles:O}=os(rn(e,"bgColor")),{intersectionRef:D,isIntersecting:B}=fC(),{resizeRef:V,contentRect:Z}=mu(),oe=ce(()=>Math.max(0,Math.min(100,parseFloat(e.modelValue)))),pe=ce(()=>Number(e.width)),Se=ce(()=>T.value?Number(e.size):Z.value?Z.value.width:Math.max(pe.value,32)),me=ce(()=>u/(1-pe.value/Se.value)*2),be=ce(()=>pe.value/Se.value*me.value),he=ce(()=>mn((100-oe.value)/100*f));return Sa(()=>{D.value=g.value,V.value=g.value}),hn(()=>E(e.tag,{ref:g,class:["v-progress-circular",{"v-progress-circular--indeterminate":!!e.indeterminate,"v-progress-circular--visible":B.value,"v-progress-circular--disable-shrink":e.indeterminate==="disable-shrink"},m.value,o.value,k.value,e.class],style:[T.value,I.value,e.style],role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":e.indeterminate?void 0:oe.value},{default:()=>[E("svg",{style:{transform:`rotate(calc(-90deg + ${Number(e.rotate)}deg))`},xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${me.value} ${me.value}`},[E("circle",{class:["v-progress-circular__underlay",z.value],style:O.value,fill:"transparent",cx:"50%",cy:"50%",r:u,"stroke-width":be.value,"stroke-dasharray":f,"stroke-dashoffset":0},null),E("circle",{class:"v-progress-circular__overlay",fill:"transparent",cx:"50%",cy:"50%",r:u,"stroke-width":be.value,"stroke-dasharray":f,"stroke-dashoffset":he.value},null)]),l.default&&E("div",{class:"v-progress-circular__content"},[l.default({value:oe.value})])]})),{}}});const lD=Ct({absolute:Boolean,active:{type:Boolean,default:!0},bgColor:String,bgOpacity:[Number,String],bufferValue:{type:[Number,String],default:0},bufferColor:String,bufferOpacity:[Number,String],clickable:Boolean,color:String,height:{type:[Number,String],default:4},indeterminate:Boolean,max:{type:[Number,String],default:100},modelValue:{type:[Number,String],default:0},opacity:[Number,String],reverse:Boolean,stream:Boolean,striped:Boolean,roundedBar:Boolean,...xn(),...vu({location:"top"}),...ua(),...Ti(),...Di()},"VProgressLinear"),mC=Wt()({name:"VProgressLinear",props:lD(),emits:{"update:modelValue":e=>!0},setup(e,i){var Ee;let{slots:l}=i;const u=ai(e,"modelValue"),{isRtl:f,rtlClasses:g}=ja(),{themeClasses:m}=Hi(e),{locationStyles:o}=Lh(e),{textColorClasses:T,textColorStyles:k}=os(e,"color"),{backgroundColorClasses:I,backgroundColorStyles:z}=Fa(ce(()=>e.bgColor||e.color)),{backgroundColorClasses:O,backgroundColorStyles:D}=Fa(ce(()=>e.bufferColor||e.bgColor||e.color)),{backgroundColorClasses:B,backgroundColorStyles:V}=Fa(e,"color"),{roundedClasses:Z}=da(e),{intersectionRef:oe,isIntersecting:pe}=fC(),Se=ce(()=>parseFloat(e.max)),me=ce(()=>parseFloat(e.height)),be=ce(()=>Cs(parseFloat(e.bufferValue)/Se.value*100,0,100)),he=ce(()=>Cs(parseFloat(u.value)/Se.value*100,0,100)),Ce=ce(()=>f.value!==e.reverse),ye=ce(()=>e.indeterminate?"fade-transition":"slide-x-transition"),Me=Wn&&((Ee=window.matchMedia)==null?void 0:Ee.call(window,"(forced-colors: active)").matches);function ke(xe){if(!oe.value)return;const{left:Oe,right:We,width:dt}=oe.value.getBoundingClientRect(),je=Ce.value?dt-xe.clientX+(We-dt):xe.clientX-Oe;u.value=Math.round(je/dt*Se.value)}return hn(()=>E(e.tag,{ref:oe,class:["v-progress-linear",{"v-progress-linear--absolute":e.absolute,"v-progress-linear--active":e.active&&pe.value,"v-progress-linear--reverse":Ce.value,"v-progress-linear--rounded":e.rounded,"v-progress-linear--rounded-bar":e.roundedBar,"v-progress-linear--striped":e.striped},Z.value,m.value,g.value,e.class],style:[{bottom:e.location==="bottom"?0:void 0,top:e.location==="top"?0:void 0,height:e.active?mn(me.value):0,"--v-progress-linear-height":mn(me.value),...e.absolute?o.value:{}},e.style],role:"progressbar","aria-hidden":e.active?"false":"true","aria-valuemin":"0","aria-valuemax":e.max,"aria-valuenow":e.indeterminate?void 0:he.value,onClick:e.clickable&&ke},{default:()=>[e.stream&&E("div",{key:"stream",class:["v-progress-linear__stream",T.value],style:{...k.value,[Ce.value?"left":"right"]:mn(-me.value),borderTop:`${mn(me.value/2)} dotted`,opacity:parseFloat(e.bufferOpacity),top:`calc(50% - ${mn(me.value/4)})`,width:mn(100-be.value,"%"),"--v-progress-linear-stream-to":mn(me.value*(Ce.value?1:-1))}},null),E("div",{class:["v-progress-linear__background",Me?void 0:I.value],style:[z.value,{opacity:parseFloat(e.bgOpacity),width:e.stream?0:void 0}]},null),E("div",{class:["v-progress-linear__buffer",Me?void 0:O.value],style:[D.value,{opacity:parseFloat(e.bufferOpacity),width:mn(be.value,"%")}]},null),E(Ts,{name:ye.value},{default:()=>[e.indeterminate?E("div",{class:"v-progress-linear__indeterminate"},[["long","short"].map(xe=>E("div",{key:xe,class:["v-progress-linear__indeterminate",xe,Me?void 0:B.value],style:V.value},null))]):E("div",{class:["v-progress-linear__determinate",Me?void 0:B.value],style:[V.value,{width:mn(he.value,"%")}]},null)]}),l.default&&E("div",{class:"v-progress-linear__content"},[l.default({value:he.value,buffer:be.value})])]})),{}}}),nv=Ct({loading:[Boolean,String]},"loader");function zm(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ks();return{loaderClasses:ce(()=>({[`${i}--loading`]:e.loading}))}}function iv(e,i){var u;let{slots:l}=i;return E("div",{class:`${e.name}__loader`},[((u=l.default)==null?void 0:u.call(l,{color:e.color,isActive:e.active}))||E(mC,{absolute:e.absolute,active:e.active,color:e.color,height:"2",indeterminate:!0},null)])}function cD(e,i){en(()=>{var l;return(l=e.isActive)==null?void 0:l.value},l=>{e.isLink.value&&l&&i&&Fi(()=>{i(!0)})},{immediate:!0})}const gC=Ct({active:{type:Boolean,default:void 0},activeColor:String,baseColor:String,symbol:{type:null,default:hC},flat:Boolean,icon:[Boolean,String,Function,Object],prependIcon:Gn,appendIcon:Gn,block:Boolean,readonly:Boolean,slim:Boolean,stacked:Boolean,ripple:{type:[Boolean,Object],default:!0},text:String,...lo(),...xn(),...Pa(),...Va(),...uo(),...Uy(),...nv(),...vu(),...Bh(),...ua(),...Tm(),...Eh(),...Ti({tag:"button"}),...Di(),...Is({variant:"elevated"})},"VBtn"),Nt=Wt()({name:"VBtn",props:gC(),emits:{"group:selected":e=>!0},setup(e,i){let{attrs:l,slots:u}=i;const{themeClasses:f}=Hi(e),{borderClasses:g}=co(e),{densityClasses:m}=$a(e),{dimensionStyles:o}=Na(e),{elevationClasses:T}=ho(e),{loaderClasses:k}=zm(e),{locationStyles:I}=Lh(e),{positionClasses:z}=Fh(e),{roundedClasses:O}=da(e),{sizeClasses:D,sizeStyles:B}=Ah(e),V=Gy(e,e.symbol,!1),Z=Cm(e,l),oe=ce(()=>{var Ee;return e.active!==void 0?e.active:Z.isLink.value?(Ee=Z.isActive)==null?void 0:Ee.value:V==null?void 0:V.isSelected.value}),pe=ce(()=>oe.value?e.activeColor??e.color:e.color),Se=ce(()=>{var xe,Oe;return{color:(V==null?void 0:V.isSelected.value)&&(!Z.isLink.value||((xe=Z.isActive)==null?void 0:xe.value))||!V||((Oe=Z.isActive)==null?void 0:Oe.value)?pe.value??e.baseColor:e.baseColor,variant:e.variant}}),{colorClasses:me,colorStyles:be,variantClasses:he}=tc(Se),Ce=ce(()=>(V==null?void 0:V.disabled.value)||e.disabled),ye=ce(()=>e.variant==="elevated"&&!(e.disabled||e.flat||e.border)),Me=ce(()=>{if(!(e.value===void 0||typeof e.value=="symbol"))return Object(e.value)===e.value?JSON.stringify(e.value,null,0):e.value});function ke(Ee){var xe;Ce.value||Z.isLink.value&&(Ee.metaKey||Ee.ctrlKey||Ee.shiftKey||Ee.button!==0||l.target==="_blank")||((xe=Z.navigate)==null||xe.call(Z,Ee),V==null||V.toggle())}return cD(Z,V==null?void 0:V.select),hn(()=>{const Ee=Z.isLink.value?"a":e.tag,xe=!!(e.prependIcon||u.prepend),Oe=!!(e.appendIcon||u.append),We=!!(e.icon&&e.icon!==!0);return Pr(E(Ee,an({type:Ee==="a"?void 0:"button",class:["v-btn",V==null?void 0:V.selectedClass.value,{"v-btn--active":oe.value,"v-btn--block":e.block,"v-btn--disabled":Ce.value,"v-btn--elevated":ye.value,"v-btn--flat":e.flat,"v-btn--icon":!!e.icon,"v-btn--loading":e.loading,"v-btn--readonly":e.readonly,"v-btn--slim":e.slim,"v-btn--stacked":e.stacked},f.value,g.value,me.value,m.value,T.value,k.value,z.value,O.value,D.value,he.value,e.class],style:[be.value,o.value,I.value,B.value,e.style],"aria-busy":e.loading?!0:void 0,disabled:Ce.value||void 0,tabindex:e.loading||e.readonly?-1:void 0,onClick:ke,value:Me.value},Z.linkProps),{default:()=>{var dt;return[ec(!0,"v-btn"),!e.icon&&xe&&E("span",{key:"prepend",class:"v-btn__prepend"},[u.prepend?E(Bi,{key:"prepend-defaults",disabled:!e.prependIcon,defaults:{VIcon:{icon:e.prependIcon}}},u.prepend):E(ui,{key:"prepend-icon",icon:e.prependIcon},null)]),E("span",{class:"v-btn__content","data-no-activator":""},[!u.default&&We?E(ui,{key:"content-icon",icon:e.icon},null):E(Bi,{key:"content-defaults",disabled:!We,defaults:{VIcon:{icon:e.icon}}},{default:()=>{var je;return[((je=u.default)==null?void 0:je.call(u))??e.text]}})]),!e.icon&&Oe&&E("span",{key:"append",class:"v-btn__append"},[u.append?E(Bi,{key:"append-defaults",disabled:!e.appendIcon,defaults:{VIcon:{icon:e.appendIcon}}},u.append):E(ui,{key:"append-icon",icon:e.appendIcon},null)]),!!e.loading&&E("span",{key:"loader",class:"v-btn__loader"},[((dt=u.loader)==null?void 0:dt.call(u))??E(pC,{color:typeof e.loading=="boolean"?void 0:e.loading,indeterminate:!0,width:"2"},null)])]}}),[[zh,!Ce.value&&e.ripple,"",{center:!!e.icon}]])}),{group:V}}});const Zn=Wt()({name:"VCardActions",props:xn(),setup(e,i){let{slots:l}=i;return Qo({VBtn:{slim:!0,variant:"text"}}),hn(()=>{var u;return E("div",{class:["v-card-actions",e.class],style:e.style},[(u=l.default)==null?void 0:u.call(l)])}),{}}}),uD=Ct({opacity:[Number,String],...xn(),...Ti()},"VCardSubtitle"),rv=Wt()({name:"VCardSubtitle",props:uD(),setup(e,i){let{slots:l}=i;return hn(()=>E(e.tag,{class:["v-card-subtitle",e.class],style:[{"--v-card-subtitle-opacity":e.opacity},e.style]},l)),{}}}),$n=vm("v-card-title"),dD=Ct({appendAvatar:String,appendIcon:Gn,prependAvatar:String,prependIcon:Gn,subtitle:[String,Number],title:[String,Number],...xn(),...Pa()},"VCardItem"),hD=Wt()({name:"VCardItem",props:dD(),setup(e,i){let{slots:l}=i;return hn(()=>{var k;const u=!!(e.prependAvatar||e.prependIcon),f=!!(u||l.prepend),g=!!(e.appendAvatar||e.appendIcon),m=!!(g||l.append),o=!!(e.title!=null||l.title),T=!!(e.subtitle!=null||l.subtitle);return E("div",{class:["v-card-item",e.class],style:e.style},[f&&E("div",{key:"prepend",class:"v-card-item__prepend"},[l.prepend?E(Bi,{key:"prepend-defaults",disabled:!u,defaults:{VAvatar:{density:e.density,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon}}},l.prepend):E(un,null,[e.prependAvatar&&E(Kl,{key:"prepend-avatar",density:e.density,image:e.prependAvatar},null),e.prependIcon&&E(ui,{key:"prepend-icon",density:e.density,icon:e.prependIcon},null)])]),E("div",{class:"v-card-item__content"},[o&&E($n,{key:"title"},{default:()=>{var I;return[((I=l.title)==null?void 0:I.call(l))??e.title]}}),T&&E(rv,{key:"subtitle"},{default:()=>{var I;return[((I=l.subtitle)==null?void 0:I.call(l))??e.subtitle]}}),(k=l.default)==null?void 0:k.call(l)]),m&&E("div",{key:"append",class:"v-card-item__append"},[l.append?E(Bi,{key:"append-defaults",disabled:!g,defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon}}},l.append):E(un,null,[e.appendIcon&&E(ui,{key:"append-icon",density:e.density,icon:e.appendIcon},null),e.appendAvatar&&E(Kl,{key:"append-avatar",density:e.density,image:e.appendAvatar},null)])])])}),{}}}),fD=Ct({opacity:[Number,String],...xn(),...Ti()},"VCardText"),qn=Wt()({name:"VCardText",props:fD(),setup(e,i){let{slots:l}=i;return hn(()=>E(e.tag,{class:["v-card-text",e.class],style:[{"--v-card-text-opacity":e.opacity},e.style]},l)),{}}}),pD=Ct({appendAvatar:String,appendIcon:Gn,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:Gn,ripple:{type:[Boolean,Object],default:!0},subtitle:[String,Number],text:[String,Number],title:[String,Number],...lo(),...xn(),...Pa(),...Va(),...uo(),...nv(),...vu(),...Bh(),...ua(),...Tm(),...Ti(),...Di(),...Is({variant:"elevated"})},"VCard"),On=Wt()({name:"VCard",directives:{Ripple:zh},props:pD(),setup(e,i){let{attrs:l,slots:u}=i;const{themeClasses:f}=Hi(e),{borderClasses:g}=co(e),{colorClasses:m,colorStyles:o,variantClasses:T}=tc(e),{densityClasses:k}=$a(e),{dimensionStyles:I}=Na(e),{elevationClasses:z}=ho(e),{loaderClasses:O}=zm(e),{locationStyles:D}=Lh(e),{positionClasses:B}=Fh(e),{roundedClasses:V}=da(e),Z=Cm(e,l),oe=ce(()=>e.link!==!1&&Z.isLink.value),pe=ce(()=>!e.disabled&&e.link!==!1&&(e.link||Z.isClickable.value));return hn(()=>{const Se=oe.value?"a":e.tag,me=!!(u.title||e.title!=null),be=!!(u.subtitle||e.subtitle!=null),he=me||be,Ce=!!(u.append||e.appendAvatar||e.appendIcon),ye=!!(u.prepend||e.prependAvatar||e.prependIcon),Me=!!(u.image||e.image),ke=he||ye||Ce,Ee=!!(u.text||e.text!=null);return Pr(E(Se,an({class:["v-card",{"v-card--disabled":e.disabled,"v-card--flat":e.flat,"v-card--hover":e.hover&&!(e.disabled||e.flat),"v-card--link":pe.value},f.value,g.value,m.value,k.value,z.value,O.value,B.value,V.value,T.value,e.class],style:[o.value,I.value,D.value,e.style],onClick:pe.value&&Z.navigate,tabindex:e.disabled?-1:void 0},Z.linkProps),{default:()=>{var xe;return[Me&&E("div",{key:"image",class:"v-card__image"},[u.image?E(Bi,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},u.image):E(Ny,{key:"image-img",cover:!0,src:e.image},null)]),E(iv,{name:"v-card",active:!!e.loading,color:typeof e.loading=="boolean"?void 0:e.loading},{default:u.loader}),ke&&E(hD,{key:"item",prependAvatar:e.prependAvatar,prependIcon:e.prependIcon,title:e.title,subtitle:e.subtitle,appendAvatar:e.appendAvatar,appendIcon:e.appendIcon},{default:u.item,prepend:u.prepend,title:u.title,subtitle:u.subtitle,append:u.append}),Ee&&E(qn,{key:"text"},{default:()=>{var Oe;return[((Oe=u.text)==null?void 0:Oe.call(u))??e.text]}}),(xe=u.default)==null?void 0:xe.call(u),u.actions&&E(Zn,null,{default:u.actions}),ec(pe.value,"v-card")]}}),[[oo("ripple"),pe.value&&e.ripple]])}),{}}});const mD=Ct({fluid:{type:Boolean,default:!1},...xn(),...Va(),...Ti()},"VContainer"),Lm=Wt()({name:"VContainer",props:mD(),setup(e,i){let{slots:l}=i;const{rtlClasses:u}=ja(),{dimensionStyles:f}=Na(e);return hn(()=>E(e.tag,{class:["v-container",{"v-container--fluid":e.fluid},u.value,e.class],style:[f.value,e.style]},l)),{}}}),_C=(()=>xm.reduce((e,i)=>(e[i]={type:[Boolean,String,Number],default:!1},e),{}))(),yC=(()=>xm.reduce((e,i)=>{const l="offset"+ao(i);return e[l]={type:[String,Number],default:null},e},{}))(),vC=(()=>xm.reduce((e,i)=>{const l="order"+ao(i);return e[l]={type:[String,Number],default:null},e},{}))(),Ux={col:Object.keys(_C),offset:Object.keys(yC),order:Object.keys(vC)};function gD(e,i,l){let u=e;if(!(l==null||l===!1)){if(i){const f=i.replace(e,"");u+=`-${f}`}return e==="col"&&(u="v-"+u),e==="col"&&(l===""||l===!0)||(u+=`-${l}`),u.toLowerCase()}}const _D=["auto","start","end","center","baseline","stretch"],yD=Ct({cols:{type:[Boolean,String,Number],default:!1},..._C,offset:{type:[String,Number],default:null},...yC,order:{type:[String,Number],default:null},...vC,alignSelf:{type:String,default:null,validator:e=>_D.includes(e)},...xn(),...Ti()},"VCol"),sr=Wt()({name:"VCol",props:yD(),setup(e,i){let{slots:l}=i;const u=ce(()=>{const f=[];let g;for(g in Ux)Ux[g].forEach(o=>{const T=e[o],k=gD(g,o,T);k&&f.push(k)});const m=f.some(o=>o.startsWith("v-col-"));return f.push({"v-col":!m||!e.cols,[`v-col-${e.cols}`]:e.cols,[`offset-${e.offset}`]:e.offset,[`order-${e.order}`]:e.order,[`align-self-${e.alignSelf}`]:e.alignSelf}),f});return()=>{var f;return Jo(e.tag,{class:[u.value,e.class],style:e.style},(f=l.default)==null?void 0:f.call(l))}}}),av=["start","end","center"],bC=["space-between","space-around","space-evenly"];function sv(e,i){return xm.reduce((l,u)=>{const f=e+ao(u);return l[f]=i(),l},{})}const vD=[...av,"baseline","stretch"],xC=e=>vD.includes(e),wC=sv("align",()=>({type:String,default:null,validator:xC})),bD=[...av,...bC],SC=e=>bD.includes(e),CC=sv("justify",()=>({type:String,default:null,validator:SC})),xD=[...av,...bC,"stretch"],TC=e=>xD.includes(e),PC=sv("alignContent",()=>({type:String,default:null,validator:TC})),Gx={align:Object.keys(wC),justify:Object.keys(CC),alignContent:Object.keys(PC)},wD={align:"align",justify:"justify",alignContent:"align-content"};function SD(e,i,l){let u=wD[e];if(l!=null){if(i){const f=i.replace(e,"");u+=`-${f}`}return u+=`-${l}`,u.toLowerCase()}}const CD=Ct({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:xC},...wC,justify:{type:String,default:null,validator:SC},...CC,alignContent:{type:String,default:null,validator:TC},...PC,...xn(),...Ti()},"VRow"),ns=Wt()({name:"VRow",props:CD(),setup(e,i){let{slots:l}=i;const u=ce(()=>{const f=[];let g;for(g in Gx)Gx[g].forEach(m=>{const o=e[m],T=SD(g,m,o);T&&f.push(T)});return f.push({"v-row--no-gutters":e.noGutters,"v-row--dense":e.dense,[`align-${e.align}`]:e.align,[`justify-${e.justify}`]:e.justify,[`align-content-${e.alignContent}`]:e.alignContent}),f});return()=>{var f;return Jo(e.tag,{class:["v-row",u.value,e.class],style:e.style},(f=l.default)==null?void 0:f.call(l))}}}),Qi=vm("v-spacer","div","VSpacer");function __(e,i){return{x:e.x+i.x,y:e.y+i.y}}function TD(e,i){return{x:e.x-i.x,y:e.y-i.y}}function Hx(e,i){if(e.side==="top"||e.side==="bottom"){const{side:l,align:u}=e,f=u==="left"?0:u==="center"?i.width/2:u==="right"?i.width:u,g=l==="top"?0:l==="bottom"?i.height:l;return __({x:f,y:g},i)}else if(e.side==="left"||e.side==="right"){const{side:l,align:u}=e,f=l==="left"?0:l==="right"?i.width:l,g=u==="top"?0:u==="center"?i.height/2:u==="bottom"?i.height:u;return __({x:f,y:g},i)}return __({x:i.width/2,y:i.height/2},i)}const kC={static:ID,connected:ED},PD=Ct({locationStrategy:{type:[String,Function],default:"static",validator:e=>typeof e=="function"||e in kC},location:{type:String,default:"bottom"},origin:{type:String,default:"auto"},offset:[Number,String,Array]},"VOverlay-location-strategies");function kD(e,i){const l=Ke({}),u=Ke();Wn&&Oa(()=>!!(i.isActive.value&&e.locationStrategy),g=>{var m,o;en(()=>e.locationStrategy,g),kr(()=>{window.removeEventListener("resize",f),u.value=void 0}),window.addEventListener("resize",f,{passive:!0}),typeof e.locationStrategy=="function"?u.value=(m=e.locationStrategy(i,e,l))==null?void 0:m.updateLocation:u.value=(o=kC[e.locationStrategy](i,e,l))==null?void 0:o.updateLocation});function f(g){var m;(m=u.value)==null||m.call(u,g)}return{contentStyles:l,updateLocation:u}}function ID(){}function MD(e,i){const l=Dy(e);return i?l.x+=parseFloat(e.style.right||0):l.x-=parseFloat(e.style.left||0),l.y-=parseFloat(e.style.top||0),l}function ED(e,i,l){(Array.isArray(e.target.value)||YI(e.target.value))&&Object.assign(l.value,{position:"fixed",top:0,[e.isRtl.value?"right":"left"]:0});const{preferredAnchor:f,preferredOrigin:g}=Ry(()=>{const B=$_(i.location,e.isRtl.value),V=i.origin==="overlap"?B:i.origin==="auto"?l_(B):$_(i.origin,e.isRtl.value);return B.side===V.side&&B.align===c_(V).align?{preferredAnchor:Gb(B),preferredOrigin:Gb(V)}:{preferredAnchor:B,preferredOrigin:V}}),[m,o,T,k]=["minWidth","minHeight","maxWidth","maxHeight"].map(B=>ce(()=>{const V=parseFloat(i[B]);return isNaN(V)?1/0:V})),I=ce(()=>{if(Array.isArray(i.offset))return i.offset;if(typeof i.offset=="string"){const B=i.offset.split(" ").map(parseFloat);return B.length<2&&B.push(0),B}return typeof i.offset=="number"?[i.offset,0]:[0,0]});let z=!1;const O=new ResizeObserver(()=>{z&&D()});en([e.target,e.contentEl],(B,V)=>{let[Z,oe]=B,[pe,Se]=V;pe&&!Array.isArray(pe)&&O.unobserve(pe),Z&&!Array.isArray(Z)&&O.observe(Z),Se&&O.unobserve(Se),oe&&O.observe(oe)},{immediate:!0}),kr(()=>{O.disconnect()});function D(){if(z=!1,requestAnimationFrame(()=>z=!0),!e.target.value||!e.contentEl.value)return;const B=Ow(e.target.value),V=MD(e.contentEl.value,e.isRtl.value),Z=Zp(e.contentEl.value),oe=12;Z.length||(Z.push(document.documentElement),e.contentEl.value.style.top&&e.contentEl.value.style.left||(V.x-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-x")||0),V.y-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-y")||0)));const pe=Z.reduce((Ee,xe)=>{const Oe=xe.getBoundingClientRect(),We=new ql({x:xe===document.documentElement?0:Oe.x,y:xe===document.documentElement?0:Oe.y,width:xe.clientWidth,height:xe.clientHeight});return Ee?new ql({x:Math.max(Ee.left,We.left),y:Math.max(Ee.top,We.top),width:Math.min(Ee.right,We.right)-Math.max(Ee.left,We.left),height:Math.min(Ee.bottom,We.bottom)-Math.max(Ee.top,We.top)}):We},void 0);pe.x+=oe,pe.y+=oe,pe.width-=oe*2,pe.height-=oe*2;let Se={anchor:f.value,origin:g.value};function me(Ee){const xe=new ql(V),Oe=Hx(Ee.anchor,B),We=Hx(Ee.origin,xe);let{x:dt,y:je}=TD(Oe,We);switch(Ee.anchor.side){case"top":je-=I.value[0];break;case"bottom":je+=I.value[0];break;case"left":dt-=I.value[0];break;case"right":dt+=I.value[0];break}switch(Ee.anchor.align){case"top":je-=I.value[1];break;case"bottom":je+=I.value[1];break;case"left":dt-=I.value[1];break;case"right":dt+=I.value[1];break}return xe.x+=dt,xe.y+=je,xe.width=Math.min(xe.width,T.value),xe.height=Math.min(xe.height,k.value),{overflows:Zb(xe,pe),x:dt,y:je}}let be=0,he=0;const Ce={x:0,y:0},ye={x:!1,y:!1};let Me=-1;for(;!(Me++>10);){const{x:Ee,y:xe,overflows:Oe}=me(Se);be+=Ee,he+=xe,V.x+=Ee,V.y+=xe;{const We=Hb(Se.anchor),dt=Oe.x.before||Oe.x.after,je=Oe.y.before||Oe.y.after;let tt=!1;if(["x","y"].forEach(Et=>{if(Et==="x"&&dt&&!ye.x||Et==="y"&&je&&!ye.y){const _t={anchor:{...Se.anchor},origin:{...Se.origin}},Qe=Et==="x"?We==="y"?c_:l_:We==="y"?l_:c_;_t.anchor=Qe(_t.anchor),_t.origin=Qe(_t.origin);const{overflows:ct}=me(_t);(ct[Et].before<=Oe[Et].before&&ct[Et].after<=Oe[Et].after||ct[Et].before+ct[Et].after<(Oe[Et].before+Oe[Et].after)/2)&&(Se=_t,tt=ye[Et]=!0)}}),tt)continue}Oe.x.before&&(be+=Oe.x.before,V.x+=Oe.x.before),Oe.x.after&&(be-=Oe.x.after,V.x-=Oe.x.after),Oe.y.before&&(he+=Oe.y.before,V.y+=Oe.y.before),Oe.y.after&&(he-=Oe.y.after,V.y-=Oe.y.after);{const We=Zb(V,pe);Ce.x=pe.width-We.x.before-We.x.after,Ce.y=pe.height-We.y.before-We.y.after,be+=We.x.before,V.x+=We.x.before,he+=We.y.before,V.y+=We.y.before}break}const ke=Hb(Se.anchor);return Object.assign(l.value,{"--v-overlay-anchor-origin":`${Se.anchor.side} ${Se.anchor.align}`,transformOrigin:`${Se.origin.side} ${Se.origin.align}`,top:mn(y_(he)),left:e.isRtl.value?void 0:mn(y_(be)),right:e.isRtl.value?mn(y_(-be)):void 0,minWidth:mn(ke==="y"?Math.min(m.value,B.width):m.value),maxWidth:mn(Zx(Cs(Ce.x,m.value===1/0?0:m.value,T.value))),maxHeight:mn(Zx(Cs(Ce.y,o.value===1/0?0:o.value,k.value)))}),{available:Ce,contentBox:V}}return en(()=>[f.value,g.value,i.offset,i.minWidth,i.minHeight,i.maxWidth,i.maxHeight],()=>D()),Fi(()=>{const B=D();if(!B)return;const{available:V,contentBox:Z}=B;Z.height>V.y&&requestAnimationFrame(()=>{D(),requestAnimationFrame(()=>{D()})})}),{updateLocation:D}}function y_(e){return Math.round(e*devicePixelRatio)/devicePixelRatio}function Zx(e){return Math.ceil(e*devicePixelRatio)/devicePixelRatio}let iy=!0;const em=[];function AD(e){!iy||em.length?(em.push(e),ry()):(iy=!1,e(),ry())}let qx=-1;function ry(){cancelAnimationFrame(qx),qx=requestAnimationFrame(()=>{const e=em.shift();e&&e(),em.length?ry():iy=!0})}const Ep={none:null,close:zD,block:LD,reposition:BD},RD=Ct({scrollStrategy:{type:[String,Function],default:"block",validator:e=>typeof e=="function"||e in Ep}},"VOverlay-scroll-strategies");function DD(e,i){if(!Wn)return;let l;Sa(async()=>{l==null||l.stop(),i.isActive.value&&e.scrollStrategy&&(l=Sh(),await new Promise(u=>setTimeout(u)),l.active&&l.run(()=>{var u;typeof e.scrollStrategy=="function"?e.scrollStrategy(i,e,l):(u=Ep[e.scrollStrategy])==null||u.call(Ep,i,e,l)}))}),kr(()=>{l==null||l.stop()})}function zD(e){function i(l){e.isActive.value=!1}IC(e.targetEl.value??e.contentEl.value,i)}function LD(e,i){var m;const l=(m=e.root.value)==null?void 0:m.offsetParent,u=[...new Set([...Zp(e.targetEl.value,i.contained?l:void 0),...Zp(e.contentEl.value,i.contained?l:void 0)])].filter(o=>!o.classList.contains("v-overlay-scroll-blocked")),f=window.innerWidth-document.documentElement.offsetWidth,g=(o=>By(o)&&o)(l||document.documentElement);g&&e.root.value.classList.add("v-overlay--scroll-blocked"),u.forEach((o,T)=>{o.style.setProperty("--v-body-scroll-x",mn(-o.scrollLeft)),o.style.setProperty("--v-body-scroll-y",mn(-o.scrollTop)),o!==document.documentElement&&o.style.setProperty("--v-scrollbar-offset",mn(f)),o.classList.add("v-overlay-scroll-blocked")}),kr(()=>{u.forEach((o,T)=>{const k=parseFloat(o.style.getPropertyValue("--v-body-scroll-x")),I=parseFloat(o.style.getPropertyValue("--v-body-scroll-y")),z=o.style.scrollBehavior;o.style.scrollBehavior="auto",o.style.removeProperty("--v-body-scroll-x"),o.style.removeProperty("--v-body-scroll-y"),o.style.removeProperty("--v-scrollbar-offset"),o.classList.remove("v-overlay-scroll-blocked"),o.scrollLeft=-k,o.scrollTop=-I,o.style.scrollBehavior=z}),g&&e.root.value.classList.remove("v-overlay--scroll-blocked")})}function BD(e,i,l){let u=!1,f=-1,g=-1;function m(o){AD(()=>{var I,z;const T=performance.now();(z=(I=e.updateLocation).value)==null||z.call(I,o),u=(performance.now()-T)/(1e3/60)>2})}g=(typeof requestIdleCallback>"u"?o=>o():requestIdleCallback)(()=>{l.run(()=>{IC(e.targetEl.value??e.contentEl.value,o=>{u?(cancelAnimationFrame(f),f=requestAnimationFrame(()=>{f=requestAnimationFrame(()=>{m(o)})})):m(o)})})}),kr(()=>{typeof cancelIdleCallback<"u"&&cancelIdleCallback(g),cancelAnimationFrame(f)})}function IC(e,i){const l=[document,...Zp(e)];l.forEach(u=>{u.addEventListener("scroll",i,{passive:!0})}),kr(()=>{l.forEach(u=>{u.removeEventListener("scroll",i)})})}const ay=Symbol.for("vuetify:v-menu"),FD=Ct({target:[String,Object],activator:[String,Object],activatorProps:{type:Object,default:()=>({})},openOnClick:{type:Boolean,default:void 0},openOnHover:Boolean,openOnFocus:{type:Boolean,default:void 0},closeOnContentClick:Boolean,...VS()},"VOverlay-activator");function OD(e,i){let{isActive:l,isTop:u,contentEl:f}=i;const g=Gi("useActivator"),m=Ke();let o=!1,T=!1,k=!0;const I=ce(()=>e.openOnFocus||e.openOnFocus==null&&e.openOnHover),z=ce(()=>e.openOnClick||e.openOnClick==null&&!e.openOnHover&&!I.value),{runOpenDelay:O,runCloseDelay:D}=NS(e,ye=>{ye===(e.openOnHover&&o||I.value&&T)&&!(e.openOnHover&&l.value&&!u.value)&&(l.value!==ye&&(k=!0),l.value=ye)}),B=Ke(),V={onClick:ye=>{ye.stopPropagation(),m.value=ye.currentTarget||ye.target,l.value||(B.value=[ye.clientX,ye.clientY]),l.value=!l.value},onMouseenter:ye=>{var Me;(Me=ye.sourceCapabilities)!=null&&Me.firesTouchEvents||(o=!0,m.value=ye.currentTarget||ye.target,O())},onMouseleave:ye=>{o=!1,D()},onFocus:ye=>{Gp(ye.target,":focus-visible")!==!1&&(T=!0,ye.stopPropagation(),m.value=ye.currentTarget||ye.target,O())},onBlur:ye=>{T=!1,ye.stopPropagation(),D()}},Z=ce(()=>{const ye={};return z.value&&(ye.onClick=V.onClick),e.openOnHover&&(ye.onMouseenter=V.onMouseenter,ye.onMouseleave=V.onMouseleave),I.value&&(ye.onFocus=V.onFocus,ye.onBlur=V.onBlur),ye}),oe=ce(()=>{const ye={};if(e.openOnHover&&(ye.onMouseenter=()=>{o=!0,O()},ye.onMouseleave=()=>{o=!1,D()}),I.value&&(ye.onFocusin=()=>{T=!0,O()},ye.onFocusout=()=>{T=!1,D()}),e.closeOnContentClick){const Me=ri(ay,null);ye.onClick=()=>{l.value=!1,Me==null||Me.closeParents()}}return ye}),pe=ce(()=>{const ye={};return e.openOnHover&&(ye.onMouseenter=()=>{k&&(o=!0,k=!1,O())},ye.onMouseleave=()=>{o=!1,D()}),ye});en(u,ye=>{var Me;ye&&(e.openOnHover&&!o&&(!I.value||!T)||I.value&&!T&&(!e.openOnHover||!o))&&!((Me=f.value)!=null&&Me.contains(document.activeElement))&&(l.value=!1)}),en(l,ye=>{ye||setTimeout(()=>{B.value=void 0})},{flush:"post"});const Se=N_();Sa(()=>{Se.value&&Fi(()=>{m.value=Se.el})});const me=N_(),be=ce(()=>e.target==="cursor"&&B.value?B.value:me.value?me.el:MC(e.target,g)||m.value),he=ce(()=>Array.isArray(be.value)?void 0:be.value);let Ce;return en(()=>!!e.activator,ye=>{ye&&Wn?(Ce=Sh(),Ce.run(()=>{VD(e,g,{activatorEl:m,activatorEvents:Z})})):Ce&&Ce.stop()},{flush:"post",immediate:!0}),kr(()=>{Ce==null||Ce.stop()}),{activatorEl:m,activatorRef:Se,target:be,targetEl:he,targetRef:me,activatorEvents:Z,contentEvents:oe,scrimEvents:pe}}function VD(e,i,l){let{activatorEl:u,activatorEvents:f}=l;en(()=>e.activator,(T,k)=>{if(k&&T!==k){const I=o(k);I&&m(I)}T&&Fi(()=>g())},{immediate:!0}),en(()=>e.activatorProps,()=>{g()}),kr(()=>{m()});function g(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:o(),k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;T&&bI(T,an(f.value,k))}function m(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:o(),k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;T&&xI(T,an(f.value,k))}function o(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.activator;const k=MC(T,i);return u.value=(k==null?void 0:k.nodeType)===Node.ELEMENT_NODE?k:void 0,u.value}}function MC(e,i){var u,f;if(!e)return;let l;if(e==="parent"){let g=(f=(u=i==null?void 0:i.proxy)==null?void 0:u.$el)==null?void 0:f.parentNode;for(;g!=null&&g.hasAttribute("data-no-activator");)g=g.parentNode;l=g}else typeof e=="string"?l=document.querySelector(e):"$el"in e?l=e.$el:l=e;return l}function ND(){if(!Wn)return ln(!1);const{ssr:e}=wm();if(e){const i=ln(!1);return Qn(()=>{i.value=!0}),i}else return ln(!0)}const EC=Ct({eager:Boolean},"lazy");function AC(e,i){const l=ln(!1),u=ce(()=>l.value||e.eager||i.value);en(i,()=>l.value=!0);function f(){e.eager||(l.value=!1)}return{isBooted:l,hasContent:u,onAfterLeave:f}}const Wx=Symbol.for("vuetify:stack"),Wd=br([]);function $D(e,i,l){const u=Gi("useStack"),f=!l,g=ri(Wx,void 0),m=br({activeChildren:new Set});Mr(Wx,m);const o=ln(+i.value);Oa(e,()=>{var z;const I=(z=Wd.at(-1))==null?void 0:z[1];o.value=I?I+10:+i.value,f&&Wd.push([u.uid,o.value]),g==null||g.activeChildren.add(u.uid),kr(()=>{if(f){const O=fn(Wd).findIndex(D=>D[0]===u.uid);Wd.splice(O,1)}g==null||g.activeChildren.delete(u.uid)})});const T=ln(!0);f&&Sa(()=>{var z;const I=((z=Wd.at(-1))==null?void 0:z[0])===u.uid;setTimeout(()=>T.value=I)});const k=ce(()=>!m.activeChildren.size);return{globalTop:Ch(T),localTop:k,stackStyles:ce(()=>({zIndex:o.value}))}}function jD(e){return{teleportTarget:ce(()=>{const l=e();if(l===!0||!Wn)return;const u=l===!1?document.body:typeof l=="string"?document.querySelector(l):l;if(u==null)return;let f=[...u.children].find(g=>g.matches(".v-overlay-container"));return f||(f=document.createElement("div"),f.className="v-overlay-container",u.appendChild(f)),f})}}function UD(){return!0}function RC(e,i,l){if(!e||DC(e,l)===!1)return!1;const u=Hw(i);if(typeof ShadowRoot<"u"&&u instanceof ShadowRoot&&u.host===e.target)return!1;const f=(typeof l.value=="object"&&l.value.include||(()=>[]))();return f.push(i),!f.some(g=>g==null?void 0:g.contains(e.target))}function DC(e,i){return(typeof i.value=="object"&&i.value.closeConditional||UD)(e)}function GD(e,i,l){const u=typeof l.value=="function"?l.value:l.value.handler;e.shadowTarget=e.target,i._clickOutside.lastMousedownWasOutside&&RC(e,i,l)&&setTimeout(()=>{DC(e,l)&&u&&u(e)},0)}function Xx(e,i){const l=Hw(e);i(document),typeof ShadowRoot<"u"&&l instanceof ShadowRoot&&i(l)}const HD={mounted(e,i){const l=f=>GD(f,e,i),u=f=>{e._clickOutside.lastMousedownWasOutside=RC(f,e,i)};Xx(e,f=>{f.addEventListener("click",l,!0),f.addEventListener("mousedown",u,!0)}),e._clickOutside||(e._clickOutside={lastMousedownWasOutside:!1}),e._clickOutside[i.instance.$.uid]={onClick:l,onMousedown:u}},beforeUnmount(e,i){e._clickOutside&&(Xx(e,l=>{var g;if(!l||!((g=e._clickOutside)!=null&&g[i.instance.$.uid]))return;const{onClick:u,onMousedown:f}=e._clickOutside[i.instance.$.uid];l.removeEventListener("click",u,!0),l.removeEventListener("mousedown",f,!0)}),delete e._clickOutside[i.instance.$.uid])}};function ZD(e){const{modelValue:i,color:l,...u}=e;return E(Ts,{name:"fade-transition",appear:!0},{default:()=>[e.modelValue&&E("div",an({class:["v-overlay__scrim",e.color.backgroundColorClasses.value],style:e.color.backgroundColorStyles.value},u),null)]})}const Vh=Ct({absolute:Boolean,attach:[Boolean,String,Object],closeOnBack:{type:Boolean,default:!0},contained:Boolean,contentClass:null,contentProps:null,disabled:Boolean,opacity:[Number,String],noClickAnimation:Boolean,modelValue:Boolean,persistent:Boolean,scrim:{type:[Boolean,String],default:!0},zIndex:{type:[Number,String],default:2e3},...FD(),...xn(),...Va(),...EC(),...PD(),...RD(),...Di(),...Rh()},"VOverlay"),Wo=Wt()({name:"VOverlay",directives:{ClickOutside:HD},inheritAttrs:!1,props:{_disableGlobalStack:Boolean,...Vh()},emits:{"click:outside":e=>!0,"update:modelValue":e=>!0,afterEnter:()=>!0,afterLeave:()=>!0},setup(e,i){let{slots:l,attrs:u,emit:f}=i;const g=Gi("VOverlay"),m=Ke(),o=Ke(),T=Ke(),k=ai(e,"modelValue"),I=ce({get:()=>k.value,set:qt=>{qt&&e.disabled||(k.value=qt)}}),{themeClasses:z}=Hi(e),{rtlClasses:O,isRtl:D}=ja(),{hasContent:B,onAfterLeave:V}=AC(e,I),Z=Fa(ce(()=>typeof e.scrim=="string"?e.scrim:null)),{globalTop:oe,localTop:pe,stackStyles:Se}=$D(I,rn(e,"zIndex"),e._disableGlobalStack),{activatorEl:me,activatorRef:be,target:he,targetEl:Ce,targetRef:ye,activatorEvents:Me,contentEvents:ke,scrimEvents:Ee}=OD(e,{isActive:I,isTop:pe,contentEl:T}),{teleportTarget:xe}=jD(()=>{var bn,jn,Nn;const qt=e.attach||e.contained;if(qt)return qt;const _n=((bn=me==null?void 0:me.value)==null?void 0:bn.getRootNode())||((Nn=(jn=g.proxy)==null?void 0:jn.$el)==null?void 0:Nn.getRootNode());return _n instanceof ShadowRoot?_n:!1}),{dimensionStyles:Oe}=Na(e),We=ND(),{scopeId:dt}=nc();en(()=>e.disabled,qt=>{qt&&(I.value=!1)});const{contentStyles:je,updateLocation:tt}=kD(e,{isRtl:D,contentEl:T,target:he,isActive:I});DD(e,{root:m,contentEl:T,targetEl:Ce,isActive:I,updateLocation:tt});function Et(qt){f("click:outside",qt),e.persistent?Jt():I.value=!1}function _t(qt){return I.value&&oe.value&&(!e.scrim||qt.target===o.value||qt instanceof MouseEvent&&qt.shadowTarget===o.value)}Wn&&en(I,qt=>{qt?window.addEventListener("keydown",Qe):window.removeEventListener("keydown",Qe)},{immediate:!0}),Ir(()=>{Wn&&window.removeEventListener("keydown",Qe)});function Qe(qt){var _n,bn;qt.key==="Escape"&&oe.value&&(e.persistent?Jt():(I.value=!1,(_n=T.value)!=null&&_n.contains(document.activeElement)&&((bn=me.value)==null||bn.focus())))}const ct=hS();Oa(()=>e.closeOnBack,()=>{VM(ct,qt=>{oe.value&&I.value?(qt(!1),e.persistent?Jt():I.value=!1):qt()})});const zt=Ke();en(()=>I.value&&(e.absolute||e.contained)&&xe.value==null,qt=>{if(qt){const _n=Zw(m.value);_n&&_n!==document.scrollingElement&&(zt.value=_n.scrollTop)}});function Jt(){e.noClickAnimation||T.value&&jl(T.value,[{transformOrigin:"center"},{transform:"scale(1.03)"},{transformOrigin:"center"}],{duration:150,easing:mh})}function Lt(){f("afterEnter")}function Yt(){V(),f("afterLeave")}return hn(()=>{var qt;return E(un,null,[(qt=l.activator)==null?void 0:qt.call(l,{isActive:I.value,targetRef:ye,props:an({ref:be},Me.value,e.activatorProps)}),We.value&&B.value&&E(TP,{disabled:!xe.value,to:xe.value},{default:()=>[E("div",an({class:["v-overlay",{"v-overlay--absolute":e.absolute||e.contained,"v-overlay--active":I.value,"v-overlay--contained":e.contained},z.value,O.value,e.class],style:[Se.value,{"--v-overlay-opacity":e.opacity,top:mn(zt.value)},e.style],ref:m},dt,u),[E(ZD,an({color:Z,modelValue:I.value&&!!e.scrim,ref:o},Ee.value),null),E(to,{appear:!0,persisted:!0,transition:e.transition,target:he.value,onAfterEnter:Lt,onAfterLeave:Yt},{default:()=>{var _n;return[Pr(E("div",an({ref:T,class:["v-overlay__content",e.contentClass],style:[Oe.value,je.value]},ke.value,e.contentProps),[(_n=l.default)==null?void 0:_n.call(l,{isActive:I})]),[[Ql,I.value],[oo("click-outside"),{handler:Et,closeConditional:_t,include:()=>[me.value]}]])]}})])]})])}),{activatorEl:me,scrimEl:o,target:he,animateClick:Jt,contentEl:T,globalTop:oe,localTop:pe,updateLocation:tt}}}),v_=Symbol("Forwarded refs");function b_(e,i){let l=e;for(;l;){const u=Reflect.getOwnPropertyDescriptor(l,i);if(u)return u;l=Object.getPrototypeOf(l)}}function fo(e){for(var i=arguments.length,l=new Array(i>1?i-1:0),u=1;u<i;u++)l[u-1]=arguments[u];return e[v_]=l,new Proxy(e,{get(f,g){if(Reflect.has(f,g))return Reflect.get(f,g);if(!(typeof g=="symbol"||g.startsWith("$")||g.startsWith("__"))){for(const m of l)if(m.value&&Reflect.has(m.value,g)){const o=Reflect.get(m.value,g);return typeof o=="function"?o.bind(m.value):o}}},has(f,g){if(Reflect.has(f,g))return!0;if(typeof g=="symbol"||g.startsWith("$")||g.startsWith("__"))return!1;for(const m of l)if(m.value&&Reflect.has(m.value,g))return!0;return!1},set(f,g,m){if(Reflect.has(f,g))return Reflect.set(f,g,m);if(typeof g=="symbol"||g.startsWith("$")||g.startsWith("__"))return!1;for(const o of l)if(o.value&&Reflect.has(o.value,g))return Reflect.set(o.value,g,m);return!1},getOwnPropertyDescriptor(f,g){var o;const m=Reflect.getOwnPropertyDescriptor(f,g);if(m)return m;if(!(typeof g=="symbol"||g.startsWith("$")||g.startsWith("__"))){for(const T of l){if(!T.value)continue;const k=b_(T.value,g)??("_"in T.value?b_((o=T.value._)==null?void 0:o.setupState,g):void 0);if(k)return k}for(const T of l){const k=T.value&&T.value[v_];if(!k)continue;const I=k.slice();for(;I.length;){const z=I.shift(),O=b_(z.value,g);if(O)return O;const D=z.value&&z.value[v_];D&&I.push(...D)}}}}})}const qD=Ct({id:String,text:String,...Ps(Vh({closeOnBack:!1,location:"end",locationStrategy:"connected",eager:!0,minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent"])},"VTooltip"),tm=Wt()({name:"VTooltip",props:qD(),emits:{"update:modelValue":e=>!0},setup(e,i){let{slots:l}=i;const u=ai(e,"modelValue"),{scopeId:f}=nc(),g=Ca(),m=ce(()=>e.id||`v-tooltip-${g}`),o=Ke(),T=ce(()=>e.location.split(" ").length>1?e.location:e.location+" center"),k=ce(()=>e.origin==="auto"||e.origin==="overlap"||e.origin.split(" ").length>1||e.location.split(" ").length>1?e.origin:e.origin+" center"),I=ce(()=>e.transition?e.transition:u.value?"scale-transition":"fade-transition"),z=ce(()=>an({"aria-describedby":m.value},e.activatorProps));return hn(()=>{const O=Wo.filterProps(e);return E(Wo,an({ref:o,class:["v-tooltip",e.class],style:e.style,id:m.value},O,{modelValue:u.value,"onUpdate:modelValue":D=>u.value=D,transition:I.value,absolute:!0,location:T.value,origin:k.value,persistent:!0,role:"tooltip",activatorProps:z.value,_disableGlobalStack:!0},f),{activator:l.activator,default:function(){var Z;for(var D=arguments.length,B=new Array(D),V=0;V<D;V++)B[V]=arguments[V];return((Z=l.default)==null?void 0:Z.call(l,...B))??e.text}})}),fo({},o)}}),WD=Vn({__name:"AvailableRacesCard",props:{race:{}},setup(e){const i=e,l=ei(),u=async()=>{(await Ht.post("UiJoinRace",JSON.stringify(i.race.RaceId))).data&&ca()},f=ce(()=>i.race.ParticipationCurrency==="racingcrypto"?i.race.ParticipationAmount+" "+l.baseData.data.payments.cryptoType:"$"+i.race.ParticipationAmount),g=ce(()=>{let Z="Sprint | ";return i.race.laps==-1?Z="Elimination | ":i.race.laps>0&&(Z=i.race.Laps+" "+ne("laps")+" | "),Z}),m=ce(()=>{let Z;return i.race.BuyIn>0&&(l.baseData.data.payments.racing==="racingcrypto"?Z=i.race.BuyIn+" "+l.baseData.data.payments.cryptoType+" "+ne("buy_in"):Z="$"+i.race.BuyIn+" "+ne("buy_in")),Z}),o=ce(()=>{let Z;return i.race.BuyIn>0&&(Z=ne("pot")+": "+i.race.racers*i.race.BuyIn),Z}),T=ce(()=>{let Z="";return i.race.Ghosting&&(Z=ne("active"),i.race.GhostingTime&&(Z=i.race.GhostingTime+"s)")),Z}),k=async()=>{(await Ht.post("UiShowTrack",JSON.stringify(i.race.TrackId))).data&&ca()},I=Ke(i.race.ExpirationTime),z=Ke(I.value?I.value-Math.floor(Date.now()/1e3):0),O=ce(()=>Math.floor(z.value/60).toString().padStart(2,"0")),D=ce(()=>(z.value%60).toString().padStart(2,"0")),B=ce(()=>z.value<=0),V=()=>{if(I.value){const Z=setInterval(()=>{z.value-=1,z.value<=0&&(z.value=0,clearInterval(Z))},1e3);kh(()=>{V(),clearInterval(Z)})}};return Qn(()=>{V()}),(Z,oe)=>!B.value&&!i.race.RaceData.Started?(Fe(),ft(On,{key:0,rounded:"xl",border:""},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(i.race.TrackData.RaceName),1)]),_:1}),E(qn,{class:"inline standardGap"},{default:K(()=>{var pe;return[(pe=i.race)!=null&&pe.Ranked?(Fe(),ft(on,{key:0,"prepend-icon":"mdi-podium-gold",color:"orange"},{default:K(()=>[Ne(ee(U(ne)("ranked")),1)]),_:1})):Mt("",!0),Z.race.ParticipationAmount?(Fe(),ft(on,{key:1,"prepend-icon":"mdi-hand-coin",color:"green"},{default:K(()=>[Ne(ee(f.value)+" ",1),E(tm,{location:"top",activator:"parent",text:U(ne)("participation_info")},null,8,["text"])]),_:1})):Mt("",!0),E(on,{"prepend-icon":"mdi-go-kart-track"},{default:K(()=>[Ne(ee(`${g.value} ${i.race.TrackData.Distance} m`),1)]),_:1}),m.value?(Fe(),ft(on,{key:2,"prepend-icon":"mdi-cash"},{default:K(()=>[Ne(ee(m.value),1)]),_:1})):Mt("",!0),o.value&&i.race.racers>1?(Fe(),ft(on,{key:3,"prepend-icon":"mdi-cash-multiple"},{default:K(()=>[Ne(ee(o.value),1)]),_:1})):Mt("",!0),E(on,{"prepend-icon":"mdi-account-group"},{default:K(()=>[Ne(ee(`${i.race.racers} ${U(ne)("racers")}`),1)]),_:1}),i.race.MaxClass?(Fe(),ft(on,{key:4,"prepend-icon":"mdi-car-info"},{default:K(()=>[Ne(ee(`${U(ne)("class")}: ${i.race.MaxClass}`),1)]),_:1})):Mt("",!0),i.race.Ghosting?(Fe(),ft(on,{key:5,"prepend-icon":"mdi-ghost"},{default:K(()=>[Ne(ee(T.value),1)]),_:1})):Mt("",!0),i.race.FirstPerson?(Fe(),ft(on,{key:6,"prepend-icon":"mdi-eye-lock"},{default:K(()=>[Ne(ee(U(ne)("first_person")),1)]),_:1})):Mt("",!0),E(on,{"prepend-icon":"mdi-robot-dead"},{default:K(()=>[Ne(ee(`${i.race.Automated?U(ne)("starts_in"):`${U(ne)("expires")}:`} ${O.value}:${D.value}`),1)]),_:1}),i.race.Reversed?(Fe(),ft(on,{key:7,"prepend-icon":"mdi-backup-restore"},{default:K(()=>[Ne(ee(U(ne)("reversed")),1)]),_:1})):Mt("",!0),E(on,{"prepend-icon":"mdi-account-star"},{default:K(()=>[Ne(ee(U(ne)("hosted_by"))+" "+ee(i.race.SetupRacerName),1)]),_:1})]}),_:1}),i.race.disabled?Mt("",!0):(Fe(),ft(Zn,{key:0},{default:K(()=>[E(Qi),E(Nt,{rounded:"xl",variant:"text",onClick:oe[0]||(oe[0]=pe=>k())},{default:K(()=>[Ne(ee(U(ne)("show_track")),1)]),_:1}),E(Nt,{rounded:"xl",variant:"flat",color:"primary",onClick:oe[1]||(oe[1]=pe=>u())},{default:K(()=>[Ne(ee(U(ne)("join_race")),1)]),_:1})]),_:1}))]),_:1})):Mt("",!0)}}),XD={class:"inline standardGap"},KD=Vn({__name:"AvailableTracksCard",props:{track:{}},emits:["select"],setup(e,{emit:i}){const l=e,u=i,f=async()=>{(await Ht.post("UiShowTrack",JSON.stringify(l.track.TrackId))).data&&ca()},g=async()=>{(await Ht.post("UiQuickHost",JSON.stringify(l.track))).data&&ca()},m=async()=>{u("select",l.track)};return(o,T)=>(Fe(),ft(On,{rounded:"xl",class:"available-card",border:""},{default:K(()=>{var k;return[E($n,null,{default:K(()=>[Ne(ee(o.track.RaceName),1)]),_:1}),(k=o.track.Metadata)!=null&&k.description?(Fe(),ft(rv,{key:0,class:"subtitle-text"},{default:K(()=>[Ne(ee(o.track.Metadata.description),1)]),_:1})):Mt("",!0),E(qn,null,{default:K(()=>{var I;return[Xe("div",XD,[o.track.Curated?(Fe(),ft(on,{key:0,color:"green","prepend-icon":"mdi-star"},{default:K(()=>[Ne(ee(U(ne)("curated")),1)]),_:1})):Mt("",!0),E(on,{color:"primary","prepend-icon":"mdi-account-star"},{default:K(()=>[Ne(ee(U(ne)("creator"))+" : "+ee(o.track.CreatorName),1)]),_:1}),E(on,{color:"primary"},{default:K(()=>[Ne(ee(U(ne)("length"))+" : "+ee(o.track.Distance),1)]),_:1}),(I=o.track.Metadata)!=null&&I.raceType&&o.track.Metadata.raceType!=="any_type"?(Fe(),ft(on,{key:1,color:"primary","prepend-icon":"mdi-go-kart-track"},{default:K(()=>[Ne(ee(U(ne)(o.track.Metadata.raceType)),1)]),_:1})):Mt("",!0)])]}),_:1}),E(Zn,null,{default:K(()=>[E(Qi),E(Nt,{rounded:"xl",variant:"text",onClick:T[0]||(T[0]=I=>f())},{default:K(()=>[Ne(ee(U(ne)("show_track")),1)]),_:1}),E(Nt,{rounded:"xl",variant:"outlined",color:"primary",onClick:T[1]||(T[1]=I=>m())},{default:K(()=>[Ne(ee(U(ne)("setup_race")),1)]),_:1}),E(Nt,{rounded:"xl",variant:"flat",color:"primary",onClick:T[2]||(T[2]=I=>g())},{default:K(()=>[Ne(ee(U(ne)("quick_host")),1)]),_:1})]),_:1})]}),_:1}))}});const YD=Pi(KD,[["__scopeId","data-v-cd39f431"]]),JD=Vn({__name:"CurrentRaceCard",props:{race:{}},emits:["start","leave","cancel"],setup(e,{emit:i}){const l=ei(),u=e,f=i,g=ce(()=>{let I=ne("sprint");return u.race.laps==-1?I=ne("elimination")+" ":u.race.laps>0&&(I=u.race.laps+" "+ne("laps")),I}),m=async()=>{f("start",u.race)},o=async()=>{f("leave",u.race)},T=Ke(!1),k=async()=>{T.value=!0;const I=await Ht.post("UiCancelRace",JSON.stringify(u.race.raceId));I&&I.data&&f("cancel"),T.value=!1};return(I,z)=>(Fe(),ft(On,{border:"",rounded:"xl"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(I.race.trackName),1)]),_:1}),E(qn,{class:"inline standardGap"},{default:K(()=>[I.race.ranked?(Fe(),ft(on,{key:0,"prepend-icon":"mdi-podium-gold",color:"orange",text:U(ne)("ranked")},null,8,["text"])):Mt("",!0),E(on,{"prepend-icon":"mdi-go-kart-track"},{default:K(()=>[Ne(ee(g.value),1)]),_:1}),E(on,{"prepend-icon":"mdi-account-group"},{default:K(()=>[Ne(ee(U(ne)("racers"))+" "+ee(I.race.racers),1)]),_:1}),E(on,{"prepend-icon":"mdi-ghost"},{default:K(()=>[Ne(ee(U(ne)("ghosting"))+" : "+ee(I.race.ghosting?U(ne)("on"):U(ne)("off")),1)]),_:1}),E(on,{"prepend-icon":"mdi-car-info"},{default:K(()=>[Ne(ee(U(ne)("max_class"))+" : "+ee(I.race.class),1)]),_:1}),E(on,{"prepend-icon":"mdi-account-star"},{default:K(()=>[Ne(ee(U(ne)("hosted_by"))+" "+ee(I.race.hostName),1)]),_:1}),I.race.reversed?(Fe(),ft(on,{key:1,"prepend-icon":"mdi-backup-restore"},{default:K(()=>[Ne(ee(U(ne)("reversed")),1)]),_:1})):Mt("",!0)]),_:1}),E(Zn,null,{default:K(()=>[E(Qi),I.race.canStart?(Fe(),ft(Nt,{key:0,rounded:"xl",variant:"flat",loading:T.value,color:"red",onClick:z[0]||(z[0]=O=>k())},{default:K(()=>[Ne(ee(U(ne)("cancel_race")),1)]),_:1},8,["loading"])):Mt("",!0),!I.race.canStart&&U(l).baseData.data.auth.cancelAll?(Fe(),ft(Nt,{key:1,rounded:"xl",variant:"flat",loading:T.value,color:"red",onClick:z[1]||(z[1]=O=>k())},{default:K(()=>[Ne(ee(U(ne)("cancel_race_forced")),1)]),_:1},8,["loading"])):Mt("",!0),E(Nt,{rounded:"xl",variant:"flat",color:"red",onClick:z[2]||(z[2]=O=>o())},{default:K(()=>[Ne(ee(U(ne)("leave_race")),1)]),_:1}),I.race.canStart?(Fe(),ft(Nt,{key:2,rounded:"xl",variant:"flat",color:"success",onClick:z[3]||(z[3]=O=>m())},{default:K(()=>[Ne(ee(U(ne)("start_race")),1)]),_:1})):Mt("",!0),!I.race.canStart&&U(l).baseData.data.auth.startAll?(Fe(),ft(Nt,{key:3,rounded:"xl",variant:"flat",color:"success",onClick:z[4]||(z[4]=O=>m())},{default:K(()=>[Ne(ee(U(ne)("start_race_forced")),1)]),_:1})):Mt("",!0)]),_:1})]),_:1}))}});const QD=Ct({fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,...Vh({origin:"center center",scrollStrategy:"block",transition:{component:Fy},zIndex:2400})},"VDialog"),ra=Wt()({name:"VDialog",props:QD(),emits:{"update:modelValue":e=>!0,afterEnter:()=>!0,afterLeave:()=>!0},setup(e,i){let{emit:l,slots:u}=i;const f=ai(e,"modelValue"),{scopeId:g}=nc(),m=Ke();function o(I){var D,B;const z=I.relatedTarget,O=I.target;if(z!==O&&((D=m.value)!=null&&D.contentEl)&&((B=m.value)!=null&&B.globalTop)&&![document,m.value.contentEl].includes(O)&&!m.value.contentEl.contains(O)){const V=fh(m.value.contentEl);if(!V.length)return;const Z=V[0],oe=V[V.length-1];z===Z?oe.focus():Z.focus()}}Ir(()=>{document.removeEventListener("focusin",o)}),Wn&&en(()=>f.value&&e.retainFocus,I=>{I?document.addEventListener("focusin",o):document.removeEventListener("focusin",o)},{immediate:!0});function T(){var I;l("afterEnter"),(I=m.value)!=null&&I.contentEl&&!m.value.contentEl.contains(document.activeElement)&&m.value.contentEl.focus({preventScroll:!0})}function k(){l("afterLeave")}return en(f,async I=>{var z;I||(await Fi(),(z=m.value.activatorEl)==null||z.focus({preventScroll:!0}))}),hn(()=>{const I=Wo.filterProps(e),z=an({"aria-haspopup":"dialog"},e.activatorProps),O=an({tabindex:-1},e.contentProps);return E(Wo,an({ref:m,class:["v-dialog",{"v-dialog--fullscreen":e.fullscreen,"v-dialog--scrollable":e.scrollable},e.class],style:e.style},I,{modelValue:f.value,"onUpdate:modelValue":D=>f.value=D,"aria-modal":"true",activatorProps:z,contentProps:O,height:e.fullscreen?void 0:e.height,width:e.fullscreen?void 0:e.width,maxHeight:e.fullscreen?void 0:e.maxHeight,maxWidth:e.fullscreen?void 0:e.maxWidth,role:"dialog",onAfterEnter:T,onAfterLeave:k},g),{activator:u.activator,default:function(){for(var D=arguments.length,B=new Array(D),V=0;V<D;V++)B[V]=arguments[V];return E(Bi,{root:"VDialog"},{default:()=>{var Z;return[(Z=u.default)==null?void 0:Z.call(u,...B)]}})}})}),fo({},m)}}),zC=Symbol.for("vuetify:form"),ez=Ct({disabled:Boolean,fastFail:Boolean,readonly:Boolean,modelValue:{type:Boolean,default:null},validateOn:{type:String,default:"input"}},"form");function tz(e){const i=ai(e,"modelValue"),l=ce(()=>e.disabled),u=ce(()=>e.readonly),f=ln(!1),g=Ke([]),m=Ke([]);async function o(){const I=[];let z=!0;m.value=[],f.value=!0;for(const O of g.value){const D=await O.validate();if(D.length>0&&(z=!1,I.push({id:O.id,errorMessages:D})),!z&&e.fastFail)break}return m.value=I,f.value=!1,{valid:z,errors:m.value}}function T(){g.value.forEach(I=>I.reset())}function k(){g.value.forEach(I=>I.resetValidation())}return en(g,()=>{let I=0,z=0;const O=[];for(const D of g.value)D.isValid===!1?(z++,O.push({id:D.id,errorMessages:D.errorMessages})):D.isValid===!0&&I++;m.value=O,i.value=z>0?!1:I===g.value.length?!0:null},{deep:!0,flush:"post"}),Mr(zC,{register:I=>{let{id:z,vm:O,validate:D,reset:B,resetValidation:V}=I;g.value.some(Z=>Z.id===z),g.value.push({id:z,validate:D,reset:B,resetValidation:V,vm:cm(O),isValid:null,errorMessages:[]})},unregister:I=>{g.value=g.value.filter(z=>z.id!==I)},update:(I,z,O)=>{const D=g.value.find(B=>B.id===I);D&&(D.isValid=z,D.errorMessages=O)},isDisabled:l,isReadonly:u,isValidating:f,isValid:i,items:g,validateOn:rn(e,"validateOn")}),{errors:m,isDisabled:l,isReadonly:u,isValidating:f,isValid:i,items:g,validate:o,reset:T,resetValidation:k}}function LC(e){const i=ri(zC,null);return{...i,isReadonly:ce(()=>!!((e==null?void 0:e.readonly)??(i==null?void 0:i.isReadonly.value))),isDisabled:ce(()=>!!((e==null?void 0:e.disabled)??(i==null?void 0:i.isDisabled.value)))}}const nz=Ct({...xn(),...ez()},"VForm"),ov=Wt()({name:"VForm",props:nz(),emits:{"update:modelValue":e=>!0,submit:e=>!0},setup(e,i){let{slots:l,emit:u}=i;const f=tz(e),g=Ke();function m(T){T.preventDefault(),f.reset()}function o(T){const k=T,I=f.validate();k.then=I.then.bind(I),k.catch=I.catch.bind(I),k.finally=I.finally.bind(I),u("submit",k),k.defaultPrevented||I.then(z=>{var D;let{valid:O}=z;O&&((D=g.value)==null||D.submit())}),k.preventDefault()}return hn(()=>{var T;return E("form",{ref:g,class:["v-form",e.class],style:e.style,novalidate:!0,onReset:m,onSubmit:o},[(T=l.default)==null?void 0:T.call(l,f)])}),fo(f,g)}});const iz=Ct({text:String,onClick:sa(),...xn(),...Di()},"VLabel"),BC=Wt()({name:"VLabel",props:iz(),setup(e,i){let{slots:l}=i;return hn(()=>{var u;return E("label",{class:["v-label",{"v-label--clickable":!!e.onClick},e.class],style:e.style,onClick:e.onClick},[e.text,(u=l.default)==null?void 0:u.call(l)])}),{}}});const FC=Symbol.for("vuetify:selection-control-group"),OC=Ct({color:String,disabled:{type:Boolean,default:null},defaultsTarget:String,error:Boolean,id:String,inline:Boolean,falseIcon:Gn,trueIcon:Gn,ripple:{type:[Boolean,Object],default:!0},multiple:{type:Boolean,default:null},name:String,readonly:{type:Boolean,default:null},modelValue:null,type:String,valueComparator:{type:Function,default:_u},...xn(),...Pa(),...Di()},"SelectionControlGroup"),rz=Ct({...OC({defaultsTarget:"VSelectionControl"})},"VSelectionControlGroup");Wt()({name:"VSelectionControlGroup",props:rz(),emits:{"update:modelValue":e=>!0},setup(e,i){let{slots:l}=i;const u=ai(e,"modelValue"),f=Ca(),g=ce(()=>e.id||`v-selection-control-group-${f}`),m=ce(()=>e.name||g.value),o=new Set;return Mr(FC,{modelValue:u,forceUpdate:()=>{o.forEach(T=>T())},onForceUpdate:T=>{o.add(T),kr(()=>{o.delete(T)})}}),Qo({[e.defaultsTarget]:{color:rn(e,"color"),disabled:rn(e,"disabled"),density:rn(e,"density"),error:rn(e,"error"),inline:rn(e,"inline"),modelValue:u,multiple:ce(()=>!!e.multiple||e.multiple==null&&Array.isArray(u.value)),name:m,falseIcon:rn(e,"falseIcon"),trueIcon:rn(e,"trueIcon"),readonly:rn(e,"readonly"),ripple:rn(e,"ripple"),type:rn(e,"type"),valueComparator:rn(e,"valueComparator")}}),hn(()=>{var T;return E("div",{class:["v-selection-control-group",{"v-selection-control-group--inline":e.inline},e.class],style:e.style,role:e.type==="radio"?"radiogroup":void 0},[(T=l.default)==null?void 0:T.call(l)])}),{}}});const lv=Ct({label:String,baseColor:String,trueValue:null,falseValue:null,value:null,...xn(),...OC()},"VSelectionControl");function az(e){const i=ri(FC,void 0),{densityClasses:l}=$a(e),u=ai(e,"modelValue"),f=ce(()=>e.trueValue!==void 0?e.trueValue:e.value!==void 0?e.value:!0),g=ce(()=>e.falseValue!==void 0?e.falseValue:!1),m=ce(()=>!!e.multiple||e.multiple==null&&Array.isArray(u.value)),o=ce({get(){const D=i?i.modelValue.value:u.value;return m.value?rs(D).some(B=>e.valueComparator(B,f.value)):e.valueComparator(D,f.value)},set(D){if(e.readonly)return;const B=D?f.value:g.value;let V=B;m.value&&(V=D?[...rs(u.value),B]:rs(u.value).filter(Z=>!e.valueComparator(Z,f.value))),i?i.modelValue.value=V:u.value=V}}),{textColorClasses:T,textColorStyles:k}=os(ce(()=>{if(!(e.error||e.disabled))return o.value?e.color:e.baseColor})),{backgroundColorClasses:I,backgroundColorStyles:z}=Fa(ce(()=>o.value&&!e.error&&!e.disabled?e.color:e.baseColor)),O=ce(()=>o.value?e.trueIcon:e.falseIcon);return{group:i,densityClasses:l,trueValue:f,falseValue:g,model:o,textColorClasses:T,textColorStyles:k,backgroundColorClasses:I,backgroundColorStyles:z,icon:O}}const nm=Wt()({name:"VSelectionControl",directives:{Ripple:zh},inheritAttrs:!1,props:lv(),emits:{"update:modelValue":e=>!0},setup(e,i){let{attrs:l,slots:u}=i;const{group:f,densityClasses:g,icon:m,model:o,textColorClasses:T,textColorStyles:k,backgroundColorClasses:I,backgroundColorStyles:z,trueValue:O}=az(e),D=Ca(),B=ln(!1),V=ln(!1),Z=Ke(),oe=ce(()=>e.id||`input-${D}`),pe=ce(()=>!e.disabled&&!e.readonly);f==null||f.onForceUpdate(()=>{Z.value&&(Z.value.checked=o.value)});function Se(Ce){pe.value&&(B.value=!0,Gp(Ce.target,":focus-visible")!==!1&&(V.value=!0))}function me(){B.value=!1,V.value=!1}function be(Ce){Ce.stopPropagation()}function he(Ce){if(!pe.value){Z.value&&(Z.value.checked=o.value);return}e.readonly&&f&&Fi(()=>f.forceUpdate()),o.value=Ce.target.checked}return hn(()=>{var Ee,xe;const Ce=u.label?u.label({label:e.label,props:{for:oe.value}}):e.label,[ye,Me]=ym(l),ke=E("input",an({ref:Z,checked:o.value,disabled:!!e.disabled,id:oe.value,onBlur:me,onFocus:Se,onInput:he,"aria-disabled":!!e.disabled,"aria-label":e.label,type:e.type,value:O.value,name:e.name,"aria-checked":e.type==="checkbox"?o.value:void 0},Me),null);return E("div",an({class:["v-selection-control",{"v-selection-control--dirty":o.value,"v-selection-control--disabled":e.disabled,"v-selection-control--error":e.error,"v-selection-control--focused":B.value,"v-selection-control--focus-visible":V.value,"v-selection-control--inline":e.inline},g.value,e.class]},ye,{style:e.style}),[E("div",{class:["v-selection-control__wrapper",T.value],style:k.value},[(Ee=u.default)==null?void 0:Ee.call(u,{backgroundColorClasses:I,backgroundColorStyles:z}),Pr(E("div",{class:["v-selection-control__input"]},[((xe=u.input)==null?void 0:xe.call(u,{model:o,textColorClasses:T,textColorStyles:k,backgroundColorClasses:I,backgroundColorStyles:z,inputNode:ke,icon:m.value,props:{onFocus:Se,onBlur:me,id:oe.value}}))??E(un,null,[m.value&&E(ui,{key:"icon",icon:m.value},null),ke])]),[[oo("ripple"),e.ripple&&[!e.disabled&&!e.readonly,null,["center","circle"]]]])]),Ce&&E(BC,{for:oe.value,onClick:be},{default:()=>[Ce]})])}),{isFocused:B,input:Z}}}),sz=Ct({indeterminate:Boolean,indeterminateIcon:{type:Gn,default:"$checkboxIndeterminate"},...lv({falseIcon:"$checkboxOff",trueIcon:"$checkboxOn"})},"VCheckboxBtn"),oz=Wt()({name:"VCheckboxBtn",props:sz(),emits:{"update:modelValue":e=>!0,"update:indeterminate":e=>!0},setup(e,i){let{slots:l}=i;const u=ai(e,"indeterminate"),f=ai(e,"modelValue");function g(T){u.value&&(u.value=!1)}const m=ce(()=>u.value?e.indeterminateIcon:e.falseIcon),o=ce(()=>u.value?e.indeterminateIcon:e.trueIcon);return hn(()=>{const T=Ps(nm.filterProps(e),["modelValue"]);return E(nm,an(T,{modelValue:f.value,"onUpdate:modelValue":[k=>f.value=k,g],class:["v-checkbox-btn",e.class],style:e.style,type:"checkbox",falseIcon:m.value,trueIcon:o.value,"aria-checked":u.value?"mixed":void 0}),l)}),{}}});function VC(e){const{t:i}=Dh();function l(u){let{name:f}=u;const g={prepend:"prependAction",prependInner:"prependAction",append:"appendAction",appendInner:"appendAction",clear:"clear"}[f],m=e[`onClick:${f}`],o=m&&g?i(`$vuetify.input.${g}`,e.label??""):void 0;return E(ui,{icon:e[`${f}Icon`],"aria-label":o,onClick:m},null)}return{InputIcon:l}}const lz=Ct({active:Boolean,color:String,messages:{type:[Array,String],default:()=>[]},...xn(),...Rh({transition:{component:Xw,leaveAbsolute:!0,group:!0}})},"VMessages"),cz=Wt()({name:"VMessages",props:lz(),setup(e,i){let{slots:l}=i;const u=ce(()=>rs(e.messages)),{textColorClasses:f,textColorStyles:g}=os(ce(()=>e.color));return hn(()=>E(to,{transition:e.transition,tag:"div",class:["v-messages",f.value,e.class],style:[g.value,e.style],role:"alert","aria-live":"polite"},{default:()=>[e.active&&u.value.map((m,o)=>E("div",{class:"v-messages__message",key:`${o}-${u.value}`},[l.message?l.message({message:m}):m]))]})),{}}}),NC=Ct({focused:Boolean,"onUpdate:focused":sa()},"focus");function Bm(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ks();const l=ai(e,"focused"),u=ce(()=>({[`${i}--focused`]:l.value}));function f(){l.value=!0}function g(){l.value=!1}return{focusClasses:u,isFocused:l,focus:f,blur:g}}const uz=Ct({disabled:{type:Boolean,default:null},error:Boolean,errorMessages:{type:[Array,String],default:()=>[]},maxErrors:{type:[Number,String],default:1},name:String,label:String,readonly:{type:Boolean,default:null},rules:{type:Array,default:()=>[]},modelValue:null,validateOn:String,validationValue:null,...NC()},"validation");function dz(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ks(),l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ca();const u=ai(e,"modelValue"),f=ce(()=>e.validationValue===void 0?u.value:e.validationValue),g=LC(e),m=Ke([]),o=ln(!0),T=ce(()=>!!(rs(u.value===""?null:u.value).length||rs(f.value===""?null:f.value).length)),k=ce(()=>{var Se;return(Se=e.errorMessages)!=null&&Se.length?rs(e.errorMessages).concat(m.value).slice(0,Math.max(0,+e.maxErrors)):m.value}),I=ce(()=>{var be;let Se=(e.validateOn??((be=g.validateOn)==null?void 0:be.value))||"input";Se==="lazy"&&(Se="input lazy"),Se==="eager"&&(Se="input eager");const me=new Set((Se==null?void 0:Se.split(" "))??[]);return{input:me.has("input"),blur:me.has("blur")||me.has("input")||me.has("invalid-input"),invalidInput:me.has("invalid-input"),lazy:me.has("lazy"),eager:me.has("eager")}}),z=ce(()=>{var Se;return e.error||(Se=e.errorMessages)!=null&&Se.length?!1:e.rules.length?o.value?m.value.length||I.value.lazy?null:!0:!m.value.length:!0}),O=ln(!1),D=ce(()=>({[`${i}--error`]:z.value===!1,[`${i}--dirty`]:T.value,[`${i}--disabled`]:g.isDisabled.value,[`${i}--readonly`]:g.isReadonly.value})),B=Gi("validation"),V=ce(()=>e.name??U(l));Ph(()=>{var Se;(Se=g.register)==null||Se.call(g,{id:V.value,vm:B,validate:pe,reset:Z,resetValidation:oe})}),Ir(()=>{var Se;(Se=g.unregister)==null||Se.call(g,V.value)}),Qn(async()=>{var Se;I.value.lazy||await pe(!I.value.eager),(Se=g.update)==null||Se.call(g,V.value,z.value,k.value)}),Oa(()=>I.value.input||I.value.invalidInput&&z.value===!1,()=>{en(f,()=>{if(f.value!=null)pe();else if(e.focused){const Se=en(()=>e.focused,me=>{me||pe(),Se()})}})}),Oa(()=>I.value.blur,()=>{en(()=>e.focused,Se=>{Se||pe()})}),en([z,k],()=>{var Se;(Se=g.update)==null||Se.call(g,V.value,z.value,k.value)});async function Z(){u.value=null,await Fi(),await oe()}async function oe(){o.value=!0,I.value.lazy?m.value=[]:await pe(!I.value.eager)}async function pe(){let Se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const me=[];O.value=!0;for(const be of e.rules){if(me.length>=+(e.maxErrors??1))break;const Ce=await(typeof be=="function"?be:()=>be)(f.value);if(Ce!==!0){if(Ce!==!1&&typeof Ce!="string"){console.warn(`${Ce} is not a valid value. Rule functions must return boolean true or a string.`);continue}me.push(Ce||"")}}return m.value=me,O.value=!1,o.value=Se,m.value}return{errorMessages:k,isDirty:T,isDisabled:g.isDisabled,isReadonly:g.isReadonly,isPristine:o,isValid:z,isValidating:O,reset:Z,resetValidation:oe,validate:pe,validationClasses:D}}const Fm=Ct({id:String,appendIcon:Gn,centerAffix:{type:Boolean,default:!0},prependIcon:Gn,hideDetails:[Boolean,String],hideSpinButtons:Boolean,hint:String,persistentHint:Boolean,messages:{type:[Array,String],default:()=>[]},direction:{type:String,default:"horizontal",validator:e=>["horizontal","vertical"].includes(e)},"onClick:prepend":sa(),"onClick:append":sa(),...xn(),...Pa(),...hI(Va(),["maxWidth","minWidth","width"]),...Di(),...uz()},"VInput"),gu=Wt()({name:"VInput",props:{...Fm()},emits:{"update:modelValue":e=>!0},setup(e,i){let{attrs:l,slots:u,emit:f}=i;const{densityClasses:g}=$a(e),{dimensionStyles:m}=Na(e),{themeClasses:o}=Hi(e),{rtlClasses:T}=ja(),{InputIcon:k}=VC(e),I=Ca(),z=ce(()=>e.id||`input-${I}`),O=ce(()=>`${z.value}-messages`),{errorMessages:D,isDirty:B,isDisabled:V,isReadonly:Z,isPristine:oe,isValid:pe,isValidating:Se,reset:me,resetValidation:be,validate:he,validationClasses:Ce}=dz(e,"v-input",z),ye=ce(()=>({id:z,messagesId:O,isDirty:B,isDisabled:V,isReadonly:Z,isPristine:oe,isValid:pe,isValidating:Se,reset:me,resetValidation:be,validate:he})),Me=ce(()=>{var ke;return(ke=e.errorMessages)!=null&&ke.length||!oe.value&&D.value.length?D.value:e.hint&&(e.persistentHint||e.focused)?e.hint:e.messages});return hn(()=>{var We,dt,je,tt;const ke=!!(u.prepend||e.prependIcon),Ee=!!(u.append||e.appendIcon),xe=Me.value.length>0,Oe=!e.hideDetails||e.hideDetails==="auto"&&(xe||!!u.details);return E("div",{class:["v-input",`v-input--${e.direction}`,{"v-input--center-affix":e.centerAffix,"v-input--hide-spin-buttons":e.hideSpinButtons},g.value,o.value,T.value,Ce.value,e.class],style:[m.value,e.style]},[ke&&E("div",{key:"prepend",class:"v-input__prepend"},[(We=u.prepend)==null?void 0:We.call(u,ye.value),e.prependIcon&&E(k,{key:"prepend-icon",name:"prepend"},null)]),u.default&&E("div",{class:"v-input__control"},[(dt=u.default)==null?void 0:dt.call(u,ye.value)]),Ee&&E("div",{key:"append",class:"v-input__append"},[e.appendIcon&&E(k,{key:"append-icon",name:"append"},null),(je=u.append)==null?void 0:je.call(u,ye.value)]),Oe&&E("div",{class:"v-input__details"},[E(cz,{id:O.value,active:xe,messages:Me.value},{message:u.message}),(tt=u.details)==null?void 0:tt.call(u,ye.value)])])}),{reset:me,resetValidation:be,validate:he,isValid:pe,errorMessages:D}}});const hz=Ct({id:String,submenu:Boolean,...Ps(Vh({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",location:void 0,openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:Fy}}),["absolute"])},"VMenu"),$C=Wt()({name:"VMenu",props:hz(),emits:{"update:modelValue":e=>!0},setup(e,i){let{slots:l}=i;const u=ai(e,"modelValue"),{scopeId:f}=nc(),{isRtl:g}=ja(),m=Ca(),o=ce(()=>e.id||`v-menu-${m}`),T=Ke(),k=ri(ay,null),I=ln(new Set);Mr(ay,{register(){I.value.add(m)},unregister(){I.value.delete(m)},closeParents(Z){setTimeout(()=>{var oe;!I.value.size&&!e.persistent&&(Z==null||(oe=T.value)!=null&&oe.contentEl&&!yI(Z,T.value.contentEl))&&(u.value=!1,k==null||k.closeParents())},40)}}),Ir(()=>{k==null||k.unregister(),document.removeEventListener("focusin",z)}),by(()=>u.value=!1);async function z(Z){var Se,me,be;const oe=Z.relatedTarget,pe=Z.target;await Fi(),u.value&&oe!==pe&&((Se=T.value)!=null&&Se.contentEl)&&((me=T.value)!=null&&me.globalTop)&&![document,T.value.contentEl].includes(pe)&&!T.value.contentEl.contains(pe)&&((be=fh(T.value.contentEl)[0])==null||be.focus())}en(u,Z=>{Z?(k==null||k.register(),Wn&&document.addEventListener("focusin",z,{once:!0})):(k==null||k.unregister(),Wn&&document.removeEventListener("focusin",z))},{immediate:!0});function O(Z){k==null||k.closeParents(Z)}function D(Z){var oe,pe,Se,me,be;if(!e.disabled)if(Z.key==="Tab"||Z.key==="Enter"&&!e.closeOnContentClick){if(Z.key==="Enter"&&(Z.target instanceof HTMLTextAreaElement||Z.target instanceof HTMLInputElement&&Z.target.closest("form")))return;Z.key==="Enter"&&Z.preventDefault(),Lw(fh((oe=T.value)==null?void 0:oe.contentEl,!1),Z.shiftKey?"prev":"next",Ce=>Ce.tabIndex>=0)||(u.value=!1,(Se=(pe=T.value)==null?void 0:pe.activatorEl)==null||Se.focus())}else e.submenu&&Z.key===(g.value?"ArrowRight":"ArrowLeft")&&(u.value=!1,(be=(me=T.value)==null?void 0:me.activatorEl)==null||be.focus())}function B(Z){var pe;if(e.disabled)return;const oe=(pe=T.value)==null?void 0:pe.contentEl;oe&&u.value?Z.key==="ArrowDown"?(Z.preventDefault(),Z.stopImmediatePropagation(),ah(oe,"next")):Z.key==="ArrowUp"?(Z.preventDefault(),Z.stopImmediatePropagation(),ah(oe,"prev")):e.submenu&&(Z.key===(g.value?"ArrowRight":"ArrowLeft")?u.value=!1:Z.key===(g.value?"ArrowLeft":"ArrowRight")&&(Z.preventDefault(),ah(oe,"first"))):(e.submenu?Z.key===(g.value?"ArrowLeft":"ArrowRight"):["ArrowDown","ArrowUp"].includes(Z.key))&&(u.value=!0,Z.preventDefault(),setTimeout(()=>setTimeout(()=>B(Z))))}const V=ce(()=>an({"aria-haspopup":"menu","aria-expanded":String(u.value),"aria-owns":o.value,onKeydown:B},e.activatorProps));return hn(()=>{const Z=Wo.filterProps(e);return E(Wo,an({ref:T,id:o.value,class:["v-menu",e.class],style:e.style},Z,{modelValue:u.value,"onUpdate:modelValue":oe=>u.value=oe,absolute:!0,activatorProps:V.value,location:e.location??(e.submenu?"end":"bottom"),"onClick:outside":O,onKeydown:D},f),{activator:l.activator,default:function(){for(var oe=arguments.length,pe=new Array(oe),Se=0;Se<oe;Se++)pe[Se]=arguments[Se];return E(Bi,{root:"VMenu"},{default:()=>{var me;return[(me=l.default)==null?void 0:me.call(l,...pe)]}})}})}),fo({id:o,ΨopenChildren:I},T)}});const fz=Ct({active:Boolean,disabled:Boolean,max:[Number,String],value:{type:[Number,String],default:0},...xn(),...Rh({transition:{component:Xw}})},"VCounter"),jC=Wt()({name:"VCounter",functional:!0,props:fz(),setup(e,i){let{slots:l}=i;const u=ce(()=>e.max?`${e.value} / ${e.max}`:String(e.value));return hn(()=>E(to,{transition:e.transition},{default:()=>[Pr(E("div",{class:["v-counter",{"text-error":e.max&&!e.disabled&&parseFloat(e.value)>parseFloat(e.max)},e.class],style:e.style},[l.default?l.default({counter:u.value,max:e.max,value:e.value}):u.value]),[[Ql,e.active]])]})),{}}});const pz=Ct({floating:Boolean,...xn()},"VFieldLabel"),gp=Wt()({name:"VFieldLabel",props:pz(),setup(e,i){let{slots:l}=i;return hn(()=>E(BC,{class:["v-field-label",{"v-field-label--floating":e.floating},e.class],style:e.style,"aria-hidden":e.floating||void 0},l)),{}}}),mz=["underlined","outlined","filled","solo","solo-inverted","solo-filled","plain"],cv=Ct({appendInnerIcon:Gn,bgColor:String,clearable:Boolean,clearIcon:{type:Gn,default:"$clear"},active:Boolean,centerAffix:{type:Boolean,default:void 0},color:String,baseColor:String,dirty:Boolean,disabled:{type:Boolean,default:null},error:Boolean,flat:Boolean,label:String,persistentClear:Boolean,prependInnerIcon:Gn,reverse:Boolean,singleLine:Boolean,variant:{type:String,default:"filled",validator:e=>mz.includes(e)},"onClick:clear":sa(),"onClick:appendInner":sa(),"onClick:prependInner":sa(),...xn(),...nv(),...ua(),...Di()},"VField"),uv=Wt()({name:"VField",inheritAttrs:!1,props:{id:String,...NC(),...cv()},emits:{"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,i){let{attrs:l,emit:u,slots:f}=i;const{themeClasses:g}=Hi(e),{loaderClasses:m}=zm(e),{focusClasses:o,isFocused:T,focus:k,blur:I}=Bm(e),{InputIcon:z}=VC(e),{roundedClasses:O}=da(e),{rtlClasses:D}=ja(),B=ce(()=>e.dirty||e.active),V=ce(()=>!e.singleLine&&!!(e.label||f.label)),Z=Ca(),oe=ce(()=>e.id||`input-${Z}`),pe=ce(()=>`${oe.value}-messages`),Se=Ke(),me=Ke(),be=Ke(),he=ce(()=>["plain","underlined"].includes(e.variant)),{backgroundColorClasses:Ce,backgroundColorStyles:ye}=Fa(rn(e,"bgColor")),{textColorClasses:Me,textColorStyles:ke}=os(ce(()=>e.error||e.disabled?void 0:B.value&&T.value?e.color:e.baseColor));en(B,We=>{if(V.value){const dt=Se.value.$el,je=me.value.$el;requestAnimationFrame(()=>{const tt=Dy(dt),Et=je.getBoundingClientRect(),_t=Et.x-tt.x,Qe=Et.y-tt.y-(tt.height/2-Et.height/2),ct=Et.width/.75,zt=Math.abs(ct-tt.width)>1?{maxWidth:mn(ct)}:void 0,Jt=getComputedStyle(dt),Lt=getComputedStyle(je),Yt=parseFloat(Jt.transitionDuration)*1e3||150,qt=parseFloat(Lt.getPropertyValue("--v-field-label-scale")),_n=Lt.getPropertyValue("color");dt.style.visibility="visible",je.style.visibility="hidden",jl(dt,{transform:`translate(${_t}px, ${Qe}px) scale(${qt})`,color:_n,...zt},{duration:Yt,easing:mh,direction:We?"normal":"reverse"}).finished.then(()=>{dt.style.removeProperty("visibility"),je.style.removeProperty("visibility")})})}},{flush:"post"});const Ee=ce(()=>({isActive:B,isFocused:T,controlRef:be,blur:I,focus:k}));function xe(We){We.target!==document.activeElement&&We.preventDefault()}function Oe(We){var dt;We.key!=="Enter"&&We.key!==" "||(We.preventDefault(),We.stopPropagation(),(dt=e["onClick:clear"])==null||dt.call(e,new MouseEvent("click")))}return hn(()=>{var _t,Qe,ct;const We=e.variant==="outlined",dt=!!(f["prepend-inner"]||e.prependInnerIcon),je=!!(e.clearable||f.clear),tt=!!(f["append-inner"]||e.appendInnerIcon||je),Et=()=>f.label?f.label({...Ee.value,label:e.label,props:{for:oe.value}}):e.label;return E("div",an({class:["v-field",{"v-field--active":B.value,"v-field--appended":tt,"v-field--center-affix":e.centerAffix??!he.value,"v-field--disabled":e.disabled,"v-field--dirty":e.dirty,"v-field--error":e.error,"v-field--flat":e.flat,"v-field--has-background":!!e.bgColor,"v-field--persistent-clear":e.persistentClear,"v-field--prepended":dt,"v-field--reverse":e.reverse,"v-field--single-line":e.singleLine,"v-field--no-label":!Et(),[`v-field--variant-${e.variant}`]:!0},g.value,Ce.value,o.value,m.value,O.value,D.value,e.class],style:[ye.value,e.style],onClick:xe},l),[E("div",{class:"v-field__overlay"},null),E(iv,{name:"v-field",active:!!e.loading,color:e.error?"error":typeof e.loading=="string"?e.loading:e.color},{default:f.loader}),dt&&E("div",{key:"prepend",class:"v-field__prepend-inner"},[e.prependInnerIcon&&E(z,{key:"prepend-icon",name:"prependInner"},null),(_t=f["prepend-inner"])==null?void 0:_t.call(f,Ee.value)]),E("div",{class:"v-field__field","data-no-activator":""},[["filled","solo","solo-inverted","solo-filled"].includes(e.variant)&&V.value&&E(gp,{key:"floating-label",ref:me,class:[Me.value],floating:!0,for:oe.value,style:ke.value},{default:()=>[Et()]}),V.value&&E(gp,{key:"label",ref:Se,for:oe.value},{default:()=>[Et()]}),(Qe=f.default)==null?void 0:Qe.call(f,{...Ee.value,props:{id:oe.value,class:"v-field__input","aria-describedby":pe.value},focus:k,blur:I})]),je&&E(Kw,{key:"clear"},{default:()=>[Pr(E("div",{class:"v-field__clearable",onMousedown:zt=>{zt.preventDefault(),zt.stopPropagation()}},[E(Bi,{defaults:{VIcon:{icon:e.clearIcon}}},{default:()=>[f.clear?f.clear({...Ee.value,props:{onKeydown:Oe,onFocus:k,onBlur:I,onClick:e["onClick:clear"]}}):E(z,{name:"clear",onKeydown:Oe,onFocus:k,onBlur:I},null)]})]),[[Ql,e.dirty]])]}),tt&&E("div",{key:"append",class:"v-field__append-inner"},[(ct=f["append-inner"])==null?void 0:ct.call(f,Ee.value),e.appendInnerIcon&&E(z,{key:"append-icon",name:"appendInner"},null)]),E("div",{class:["v-field__outline",Me.value],style:ke.value},[We&&E(un,null,[E("div",{class:"v-field__outline__start"},null),V.value&&E("div",{class:"v-field__outline__notch"},[E(gp,{ref:me,floating:!0,for:oe.value},{default:()=>[Et()]})]),E("div",{class:"v-field__outline__end"},null)]),he.value&&V.value&&E(gp,{ref:me,floating:!0,for:oe.value},{default:()=>[Et()]})])])}),{controlRef:be}}});function UC(e){const i=Object.keys(uv.props).filter(l=>!Ay(l)&&l!=="class"&&l!=="style");return Ew(e,i)}const gz=["color","file","time","date","datetime-local","week","month"],GC=Ct({autofocus:Boolean,counter:[Boolean,Number,String],counterValue:[Number,Function],prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,suffix:String,role:String,type:{type:String,default:"text"},modelModifiers:Object,...Fm(),...cv()},"VTextField"),hr=Wt()({name:"VTextField",directives:{Intersect:Vy},inheritAttrs:!1,props:GC(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,i){let{attrs:l,emit:u,slots:f}=i;const g=ai(e,"modelValue"),{isFocused:m,focus:o,blur:T}=Bm(e),k=ce(()=>typeof e.counterValue=="function"?e.counterValue(g.value):typeof e.counterValue=="number"?e.counterValue:(g.value??"").toString().length),I=ce(()=>{if(l.maxlength)return l.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter}),z=ce(()=>["plain","underlined"].includes(e.variant));function O(he,Ce){var ye,Me;!e.autofocus||!he||(Me=(ye=Ce[0].target)==null?void 0:ye.focus)==null||Me.call(ye)}const D=Ke(),B=Ke(),V=Ke(),Z=ce(()=>gz.includes(e.type)||e.persistentPlaceholder||m.value||e.active);function oe(){var he;V.value!==document.activeElement&&((he=V.value)==null||he.focus()),m.value||o()}function pe(he){u("mousedown:control",he),he.target!==V.value&&(oe(),he.preventDefault())}function Se(he){oe(),u("click:control",he)}function me(he){he.stopPropagation(),oe(),Fi(()=>{g.value=null,zw(e["onClick:clear"],he)})}function be(he){var ye;const Ce=he.target;if(g.value=Ce.value,(ye=e.modelModifiers)!=null&&ye.trim&&["text","search","password","tel","url"].includes(e.type)){const Me=[Ce.selectionStart,Ce.selectionEnd];Fi(()=>{Ce.selectionStart=Me[0],Ce.selectionEnd=Me[1]})}}return hn(()=>{const he=!!(f.counter||e.counter!==!1&&e.counter!=null),Ce=!!(he||f.details),[ye,Me]=ym(l),{modelValue:ke,...Ee}=gu.filterProps(e),xe=UC(e);return E(gu,an({ref:D,modelValue:g.value,"onUpdate:modelValue":Oe=>g.value=Oe,class:["v-text-field",{"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-input--plain-underlined":z.value},e.class],style:e.style},ye,Ee,{centerAffix:!z.value,focused:m.value}),{...f,default:Oe=>{let{id:We,isDisabled:dt,isDirty:je,isReadonly:tt,isValid:Et}=Oe;return E(uv,an({ref:B,onMousedown:pe,onClick:Se,"onClick:clear":me,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"],role:e.role},xe,{id:We.value,active:Z.value||je.value,dirty:je.value||e.dirty,disabled:dt.value,focused:m.value,error:Et.value===!1}),{...f,default:_t=>{let{props:{class:Qe,...ct}}=_t;const zt=Pr(E("input",an({ref:V,value:g.value,onInput:be,autofocus:e.autofocus,readonly:tt.value,disabled:dt.value,name:e.name,placeholder:e.placeholder,size:1,type:e.type,onFocus:oe,onBlur:T},ct,Me),null),[[oo("intersect"),{handler:O},null,{once:!0}]]);return E(un,null,[e.prefix&&E("span",{class:"v-text-field__prefix"},[E("span",{class:"v-text-field__prefix__text"},[e.prefix])]),f.default?E("div",{class:Qe,"data-no-activator":""},[f.default(),zt]):io(zt,{class:Qe}),e.suffix&&E("span",{class:"v-text-field__suffix"},[E("span",{class:"v-text-field__suffix__text"},[e.suffix])])])}})},details:Ce?Oe=>{var We;return E(un,null,[(We=f.details)==null?void 0:We.call(f,Oe),he&&E(un,null,[E("span",null,null),E(jC,{active:e.persistentCounter||m.value,value:k.value,max:I.value,disabled:e.disabled},f.counter)])])}:void 0})}),fo({},D,B,V)}});const _z=Ct({renderless:Boolean,...xn()},"VVirtualScrollItem"),yz=Wt()({name:"VVirtualScrollItem",inheritAttrs:!1,props:_z(),emits:{"update:height":e=>!0},setup(e,i){let{attrs:l,emit:u,slots:f}=i;const{resizeRef:g,contentRect:m}=mu(void 0,"border");en(()=>{var o;return(o=m.value)==null?void 0:o.height},o=>{o!=null&&u("update:height",o)}),hn(()=>{var o,T;return e.renderless?E(un,null,[(o=f.default)==null?void 0:o.call(f,{itemRef:g})]):E("div",an({ref:g,class:["v-virtual-scroll__item",e.class],style:e.style},l),[(T=f.default)==null?void 0:T.call(f)])})}}),vz=-1,bz=1,x_=100,xz=Ct({itemHeight:{type:[Number,String],default:null},height:[Number,String]},"virtual");function wz(e,i){const l=wm(),u=ln(0);Sa(()=>{u.value=parseFloat(e.itemHeight||0)});const f=ln(0),g=ln(Math.ceil((parseInt(e.height)||l.height.value)/(u.value||16))||1),m=ln(0),o=ln(0),T=Ke(),k=Ke();let I=0;const{resizeRef:z,contentRect:O}=mu();Sa(()=>{z.value=T.value});const D=ce(()=>{var Qe;return T.value===document.documentElement?l.height.value:((Qe=O.value)==null?void 0:Qe.height)||parseInt(e.height)||0}),B=ce(()=>!!(T.value&&k.value&&D.value&&u.value));let V=Array.from({length:i.value.length}),Z=Array.from({length:i.value.length});const oe=ln(0);let pe=-1;function Se(Qe){return V[Qe]||u.value}const me=pI(()=>{const Qe=performance.now();Z[0]=0;const ct=i.value.length;for(let zt=1;zt<=ct-1;zt++)Z[zt]=(Z[zt-1]||0)+Se(zt-1);oe.value=Math.max(oe.value,performance.now()-Qe)},oe),be=en(B,Qe=>{Qe&&(be(),I=k.value.offsetTop,me.immediate(),je(),~pe&&Fi(()=>{Wn&&window.requestAnimationFrame(()=>{Et(pe),pe=-1})}))});kr(()=>{me.clear()});function he(Qe,ct){const zt=V[Qe],Jt=u.value;u.value=Jt?Math.min(u.value,ct):ct,(zt!==ct||Jt!==u.value)&&(V[Qe]=ct,me())}function Ce(Qe){return Qe=Cs(Qe,0,i.value.length-1),Z[Qe]||0}function ye(Qe){return Sz(Z,Qe)}let Me=0,ke=0,Ee=0;en(D,(Qe,ct)=>{ct&&(je(),Qe<ct&&requestAnimationFrame(()=>{ke=0,je()}))});let xe=-1;function Oe(){if(!T.value||!k.value)return;const Qe=T.value.scrollTop,ct=performance.now();ct-Ee>500?(ke=Math.sign(Qe-Me),I=k.value.offsetTop):ke=Qe-Me,Me=Qe,Ee=ct,window.clearTimeout(xe),xe=window.setTimeout(We,500),je()}function We(){!T.value||!k.value||(ke=0,Ee=0,window.clearTimeout(xe),je())}let dt=-1;function je(){cancelAnimationFrame(dt),dt=requestAnimationFrame(tt)}function tt(){if(!T.value||!D.value)return;const Qe=Me-I,ct=Math.sign(ke),zt=Math.max(0,Qe-x_),Jt=Cs(ye(zt),0,i.value.length),Lt=Qe+D.value+x_,Yt=Cs(ye(Lt)+1,Jt+1,i.value.length);if((ct!==vz||Jt<f.value)&&(ct!==bz||Yt>g.value)){const qt=Ce(f.value)-Ce(Jt),_n=Ce(Yt)-Ce(g.value);Math.max(qt,_n)>x_?(f.value=Jt,g.value=Yt):(Jt<=0&&(f.value=Jt),Yt>=i.value.length&&(g.value=Yt))}m.value=Ce(f.value),o.value=Ce(i.value.length)-Ce(g.value)}function Et(Qe){const ct=Ce(Qe);!T.value||Qe&&!ct?pe=Qe:T.value.scrollTop=ct}const _t=ce(()=>i.value.slice(f.value,g.value).map((Qe,ct)=>({raw:Qe,index:ct+f.value,key:My(Qe)&&"value"in Qe?Qe.value:ct+f.value})));return en(i,()=>{V=Array.from({length:i.value.length}),Z=Array.from({length:i.value.length}),me.immediate(),je()},{deep:!0}),{calculateVisibleItems:je,containerRef:T,markerRef:k,computedItems:_t,paddingTop:m,paddingBottom:o,scrollToIndex:Et,handleScroll:Oe,handleScrollend:We,handleItemResize:he}}function Sz(e,i){let l=e.length-1,u=0,f=0,g=null,m=-1;if(e[l]<i)return l;for(;u<=l;)if(f=u+l>>1,g=e[f],g>i)l=f-1;else if(g<i)m=f,u=f+1;else return g===i?f:u;return m}const Cz=Ct({items:{type:Array,default:()=>[]},renderless:Boolean,...xz(),...xn(),...Va()},"VVirtualScroll"),Tz=Wt()({name:"VVirtualScroll",props:Cz(),setup(e,i){let{slots:l}=i;const u=Gi("VVirtualScroll"),{dimensionStyles:f}=Na(e),{calculateVisibleItems:g,containerRef:m,markerRef:o,handleScroll:T,handleScrollend:k,handleItemResize:I,scrollToIndex:z,paddingTop:O,paddingBottom:D,computedItems:B}=wz(e,rn(e,"items"));return Oa(()=>e.renderless,()=>{function V(){var pe,Se;const oe=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?"addEventListener":"removeEventListener";m.value===document.documentElement?(document[oe]("scroll",T,{passive:!0}),document[oe]("scrollend",k)):((pe=m.value)==null||pe[oe]("scroll",T,{passive:!0}),(Se=m.value)==null||Se[oe]("scrollend",k))}Qn(()=>{m.value=Zw(u.vnode.el,!0),V(!0)}),kr(V)}),hn(()=>{const V=B.value.map(Z=>E(yz,{key:Z.key,renderless:e.renderless,"onUpdate:height":oe=>I(Z.index,oe)},{default:oe=>{var pe;return(pe=l.default)==null?void 0:pe.call(l,{item:Z.raw,index:Z.index,...oe})}}));return e.renderless?E(un,null,[E("div",{ref:o,class:"v-virtual-scroll__spacer",style:{paddingTop:mn(O.value)}},null),V,E("div",{class:"v-virtual-scroll__spacer",style:{paddingBottom:mn(D.value)}},null)]):E("div",{ref:m,class:["v-virtual-scroll",e.class],onScrollPassive:T,onScrollend:k,style:[f.value,e.style]},[E("div",{ref:o,class:"v-virtual-scroll__container",style:{paddingTop:mn(O.value),paddingBottom:mn(D.value)}},[V])])}),{calculateVisibleItems:g,scrollToIndex:z}}});function Pz(e,i){const l=ln(!1);let u;function f(o){cancelAnimationFrame(u),l.value=!0,u=requestAnimationFrame(()=>{u=requestAnimationFrame(()=>{l.value=!1})})}async function g(){await new Promise(o=>requestAnimationFrame(o)),await new Promise(o=>requestAnimationFrame(o)),await new Promise(o=>requestAnimationFrame(o)),await new Promise(o=>{if(l.value){const T=en(l,()=>{T(),o()})}else o()})}async function m(o){var I,z;if(o.key==="Tab"&&((I=i.value)==null||I.focus()),!["PageDown","PageUp","Home","End"].includes(o.key))return;const T=(z=e.value)==null?void 0:z.$el;if(!T)return;(o.key==="Home"||o.key==="End")&&T.scrollTo({top:o.key==="Home"?0:T.scrollHeight,behavior:"smooth"}),await g();const k=T.querySelectorAll(":scope > :not(.v-virtual-scroll__spacer)");if(o.key==="PageDown"||o.key==="Home"){const O=T.getBoundingClientRect().top;for(const D of k)if(D.getBoundingClientRect().top>=O){D.focus();break}}else{const O=T.getBoundingClientRect().bottom;for(const D of[...k].reverse())if(D.getBoundingClientRect().bottom<=O){D.focus();break}}}return{onScrollPassive:f,onKeydown:m}}const kz=Ct({chips:Boolean,closableChips:Boolean,closeText:{type:String,default:"$vuetify.close"},openText:{type:String,default:"$vuetify.open"},eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,listProps:{type:Object},menu:Boolean,menuIcon:{type:Gn,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,itemColor:String,...ES({itemChildren:!1})},"Select"),Iz=Ct({...kz(),...Ps(GC({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...Rh({transition:{component:Fy}})},"VSelect"),ts=Wt()({name:"VSelect",props:Iz(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,i){let{slots:l}=i;const{t:u}=Dh(),f=Ke(),g=Ke(),m=Ke(),o=ai(e,"menu"),T=ce({get:()=>o.value,set:_t=>{var Qe;o.value&&!_t&&((Qe=g.value)!=null&&Qe.ΨopenChildren.size)||(o.value=_t)}}),{items:k,transformIn:I,transformOut:z}=vE(e),O=ai(e,"modelValue",[],_t=>I(_t===null?[null]:rs(_t)),_t=>{const Qe=z(_t);return e.multiple?Qe:Qe[0]??null}),D=ce(()=>typeof e.counterValue=="function"?e.counterValue(O.value):typeof e.counterValue=="number"?e.counterValue:O.value.length),B=LC(e),V=ce(()=>O.value.map(_t=>_t.value)),Z=ln(!1),oe=ce(()=>T.value?e.closeText:e.openText);let pe="",Se;const me=ce(()=>e.hideSelected?k.value.filter(_t=>!O.value.some(Qe=>e.valueComparator(Qe,_t))):k.value),be=ce(()=>e.hideNoData&&!me.value.length||B.isReadonly.value||B.isDisabled.value),he=ce(()=>{var _t;return{...e.menuProps,activatorProps:{...((_t=e.menuProps)==null?void 0:_t.activatorProps)||{},"aria-haspopup":"listbox"}}}),Ce=Ke(),ye=Pz(Ce,f);function Me(_t){e.openOnClear&&(T.value=!0)}function ke(){be.value||(T.value=!T.value)}function Ee(_t){Ub(_t)&&xe(_t)}function xe(_t){var Jt,Lt;if(!_t.key||B.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(_t.key)&&_t.preventDefault(),["Enter","ArrowDown"," "].includes(_t.key)&&(T.value=!0),["Escape","Tab"].includes(_t.key)&&(T.value=!1),_t.key==="Home"?(Jt=Ce.value)==null||Jt.focus("first"):_t.key==="End"&&((Lt=Ce.value)==null||Lt.focus("last"));const Qe=1e3;if(e.multiple||!Ub(_t))return;const ct=performance.now();ct-Se>Qe&&(pe=""),pe+=_t.key.toLowerCase(),Se=ct;const zt=k.value.find(Yt=>Yt.title.toLowerCase().startsWith(pe));if(zt!==void 0){O.value=[zt];const Yt=me.value.indexOf(zt);Wn&&window.requestAnimationFrame(()=>{var qt;Yt>=0&&((qt=m.value)==null||qt.scrollToIndex(Yt))})}}function Oe(_t){let Qe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!_t.props.disabled)if(e.multiple){const ct=O.value.findIndex(Jt=>e.valueComparator(Jt.value,_t.value)),zt=Qe??!~ct;if(~ct){const Jt=zt?[...O.value,_t]:[...O.value];Jt.splice(ct,1),O.value=Jt}else zt&&(O.value=[...O.value,_t])}else{const ct=Qe!==!1;O.value=ct?[_t]:[],Fi(()=>{T.value=!1})}}function We(_t){var Qe;(Qe=Ce.value)!=null&&Qe.$el.contains(_t.relatedTarget)||(T.value=!1)}function dt(){var _t;e.eager&&((_t=m.value)==null||_t.calculateVisibleItems())}function je(){var _t;Z.value&&((_t=f.value)==null||_t.focus())}function tt(_t){Z.value=!0}function Et(_t){if(_t==null)O.value=[];else if(Gp(f.value,":autofill")||Gp(f.value,":-webkit-autofill")){const Qe=k.value.find(ct=>ct.title===_t);Qe&&Oe(Qe)}else f.value&&(f.value.value="")}return en(T,()=>{if(!e.hideSelected&&T.value&&O.value.length){const _t=me.value.findIndex(Qe=>O.value.some(ct=>e.valueComparator(ct.value,Qe.value)));Wn&&window.requestAnimationFrame(()=>{var Qe;_t>=0&&((Qe=m.value)==null||Qe.scrollToIndex(_t))})}}),en(()=>e.items,(_t,Qe)=>{T.value||Z.value&&!Qe.length&&_t.length&&(T.value=!0)}),hn(()=>{const _t=!!(e.chips||l.chip),Qe=!!(!e.hideNoData||me.value.length||l["prepend-item"]||l["append-item"]||l["no-data"]),ct=O.value.length>0,zt=hr.filterProps(e),Jt=ct||!Z.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return E(hr,an({ref:f},zt,{modelValue:O.value.map(Lt=>Lt.props.value).join(", "),"onUpdate:modelValue":Et,focused:Z.value,"onUpdate:focused":Lt=>Z.value=Lt,validationValue:O.externalValue,counterValue:D.value,dirty:ct,class:["v-select",{"v-select--active-menu":T.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":O.value.length,"v-select--selection-slot":!!l.selection},e.class],style:e.style,inputmode:"none",placeholder:Jt,"onClick:clear":Me,"onMousedown:control":ke,onBlur:We,onKeydown:xe,"aria-label":u(oe.value),title:u(oe.value)}),{...l,default:()=>E(un,null,[E($C,an({ref:g,modelValue:T.value,"onUpdate:modelValue":Lt=>T.value=Lt,activator:"parent",contentClass:"v-select__content",disabled:be.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:dt,onAfterLeave:je},he.value),{default:()=>[Qe&&E(Xy,an({ref:Ce,selected:V.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:Lt=>Lt.preventDefault(),onKeydown:Ee,onFocusin:tt,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},ye,e.listProps),{default:()=>{var Lt,Yt,qt;return[(Lt=l["prepend-item"])==null?void 0:Lt.call(l),!me.value.length&&!e.hideNoData&&(((Yt=l["no-data"])==null?void 0:Yt.call(l))??E(za,{key:"no-data",title:u(e.noDataText)},null)),E(Tz,{ref:m,renderless:!0,items:me.value},{default:_n=>{var En;let{item:bn,index:jn,itemRef:Nn}=_n;const si=an(bn.props,{ref:Nn,key:bn.value,onClick:()=>Oe(bn,null)});return((En=l.item)==null?void 0:En.call(l,{item:bn,index:jn,props:si}))??E(za,an(si,{role:"option"}),{prepend:Pe=>{let{isSelected:Le}=Pe;return E(un,null,[e.multiple&&!e.hideSelected?E(oz,{key:bn.value,modelValue:Le,ripple:!1,tabindex:"-1"},null):void 0,bn.props.prependAvatar&&E(Kl,{image:bn.props.prependAvatar},null),bn.props.prependIcon&&E(ui,{icon:bn.props.prependIcon},null)])}})}}),(qt=l["append-item"])==null?void 0:qt.call(l)]}})]}),O.value.map((Lt,Yt)=>{function qt(Nn){Nn.stopPropagation(),Nn.preventDefault(),Oe(Lt,!1)}const _n={"onClick:close":qt,onKeydown(Nn){Nn.key!=="Enter"&&Nn.key!==" "||(Nn.preventDefault(),Nn.stopPropagation(),qt(Nn))},onMousedown(Nn){Nn.preventDefault(),Nn.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},bn=_t?!!l.chip:!!l.selection,jn=bn?Bw(_t?l.chip({item:Lt,index:Yt,props:_n}):l.selection({item:Lt,index:Yt})):void 0;if(!(bn&&!jn))return E("div",{key:Lt.value,class:"v-select__selection"},[_t?l.chip?E(Bi,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:Lt.title}}},{default:()=>[jn]}):E(on,an({key:"chip",closable:e.closableChips,size:"small",text:Lt.title,disabled:Lt.props.disabled},_n),null):jn??E("span",{class:"v-select__selection-text"},[Lt.title,e.multiple&&Yt<O.value.length-1&&E("span",{class:"v-select__selection-comma"},[Ne(",")])])])})]),"append-inner":function(){var _n;for(var Lt=arguments.length,Yt=new Array(Lt),qt=0;qt<Lt;qt++)Yt[qt]=arguments[qt];return E(un,null,[(_n=l["append-inner"])==null?void 0:_n.call(l,...Yt),e.menuIcon?E(ui,{class:"v-select__menu-icon",icon:e.menuIcon},null):void 0])}})}),fo({isFocused:Z,menu:T,select:Oe},f)}});const Mz=Ct({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...Fm(),...lv()},"VSwitch"),aa=Wt()({name:"VSwitch",inheritAttrs:!1,props:Mz(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:indeterminate":e=>!0},setup(e,i){let{attrs:l,slots:u}=i;const f=ai(e,"indeterminate"),g=ai(e,"modelValue"),{loaderClasses:m}=zm(e),{isFocused:o,focus:T,blur:k}=Bm(e),I=Ke(),z=Wn&&window.matchMedia("(forced-colors: active)").matches,O=ce(()=>typeof e.loading=="string"&&e.loading!==""?e.loading:e.color),D=Ca(),B=ce(()=>e.id||`switch-${D}`);function V(){f.value&&(f.value=!1)}function Z(oe){var pe,Se;oe.stopPropagation(),oe.preventDefault(),(Se=(pe=I.value)==null?void 0:pe.input)==null||Se.click()}return hn(()=>{const[oe,pe]=ym(l),Se=gu.filterProps(e),me=nm.filterProps(e);return E(gu,an({class:["v-switch",{"v-switch--flat":e.flat},{"v-switch--inset":e.inset},{"v-switch--indeterminate":f.value},m.value,e.class]},oe,Se,{modelValue:g.value,"onUpdate:modelValue":be=>g.value=be,id:B.value,focused:o.value,style:e.style}),{...u,default:be=>{let{id:he,messagesId:Ce,isDisabled:ye,isReadonly:Me,isValid:ke}=be;const Ee={model:g,isValid:ke};return E(nm,an({ref:I},me,{modelValue:g.value,"onUpdate:modelValue":[xe=>g.value=xe,V],id:he.value,"aria-describedby":Ce.value,type:"checkbox","aria-checked":f.value?"mixed":void 0,disabled:ye.value,readonly:Me.value,onFocus:T,onBlur:k},pe),{...u,default:xe=>{let{backgroundColorClasses:Oe,backgroundColorStyles:We}=xe;return E("div",{class:["v-switch__track",z?void 0:Oe.value],style:We.value,onClick:Z},[u["track-true"]&&E("div",{key:"prepend",class:"v-switch__track-true"},[u["track-true"](Ee)]),u["track-false"]&&E("div",{key:"append",class:"v-switch__track-false"},[u["track-false"](Ee)])])},input:xe=>{let{inputNode:Oe,icon:We,backgroundColorClasses:dt,backgroundColorStyles:je}=xe;return E(un,null,[Oe,E("div",{class:["v-switch__thumb",{"v-switch__thumb--filled":We||e.loading},e.inset||z?void 0:dt.value],style:e.inset?void 0:je.value},[u.thumb?E(Bi,{defaults:{VIcon:{icon:We,size:"x-small"}}},{default:()=>[u.thumb({...Ee,icon:We})]}):E(eM,null,{default:()=>[e.loading?E(iv,{name:"v-switch",active:!0,color:ke.value===!1?void 0:O.value},{default:tt=>u.loader?u.loader(tt):E(pC,{active:tt.isActive,color:tt.color,indeterminate:!0,size:"16",width:"2"},null)}):We&&E(ui,{key:String(We),icon:We,size:"x-small"},null)]})])])}})}})}),{}}}),Ez=Vn({__name:"SetupRaceDialog",props:{track:{},open:{type:Boolean}},emits:["goBack"],setup(e,{emit:i}){var O,D,B;const l=e,u=i,f=ei(),g=Ke(l.open),m=ce(()=>f.baseData.data.laps.filter(V=>{var Z;return V.value===-1?f.baseData.data.auth.startElimination:!((Z=l.track.Metadata)!=null&&Z.raceType&&(l.track.Metadata.raceType==="sprint"&&V.value>0||l.track.Metadata.raceType==="circuit_only"&&V.value===0))})),T=(((O=l.track.Metadata)==null?void 0:O.raceType)==="circuit_only"||((D=l.track.Metadata)==null?void 0:D.raceType)==="sprint")&&((B=l.track.Metadata)==null?void 0:B.raceType)==="circuit_only"?f.baseData.data.laps[2].value:f.baseData.data.laps[1].value,k=Ke({laps:T,buyIn:f.baseData.data.buyIns[0].value,ghosting:f.baseData.data.ghostingTimes[0].value,maxClass:f.baseData.data.classes[0].value,ranked:!1,reversed:!1,firstPerson:!1,participationMoney:0,participationCurrency:f.baseData.data.participationCurrencyOptions[0].value,silent:!1}),I=()=>{g.value=!1,u("goBack")},z=async()=>{k.value.participationMoney<0&&(k.value.participationMoney=0),k.value.laps===-1&&(k.value.ranked=!1);let V={trackId:l.track.TrackId,laps:k.value.laps,buyIn:k.value.buyIn,maxClass:k.value.maxClass,ghostingOn:k.value.ghosting!==-1,ghostingTime:k.value.ghosting,ranked:k.value.ranked,participationMoney:k.value.participationMoney,participationCurrency:k.value.participationCurrency,reversed:k.value.reversed,firstPerson:k.value.firstPerson,silent:k.value.silent};(await Ht.post("UiSetupRace",JSON.stringify(V))).data&&(g.value=!1,ca(),u("goBack"))};return(V,Z)=>(Fe(),ft(ra,{modelValue:g.value,"onUpdate:modelValue":Z[12]||(Z[12]=oe=>g.value=oe),persistent:"",width:"1024",contained:""},{default:K(()=>[E(ov,null,{default:K(()=>[E(On,null,{default:K(()=>[E($n,{class:"title-holder"},{default:K(()=>[Ne(ee(U(ne)("selected_track"))+" "+ee(V.track.RaceName),1)]),_:1}),E(qn,null,{default:K(()=>[E(Lm,null,{default:K(()=>[E(ns,null,{default:K(()=>[E(sr,{cols:"12",sm:"6"},{default:K(()=>[E(ts,{color:"primary",density:"compact",items:m.value,"item-value":"value","item-title":"text",label:U(ne)("laps"),hideDetails:"",modelValue:k.value.laps,"onUpdate:modelValue":Z[0]||(Z[0]=oe=>k.value.laps=oe)},null,8,["items","label","modelValue"])]),_:1}),E(sr,{cols:"12",sm:"6"},{default:K(()=>[E(ts,{color:"primary",density:"compact",items:U(f).baseData.data.buyIns,"item-value":"value","item-title":"text",label:U(ne)("buy_in"),hideDetails:"",modelValue:k.value.buyIn,"onUpdate:modelValue":Z[1]||(Z[1]=oe=>k.value.buyIn=oe)},null,8,["items","label","modelValue"])]),_:1})]),_:1}),E(ns,null,{default:K(()=>[E(sr,{cols:"12",sm:"6"},{default:K(()=>[U(f).baseData.data.ghostingEnabled?(Fe(),ft(ts,{key:0,color:"primary",density:"compact",items:U(f).baseData.data.ghostingTimes,"item-value":"value","item-title":"text",label:U(ne)("ghosting"),hideDetails:"",modelValue:k.value.ghosting,"onUpdate:modelValue":Z[2]||(Z[2]=oe=>k.value.ghosting=oe)},null,8,["items","label","modelValue"])):Mt("",!0)]),_:1}),E(sr,{cols:"12",sm:"6"},{default:K(()=>[E(ts,{color:"primary",density:"compact",items:U(f).baseData.data.classes,"item-value":"value","item-title":"text",label:U(ne)("max_class"),hideDetails:"",modelValue:k.value.maxClass,"onUpdate:modelValue":Z[3]||(Z[3]=oe=>k.value.maxClass=oe)},null,8,["items","label","modelValue"])]),_:1})]),_:1}),E(ns,{justify:"center"},{default:K(()=>[E(sr,{cols:"12",sm:"4"},{default:K(()=>[E(aa,{color:"primary",class:"reverse-switch",label:U(ne)("host_silent"),modelValue:k.value.silent,"onUpdate:modelValue":Z[4]||(Z[4]=oe=>k.value.silent=oe),density:"compact","hide-details":""},null,8,["label","modelValue"])]),_:1}),E(sr,{cols:"12",sm:"4"},{default:K(()=>[U(f).baseData.data.auth.startReversed?(Fe(),ft(aa,{key:0,color:"primary",class:"reverse-switch",label:U(ne)("reversed"),modelValue:k.value.reversed,"onUpdate:modelValue":Z[5]||(Z[5]=oe=>k.value.reversed=oe),density:"compact","hide-details":""},null,8,["label","modelValue"])):Mt("",!0)]),_:1}),E(sr,{cols:"12",sm:"4"},{default:K(()=>[E(aa,{color:"primary",class:"reverse-switch",label:U(ne)("first_person"),modelValue:k.value.firstPerson,"onUpdate:modelValue":Z[6]||(Z[6]=oe=>k.value.firstPerson=oe),density:"compact","hide-details":""},null,8,["label","modelValue"])]),_:1})]),_:1}),E(ns,null,{default:K(()=>{var oe,pe,Se,me,be,he,Ce,ye,Me,ke,Ee,xe;return[(me=(Se=(pe=(oe=U(f))==null?void 0:oe.baseData)==null?void 0:pe.data)==null?void 0:Se.auth)!=null&&me.setupParticipation?(Fe(),ft(sr,{key:0,cols:"12",sm:"6"},{default:K(()=>[E(hr,{color:"primary",class:"text-field",hideDetails:"",label:U(ne)("participation_amount"),density:"compact",type:"number",modelValue:k.value.participationMoney,"onUpdate:modelValue":Z[7]||(Z[7]=Oe=>k.value.participationMoney=Oe)},{prepend:K(()=>[E(tm,{location:"bottom"},{activator:K(({props:Oe})=>[E(ui,an(Oe,{icon:"mdi-help-circle-outline"}),null,16)]),default:K(()=>[Ne(" "+ee(U(ne)("participation_info")),1)]),_:1})]),_:1},8,["label","modelValue"])]),_:1})):Mt("",!0),(ye=(Ce=(he=(be=U(f))==null?void 0:be.baseData)==null?void 0:he.data)==null?void 0:Ce.auth)!=null&&ye.setupParticipation?(Fe(),ft(sr,{key:1,cols:"12",sm:"6"},{default:K(()=>[E(ts,{label:U(ne)("currency"),density:"compact",items:U(f).baseData.data.participationCurrencyOptions,modelValue:k.value.participationCurrency,"onUpdate:modelValue":Z[8]||(Z[8]=Oe=>k.value.participationCurrency=Oe),"item-title":"title","item-value":"value"},null,8,["label","items","modelValue"])]),_:1})):Mt("",!0),(xe=(Ee=(ke=(Me=U(f))==null?void 0:Me.baseData)==null?void 0:ke.data)==null?void 0:Ee.auth)!=null&&xe.startRanked?(Fe(),ft(sr,{key:2,cols:"12",sm:"6"},{default:K(()=>[E(aa,{color:"primary",label:U(ne)("ranked"),modelValue:k.value.ranked,"onUpdate:modelValue":Z[9]||(Z[9]=Oe=>k.value.ranked=Oe),density:"compact","hide-details":"",disabled:k.value.laps===-1},null,8,["label","modelValue","disabled"])]),_:1})):Mt("",!0)]}),_:1})]),_:1})]),_:1}),E(Zn,null,{default:K(()=>[E(Qi),E(Nt,{rounded:"xl",variant:"text",onClick:Z[10]||(Z[10]=oe=>I())},{default:K(()=>[Ne(ee(U(ne)("close")),1)]),_:1}),E(Nt,{rounded:"xl",color:"success",variant:"flat",onClick:Z[11]||(Z[11]=oe=>z())},{default:K(()=>[Ne(ee(U(ne)("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}});const HC=Pi(Ez,[["__scopeId","data-v-9cfb9e87"]]),Az={class:"infotext"},Rz={key:0},Dz=Vn({__name:"InfoText",props:{title:{},text:{}},setup(e){const i=e;return(l,u)=>(Fe(),Ot("div",Az,[Xe("h3",null,ee(i.title),1),i.text?(Fe(),Ot("h4",Rz,ee(i.text),1)):Mt("",!0)]))}});const Tr=Pi(Dz,[["__scopeId","data-v-a911d7f3"]]),no=e=>{const i=e,l=Math.floor(i/1e3),u=Math.floor(l/60),f=l%60,g=i%1e3,m=String(u).padStart(2,"0"),o=String(f).padStart(2,"0"),T=String(g).padStart(3,"0");return`${m}:${o}.${T}`};const zz=Ct({fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,...xn(),...Pa(),...Ti(),...Di()},"VTable"),Nh=Wt()({name:"VTable",props:zz(),setup(e,i){let{slots:l,emit:u}=i;const{themeClasses:f}=Hi(e),{densityClasses:g}=$a(e);return hn(()=>E(e.tag,{class:["v-table",{"v-table--fixed-height":!!e.height,"v-table--fixed-header":e.fixedHeader,"v-table--fixed-footer":e.fixedFooter,"v-table--has-top":!!l.top,"v-table--has-bottom":!!l.bottom,"v-table--hover":e.hover},f.value,g.value,e.class],style:e.style},{default:()=>{var m,o,T;return[(m=l.top)==null?void 0:m.call(l),l.default?E("div",{class:"v-table__wrapper",style:{height:mn(e.height)}},[E("table",null,[l.default()])]):(o=l.wrapper)==null?void 0:o.call(l),(T=l.bottom)==null?void 0:T.call(l)]}})),{}}}),Lz={class:"d-flex ga-1"},Bz={class:"text-left"},Fz={class:"text-left"},Oz=Vn({__name:"BountyItem",props:{bounty:{}},setup(e){const i=e,l=Ke(!1),u=Ke(!1),f=ei(),g=ce(()=>{const k=i.bounty.claimed;return Object.values(k).sort((z,O)=>z.time<O.time?-1:1)}),m=ce(()=>g.value.filter(k=>k.racerName===f.baseData.data.currentRacerName).length>0),o=ce(()=>i.bounty.rankRequired<=f.baseData.data.currentRanking),T=async()=>{l.value=!0,(await Ht.post("UiQuickSetupBounty",JSON.stringify(i.bounty))).data&&(l.value=!1)};return(k,I)=>(Fe(),Ot(un,null,[E(On,{rounded:"xl",border:""},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(k.bounty.trackName)+" ",1),E(on,{variant:"outlined",color:m.value?"green":"primary"},{default:K(()=>[Ne(ee(U(no)(k.bounty.timeToBeat)),1)]),_:1},8,["color"])]),_:1}),E(qn,{class:"text"},{default:K(()=>[E(on,{color:"green"},{default:K(()=>[Ne(ee(U(ne)("price"))+": "+ee(U(ne)("currency_text"))+ee(k.bounty.price),1)]),_:1}),E(on,{color:"primary"},{default:K(()=>[Ne(ee(U(ne)("class"))+": "+ee(k.bounty.maxClass),1)]),_:1}),E(on,{color:o.value?"green":"error"},{default:K(()=>[Ne(ee(U(ne)("required_rank"))+": "+ee(k.bounty.rankRequired),1)]),_:1},8,["color"]),k.bounty.reversed?(Fe(),ft(on,{key:0,color:"primary"},{default:K(()=>[Ne(ee(U(ne)("reversed")),1)]),_:1})):Mt("",!0),k.bounty.sprint?(Fe(),ft(on,{key:1,color:"primary"},{default:K(()=>[Ne(ee(U(ne)("sprint")),1)]),_:1})):(Fe(),ft(on,{key:2,color:"primary"},{default:K(()=>[Ne(ee(U(ne)("circuit")),1)]),_:1}))]),_:1}),E(Zn,null,{default:K(()=>[E(Qi),E(Nt,{rounded:"xl",onClick:I[0]||(I[0]=z=>u.value=!0)},{default:K(()=>[Ne(ee(U(ne)("records")),1)]),_:1}),E(Nt,{variant:"flat",color:"primary",disabled:!o.value||l.value,rounded:"xl",onClick:T},{default:K(()=>[Ne(ee(U(ne)("quick_host")),1)]),_:1},8,["disabled"])]),_:1})]),_:1}),E(ra,{attach:".app-container",contained:"",modelValue:u.value,"onUpdate:modelValue":I[2]||(I[2]=z=>u.value=z),width:"auto"},{default:K(()=>[E(On,{rounded:"xl"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(k.bounty.trackName),1)]),_:1}),E(qn,null,{default:K(()=>[Xe("div",Lz,[E(on,{color:"primary"},{default:K(()=>[Ne(ee(U(ne)("class"))+": "+ee(k.bounty.maxClass),1)]),_:1}),k.bounty.reversed?(Fe(),ft(on,{key:0,color:"primary"},{default:K(()=>[Ne(ee(U(ne)("reversed")),1)]),_:1})):Mt("",!0),k.bounty.sprint?(Fe(),ft(on,{key:1,color:"primary"},{default:K(()=>[Ne(ee(U(ne)("sprint")),1)]),_:1})):(Fe(),ft(on,{key:2,color:"primary"},{default:K(()=>[Ne(ee(U(ne)("circuit")),1)]),_:1})),E(on,{color:o.value?"green":"error"},{default:K(()=>[Ne(ee(U(ne)("required_rank"))+": "+ee(k.bounty.rankRequired),1)]),_:1},8,["color"])]),g.value&&g.value.length>0?(Fe(),ft(Nh,{key:0},{default:K(()=>[Xe("thead",null,[Xe("tr",null,[I[3]||(I[3]=Xe("th",{class:"text-left"},null,-1)),Xe("th",Bz,ee(U(ne)("time")),1),Xe("th",Fz,ee(U(ne)("vehicle")),1)])]),Xe("tbody",null,[(Fe(!0),Ot(un,null,la(g.value,(z,O)=>(Fe(),Ot("tr",{key:O},[Xe("td",null,ee(O+1)+". "+ee(z.racerName),1),Xe("td",null,ee(U(no)(z.time)),1),Xe("td",null,ee(z.vehicleModel),1)]))),128))])]),_:1})):(Fe(),ft(Tr,{key:1,title:U(ne)("no_data")},null,8,["title"]))]),_:1}),E(Zn,null,{default:K(()=>[E(Qi),E(Nt,{rounded:"xl",onClick:I[1]||(I[1]=z=>u.value=!1)},{default:K(()=>[Ne(ee(U(ne)("close")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}});const Vz=Pi(Oz,[["__scopeId","data-v-a6d551be"]]),Nz={class:"results-container"},$z={key:0,class:"bounty-list"},jz={key:1},Uz=Vn({__name:"BountiesTab",setup(e){const i=ei(),l=async()=>{const u=await Ht.post("UiGetBounties");u.data&&(i.bounties=u.data)};return Qn(()=>{l()}),(u,f)=>(Fe(),Ot("div",Nz,[E(On,{class:"mb-3"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("bounties")),1)]),_:1}),E(qn,{class:"text"},{default:K(()=>[Xe("p",null,ee(U(ne)("bounties_desc")),1),Xe("p",null,ee(U(ne)("bounties_desc_2")),1)]),_:1})]),_:1}),U(i).bounties.length>0?(Fe(),Ot("div",$z,[(Fe(!0),Ot(un,null,la(U(i).bounties,g=>(Fe(),ft(Vz,{key:g.id,bounty:g},null,8,["bounty"]))),128))])):(Fe(),Ot("div",jz,[E(Tr,{title:U(ne)("no_bounties")},null,8,["title"])]))]))}});const Gz=Pi(Uz,[["__scopeId","data-v-9c9a5b4f"]]);const Ui=[{game:{x:0,y:0},map:{lng:-97.383049,lat:11.992}},{game:{x:-52.34,y:-254.46},map:{lng:-98.2266,lat:6.9408}},{game:{x:-510.44,y:-371.56},map:{lng:-107.4021,lat:4.7763}},{game:{x:192.18,y:-3009.55},map:{lng:-93.3233,lat:-43.323}},{game:{x:-966.44,y:-3162.13},map:{lng:-116.49922,lat:-45.5551}},{game:{x:222.51715087890625,y:-3328.126220703125},map:{lng:-92.79132004220685,lat:-47.80717334396935}},{game:{x:1916.57,y:-959.06},map:{lng:-59.047,lat:-7.2755}},{game:{x:-2582.43,y:2286.39},map:{lng:-148.6607,lat:49.9221}},{game:{x:-2256.86,y:4326.72},map:{lng:-142.3285,lat:69.7424}},{game:{x:91.8,y:7028.52},map:{lng:-95.3158,lat:82.0328}}],Hz=()=>{const e=Ui.reduce((D,B)=>D+B.game.x,0),i=Ui.reduce((D,B)=>D+B.game.x**2,0),l=Ui.reduce((D,B)=>D+B.game.x**3,0),u=Ui.reduce((D,B)=>D+B.game.x**4,0),f=Ui.reduce((D,B)=>D+B.map.lng,0),g=Ui.reduce((D,B)=>D+B.game.x*B.map.lng,0),m=Ui.reduce((D,B)=>D+B.game.x**2*B.map.lng,0),T=[[Ui.length,e,i],[e,i,l],[i,l,u]],k=[f,g,m],[I,z,O]=ZC(T,k);return{a:O,b:z,c:I}},Zz=()=>{const e=Ui.reduce((be,he)=>be+he.game.y,0),i=Ui.reduce((be,he)=>be+he.game.y**2,0),l=Ui.reduce((be,he)=>be+he.game.y**3,0),u=Ui.reduce((be,he)=>be+he.game.y**4,0),f=Ui.reduce((be,he)=>be+he.game.y**5,0),g=Ui.reduce((be,he)=>be+he.game.y**6,0),m=Ui.reduce((be,he)=>be+he.game.y**7,0),o=Ui.reduce((be,he)=>be+he.game.y**8,0),T=Ui.reduce((be,he)=>be+he.map.lat,0),k=Ui.reduce((be,he)=>be+he.game.y*he.map.lat,0),I=Ui.reduce((be,he)=>be+he.game.y**2*he.map.lat,0),z=Ui.reduce((be,he)=>be+he.game.y**3*he.map.lat,0),O=Ui.reduce((be,he)=>be+he.game.y**4*he.map.lat,0),B=[[Ui.length,e,i,l,u],[e,i,l,u,f],[i,l,u,f,g],[l,u,f,g,m],[u,f,g,m,o]],V=[T,k,I,z,O],[Z,oe,pe,Se,me]=ZC(B,V);return{a:me,b:Se,c:pe,d:oe,e:Z}},ZC=(e,i)=>{const l=i.length,u=e.map((g,m)=>[...g,i[m]]);for(let g=0;g<l;g++){let m=g;for(let o=g+1;o<l;o++)Math.abs(u[o][g])>Math.abs(u[m][g])&&(m=o);[u[g],u[m]]=[u[m],u[g]];for(let o=g+1;o<l;o++){const T=u[o][g]/u[g][g];for(let k=g;k<=l;k++)u[o][k]-=T*u[g][k]}}const f=new Array(l);for(let g=l-1;g>=0;g--){f[g]=u[g][l];for(let m=g+1;m<l;m++)f[g]-=u[g][m]*f[m];f[g]/=u[g][g]}return f},w_=Hz(),Xd=Zz(),_p=(e,i)=>{const l=w_.a*e**2+w_.b*e+w_.c,u=Xd.a*i**4+Xd.b*i**3+Xd.c*i**2+Xd.d*i+Xd.e;return[l,u]};function qC(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{blueprint:i,...l}=e,u=Fr(i,l),{aliases:f={},components:g={},directives:m={}}=u,o=HI(u.defaults),T=bM(u.display,u.ssr),k=uM(u.theme),I=sM(u.icons),z=CM(u.locale),O=mA(u.date,z),D=IM(u.goTo,z);return{install:V=>{for(const Z in m)V.directive(Z,m[Z]);for(const Z in g)V.component(Z,g[Z]);for(const Z in f)V.component(Z,yu({...f[Z],name:Z,aliasName:f[Z].name}));if(k.install(V),V.provide(pu,o),V.provide(H_,T),V.provide(gh,k),V.provide(G_,I),V.provide(qp,z),V.provide(pA,O.options),V.provide(Px,O.instance),V.provide(sS,D),Wn&&u.ssr)if(V.$nuxt)V.$nuxt.hook("app:suspense:resolve",()=>{T.update()});else{const{mount:Z}=V;V.mount=function(){const oe=Z(...arguments);return Fi(()=>T.update()),V.mount=Z,oe}}Ca.reset(),V.mixin({computed:{$vuetify(){return br({defaults:au.call(this,pu),display:au.call(this,H_),theme:au.call(this,gh),icons:au.call(this,G_),locale:au.call(this,qp),date:au.call(this,Px)})}}})},defaults:o,display:T,theme:k,icons:I,locale:z,date:O,goTo:D}}const qz="3.7.6";qC.version=qz;function au(e){var u,f;const i=this.$,l=((u=i.parent)==null?void 0:u.provides)??((f=i.vnode.appContext)==null?void 0:f.provides);if(l&&e in l)return l[e]}var Wz=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xz(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var WC={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.1.0/LICENSE.txt
 */(function(e,i){(function(l,u){e.exports=u()})(Wz,function(){var l={},u={};function f(m,o,T){if(u[m]=T,m==="index"){var k="var sharedModule = {}; ("+u.shared+")(sharedModule); ("+u.worker+")(sharedModule);",I={};return u.shared(I),u.index(l,I),typeof window<"u"&&l.setWorkerUrl(window.URL.createObjectURL(new Blob([k],{type:"text/javascript"}))),l}}f("shared",["exports"],function(m){function o(s,n,a,c){return new(a||(a=Promise))(function(p,v){function b(M){try{C(c.next(M))}catch(R){v(R)}}function w(M){try{C(c.throw(M))}catch(R){v(R)}}function C(M){var R;M.done?p(M.value):(R=M.value,R instanceof a?R:new a(function(L){L(R)})).then(b,w)}C((c=c.apply(s,n||[])).next())})}function T(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var k,I;function z(){if(I)return k;function s(n,a){this.x=n,this.y=a}return I=1,k=s,s.prototype={clone:function(){return new s(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,a){return this.clone()._rotateAround(n,a)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var a=n.x-this.x,c=n.y-this.y;return a*a+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,a){return Math.atan2(this.x*a-this.y*n,this.x*n+this.y*a)},_matMult:function(n){var a=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=a,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var a=Math.cos(n),c=Math.sin(n),p=c*this.x+a*this.y;return this.x=a*this.x-c*this.y,this.y=p,this},_rotateAround:function(n,a){var c=Math.cos(n),p=Math.sin(n),v=a.y+p*(this.x-a.x)+c*(this.y-a.y);return this.x=a.x+c*(this.x-a.x)-p*(this.y-a.y),this.y=v,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},s.convert=function(n){return n instanceof s?n:Array.isArray(n)?new s(n[0],n[1]):n},k}typeof SuppressedError=="function"&&SuppressedError;var O,D,B=T(z()),V=function(){if(D)return O;function s(n,a,c,p){this.cx=3*n,this.bx=3*(c-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(p-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=a,this.p2x=c,this.p2y=p}return D=1,O=s,s.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,a){if(a===void 0&&(a=1e-6),n<0)return 0;if(n>1)return 1;for(var c=n,p=0;p<8;p++){var v=this.sampleCurveX(c)-n;if(Math.abs(v)<a)return c;var b=this.sampleCurveDerivativeX(c);if(Math.abs(b)<1e-6)break;c-=v/b}var w=0,C=1;for(c=n,p=0;p<20&&(v=this.sampleCurveX(c),!(Math.abs(v-n)<a));p++)n>v?w=c:C=c,c=.5*(C-w)+w;return c},solve:function(n,a){return this.sampleCurveY(this.solveCurveX(n,a))}},O}(),Z=T(V);let oe,pe;function Se(){return oe==null&&(oe=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),oe}function me(){if(pe==null&&(pe=!1,Se())){const n=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(n){for(let c=0;c<5*5;c++){const p=4*c;n.fillStyle=`rgb(${p},${p+1},${p+2})`,n.fillRect(c%5,Math.floor(c/5),1,1)}const a=n.getImageData(0,0,5,5).data;for(let c=0;c<5*5*4;c++)if(c%4!=3&&a[c]!==c){pe=!0;break}}}return pe||!1}var be,he=1e-6,Ce=typeof Float32Array<"u"?Float32Array:Array;function ye(){var s=new Ce(9);return Ce!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s}function Me(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function ke(){var s=new Ce(3);return Ce!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function Ee(s,n,a){var c=new Ce(3);return c[0]=s,c[1]=n,c[2]=a,c}function xe(s,n,a){var c=n[0],p=n[1],v=n[2],b=n[3];return s[0]=a[0]*c+a[4]*p+a[8]*v+a[12]*b,s[1]=a[1]*c+a[5]*p+a[9]*v+a[13]*b,s[2]=a[2]*c+a[6]*p+a[10]*v+a[14]*b,s[3]=a[3]*c+a[7]*p+a[11]*v+a[15]*b,s}function Oe(){var s=new Ce(4);return Ce!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s[3]=1,s}function We(){var s=new Ce(2);return Ce!=Float32Array&&(s[0]=0,s[1]=0),s}function dt(s,n){var a=new Ce(2);return a[0]=s,a[1]=n,a}Math.hypot||(Math.hypot=function(){for(var s=0,n=arguments.length;n--;)s+=arguments[n]*arguments[n];return Math.sqrt(s)}),ke(),be=new Ce(4),Ce!=Float32Array&&(be[0]=0,be[1]=0,be[2]=0,be[3]=0),ke(),Ee(1,0,0),Ee(0,1,0),Oe(),Oe(),ye(),We();const je=8192;function tt(s,n,a){return n*(je/(s.tileSize*Math.pow(2,a-s.tileID.overscaledZ)))}function Et(s,n){return(s%n+n)%n}function _t(s,n,a){return s*(1-a)+n*a}function Qe(s){if(s<=0)return 0;if(s>=1)return 1;const n=s*s,a=n*s;return 4*(s<.5?a:3*(s-n)+a-.75)}function ct(s,n,a,c){const p=new Z(s,n,a,c);return v=>p.solve(v)}const zt=ct(.25,.1,.25,1);function Jt(s,n,a){return Math.min(a,Math.max(n,s))}function Lt(s,n,a){const c=a-n,p=((s-n)%c+c)%c+n;return p===n?a:p}function Yt(s,...n){for(const a of n)for(const c in a)s[c]=a[c];return s}let qt=1;function _n(s,n,a){const c={};for(const p in s)c[p]=n.call(this,s[p],p,s);return c}function bn(s,n,a){const c={};for(const p in s)n.call(this,s[p],p,s)&&(c[p]=s[p]);return c}function jn(s){return Array.isArray(s)?s.map(jn):typeof s=="object"&&s?_n(s,jn):s}const Nn={};function si(s){Nn[s]||(typeof console<"u"&&console.warn(s),Nn[s]=!0)}function En(s,n,a){return(a.y-s.y)*(n.x-s.x)>(n.y-s.y)*(a.x-s.x)}function Pe(s){return typeof WorkerGlobalScope<"u"&&s!==void 0&&s instanceof WorkerGlobalScope}let Le=null;function ot(s){return typeof ImageBitmap<"u"&&s instanceof ImageBitmap}const xt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function gt(s,n,a,c,p){return o(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const v=new VideoFrame(s,{timestamp:0});try{const b=v==null?void 0:v.format;if(!b||!b.startsWith("BGR")&&!b.startsWith("RGB"))throw new Error(`Unrecognized format ${b}`);const w=b.startsWith("BGR"),C=new Uint8ClampedArray(c*p*4);if(yield v.copyTo(C,function(M,R,L,$,H){const q=4*Math.max(1,0),Y=(Math.max(0,L)-L)*$*4+q,re=4*$,de=Math.max(0,R),ze=Math.max(0,L);return{rect:{x:de,y:ze,width:Math.min(M.width,R+$)-de,height:Math.min(M.height,L+H)-ze},layout:[{offset:Y,stride:re}]}}(s,n,a,c,p)),w)for(let M=0;M<C.length;M+=4){const R=C[M];C[M]=C[M+2],C[M+2]=R}return C}finally{v.close()}})}let vt,Bt;function It(s){return s/Math.PI*180}const Rt="AbortError";function wt(){return new Error(Rt)}const tn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function $t(s){return tn.REGISTERED_PROTOCOLS[s.substring(0,s.indexOf("://"))]}const Xt="global-dispatcher";class dn extends Error{constructor(n,a,c,p){super(`AJAXError: ${a} (${n}): ${c}`),this.status=n,this.statusText=a,this.url=c,this.body=p}}const Sn=()=>Pe(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Dn=function(s,n){if(/:\/\//.test(s.url)&&!/^https?:|^file:/.test(s.url)){const c=$t(s.url);if(c)return c(s,n);if(Pe(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,targetMapId:Xt},n)}if(!(/^file:/.test(a=s.url)||/^file:/.test(Sn())&&!/^\w+:/.test(a))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(c,p){return o(this,void 0,void 0,function*(){const v=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,cache:c.cache,referrer:Sn(),signal:p.signal});let b,w;c.type!=="json"||v.headers.has("Accept")||v.headers.set("Accept","application/json");try{b=yield fetch(v)}catch(M){throw new dn(0,M.message,c.url,new Blob)}if(!b.ok){const M=yield b.blob();throw new dn(b.status,b.statusText,c.url,M)}w=c.type==="arrayBuffer"||c.type==="image"?b.arrayBuffer():c.type==="json"?b.json():b.text();const C=yield w;if(p.signal.aborted)throw wt();return{data:C,cacheControl:b.headers.get("Cache-Control"),expires:b.headers.get("Expires")}})}(s,n);if(Pe(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,mustQueue:!0,targetMapId:Xt},n)}var a;return function(c,p){return new Promise((v,b)=>{var w;const C=new XMLHttpRequest;C.open(c.method||"GET",c.url,!0),c.type!=="arrayBuffer"&&c.type!=="image"||(C.responseType="arraybuffer");for(const M in c.headers)C.setRequestHeader(M,c.headers[M]);c.type==="json"&&(C.responseType="text",!((w=c.headers)===null||w===void 0)&&w.Accept||C.setRequestHeader("Accept","application/json")),C.withCredentials=c.credentials==="include",C.onerror=()=>{b(new Error(C.statusText))},C.onload=()=>{if(!p.signal.aborted)if((C.status>=200&&C.status<300||C.status===0)&&C.response!==null){let M=C.response;if(c.type==="json")try{M=JSON.parse(C.response)}catch(R){return void b(R)}v({data:M,cacheControl:C.getResponseHeader("Cache-Control"),expires:C.getResponseHeader("Expires")})}else{const M=new Blob([C.response],{type:C.getResponseHeader("Content-Type")});b(new dn(C.status,C.statusText,c.url,M))}},p.signal.addEventListener("abort",()=>{C.abort(),b(wt())}),C.send(c.body)})}(s,n)};function An(s){if(!s||s.indexOf("://")<=0||s.indexOf("data:image/")===0||s.indexOf("blob:")===0)return!0;const n=new URL(s),a=window.location;return n.protocol===a.protocol&&n.host===a.host}function Ei(s,n,a){a[s]&&a[s].indexOf(n)!==-1||(a[s]=a[s]||[],a[s].push(n))}function ki(s,n,a){if(a&&a[s]){const c=a[s].indexOf(n);c!==-1&&a[s].splice(c,1)}}class tr{constructor(n,a={}){Yt(this,a),this.type=n}}class Zi extends tr{constructor(n,a={}){super("error",Yt({error:n},a))}}class Er{on(n,a){return this._listeners=this._listeners||{},Ei(n,a,this._listeners),{unsubscribe:()=>{this.off(n,a)}}}off(n,a){return ki(n,a,this._listeners),ki(n,a,this._oneTimeListeners),this}once(n,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},Ei(n,a,this._oneTimeListeners),this):new Promise(c=>this.once(n,c))}fire(n,a){typeof n=="string"&&(n=new tr(n,a||{}));const c=n.type;if(this.listens(c)){n.target=this;const p=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const w of p)w.call(this,n);const v=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const w of v)ki(c,w,this._oneTimeListeners),w.call(this,n);const b=this._eventedParent;b&&(Yt(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),b.fire(n))}else n instanceof Zi&&console.error(n.error);return this}listens(n){return this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n)}setEventedParent(n,a){return this._eventedParent=n,this._eventedParentData=a,this}}var ae={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const W=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Q(s,n){const a={};for(const c in s)c!=="ref"&&(a[c]=s[c]);return W.forEach(c=>{c in n&&(a[c]=n[c])}),a}function te(s,n){if(Array.isArray(s)){if(!Array.isArray(n)||s.length!==n.length)return!1;for(let a=0;a<s.length;a++)if(!te(s[a],n[a]))return!1;return!0}if(typeof s=="object"&&s!==null&&n!==null){if(typeof n!="object"||Object.keys(s).length!==Object.keys(n).length)return!1;for(const a in s)if(!te(s[a],n[a]))return!1;return!0}return s===n}function ge(s,n){s.push(n)}function Ae(s,n,a){ge(a,{command:"addSource",args:[s,n[s]]})}function $e(s,n,a){ge(n,{command:"removeSource",args:[s]}),a[s]=!0}function qe(s,n,a,c){$e(s,a,c),Ae(s,n,a)}function Ve(s,n,a){let c;for(c in s[a])if(Object.prototype.hasOwnProperty.call(s[a],c)&&c!=="data"&&!te(s[a][c],n[a][c]))return!1;for(c in n[a])if(Object.prototype.hasOwnProperty.call(n[a],c)&&c!=="data"&&!te(s[a][c],n[a][c]))return!1;return!0}function it(s,n,a,c,p,v){s=s||{},n=n||{};for(const b in s)Object.prototype.hasOwnProperty.call(s,b)&&(te(s[b],n[b])||a.push({command:v,args:[c,b,n[b],p]}));for(const b in n)Object.prototype.hasOwnProperty.call(n,b)&&!Object.prototype.hasOwnProperty.call(s,b)&&(te(s[b],n[b])||a.push({command:v,args:[c,b,n[b],p]}))}function Je(s){return s.id}function Ue(s,n){return s[n.id]=n,s}class Be{constructor(n,a,c,p){this.message=(n?`${n}: `:"")+c,p&&(this.identifier=p),a!=null&&a.__line__&&(this.line=a.__line__)}}function kt(s,...n){for(const a of n)for(const c in a)s[c]=a[c];return s}class Tt extends Error{constructor(n,a){super(a),this.message=a,this.key=n}}class nn{constructor(n,a=[]){this.parent=n,this.bindings={};for(const[c,p]of a)this.bindings[c]=p}concat(n){return new nn(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const pn={kind:"null"},st={kind:"number"},At={kind:"string"},Ut={kind:"boolean"},Cn={kind:"color"},zn={kind:"projectionDefinition"},cn={kind:"object"},Vt={kind:"value"},Ii={kind:"collator"},cs={kind:"formatted"},qi={kind:"padding"},Vi={kind:"resolvedImage"},hi={kind:"variableAnchorOffsetCollection"};function Or(s,n){return{kind:"array",itemType:s,N:n}}function fi(s){if(s.kind==="array"){const n=fi(s.itemType);return typeof s.N=="number"?`array<${n}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${n}>`}return s.kind}const el=[pn,st,At,Ut,Cn,zn,cs,cn,Or(Vt),qi,Vi,hi];function po(s,n){if(n.kind==="error")return null;if(s.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!po(s.itemType,n.itemType))&&(typeof s.N!="number"||s.N===n.N))return null}else{if(s.kind===n.kind)return null;if(s.kind==="value"){for(const a of el)if(!po(a,n))return null}}return`Expected ${fi(s)} but found ${fi(n)} instead.`}function Su(s,n){return n.some(a=>a.kind===s.kind)}function Ms(s,n){return n.some(a=>a==="null"?s===null:a==="array"?Array.isArray(s):a==="object"?s&&!Array.isArray(s)&&typeof s=="object":a===typeof s)}function Es(s,n){return s.kind==="array"&&n.kind==="array"?s.itemType.kind===n.itemType.kind&&typeof s.N=="number":s.kind===n.kind}const $h=.96422,Cu=.82521,jh=4/29,mo=6/29,Uh=3*mo*mo,Om=mo*mo*mo,Vm=Math.PI/180,Nm=180/Math.PI;function Gh(s){return(s%=360)<0&&(s+=360),s}function Tu([s,n,a,c]){let p,v;const b=Pu((.2225045*(s=As(s))+.7168786*(n=As(n))+.0606169*(a=As(a)))/1);s===n&&n===a?p=v=b:(p=Pu((.4360747*s+.3850649*n+.1430804*a)/$h),v=Pu((.0139322*s+.0971045*n+.7141733*a)/Cu));const w=116*b-16;return[w<0?0:w,500*(p-b),200*(b-v),c]}function As(s){return s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function Pu(s){return s>Om?Math.pow(s,1/3):s/Uh+jh}function Hh([s,n,a,c]){let p=(s+16)/116,v=isNaN(n)?p:p+n/500,b=isNaN(a)?p:p-a/200;return p=1*ku(p),v=$h*ku(v),b=Cu*ku(b),[Rs(3.1338561*v-1.6168667*p-.4906146*b),Rs(-.9787684*v+1.9161415*p+.033454*b),Rs(.0719453*v-.2289914*p+1.4052427*b),c]}function Rs(s){return(s=s<=.00304?12.92*s:1.055*Math.pow(s,1/2.4)-.055)<0?0:s>1?1:s}function ku(s){return s>mo?s*s*s:Uh*(s-jh)}function ic(s){return parseInt(s.padEnd(2,s),16)/255}function Zh(s,n){return Ds(n?s/100:s,0,1)}function Ds(s,n,a){return Math.min(Math.max(n,s),a)}function Iu(s){return!s.some(Number.isNaN)}const ka={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Tn(s,n,a){return s+a*(n-s)}function Ia(s,n,a){return s.map((c,p)=>Tn(c,n[p],a))}class Pn{constructor(n,a,c,p=1,v=!0){this.r=n,this.g=a,this.b=c,this.a=p,v||(this.r*=p,this.g*=p,this.b*=p,p||this.overwriteGetter("rgb",[n,a,c,p]))}static parse(n){if(n instanceof Pn)return n;if(typeof n!="string")return;const a=function(c){if((c=c.toLowerCase().trim())==="transparent")return[0,0,0,0];const p=ka[c];if(p){const[b,w,C]=p;return[b/255,w/255,C/255,1]}if(c.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(c)){const b=c.length<6?1:2;let w=1;return[ic(c.slice(w,w+=b)),ic(c.slice(w,w+=b)),ic(c.slice(w,w+=b)),ic(c.slice(w,w+b)||"ff")]}if(c.startsWith("rgb")){const b=c.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){const[w,C,M,R,L,$,H,q,Y,re,de,ze]=b,_e=[R||" ",H||" ",re].join("");if(_e==="  "||_e==="  /"||_e===",,"||_e===",,,"){const G=[M,$,Y].join(""),ie=G==="%%%"?100:G===""?255:0;if(ie){const ve=[Ds(+C/ie,0,1),Ds(+L/ie,0,1),Ds(+q/ie,0,1),de?Zh(+de,ze):1];if(Iu(ve))return ve}}return}}const v=c.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[b,w,C,M,R,L,$,H,q]=v,Y=[C||" ",R||" ",$].join("");if(Y==="  "||Y==="  /"||Y===",,"||Y===",,,"){const re=[+w,Ds(+M,0,100),Ds(+L,0,100),H?Zh(+H,q):1];if(Iu(re))return function([de,ze,_e,G]){function ie(ve){const He=(ve+de/30)%12,ht=ze*Math.min(_e,1-_e);return _e-ht*Math.max(-1,Math.min(He-3,9-He,1))}return de=Gh(de),ze/=100,_e/=100,[ie(0),ie(8),ie(4),G]}(re)}}}(n);return a?new Pn(...a,!1):void 0}get rgb(){const{r:n,g:a,b:c,a:p}=this,v=p||1/0;return this.overwriteGetter("rgb",[n/v,a/v,c/v,p])}get hcl(){return this.overwriteGetter("hcl",function(n){const[a,c,p,v]=Tu(n),b=Math.sqrt(c*c+p*p);return[Math.round(1e4*b)?Gh(Math.atan2(p,c)*Nm):NaN,b,a,v]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Tu(this.rgb))}overwriteGetter(n,a){return Object.defineProperty(this,n,{value:a}),a}toString(){const[n,a,c,p]=this.rgb;return`rgba(${[n,a,c].map(v=>Math.round(255*v)).join(",")},${p})`}static interpolate(n,a,c,p="rgb"){switch(p){case"rgb":{const[v,b,w,C]=Ia(n.rgb,a.rgb,c);return new Pn(v,b,w,C,!1)}case"hcl":{const[v,b,w,C]=n.hcl,[M,R,L,$]=a.hcl;let H,q;if(isNaN(v)||isNaN(M))isNaN(v)?isNaN(M)?H=NaN:(H=M,w!==1&&w!==0||(q=R)):(H=v,L!==1&&L!==0||(q=b));else{let _e=M-v;M>v&&_e>180?_e-=360:M<v&&v-M>180&&(_e+=360),H=v+c*_e}const[Y,re,de,ze]=function([_e,G,ie,ve]){return _e=isNaN(_e)?0:_e*Vm,Hh([ie,Math.cos(_e)*G,Math.sin(_e)*G,ve])}([H,q??Tn(b,R,c),Tn(w,L,c),Tn(C,$,c)]);return new Pn(Y,re,de,ze,!1)}case"lab":{const[v,b,w,C]=Hh(Ia(n.lab,a.lab,c));return new Pn(v,b,w,C,!1)}}}}Pn.black=new Pn(0,0,0,1),Pn.white=new Pn(1,1,1,1),Pn.transparent=new Pn(0,0,0,0),Pn.red=new Pn(1,0,0,1);class rc{constructor(n,a,c){this.sensitivity=n?a?"variant":"case":a?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,a){return this.collator.compare(n,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const qh=["bottom","center","top"];class tl{constructor(n,a,c,p,v,b){this.text=n,this.image=a,this.scale=c,this.fontStack=p,this.textColor=v,this.verticalAlign=b}}class Ai{constructor(n){this.sections=n}static fromString(n){return new Ai([new tl(n,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.name.length!==0)}static factory(n){return n instanceof Ai?n:Ai.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}}class Wi{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof Wi)return n;if(typeof n=="number")return new Wi([n,n,n,n]);if(Array.isArray(n)&&!(n.length<1||n.length>4)){for(const a of n)if(typeof a!="number")return;switch(n.length){case 1:n=[n[0],n[0],n[0],n[0]];break;case 2:n=[n[0],n[1],n[0],n[1]];break;case 3:n=[n[0],n[1],n[2],n[1]]}return new Wi(n)}}toString(){return JSON.stringify(this.values)}static interpolate(n,a,c){return new Wi(Ia(n.values,a.values,c))}}class bi{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const Mu=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class mr{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof mr)return n;if(Array.isArray(n)&&!(n.length<1)&&n.length%2==0){for(let a=0;a<n.length;a+=2){const c=n[a],p=n[a+1];if(typeof c!="string"||!Mu.has(c)||!Array.isArray(p)||p.length!==2||typeof p[0]!="number"||typeof p[1]!="number")return}return new mr(n)}}toString(){return JSON.stringify(this.values)}static interpolate(n,a,c){const p=n.values,v=a.values;if(p.length!==v.length)throw new bi(`Cannot interpolate values of different length. from: ${n.toString()}, to: ${a.toString()}`);const b=[];for(let w=0;w<p.length;w+=2){if(p[w]!==v[w])throw new bi(`Cannot interpolate values containing mismatched anchors. from[${w}]: ${p[w]}, to[${w}]: ${v[w]}`);b.push(p[w]);const[C,M]=p[w+1],[R,L]=v[w+1];b.push([Tn(C,R,c),Tn(M,L,c)])}return new mr(b)}}class gr{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new gr({name:n,available:!1}):null}}class _r{constructor(n,a,c){this.from=n,this.to=a,this.transition=c}static interpolate(n,a,c){return new _r(n,a,c)}static parse(n){return n instanceof _r?n:Array.isArray(n)&&n.length===3&&typeof n[0]=="string"&&typeof n[1]=="string"&&typeof n[2]=="number"?new _r(n[0],n[1],n[2]):typeof n=="object"&&typeof n.from=="string"&&typeof n.to=="string"&&typeof n.transition=="number"?new _r(n.from,n.to,n.transition):typeof n=="string"?new _r(n,n,1):void 0}}function Eu(s,n,a,c){return typeof s=="number"&&s>=0&&s<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof a=="number"&&a>=0&&a<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[s,n,a,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[s,n,a,c]:[s,n,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function zs(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof _r||s instanceof Pn||s instanceof rc||s instanceof Ai||s instanceof Wi||s instanceof mr||s instanceof gr)return!0;if(Array.isArray(s)){for(const n of s)if(!zs(n))return!1;return!0}if(typeof s=="object"){for(const n in s)if(!zs(s[n]))return!1;return!0}return!1}function oi(s){if(s===null)return pn;if(typeof s=="string")return At;if(typeof s=="boolean")return Ut;if(typeof s=="number")return st;if(s instanceof Pn)return Cn;if(s instanceof _r)return zn;if(s instanceof rc)return Ii;if(s instanceof Ai)return cs;if(s instanceof Wi)return qi;if(s instanceof mr)return hi;if(s instanceof gr)return Vi;if(Array.isArray(s)){const n=s.length;let a;for(const c of s){const p=oi(c);if(a){if(a===p)continue;a=Vt;break}a=p}return Or(a||Vt,n)}return cn}function nl(s){const n=typeof s;return s===null?"":n==="string"||n==="number"||n==="boolean"?String(s):s instanceof Pn||s instanceof _r||s instanceof Ai||s instanceof Wi||s instanceof mr||s instanceof gr?s.toString():JSON.stringify(s)}class Ma{constructor(n,a){this.type=n,this.value=a}static parse(n,a){if(n.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!zs(n[1]))return a.error("invalid value");const c=n[1];let p=oi(c);const v=a.expectedType;return p.kind!=="array"||p.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(p=v),new Ma(p,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Ua={string:At,number:st,boolean:Ut,object:cn};class Jr{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");let c,p=1;const v=n[0];if(v==="array"){let w,C;if(n.length>2){const M=n[1];if(typeof M!="string"||!(M in Ua)||M==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);w=Ua[M],p++}else w=Vt;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return a.error('The length argument to "array" must be a positive integer literal',2);C=n[2],p++}c=Or(w,C)}else{if(!Ua[v])throw new Error(`Types doesn't contain name = ${v}`);c=Ua[v]}const b=[];for(;p<n.length;p++){const w=a.parse(n[p],p,Vt);if(!w)return null;b.push(w)}return new Jr(c,b)}evaluate(n){for(let a=0;a<this.args.length;a++){const c=this.args[a].evaluate(n);if(!po(this.type,oi(c)))return c;if(a===this.args.length-1)throw new bi(`Expected value to be of type ${fi(this.type)}, but found ${fi(oi(c))} instead.`)}throw new Error}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const Au={"to-boolean":Ut,"to-color":Cn,"to-number":st,"to-string":At};class Ga{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");const c=n[0];if(!Au[c])throw new Error(`Can't parse ${c} as it is not part of the known types`);if((c==="to-boolean"||c==="to-string")&&n.length!==2)return a.error("Expected one argument.");const p=Au[c],v=[];for(let b=1;b<n.length;b++){const w=a.parse(n[b],b,Vt);if(!w)return null;v.push(w)}return new Ga(p,v)}evaluate(n){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(n);case"color":{let a,c;for(const p of this.args){if(a=p.evaluate(n),c=null,a instanceof Pn)return a;if(typeof a=="string"){const v=n.parseColor(a);if(v)return v}else if(Array.isArray(a)&&(c=a.length<3||a.length>4?`Invalid rgba value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:Eu(a[0],a[1],a[2],a[3]),!c))return new Pn(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new bi(c||`Could not parse color from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"padding":{let a;for(const c of this.args){a=c.evaluate(n);const p=Wi.parse(a);if(p)return p}throw new bi(`Could not parse padding from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"variableAnchorOffsetCollection":{let a;for(const c of this.args){a=c.evaluate(n);const p=mr.parse(a);if(p)return p}throw new bi(`Could not parse variableAnchorOffsetCollection from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"number":{let a=null;for(const c of this.args){if(a=c.evaluate(n),a===null)return 0;const p=Number(a);if(!isNaN(p))return p}throw new bi(`Could not convert ${JSON.stringify(a)} to number.`)}case"formatted":return Ai.fromString(nl(this.args[0].evaluate(n)));case"resolvedImage":return gr.fromString(nl(this.args[0].evaluate(n)));case"projectionDefinition":return this.args[0].evaluate(n);default:return nl(this.args[0].evaluate(n))}}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const ac=["Unknown","Point","LineString","Polygon"];class li{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ac[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(n){let a=this._parseColorCache[n];return a||(a=this._parseColorCache[n]=Pn.parse(n)),a}}class go{constructor(n,a,c=[],p,v=new nn,b=[]){this.registry=n,this.path=c,this.key=c.map(w=>`[${w}]`).join(""),this.scope=v,this.errors=b,this.expectedType=p,this._isConstant=a}parse(n,a,c,p,v={}){return a?this.concat(a,c,p)._parse(n,v):this._parse(n,v)}_parse(n,a){function c(p,v,b){return b==="assert"?new Jr(v,[p]):b==="coerce"?new Ga(v,[p]):p}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=n[0];if(typeof p!="string")return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[p];if(v){let b=v.parse(n,this);if(!b)return null;if(this.expectedType){const w=this.expectedType,C=b.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||C.kind!=="value")if(w.kind!=="projectionDefinition"||C.kind!=="string"&&C.kind!=="array")if(w.kind!=="color"&&w.kind!=="formatted"&&w.kind!=="resolvedImage"||C.kind!=="value"&&C.kind!=="string")if(w.kind!=="padding"||C.kind!=="value"&&C.kind!=="number"&&C.kind!=="array")if(w.kind!=="variableAnchorOffsetCollection"||C.kind!=="value"&&C.kind!=="array"){if(this.checkSubtype(w,C))return null}else b=c(b,w,a.typeAnnotation||"coerce");else b=c(b,w,a.typeAnnotation||"coerce");else b=c(b,w,a.typeAnnotation||"coerce");else b=c(b,w,a.typeAnnotation||"coerce");else b=c(b,w,a.typeAnnotation||"assert")}if(!(b instanceof Ma)&&b.type.kind!=="resolvedImage"&&this._isConstant(b)){const w=new li;try{b=new Ma(b.type,b.evaluate(w))}catch(C){return this.error(C.message),null}}return b}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,a,c){const p=typeof n=="number"?this.path.concat(n):this.path,v=c?this.scope.concat(c):this.scope;return new go(this.registry,this._isConstant,p,a||null,v,this.errors)}error(n,...a){const c=`${this.key}${a.map(p=>`[${p}]`).join("")}`;this.errors.push(new Tt(c,n))}checkSubtype(n,a){const c=po(n,a);return c&&this.error(c),c}}class Rn{constructor(n,a){this.type=a.type,this.bindings=[].concat(n),this.result=a}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const a of this.bindings)n(a[1]);n(this.result)}static parse(n,a){if(n.length<4)return a.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const c=[];for(let v=1;v<n.length-1;v+=2){const b=n[v];if(typeof b!="string")return a.error(`Expected string, but found ${typeof b} instead.`,v);if(/[^a-zA-Z0-9_]/.test(b))return a.error("Variable names must contain only alphanumeric characters or '_'.",v);const w=a.parse(n[v+1],v+1);if(!w)return null;c.push([b,w])}const p=a.parse(n[n.length-1],n.length-1,a.expectedType,c);return p?new Rn(c,p):null}outputDefined(){return this.result.outputDefined()}}class yn{constructor(n,a){this.type=a.type,this.name=n,this.boundExpression=a}static parse(n,a){if(n.length!==2||typeof n[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const c=n[1];return a.scope.has(c)?new yn(c,a.scope.get(c)):a.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}}class il{constructor(n,a,c){this.type=n,this.index=a,this.input=c}static parse(n,a){if(n.length!==3)return a.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const c=a.parse(n[1],1,st),p=a.parse(n[2],2,Or(a.expectedType||Vt));return c&&p?new il(p.type.itemType,c,p):null}evaluate(n){const a=this.index.evaluate(n),c=this.input.evaluate(n);if(a<0)throw new bi(`Array index out of bounds: ${a} < 0.`);if(a>=c.length)throw new bi(`Array index out of bounds: ${a} > ${c.length-1}.`);if(a!==Math.floor(a))throw new bi(`Array index must be an integer, but found ${a} instead.`);return c[a]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}}class Ln{constructor(n,a){this.type=Ut,this.needle=n,this.haystack=a}static parse(n,a){if(n.length!==3)return a.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const c=a.parse(n[1],1,Vt),p=a.parse(n[2],2,Vt);return c&&p?Su(c.type,[Ut,At,st,pn,Vt])?new Ln(c,p):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${fi(c.type)} instead`):null}evaluate(n){const a=this.needle.evaluate(n),c=this.haystack.evaluate(n);if(!c)return!1;if(!Ms(a,["boolean","string","number","null"]))throw new bi(`Expected first argument to be of type boolean, string, number or null, but found ${fi(oi(a))} instead.`);if(!Ms(c,["string","array"]))throw new bi(`Expected second argument to be of type array or string, but found ${fi(oi(c))} instead.`);return c.indexOf(a)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}}class _o{constructor(n,a,c){this.type=st,this.needle=n,this.haystack=a,this.fromIndex=c}static parse(n,a){if(n.length<=2||n.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const c=a.parse(n[1],1,Vt),p=a.parse(n[2],2,Vt);if(!c||!p)return null;if(!Su(c.type,[Ut,At,st,pn,Vt]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${fi(c.type)} instead`);if(n.length===4){const v=a.parse(n[3],3,st);return v?new _o(c,p,v):null}return new _o(c,p)}evaluate(n){const a=this.needle.evaluate(n),c=this.haystack.evaluate(n);if(!Ms(a,["boolean","string","number","null"]))throw new bi(`Expected first argument to be of type boolean, string, number or null, but found ${fi(oi(a))} instead.`);let p;if(this.fromIndex&&(p=this.fromIndex.evaluate(n)),Ms(c,["string"])){const v=c.indexOf(a,p);return v===-1?-1:[...c.slice(0,v)].length}if(Ms(c,["array"]))return c.indexOf(a,p);throw new bi(`Expected second argument to be of type array or string, but found ${fi(oi(c))} instead.`)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}}class ha{constructor(n,a,c,p,v,b){this.inputType=n,this.type=a,this.input=c,this.cases=p,this.outputs=v,this.otherwise=b}static parse(n,a){if(n.length<5)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return a.error("Expected an even number of arguments.");let c,p;a.expectedType&&a.expectedType.kind!=="value"&&(p=a.expectedType);const v={},b=[];for(let M=2;M<n.length-1;M+=2){let R=n[M];const L=n[M+1];Array.isArray(R)||(R=[R]);const $=a.concat(M);if(R.length===0)return $.error("Expected at least one branch label.");for(const q of R){if(typeof q!="number"&&typeof q!="string")return $.error("Branch labels must be numbers or strings.");if(typeof q=="number"&&Math.abs(q)>Number.MAX_SAFE_INTEGER)return $.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof q=="number"&&Math.floor(q)!==q)return $.error("Numeric branch labels must be integer values.");if(c){if($.checkSubtype(c,oi(q)))return null}else c=oi(q);if(v[String(q)]!==void 0)return $.error("Branch labels must be unique.");v[String(q)]=b.length}const H=a.parse(L,M,p);if(!H)return null;p=p||H.type,b.push(H)}const w=a.parse(n[1],1,Vt);if(!w)return null;const C=a.parse(n[n.length-1],n.length-1,p);return C?w.type.kind!=="value"&&a.concat(1).checkSubtype(c,w.type)?null:new ha(c,p,w,v,b,C):null}evaluate(n){const a=this.input.evaluate(n);return(oi(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}}class rl{constructor(n,a,c){this.type=n,this.branches=a,this.otherwise=c}static parse(n,a){if(n.length<4)return a.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return a.error("Expected an odd number of arguments.");let c;a.expectedType&&a.expectedType.kind!=="value"&&(c=a.expectedType);const p=[];for(let b=1;b<n.length-1;b+=2){const w=a.parse(n[b],b,Ut);if(!w)return null;const C=a.parse(n[b+1],b+1,c);if(!C)return null;p.push([w,C]),c=c||C.type}const v=a.parse(n[n.length-1],n.length-1,c);if(!v)return null;if(!c)throw new Error("Can't infer output type");return new rl(c,p,v)}evaluate(n){for(const[a,c]of this.branches)if(a.evaluate(n))return c.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[a,c]of this.branches)n(a),n(c);n(this.otherwise)}outputDefined(){return this.branches.every(([n,a])=>a.outputDefined())&&this.otherwise.outputDefined()}}class al{constructor(n,a,c,p){this.type=n,this.input=a,this.beginIndex=c,this.endIndex=p}static parse(n,a){if(n.length<=2||n.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const c=a.parse(n[1],1,Vt),p=a.parse(n[2],2,st);if(!c||!p)return null;if(!Su(c.type,[Or(Vt),At,Vt]))return a.error(`Expected first argument to be of type array or string, but found ${fi(c.type)} instead`);if(n.length===4){const v=a.parse(n[3],3,st);return v?new al(c.type,c,p,v):null}return new al(c.type,c,p)}evaluate(n){const a=this.input.evaluate(n),c=this.beginIndex.evaluate(n);let p;if(this.endIndex&&(p=this.endIndex.evaluate(n)),Ms(a,["string"]))return[...a].slice(c,p).join("");if(Ms(a,["array"]))return a.slice(c,p);throw new bi(`Expected first argument to be of type array or string, but found ${fi(oi(a))} instead.`)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}}function sl(s,n){const a=s.length-1;let c,p,v=0,b=a,w=0;for(;v<=b;)if(w=Math.floor((v+b)/2),c=s[w],p=s[w+1],c<=n){if(w===a||n<p)return w;v=w+1}else{if(!(c>n))throw new bi("Input is not a number.");b=w-1}return 0}class Ls{constructor(n,a,c){this.type=n,this.input=a,this.labels=[],this.outputs=[];for(const[p,v]of c)this.labels.push(p),this.outputs.push(v)}static parse(n,a){if(n.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return a.error("Expected an even number of arguments.");const c=a.parse(n[1],1,st);if(!c)return null;const p=[];let v=null;a.expectedType&&a.expectedType.kind!=="value"&&(v=a.expectedType);for(let b=1;b<n.length;b+=2){const w=b===1?-1/0:n[b],C=n[b+1],M=b,R=b+1;if(typeof w!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(p.length&&p[p.length-1][0]>=w)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const L=a.parse(C,R,v);if(!L)return null;v=v||L.type,p.push([w,L])}return new Ls(v,c,p)}evaluate(n){const a=this.labels,c=this.outputs;if(a.length===1)return c[0].evaluate(n);const p=this.input.evaluate(n);if(p<=a[0])return c[0].evaluate(n);const v=a.length;return p>=a[v-1]?c[v-1].evaluate(n):c[sl(a,p)].evaluate(n)}eachChild(n){n(this.input);for(const a of this.outputs)n(a)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function Wh(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Ru,Du,Xh=function(){if(Du)return Ru;function s(n,a,c,p){this.cx=3*n,this.bx=3*(c-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(p-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=a,this.p2x=c,this.p2y=p}return Du=1,Ru=s,s.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,a){if(a===void 0&&(a=1e-6),n<0)return 0;if(n>1)return 1;for(var c=n,p=0;p<8;p++){var v=this.sampleCurveX(c)-n;if(Math.abs(v)<a)return c;var b=this.sampleCurveDerivativeX(c);if(Math.abs(b)<1e-6)break;c-=v/b}var w=0,C=1;for(c=n,p=0;p<20&&(v=this.sampleCurveX(c),!(Math.abs(v-n)<a));p++)n>v?w=c:C=c,c=.5*(C-w)+w;return c},solve:function(n,a){return this.sampleCurveY(this.solveCurveX(n,a))}},Ru}(),ol=Wh(Xh);class ti{constructor(n,a,c,p,v){this.type=n,this.operator=a,this.interpolation=c,this.input=p,this.labels=[],this.outputs=[];for(const[b,w]of v)this.labels.push(b),this.outputs.push(w)}static interpolationFactor(n,a,c,p){let v=0;if(n.name==="exponential")v=yo(a,n.base,c,p);else if(n.name==="linear")v=yo(a,1,c,p);else if(n.name==="cubic-bezier"){const b=n.controlPoints;v=new ol(b[0],b[1],b[2],b[3]).solve(yo(a,1,c,p))}return v}static parse(n,a){let[c,p,v,...b]=n;if(!Array.isArray(p)||p.length===0)return a.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const M=p[1];if(typeof M!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:M}}else{if(p[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const M=p.slice(1);if(M.length!==4||M.some(R=>typeof R!="number"||R<0||R>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:M}}}if(n.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(v=a.parse(v,2,st),!v)return null;const w=[];let C=null;c==="interpolate-hcl"||c==="interpolate-lab"?C=Cn:a.expectedType&&a.expectedType.kind!=="value"&&(C=a.expectedType);for(let M=0;M<b.length;M+=2){const R=b[M],L=b[M+1],$=M+3,H=M+4;if(typeof R!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(w.length&&w[w.length-1][0]>=R)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);const q=a.parse(L,H,C);if(!q)return null;C=C||q.type,w.push([R,q])}return Es(C,st)||Es(C,zn)||Es(C,Cn)||Es(C,qi)||Es(C,hi)||Es(C,Or(st))?new ti(C,c,p,v,w):a.error(`Type ${fi(C)} is not interpolatable.`)}evaluate(n){const a=this.labels,c=this.outputs;if(a.length===1)return c[0].evaluate(n);const p=this.input.evaluate(n);if(p<=a[0])return c[0].evaluate(n);const v=a.length;if(p>=a[v-1])return c[v-1].evaluate(n);const b=sl(a,p),w=ti.interpolationFactor(this.interpolation,p,a[b],a[b+1]),C=c[b].evaluate(n),M=c[b+1].evaluate(n);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Tn(C,M,w);case"color":return Pn.interpolate(C,M,w);case"padding":return Wi.interpolate(C,M,w);case"variableAnchorOffsetCollection":return mr.interpolate(C,M,w);case"array":return Ia(C,M,w);case"projectionDefinition":return _r.interpolate(C,M,w)}case"interpolate-hcl":return Pn.interpolate(C,M,w,"hcl");case"interpolate-lab":return Pn.interpolate(C,M,w,"lab")}}eachChild(n){n(this.input);for(const a of this.outputs)n(a)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function yo(s,n,a,c){const p=c-a,v=s-a;return p===0?0:n===1?v/p:(Math.pow(n,v)-1)/(Math.pow(n,p)-1)}const fa={color:Pn.interpolate,number:Tn,padding:Wi.interpolate,variableAnchorOffsetCollection:mr.interpolate,array:Ia};class Bs{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");let c=null;const p=a.expectedType;p&&p.kind!=="value"&&(c=p);const v=[];for(const w of n.slice(1)){const C=a.parse(w,1+v.length,c,void 0,{typeAnnotation:"omit"});if(!C)return null;c=c||C.type,v.push(C)}if(!c)throw new Error("No output type");const b=p&&v.some(w=>po(p,w.type));return new Bs(b?Vt:c,v)}evaluate(n){let a,c=null,p=0;for(const v of this.args)if(p++,c=v.evaluate(n),c&&c instanceof gr&&!c.available&&(a||(a=c.name),c=null,p===this.args.length&&(c=a)),c!==null)break;return c}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}function Xi(s,n){return s==="=="||s==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function zu(s,n,a,c){return c.compare(n,a)===0}function us(s,n,a){const c=s!=="=="&&s!=="!=";return class XC{constructor(v,b,w){this.type=Ut,this.lhs=v,this.rhs=b,this.collator=w,this.hasUntypedArgument=v.type.kind==="value"||b.type.kind==="value"}static parse(v,b){if(v.length!==3&&v.length!==4)return b.error("Expected two or three arguments.");const w=v[0];let C=b.parse(v[1],1,Vt);if(!C)return null;if(!Xi(w,C.type))return b.concat(1).error(`"${w}" comparisons are not supported for type '${fi(C.type)}'.`);let M=b.parse(v[2],2,Vt);if(!M)return null;if(!Xi(w,M.type))return b.concat(2).error(`"${w}" comparisons are not supported for type '${fi(M.type)}'.`);if(C.type.kind!==M.type.kind&&C.type.kind!=="value"&&M.type.kind!=="value")return b.error(`Cannot compare types '${fi(C.type)}' and '${fi(M.type)}'.`);c&&(C.type.kind==="value"&&M.type.kind!=="value"?C=new Jr(M.type,[C]):C.type.kind!=="value"&&M.type.kind==="value"&&(M=new Jr(C.type,[M])));let R=null;if(v.length===4){if(C.type.kind!=="string"&&M.type.kind!=="string"&&C.type.kind!=="value"&&M.type.kind!=="value")return b.error("Cannot use collator to compare non-string types.");if(R=b.parse(v[3],3,Ii),!R)return null}return new XC(C,M,R)}evaluate(v){const b=this.lhs.evaluate(v),w=this.rhs.evaluate(v);if(c&&this.hasUntypedArgument){const C=oi(b),M=oi(w);if(C.kind!==M.kind||C.kind!=="string"&&C.kind!=="number")throw new bi(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${C.kind}, ${M.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const C=oi(b),M=oi(w);if(C.kind!=="string"||M.kind!=="string")return n(v,b,w)}return this.collator?a(v,b,w,this.collator.evaluate(v)):n(v,b,w)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}}}const Kh=us("==",function(s,n,a){return n===a},zu),$m=us("!=",function(s,n,a){return n!==a},function(s,n,a,c){return!zu(0,n,a,c)}),sc=us("<",function(s,n,a){return n<a},function(s,n,a,c){return c.compare(n,a)<0}),Lu=us(">",function(s,n,a){return n>a},function(s,n,a,c){return c.compare(n,a)>0}),jm=us("<=",function(s,n,a){return n<=a},function(s,n,a,c){return c.compare(n,a)<=0}),oc=us(">=",function(s,n,a){return n>=a},function(s,n,a,c){return c.compare(n,a)>=0});class Fs{constructor(n,a,c){this.type=Ii,this.locale=c,this.caseSensitive=n,this.diacriticSensitive=a}static parse(n,a){if(n.length!==2)return a.error("Expected one argument.");const c=n[1];if(typeof c!="object"||Array.isArray(c))return a.error("Collator options argument must be an object.");const p=a.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,Ut);if(!p)return null;const v=a.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,Ut);if(!v)return null;let b=null;return c.locale&&(b=a.parse(c.locale,1,At),!b)?null:new Fs(p,v,b)}evaluate(n){return new rc(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}}class Vr{constructor(n,a,c,p,v){this.type=At,this.number=n,this.locale=a,this.currency=c,this.minFractionDigits=p,this.maxFractionDigits=v}static parse(n,a){if(n.length!==3)return a.error("Expected two arguments.");const c=a.parse(n[1],1,st);if(!c)return null;const p=n[2];if(typeof p!="object"||Array.isArray(p))return a.error("NumberFormat options argument must be an object.");let v=null;if(p.locale&&(v=a.parse(p.locale,1,At),!v))return null;let b=null;if(p.currency&&(b=a.parse(p.currency,1,At),!b))return null;let w=null;if(p["min-fraction-digits"]&&(w=a.parse(p["min-fraction-digits"],1,st),!w))return null;let C=null;return p["max-fraction-digits"]&&(C=a.parse(p["max-fraction-digits"],1,st),!C)?null:new Vr(c,v,b,w,C)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}}class ll{constructor(n){this.type=cs,this.sections=n}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");const c=n[1];if(!Array.isArray(c)&&typeof c=="object")return a.error("First argument must be an image or text section.");const p=[];let v=!1;for(let b=1;b<=n.length-1;++b){const w=n[b];if(v&&typeof w=="object"&&!Array.isArray(w)){v=!1;let C=null;if(w["font-scale"]&&(C=a.parse(w["font-scale"],1,st),!C))return null;let M=null;if(w["text-font"]&&(M=a.parse(w["text-font"],1,Or(At)),!M))return null;let R=null;if(w["text-color"]&&(R=a.parse(w["text-color"],1,Cn),!R))return null;let L=null;if(w["vertical-align"]){if(typeof w["vertical-align"]=="string"&&!qh.includes(w["vertical-align"]))return a.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${w["vertical-align"]}' instead.`);if(L=a.parse(w["vertical-align"],1,At),!L)return null}const $=p[p.length-1];$.scale=C,$.font=M,$.textColor=R,$.verticalAlign=L}else{const C=a.parse(n[b],1,Vt);if(!C)return null;const M=C.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,p.push({content:C,scale:null,font:null,textColor:null,verticalAlign:null})}}return new ll(p)}evaluate(n){return new Ai(this.sections.map(a=>{const c=a.content.evaluate(n);return oi(c)===Vi?new tl("",c,null,null,null,a.verticalAlign?a.verticalAlign.evaluate(n):null):new tl(nl(c),null,a.scale?a.scale.evaluate(n):null,a.font?a.font.evaluate(n).join(","):null,a.textColor?a.textColor.evaluate(n):null,a.verticalAlign?a.verticalAlign.evaluate(n):null)}))}eachChild(n){for(const a of this.sections)n(a.content),a.scale&&n(a.scale),a.font&&n(a.font),a.textColor&&n(a.textColor),a.verticalAlign&&n(a.verticalAlign)}outputDefined(){return!1}}class vo{constructor(n){this.type=Vi,this.input=n}static parse(n,a){if(n.length!==2)return a.error("Expected two arguments.");const c=a.parse(n[1],1,At);return c?new vo(c):a.error("No image name provided.")}evaluate(n){const a=this.input.evaluate(n),c=gr.fromString(a);return c&&n.availableImages&&(c.available=n.availableImages.indexOf(a)>-1),c}eachChild(n){n(this.input)}outputDefined(){return!1}}class Bu{constructor(n){this.type=st,this.input=n}static parse(n,a){if(n.length!==2)return a.error(`Expected 1 argument, but found ${n.length-1} instead.`);const c=a.parse(n[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${fi(c.type)} instead.`):new Bu(c):null}evaluate(n){const a=this.input.evaluate(n);if(typeof a=="string")return[...a].length;if(Array.isArray(a))return a.length;throw new bi(`Expected value to be of type string or array, but found ${fi(oi(a))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}}const Qr=8192;function Um(s,n){const a=(180+s[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,p=Math.pow(2,n.z);return[Math.round(a*p*Qr),Math.round(c*p*Qr)]}function Fu(s,n){const a=Math.pow(2,n.z);return[(p=(s[0]/Qr+n.x)/a,360*p-180),(c=(s[1]/Qr+n.y)/a,360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90)];var c,p}function cl(s,n){s[0]=Math.min(s[0],n[0]),s[1]=Math.min(s[1],n[1]),s[2]=Math.max(s[2],n[0]),s[3]=Math.max(s[3],n[1])}function ul(s,n){return!(s[0]<=n[0]||s[2]>=n[2]||s[1]<=n[1]||s[3]>=n[3])}function lc(s,n,a){const c=s[0]-n[0],p=s[1]-n[1],v=s[0]-a[0],b=s[1]-a[1];return c*b-v*p==0&&c*v<=0&&p*b<=0}function cc(s,n,a,c){return(p=[c[0]-a[0],c[1]-a[1]])[0]*(v=[n[0]-s[0],n[1]-s[1]])[1]-p[1]*v[0]!=0&&!(!Jh(s,n,a,c)||!Jh(a,c,s,n));var p,v}function Yh(s,n,a){for(const c of a)for(let p=0;p<c.length-1;++p)if(cc(s,n,c[p],c[p+1]))return!0;return!1}function Os(s,n,a=!1){let c=!1;for(const w of n)for(let C=0;C<w.length-1;C++){if(lc(s,w[C],w[C+1]))return a;(v=w[C])[1]>(p=s)[1]!=(b=w[C+1])[1]>p[1]&&p[0]<(b[0]-v[0])*(p[1]-v[1])/(b[1]-v[1])+v[0]&&(c=!c)}var p,v,b;return c}function Gm(s,n){for(const a of n)if(Os(s,a))return!0;return!1}function Ou(s,n){for(const a of s)if(!Os(a,n))return!1;for(let a=0;a<s.length-1;++a)if(Yh(s[a],s[a+1],n))return!1;return!0}function Hm(s,n){for(const a of n)if(Ou(s,a))return!0;return!1}function Jh(s,n,a,c){const p=c[0]-a[0],v=c[1]-a[1],b=(s[0]-a[0])*v-p*(s[1]-a[1]),w=(n[0]-a[0])*v-p*(n[1]-a[1]);return b>0&&w<0||b<0&&w>0}function Vu(s,n,a){const c=[];for(let p=0;p<s.length;p++){const v=[];for(let b=0;b<s[p].length;b++){const w=Um(s[p][b],a);cl(n,w),v.push(w)}c.push(v)}return c}function Qh(s,n,a){const c=[];for(let p=0;p<s.length;p++){const v=Vu(s[p],n,a);c.push(v)}return c}function ef(s,n,a,c){if(s[0]<a[0]||s[0]>a[2]){const p=.5*c;let v=s[0]-a[0]>p?-c:a[0]-s[0]>p?c:0;v===0&&(v=s[0]-a[2]>p?-c:a[2]-s[0]>p?c:0),s[0]+=v}cl(n,s)}function Nu(s,n,a,c){const p=Math.pow(2,c.z)*Qr,v=[c.x*Qr,c.y*Qr],b=[];for(const w of s)for(const C of w){const M=[C.x+v[0],C.y+v[1]];ef(M,n,a,p),b.push(M)}return b}function $u(s,n,a,c){const p=Math.pow(2,c.z)*Qr,v=[c.x*Qr,c.y*Qr],b=[];for(const C of s){const M=[];for(const R of C){const L=[R.x+v[0],R.y+v[1]];cl(n,L),M.push(L)}b.push(M)}if(n[2]-n[0]<=p/2){(w=n)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const C of b)for(const M of C)ef(M,n,a,p)}var w;return b}class ds{constructor(n,a){this.type=Ut,this.geojson=n,this.geometries=a}static parse(n,a){if(n.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(zs(n[1])){const c=n[1];if(c.type==="FeatureCollection"){const p=[];for(const v of c.features){const{type:b,coordinates:w}=v.geometry;b==="Polygon"&&p.push(w),b==="MultiPolygon"&&p.push(...w)}if(p.length)return new ds(c,{type:"MultiPolygon",coordinates:p})}else if(c.type==="Feature"){const p=c.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new ds(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new ds(c,c)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(a,c){const p=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],b=a.canonicalID();if(c.type==="Polygon"){const w=Vu(c.coordinates,v,b),C=Nu(a.geometry(),p,v,b);if(!ul(p,v))return!1;for(const M of C)if(!Os(M,w))return!1}if(c.type==="MultiPolygon"){const w=Qh(c.coordinates,v,b),C=Nu(a.geometry(),p,v,b);if(!ul(p,v))return!1;for(const M of C)if(!Gm(M,w))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(a,c){const p=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],b=a.canonicalID();if(c.type==="Polygon"){const w=Vu(c.coordinates,v,b),C=$u(a.geometry(),p,v,b);if(!ul(p,v))return!1;for(const M of C)if(!Ou(M,w))return!1}if(c.type==="MultiPolygon"){const w=Qh(c.coordinates,v,b),C=$u(a.geometry(),p,v,b);if(!ul(p,v))return!1;for(const M of C)if(!Hm(M,w))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let tf=class{constructor(s=[],n=(a,c)=>a<c?-1:a>c?1:0){if(this.data=s,this.length=this.data.length,this.compare=n,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(s){this.data.push(s),this._up(this.length++)}pop(){if(this.length===0)return;const s=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:n,compare:a}=this,c=n[s];for(;s>0;){const p=s-1>>1,v=n[p];if(a(c,v)>=0)break;n[s]=v,s=p}n[s]=c}_down(s){const{data:n,compare:a}=this,c=this.length>>1,p=n[s];for(;s<c;){let v=1+(s<<1);const b=v+1;if(b<this.length&&a(n[b],n[v])<0&&(v=b),a(n[v],p)>=0)break;n[s]=n[v],s=v}n[s]=p}};function nf(s,n,a=0,c=s.length-1,p=ju){for(;c>a;){if(c-a>600){const C=c-a+1,M=n-a+1,R=Math.log(C),L=.5*Math.exp(2*R/3),$=.5*Math.sqrt(R*L*(C-L)/C)*(M-C/2<0?-1:1);nf(s,n,Math.max(a,Math.floor(n-M*L/C+$)),Math.min(c,Math.floor(n+(C-M)*L/C+$)),p)}const v=s[n];let b=a,w=c;for(dl(s,a,n),p(s[c],v)>0&&dl(s,a,c);b<w;){for(dl(s,b,w),b++,w--;p(s[b],v)<0;)b++;for(;p(s[w],v)>0;)w--}p(s[a],v)===0?dl(s,a,w):(w++,dl(s,w,c)),w<=n&&(a=w+1),n<=w&&(c=w-1)}}function dl(s,n,a){const c=s[n];s[n]=s[a],s[a]=c}function ju(s,n){return s<n?-1:s>n?1:0}function uc(s,n){if(s.length<=1)return[s];const a=[];let c,p;for(const v of s){const b=qm(v);b!==0&&(v.area=Math.abs(b),p===void 0&&(p=b<0),p===b<0?(c&&a.push(c),c=[v]):c.push(v))}if(c&&a.push(c),n>1)for(let v=0;v<a.length;v++)a[v].length<=n||(nf(a[v],n,1,a[v].length-1,Zm),a[v]=a[v].slice(0,n));return a}function Zm(s,n){return n.area-s.area}function qm(s){let n=0;for(let a,c,p=0,v=s.length,b=v-1;p<v;b=p++)a=s[p],c=s[b],n+=(c.x-a.x)*(a.y+c.y);return n}const Uu=1/298.257223563,Gu=Uu*(2-Uu),rf=Math.PI/180;class Hu{constructor(n){const a=6378.137*rf*1e3,c=Math.cos(n*rf),p=1/(1-Gu*(1-c*c)),v=Math.sqrt(p);this.kx=a*v*c,this.ky=a*v*p*(1-Gu)}distance(n,a){const c=this.wrap(n[0]-a[0])*this.kx,p=(n[1]-a[1])*this.ky;return Math.sqrt(c*c+p*p)}pointOnLine(n,a){let c,p,v,b,w=1/0;for(let C=0;C<n.length-1;C++){let M=n[C][0],R=n[C][1],L=this.wrap(n[C+1][0]-M)*this.kx,$=(n[C+1][1]-R)*this.ky,H=0;L===0&&$===0||(H=(this.wrap(a[0]-M)*this.kx*L+(a[1]-R)*this.ky*$)/(L*L+$*$),H>1?(M=n[C+1][0],R=n[C+1][1]):H>0&&(M+=L/this.kx*H,R+=$/this.ky*H)),L=this.wrap(a[0]-M)*this.kx,$=(a[1]-R)*this.ky;const q=L*L+$*$;q<w&&(w=q,c=M,p=R,v=C,b=H)}return{point:[c,p],index:v,t:Math.max(0,Math.min(1,b))}}wrap(n){for(;n<-180;)n+=360;for(;n>180;)n-=360;return n}}function Zu(s,n){return n[0]-s[0]}function hl(s){return s[1]-s[0]+1}function Ha(s,n){return s[1]>=s[0]&&s[1]<n}function qu(s,n){if(s[0]>s[1])return[null,null];const a=hl(s);if(n){if(a===2)return[s,null];const p=Math.floor(a/2);return[[s[0],s[0]+p],[s[0]+p,s[1]]]}if(a===1)return[s,null];const c=Math.floor(a/2)-1;return[[s[0],s[0]+c],[s[0]+c+1,s[1]]]}function Wu(s,n){if(!Ha(n,s.length))return[1/0,1/0,-1/0,-1/0];const a=[1/0,1/0,-1/0,-1/0];for(let c=n[0];c<=n[1];++c)cl(a,s[c]);return a}function dc(s){const n=[1/0,1/0,-1/0,-1/0];for(const a of s)for(const c of a)cl(n,c);return n}function af(s){return s[0]!==-1/0&&s[1]!==-1/0&&s[2]!==1/0&&s[3]!==1/0}function Xu(s,n,a){if(!af(s)||!af(n))return NaN;let c=0,p=0;return s[2]<n[0]&&(c=n[0]-s[2]),s[0]>n[2]&&(c=s[0]-n[2]),s[1]>n[3]&&(p=s[1]-n[3]),s[3]<n[1]&&(p=n[1]-s[3]),a.distance([0,0],[c,p])}function Vs(s,n,a){const c=a.pointOnLine(n,s);return a.distance(s,c.point)}function Ku(s,n,a,c,p){const v=Math.min(Vs(s,[a,c],p),Vs(n,[a,c],p)),b=Math.min(Vs(a,[s,n],p),Vs(c,[s,n],p));return Math.min(v,b)}function Un(s,n,a,c,p){if(!Ha(n,s.length)||!Ha(c,a.length))return 1/0;let v=1/0;for(let b=n[0];b<n[1];++b){const w=s[b],C=s[b+1];for(let M=c[0];M<c[1];++M){const R=a[M],L=a[M+1];if(cc(w,C,R,L))return 0;v=Math.min(v,Ku(w,C,R,L,p))}}return v}function Wm(s,n,a,c,p){if(!Ha(n,s.length)||!Ha(c,a.length))return NaN;let v=1/0;for(let b=n[0];b<=n[1];++b)for(let w=c[0];w<=c[1];++w)if(v=Math.min(v,p.distance(s[b],a[w])),v===0)return v;return v}function Xm(s,n,a){if(Os(s,n,!0))return 0;let c=1/0;for(const p of n){const v=p[0],b=p[p.length-1];if(v!==b&&(c=Math.min(c,Vs(s,[b,v],a)),c===0))return c;const w=a.pointOnLine(p,s);if(c=Math.min(c,a.distance(s,w.point)),c===0)return c}return c}function Km(s,n,a,c){if(!Ha(n,s.length))return NaN;for(let v=n[0];v<=n[1];++v)if(Os(s[v],a,!0))return 0;let p=1/0;for(let v=n[0];v<n[1];++v){const b=s[v],w=s[v+1];for(const C of a)for(let M=0,R=C.length,L=R-1;M<R;L=M++){const $=C[L],H=C[M];if(cc(b,w,$,H))return 0;p=Math.min(p,Ku(b,w,$,H,c))}}return p}function sf(s,n){for(const a of s)for(const c of a)if(Os(c,n,!0))return!0;return!1}function Ym(s,n,a,c=1/0){const p=dc(s),v=dc(n);if(c!==1/0&&Xu(p,v,a)>=c)return c;if(ul(p,v)){if(sf(s,n))return 0}else if(sf(n,s))return 0;let b=1/0;for(const w of s)for(let C=0,M=w.length,R=M-1;C<M;R=C++){const L=w[R],$=w[C];for(const H of n)for(let q=0,Y=H.length,re=Y-1;q<Y;re=q++){const de=H[re],ze=H[q];if(cc(L,$,de,ze))return 0;b=Math.min(b,Ku(L,$,de,ze,a))}}return b}function of(s,n,a,c,p,v){if(!v)return;const b=Xu(Wu(c,v),p,a);b<n&&s.push([b,v,[0,0]])}function hc(s,n,a,c,p,v,b){if(!v||!b)return;const w=Xu(Wu(c,v),Wu(p,b),a);w<n&&s.push([w,v,b])}function fc(s,n,a,c,p=1/0){let v=Math.min(c.distance(s[0],a[0][0]),p);if(v===0)return v;const b=new tf([[0,[0,s.length-1],[0,0]]],Zu),w=dc(a);for(;b.length>0;){const C=b.pop();if(C[0]>=v)continue;const M=C[1],R=n?50:100;if(hl(M)<=R){if(!Ha(M,s.length))return NaN;if(n){const L=Km(s,M,a,c);if(isNaN(L)||L===0)return L;v=Math.min(v,L)}else for(let L=M[0];L<=M[1];++L){const $=Xm(s[L],a,c);if(v=Math.min(v,$),v===0)return 0}}else{const L=qu(M,n);of(b,v,c,s,w,L[0]),of(b,v,c,s,w,L[1])}}return v}function pc(s,n,a,c,p,v=1/0){let b=Math.min(v,p.distance(s[0],a[0]));if(b===0)return b;const w=new tf([[0,[0,s.length-1],[0,a.length-1]]],Zu);for(;w.length>0;){const C=w.pop();if(C[0]>=b)continue;const M=C[1],R=C[2],L=n?50:100,$=c?50:100;if(hl(M)<=L&&hl(R)<=$){if(!Ha(M,s.length)&&Ha(R,a.length))return NaN;let H;if(n&&c)H=Un(s,M,a,R,p),b=Math.min(b,H);else if(n&&!c){const q=s.slice(M[0],M[1]+1);for(let Y=R[0];Y<=R[1];++Y)if(H=Vs(a[Y],q,p),b=Math.min(b,H),b===0)return b}else if(!n&&c){const q=a.slice(R[0],R[1]+1);for(let Y=M[0];Y<=M[1];++Y)if(H=Vs(s[Y],q,p),b=Math.min(b,H),b===0)return b}else H=Wm(s,M,a,R,p),b=Math.min(b,H)}else{const H=qu(M,n),q=qu(R,c);hc(w,b,p,s,a,H[0],q[0]),hc(w,b,p,s,a,H[0],q[1]),hc(w,b,p,s,a,H[1],q[0]),hc(w,b,p,s,a,H[1],q[1])}}return b}function Yu(s){return s.type==="MultiPolygon"?s.coordinates.map(n=>({type:"Polygon",coordinates:n})):s.type==="MultiLineString"?s.coordinates.map(n=>({type:"LineString",coordinates:n})):s.type==="MultiPoint"?s.coordinates.map(n=>({type:"Point",coordinates:n})):[s]}class Ns{constructor(n,a){this.type=st,this.geojson=n,this.geometries=a}static parse(n,a){if(n.length!==2)return a.error(`'distance' expression requires exactly one argument, but found ${n.length-1} instead.`);if(zs(n[1])){const c=n[1];if(c.type==="FeatureCollection")return new Ns(c,c.features.map(p=>Yu(p.geometry)).flat());if(c.type==="Feature")return new Ns(c,Yu(c.geometry));if("type"in c&&"coordinates"in c)return new Ns(c,Yu(c))}return a.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(a,c){const p=a.geometry(),v=p.flat().map(C=>Fu([C.x,C.y],a.canonical));if(p.length===0)return NaN;const b=new Hu(v[0][1]);let w=1/0;for(const C of c){switch(C.type){case"Point":w=Math.min(w,pc(v,!1,[C.coordinates],!1,b,w));break;case"LineString":w=Math.min(w,pc(v,!1,C.coordinates,!0,b,w));break;case"Polygon":w=Math.min(w,fc(v,!1,C.coordinates,b,w))}if(w===0)return w}return w}(n,this.geometries);if(n.geometryType()==="LineString")return function(a,c){const p=a.geometry(),v=p.flat().map(C=>Fu([C.x,C.y],a.canonical));if(p.length===0)return NaN;const b=new Hu(v[0][1]);let w=1/0;for(const C of c){switch(C.type){case"Point":w=Math.min(w,pc(v,!0,[C.coordinates],!1,b,w));break;case"LineString":w=Math.min(w,pc(v,!0,C.coordinates,!0,b,w));break;case"Polygon":w=Math.min(w,fc(v,!0,C.coordinates,b,w))}if(w===0)return w}return w}(n,this.geometries);if(n.geometryType()==="Polygon")return function(a,c){const p=a.geometry();if(p.length===0||p[0].length===0)return NaN;const v=uc(p,0).map(C=>C.map(M=>M.map(R=>Fu([R.x,R.y],a.canonical)))),b=new Hu(v[0][0][0][1]);let w=1/0;for(const C of c)for(const M of v){switch(C.type){case"Point":w=Math.min(w,fc([C.coordinates],!1,M,b,w));break;case"LineString":w=Math.min(w,fc(C.coordinates,!0,M,b,w));break;case"Polygon":w=Math.min(w,Ym(M,C.coordinates,b,w))}if(w===0)return w}return w}(n,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const bo={"==":Kh,"!=":$m,">":Lu,"<":sc,">=":oc,"<=":jm,array:Jr,at:il,boolean:Jr,case:rl,coalesce:Bs,collator:Fs,format:ll,image:vo,in:Ln,"index-of":_o,interpolate:ti,"interpolate-hcl":ti,"interpolate-lab":ti,length:Bu,let:Rn,literal:Ma,match:ha,number:Jr,"number-format":Vr,object:Jr,slice:al,step:Ls,string:Jr,"to-boolean":Ga,"to-color":Ga,"to-number":Ga,"to-string":Ga,var:yn,within:ds,distance:Ns};class ea{constructor(n,a,c,p){this.name=n,this.type=a,this._evaluate=c,this.args=p}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}static parse(n,a){const c=n[0],p=ea.definitions[c];if(!p)return a.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(p)?p[0]:p.type,b=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,w=b.filter(([M])=>!Array.isArray(M)||M.length===n.length-1);let C=null;for(const[M,R]of w){C=new go(a.registry,mc,a.path,null,a.scope);const L=[];let $=!1;for(let H=1;H<n.length;H++){const q=n[H],Y=Array.isArray(M)?M[H-1]:M.type,re=C.parse(q,1+L.length,Y);if(!re){$=!0;break}L.push(re)}if(!$)if(Array.isArray(M)&&M.length!==L.length)C.error(`Expected ${M.length} arguments, but found ${L.length} instead.`);else{for(let H=0;H<L.length;H++){const q=Array.isArray(M)?M[H]:M.type,Y=L[H];C.concat(H+1).checkSubtype(q,Y.type)}if(C.errors.length===0)return new ea(c,v,R,L)}}if(w.length===1)a.errors.push(...C.errors);else{const M=(w.length?w:b).map(([L])=>{return $=L,Array.isArray($)?`(${$.map(fi).join(", ")})`:`(${fi($.type)}...)`;var $}).join(" | "),R=[];for(let L=1;L<n.length;L++){const $=a.parse(n[L],1+R.length);if(!$)return null;R.push(fi($.type))}a.error(`Expected arguments of type ${M}, but found (${R.join(", ")}) instead.`)}return null}static register(n,a){ea.definitions=a;for(const c in a)n[c]=ea}}function lf(s,[n,a,c,p]){n=n.evaluate(s),a=a.evaluate(s),c=c.evaluate(s);const v=p?p.evaluate(s):1,b=Eu(n,a,c,v);if(b)throw new bi(b);return new Pn(n/255,a/255,c/255,v,!1)}function cf(s,n){return s in n}function Ju(s,n){const a=n[s];return a===void 0?null:a}function $s(s){return{type:s}}function mc(s){if(s instanceof yn)return mc(s.boundExpression);if(s instanceof ea&&s.name==="error"||s instanceof Fs||s instanceof ds||s instanceof Ns)return!1;const n=s instanceof Ga||s instanceof Jr;let a=!0;return s.eachChild(c=>{a=n?a&&mc(c):a&&c instanceof Ma}),!!a&&gc(s)&&_c(s,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function gc(s){if(s instanceof ea&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof ds||s instanceof Ns)return!1;let n=!0;return s.eachChild(a=>{n&&!gc(a)&&(n=!1)}),n}function fl(s){if(s instanceof ea&&s.name==="feature-state")return!1;let n=!0;return s.eachChild(a=>{n&&!fl(a)&&(n=!1)}),n}function _c(s,n){if(s instanceof ea&&n.indexOf(s.name)>=0)return!1;let a=!0;return s.eachChild(c=>{a&&!_c(c,n)&&(a=!1)}),a}function uf(s){return{result:"success",value:s}}function xo(s){return{result:"error",value:s}}function wo(s){return s["property-type"]==="data-driven"||s["property-type"]==="cross-faded-data-driven"}function df(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function Qu(s){return!!s.expression&&s.expression.interpolated}function Fn(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function yc(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)}function Jm(s){return s}function hf(s,n){const a=n.type==="color",c=s.stops&&typeof s.stops[0][0]=="object",p=c||!(c||s.property!==void 0),v=s.type||(Qu(n)?"exponential":"interval");if(a||n.type==="padding"){const R=a?Pn.parse:Wi.parse;(s=kt({},s)).stops&&(s.stops=s.stops.map(L=>[L[0],R(L[1])])),s.default=R(s.default?s.default:n.default)}if(s.colorSpace&&(b=s.colorSpace)!=="rgb"&&b!=="hcl"&&b!=="lab")throw new Error(`Unknown color space: "${s.colorSpace}"`);var b;let w,C,M;if(v==="exponential")w=ff;else if(v==="interval")w=Qm;else if(v==="categorical"){w=ed,C=Object.create(null);for(const R of s.stops)C[R[0]]=R[1];M=typeof s.stops[0][0]}else{if(v!=="identity")throw new Error(`Unknown function type "${v}"`);w=eg}if(c){const R={},L=[];for(let q=0;q<s.stops.length;q++){const Y=s.stops[q],re=Y[0].zoom;R[re]===void 0&&(R[re]={zoom:re,type:s.type,property:s.property,default:s.default,stops:[]},L.push(re)),R[re].stops.push([Y[0].value,Y[1]])}const $=[];for(const q of L)$.push([R[q].zoom,hf(R[q],n)]);const H={name:"linear"};return{kind:"composite",interpolationType:H,interpolationFactor:ti.interpolationFactor.bind(void 0,H),zoomStops:$.map(q=>q[0]),evaluate:({zoom:q},Y)=>ff({stops:$,base:s.base},n,q).evaluate(q,Y)}}if(p){const R=v==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:R,interpolationFactor:ti.interpolationFactor.bind(void 0,R),zoomStops:s.stops.map(L=>L[0]),evaluate:({zoom:L})=>w(s,n,L,C,M)}}return{kind:"source",evaluate(R,L){const $=L&&L.properties?L.properties[s.property]:void 0;return $===void 0?pl(s.default,n.default):w(s,n,$,C,M)}}}function pl(s,n,a){return s!==void 0?s:n!==void 0?n:a!==void 0?a:void 0}function ed(s,n,a,c,p){return pl(typeof a===p?c[a]:void 0,s.default,n.default)}function Qm(s,n,a){if(Fn(a)!=="number")return pl(s.default,n.default);const c=s.stops.length;if(c===1||a<=s.stops[0][0])return s.stops[0][1];if(a>=s.stops[c-1][0])return s.stops[c-1][1];const p=sl(s.stops.map(v=>v[0]),a);return s.stops[p][1]}function ff(s,n,a){const c=s.base!==void 0?s.base:1;if(Fn(a)!=="number")return pl(s.default,n.default);const p=s.stops.length;if(p===1||a<=s.stops[0][0])return s.stops[0][1];if(a>=s.stops[p-1][0])return s.stops[p-1][1];const v=sl(s.stops.map(R=>R[0]),a),b=function(R,L,$,H){const q=H-$,Y=R-$;return q===0?0:L===1?Y/q:(Math.pow(L,Y)-1)/(Math.pow(L,q)-1)}(a,c,s.stops[v][0],s.stops[v+1][0]),w=s.stops[v][1],C=s.stops[v+1][1],M=fa[n.type]||Jm;return typeof w.evaluate=="function"?{evaluate(...R){const L=w.evaluate.apply(void 0,R),$=C.evaluate.apply(void 0,R);if(L!==void 0&&$!==void 0)return M(L,$,b,s.colorSpace)}}:M(w,C,b,s.colorSpace)}function eg(s,n,a){switch(n.type){case"color":a=Pn.parse(a);break;case"formatted":a=Ai.fromString(a.toString());break;case"resolvedImage":a=gr.fromString(a.toString());break;case"padding":a=Wi.parse(a);break;default:Fn(a)===n.type||n.type==="enum"&&n.values[a]||(a=void 0)}return pl(a,s.default,n.default)}ea.register(bo,{error:[{kind:"error"},[At],(s,[n])=>{throw new bi(n.evaluate(s))}],typeof:[At,[Vt],(s,[n])=>fi(oi(n.evaluate(s)))],"to-rgba":[Or(st,4),[Cn],(s,[n])=>{const[a,c,p,v]=n.evaluate(s).rgb;return[255*a,255*c,255*p,v]}],rgb:[Cn,[st,st,st],lf],rgba:[Cn,[st,st,st,st],lf],has:{type:Ut,overloads:[[[At],(s,[n])=>cf(n.evaluate(s),s.properties())],[[At,cn],(s,[n,a])=>cf(n.evaluate(s),a.evaluate(s))]]},get:{type:Vt,overloads:[[[At],(s,[n])=>Ju(n.evaluate(s),s.properties())],[[At,cn],(s,[n,a])=>Ju(n.evaluate(s),a.evaluate(s))]]},"feature-state":[Vt,[At],(s,[n])=>Ju(n.evaluate(s),s.featureState||{})],properties:[cn,[],s=>s.properties()],"geometry-type":[At,[],s=>s.geometryType()],id:[Vt,[],s=>s.id()],zoom:[st,[],s=>s.globals.zoom],"heatmap-density":[st,[],s=>s.globals.heatmapDensity||0],"line-progress":[st,[],s=>s.globals.lineProgress||0],accumulated:[Vt,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[st,$s(st),(s,n)=>{let a=0;for(const c of n)a+=c.evaluate(s);return a}],"*":[st,$s(st),(s,n)=>{let a=1;for(const c of n)a*=c.evaluate(s);return a}],"-":{type:st,overloads:[[[st,st],(s,[n,a])=>n.evaluate(s)-a.evaluate(s)],[[st],(s,[n])=>-n.evaluate(s)]]},"/":[st,[st,st],(s,[n,a])=>n.evaluate(s)/a.evaluate(s)],"%":[st,[st,st],(s,[n,a])=>n.evaluate(s)%a.evaluate(s)],ln2:[st,[],()=>Math.LN2],pi:[st,[],()=>Math.PI],e:[st,[],()=>Math.E],"^":[st,[st,st],(s,[n,a])=>Math.pow(n.evaluate(s),a.evaluate(s))],sqrt:[st,[st],(s,[n])=>Math.sqrt(n.evaluate(s))],log10:[st,[st],(s,[n])=>Math.log(n.evaluate(s))/Math.LN10],ln:[st,[st],(s,[n])=>Math.log(n.evaluate(s))],log2:[st,[st],(s,[n])=>Math.log(n.evaluate(s))/Math.LN2],sin:[st,[st],(s,[n])=>Math.sin(n.evaluate(s))],cos:[st,[st],(s,[n])=>Math.cos(n.evaluate(s))],tan:[st,[st],(s,[n])=>Math.tan(n.evaluate(s))],asin:[st,[st],(s,[n])=>Math.asin(n.evaluate(s))],acos:[st,[st],(s,[n])=>Math.acos(n.evaluate(s))],atan:[st,[st],(s,[n])=>Math.atan(n.evaluate(s))],min:[st,$s(st),(s,n)=>Math.min(...n.map(a=>a.evaluate(s)))],max:[st,$s(st),(s,n)=>Math.max(...n.map(a=>a.evaluate(s)))],abs:[st,[st],(s,[n])=>Math.abs(n.evaluate(s))],round:[st,[st],(s,[n])=>{const a=n.evaluate(s);return a<0?-Math.round(-a):Math.round(a)}],floor:[st,[st],(s,[n])=>Math.floor(n.evaluate(s))],ceil:[st,[st],(s,[n])=>Math.ceil(n.evaluate(s))],"filter-==":[Ut,[At,Vt],(s,[n,a])=>s.properties()[n.value]===a.value],"filter-id-==":[Ut,[Vt],(s,[n])=>s.id()===n.value],"filter-type-==":[Ut,[At],(s,[n])=>s.geometryType()===n.value],"filter-<":[Ut,[At,Vt],(s,[n,a])=>{const c=s.properties()[n.value],p=a.value;return typeof c==typeof p&&c<p}],"filter-id-<":[Ut,[Vt],(s,[n])=>{const a=s.id(),c=n.value;return typeof a==typeof c&&a<c}],"filter->":[Ut,[At,Vt],(s,[n,a])=>{const c=s.properties()[n.value],p=a.value;return typeof c==typeof p&&c>p}],"filter-id->":[Ut,[Vt],(s,[n])=>{const a=s.id(),c=n.value;return typeof a==typeof c&&a>c}],"filter-<=":[Ut,[At,Vt],(s,[n,a])=>{const c=s.properties()[n.value],p=a.value;return typeof c==typeof p&&c<=p}],"filter-id-<=":[Ut,[Vt],(s,[n])=>{const a=s.id(),c=n.value;return typeof a==typeof c&&a<=c}],"filter->=":[Ut,[At,Vt],(s,[n,a])=>{const c=s.properties()[n.value],p=a.value;return typeof c==typeof p&&c>=p}],"filter-id->=":[Ut,[Vt],(s,[n])=>{const a=s.id(),c=n.value;return typeof a==typeof c&&a>=c}],"filter-has":[Ut,[Vt],(s,[n])=>n.value in s.properties()],"filter-has-id":[Ut,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[Ut,[Or(At)],(s,[n])=>n.value.indexOf(s.geometryType())>=0],"filter-id-in":[Ut,[Or(Vt)],(s,[n])=>n.value.indexOf(s.id())>=0],"filter-in-small":[Ut,[At,Or(Vt)],(s,[n,a])=>a.value.indexOf(s.properties()[n.value])>=0],"filter-in-large":[Ut,[At,Or(Vt)],(s,[n,a])=>function(c,p,v,b){for(;v<=b;){const w=v+b>>1;if(p[w]===c)return!0;p[w]>c?b=w-1:v=w+1}return!1}(s.properties()[n.value],a.value,0,a.value.length-1)],all:{type:Ut,overloads:[[[Ut,Ut],(s,[n,a])=>n.evaluate(s)&&a.evaluate(s)],[$s(Ut),(s,n)=>{for(const a of n)if(!a.evaluate(s))return!1;return!0}]]},any:{type:Ut,overloads:[[[Ut,Ut],(s,[n,a])=>n.evaluate(s)||a.evaluate(s)],[$s(Ut),(s,n)=>{for(const a of n)if(a.evaluate(s))return!0;return!1}]]},"!":[Ut,[Ut],(s,[n])=>!n.evaluate(s)],"is-supported-script":[Ut,[At],(s,[n])=>{const a=s.globals&&s.globals.isSupportedScript;return!a||a(n.evaluate(s))}],upcase:[At,[At],(s,[n])=>n.evaluate(s).toUpperCase()],downcase:[At,[At],(s,[n])=>n.evaluate(s).toLowerCase()],concat:[At,$s(Vt),(s,n)=>n.map(a=>nl(a.evaluate(s))).join("")],"resolved-locale":[At,[Ii],(s,[n])=>n.evaluate(s).resolvedLocale()]});class vc{constructor(n,a){var c;this.expression=n,this._warningHistory={},this._evaluator=new li,this._defaultValue=a?(c=a).type==="color"&&yc(c.default)?new Pn(0,0,0,0):c.type==="color"?Pn.parse(c.default)||null:c.type==="padding"?Wi.parse(c.default)||null:c.type==="variableAnchorOffsetCollection"?mr.parse(c.default)||null:c.type==="projectionDefinition"?_r.parse(c.default)||null:c.default===void 0?null:c.default:null,this._enumValues=a&&a.type==="enum"?a.values:null}evaluateWithoutErrorHandling(n,a,c,p,v,b){return this._evaluator.globals=n,this._evaluator.feature=a,this._evaluator.featureState=c,this._evaluator.canonical=p,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=b,this.expression.evaluate(this._evaluator)}evaluate(n,a,c,p,v,b){this._evaluator.globals=n,this._evaluator.feature=a||null,this._evaluator.featureState=c||null,this._evaluator.canonical=p,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=b||null;try{const w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new bi(`Expected value to be one of ${Object.keys(this._enumValues).map(C=>JSON.stringify(C)).join(", ")}, but found ${JSON.stringify(w)} instead.`);return w}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console<"u"&&console.warn(w.message)),this._defaultValue}}}function bc(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in bo}function xc(s,n){const a=new go(bo,mc,[],n?function(p){const v={color:Cn,string:At,number:st,enum:At,boolean:Ut,formatted:cs,padding:qi,projectionDefinition:zn,resolvedImage:Vi,variableAnchorOffsetCollection:hi};return p.type==="array"?Or(v[p.value]||Vt,p.length):v[p.type]}(n):void 0),c=a.parse(s,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return c?uf(new vc(c,n)):xo(a.errors)}class So{constructor(n,a){this.kind=n,this._styleExpression=a,this.isStateDependent=n!=="constant"&&!fl(a.expression)}evaluateWithoutErrorHandling(n,a,c,p,v,b){return this._styleExpression.evaluateWithoutErrorHandling(n,a,c,p,v,b)}evaluate(n,a,c,p,v,b){return this._styleExpression.evaluate(n,a,c,p,v,b)}}class wc{constructor(n,a,c,p){this.kind=n,this.zoomStops=c,this._styleExpression=a,this.isStateDependent=n!=="camera"&&!fl(a.expression),this.interpolationType=p}evaluateWithoutErrorHandling(n,a,c,p,v,b){return this._styleExpression.evaluateWithoutErrorHandling(n,a,c,p,v,b)}evaluate(n,a,c,p,v,b){return this._styleExpression.evaluate(n,a,c,p,v,b)}interpolationFactor(n,a,c){return this.interpolationType?ti.interpolationFactor(this.interpolationType,n,a,c):0}}function pf(s,n){const a=xc(s,n);if(a.result==="error")return a;const c=a.value.expression,p=gc(c);if(!p&&!wo(n))return xo([new Tt("","data expressions not supported")]);const v=_c(c,["zoom"]);if(!v&&!df(n))return xo([new Tt("","zoom expressions not supported")]);const b=Cc(c);return b||v?b instanceof Tt?xo([b]):b instanceof ti&&!Qu(n)?xo([new Tt("",'"interpolate" expressions cannot be used with this property')]):uf(b?new wc(p?"camera":"composite",a.value,b.labels,b instanceof ti?b.interpolation:void 0):new So(p?"constant":"source",a.value)):xo([new Tt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Sc{constructor(n,a){this._parameters=n,this._specification=a,kt(this,hf(this._parameters,this._specification))}static deserialize(n){return new Sc(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function Cc(s){let n=null;if(s instanceof Rn)n=Cc(s.result);else if(s instanceof Bs){for(const a of s.args)if(n=Cc(a),n)break}else(s instanceof Ls||s instanceof ti)&&s.input instanceof ea&&s.input.name==="zoom"&&(n=s);return n instanceof Tt||s.eachChild(a=>{const c=Cc(a);c instanceof Tt?n=c:!n&&c?n=new Tt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&c&&n!==c&&(n=new Tt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}function td(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const n of s.slice(1))if(!td(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}const tg={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Tc(s){if(s==null)return{filter:()=>!0,needGeometry:!1};td(s)||(s=Pc(s));const n=xc(s,tg);if(n.result==="error")throw new Error(n.value.map(a=>`${a.key}: ${a.message}`).join(", "));return{filter:(a,c,p)=>n.value.evaluate(a,c,{},p),needGeometry:gf(s)}}function mf(s,n){return s<n?-1:s>n?1:0}function gf(s){if(!Array.isArray(s))return!1;if(s[0]==="within"||s[0]==="distance")return!0;for(let n=1;n<s.length;n++)if(gf(s[n]))return!0;return!1}function Pc(s){if(!s)return!0;const n=s[0];return s.length<=1?n!=="any":n==="=="?kc(s[1],s[2],"=="):n==="!="?ml(kc(s[1],s[2],"==")):n==="<"||n===">"||n==="<="||n===">="?kc(s[1],s[2],n):n==="any"?(a=s.slice(1),["any"].concat(a.map(Pc))):n==="all"?["all"].concat(s.slice(1).map(Pc)):n==="none"?["all"].concat(s.slice(1).map(Pc).map(ml)):n==="in"?nd(s[1],s.slice(2)):n==="!in"?ml(nd(s[1],s.slice(2))):n==="has"?id(s[1]):n!=="!has"||ml(id(s[1]));var a}function kc(s,n,a){switch(s){case"$type":return[`filter-type-${a}`,n];case"$id":return[`filter-id-${a}`,n];default:return[`filter-${a}`,s,n]}}function nd(s,n){if(n.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(a=>typeof a!=typeof n[0])?["filter-in-large",s,["literal",n.sort(mf)]]:["filter-in-small",s,["literal",n]]}}function id(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function ml(s){return["!",s]}function gl(s){const n=typeof s;if(n==="number"||n==="boolean"||n==="string"||s==null)return JSON.stringify(s);if(Array.isArray(s)){let p="[";for(const v of s)p+=`${gl(v)},`;return`${p}]`}const a=Object.keys(s).sort();let c="{";for(let p=0;p<a.length;p++)c+=`${JSON.stringify(a[p])}:${gl(s[a[p]])},`;return`${c}}`}function rd(s){let n="";for(const a of W)n+=`/${gl(s[a])}`;return n}function Ic(s){const n=s.value;return n?[new Be(s.key,n,"constants have been deprecated as of v8")]:[]}function pi(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function js(s){if(Array.isArray(s))return s.map(js);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const n={};for(const a in s)n[a]=js(s[a]);return n}return pi(s)}function ta(s){const n=s.key,a=s.value,c=s.valueSpec||{},p=s.objectElementValidators||{},v=s.style,b=s.styleSpec,w=s.validateSpec;let C=[];const M=Fn(a);if(M!=="object")return[new Be(n,a,`object expected, ${M} found`)];for(const R in a){const L=R.split(".")[0],$=c[L]||c["*"];let H;if(p[L])H=p[L];else if(c[L])H=w;else if(p["*"])H=p["*"];else{if(!c["*"]){C.push(new Be(n,a[R],`unknown property "${R}"`));continue}H=w}C=C.concat(H({key:(n&&`${n}.`)+R,value:a[R],valueSpec:$,style:v,styleSpec:b,object:a,objectKey:R,validateSpec:w},a))}for(const R in c)p[R]||c[R].required&&c[R].default===void 0&&a[R]===void 0&&C.push(new Be(n,a,`missing required property "${R}"`));return C}function ad(s){const n=s.value,a=s.valueSpec,c=s.style,p=s.styleSpec,v=s.key,b=s.arrayElementValidator||s.validateSpec;if(Fn(n)!=="array")return[new Be(v,n,`array expected, ${Fn(n)} found`)];if(a.length&&n.length!==a.length)return[new Be(v,n,`array length ${a.length} expected, length ${n.length} found`)];if(a["min-length"]&&n.length<a["min-length"])return[new Be(v,n,`array length at least ${a["min-length"]} expected, length ${n.length} found`)];let w={type:a.value,values:a.values};p.$version<7&&(w.function=a.function),Fn(a.value)==="object"&&(w=a.value);let C=[];for(let M=0;M<n.length;M++)C=C.concat(b({array:n,arrayIndex:M,value:n[M],valueSpec:w,validateSpec:s.validateSpec,style:c,styleSpec:p,key:`${v}[${M}]`}));return C}function sd(s){const n=s.key,a=s.value,c=s.valueSpec;let p=Fn(a);return p==="number"&&a!=a&&(p="NaN"),p!=="number"?[new Be(n,a,`number expected, ${p} found`)]:"minimum"in c&&a<c.minimum?[new Be(n,a,`${a} is less than the minimum value ${c.minimum}`)]:"maximum"in c&&a>c.maximum?[new Be(n,a,`${a} is greater than the maximum value ${c.maximum}`)]:[]}function _f(s){const n=s.valueSpec,a=pi(s.value.type);let c,p,v,b={};const w=a!=="categorical"&&s.value.property===void 0,C=!w,M=Fn(s.value.stops)==="array"&&Fn(s.value.stops[0])==="array"&&Fn(s.value.stops[0][0])==="object",R=ta({key:s.key,value:s.value,valueSpec:s.styleSpec.function,validateSpec:s.validateSpec,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(H){if(a==="identity")return[new Be(H.key,H.value,'identity function may not have a "stops" property')];let q=[];const Y=H.value;return q=q.concat(ad({key:H.key,value:Y,valueSpec:H.valueSpec,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,arrayElementValidator:L})),Fn(Y)==="array"&&Y.length===0&&q.push(new Be(H.key,Y,"array must have at least one stop")),q},default:function(H){return H.validateSpec({key:H.key,value:H.value,valueSpec:n,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec})}}});return a==="identity"&&w&&R.push(new Be(s.key,s.value,'missing required property "property"')),a==="identity"||s.value.stops||R.push(new Be(s.key,s.value,'missing required property "stops"')),a==="exponential"&&s.valueSpec.expression&&!Qu(s.valueSpec)&&R.push(new Be(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(C&&!wo(s.valueSpec)?R.push(new Be(s.key,s.value,"property functions not supported")):w&&!df(s.valueSpec)&&R.push(new Be(s.key,s.value,"zoom functions not supported"))),a!=="categorical"&&!M||s.value.property!==void 0||R.push(new Be(s.key,s.value,'"property" property is required')),R;function L(H){let q=[];const Y=H.value,re=H.key;if(Fn(Y)!=="array")return[new Be(re,Y,`array expected, ${Fn(Y)} found`)];if(Y.length!==2)return[new Be(re,Y,`array length 2 expected, length ${Y.length} found`)];if(M){if(Fn(Y[0])!=="object")return[new Be(re,Y,`object expected, ${Fn(Y[0])} found`)];if(Y[0].zoom===void 0)return[new Be(re,Y,"object stop key must have zoom")];if(Y[0].value===void 0)return[new Be(re,Y,"object stop key must have value")];if(v&&v>pi(Y[0].zoom))return[new Be(re,Y[0].zoom,"stop zoom values must appear in ascending order")];pi(Y[0].zoom)!==v&&(v=pi(Y[0].zoom),p=void 0,b={}),q=q.concat(ta({key:`${re}[0]`,value:Y[0],valueSpec:{zoom:{}},validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,objectElementValidators:{zoom:sd,value:$}}))}else q=q.concat($({key:`${re}[0]`,value:Y[0],valueSpec:{},validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec},Y));return bc(js(Y[1]))?q.concat([new Be(`${re}[1]`,Y[1],"expressions are not allowed in function stops.")]):q.concat(H.validateSpec({key:`${re}[1]`,value:Y[1],valueSpec:n,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec}))}function $(H,q){const Y=Fn(H.value),re=pi(H.value),de=H.value!==null?H.value:q;if(c){if(Y!==c)return[new Be(H.key,de,`${Y} stop domain type must match previous stop domain type ${c}`)]}else c=Y;if(Y!=="number"&&Y!=="string"&&Y!=="boolean")return[new Be(H.key,de,"stop domain value must be a number, string, or boolean")];if(Y!=="number"&&a!=="categorical"){let ze=`number expected, ${Y} found`;return wo(n)&&a===void 0&&(ze+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Be(H.key,de,ze)]}return a!=="categorical"||Y!=="number"||isFinite(re)&&Math.floor(re)===re?a!=="categorical"&&Y==="number"&&p!==void 0&&re<p?[new Be(H.key,de,"stop domain values must appear in ascending order")]:(p=re,a==="categorical"&&re in b?[new Be(H.key,de,"stop domain values must be unique")]:(b[re]=!0,[])):[new Be(H.key,de,`integer expected, found ${re}`)]}}function Co(s){const n=(s.expressionContext==="property"?pf:xc)(js(s.value),s.valueSpec);if(n.result==="error")return n.value.map(c=>new Be(`${s.key}${c.key}`,s.value,c.message));const a=n.value.expression||n.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!a.outputDefined())return[new Be(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!fl(a))return[new Be(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter"&&!fl(a))return[new Be(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!_c(a,["zoom","feature-state"]))return[new Be(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!gc(a))return[new Be(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function To(s){const n=s.key,a=s.value,c=s.valueSpec,p=[];return Array.isArray(c.values)?c.values.indexOf(pi(a))===-1&&p.push(new Be(n,a,`expected one of [${c.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(c.values).indexOf(pi(a))===-1&&p.push(new Be(n,a,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(a)} found`)),p}function Mc(s){return td(js(s.value))?Co(kt({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):_l(s)}function _l(s){const n=s.value,a=s.key;if(Fn(n)!=="array")return[new Be(a,n,`array expected, ${Fn(n)} found`)];const c=s.styleSpec;let p,v=[];if(n.length<1)return[new Be(a,n,"filter array must have at least 1 element")];switch(v=v.concat(To({key:`${a}[0]`,value:n[0],valueSpec:c.filter_operator,style:s.style,styleSpec:s.styleSpec})),pi(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&pi(n[1])==="$type"&&v.push(new Be(a,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&v.push(new Be(a,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(p=Fn(n[1]),p!=="string"&&v.push(new Be(`${a}[1]`,n[1],`string expected, ${p} found`)));for(let b=2;b<n.length;b++)p=Fn(n[b]),pi(n[1])==="$type"?v=v.concat(To({key:`${a}[${b}]`,value:n[b],valueSpec:c.geometry_type,style:s.style,styleSpec:s.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&v.push(new Be(`${a}[${b}]`,n[b],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let b=1;b<n.length;b++)v=v.concat(_l({key:`${a}[${b}]`,value:n[b],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":p=Fn(n[1]),n.length!==2?v.push(new Be(a,n,`filter array for "${n[0]}" operator must have 2 elements`)):p!=="string"&&v.push(new Be(`${a}[1]`,n[1],`string expected, ${p} found`))}return v}function yf(s,n){const a=s.key,c=s.validateSpec,p=s.style,v=s.styleSpec,b=s.value,w=s.objectKey,C=v[`${n}_${s.layerType}`];if(!C)return[];const M=w.match(/^(.*)-transition$/);if(n==="paint"&&M&&C[M[1]]&&C[M[1]].transition)return c({key:a,value:b,valueSpec:v.transition,style:p,styleSpec:v});const R=s.valueSpec||C[w];if(!R)return[new Be(a,b,`unknown property "${w}"`)];let L;if(Fn(b)==="string"&&wo(R)&&!R.tokens&&(L=/^{([^}]+)}$/.exec(b)))return[new Be(a,b,`"${w}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(L[1])} }\`.`)];const $=[];return s.layerType==="symbol"&&(w==="text-field"&&p&&!p.glyphs&&$.push(new Be(a,b,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&yc(js(b))&&pi(b.type)==="identity"&&$.push(new Be(a,b,'"text-font" does not support identity functions'))),$.concat(c({key:s.key,value:b,valueSpec:R,style:p,styleSpec:v,expressionContext:"property",propertyType:n,propertyKey:w}))}function od(s){return yf(s,"paint")}function ld(s){return yf(s,"layout")}function vf(s){let n=[];const a=s.value,c=s.key,p=s.style,v=s.styleSpec;a.type||a.ref||n.push(new Be(c,a,'either "type" or "ref" is required'));let b=pi(a.type);const w=pi(a.ref);if(a.id){const C=pi(a.id);for(let M=0;M<s.arrayIndex;M++){const R=p.layers[M];pi(R.id)===C&&n.push(new Be(c,a.id,`duplicate layer id "${a.id}", previously used at line ${R.id.__line__}`))}}if("ref"in a){let C;["type","source","source-layer","filter","layout"].forEach(M=>{M in a&&n.push(new Be(c,a[M],`"${M}" is prohibited for ref layers`))}),p.layers.forEach(M=>{pi(M.id)===w&&(C=M)}),C?C.ref?n.push(new Be(c,a.ref,"ref cannot reference another ref layer")):b=pi(C.type):n.push(new Be(c,a.ref,`ref layer "${w}" not found`))}else if(b!=="background")if(a.source){const C=p.sources&&p.sources[a.source],M=C&&pi(C.type);C?M==="vector"&&b==="raster"?n.push(new Be(c,a.source,`layer "${a.id}" requires a raster source`)):M!=="raster-dem"&&b==="hillshade"?n.push(new Be(c,a.source,`layer "${a.id}" requires a raster-dem source`)):M==="raster"&&b!=="raster"?n.push(new Be(c,a.source,`layer "${a.id}" requires a vector source`)):M!=="vector"||a["source-layer"]?M==="raster-dem"&&b!=="hillshade"?n.push(new Be(c,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):b!=="line"||!a.paint||!a.paint["line-gradient"]||M==="geojson"&&C.lineMetrics||n.push(new Be(c,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new Be(c,a,`layer "${a.id}" must specify a "source-layer"`)):n.push(new Be(c,a.source,`source "${a.source}" not found`))}else n.push(new Be(c,a,'missing required property "source"'));return n=n.concat(ta({key:c,value:a,valueSpec:v.layer,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,objectElementValidators:{"*":()=>[],type:()=>s.validateSpec({key:`${c}.type`,value:a.type,valueSpec:v.layer.type,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,object:a,objectKey:"type"}),filter:Mc,layout:C=>ta({layer:a,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,objectElementValidators:{"*":M=>ld(kt({layerType:b},M))}}),paint:C=>ta({layer:a,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,objectElementValidators:{"*":M=>od(kt({layerType:b},M))}})}})),n}function hs(s){const n=s.value,a=s.key,c=Fn(n);return c!=="string"?[new Be(a,n,`string expected, ${c} found`)]:[]}const cd={promoteId:function({key:s,value:n}){if(Fn(n)==="string")return hs({key:s,value:n});{const a=[];for(const c in n)a.push(...hs({key:`${s}.${c}`,value:n[c]}));return a}}};function Po(s){const n=s.value,a=s.key,c=s.styleSpec,p=s.style,v=s.validateSpec;if(!n.type)return[new Be(a,n,'"type" is required')];const b=pi(n.type);let w;switch(b){case"vector":case"raster":return w=ta({key:a,value:n,valueSpec:c[`source_${b.replace("-","_")}`],style:s.style,styleSpec:c,objectElementValidators:cd,validateSpec:v}),w;case"raster-dem":return w=function(C){var M;const R=(M=C.sourceName)!==null&&M!==void 0?M:"",L=C.value,$=C.styleSpec,H=$.source_raster_dem,q=C.style;let Y=[];const re=Fn(L);if(L===void 0)return Y;if(re!=="object")return Y.push(new Be("source_raster_dem",L,`object expected, ${re} found`)),Y;const de=pi(L.encoding)==="custom",ze=["redFactor","greenFactor","blueFactor","baseShift"],_e=C.value.encoding?`"${C.value.encoding}"`:"Default";for(const G in L)!de&&ze.includes(G)?Y.push(new Be(G,L[G],`In "${R}": "${G}" is only valid when "encoding" is set to "custom". ${_e} encoding found`)):H[G]?Y=Y.concat(C.validateSpec({key:G,value:L[G],valueSpec:H[G],validateSpec:C.validateSpec,style:q,styleSpec:$})):Y.push(new Be(G,L[G],`unknown property "${G}"`));return Y}({sourceName:a,value:n,style:s.style,styleSpec:c,validateSpec:v}),w;case"geojson":if(w=ta({key:a,value:n,valueSpec:c.source_geojson,style:p,styleSpec:c,validateSpec:v,objectElementValidators:cd}),n.cluster)for(const C in n.clusterProperties){const[M,R]=n.clusterProperties[C],L=typeof M=="string"?[M,["accumulated"],["get",C]]:M;w.push(...Co({key:`${a}.${C}.map`,value:R,validateSpec:v,expressionContext:"cluster-map"})),w.push(...Co({key:`${a}.${C}.reduce`,value:L,validateSpec:v,expressionContext:"cluster-reduce"}))}return w;case"video":return ta({key:a,value:n,valueSpec:c.source_video,style:p,validateSpec:v,styleSpec:c});case"image":return ta({key:a,value:n,valueSpec:c.source_image,style:p,validateSpec:v,styleSpec:c});case"canvas":return[new Be(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return To({key:`${a}.type`,value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:p,validateSpec:v,styleSpec:c})}}function bf(s){const n=s.value,a=s.styleSpec,c=a.light,p=s.style;let v=[];const b=Fn(n);if(n===void 0)return v;if(b!=="object")return v=v.concat([new Be("light",n,`object expected, ${b} found`)]),v;for(const w in n){const C=w.match(/^(.*)-transition$/);v=v.concat(C&&c[C[1]]&&c[C[1]].transition?s.validateSpec({key:w,value:n[w],valueSpec:a.transition,validateSpec:s.validateSpec,style:p,styleSpec:a}):c[w]?s.validateSpec({key:w,value:n[w],valueSpec:c[w],validateSpec:s.validateSpec,style:p,styleSpec:a}):[new Be(w,n[w],`unknown property "${w}"`)])}return v}function xf(s){const n=s.value,a=s.styleSpec,c=a.sky,p=s.style,v=Fn(n);if(n===void 0)return[];if(v!=="object")return[new Be("sky",n,`object expected, ${v} found`)];let b=[];for(const w in n)b=b.concat(c[w]?s.validateSpec({key:w,value:n[w],valueSpec:c[w],style:p,styleSpec:a}):[new Be(w,n[w],`unknown property "${w}"`)]);return b}function wf(s){const n=s.value,a=s.styleSpec,c=a.terrain,p=s.style;let v=[];const b=Fn(n);if(n===void 0)return v;if(b!=="object")return v=v.concat([new Be("terrain",n,`object expected, ${b} found`)]),v;for(const w in n)v=v.concat(c[w]?s.validateSpec({key:w,value:n[w],valueSpec:c[w],validateSpec:s.validateSpec,style:p,styleSpec:a}):[new Be(w,n[w],`unknown property "${w}"`)]);return v}function Sf(s){let n=[];const a=s.value,c=s.key;if(Array.isArray(a)){const p=[],v=[];for(const b in a)a[b].id&&p.includes(a[b].id)&&n.push(new Be(c,a,`all the sprites' ids must be unique, but ${a[b].id} is duplicated`)),p.push(a[b].id),a[b].url&&v.includes(a[b].url)&&n.push(new Be(c,a,`all the sprites' URLs must be unique, but ${a[b].url} is duplicated`)),v.push(a[b].url),n=n.concat(ta({key:`${c}[${b}]`,value:a[b],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:s.validateSpec}));return n}return hs({key:c,value:a})}const Cf={"*":()=>[],array:ad,boolean:function(s){const n=s.value,a=s.key,c=Fn(n);return c!=="boolean"?[new Be(a,n,`boolean expected, ${c} found`)]:[]},number:sd,color:function(s){const n=s.key,a=s.value,c=Fn(a);return c!=="string"?[new Be(n,a,`color expected, ${c} found`)]:Pn.parse(String(a))?[]:[new Be(n,a,`color expected, "${a}" found`)]},constants:Ic,enum:To,filter:Mc,function:_f,layer:vf,object:ta,source:Po,light:bf,sky:xf,terrain:wf,projection:function(s){const n=s.value,a=s.styleSpec,c=a.projection,p=s.style,v=Fn(n);if(n===void 0)return[];if(v!=="object")return[new Be("projection",n,`object expected, ${v} found`)];let b=[];for(const w in n)b=b.concat(c[w]?s.validateSpec({key:w,value:n[w],valueSpec:c[w],style:p,styleSpec:a}):[new Be(w,n[w],`unknown property "${w}"`)]);return b},projectionDefinition:function(s){const n=s.key;let a=s.value;a=a instanceof String?a.valueOf():a;const c=Fn(a);return c!=="array"||function(p){return Array.isArray(p)&&p.length===3&&typeof p[0]=="string"&&typeof p[1]=="string"&&typeof p[2]=="number"}(a)||function(p){return!!["interpolate","step","literal"].includes(p[0])}(a)?["array","string"].includes(c)?[]:[new Be(n,a,`projection expected, invalid type "${c}" found`)]:[new Be(n,a,`projection expected, invalid array ${JSON.stringify(a)} found`)]},string:hs,formatted:function(s){return hs(s).length===0?[]:Co(s)},resolvedImage:function(s){return hs(s).length===0?[]:Co(s)},padding:function(s){const n=s.key,a=s.value;if(Fn(a)==="array"){if(a.length<1||a.length>4)return[new Be(n,a,`padding requires 1 to 4 values; ${a.length} values found`)];const c={type:"number"};let p=[];for(let v=0;v<a.length;v++)p=p.concat(s.validateSpec({key:`${n}[${v}]`,value:a[v],validateSpec:s.validateSpec,valueSpec:c}));return p}return sd({key:n,value:a,valueSpec:{}})},variableAnchorOffsetCollection:function(s){const n=s.key,a=s.value,c=Fn(a),p=s.styleSpec;if(c!=="array"||a.length<1||a.length%2!=0)return[new Be(n,a,"variableAnchorOffsetCollection requires a non-empty array of even length")];let v=[];for(let b=0;b<a.length;b+=2)v=v.concat(To({key:`${n}[${b}]`,value:a[b],valueSpec:p.layout_symbol["text-anchor"]})),v=v.concat(ad({key:`${n}[${b+1}]`,value:a[b+1],valueSpec:{length:2,value:"number"},validateSpec:s.validateSpec,style:s.style,styleSpec:p}));return v},sprite:Sf};function yl(s){const n=s.value,a=s.valueSpec,c=s.styleSpec;return s.validateSpec=yl,a.expression&&yc(pi(n))?_f(s):a.expression&&bc(js(n))?Co(s):a.type&&Cf[a.type]?Cf[a.type](s):ta(kt({},s,{valueSpec:a.type?c[a.type]:a}))}function ko(s){const n=s.value,a=s.key,c=hs(s);return c.length||(n.indexOf("{fontstack}")===-1&&c.push(new Be(a,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&c.push(new Be(a,n,'"glyphs" url must include a "{range}" token'))),c}function wr(s,n=ae){let a=[];return a=a.concat(yl({key:"",value:s,valueSpec:n.$root,styleSpec:n,style:s,validateSpec:yl,objectElementValidators:{glyphs:ko,"*":()=>[]}})),s.constants&&(a=a.concat(Ic({key:"constants",value:s.constants,style:s,styleSpec:n,validateSpec:yl}))),Io(a)}function Ri(s){return function(n){return s({...n,validateSpec:yl})}}function Io(s){return[].concat(s).sort((n,a)=>n.line-a.line)}function pa(s){return function(...n){return Io(s.apply(this,n))}}wr.source=pa(Ri(Po)),wr.sprite=pa(Ri(Sf)),wr.glyphs=pa(Ri(ko)),wr.light=pa(Ri(bf)),wr.sky=pa(Ri(xf)),wr.terrain=pa(Ri(wf)),wr.layer=pa(Ri(vf)),wr.filter=pa(Ri(Mc)),wr.paintProperty=pa(Ri(od)),wr.layoutProperty=pa(Ri(ld));const Mo=wr,ng=Mo.light,vl=Mo.sky,Tf=Mo.paintProperty,ud=Mo.layoutProperty;function Pf(s,n){let a=!1;if(n&&n.length)for(const c of n)s.fire(new Zi(new Error(c.message))),a=!0;return a}class Us{constructor(n,a,c){const p=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;const b=new Int32Array(this.arrayBuffer);n=b[0],this.d=(a=b[1])+2*(c=b[2]);for(let C=0;C<this.d*this.d;C++){const M=b[3+C],R=b[3+C+1];p.push(M===R?null:b.subarray(M,R))}const w=b[3+p.length+1];this.keys=b.subarray(b[3+p.length],w),this.bboxes=b.subarray(w),this.insert=this._insertReadonly}else{this.d=a+2*c;for(let b=0;b<this.d*this.d;b++)p.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=n,this.padding=c,this.scale=a/n,this.uid=0;const v=c/a*n;this.min=-v,this.max=n+v}insert(n,a,c,p,v){this._forEachCell(a,c,p,v,this._insertCell,this.uid++,void 0,void 0),this.keys.push(n),this.bboxes.push(a),this.bboxes.push(c),this.bboxes.push(p),this.bboxes.push(v)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(n,a,c,p,v,b){this.cells[v].push(b)}query(n,a,c,p,v){const b=this.min,w=this.max;if(n<=b&&a<=b&&w<=c&&w<=p&&!v)return Array.prototype.slice.call(this.keys);{const C=[];return this._forEachCell(n,a,c,p,this._queryCell,C,{},v),C}}_queryCell(n,a,c,p,v,b,w,C){const M=this.cells[v];if(M!==null){const R=this.keys,L=this.bboxes;for(let $=0;$<M.length;$++){const H=M[$];if(w[H]===void 0){const q=4*H;(C?C(L[q+0],L[q+1],L[q+2],L[q+3]):n<=L[q+2]&&a<=L[q+3]&&c>=L[q+0]&&p>=L[q+1])?(w[H]=!0,b.push(R[H])):w[H]=!1}}}}_forEachCell(n,a,c,p,v,b,w,C){const M=this._convertToCellCoord(n),R=this._convertToCellCoord(a),L=this._convertToCellCoord(c),$=this._convertToCellCoord(p);for(let H=M;H<=L;H++)for(let q=R;q<=$;q++){const Y=this.d*q+H;if((!C||C(this._convertFromCellCoord(H),this._convertFromCellCoord(q),this._convertFromCellCoord(H+1),this._convertFromCellCoord(q+1)))&&v.call(this,n,a,c,p,Y,b,w,C))return}}_convertFromCellCoord(n){return(n-this.padding)/this.scale}_convertToCellCoord(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const n=this.cells,a=3+this.cells.length+1+1;let c=0;for(let b=0;b<this.cells.length;b++)c+=this.cells[b].length;const p=new Int32Array(a+c+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;let v=a;for(let b=0;b<n.length;b++){const w=n[b];p[3+b]=v,p.set(w,v),v+=w.length}return p[3+n.length]=v,p.set(this.keys,v),v+=this.keys.length,p[3+n.length+1]=v,p.set(this.bboxes,v),v+=this.bboxes.length,p.buffer}static serialize(n,a){const c=n.toArrayBuffer();return a&&a.push(c),{buffer:c}}static deserialize(n){return new Us(n.buffer)}}const Za={};function Ft(s,n,a={}){if(Za[s])throw new Error(`${s} is already registered.`);Object.defineProperty(n,"_classRegistryKey",{value:s,writeable:!1}),Za[s]={klass:n,omit:a.omit||[],shallow:a.shallow||[]}}Ft("Object",Object),Ft("TransferableGridIndex",Us),Ft("Color",Pn),Ft("Error",Error),Ft("AJAXError",dn),Ft("ResolvedImage",gr),Ft("StylePropertyFunction",Sc),Ft("StyleExpression",vc,{omit:["_evaluator"]}),Ft("ZoomDependentExpression",wc),Ft("ZoomConstantExpression",So),Ft("CompoundExpression",ea,{omit:["_evaluate"]});for(const s in bo)bo[s]._classRegistryKey||Ft(`Expression_${s}`,bo[s]);function kf(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function Gs(s){return s.$name||s.constructor._classRegistryKey}function If(s){return!function(n){if(n===null||typeof n!="object")return!1;const a=Gs(n);return!(!a||a==="Object")}(s)&&(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob||s instanceof Error||kf(s)||ot(s)||ArrayBuffer.isView(s)||s instanceof ImageData)}function bl(s,n){if(If(s))return(kf(s)||ot(s))&&n&&n.push(s),ArrayBuffer.isView(s)&&n&&n.push(s.buffer),s instanceof ImageData&&n&&n.push(s.data.buffer),s;if(Array.isArray(s)){const v=[];for(const b of s)v.push(bl(b,n));return v}if(typeof s!="object")throw new Error("can't serialize object of type "+typeof s);const a=Gs(s);if(!a)throw new Error(`can't serialize object of unregistered class ${s.constructor.name}`);if(!Za[a])throw new Error(`${a} is not registered.`);const{klass:c}=Za[a],p=c.serialize?c.serialize(s,n):{};if(c.serialize){if(n&&p===n[n.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const v in s){if(!s.hasOwnProperty(v)||Za[a].omit.indexOf(v)>=0)continue;const b=s[v];p[v]=Za[a].shallow.indexOf(v)>=0?b:bl(b,n)}s instanceof Error&&(p.message=s.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(p.$name=a),p}function fs(s){if(If(s))return s;if(Array.isArray(s))return s.map(fs);if(typeof s!="object")throw new Error("can't deserialize object of type "+typeof s);const n=Gs(s)||"Object";if(!Za[n])throw new Error(`can't deserialize unregistered class ${n}`);const{klass:a}=Za[n];if(!a)throw new Error(`can't deserialize unregistered class ${n}`);if(a.deserialize)return a.deserialize(s);const c=Object.create(a.prototype);for(const p of Object.keys(s)){if(p==="$name")continue;const v=s[p];c[p]=Za[n].shallow.indexOf(p)>=0?v:fs(v)}return c}class Mf{constructor(){this.first=!0}update(n,a){const c=Math.floor(n);return this.first?(this.first=!1,this.lastIntegerZoom=c,this.lastIntegerZoomTime=0,this.lastZoom=n,this.lastFloorZoom=c,!0):(this.lastFloorZoom>c?(this.lastIntegerZoom=c+1,this.lastIntegerZoomTime=a):this.lastFloorZoom<c&&(this.lastIntegerZoom=c,this.lastIntegerZoomTime=a),n!==this.lastZoom&&(this.lastZoom=n,this.lastFloorZoom=c,!0))}}const kn={"Latin-1 Supplement":s=>s>=128&&s<=255,"Hangul Jamo":s=>s>=4352&&s<=4607,Khmer:s=>s>=6016&&s<=6143,"General Punctuation":s=>s>=8192&&s<=8303,"Letterlike Symbols":s=>s>=8448&&s<=8527,"Number Forms":s=>s>=8528&&s<=8591,"Miscellaneous Technical":s=>s>=8960&&s<=9215,"Control Pictures":s=>s>=9216&&s<=9279,"Optical Character Recognition":s=>s>=9280&&s<=9311,"Enclosed Alphanumerics":s=>s>=9312&&s<=9471,"Geometric Shapes":s=>s>=9632&&s<=9727,"Miscellaneous Symbols":s=>s>=9728&&s<=9983,"Miscellaneous Symbols and Arrows":s=>s>=11008&&s<=11263,"Ideographic Description Characters":s=>s>=12272&&s<=12287,"CJK Symbols and Punctuation":s=>s>=12288&&s<=12351,Katakana:s=>s>=12448&&s<=12543,Kanbun:s=>s>=12688&&s<=12703,"CJK Strokes":s=>s>=12736&&s<=12783,"Enclosed CJK Letters and Months":s=>s>=12800&&s<=13055,"CJK Compatibility":s=>s>=13056&&s<=13311,"Yijing Hexagram Symbols":s=>s>=19904&&s<=19967,"Private Use Area":s=>s>=57344&&s<=63743,"Vertical Forms":s=>s>=65040&&s<=65055,"CJK Compatibility Forms":s=>s>=65072&&s<=65103,"Small Form Variants":s=>s>=65104&&s<=65135,"Halfwidth and Fullwidth Forms":s=>s>=65280&&s<=65519};function Eo(s){for(const n of s)if(Rc(n.charCodeAt(0)))return!0;return!1}function Ef(s){for(const n of s)if(!Rf(n.charCodeAt(0)))return!1;return!0}function Ec(s){const n=s.map(a=>{try{return new RegExp(`\\p{sc=${a}}`,"u").source}catch{return null}}).filter(a=>a);return new RegExp(n.join("|"),"u")}const Af=Ec(["Arab","Dupl","Mong","Ougr","Syrc"]);function Rf(s){return!Af.test(String.fromCodePoint(s))}const Ac=Ec(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Rc(s){return!(s!==746&&s!==747&&(s<4352||!(kn["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||kn["CJK Compatibility"](s)||kn["CJK Strokes"](s)||!(!kn["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||kn["Enclosed CJK Letters and Months"](s)||kn["Ideographic Description Characters"](s)||kn.Kanbun(s)||kn.Katakana(s)&&s!==12540||!(!kn["Halfwidth and Fullwidth Forms"](s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!kn["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||kn["Vertical Forms"](s)||kn["Yijing Hexagram Symbols"](s)||/\p{sc=Cans}/u.test(String.fromCodePoint(s))||/\p{sc=Hang}/u.test(String.fromCodePoint(s))||Ac.test(String.fromCodePoint(s)))))}function Df(s){return!(Rc(s)||function(n){return!!(kn["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||kn["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||kn["Letterlike Symbols"](n)||kn["Number Forms"](n)||kn["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||kn["Control Pictures"](n)&&n!==9251||kn["Optical Character Recognition"](n)||kn["Enclosed Alphanumerics"](n)||kn["Geometric Shapes"](n)||kn["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||kn["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||kn["CJK Symbols and Punctuation"](n)||kn.Katakana(n)||kn["Private Use Area"](n)||kn["CJK Compatibility Forms"](n)||kn["Small Form Variants"](n)||kn["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(s))}const zf=Ec(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Lf(s){return zf.test(String.fromCodePoint(s))}function Bf(s,n){return!(!n&&Lf(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||kn.Khmer(s))}function Ff(s){for(const n of s)if(Lf(n.charCodeAt(0)))return!0;return!1}const qa=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(s){this.pluginStatus=s.pluginStatus,this.pluginURL=s.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(s){if(qa.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=s.applyArabicShaping,this.processBidirectionalText=s.processBidirectionalText,this.processStyledBidirectionalText=s.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(s,n){return o(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(s.pluginStatus!=="loading")return this.setState(s),s;const a=s.pluginURL,c=new Promise(v=>{this.loadScriptResolve=v});n(a);const p=new Promise(v=>setTimeout(()=>v(),this.TIMEOUT));if(yield Promise.race([c,p]),this.isParsed()){const v={pluginStatus:"loaded",pluginURL:a};return this.setState(v),v}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${a}`)})}};class mi{constructor(n,a){this.zoom=n,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.zoomHistory=a.zoomHistory,this.transition=a.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Mf,this.transition={})}isSupportedScript(n){return function(a,c){for(const p of a)if(!Bf(p.charCodeAt(0),c))return!1;return!0}(n,qa.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const n=this.zoom,a=n-Math.floor(n),c=this.crossFadingFactor();return n>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:a+(1-a)*c}:{fromScale:.5,toScale:1,t:1-(1-c)*a}}}class Dc{constructor(n,a){this.property=n,this.value=a,this.expression=function(c,p){if(yc(c))return new Sc(c,p);if(bc(c)){const v=pf(c,p);if(v.result==="error")throw new Error(v.value.map(b=>`${b.key}: ${b.message}`).join(", "));return v.value}{let v=c;return p.type==="color"&&typeof c=="string"?v=Pn.parse(c):p.type!=="padding"||typeof c!="number"&&!Array.isArray(c)?p.type==="variableAnchorOffsetCollection"&&Array.isArray(c)?v=mr.parse(c):p.type==="projectionDefinition"&&typeof c=="string"&&(v=_r.parse(c)):v=Wi.parse(c),{kind:"constant",evaluate:()=>v}}}(a===void 0?n.specification.default:a,n.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,a,c){return this.property.possiblyEvaluate(this,n,a,c)}}class zc{constructor(n){this.property=n,this.value=new Dc(n,void 0)}transitioned(n,a){return new hd(this.property,this.value,a,Yt({},n.transition,this.transition),n.now)}untransitioned(){return new hd(this.property,this.value,null,{},0)}}class dd{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues)}getValue(n){return jn(this._values[n].value.value)}setValue(n,a){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new zc(this._values[n].property)),this._values[n].value=new Dc(this._values[n].property,a===null?void 0:jn(a))}getTransition(n){return jn(this._values[n].transition)}setTransition(n,a){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new zc(this._values[n].property)),this._values[n].transition=jn(a)||void 0}serialize(){const n={};for(const a of Object.keys(this._values)){const c=this.getValue(a);c!==void 0&&(n[a]=c);const p=this.getTransition(a);p!==void 0&&(n[`${a}-transition`]=p)}return n}transitioned(n,a){const c=new fd(this._properties);for(const p of Object.keys(this._values))c._values[p]=this._values[p].transitioned(n,a._values[p]);return c}untransitioned(){const n=new fd(this._properties);for(const a of Object.keys(this._values))n._values[a]=this._values[a].untransitioned();return n}}class hd{constructor(n,a,c,p,v){this.property=n,this.value=a,this.begin=v+p.delay||0,this.end=this.begin+p.duration||0,n.specification.transition&&(p.delay||p.duration)&&(this.prior=c)}possiblyEvaluate(n,a,c){const p=n.now||0,v=this.value.possiblyEvaluate(n,a,c),b=this.prior;if(b){if(p>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(p<this.begin)return b.possiblyEvaluate(n,a,c);{const w=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(n,a,c),v,Qe(w))}}return v}}class fd{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,a,c){const p=new Ao(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].possiblyEvaluate(n,a,c);return p}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class Lc{constructor(n){this._properties=n,this._values=Object.create(n.defaultPropertyValues)}hasValue(n){return this._values[n].value!==void 0}getValue(n){return jn(this._values[n].value)}setValue(n,a){this._values[n]=new Dc(this._values[n].property,a===null?void 0:jn(a))}serialize(){const n={};for(const a of Object.keys(this._values)){const c=this.getValue(a);c!==void 0&&(n[a]=c)}return n}possiblyEvaluate(n,a,c){const p=new Ao(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].possiblyEvaluate(n,a,c);return p}}class Ea{constructor(n,a,c){this.property=n,this.value=a,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,a,c,p){return this.property.evaluate(this.value,this.parameters,n,a,c,p)}}class Ao{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class Zt{constructor(n){this.specification=n}possiblyEvaluate(n,a){if(n.isDataDriven())throw new Error("Value should not be data driven");return n.expression.evaluate(a)}interpolate(n,a,c){const p=fa[this.specification.type];return p?p(n,a,c):n}}class sn{constructor(n,a){this.specification=n,this.overrides=a}possiblyEvaluate(n,a,c,p){return new Ea(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(a,null,{},c,p)}:n.expression,a)}interpolate(n,a,c){if(n.value.kind!=="constant"||a.value.kind!=="constant")return n;if(n.value.value===void 0||a.value.value===void 0)return new Ea(this,{kind:"constant",value:void 0},n.parameters);const p=fa[this.specification.type];if(p){const v=p(n.value.value,a.value.value,c);return new Ea(this,{kind:"constant",value:v},n.parameters)}return n}evaluate(n,a,c,p,v,b){return n.kind==="constant"?n.value:n.evaluate(a,c,p,v,b)}}class xl extends sn{possiblyEvaluate(n,a,c,p){if(n.value===void 0)return new Ea(this,{kind:"constant",value:void 0},a);if(n.expression.kind==="constant"){const v=n.expression.evaluate(a,null,{},c,p),b=n.property.specification.type==="resolvedImage"&&typeof v!="string"?v.name:v,w=this._calculate(b,b,b,a);return new Ea(this,{kind:"constant",value:w},a)}if(n.expression.kind==="camera"){const v=this._calculate(n.expression.evaluate({zoom:a.zoom-1}),n.expression.evaluate({zoom:a.zoom}),n.expression.evaluate({zoom:a.zoom+1}),a);return new Ea(this,{kind:"constant",value:v},a)}return new Ea(this,n.expression,a)}evaluate(n,a,c,p,v,b){if(n.kind==="source"){const w=n.evaluate(a,c,p,v,b);return this._calculate(w,w,w,a)}return n.kind==="composite"?this._calculate(n.evaluate({zoom:Math.floor(a.zoom)-1},c,p),n.evaluate({zoom:Math.floor(a.zoom)},c,p),n.evaluate({zoom:Math.floor(a.zoom)+1},c,p),a):n.value}_calculate(n,a,c,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:n,to:a}:{from:c,to:a}}interpolate(n){return n}}class Bc{constructor(n){this.specification=n}possiblyEvaluate(n,a,c,p){if(n.value!==void 0){if(n.expression.kind==="constant"){const v=n.expression.evaluate(a,null,{},c,p);return this._calculate(v,v,v,a)}return this._calculate(n.expression.evaluate(new mi(Math.floor(a.zoom-1),a)),n.expression.evaluate(new mi(Math.floor(a.zoom),a)),n.expression.evaluate(new mi(Math.floor(a.zoom+1),a)),a)}}_calculate(n,a,c,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:n,to:a}:{from:c,to:a}}interpolate(n){return n}}class Fc{constructor(n){this.specification=n}possiblyEvaluate(n,a,c,p){return!!n.expression.evaluate(a,null,{},c,p)}interpolate(){return!1}}class Ar{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const a in n){const c=n[a];c.specification.overridable&&this.overridableProperties.push(a);const p=this.defaultPropertyValues[a]=new Dc(c,void 0),v=this.defaultTransitionablePropertyValues[a]=new zc(c);this.defaultTransitioningPropertyValues[a]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=p.possiblyEvaluate({})}}}Ft("DataDrivenProperty",sn),Ft("DataConstantProperty",Zt),Ft("CrossFadedDataDrivenProperty",xl),Ft("CrossFadedProperty",Bc),Ft("ColorRampProperty",Fc);const Of="-transition";class Aa extends Er{constructor(n,a){if(super(),this.id=n.id,this.type=n.type,this._featureFilter={filter:()=>!0,needGeometry:!1},n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),a.layout&&(this._unevaluatedLayout=new Lc(a.layout)),a.paint)){this._transitionablePaint=new dd(a.paint);for(const c in n.paint)this.setPaintProperty(c,n.paint[c],{validate:!1});for(const c in n.layout)this.setLayoutProperty(c,n.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ao(a.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,a,c={}){a!=null&&this._validate(ud,`layers.${this.id}.layout.${n}`,n,a,c)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,a):this.visibility=a)}getPaintProperty(n){return n.endsWith(Of)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,a,c={}){if(a!=null&&this._validate(Tf,`layers.${this.id}.paint.${n}`,n,a,c))return!1;if(n.endsWith(Of))return this._transitionablePaint.setTransition(n.slice(0,-11),a||void 0),!1;{const p=this._transitionablePaint._values[n],v=p.property.specification["property-type"]==="cross-faded-data-driven",b=p.value.isDataDriven(),w=p.value;this._transitionablePaint.setValue(n,a),this._handleSpecialPaintPropertyUpdate(n);const C=this._transitionablePaint._values[n].value;return C.isDataDriven()||b||v||this._handleOverridablePaintPropertyUpdate(n,w,C)}}_handleSpecialPaintPropertyUpdate(n){}_handleOverridablePaintPropertyUpdate(n,a,c){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,a){n.getCrossfadeParameters&&(this._crossfadeParameters=n.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,a)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),bn(n,(a,c)=>!(a===void 0||c==="layout"&&!Object.keys(a).length||c==="paint"&&!Object.keys(a).length))}_validate(n,a,c,p,v={}){return(!v||v.validate!==!1)&&Pf(this,n.call(Mo,{key:a,layerType:this.type,objectKey:c,value:p,styleSpec:ae,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const a=this.paint.get(n);if(a instanceof Ea&&wo(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}}const ig={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class wl{constructor(n,a){this._structArray=n,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ni{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,a){return n._trim(),a&&(n.isTransferred=!0,a.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const a=Object.create(this.prototype);return a.arrayBuffer=n.arrayBuffer,a.length=n.length,a.capacity=n.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function zi(s,n=1){let a=0,c=0;return{members:s.map(p=>{const v=ig[p.type].BYTES_PER_ELEMENT,b=a=Vf(a,Math.max(n,v)),w=p.components||1;return c=Math.max(c,v),a+=v*w,{name:p.name,type:p.type,components:w,offset:b}}),size:Vf(a,Math.max(c,n)),alignment:n}}function Vf(s,n){return Math.ceil(s/n)*n}class Sl extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a){const c=this.length;return this.resize(c+1),this.emplace(c,n,a)}emplace(n,a,c){const p=2*n;return this.int16[p+0]=a,this.int16[p+1]=c,n}}Sl.prototype.bytesPerElement=4,Ft("StructArrayLayout2i4",Sl);class Cl extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,c){const p=this.length;return this.resize(p+1),this.emplace(p,n,a,c)}emplace(n,a,c,p){const v=3*n;return this.int16[v+0]=a,this.int16[v+1]=c,this.int16[v+2]=p,n}}Cl.prototype.bytesPerElement=6,Ft("StructArrayLayout3i6",Cl);class pd extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,c,p){const v=this.length;return this.resize(v+1),this.emplace(v,n,a,c,p)}emplace(n,a,c,p,v){const b=4*n;return this.int16[b+0]=a,this.int16[b+1]=c,this.int16[b+2]=p,this.int16[b+3]=v,n}}pd.prototype.bytesPerElement=8,Ft("StructArrayLayout4i8",pd);class md extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,c,p,v,b){const w=this.length;return this.resize(w+1),this.emplace(w,n,a,c,p,v,b)}emplace(n,a,c,p,v,b,w){const C=6*n;return this.int16[C+0]=a,this.int16[C+1]=c,this.int16[C+2]=p,this.int16[C+3]=v,this.int16[C+4]=b,this.int16[C+5]=w,n}}md.prototype.bytesPerElement=12,Ft("StructArrayLayout2i4i12",md);class Wa extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,c,p,v,b){const w=this.length;return this.resize(w+1),this.emplace(w,n,a,c,p,v,b)}emplace(n,a,c,p,v,b,w){const C=4*n,M=8*n;return this.int16[C+0]=a,this.int16[C+1]=c,this.uint8[M+4]=p,this.uint8[M+5]=v,this.uint8[M+6]=b,this.uint8[M+7]=w,n}}Wa.prototype.bytesPerElement=8,Ft("StructArrayLayout2i4ub8",Wa);class Ro extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a){const c=this.length;return this.resize(c+1),this.emplace(c,n,a)}emplace(n,a,c){const p=2*n;return this.float32[p+0]=a,this.float32[p+1]=c,n}}Ro.prototype.bytesPerElement=8,Ft("StructArrayLayout2f8",Ro);class Tl extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,c,p,v,b,w,C,M,R){const L=this.length;return this.resize(L+1),this.emplace(L,n,a,c,p,v,b,w,C,M,R)}emplace(n,a,c,p,v,b,w,C,M,R,L){const $=10*n;return this.uint16[$+0]=a,this.uint16[$+1]=c,this.uint16[$+2]=p,this.uint16[$+3]=v,this.uint16[$+4]=b,this.uint16[$+5]=w,this.uint16[$+6]=C,this.uint16[$+7]=M,this.uint16[$+8]=R,this.uint16[$+9]=L,n}}Tl.prototype.bytesPerElement=20,Ft("StructArrayLayout10ui20",Tl);class Oc extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,c,p,v,b,w,C,M,R,L,$){const H=this.length;return this.resize(H+1),this.emplace(H,n,a,c,p,v,b,w,C,M,R,L,$)}emplace(n,a,c,p,v,b,w,C,M,R,L,$,H){const q=12*n;return this.int16[q+0]=a,this.int16[q+1]=c,this.int16[q+2]=p,this.int16[q+3]=v,this.uint16[q+4]=b,this.uint16[q+5]=w,this.uint16[q+6]=C,this.uint16[q+7]=M,this.int16[q+8]=R,this.int16[q+9]=L,this.int16[q+10]=$,this.int16[q+11]=H,n}}Oc.prototype.bytesPerElement=24,Ft("StructArrayLayout4i4ui4i24",Oc);class Pl extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,c){const p=this.length;return this.resize(p+1),this.emplace(p,n,a,c)}emplace(n,a,c,p){const v=3*n;return this.float32[v+0]=a,this.float32[v+1]=c,this.float32[v+2]=p,n}}Pl.prototype.bytesPerElement=12,Ft("StructArrayLayout3f12",Pl);class gd extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.uint32[1*n+0]=a,n}}gd.prototype.bytesPerElement=4,Ft("StructArrayLayout1ul4",gd);class Do extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,c,p,v,b,w,C,M){const R=this.length;return this.resize(R+1),this.emplace(R,n,a,c,p,v,b,w,C,M)}emplace(n,a,c,p,v,b,w,C,M,R){const L=10*n,$=5*n;return this.int16[L+0]=a,this.int16[L+1]=c,this.int16[L+2]=p,this.int16[L+3]=v,this.int16[L+4]=b,this.int16[L+5]=w,this.uint32[$+3]=C,this.uint16[L+8]=M,this.uint16[L+9]=R,n}}Do.prototype.bytesPerElement=20,Ft("StructArrayLayout6i1ul2ui20",Do);class Hs extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,c,p,v,b){const w=this.length;return this.resize(w+1),this.emplace(w,n,a,c,p,v,b)}emplace(n,a,c,p,v,b,w){const C=6*n;return this.int16[C+0]=a,this.int16[C+1]=c,this.int16[C+2]=p,this.int16[C+3]=v,this.int16[C+4]=b,this.int16[C+5]=w,n}}Hs.prototype.bytesPerElement=12,Ft("StructArrayLayout2i2i2i12",Hs);class _d extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,c,p,v){const b=this.length;return this.resize(b+1),this.emplace(b,n,a,c,p,v)}emplace(n,a,c,p,v,b){const w=4*n,C=8*n;return this.float32[w+0]=a,this.float32[w+1]=c,this.float32[w+2]=p,this.int16[C+6]=v,this.int16[C+7]=b,n}}_d.prototype.bytesPerElement=16,Ft("StructArrayLayout2f1f2i16",_d);class Vc extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,c,p,v,b){const w=this.length;return this.resize(w+1),this.emplace(w,n,a,c,p,v,b)}emplace(n,a,c,p,v,b,w){const C=16*n,M=4*n,R=8*n;return this.uint8[C+0]=a,this.uint8[C+1]=c,this.float32[M+1]=p,this.float32[M+2]=v,this.int16[R+6]=b,this.int16[R+7]=w,n}}Vc.prototype.bytesPerElement=16,Ft("StructArrayLayout2ub2f2i16",Vc);class ps extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,c){const p=this.length;return this.resize(p+1),this.emplace(p,n,a,c)}emplace(n,a,c,p){const v=3*n;return this.uint16[v+0]=a,this.uint16[v+1]=c,this.uint16[v+2]=p,n}}ps.prototype.bytesPerElement=6,Ft("StructArrayLayout3ui6",ps);class yd extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,c,p,v,b,w,C,M,R,L,$,H,q,Y,re,de){const ze=this.length;return this.resize(ze+1),this.emplace(ze,n,a,c,p,v,b,w,C,M,R,L,$,H,q,Y,re,de)}emplace(n,a,c,p,v,b,w,C,M,R,L,$,H,q,Y,re,de,ze){const _e=24*n,G=12*n,ie=48*n;return this.int16[_e+0]=a,this.int16[_e+1]=c,this.uint16[_e+2]=p,this.uint16[_e+3]=v,this.uint32[G+2]=b,this.uint32[G+3]=w,this.uint32[G+4]=C,this.uint16[_e+10]=M,this.uint16[_e+11]=R,this.uint16[_e+12]=L,this.float32[G+7]=$,this.float32[G+8]=H,this.uint8[ie+36]=q,this.uint8[ie+37]=Y,this.uint8[ie+38]=re,this.uint32[G+10]=de,this.int16[_e+22]=ze,n}}yd.prototype.bytesPerElement=48,Ft("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",yd);class vd extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,c,p,v,b,w,C,M,R,L,$,H,q,Y,re,de,ze,_e,G,ie,ve,He,ht,Ye,nt,yt,mt){const bt=this.length;return this.resize(bt+1),this.emplace(bt,n,a,c,p,v,b,w,C,M,R,L,$,H,q,Y,re,de,ze,_e,G,ie,ve,He,ht,Ye,nt,yt,mt)}emplace(n,a,c,p,v,b,w,C,M,R,L,$,H,q,Y,re,de,ze,_e,G,ie,ve,He,ht,Ye,nt,yt,mt,bt){const at=32*n,jt=16*n;return this.int16[at+0]=a,this.int16[at+1]=c,this.int16[at+2]=p,this.int16[at+3]=v,this.int16[at+4]=b,this.int16[at+5]=w,this.int16[at+6]=C,this.int16[at+7]=M,this.uint16[at+8]=R,this.uint16[at+9]=L,this.uint16[at+10]=$,this.uint16[at+11]=H,this.uint16[at+12]=q,this.uint16[at+13]=Y,this.uint16[at+14]=re,this.uint16[at+15]=de,this.uint16[at+16]=ze,this.uint16[at+17]=_e,this.uint16[at+18]=G,this.uint16[at+19]=ie,this.uint16[at+20]=ve,this.uint16[at+21]=He,this.uint16[at+22]=ht,this.uint32[jt+12]=Ye,this.float32[jt+13]=nt,this.float32[jt+14]=yt,this.uint16[at+30]=mt,this.uint16[at+31]=bt,n}}vd.prototype.bytesPerElement=64,Ft("StructArrayLayout8i15ui1ul2f2ui64",vd);class kl extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.float32[1*n+0]=a,n}}kl.prototype.bytesPerElement=4,Ft("StructArrayLayout1f4",kl);class bd extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,c){const p=this.length;return this.resize(p+1),this.emplace(p,n,a,c)}emplace(n,a,c,p){const v=3*n;return this.uint16[6*n+0]=a,this.float32[v+1]=c,this.float32[v+2]=p,n}}bd.prototype.bytesPerElement=12,Ft("StructArrayLayout1ui2f12",bd);class _ extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,c){const p=this.length;return this.resize(p+1),this.emplace(p,n,a,c)}emplace(n,a,c,p){const v=4*n;return this.uint32[2*n+0]=a,this.uint16[v+2]=c,this.uint16[v+3]=p,n}}_.prototype.bytesPerElement=8,Ft("StructArrayLayout1ul2ui8",_);class t extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a){const c=this.length;return this.resize(c+1),this.emplace(c,n,a)}emplace(n,a,c){const p=2*n;return this.uint16[p+0]=a,this.uint16[p+1]=c,n}}t.prototype.bytesPerElement=4,Ft("StructArrayLayout2ui4",t);class r extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.uint16[1*n+0]=a,n}}r.prototype.bytesPerElement=2,Ft("StructArrayLayout1ui2",r);class d extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,c,p){const v=this.length;return this.resize(v+1),this.emplace(v,n,a,c,p)}emplace(n,a,c,p,v){const b=4*n;return this.float32[b+0]=a,this.float32[b+1]=c,this.float32[b+2]=p,this.float32[b+3]=v,n}}d.prototype.bytesPerElement=16,Ft("StructArrayLayout4f16",d);class h extends wl{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new B(this.anchorPointX,this.anchorPointY)}}h.prototype.size=20;class y extends Do{get(n){return new h(this,n)}}Ft("CollisionBoxArray",y);class x extends wl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(n){this._structArray.uint8[this._pos1+37]=n}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(n){this._structArray.uint8[this._pos1+38]=n}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(n){this._structArray.uint32[this._pos4+10]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}x.prototype.size=48;class S extends yd{get(n){return new x(this,n)}}Ft("PlacedSymbolArray",S);class P extends wl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(n){this._structArray.uint32[this._pos4+12]=n}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}P.prototype.size=64;class A extends vd{get(n){return new P(this,n)}}Ft("SymbolInstanceArray",A);class F extends kl{getoffsetX(n){return this.float32[1*n+0]}}Ft("GlyphOffsetArray",F);class N extends Cl{getx(n){return this.int16[3*n+0]}gety(n){return this.int16[3*n+1]}gettileUnitDistanceFromAnchor(n){return this.int16[3*n+2]}}Ft("SymbolLineVertexArray",N);class j extends wl{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}j.prototype.size=12;class X extends bd{get(n){return new j(this,n)}}Ft("TextAnchorOffsetArray",X);class J extends wl{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}J.prototype.size=8;class le extends _{get(n){return new J(this,n)}}Ft("FeatureIndexArray",le);class se extends Sl{}class ue extends Sl{}class fe extends Sl{}class we extends md{}class Te extends Wa{}class Ie extends Ro{}class De extends Tl{}class Re extends Oc{}class Ge extends Pl{}class Ze extends gd{}class rt extends Hs{}class lt extends Vc{}class et extends ps{}class Pt extends t{}const St=zi([{name:"a_pos",components:2,type:"Int16"}],4),{members:pt}=St;class Dt{constructor(n=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=n}prepareSegment(n,a,c,p){const v=this.segments[this.segments.length-1];return n>Dt.MAX_VERTEX_ARRAY_LENGTH&&si(`Max vertices per segment is ${Dt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Dt.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!v||v.vertexLength+n>Dt.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==p?this.createNewSegment(a,c,p):v}createNewSegment(n,a,c){const p={vertexOffset:n.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0,vaos:{}};return c!==void 0&&(p.sortKey=c),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(p),p}getOrCreateLatestSegment(n,a,c){return this.prepareSegment(0,n,a,c)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const n of this.segments)for(const a in n.vaos)n.vaos[a].destroy()}static simpleSegment(n,a,c,p){return new Dt([{vertexOffset:n,primitiveOffset:a,vertexLength:c,primitiveLength:p,vaos:{},sortKey:0}])}}function vn(s,n){return 256*(s=Jt(Math.floor(s),0,255))+Jt(Math.floor(n),0,255)}Dt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ft("SegmentVector",Dt);const Bn=zi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var gi,Xn,_i,Kn={exports:{}},Hn={exports:{}},Yn={exports:{}},lr=function(){if(_i)return Kn.exports;_i=1;var s=(gi||(gi=1,Hn.exports=function(a,c){var p,v,b,w,C,M,R,L;for(v=a.length-(p=3&a.length),b=c,C=3432918353,M=461845907,L=0;L<v;)R=255&a.charCodeAt(L)|(255&a.charCodeAt(++L))<<8|(255&a.charCodeAt(++L))<<16|(255&a.charCodeAt(++L))<<24,++L,b=27492+(65535&(w=5*(65535&(b=(b^=R=(65535&(R=(R=(65535&R)*C+(((R>>>16)*C&65535)<<16)&4294967295)<<15|R>>>17))*M+(((R>>>16)*M&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(w>>>16)&65535)<<16);switch(R=0,p){case 3:R^=(255&a.charCodeAt(L+2))<<16;case 2:R^=(255&a.charCodeAt(L+1))<<8;case 1:b^=R=(65535&(R=(R=(65535&(R^=255&a.charCodeAt(L)))*C+(((R>>>16)*C&65535)<<16)&4294967295)<<15|R>>>17))*M+(((R>>>16)*M&65535)<<16)&4294967295}return b^=a.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0}),Hn.exports),n=(Xn||(Xn=1,Yn.exports=function(a,c){for(var p,v=a.length,b=c^v,w=0;v>=4;)p=1540483477*(65535&(p=255&a.charCodeAt(w)|(255&a.charCodeAt(++w))<<8|(255&a.charCodeAt(++w))<<16|(255&a.charCodeAt(++w))<<24))+((1540483477*(p>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),v-=4,++w;switch(v){case 3:b^=(255&a.charCodeAt(w+2))<<16;case 2:b^=(255&a.charCodeAt(w+1))<<8;case 1:b=1540483477*(65535&(b^=255&a.charCodeAt(w)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0}),Yn.exports);return Kn.exports=s,Kn.exports.murmur3=s,Kn.exports.murmur2=n,Kn.exports}(),Ni=T(lr);class $i{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,a,c,p){this.ids.push(Sr(n)),this.positions.push(a,c,p)}getPositions(n){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const a=Sr(n);let c=0,p=this.ids.length-1;for(;c<p;){const b=c+p>>1;this.ids[b]>=a?p=b:c=b+1}const v=[];for(;this.ids[c]===a;)v.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return v}static serialize(n,a){const c=new Float64Array(n.ids),p=new Uint32Array(n.positions);return Xa(c,p,0,c.length-1),a&&a.push(c.buffer,p.buffer),{ids:c,positions:p}}static deserialize(n){const a=new $i;return a.ids=n.ids,a.positions=n.positions,a.indexed=!0,a}}function Sr(s){const n=+s;return!isNaN(n)&&n<=Number.MAX_SAFE_INTEGER?n:Ni(String(s))}function Xa(s,n,a,c){for(;a<c;){const p=s[a+c>>1];let v=a-1,b=c+1;for(;;){do v++;while(s[v]<p);do b--;while(s[b]>p);if(v>=b)break;Ra(s,v,b),Ra(n,3*v,3*b),Ra(n,3*v+1,3*b+1),Ra(n,3*v+2,3*b+2)}b-a<c-b?(Xa(s,n,a,b),a=b+1):(Xa(s,n,b+1,c),c=b)}}function Ra(s,n,a){const c=s[n];s[n]=s[a],s[a]=c}Ft("FeaturePositionMap",$i);class Nr{constructor(n,a){this.gl=n.gl,this.location=a}}class Ka extends Nr{constructor(n,a){super(n,a),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class Il extends Nr{constructor(n,a){super(n,a),this.current=[0,0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3]))}}class Ml extends Nr{constructor(n,a){super(n,a),this.current=Pn.transparent}set(n){n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a))}}const zo=new Float32Array(16);function Rr(s){return[vn(255*s.r,255*s.g),vn(255*s.b,255*s.a)]}class na{constructor(n,a,c){this.value=n,this.uniformNames=a.map(p=>`u_${p}`),this.type=c}setUniform(n,a,c){n.set(c.constantOr(this.value))}getBinding(n,a,c){return this.type==="color"?new Ml(n,a):new Ka(n,a)}}class ia{constructor(n,a){this.uniformNames=a.map(c=>`u_${c}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(n,a){this.pixelRatioFrom=a.pixelRatio,this.pixelRatioTo=n.pixelRatio,this.patternFrom=a.tlbr,this.patternTo=n.tlbr}setUniform(n,a,c,p){const v=p==="u_pattern_to"?this.patternTo:p==="u_pattern_from"?this.patternFrom:p==="u_pixel_ratio_to"?this.pixelRatioTo:p==="u_pixel_ratio_from"?this.pixelRatioFrom:null;v&&n.set(v)}getBinding(n,a,c){return c.substr(0,9)==="u_pattern"?new Il(n,a):new Ka(n,a)}}class $r{constructor(n,a,c,p){this.expression=n,this.type=c,this.maxValue=0,this.paintVertexAttributes=a.map(v=>({name:`a_${v}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(n,a,c,p,v){const b=this.paintVertexArray.length,w=this.expression.evaluate(new mi(0),a,{},p,[],v);this.paintVertexArray.resize(n),this._setPaintValue(b,n,w)}updatePaintArray(n,a,c,p){const v=this.expression.evaluate({zoom:0},c,p);this._setPaintValue(n,a,v)}_setPaintValue(n,a,c){if(this.type==="color"){const p=Rr(c);for(let v=n;v<a;v++)this.paintVertexArray.emplace(v,p[0],p[1])}else{for(let p=n;p<a;p++)this.paintVertexArray.emplace(p,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Jn{constructor(n,a,c,p,v,b){this.expression=n,this.uniformNames=a.map(w=>`u_${w}_t`),this.type=c,this.useIntegerZoom=p,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=a.map(w=>({name:`a_${w}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new b}populatePaintArray(n,a,c,p,v){const b=this.expression.evaluate(new mi(this.zoom),a,{},p,[],v),w=this.expression.evaluate(new mi(this.zoom+1),a,{},p,[],v),C=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(C,n,b,w)}updatePaintArray(n,a,c,p){const v=this.expression.evaluate({zoom:this.zoom},c,p),b=this.expression.evaluate({zoom:this.zoom+1},c,p);this._setPaintValue(n,a,v,b)}_setPaintValue(n,a,c,p){if(this.type==="color"){const v=Rr(c),b=Rr(p);for(let w=n;w<a;w++)this.paintVertexArray.emplace(w,v[0],v[1],b[0],b[1])}else{for(let v=n;v<a;v++)this.paintVertexArray.emplace(v,c,p);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(p))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,a){const c=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,p=Jt(this.expression.interpolationFactor(c,this.zoom,this.zoom+1),0,1);n.set(p)}getBinding(n,a,c){return new Ka(n,a)}}class yi{constructor(n,a,c,p,v,b){this.expression=n,this.type=a,this.useIntegerZoom=c,this.zoom=p,this.layerId=b,this.zoomInPaintVertexArray=new v,this.zoomOutPaintVertexArray=new v}populatePaintArray(n,a,c){const p=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(n),this.zoomOutPaintVertexArray.resize(n),this._setPaintValues(p,n,a.patterns&&a.patterns[this.layerId],c)}updatePaintArray(n,a,c,p,v){this._setPaintValues(n,a,c.patterns&&c.patterns[this.layerId],v)}_setPaintValues(n,a,c,p){if(!p||!c)return;const{min:v,mid:b,max:w}=c,C=p[v],M=p[b],R=p[w];if(C&&M&&R)for(let L=n;L<a;L++)this.zoomInPaintVertexArray.emplace(L,M.tl[0],M.tl[1],M.br[0],M.br[1],C.tl[0],C.tl[1],C.br[0],C.br[1],M.pixelRatio,C.pixelRatio),this.zoomOutPaintVertexArray.emplace(L,M.tl[0],M.tl[1],M.br[0],M.br[1],R.tl[0],R.tl[1],R.br[0],R.br[1],M.pixelRatio,R.pixelRatio)}upload(n){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=n.createVertexBuffer(this.zoomInPaintVertexArray,Bn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=n.createVertexBuffer(this.zoomOutPaintVertexArray,Bn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class jr{constructor(n,a,c){this.binders={},this._buffers=[];const p=[];for(const v in n.paint._values){if(!c(v))continue;const b=n.paint.get(v);if(!(b instanceof Ea&&wo(b.property.specification)))continue;const w=rg(v,n.type),C=b.value,M=b.property.specification.type,R=b.property.useIntegerZoom,L=b.property.specification["property-type"],$=L==="cross-faded"||L==="cross-faded-data-driven";if(C.kind==="constant")this.binders[v]=$?new ia(C.value,w):new na(C.value,w,M),p.push(`/u_${v}`);else if(C.kind==="source"||$){const H=Nf(v,M,"source");this.binders[v]=$?new yi(C,M,R,a,H,n.id):new $r(C,w,M,H),p.push(`/a_${v}`)}else{const H=Nf(v,M,"composite");this.binders[v]=new Jn(C,w,M,R,a,H),p.push(`/z_${v}`)}}this.cacheKey=p.sort().join("")}getMaxValue(n){const a=this.binders[n];return a instanceof $r||a instanceof Jn?a.maxValue:0}populatePaintArrays(n,a,c,p,v){for(const b in this.binders){const w=this.binders[b];(w instanceof $r||w instanceof Jn||w instanceof yi)&&w.populatePaintArray(n,a,c,p,v)}}setConstantPatternPositions(n,a){for(const c in this.binders){const p=this.binders[c];p instanceof ia&&p.setConstantPatternPositions(n,a)}}updatePaintArrays(n,a,c,p,v){let b=!1;for(const w in n){const C=a.getPositions(w);for(const M of C){const R=c.feature(M.index);for(const L in this.binders){const $=this.binders[L];if(($ instanceof $r||$ instanceof Jn||$ instanceof yi)&&$.expression.isStateDependent===!0){const H=p.paint.get(L);$.expression=H.value,$.updatePaintArray(M.start,M.end,R,n[w],v),b=!0}}}}return b}defines(){const n=[];for(const a in this.binders){const c=this.binders[a];(c instanceof na||c instanceof ia)&&n.push(...c.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return n}getBinderAttributes(){const n=[];for(const a in this.binders){const c=this.binders[a];if(c instanceof $r||c instanceof Jn)for(let p=0;p<c.paintVertexAttributes.length;p++)n.push(c.paintVertexAttributes[p].name);else if(c instanceof yi)for(let p=0;p<Bn.members.length;p++)n.push(Bn.members[p].name)}return n}getBinderUniforms(){const n=[];for(const a in this.binders){const c=this.binders[a];if(c instanceof na||c instanceof ia||c instanceof Jn)for(const p of c.uniformNames)n.push(p)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n,a){const c=[];for(const p in this.binders){const v=this.binders[p];if(v instanceof na||v instanceof ia||v instanceof Jn){for(const b of v.uniformNames)if(a[b]){const w=v.getBinding(n,a[b],b);c.push({name:b,property:p,binding:w})}}}return c}setUniforms(n,a,c,p){for(const{name:v,property:b,binding:w}of a)this.binders[b].setUniform(w,p,c.get(b),v)}updatePaintBuffers(n){this._buffers=[];for(const a in this.binders){const c=this.binders[a];if(n&&c instanceof yi){const p=n.fromScale===2?c.zoomInPaintVertexBuffer:c.zoomOutPaintVertexBuffer;p&&this._buffers.push(p)}else(c instanceof $r||c instanceof Jn)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(n){for(const a in this.binders){const c=this.binders[a];(c instanceof $r||c instanceof Jn||c instanceof yi)&&c.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const a=this.binders[n];(a instanceof $r||a instanceof Jn||a instanceof yi)&&a.destroy()}}}class xi{constructor(n,a,c=()=>!0){this.programConfigurations={};for(const p of n)this.programConfigurations[p.id]=new jr(p,a,c);this.needsUpload=!1,this._featureMap=new $i,this._bufferOffset=0}populatePaintArrays(n,a,c,p,v,b){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(n,a,p,v,b);a.id!==void 0&&this._featureMap.add(a.id,c,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,a,c,p){for(const v of c)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(n,this._featureMap,a,v,p)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}function rg(s,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[s]||[s.replace(`${n}-`,"").replace(/-/g,"_")]}function Nf(s,n,a){const c={color:{source:Ro,composite:d},number:{source:kl,composite:Ro}},p=function(v){return{"line-pattern":{source:De,composite:De},"fill-pattern":{source:De,composite:De},"fill-extrusion-pattern":{source:De,composite:De}}[v]}(s);return p&&p[a]||c[n][a]}Ft("ConstantBinder",na),Ft("CrossFadedConstantBinder",ia),Ft("SourceExpressionBinder",$r),Ft("CrossFadedCompositeBinder",yi),Ft("CompositeExpressionBinder",Jn),Ft("ProgramConfiguration",jr,{omit:["_buffers"]}),Ft("ProgramConfigurationSet",xi);const xd=Math.pow(2,14)-1,$f=-xd-1;function Zs(s){const n=je/s.extent,a=s.loadGeometry();for(let c=0;c<a.length;c++){const p=a[c];for(let v=0;v<p.length;v++){const b=p[v],w=Math.round(b.x*n),C=Math.round(b.y*n);b.x=Jt(w,$f,xd),b.y=Jt(C,$f,xd),(w<b.x||w>b.x+1||C<b.y||C>b.y+1)&&si("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return a}function qs(s,n){return{type:s.type,id:s.id,properties:s.properties,geometry:n?Zs(s):[]}}const ms=-32768;function jf(s,n,a,c,p){s.emplaceBack(ms+8*n+c,ms+8*a+p)}class Nc{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new ue,this.indexArray=new et,this.segments=new Dt,this.programConfigurations=new xi(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(n,a,c){const p=this.layers[0],v=[];let b=null,w=!1,C=p.type==="heatmap";if(p.type==="circle"){const R=p;b=R.layout.get("circle-sort-key"),w=!b.isConstant(),C=C||R.paint.get("circle-pitch-alignment")==="map"}const M=C?a.subdivisionGranularity.circle:1;for(const{feature:R,id:L,index:$,sourceLayerIndex:H}of n){const q=this.layers[0]._featureFilter.needGeometry,Y=qs(R,q);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),Y,c))continue;const re=w?b.evaluate(Y,{},c):void 0,de={id:L,properties:R.properties,type:R.type,sourceLayerIndex:H,index:$,geometry:q?Y.geometry:Zs(R),patterns:{},sortKey:re};v.push(de)}w&&v.sort((R,L)=>R.sortKey-L.sortKey);for(const R of v){const{geometry:L,index:$,sourceLayerIndex:H}=R,q=n[$].feature;this.addFeature(R,L,$,c,M),a.featureIndex.insert(q,L,$,H,this.index)}}update(n,a,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,a,this.stateDependentLayers,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,pt),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,a,c,p,v=1){let b;switch(v){case 1:b=[0,7];break;case 3:b=[0,2,5,7];break;case 5:b=[0,1,3,4,6,7];break;case 7:b=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${v}; valid values are 1, 3, 5, 7.`)}const w=b.length;for(const C of a)for(const M of C){const R=M.x,L=M.y;if(R<0||R>=je||L<0||L>=je)continue;const $=this.segments.prepareSegment(w*w,this.layoutVertexArray,this.indexArray,n.sortKey),H=$.vertexLength;for(let q=0;q<w;q++)for(let Y=0;Y<w;Y++)jf(this.layoutVertexArray,R,L,b[Y],b[q]);for(let q=0;q<w-1;q++)for(let Y=0;Y<w-1;Y++){const re=H+q*w+Y,de=H+(q+1)*w+Y;this.indexArray.emplaceBack(re,de+1,re+1),this.indexArray.emplaceBack(re,de,de+1)}$.vertexLength+=w*w,$.primitiveLength+=(w-1)*(w-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,{},p)}}function wd(s,n){for(let a=0;a<s.length;a++)if($c(n,s[a]))return!0;for(let a=0;a<n.length;a++)if($c(s,n[a]))return!0;return!!ag(s,n)}function Sd(s,n,a){return!!$c(s,n)||!!sg(n,s,a)}function Cd(s,n){if(s.length===1)return mv(n,s[0]);for(let a=0;a<n.length;a++){const c=n[a];for(let p=0;p<c.length;p++)if($c(s,c[p]))return!0}for(let a=0;a<s.length;a++)if(mv(n,s[a]))return!0;for(let a=0;a<n.length;a++)if(ag(s,n[a]))return!0;return!1}function Td(s,n,a){if(s.length>1){if(ag(s,n))return!0;for(let c=0;c<n.length;c++)if(sg(n[c],s,a))return!0}for(let c=0;c<s.length;c++)if(sg(s[c],n,a))return!0;return!1}function ag(s,n){if(s.length===0||n.length===0)return!1;for(let a=0;a<s.length-1;a++){const c=s[a],p=s[a+1];for(let v=0;v<n.length-1;v++)if(n2(c,p,n[v],n[v+1]))return!0}return!1}function n2(s,n,a,c){return En(s,a,c)!==En(n,a,c)&&En(s,n,a)!==En(s,n,c)}function sg(s,n,a){const c=a*a;if(n.length===1)return s.distSqr(n[0])<c;for(let p=1;p<n.length;p++)if(pv(s,n[p-1],n[p])<c)return!0;return!1}function pv(s,n,a){const c=n.distSqr(a);if(c===0)return s.distSqr(n);const p=((s.x-n.x)*(a.x-n.x)+(s.y-n.y)*(a.y-n.y))/c;return s.distSqr(p<0?n:p>1?a:a.sub(n)._mult(p)._add(n))}function mv(s,n){let a,c,p,v=!1;for(let b=0;b<s.length;b++){a=s[b];for(let w=0,C=a.length-1;w<a.length;C=w++)c=a[w],p=a[C],c.y>n.y!=p.y>n.y&&n.x<(p.x-c.x)*(n.y-c.y)/(p.y-c.y)+c.x&&(v=!v)}return v}function $c(s,n){let a=!1;for(let c=0,p=s.length-1;c<s.length;p=c++){const v=s[c],b=s[p];v.y>n.y!=b.y>n.y&&n.x<(b.x-v.x)*(n.y-v.y)/(b.y-v.y)+v.x&&(a=!a)}return a}function i2(s,n,a){const c=a[0],p=a[2];if(s.x<c.x&&n.x<c.x||s.x>p.x&&n.x>p.x||s.y<c.y&&n.y<c.y||s.y>p.y&&n.y>p.y)return!1;const v=En(s,n,a[0]);return v!==En(s,n,a[1])||v!==En(s,n,a[2])||v!==En(s,n,a[3])}function Pd(s,n,a){const c=n.paint.get(s).value;return c.kind==="constant"?c.value:a.programConfigurations.get(n.id).getMaxValue(s)}function Uf(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function Gf(s,n,a,c,p){if(!n[0]&&!n[1])return s;const v=B.convert(n)._mult(p);a==="viewport"&&v._rotate(-c);const b=[];for(let w=0;w<s.length;w++)b.push(s[w].sub(v));return b}let gv,_v;Ft("CircleBucket",Nc,{omit:["layers"]});var r2={get paint(){return _v=_v||new Ar({"circle-radius":new sn(ae.paint_circle["circle-radius"]),"circle-color":new sn(ae.paint_circle["circle-color"]),"circle-blur":new sn(ae.paint_circle["circle-blur"]),"circle-opacity":new sn(ae.paint_circle["circle-opacity"]),"circle-translate":new Zt(ae.paint_circle["circle-translate"]),"circle-translate-anchor":new Zt(ae.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Zt(ae.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Zt(ae.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new sn(ae.paint_circle["circle-stroke-width"]),"circle-stroke-color":new sn(ae.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new sn(ae.paint_circle["circle-stroke-opacity"])})},get layout(){return gv=gv||new Ar({"circle-sort-key":new sn(ae.layout_circle["circle-sort-key"])})}};class a2 extends Aa{constructor(n){super(n,r2)}createBucket(n){return new Nc(n)}queryRadius(n){const a=n;return Pd("circle-radius",this,a)+Pd("circle-stroke-width",this,a)+Uf(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:n,feature:a,featureState:c,geometry:p,transform:v,pixelsToTileUnits:b,pixelPosMatrix:w}){const C=Gf(n,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-v.bearingInRadians,b),M=this.paint.get("circle-radius").evaluate(a,c)+this.paint.get("circle-stroke-width").evaluate(a,c),R=this.paint.get("circle-pitch-alignment")==="map",L=R?C:function(H,q){return H.map(Y=>yv(Y,q))}(C,w),$=R?M*b:M;for(const H of p)for(const q of H){const Y=R?q:yv(q,w);let re=$;const de=xe([],[q.x,q.y,0,1],w);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?re*=de[3]/v.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(re*=v.cameraToCenterDistance/de[3]),Sd(L,Y,re))return!0}return!1}}function yv(s,n){const a=xe([],[s.x,s.y,0,1],n);return new B(a[0]/a[3],a[1]/a[3])}class vv extends Nc{}let bv;Ft("HeatmapBucket",vv,{omit:["layers"]});var s2={get paint(){return bv=bv||new Ar({"heatmap-radius":new sn(ae.paint_heatmap["heatmap-radius"]),"heatmap-weight":new sn(ae.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Zt(ae.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Fc(ae.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Zt(ae.paint_heatmap["heatmap-opacity"])})}};function og(s,{width:n,height:a},c,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==n*a*c)throw new RangeError(`mismatched image size. expected: ${p.length} but got: ${n*a*c}`)}else p=new Uint8Array(n*a*c);return s.width=n,s.height=a,s.data=p,s}function xv(s,{width:n,height:a},c){if(n===s.width&&a===s.height)return;const p=og({},{width:n,height:a},c);lg(s,p,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,n),height:Math.min(s.height,a)},c),s.width=n,s.height=a,s.data=p.data}function lg(s,n,a,c,p,v){if(p.width===0||p.height===0)return n;if(p.width>s.width||p.height>s.height||a.x>s.width-p.width||a.y>s.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>n.width||p.height>n.height||c.x>n.width-p.width||c.y>n.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const b=s.data,w=n.data;if(b===w)throw new Error("srcData equals dstData, so image is already copied");for(let C=0;C<p.height;C++){const M=((a.y+C)*s.width+a.x)*v,R=((c.y+C)*n.width+c.x)*v;for(let L=0;L<p.width*v;L++)w[R+L]=b[M+L]}return n}class kd{constructor(n,a){og(this,n,1,a)}resize(n){xv(this,n,1)}clone(){return new kd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,a,c,p,v){lg(n,a,c,p,v,1)}}class ma{constructor(n,a){og(this,n,4,a)}resize(n){xv(this,n,4)}replace(n,a){a?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new ma({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,a,c,p,v){lg(n,a,c,p,v,4)}}function wv(s){const n={},a=s.resolution||256,c=s.clips?s.clips.length:1,p=s.image||new ma({width:a,height:c});if(Math.log(a)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${a}`);const v=(b,w,C)=>{n[s.evaluationKey]=C;const M=s.expression.evaluate(n);p.data[b+w+0]=Math.floor(255*M.r/M.a),p.data[b+w+1]=Math.floor(255*M.g/M.a),p.data[b+w+2]=Math.floor(255*M.b/M.a),p.data[b+w+3]=Math.floor(255*M.a)};if(s.clips)for(let b=0,w=0;b<c;++b,w+=4*a)for(let C=0,M=0;C<a;C++,M+=4){const R=C/(a-1),{start:L,end:$}=s.clips[b];v(w,M,L*(1-R)+$*R)}else for(let b=0,w=0;b<a;b++,w+=4)v(0,w,b/(a-1));return p}Ft("AlphaImage",kd),Ft("RGBAImage",ma);const cg="big-fb";class o2 extends Aa{createBucket(n){return new vv(n)}constructor(n){super(n,s2),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=wv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(cg)&&this.heatmapFbos.delete(cg)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Sv;var l2={get paint(){return Sv=Sv||new Ar({"hillshade-illumination-direction":new Zt(ae.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Zt(ae.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Zt(ae.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Zt(ae.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Zt(ae.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Zt(ae.paint_hillshade["hillshade-accent-color"])})}};class c2 extends Aa{constructor(n){super(n,l2)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const u2=zi([{name:"a_pos",components:2,type:"Int16"}],4),{members:d2}=u2;function ug(s,n,a){const c=a.patternDependencies;let p=!1;for(const v of n){const b=v.paint.get(`${s}-pattern`);b.isConstant()||(p=!0);const w=b.constantOr(null);w&&(p=!0,c[w.to]=!0,c[w.from]=!0)}return p}function dg(s,n,a,c,p){const v=p.patternDependencies;for(const b of n){const w=b.paint.get(`${s}-pattern`).value;if(w.kind!=="constant"){let C=w.evaluate({zoom:c-1},a,{},p.availableImages),M=w.evaluate({zoom:c},a,{},p.availableImages),R=w.evaluate({zoom:c+1},a,{},p.availableImages);C=C&&C.name?C.name:C,M=M&&M.name?M.name:M,R=R&&R.name?R.name:R,v[C]=!0,v[M]=!0,v[R]=!0,a.patterns[b.id]={min:C,mid:M,max:R}}}return a}function Cv(s,n,a,c,p){let v;if(p===function(b,w,C,M){let R=0;for(let L=w,$=C-M;L<C;L+=M)R+=(b[$]-b[L])*(b[L+1]+b[$+1]),$=L;return R}(s,n,a,c)>0)for(let b=n;b<a;b+=c)v=Iv(b/c|0,s[b],s[b+1],v);else for(let b=a-c;b>=n;b-=c)v=Iv(b/c|0,s[b],s[b+1],v);return v&&jc(v,v.next)&&(Ad(v),v=v.next),v}function El(s,n){if(!s)return s;n||(n=s);let a,c=s;do if(a=!1,c.steiner||!jc(c,c.next)&&Li(c.prev,c,c.next)!==0)c=c.next;else{if(Ad(c),c=n=c.prev,c===c.next)break;a=!0}while(a||c!==n);return n}function Id(s,n,a,c,p,v,b){if(!s)return;!b&&v&&function(C,M,R,L){let $=C;do $.z===0&&($.z=hg($.x,$.y,M,R,L)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next;while($!==C);$.prevZ.nextZ=null,$.prevZ=null,function(H){let q,Y=1;do{let re,de=H;H=null;let ze=null;for(q=0;de;){q++;let _e=de,G=0;for(let ve=0;ve<Y&&(G++,_e=_e.nextZ,_e);ve++);let ie=Y;for(;G>0||ie>0&&_e;)G!==0&&(ie===0||!_e||de.z<=_e.z)?(re=de,de=de.nextZ,G--):(re=_e,_e=_e.nextZ,ie--),ze?ze.nextZ=re:H=re,re.prevZ=ze,ze=re;de=_e}ze.nextZ=null,Y*=2}while(q>1)}($)}(s,c,p,v);let w=s;for(;s.prev!==s.next;){const C=s.prev,M=s.next;if(v?f2(s,c,p,v):h2(s))n.push(C.i,s.i,M.i),Ad(s),s=M.next,w=M.next;else if((s=M)===w){b?b===1?Id(s=p2(El(s),n),n,a,c,p,v,2):b===2&&m2(s,n,a,c,p,v):Id(El(s),n,a,c,p,v,1);break}}}function h2(s){const n=s.prev,a=s,c=s.next;if(Li(n,a,c)>=0)return!1;const p=n.x,v=a.x,b=c.x,w=n.y,C=a.y,M=c.y,R=Math.min(p,v,b),L=Math.min(w,C,M),$=Math.max(p,v,b),H=Math.max(w,C,M);let q=c.next;for(;q!==n;){if(q.x>=R&&q.x<=$&&q.y>=L&&q.y<=H&&Md(p,w,v,C,b,M,q.x,q.y)&&Li(q.prev,q,q.next)>=0)return!1;q=q.next}return!0}function f2(s,n,a,c){const p=s.prev,v=s,b=s.next;if(Li(p,v,b)>=0)return!1;const w=p.x,C=v.x,M=b.x,R=p.y,L=v.y,$=b.y,H=Math.min(w,C,M),q=Math.min(R,L,$),Y=Math.max(w,C,M),re=Math.max(R,L,$),de=hg(H,q,n,a,c),ze=hg(Y,re,n,a,c);let _e=s.prevZ,G=s.nextZ;for(;_e&&_e.z>=de&&G&&G.z<=ze;){if(_e.x>=H&&_e.x<=Y&&_e.y>=q&&_e.y<=re&&_e!==p&&_e!==b&&Md(w,R,C,L,M,$,_e.x,_e.y)&&Li(_e.prev,_e,_e.next)>=0||(_e=_e.prevZ,G.x>=H&&G.x<=Y&&G.y>=q&&G.y<=re&&G!==p&&G!==b&&Md(w,R,C,L,M,$,G.x,G.y)&&Li(G.prev,G,G.next)>=0))return!1;G=G.nextZ}for(;_e&&_e.z>=de;){if(_e.x>=H&&_e.x<=Y&&_e.y>=q&&_e.y<=re&&_e!==p&&_e!==b&&Md(w,R,C,L,M,$,_e.x,_e.y)&&Li(_e.prev,_e,_e.next)>=0)return!1;_e=_e.prevZ}for(;G&&G.z<=ze;){if(G.x>=H&&G.x<=Y&&G.y>=q&&G.y<=re&&G!==p&&G!==b&&Md(w,R,C,L,M,$,G.x,G.y)&&Li(G.prev,G,G.next)>=0)return!1;G=G.nextZ}return!0}function p2(s,n){let a=s;do{const c=a.prev,p=a.next.next;!jc(c,p)&&Pv(c,a,a.next,p)&&Ed(c,p)&&Ed(p,c)&&(n.push(c.i,a.i,p.i),Ad(a),Ad(a.next),a=s=p),a=a.next}while(a!==s);return El(a)}function m2(s,n,a,c,p,v){let b=s;do{let w=b.next.next;for(;w!==b.prev;){if(b.i!==w.i&&b2(b,w)){let C=kv(b,w);return b=El(b,b.next),C=El(C,C.next),Id(b,n,a,c,p,v,0),void Id(C,n,a,c,p,v,0)}w=w.next}b=b.next}while(b!==s)}function g2(s,n){let a=s.x-n.x;return a===0&&(a=s.y-n.y,a===0)&&(a=(s.next.y-s.y)/(s.next.x-s.x)-(n.next.y-n.y)/(n.next.x-n.x)),a}function _2(s,n){const a=function(p,v){let b=v;const w=p.x,C=p.y;let M,R=-1/0;if(jc(p,b))return b;do{if(jc(p,b.next))return b.next;if(C<=b.y&&C>=b.next.y&&b.next.y!==b.y){const Y=b.x+(C-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(Y<=w&&Y>R&&(R=Y,M=b.x<b.next.x?b:b.next,Y===w))return M}b=b.next}while(b!==v);if(!M)return null;const L=M,$=M.x,H=M.y;let q=1/0;b=M;do{if(w>=b.x&&b.x>=$&&w!==b.x&&Tv(C<H?w:R,C,$,H,C<H?R:w,C,b.x,b.y)){const Y=Math.abs(C-b.y)/(w-b.x);Ed(b,p)&&(Y<q||Y===q&&(b.x>M.x||b.x===M.x&&y2(M,b)))&&(M=b,q=Y)}b=b.next}while(b!==L);return M}(s,n);if(!a)return n;const c=kv(a,s);return El(c,c.next),El(a,a.next)}function y2(s,n){return Li(s.prev,s,n.prev)<0&&Li(n.next,s,s.next)<0}function hg(s,n,a,c,p){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-a)*p|0)|s<<8))|s<<4))|s<<2))|s<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-c)*p|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function v2(s){let n=s,a=s;do(n.x<a.x||n.x===a.x&&n.y<a.y)&&(a=n),n=n.next;while(n!==s);return a}function Tv(s,n,a,c,p,v,b,w){return(p-b)*(n-w)>=(s-b)*(v-w)&&(s-b)*(c-w)>=(a-b)*(n-w)&&(a-b)*(v-w)>=(p-b)*(c-w)}function Md(s,n,a,c,p,v,b,w){return!(s===b&&n===w)&&Tv(s,n,a,c,p,v,b,w)}function b2(s,n){return s.next.i!==n.i&&s.prev.i!==n.i&&!function(a,c){let p=a;do{if(p.i!==a.i&&p.next.i!==a.i&&p.i!==c.i&&p.next.i!==c.i&&Pv(p,p.next,a,c))return!0;p=p.next}while(p!==a);return!1}(s,n)&&(Ed(s,n)&&Ed(n,s)&&function(a,c){let p=a,v=!1;const b=(a.x+c.x)/2,w=(a.y+c.y)/2;do p.y>w!=p.next.y>w&&p.next.y!==p.y&&b<(p.next.x-p.x)*(w-p.y)/(p.next.y-p.y)+p.x&&(v=!v),p=p.next;while(p!==a);return v}(s,n)&&(Li(s.prev,s,n.prev)||Li(s,n.prev,n))||jc(s,n)&&Li(s.prev,s,s.next)>0&&Li(n.prev,n,n.next)>0)}function Li(s,n,a){return(n.y-s.y)*(a.x-n.x)-(n.x-s.x)*(a.y-n.y)}function jc(s,n){return s.x===n.x&&s.y===n.y}function Pv(s,n,a,c){const p=Zf(Li(s,n,a)),v=Zf(Li(s,n,c)),b=Zf(Li(a,c,s)),w=Zf(Li(a,c,n));return p!==v&&b!==w||!(p!==0||!Hf(s,a,n))||!(v!==0||!Hf(s,c,n))||!(b!==0||!Hf(a,s,c))||!(w!==0||!Hf(a,n,c))}function Hf(s,n,a){return n.x<=Math.max(s.x,a.x)&&n.x>=Math.min(s.x,a.x)&&n.y<=Math.max(s.y,a.y)&&n.y>=Math.min(s.y,a.y)}function Zf(s){return s>0?1:s<0?-1:0}function Ed(s,n){return Li(s.prev,s,s.next)<0?Li(s,n,s.next)>=0&&Li(s,s.prev,n)>=0:Li(s,n,s.prev)<0||Li(s,s.next,n)<0}function kv(s,n){const a=fg(s.i,s.x,s.y),c=fg(n.i,n.x,n.y),p=s.next,v=n.prev;return s.next=n,n.prev=s,a.next=p,p.prev=a,c.next=a,a.prev=c,v.next=c,c.prev=v,c}function Iv(s,n,a,c){const p=fg(s,n,a);return c?(p.next=c.next,p.prev=c,c.next.prev=p,c.next=p):(p.prev=p,p.next=p),p}function Ad(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function fg(s,n,a){return{i:s,x:n,y:a,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Uc{constructor(n,a){if(a>n)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=n,this._minGranularity=a}getGranularityForZoomLevel(n){return Math.max(Math.floor(this._baseZoomGranularity/(1<<n)),this._minGranularity,1)}}class qf{constructor(n){this.fill=n.fill,this.line=n.line,this.tile=n.tile,this.stencil=n.stencil,this.circle=n.circle}}qf.noSubdivision=new qf({fill:new Uc(0,0),line:new Uc(0,0),tile:new Uc(0,0),stencil:new Uc(0,0),circle:1}),Ft("SubdivisionGranularityExpression",Uc),Ft("SubdivisionGranularitySetting",qf);const Gc=-32768,Rd=32767;class x2{constructor(n,a){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=n,this._granularityCellSize=je/n,this._canonical=a}_getKey(n,a){return(n+=32768)<<16|(a+=32768)<<0}_vertexToIndex(n,a){if(n<-32768||a<-32768||n>32767||a>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const c=0|Math.round(n),p=0|Math.round(a),v=this._getKey(c,p);if(this._vertexDictionary.has(v))return this._vertexDictionary.get(v);const b=this._vertexBuffer.length/2;return this._vertexDictionary.set(v,b),this._vertexBuffer.push(c,p),b}_subdivideTrianglesScanline(n){if(this._granularity<2)return function(p,v){const b=[];for(let w=0;w<v.length;w+=3){const C=v[w],M=v[w+1],R=v[w+2],L=p[2*C],$=p[2*C+1];(p[2*M]-L)*(p[2*R+1]-$)-(p[2*M+1]-$)*(p[2*R]-L)>0?(b.push(C),b.push(R),b.push(M)):(b.push(C),b.push(M),b.push(R))}return b}(this._vertexBuffer,n);const a=[],c=n.length;for(let p=0;p<c;p+=3){const v=[n[p+0],n[p+1],n[p+2]],b=[this._vertexBuffer[2*n[p+0]+0],this._vertexBuffer[2*n[p+0]+1],this._vertexBuffer[2*n[p+1]+0],this._vertexBuffer[2*n[p+1]+1],this._vertexBuffer[2*n[p+2]+0],this._vertexBuffer[2*n[p+2]+1]];let w=1/0,C=1/0,M=-1/0,R=-1/0;for(let Y=0;Y<3;Y++){const re=b[2*Y],de=b[2*Y+1];w=Math.min(w,re),M=Math.max(M,re),C=Math.min(C,de),R=Math.max(R,de)}if(w===M||C===R)continue;const L=Math.floor(w/this._granularityCellSize),$=Math.ceil(M/this._granularityCellSize),H=Math.floor(C/this._granularityCellSize),q=Math.ceil(R/this._granularityCellSize);if(L!==$||H!==q)for(let Y=H;Y<q;Y++){const re=this._scanlineGenerateVertexRingForCellRow(Y,b,v);w2(this._vertexBuffer,re,a)}else a.push(...v)}return a}_scanlineGenerateVertexRingForCellRow(n,a,c){const p=n*this._granularityCellSize,v=p+this._granularityCellSize,b=[];for(let w=0;w<3;w++){const C=a[2*w],M=a[2*w+1],R=a[2*(w+1)%6],L=a[(2*(w+1)+1)%6],$=a[2*(w+2)%6],H=a[(2*(w+2)+1)%6],q=R-C,Y=L-M,re=q===0,de=Y===0,ze=(p-M)/Y,_e=(v-M)/Y,G=Math.min(ze,_e),ie=Math.max(ze,_e);if(!de&&(G>=1||ie<=0)||de&&(M<p||M>v)){L>=p&&L<=v&&b.push(c[(w+1)%3]);continue}!de&&G>0&&b.push(this._vertexToIndex(C+q*G,M+Y*G));const ve=C+q*Math.max(G,0),He=C+q*Math.min(ie,1);re||this._generateIntraEdgeVertices(b,C,M,R,L,ve,He),!de&&ie<1&&b.push(this._vertexToIndex(C+q*ie,M+Y*ie)),(de||L>=p&&L<=v)&&b.push(c[(w+1)%3]),!de&&(L<=p||L>=v)&&this._generateInterEdgeVertices(b,C,M,R,L,$,H,He,p,v)}return b}_generateIntraEdgeVertices(n,a,c,p,v,b,w){const C=p-a,M=v-c,R=M===0,L=R?Math.min(a,p):Math.min(b,w),$=R?Math.max(a,p):Math.max(b,w),H=Math.floor(L/this._granularityCellSize)+1,q=Math.ceil($/this._granularityCellSize)-1;if(R?a<p:b<w)for(let Y=H;Y<=q;Y++){const re=Y*this._granularityCellSize;n.push(this._vertexToIndex(re,c+M*(re-a)/C))}else for(let Y=q;Y>=H;Y--){const re=Y*this._granularityCellSize;n.push(this._vertexToIndex(re,c+M*(re-a)/C))}}_generateInterEdgeVertices(n,a,c,p,v,b,w,C,M,R){const L=v-c,$=b-p,H=w-v,q=(M-v)/H,Y=(R-v)/H,re=Math.min(q,Y),de=Math.max(q,Y),ze=p+$*re;let _e=Math.floor(Math.min(ze,C)/this._granularityCellSize)+1,G=Math.ceil(Math.max(ze,C)/this._granularityCellSize)-1,ie=C<ze;const ve=H===0;if(ve&&(w===M||w===R))return;if(ve||re>=1||de<=0){const ht=c-w,Ye=b+(a-b)*Math.min((M-w)/ht,(R-w)/ht);_e=Math.floor(Math.min(Ye,C)/this._granularityCellSize)+1,G=Math.ceil(Math.max(Ye,C)/this._granularityCellSize)-1,ie=C<Ye}const He=L>0?R:M;if(ie)for(let ht=_e;ht<=G;ht++)n.push(this._vertexToIndex(ht*this._granularityCellSize,He));else for(let ht=G;ht>=_e;ht--)n.push(this._vertexToIndex(ht*this._granularityCellSize,He))}_generateOutline(n){const a=[];for(const c of n){const p=Al(c,this._granularity,!0),v=this._pointArrayToIndices(p),b=[];for(let w=1;w<v.length;w++)b.push(v[w-1]),b.push(v[w]);a.push(b)}return a}_handlePoles(n){let a=!1,c=!1;this._canonical&&(this._canonical.y===0&&(a=!0),this._canonical.y===(1<<this._canonical.z)-1&&(c=!0)),(a||c)&&this._fillPoles(n,a,c)}_ensureNoPoleVertices(){const n=this._vertexBuffer;for(let a=0;a<n.length;a+=2){const c=n[a+1];c===Gc&&(n[a+1]=-32767),c===Rd&&(n[a+1]=32766)}}_generatePoleQuad(n,a,c,p,v,b){p>v!=(b===Gc)?(n.push(a),n.push(c),n.push(this._vertexToIndex(p,b)),n.push(c),n.push(this._vertexToIndex(v,b)),n.push(this._vertexToIndex(p,b))):(n.push(c),n.push(a),n.push(this._vertexToIndex(p,b)),n.push(this._vertexToIndex(v,b)),n.push(c),n.push(this._vertexToIndex(p,b)))}_fillPoles(n,a,c){const p=this._vertexBuffer,v=je,b=n.length;for(let w=2;w<b;w+=3){const C=n[w-2],M=n[w-1],R=n[w],L=p[2*C],$=p[2*C+1],H=p[2*M],q=p[2*M+1],Y=p[2*R],re=p[2*R+1];a&&($===0&&q===0&&this._generatePoleQuad(n,C,M,L,H,Gc),q===0&&re===0&&this._generatePoleQuad(n,M,R,H,Y,Gc),re===0&&$===0&&this._generatePoleQuad(n,R,C,Y,L,Gc)),c&&($===v&&q===v&&this._generatePoleQuad(n,C,M,L,H,Rd),q===v&&re===v&&this._generatePoleQuad(n,M,R,H,Y,Rd),re===v&&$===v&&this._generatePoleQuad(n,R,C,Y,L,Rd))}}_initializeVertices(n){for(let a=0;a<n.length;a+=2)this._vertexToIndex(n[a],n[a+1])}subdividePolygonInternal(n,a){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:c,holeIndices:p}=function(w){const C=[],M=[];for(const R of w)if(R.length!==0){R!==w[0]&&C.push(M.length/2);for(let L=0;L<R.length;L++)M.push(R[L].x),M.push(R[L].y)}return{flattened:M,holeIndices:C}}(n);let v;this._initializeVertices(c);try{const w=function(M,R,L=2){const $=R&&R.length,H=$?R[0]*L:M.length;let q=Cv(M,0,H,L,!0);const Y=[];if(!q||q.next===q.prev)return Y;let re,de,ze;if($&&(q=function(_e,G,ie,ve){const He=[];for(let ht=0,Ye=G.length;ht<Ye;ht++){const nt=Cv(_e,G[ht]*ve,ht<Ye-1?G[ht+1]*ve:_e.length,ve,!1);nt===nt.next&&(nt.steiner=!0),He.push(v2(nt))}He.sort(g2);for(let ht=0;ht<He.length;ht++)ie=_2(He[ht],ie);return ie}(M,R,q,L)),M.length>80*L){re=1/0,de=1/0;let _e=-1/0,G=-1/0;for(let ie=L;ie<H;ie+=L){const ve=M[ie],He=M[ie+1];ve<re&&(re=ve),He<de&&(de=He),ve>_e&&(_e=ve),He>G&&(G=He)}ze=Math.max(_e-re,G-de),ze=ze!==0?32767/ze:0}return Id(q,Y,L,re,de,ze,0),Y}(c,p),C=this._convertIndices(c,w);v=this._subdivideTrianglesScanline(C)}catch(w){console.error(w)}let b=[];return a&&(b=this._generateOutline(n)),this._ensureNoPoleVertices(),this._handlePoles(v),{verticesFlattened:this._vertexBuffer,indicesTriangles:v,indicesLineList:b}}_convertIndices(n,a){const c=[];for(let p=0;p<a.length;p++)c.push(this._vertexToIndex(n[2*a[p]],n[2*a[p]+1]));return c}_pointArrayToIndices(n){const a=[];for(let c=0;c<n.length;c++){const p=n[c];a.push(this._vertexToIndex(p.x,p.y))}return a}}function Mv(s,n,a,c=!0){return new x2(a,n).subdividePolygonInternal(s,c)}function Al(s,n,a=!1){if(!s||s.length<1)return[];if(s.length<2)return[];const c=s[0],p=s[s.length-1],v=a&&(c.x!==p.x||c.y!==p.y);if(n<2)return v?[...s,s[0]]:[...s];const b=Math.floor(je/n),w=[];w.push(new B(s[0].x,s[0].y));const C=s.length,M=v?C:C-1;for(let R=0;R<M;R++){const L=s[R],$=R<C-1?s[R+1]:s[0],H=L.x,q=L.y,Y=$.x,re=$.y,de=H!==Y,ze=q!==re;if(!de&&!ze)continue;const _e=Y-H,G=re-q,ie=Math.abs(_e),ve=Math.abs(G);let He=H,ht=q;for(;;){const nt=_e>0?(Math.floor(He/b)+1)*b:(Math.ceil(He/b)-1)*b,yt=G>0?(Math.floor(ht/b)+1)*b:(Math.ceil(ht/b)-1)*b,mt=Math.abs(He-nt),bt=Math.abs(ht-yt),at=Math.abs(He-Y),jt=Math.abs(ht-re),Qt=de?mt/ie:Number.POSITIVE_INFINITY,Kt=ze?bt/ve:Number.POSITIVE_INFINITY;if((at<=mt||!de)&&(jt<=bt||!ze))break;if(Qt<Kt&&de||!ze){He=nt,ht+=G*Qt;const Gt=new B(He,Math.round(ht));w[w.length-1].x===Gt.x&&w[w.length-1].y===Gt.y||w.push(Gt)}else{He+=_e*Kt,ht=yt;const Gt=new B(Math.round(He),ht);w[w.length-1].x===Gt.x&&w[w.length-1].y===Gt.y||w.push(Gt)}}const Ye=new B(Y,re);w[w.length-1].x===Ye.x&&w[w.length-1].y===Ye.y||w.push(Ye)}return w}function w2(s,n,a){if(n.length===0)throw new Error("Subdivision vertex ring is empty.");let c=0,p=s[2*n[0]];for(let C=1;C<n.length;C++){const M=s[2*n[C]];M<p&&(p=M,c=C)}const v=n.length;let b=c,w=(b+1)%v;for(;;){const C=b-1>=0?b-1:v-1,M=(w+1)%v,R=s[2*n[C]],L=s[2*n[M]],$=s[2*n[b]],H=s[2*n[b]+1],q=s[2*n[w]+1];let Y=!1;if(R<L)Y=!0;else if(R>L)Y=!1;else{const re=q-H,de=-(s[2*n[w]]-$),ze=H<q?1:-1;((R-$)*re+(s[2*n[C]+1]-H)*de)*ze>((L-$)*re+(s[2*n[M]+1]-H)*de)*ze&&(Y=!0)}if(Y){const re=n[C],de=n[b],ze=n[w];re!==de&&re!==ze&&de!==ze&&a.push(ze,de,re),b--,b<0&&(b=v-1)}else{const re=n[M],de=n[b],ze=n[w];re!==de&&re!==ze&&de!==ze&&a.push(ze,de,re),w++,w>=v&&(w=0)}if(C===M)break}}function Ev(s,n,a,c,p,v,b,w,C){const M=p.length/2,R=b&&w&&C;if(M<Dt.MAX_VERTEX_ARRAY_LENGTH){const L=n.prepareSegment(M,a,c),$=L.vertexLength;for(let Y=0;Y<v.length;Y+=3)c.emplaceBack($+v[Y],$+v[Y+1],$+v[Y+2]);let H,q;L.vertexLength+=M,L.primitiveLength+=v.length/3,R&&(q=b.prepareSegment(M,a,w),H=q.vertexLength,q.vertexLength+=M);for(let Y=0;Y<p.length;Y+=2)s(p[Y],p[Y+1]);if(R)for(let Y=0;Y<C.length;Y++){const re=C[Y];for(let de=1;de<re.length;de+=2)w.emplaceBack(H+re[de-1],H+re[de]);q.primitiveLength+=re.length/2}}else(function(L,$,H,q,Y,re){const de=[];for(let ve=0;ve<q.length/2;ve++)de.push(-1);const ze={count:0};let _e=0,G=L.getOrCreateLatestSegment($,H),ie=G.vertexLength;for(let ve=2;ve<Y.length;ve+=3){const He=Y[ve-2],ht=Y[ve-1],Ye=Y[ve];let nt=de[He]<_e,yt=de[ht]<_e,mt=de[Ye]<_e;G.vertexLength+((nt?1:0)+(yt?1:0)+(mt?1:0))>Dt.MAX_VERTEX_ARRAY_LENGTH&&(G=L.createNewSegment($,H),_e=ze.count,nt=!0,yt=!0,mt=!0,ie=0);const bt=Dd(de,q,re,ze,He,nt,G),at=Dd(de,q,re,ze,ht,yt,G),jt=Dd(de,q,re,ze,Ye,mt,G);H.emplaceBack(ie+bt-_e,ie+at-_e,ie+jt-_e),G.primitiveLength++}})(n,a,c,p,v,s),R&&function(L,$,H,q,Y,re){const de=[];for(let ve=0;ve<q.length/2;ve++)de.push(-1);const ze={count:0};let _e=0,G=L.getOrCreateLatestSegment($,H),ie=G.vertexLength;for(let ve=0;ve<Y.length;ve++){const He=Y[ve];for(let ht=1;ht<Y[ve].length;ht+=2){const Ye=He[ht-1],nt=He[ht];let yt=de[Ye]<_e,mt=de[nt]<_e;G.vertexLength+((yt?1:0)+(mt?1:0))>Dt.MAX_VERTEX_ARRAY_LENGTH&&(G=L.createNewSegment($,H),_e=ze.count,yt=!0,mt=!0,ie=0);const bt=Dd(de,q,re,ze,Ye,yt,G),at=Dd(de,q,re,ze,nt,mt,G);H.emplaceBack(ie+bt-_e,ie+at-_e),G.primitiveLength++}}}(b,a,w,p,C,s),n.forceNewSegmentOnNextPrepare(),b==null||b.forceNewSegmentOnNextPrepare()}function Dd(s,n,a,c,p,v,b){if(v){const w=c.count;return a(n[2*p],n[2*p+1]),s[p]=c.count,c.count++,b.vertexLength++,w}return s[p]}class pg{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new fe,this.indexArray=new et,this.indexArray2=new Pt,this.programConfigurations=new xi(n.layers,n.zoom),this.segments=new Dt,this.segments2=new Dt,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(n,a,c){this.hasPattern=ug("fill",this.layers,a);const p=this.layers[0].layout.get("fill-sort-key"),v=!p.isConstant(),b=[];for(const{feature:w,id:C,index:M,sourceLayerIndex:R}of n){const L=this.layers[0]._featureFilter.needGeometry,$=qs(w,L);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),$,c))continue;const H=v?p.evaluate($,{},c,a.availableImages):void 0,q={id:C,properties:w.properties,type:w.type,sourceLayerIndex:R,index:M,geometry:L?$.geometry:Zs(w),patterns:{},sortKey:H};b.push(q)}v&&b.sort((w,C)=>w.sortKey-C.sortKey);for(const w of b){const{geometry:C,index:M,sourceLayerIndex:R}=w;if(this.hasPattern){const L=dg("fill",this.layers,w,this.zoom,a);this.patternFeatures.push(L)}else this.addFeature(w,C,M,c,{},a.subdivisionGranularity);a.featureIndex.insert(n[M].feature,C,M,R,this.index)}}update(n,a,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,a,this.stateDependentLayers,c)}addFeatures(n,a,c){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,a,c,n.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,d2),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,a,c,p,v,b){for(const w of uc(a,500)){const C=Mv(w,p,b.fill.getGranularityForZoomLevel(p.z)),M=this.layoutVertexArray;Ev((R,L)=>{M.emplaceBack(R,L)},this.segments,this.layoutVertexArray,this.indexArray,C.verticesFlattened,C.indicesTriangles,this.segments2,this.indexArray2,C.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,v,p)}}let Av,Rv;Ft("FillBucket",pg,{omit:["layers","patternFeatures"]});var S2={get paint(){return Rv=Rv||new Ar({"fill-antialias":new Zt(ae.paint_fill["fill-antialias"]),"fill-opacity":new sn(ae.paint_fill["fill-opacity"]),"fill-color":new sn(ae.paint_fill["fill-color"]),"fill-outline-color":new sn(ae.paint_fill["fill-outline-color"]),"fill-translate":new Zt(ae.paint_fill["fill-translate"]),"fill-translate-anchor":new Zt(ae.paint_fill["fill-translate-anchor"]),"fill-pattern":new xl(ae.paint_fill["fill-pattern"])})},get layout(){return Av=Av||new Ar({"fill-sort-key":new sn(ae.layout_fill["fill-sort-key"])})}};class C2 extends Aa{constructor(n){super(n,S2)}recalculate(n,a){super.recalculate(n,a);const c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new pg(n)}queryRadius(){return Uf(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:n,geometry:a,transform:c,pixelsToTileUnits:p}){return Cd(Gf(n,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-c.bearingInRadians,p),a)}isTileClipped(){return!0}}const T2=zi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),P2=zi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:k2}=T2;var mg,Dv,gg,zv,_g,Lv,Bv,Wf={};function Fv(){if(Dv)return mg;Dv=1;var s=z();function n(p,v,b,w,C){this.properties={},this.extent=b,this.type=0,this._pbf=p,this._geometry=-1,this._keys=w,this._values=C,p.readFields(a,this,v)}function a(p,v,b){p==1?v.id=b.readVarint():p==2?function(w,C){for(var M=w.readVarint()+w.pos;w.pos<M;){var R=C._keys[w.readVarint()],L=C._values[w.readVarint()];C.properties[R]=L}}(b,v):p==3?v.type=b.readVarint():p==4&&(v._geometry=b.pos)}function c(p){for(var v,b,w=0,C=0,M=p.length,R=M-1;C<M;R=C++)w+=((b=p[R]).x-(v=p[C]).x)*(v.y+b.y);return w}return mg=n,n.types=["Unknown","Point","LineString","Polygon"],n.prototype.loadGeometry=function(){var p=this._pbf;p.pos=this._geometry;for(var v,b=p.readVarint()+p.pos,w=1,C=0,M=0,R=0,L=[];p.pos<b;){if(C<=0){var $=p.readVarint();w=7&$,C=$>>3}if(C--,w===1||w===2)M+=p.readSVarint(),R+=p.readSVarint(),w===1&&(v&&L.push(v),v=[]),v.push(new s(M,R));else{if(w!==7)throw new Error("unknown command "+w);v&&v.push(v[0].clone())}}return v&&L.push(v),L},n.prototype.bbox=function(){var p=this._pbf;p.pos=this._geometry;for(var v=p.readVarint()+p.pos,b=1,w=0,C=0,M=0,R=1/0,L=-1/0,$=1/0,H=-1/0;p.pos<v;){if(w<=0){var q=p.readVarint();b=7&q,w=q>>3}if(w--,b===1||b===2)(C+=p.readSVarint())<R&&(R=C),C>L&&(L=C),(M+=p.readSVarint())<$&&($=M),M>H&&(H=M);else if(b!==7)throw new Error("unknown command "+b)}return[R,$,L,H]},n.prototype.toGeoJSON=function(p,v,b){var w,C,M=this.extent*Math.pow(2,b),R=this.extent*p,L=this.extent*v,$=this.loadGeometry(),H=n.types[this.type];function q(de){for(var ze=0;ze<de.length;ze++){var _e=de[ze];de[ze]=[360*(_e.x+R)/M-180,360/Math.PI*Math.atan(Math.exp((180-360*(_e.y+L)/M)*Math.PI/180))-90]}}switch(this.type){case 1:var Y=[];for(w=0;w<$.length;w++)Y[w]=$[w][0];q($=Y);break;case 2:for(w=0;w<$.length;w++)q($[w]);break;case 3:for($=function(de){var ze=de.length;if(ze<=1)return[de];for(var _e,G,ie=[],ve=0;ve<ze;ve++){var He=c(de[ve]);He!==0&&(G===void 0&&(G=He<0),G===He<0?(_e&&ie.push(_e),_e=[de[ve]]):_e.push(de[ve]))}return _e&&ie.push(_e),ie}($),w=0;w<$.length;w++)for(C=0;C<$[w].length;C++)q($[w][C])}$.length===1?$=$[0]:H="Multi"+H;var re={type:"Feature",geometry:{type:H,coordinates:$},properties:this.properties};return"id"in this&&(re.id=this.id),re},mg}function Ov(){if(zv)return gg;zv=1;var s=Fv();function n(c,p){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(a,this,p),this.length=this._features.length}function a(c,p,v){c===15?p.version=v.readVarint():c===1?p.name=v.readString():c===5?p.extent=v.readVarint():c===2?p._features.push(v.pos):c===3?p._keys.push(v.readString()):c===4&&p._values.push(function(b){for(var w=null,C=b.readVarint()+b.pos;b.pos<C;){var M=b.readVarint()>>3;w=M===1?b.readString():M===2?b.readFloat():M===3?b.readDouble():M===4?b.readVarint64():M===5?b.readVarint():M===6?b.readSVarint():M===7?b.readBoolean():null}return w}(v))}return gg=n,n.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var p=this._pbf.readVarint()+this._pbf.pos;return new s(this._pbf,p,this.extent,this._keys,this._values)},gg}function Vv(){return Bv||(Bv=1,Wf.VectorTile=function(){if(Lv)return _g;Lv=1;var s=Ov();function n(a,c,p){if(a===3){var v=new s(p,p.readVarint()+p.pos);v.length&&(c[v.name]=v)}}return _g=function(a,c){this.layers=a.readFields(n,{},c)},_g}(),Wf.VectorTileFeature=Fv(),Wf.VectorTileLayer=Ov()),Wf}var zd=T(Vv());const I2=zd.VectorTileFeature.types,yg=Math.pow(2,13);function Ld(s,n,a,c,p,v,b,w){s.emplaceBack(n,a,2*Math.floor(c*yg)+b,p*yg*2,v*yg*2,Math.round(w))}class vg{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new we,this.centroidVertexArray=new se,this.indexArray=new et,this.programConfigurations=new xi(n.layers,n.zoom),this.segments=new Dt,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(n,a,c){this.features=[],this.hasPattern=ug("fill-extrusion",this.layers,a);for(const{feature:p,id:v,index:b,sourceLayerIndex:w}of n){const C=this.layers[0]._featureFilter.needGeometry,M=qs(p,C);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),M,c))continue;const R={id:v,sourceLayerIndex:w,index:b,geometry:C?M.geometry:Zs(p),properties:p.properties,type:p.type,patterns:{}};this.hasPattern?this.features.push(dg("fill-extrusion",this.layers,R,this.zoom,a)):this.addFeature(R,R.geometry,b,c,{},a.subdivisionGranularity),a.featureIndex.insert(p,R.geometry,b,w,this.index,!0)}}addFeatures(n,a,c){for(const p of this.features){const{geometry:v}=p;this.addFeature(p,v,p.index,a,c,n.subdivisionGranularity)}}update(n,a,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,a,this.stateDependentLayers,c)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,k2),this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,P2.members,!0),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(n,a,c,p,v,b){for(const w of uc(a,500)){const C={x:0,y:0,sampleCount:0},M=this.layoutVertexArray.length;this.processPolygon(C,p,n,w,b);const R=this.layoutVertexArray.length-M,L=Math.floor(C.x/C.sampleCount),$=Math.floor(C.y/C.sampleCount);for(let H=0;H<R;H++)this.centroidVertexArray.emplaceBack(L,$)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,v,p)}processPolygon(n,a,c,p,v){if(p.length<1||Nv(p[0]))return;for(const L of p)L.length!==0&&M2(n,L);const b={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},w=v.fill.getGranularityForZoomLevel(a.z),C=I2[c.type]==="Polygon";for(const L of p){if(L.length===0||Nv(L))continue;const $=Al(L,w,C);this._generateSideFaces($,b)}if(!C)return;const M=Mv(p,a,w,!1),R=this.layoutVertexArray;Ev((L,$)=>{Ld(R,L,$,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,M.verticesFlattened,M.indicesTriangles)}_generateSideFaces(n,a){let c=0;for(let p=1;p<n.length;p++){const v=n[p],b=n[p-1];if(E2(v,b))continue;a.segment.vertexLength+4>Dt.MAX_VERTEX_ARRAY_LENGTH&&(a.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const w=v.sub(b)._perp()._unit(),C=b.dist(v);c+C>32768&&(c=0),Ld(this.layoutVertexArray,v.x,v.y,w.x,w.y,0,0,c),Ld(this.layoutVertexArray,v.x,v.y,w.x,w.y,0,1,c),c+=C,Ld(this.layoutVertexArray,b.x,b.y,w.x,w.y,0,0,c),Ld(this.layoutVertexArray,b.x,b.y,w.x,w.y,0,1,c);const M=a.segment.vertexLength;this.indexArray.emplaceBack(M,M+2,M+1),this.indexArray.emplaceBack(M+1,M+2,M+3),a.segment.vertexLength+=4,a.segment.primitiveLength+=2}}}function M2(s,n){for(let a=0;a<n.length;a++){const c=n[a];a===n.length-1&&n[0].x===c.x&&n[0].y===c.y||(s.x+=c.x,s.y+=c.y,s.sampleCount++)}}function E2(s,n){return s.x===n.x&&(s.x<0||s.x>je)||s.y===n.y&&(s.y<0||s.y>je)}function Nv(s){return s.every(n=>n.x<0)||s.every(n=>n.x>je)||s.every(n=>n.y<0)||s.every(n=>n.y>je)}let $v;Ft("FillExtrusionBucket",vg,{omit:["layers","features"]});var A2={get paint(){return $v=$v||new Ar({"fill-extrusion-opacity":new Zt(ae["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new sn(ae["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Zt(ae["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Zt(ae["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new xl(ae["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new sn(ae["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new sn(ae["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Zt(ae["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class R2 extends Aa{constructor(n){super(n,A2)}createBucket(n){return new vg(n)}queryRadius(){return Uf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:n,feature:a,featureState:c,geometry:p,transform:v,pixelsToTileUnits:b,pixelPosMatrix:w}){const C=Gf(n,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-v.bearingInRadians,b),M=this.paint.get("fill-extrusion-height").evaluate(a,c),R=this.paint.get("fill-extrusion-base").evaluate(a,c),L=function(H,q,Y){const re=[];for(const de of H){const ze=[de.x,de.y,0,1];xe(ze,ze,q),re.push(new B(ze[0]/ze[3],ze[1]/ze[3]))}return re}(C,w),$=function(H,q,Y,re){const de=[],ze=[],_e=re[8]*q,G=re[9]*q,ie=re[10]*q,ve=re[11]*q,He=re[8]*Y,ht=re[9]*Y,Ye=re[10]*Y,nt=re[11]*Y;for(const yt of H){const mt=[],bt=[];for(const at of yt){const jt=at.x,Qt=at.y,Kt=re[0]*jt+re[4]*Qt+re[12],Gt=re[1]*jt+re[5]*Qt+re[13],Mn=re[2]*jt+re[6]*Qt+re[14],Mi=re[3]*jt+re[7]*Qt+re[15],Yi=Mn+ie,vr=Mi+ve,_a=Kt+He,Gr=Gt+ht,cr=Mn+Ye,wi=Mi+nt,nr=new B((Kt+_e)/vr,(Gt+G)/vr);nr.z=Yi/vr,mt.push(nr);const ur=new B(_a/wi,Gr/wi);ur.z=cr/wi,bt.push(ur)}de.push(mt),ze.push(bt)}return[de,ze]}(p,R,M,w);return function(H,q,Y){let re=1/0;Cd(Y,q)&&(re=jv(Y,q[0]));for(let de=0;de<q.length;de++){const ze=q[de],_e=H[de];for(let G=0;G<ze.length-1;G++){const ie=ze[G],ve=[ie,ze[G+1],_e[G+1],_e[G],ie];wd(Y,ve)&&(re=Math.min(re,jv(Y,ve)))}}return re!==1/0&&re}($[0],$[1],L)}}function Bd(s,n){return s.x*n.x+s.y*n.y}function jv(s,n){if(s.length===1){let a=0;const c=n[a++];let p;for(;!p||c.equals(p);)if(p=n[a++],!p)return 1/0;for(;a<n.length;a++){const v=n[a],b=s[0],w=p.sub(c),C=v.sub(c),M=b.sub(c),R=Bd(w,w),L=Bd(w,C),$=Bd(C,C),H=Bd(M,w),q=Bd(M,C),Y=R*$-L*L,re=($*H-L*q)/Y,de=(R*q-L*H)/Y,ze=c.z*(1-re-de)+p.z*re+v.z*de;if(isFinite(ze))return ze}return 1/0}{let a=1/0;for(const c of n)a=Math.min(a,c.z);return a}}const D2=zi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:z2}=D2,L2=zi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:B2}=L2,F2=zd.VectorTileFeature.types,O2=Math.cos(Math.PI/180*37.5),Uv=Math.pow(2,14)/.5;class bg{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new Te,this.layoutVertexArray2=new Ie,this.indexArray=new et,this.programConfigurations=new xi(n.layers,n.zoom),this.segments=new Dt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(n,a,c){this.hasPattern=ug("line",this.layers,a);const p=this.layers[0].layout.get("line-sort-key"),v=!p.isConstant(),b=[];for(const{feature:w,id:C,index:M,sourceLayerIndex:R}of n){const L=this.layers[0]._featureFilter.needGeometry,$=qs(w,L);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),$,c))continue;const H=v?p.evaluate($,{},c):void 0,q={id:C,properties:w.properties,type:w.type,sourceLayerIndex:R,index:M,geometry:L?$.geometry:Zs(w),patterns:{},sortKey:H};b.push(q)}v&&b.sort((w,C)=>w.sortKey-C.sortKey);for(const w of b){const{geometry:C,index:M,sourceLayerIndex:R}=w;if(this.hasPattern){const L=dg("line",this.layers,w,this.zoom,a);this.patternFeatures.push(L)}else this.addFeature(w,C,M,c,{},a.subdivisionGranularity);a.featureIndex.insert(n[M].feature,C,M,R,this.index)}}update(n,a,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,a,this.stateDependentLayers,c)}addFeatures(n,a,c){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,a,c,n.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,B2)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,z2),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,a,c,p,v,b){const w=this.layers[0].layout,C=w.get("line-join").evaluate(n,{}),M=w.get("line-cap"),R=w.get("line-miter-limit"),L=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const $ of a)this.addLine($,n,C,M,R,L,p,b);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,v,p)}addLine(n,a,c,p,v,b,w,C){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,n=Al(n,w?C.line.getGranularityForZoomLevel(w.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let _e=0;_e<n.length-1;_e++)this.totalDistance+=n[_e].dist(n[_e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const M=F2[a.type]==="Polygon";let R=n.length;for(;R>=2&&n[R-1].equals(n[R-2]);)R--;let L=0;for(;L<R-1&&n[L].equals(n[L+1]);)L++;if(R<(M?3:2))return;c==="bevel"&&(v=1.05);const $=this.overscaling<=16?15*je/(512*this.overscaling):0,H=this.segments.prepareSegment(10*R,this.layoutVertexArray,this.indexArray);let q,Y,re,de,ze;this.e1=this.e2=-1,M&&(q=n[R-2],ze=n[L].sub(q)._unit()._perp());for(let _e=L;_e<R;_e++){if(re=_e===R-1?M?n[L+1]:void 0:n[_e+1],re&&n[_e].equals(re))continue;ze&&(de=ze),q&&(Y=q),q=n[_e],ze=re?re.sub(q)._unit()._perp():de,de=de||ze;let G=de.add(ze);G.x===0&&G.y===0||G._unit();const ie=de.x*ze.x+de.y*ze.y,ve=G.x*ze.x+G.y*ze.y,He=ve!==0?1/ve:1/0,ht=2*Math.sqrt(2-2*ve),Ye=ve<O2&&Y&&re,nt=de.x*ze.y-de.y*ze.x>0;if(Ye&&_e>L){const bt=q.dist(Y);if(bt>2*$){const at=q.sub(q.sub(Y)._mult($/bt)._round());this.updateDistance(Y,at),this.addCurrentVertex(at,de,0,0,H),Y=at}}const yt=Y&&re;let mt=yt?c:M?"butt":p;if(yt&&mt==="round"&&(He<b?mt="miter":He<=2&&(mt="fakeround")),mt==="miter"&&He>v&&(mt="bevel"),mt==="bevel"&&(He>2&&(mt="flipbevel"),He<v&&(mt="miter")),Y&&this.updateDistance(Y,q),mt==="miter")G._mult(He),this.addCurrentVertex(q,G,0,0,H);else if(mt==="flipbevel"){if(He>100)G=ze.mult(-1);else{const bt=He*de.add(ze).mag()/de.sub(ze).mag();G._perp()._mult(bt*(nt?-1:1))}this.addCurrentVertex(q,G,0,0,H),this.addCurrentVertex(q,G.mult(-1),0,0,H)}else if(mt==="bevel"||mt==="fakeround"){const bt=-Math.sqrt(He*He-1),at=nt?bt:0,jt=nt?0:bt;if(Y&&this.addCurrentVertex(q,de,at,jt,H),mt==="fakeround"){const Qt=Math.round(180*ht/Math.PI/20);for(let Kt=1;Kt<Qt;Kt++){let Gt=Kt/Qt;if(Gt!==.5){const Mi=Gt-.5;Gt+=Gt*Mi*(Gt-1)*((1.0904+ie*(ie*(3.55645-1.43519*ie)-3.2452))*Mi*Mi+(.848013+ie*(.215638*ie-1.06021)))}const Mn=ze.sub(de)._mult(Gt)._add(de)._unit()._mult(nt?-1:1);this.addHalfVertex(q,Mn.x,Mn.y,!1,nt,0,H)}}re&&this.addCurrentVertex(q,ze,-at,-jt,H)}else if(mt==="butt")this.addCurrentVertex(q,G,0,0,H);else if(mt==="square"){const bt=Y?1:-1;this.addCurrentVertex(q,G,bt,bt,H)}else mt==="round"&&(Y&&(this.addCurrentVertex(q,de,0,0,H),this.addCurrentVertex(q,de,1,1,H,!0)),re&&(this.addCurrentVertex(q,ze,-1,-1,H,!0),this.addCurrentVertex(q,ze,0,0,H)));if(Ye&&_e<R-1){const bt=q.dist(re);if(bt>2*$){const at=q.add(re.sub(q)._mult($/bt)._round());this.updateDistance(q,at),this.addCurrentVertex(at,ze,0,0,H),q=at}}}}addCurrentVertex(n,a,c,p,v,b=!1){const w=a.y*p-a.x,C=-a.y-a.x*p;this.addHalfVertex(n,a.x+a.y*c,a.y-a.x*c,b,!1,c,v),this.addHalfVertex(n,w,C,b,!0,-p,v),this.distance>Uv/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(n,a,c,p,v,b))}addHalfVertex({x:n,y:a},c,p,v,b,w,C){const M=.5*(this.lineClips?this.scaledDistance*(Uv-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((n<<1)+(v?1:0),(a<<1)+(b?1:0),Math.round(63*c)+128,Math.round(63*p)+128,1+(w===0?0:w<0?-1:1)|(63&M)<<2,M>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const R=C.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,R,this.e2),C.primitiveLength++),b?this.e2=R:this.e1=R}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(n,a){this.distance+=n.dist(a),this.updateScaledDistance()}}let Gv,Hv;Ft("LineBucket",bg,{omit:["layers","patternFeatures"]});var Zv={get paint(){return Hv=Hv||new Ar({"line-opacity":new sn(ae.paint_line["line-opacity"]),"line-color":new sn(ae.paint_line["line-color"]),"line-translate":new Zt(ae.paint_line["line-translate"]),"line-translate-anchor":new Zt(ae.paint_line["line-translate-anchor"]),"line-width":new sn(ae.paint_line["line-width"]),"line-gap-width":new sn(ae.paint_line["line-gap-width"]),"line-offset":new sn(ae.paint_line["line-offset"]),"line-blur":new sn(ae.paint_line["line-blur"]),"line-dasharray":new Bc(ae.paint_line["line-dasharray"]),"line-pattern":new xl(ae.paint_line["line-pattern"]),"line-gradient":new Fc(ae.paint_line["line-gradient"])})},get layout(){return Gv=Gv||new Ar({"line-cap":new Zt(ae.layout_line["line-cap"]),"line-join":new sn(ae.layout_line["line-join"]),"line-miter-limit":new Zt(ae.layout_line["line-miter-limit"]),"line-round-limit":new Zt(ae.layout_line["line-round-limit"]),"line-sort-key":new sn(ae.layout_line["line-sort-key"])})}};class V2 extends sn{possiblyEvaluate(n,a){return a=new mi(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition}),super.possiblyEvaluate(n,a)}evaluate(n,a,c,p){return a=Yt({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(n,a,c,p)}}let Xf;class N2 extends Aa{constructor(n){super(n,Zv),this.gradientVersion=0,Xf||(Xf=new V2(Zv.paint.properties["line-width"].specification),Xf.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const a=this.gradientExpression();this.stepInterpolant=!!function(c){return c._styleExpression!==void 0}(a)&&a._styleExpression.expression instanceof Ls,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,a){super.recalculate(n,a),this.paint._values["line-floorwidth"]=Xf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new bg(n)}queryRadius(n){const a=n,c=qv(Pd("line-width",this,a),Pd("line-gap-width",this,a)),p=Pd("line-offset",this,a);return c/2+Math.abs(p)+Uf(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:n,feature:a,featureState:c,geometry:p,transform:v,pixelsToTileUnits:b}){const w=Gf(n,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-v.bearingInRadians,b),C=b/2*qv(this.paint.get("line-width").evaluate(a,c),this.paint.get("line-gap-width").evaluate(a,c)),M=this.paint.get("line-offset").evaluate(a,c);return M&&(p=function(R,L){const $=[];for(let H=0;H<R.length;H++){const q=R[H],Y=[];for(let re=0;re<q.length;re++){const de=q[re-1],ze=q[re],_e=q[re+1],G=re===0?new B(0,0):ze.sub(de)._unit()._perp(),ie=re===q.length-1?new B(0,0):_e.sub(ze)._unit()._perp(),ve=G._add(ie)._unit(),He=ve.x*ie.x+ve.y*ie.y;He!==0&&ve._mult(1/He),Y.push(ve._mult(L)._add(ze))}$.push(Y)}return $}(p,M*b)),function(R,L,$){for(let H=0;H<L.length;H++){const q=L[H];if(R.length>=3){for(let Y=0;Y<q.length;Y++)if($c(R,q[Y]))return!0}if(Td(R,q,$))return!0}return!1}(w,p,C)}isTileClipped(){return!0}}function qv(s,n){return n>0?n+2*s:s}const $2=zi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),j2=zi([{name:"a_projected_pos",components:3,type:"Float32"}],4);zi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const U2=zi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);zi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Wv=zi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),G2=zi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function H2(s,n,a){return s.sections.forEach(c=>{c.text=function(p,v,b){const w=v.layout.get("text-transform").evaluate(b,{});return w==="uppercase"?p=p.toLocaleUpperCase():w==="lowercase"&&(p=p.toLocaleLowerCase()),qa.applyArabicShaping&&(p=qa.applyArabicShaping(p)),p}(c.text,n,a)}),s}zi([{name:"triangle",components:3,type:"Uint16"}]),zi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),zi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),zi([{type:"Float32",name:"offsetX"}]),zi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),zi([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Fd={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Xv,xg,Kv,Ki=24,wg={};function Z2(){return Xv||(Xv=1,wg.read=function(s,n,a,c,p){var v,b,w=8*p-c-1,C=(1<<w)-1,M=C>>1,R=-7,L=a?p-1:0,$=a?-1:1,H=s[n+L];for(L+=$,v=H&(1<<-R)-1,H>>=-R,R+=w;R>0;v=256*v+s[n+L],L+=$,R-=8);for(b=v&(1<<-R)-1,v>>=-R,R+=c;R>0;b=256*b+s[n+L],L+=$,R-=8);if(v===0)v=1-M;else{if(v===C)return b?NaN:1/0*(H?-1:1);b+=Math.pow(2,c),v-=M}return(H?-1:1)*b*Math.pow(2,v-c)},wg.write=function(s,n,a,c,p,v){var b,w,C,M=8*v-p-1,R=(1<<M)-1,L=R>>1,$=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,H=c?0:v-1,q=c?1:-1,Y=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(w=isNaN(n)?1:0,b=R):(b=Math.floor(Math.log(n)/Math.LN2),n*(C=Math.pow(2,-b))<1&&(b--,C*=2),(n+=b+L>=1?$/C:$*Math.pow(2,1-L))*C>=2&&(b++,C/=2),b+L>=R?(w=0,b=R):b+L>=1?(w=(n*C-1)*Math.pow(2,p),b+=L):(w=n*Math.pow(2,L-1)*Math.pow(2,p),b=0));p>=8;s[a+H]=255&w,H+=q,w/=256,p-=8);for(b=b<<p|w,M+=p;M>0;s[a+H]=255&b,H+=q,b/=256,M-=8);s[a+H-q]|=128*Y}),wg}function Yv(){if(Kv)return xg;Kv=1,xg=n;var s=Z2();function n(G){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(G)?G:new Uint8Array(G||0),this.pos=0,this.type=0,this.length=this.buf.length}n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var a=4294967296,c=1/a,p=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function v(G){return G.type===n.Bytes?G.readVarint()+G.pos:G.pos+1}function b(G,ie,ve){return ve?4294967296*ie+(G>>>0):4294967296*(ie>>>0)+(G>>>0)}function w(G,ie,ve){var He=ie<=16383?1:ie<=2097151?2:ie<=268435455?3:Math.floor(Math.log(ie)/(7*Math.LN2));ve.realloc(He);for(var ht=ve.pos-1;ht>=G;ht--)ve.buf[ht+He]=ve.buf[ht]}function C(G,ie){for(var ve=0;ve<G.length;ve++)ie.writeVarint(G[ve])}function M(G,ie){for(var ve=0;ve<G.length;ve++)ie.writeSVarint(G[ve])}function R(G,ie){for(var ve=0;ve<G.length;ve++)ie.writeFloat(G[ve])}function L(G,ie){for(var ve=0;ve<G.length;ve++)ie.writeDouble(G[ve])}function $(G,ie){for(var ve=0;ve<G.length;ve++)ie.writeBoolean(G[ve])}function H(G,ie){for(var ve=0;ve<G.length;ve++)ie.writeFixed32(G[ve])}function q(G,ie){for(var ve=0;ve<G.length;ve++)ie.writeSFixed32(G[ve])}function Y(G,ie){for(var ve=0;ve<G.length;ve++)ie.writeFixed64(G[ve])}function re(G,ie){for(var ve=0;ve<G.length;ve++)ie.writeSFixed64(G[ve])}function de(G,ie){return(G[ie]|G[ie+1]<<8|G[ie+2]<<16)+16777216*G[ie+3]}function ze(G,ie,ve){G[ve]=ie,G[ve+1]=ie>>>8,G[ve+2]=ie>>>16,G[ve+3]=ie>>>24}function _e(G,ie){return(G[ie]|G[ie+1]<<8|G[ie+2]<<16)+(G[ie+3]<<24)}return n.prototype={destroy:function(){this.buf=null},readFields:function(G,ie,ve){for(ve=ve||this.length;this.pos<ve;){var He=this.readVarint(),ht=He>>3,Ye=this.pos;this.type=7&He,G(ht,ie,this),this.pos===Ye&&this.skip(He)}return ie},readMessage:function(G,ie){return this.readFields(G,ie,this.readVarint()+this.pos)},readFixed32:function(){var G=de(this.buf,this.pos);return this.pos+=4,G},readSFixed32:function(){var G=_e(this.buf,this.pos);return this.pos+=4,G},readFixed64:function(){var G=de(this.buf,this.pos)+de(this.buf,this.pos+4)*a;return this.pos+=8,G},readSFixed64:function(){var G=de(this.buf,this.pos)+_e(this.buf,this.pos+4)*a;return this.pos+=8,G},readFloat:function(){var G=s.read(this.buf,this.pos,!0,23,4);return this.pos+=4,G},readDouble:function(){var G=s.read(this.buf,this.pos,!0,52,8);return this.pos+=8,G},readVarint:function(G){var ie,ve,He=this.buf;return ie=127&(ve=He[this.pos++]),ve<128?ie:(ie|=(127&(ve=He[this.pos++]))<<7,ve<128?ie:(ie|=(127&(ve=He[this.pos++]))<<14,ve<128?ie:(ie|=(127&(ve=He[this.pos++]))<<21,ve<128?ie:function(ht,Ye,nt){var yt,mt,bt=nt.buf;if(yt=(112&(mt=bt[nt.pos++]))>>4,mt<128||(yt|=(127&(mt=bt[nt.pos++]))<<3,mt<128)||(yt|=(127&(mt=bt[nt.pos++]))<<10,mt<128)||(yt|=(127&(mt=bt[nt.pos++]))<<17,mt<128)||(yt|=(127&(mt=bt[nt.pos++]))<<24,mt<128)||(yt|=(1&(mt=bt[nt.pos++]))<<31,mt<128))return b(ht,yt,Ye);throw new Error("Expected varint not more than 10 bytes")}(ie|=(15&(ve=He[this.pos]))<<28,G,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var G=this.readVarint();return G%2==1?(G+1)/-2:G/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var G=this.readVarint()+this.pos,ie=this.pos;return this.pos=G,G-ie>=12&&p?function(ve,He,ht){return p.decode(ve.subarray(He,ht))}(this.buf,ie,G):function(ve,He,ht){for(var Ye="",nt=He;nt<ht;){var yt,mt,bt,at=ve[nt],jt=null,Qt=at>239?4:at>223?3:at>191?2:1;if(nt+Qt>ht)break;Qt===1?at<128&&(jt=at):Qt===2?(192&(yt=ve[nt+1]))==128&&(jt=(31&at)<<6|63&yt)<=127&&(jt=null):Qt===3?(mt=ve[nt+2],(192&(yt=ve[nt+1]))==128&&(192&mt)==128&&((jt=(15&at)<<12|(63&yt)<<6|63&mt)<=2047||jt>=55296&&jt<=57343)&&(jt=null)):Qt===4&&(mt=ve[nt+2],bt=ve[nt+3],(192&(yt=ve[nt+1]))==128&&(192&mt)==128&&(192&bt)==128&&((jt=(15&at)<<18|(63&yt)<<12|(63&mt)<<6|63&bt)<=65535||jt>=1114112)&&(jt=null)),jt===null?(jt=65533,Qt=1):jt>65535&&(jt-=65536,Ye+=String.fromCharCode(jt>>>10&1023|55296),jt=56320|1023&jt),Ye+=String.fromCharCode(jt),nt+=Qt}return Ye}(this.buf,ie,G)},readBytes:function(){var G=this.readVarint()+this.pos,ie=this.buf.subarray(this.pos,G);return this.pos=G,ie},readPackedVarint:function(G,ie){if(this.type!==n.Bytes)return G.push(this.readVarint(ie));var ve=v(this);for(G=G||[];this.pos<ve;)G.push(this.readVarint(ie));return G},readPackedSVarint:function(G){if(this.type!==n.Bytes)return G.push(this.readSVarint());var ie=v(this);for(G=G||[];this.pos<ie;)G.push(this.readSVarint());return G},readPackedBoolean:function(G){if(this.type!==n.Bytes)return G.push(this.readBoolean());var ie=v(this);for(G=G||[];this.pos<ie;)G.push(this.readBoolean());return G},readPackedFloat:function(G){if(this.type!==n.Bytes)return G.push(this.readFloat());var ie=v(this);for(G=G||[];this.pos<ie;)G.push(this.readFloat());return G},readPackedDouble:function(G){if(this.type!==n.Bytes)return G.push(this.readDouble());var ie=v(this);for(G=G||[];this.pos<ie;)G.push(this.readDouble());return G},readPackedFixed32:function(G){if(this.type!==n.Bytes)return G.push(this.readFixed32());var ie=v(this);for(G=G||[];this.pos<ie;)G.push(this.readFixed32());return G},readPackedSFixed32:function(G){if(this.type!==n.Bytes)return G.push(this.readSFixed32());var ie=v(this);for(G=G||[];this.pos<ie;)G.push(this.readSFixed32());return G},readPackedFixed64:function(G){if(this.type!==n.Bytes)return G.push(this.readFixed64());var ie=v(this);for(G=G||[];this.pos<ie;)G.push(this.readFixed64());return G},readPackedSFixed64:function(G){if(this.type!==n.Bytes)return G.push(this.readSFixed64());var ie=v(this);for(G=G||[];this.pos<ie;)G.push(this.readSFixed64());return G},skip:function(G){var ie=7&G;if(ie===n.Varint)for(;this.buf[this.pos++]>127;);else if(ie===n.Bytes)this.pos=this.readVarint()+this.pos;else if(ie===n.Fixed32)this.pos+=4;else{if(ie!==n.Fixed64)throw new Error("Unimplemented type: "+ie);this.pos+=8}},writeTag:function(G,ie){this.writeVarint(G<<3|ie)},realloc:function(G){for(var ie=this.length||16;ie<this.pos+G;)ie*=2;if(ie!==this.length){var ve=new Uint8Array(ie);ve.set(this.buf),this.buf=ve,this.length=ie}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(G){this.realloc(4),ze(this.buf,G,this.pos),this.pos+=4},writeSFixed32:function(G){this.realloc(4),ze(this.buf,G,this.pos),this.pos+=4},writeFixed64:function(G){this.realloc(8),ze(this.buf,-1&G,this.pos),ze(this.buf,Math.floor(G*c),this.pos+4),this.pos+=8},writeSFixed64:function(G){this.realloc(8),ze(this.buf,-1&G,this.pos),ze(this.buf,Math.floor(G*c),this.pos+4),this.pos+=8},writeVarint:function(G){(G=+G||0)>268435455||G<0?function(ie,ve){var He,ht;if(ie>=0?(He=ie%4294967296|0,ht=ie/4294967296|0):(ht=~(-ie/4294967296),4294967295^(He=~(-ie%4294967296))?He=He+1|0:(He=0,ht=ht+1|0)),ie>=18446744073709552e3||ie<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ve.realloc(10),function(Ye,nt,yt){yt.buf[yt.pos++]=127&Ye|128,Ye>>>=7,yt.buf[yt.pos++]=127&Ye|128,Ye>>>=7,yt.buf[yt.pos++]=127&Ye|128,Ye>>>=7,yt.buf[yt.pos++]=127&Ye|128,yt.buf[yt.pos]=127&(Ye>>>=7)}(He,0,ve),function(Ye,nt){var yt=(7&Ye)<<4;nt.buf[nt.pos++]|=yt|((Ye>>>=3)?128:0),Ye&&(nt.buf[nt.pos++]=127&Ye|((Ye>>>=7)?128:0),Ye&&(nt.buf[nt.pos++]=127&Ye|((Ye>>>=7)?128:0),Ye&&(nt.buf[nt.pos++]=127&Ye|((Ye>>>=7)?128:0),Ye&&(nt.buf[nt.pos++]=127&Ye|((Ye>>>=7)?128:0),Ye&&(nt.buf[nt.pos++]=127&Ye)))))}(ht,ve)}(G,this):(this.realloc(4),this.buf[this.pos++]=127&G|(G>127?128:0),G<=127||(this.buf[this.pos++]=127&(G>>>=7)|(G>127?128:0),G<=127||(this.buf[this.pos++]=127&(G>>>=7)|(G>127?128:0),G<=127||(this.buf[this.pos++]=G>>>7&127))))},writeSVarint:function(G){this.writeVarint(G<0?2*-G-1:2*G)},writeBoolean:function(G){this.writeVarint(!!G)},writeString:function(G){G=String(G),this.realloc(4*G.length),this.pos++;var ie=this.pos;this.pos=function(He,ht,Ye){for(var nt,yt,mt=0;mt<ht.length;mt++){if((nt=ht.charCodeAt(mt))>55295&&nt<57344){if(!yt){nt>56319||mt+1===ht.length?(He[Ye++]=239,He[Ye++]=191,He[Ye++]=189):yt=nt;continue}if(nt<56320){He[Ye++]=239,He[Ye++]=191,He[Ye++]=189,yt=nt;continue}nt=yt-55296<<10|nt-56320|65536,yt=null}else yt&&(He[Ye++]=239,He[Ye++]=191,He[Ye++]=189,yt=null);nt<128?He[Ye++]=nt:(nt<2048?He[Ye++]=nt>>6|192:(nt<65536?He[Ye++]=nt>>12|224:(He[Ye++]=nt>>18|240,He[Ye++]=nt>>12&63|128),He[Ye++]=nt>>6&63|128),He[Ye++]=63&nt|128)}return Ye}(this.buf,G,this.pos);var ve=this.pos-ie;ve>=128&&w(ie,ve,this),this.pos=ie-1,this.writeVarint(ve),this.pos+=ve},writeFloat:function(G){this.realloc(4),s.write(this.buf,G,this.pos,!0,23,4),this.pos+=4},writeDouble:function(G){this.realloc(8),s.write(this.buf,G,this.pos,!0,52,8),this.pos+=8},writeBytes:function(G){var ie=G.length;this.writeVarint(ie),this.realloc(ie);for(var ve=0;ve<ie;ve++)this.buf[this.pos++]=G[ve]},writeRawMessage:function(G,ie){this.pos++;var ve=this.pos;G(ie,this);var He=this.pos-ve;He>=128&&w(ve,He,this),this.pos=ve-1,this.writeVarint(He),this.pos+=He},writeMessage:function(G,ie,ve){this.writeTag(G,n.Bytes),this.writeRawMessage(ie,ve)},writePackedVarint:function(G,ie){ie.length&&this.writeMessage(G,C,ie)},writePackedSVarint:function(G,ie){ie.length&&this.writeMessage(G,M,ie)},writePackedBoolean:function(G,ie){ie.length&&this.writeMessage(G,$,ie)},writePackedFloat:function(G,ie){ie.length&&this.writeMessage(G,R,ie)},writePackedDouble:function(G,ie){ie.length&&this.writeMessage(G,L,ie)},writePackedFixed32:function(G,ie){ie.length&&this.writeMessage(G,H,ie)},writePackedSFixed32:function(G,ie){ie.length&&this.writeMessage(G,q,ie)},writePackedFixed64:function(G,ie){ie.length&&this.writeMessage(G,Y,ie)},writePackedSFixed64:function(G,ie){ie.length&&this.writeMessage(G,re,ie)},writeBytesField:function(G,ie){this.writeTag(G,n.Bytes),this.writeBytes(ie)},writeFixed32Field:function(G,ie){this.writeTag(G,n.Fixed32),this.writeFixed32(ie)},writeSFixed32Field:function(G,ie){this.writeTag(G,n.Fixed32),this.writeSFixed32(ie)},writeFixed64Field:function(G,ie){this.writeTag(G,n.Fixed64),this.writeFixed64(ie)},writeSFixed64Field:function(G,ie){this.writeTag(G,n.Fixed64),this.writeSFixed64(ie)},writeVarintField:function(G,ie){this.writeTag(G,n.Varint),this.writeVarint(ie)},writeSVarintField:function(G,ie){this.writeTag(G,n.Varint),this.writeSVarint(ie)},writeStringField:function(G,ie){this.writeTag(G,n.Bytes),this.writeString(ie)},writeFloatField:function(G,ie){this.writeTag(G,n.Fixed32),this.writeFloat(ie)},writeDoubleField:function(G,ie){this.writeTag(G,n.Fixed64),this.writeDouble(ie)},writeBooleanField:function(G,ie){this.writeVarintField(G,!!ie)}},xg}var Sg=T(Yv());const Cg=3;function q2(s,n,a){s===1&&a.readMessage(W2,n)}function W2(s,n,a){if(s===3){const{id:c,bitmap:p,width:v,height:b,left:w,top:C,advance:M}=a.readMessage(X2,{});n.push({id:c,bitmap:new kd({width:v+2*Cg,height:b+2*Cg},p),metrics:{width:v,height:b,left:w,top:C,advance:M}})}}function X2(s,n,a){s===1?n.id=a.readVarint():s===2?n.bitmap=a.readBytes():s===3?n.width=a.readVarint():s===4?n.height=a.readVarint():s===5?n.left=a.readSVarint():s===6?n.top=a.readSVarint():s===7&&(n.advance=a.readVarint())}const K2=Cg;function Jv(s){let n=0,a=0;for(const b of s)n+=b.w*b.h,a=Math.max(a,b.w);s.sort((b,w)=>w.h-b.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),a),h:1/0}];let p=0,v=0;for(const b of s)for(let w=c.length-1;w>=0;w--){const C=c[w];if(!(b.w>C.w||b.h>C.h)){if(b.x=C.x,b.y=C.y,v=Math.max(v,b.y+b.h),p=Math.max(p,b.x+b.w),b.w===C.w&&b.h===C.h){const M=c.pop();w<c.length&&(c[w]=M)}else b.h===C.h?(C.x+=b.w,C.w-=b.w):b.w===C.w?(C.y+=b.h,C.h-=b.h):(c.push({x:C.x+b.w,y:C.y,w:C.w-b.w,h:b.h}),C.y+=b.h,C.h-=b.h);break}}return{w:p,h:v,fill:n/(p*v)||0}}const Ur=1;class Tg{constructor(n,{pixelRatio:a,version:c,stretchX:p,stretchY:v,content:b,textFitWidth:w,textFitHeight:C}){this.paddedRect=n,this.pixelRatio=a,this.stretchX=p,this.stretchY=v,this.content=b,this.version=c,this.textFitWidth=w,this.textFitHeight=C}get tl(){return[this.paddedRect.x+Ur,this.paddedRect.y+Ur]}get br(){return[this.paddedRect.x+this.paddedRect.w-Ur,this.paddedRect.y+this.paddedRect.h-Ur]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Ur)/this.pixelRatio,(this.paddedRect.h-2*Ur)/this.pixelRatio]}}class Qv{constructor(n,a){const c={},p={};this.haveRenderCallbacks=[];const v=[];this.addImages(n,c,v),this.addImages(a,p,v);const{w:b,h:w}=Jv(v),C=new ma({width:b||1,height:w||1});for(const M in n){const R=n[M],L=c[M].paddedRect;ma.copy(R.data,C,{x:0,y:0},{x:L.x+Ur,y:L.y+Ur},R.data)}for(const M in a){const R=a[M],L=p[M].paddedRect,$=L.x+Ur,H=L.y+Ur,q=R.data.width,Y=R.data.height;ma.copy(R.data,C,{x:0,y:0},{x:$,y:H},R.data),ma.copy(R.data,C,{x:0,y:Y-1},{x:$,y:H-1},{width:q,height:1}),ma.copy(R.data,C,{x:0,y:0},{x:$,y:H+Y},{width:q,height:1}),ma.copy(R.data,C,{x:q-1,y:0},{x:$-1,y:H},{width:1,height:Y}),ma.copy(R.data,C,{x:0,y:0},{x:$+q,y:H},{width:1,height:Y})}this.image=C,this.iconPositions=c,this.patternPositions=p}addImages(n,a,c){for(const p in n){const v=n[p],b={x:0,y:0,w:v.data.width+2*Ur,h:v.data.height+2*Ur};c.push(b),a[p]=new Tg(b,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(n,a){n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in n.updatedImages)this.patchUpdatedImage(this.iconPositions[c],n.getImage(c),a),this.patchUpdatedImage(this.patternPositions[c],n.getImage(c),a)}patchUpdatedImage(n,a,c){if(!n||!a||n.version===a.version)return;n.version=a.version;const[p,v]=n.tl;c.update(a.data,void 0,{x:p,y:v})}}var Lo;Ft("ImagePosition",Tg),Ft("ImageAtlas",Qv),m.ai=void 0,(Lo=m.ai||(m.ai={}))[Lo.none=0]="none",Lo[Lo.horizontal=1]="horizontal",Lo[Lo.vertical=2]="vertical",Lo[Lo.horizontalOnly=3]="horizontalOnly";const Kf=-17;class Od{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(n,a,c){const p=new Od;return p.scale=n||1,p.fontStack=a,p.verticalAlign=c||"bottom",p}static forImage(n,a){const c=new Od;return c.imageName=n,c.verticalAlign=a||"bottom",c}}class Hc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,a){const c=new Hc;for(let p=0;p<n.sections.length;p++){const v=n.sections[p];v.image?c.addImageSection(v):c.addTextSection(v,a)}return c}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(){this.text=function(n){let a="";for(let c=0;c<n.length;c++){const p=n.charCodeAt(c+1)||null,v=n.charCodeAt(c-1)||null;a+=p&&Df(p)&&!Fd[n[c+1]]||v&&Df(v)&&!Fd[n[c-1]]||!Fd[n[c]]?n[c]:Fd[n[c]]}return a}(this.text)}trim(){let n=0;for(let c=0;c<this.text.length&&Jf[this.text.charCodeAt(c)];c++)n++;let a=this.text.length;for(let c=this.text.length-1;c>=0&&c>=n&&Jf[this.text.charCodeAt(c)];c--)a--;this.text=this.text.substring(n,a),this.sectionIndex=this.sectionIndex.slice(n,a)}substring(n,a){const c=new Hc;return c.text=this.text.substring(n,a),c.sectionIndex=this.sectionIndex.slice(n,a),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,a)=>Math.max(n,this.sections[a].scale),0)}getMaxImageSize(n){let a=0,c=0;for(let p=0;p<this.length();p++){const v=this.getSection(p);if(v.imageName){const b=n[v.imageName];if(!b)continue;const w=b.displaySize;a=Math.max(a,w[0]),c=Math.max(c,w[1])}}return{maxImageWidth:a,maxImageHeight:c}}addTextSection(n,a){this.text+=n.text,this.sections.push(Od.forText(n.scale,n.fontStack||a,n.verticalAlign));const c=this.sections.length-1;for(let p=0;p<n.text.length;++p)this.sectionIndex.push(c)}addImageSection(n){const a=n.image?n.image.name:"";if(a.length===0)return void si("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(Od.forImage(a,n.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):si("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Yf(s,n,a,c,p,v,b,w,C,M,R,L,$,H,q){const Y=Hc.fromFeature(s,p);let re;L===m.ai.vertical&&Y.verticalizePunctuation();const{processBidirectionalText:de,processStyledBidirectionalText:ze}=qa;if(de&&Y.sections.length===1){re=[];const ie=de(Y.toString(),Pg(Y,M,v,n,c,H));for(const ve of ie){const He=new Hc;He.text=ve,He.sections=Y.sections;for(let ht=0;ht<ve.length;ht++)He.sectionIndex.push(0);re.push(He)}}else if(ze){re=[];const ie=ze(Y.text,Y.sectionIndex,Pg(Y,M,v,n,c,H));for(const ve of ie){const He=new Hc;He.text=ve[0],He.sectionIndex=ve[1],He.sections=Y.sections,re.push(He)}}else re=function(ie,ve){const He=[],ht=ie.text;let Ye=0;for(const nt of ve)He.push(ie.substring(Ye,nt)),Ye=nt;return Ye<ht.length&&He.push(ie.substring(Ye,ht.length)),He}(Y,Pg(Y,M,v,n,c,H));const _e=[],G={positionedLines:_e,text:Y.toString(),top:R[1],bottom:R[1],left:R[0],right:R[0],writingMode:L,iconsInText:!1,verticalizable:!1};return function(ie,ve,He,ht,Ye,nt,yt,mt,bt,at,jt,Qt){let Kt=0,Gt=0,Mn=0,Mi=0;const Yi=mt==="right"?1:mt==="left"?0:.5,vr=Ki/Qt;let _a=0;for(const wi of Ye){wi.trim();const nr=wi.getMaxScale(),ur={positionedGlyphs:[],lineOffset:0};ie.positionedLines[_a]=ur;const dr=ur.positionedGlyphs;let Dr=0;if(!wi.length()){Gt+=nt,++_a;continue}const ya=eT(ht,wi,vr);for(let Hr=0;Hr<wi.length();Hr++){const Ji=wi.getSection(Hr),rr=wi.getSectionIndex(Hr),ar=wi.getCharCode(Hr),ji=tT(bt,jt,ar);let ci;if(Ji.imageName){if(ie.iconsInText=!0,Ji.scale=Ji.scale*vr,ci=iT(Ji,ji,nr,ya,ht),!ci)continue;Dr=Math.max(Dr,ci.imageOffset)}else if(ci=nT(Ji,ar,ji,ya,ve,He),!ci)continue;const{rect:Ya,metrics:Xc,baselineOffset:Ja}=ci;dr.push({glyph:ar,imageName:Ji.imageName,x:Kt,y:Gt+Ja+Kf,vertical:ji,scale:Ji.scale,fontStack:Ji.fontStack,sectionIndex:rr,metrics:Xc,rect:Ya}),ji?(ie.verticalizable=!0,Kt+=(Ji.imageName?Xc.advance:Ki)*Ji.scale+at):Kt+=Xc.advance*Ji.scale+at}dr.length!==0&&(Mn=Math.max(Kt-at,Mn),rT(dr,0,dr.length-1,Yi)),Kt=0,ur.lineOffset=Math.max(Dr,(nr-1)*Ki);const ir=nt*nr+Dr;Gt+=ir,Mi=Math.max(ir,Mi),++_a}const{horizontalAlign:Gr,verticalAlign:cr}=kg(yt);(function(wi,nr,ur,dr,Dr,ya,ir,Hr,Ji){const rr=(nr-ur)*Dr;let ar=0;ar=ya!==ir?-Hr*dr-Kf:-dr*Ji*ir+.5*ir;for(const ji of wi)for(const ci of ji.positionedGlyphs)ci.x+=rr,ci.y+=ar})(ie.positionedLines,Yi,Gr,cr,Mn,Mi,nt,Gt,Ye.length),ie.top+=-cr*Gt,ie.bottom=ie.top+Gt,ie.left+=-Gr*Mn,ie.right=ie.left+Mn}(G,n,a,c,re,b,w,C,L,M,$,q),!function(ie){for(const ve of ie)if(ve.positionedGlyphs.length!==0)return!1;return!0}(_e)&&G}const Jf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Y2={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},J2={40:!0};function e0(s,n,a,c,p,v){if(n.imageName){const b=c[n.imageName];return b?b.displaySize[0]*n.scale*Ki/v+p:0}{const b=a[n.fontStack],w=b&&b[s];return w?w.metrics.advance*n.scale+p:0}}function t0(s,n,a,c){const p=Math.pow(s-n,2);return c?s<n?p/2:2*p:p+Math.abs(a)*a}function Q2(s,n,a){let c=0;return s===10&&(c-=1e4),a&&(c+=150),s!==40&&s!==65288||(c+=50),n!==41&&n!==65289||(c+=50),c}function n0(s,n,a,c,p,v){let b=null,w=t0(n,a,p,v);for(const C of c){const M=t0(n-C.x,a,p,v)+C.badness;M<=w&&(b=C,w=M)}return{index:s,x:n,priorBreak:b,badness:w}}function i0(s){return s?i0(s.priorBreak).concat(s.index):[]}function Pg(s,n,a,c,p,v){if(!s)return[];const b=[],w=function(L,$,H,q,Y,re){let de=0;for(let ze=0;ze<L.length();ze++){const _e=L.getSection(ze);de+=e0(L.getCharCode(ze),_e,q,Y,$,re)}return de/Math.max(1,Math.ceil(de/H))}(s,n,a,c,p,v),C=s.text.indexOf("​")>=0;let M=0;for(let L=0;L<s.length();L++){const $=s.getSection(L),H=s.getCharCode(L);if(Jf[H]||(M+=e0(H,$,c,p,n,v)),L<s.length()-1){const q=!((R=H)<11904)&&(!!kn["CJK Compatibility Forms"](R)||!!kn["CJK Compatibility"](R)||!!kn["CJK Strokes"](R)||!!kn["CJK Symbols and Punctuation"](R)||!!kn["Enclosed CJK Letters and Months"](R)||!!kn["Halfwidth and Fullwidth Forms"](R)||!!kn["Ideographic Description Characters"](R)||!!kn["Vertical Forms"](R)||Ac.test(String.fromCodePoint(R)));(Y2[H]||q||$.imageName||L!==s.length()-2&&J2[s.getCharCode(L+1)])&&b.push(n0(L+1,M,w,b,Q2(H,s.getCharCode(L+1),q&&C),!1))}}var R;return i0(n0(s.length(),M,w,b,0,!0))}function kg(s){let n=.5,a=.5;switch(s){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:n,verticalAlign:a}}function eT(s,n,a){const c=n.getMaxScale()*Ki,{maxImageWidth:p,maxImageHeight:v}=n.getMaxImageSize(s),b=Math.max(c,v*a);return{verticalLineContentWidth:Math.max(c,p*a),horizontalLineContentHeight:b}}function r0(s){switch(s){case"top":return 0;case"center":return .5;default:return 1}}function tT(s,n,a){return!(s===m.ai.horizontal||!n&&!Rc(a)||n&&(Jf[a]||(c=a,/\p{sc=Arab}/u.test(String.fromCodePoint(c)))));var c}function nT(s,n,a,c,p,v){const b=v[s.fontStack],w=function(M,R,L,$){if(M&&M.rect)return M;const H=R[L.fontStack],q=H&&H[$];return q?{rect:null,metrics:q.metrics}:null}(b&&b[n],p,s,n);if(w===null)return null;let C;if(a)C=c.verticalLineContentWidth-s.scale*Ki;else{const M=r0(s.verticalAlign);C=(c.horizontalLineContentHeight-s.scale*Ki)*M}return{rect:w.rect,metrics:w.metrics,baselineOffset:C}}function iT(s,n,a,c,p){const v=p[s.imageName];if(!v)return null;const b=v.paddedRect,w=v.displaySize,C={width:w[0],height:w[1],left:Ur,top:-3,advance:n?w[1]:w[0]};let M;if(n)M=c.verticalLineContentWidth-w[1]*s.scale;else{const R=r0(s.verticalAlign);M=(c.horizontalLineContentHeight-w[1]*s.scale)*R}return{rect:b,metrics:C,baselineOffset:M,imageOffset:(n?w[0]:w[1])*s.scale-Ki*a}}function rT(s,n,a,c){if(c===0)return;const p=s[a],v=(s[a].x+p.metrics.advance*p.scale)*c;for(let b=n;b<=a;b++)s[b].x-=v}function aT(s,n,a){const{horizontalAlign:c,verticalAlign:p}=kg(a),v=n[0]-s.displaySize[0]*c,b=n[1]-s.displaySize[1]*p;return{image:s,top:b,bottom:b+s.displaySize[1],left:v,right:v+s.displaySize[0]}}function a0(s){var n,a;let c=s.left,p=s.top,v=s.right-c,b=s.bottom-p;const w=(n=s.image.textFitWidth)!==null&&n!==void 0?n:"stretchOrShrink",C=(a=s.image.textFitHeight)!==null&&a!==void 0?a:"stretchOrShrink",M=(s.image.content[2]-s.image.content[0])/(s.image.content[3]-s.image.content[1]);if(C==="proportional"){if(w==="stretchOnly"&&v/b<M||w==="proportional"){const R=Math.ceil(b*M);c*=R/v,v=R}}else if(w==="proportional"&&C==="stretchOnly"&&M!==0&&v/b>M){const R=Math.ceil(v/M);p*=R/b,b=R}return{x1:c,y1:p,x2:c+v,y2:p+b}}function s0(s,n,a,c,p,v){const b=s.image;let w;if(b.content){const re=b.content,de=b.pixelRatio||1;w=[re[0]/de,re[1]/de,b.displaySize[0]-re[2]/de,b.displaySize[1]-re[3]/de]}const C=n.left*v,M=n.right*v;let R,L,$,H;a==="width"||a==="both"?(H=p[0]+C-c[3],L=p[0]+M+c[1]):(H=p[0]+(C+M-b.displaySize[0])/2,L=H+b.displaySize[0]);const q=n.top*v,Y=n.bottom*v;return a==="height"||a==="both"?(R=p[1]+q-c[0],$=p[1]+Y+c[2]):(R=p[1]+(q+Y-b.displaySize[1])/2,$=R+b.displaySize[1]),{image:b,top:R,right:L,bottom:$,left:H,collisionPadding:w}}const Vd=255,gs=128,Bo=Vd*gs;function o0(s,n){const{expression:a}=n;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new mi(s+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:p}=a;let v=0;for(;v<c.length&&c[v]<=s;)v++;v=Math.max(0,v-1);let b=v;for(;b<c.length&&c[b]<s+1;)b++;b=Math.min(c.length-1,b);const w=c[v],C=c[b];return a.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:C,interpolationType:p}:{kind:"camera",minZoom:w,maxZoom:C,minSize:a.evaluate(new mi(w)),maxSize:a.evaluate(new mi(C)),interpolationType:p}}}function Ig(s,n,a){let c="never";const p=s.get(n);return p?c=p:s.get(a)&&(c="always"),c}const sT=zd.VectorTileFeature.types,oT=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Qf(s,n,a,c,p,v,b,w,C,M,R,L,$){const H=w?Math.min(Bo,Math.round(w[0])):0,q=w?Math.min(Bo,Math.round(w[1])):0;s.emplaceBack(n,a,Math.round(32*c),Math.round(32*p),v,b,(H<<1)+(C?1:0),q,16*M,16*R,256*L,256*$)}function Mg(s,n,a){s.emplaceBack(n.x,n.y,a),s.emplaceBack(n.x,n.y,a),s.emplaceBack(n.x,n.y,a),s.emplaceBack(n.x,n.y,a)}function lT(s){for(const n of s.sections)if(Ff(n.text))return!0;return!1}class Eg{constructor(n){this.layoutVertexArray=new Re,this.indexArray=new et,this.programConfigurations=n,this.segments=new Dt,this.dynamicLayoutVertexArray=new Ge,this.opacityVertexArray=new Ze,this.hasVisibleVertices=!1,this.placedSymbolArray=new S}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,a,c,p){this.isEmpty()||(c&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,$2.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,j2.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,oT,!0),this.opacityVertexBuffer.itemSize=1),(c||p)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ft("SymbolBuffers",Eg);class Ag{constructor(n,a,c){this.layoutVertexArray=new n,this.layoutAttributes=a,this.indexArray=new c,this.segments=new Dt,this.collisionVertexArray=new lt}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,U2.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ft("CollisionBuffers",Ag);class Zc{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(b=>b.id),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=o0(this.zoom,a["text-size"]),this.iconSizeData=o0(this.zoom,a["icon-size"]);const c=this.layers[0].layout,p=c.get("symbol-sort-key"),v=c.get("symbol-z-order");this.canOverlap=Ig(c,"text-overlap","text-allow-overlap")!=="never"||Ig(c,"icon-overlap","icon-allow-overlap")!=="never"||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&!p.isConstant(),this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,c.get("symbol-placement")==="point"&&(this.writingModes=c.get("text-writing-mode").map(b=>m.ai[b])),this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id),this.sourceID=n.sourceID}createArrays(){this.text=new Eg(new xi(this.layers,this.zoom,n=>/^text/.test(n))),this.icon=new Eg(new xi(this.layers,this.zoom,n=>/^icon/.test(n))),this.glyphOffsetArray=new F,this.lineVertexArray=new N,this.symbolInstances=new A,this.textAnchorOffsets=new X}calculateGlyphDependencies(n,a,c,p,v){for(let b=0;b<n.length;b++)if(a[n.charCodeAt(b)]=!0,(c||p)&&v){const w=Fd[n.charAt(b)];w&&(a[w.charCodeAt(0)]=!0)}}populate(n,a,c){const p=this.layers[0],v=p.layout,b=v.get("text-font"),w=v.get("text-field"),C=v.get("icon-image"),M=(w.value.kind!=="constant"||w.value.value instanceof Ai&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(b.value.kind!=="constant"||b.value.value.length>0),R=C.value.kind!=="constant"||!!C.value.value||Object.keys(C.parameters).length>0,L=v.get("symbol-sort-key");if(this.features=[],!M&&!R)return;const $=a.iconDependencies,H=a.glyphDependencies,q=a.availableImages,Y=new mi(this.zoom);for(const{feature:re,id:de,index:ze,sourceLayerIndex:_e}of n){const G=p._featureFilter.needGeometry,ie=qs(re,G);if(!p._featureFilter.filter(Y,ie,c))continue;let ve,He;if(G||(ie.geometry=Zs(re)),M){const Ye=p.getValueAndResolveTokens("text-field",ie,c,q),nt=Ai.factory(Ye),yt=this.hasRTLText=this.hasRTLText||lT(nt);(!yt||qa.getRTLTextPluginStatus()==="unavailable"||yt&&qa.isParsed())&&(ve=H2(nt,p,ie))}if(R){const Ye=p.getValueAndResolveTokens("icon-image",ie,c,q);He=Ye instanceof gr?Ye:gr.fromString(Ye)}if(!ve&&!He)continue;const ht=this.sortFeaturesByKey?L.evaluate(ie,{},c):void 0;if(this.features.push({id:de,text:ve,icon:He,index:ze,sourceLayerIndex:_e,geometry:ie.geometry,properties:re.properties,type:sT[re.type],sortKey:ht}),He&&($[He.name]=!0),ve){const Ye=b.evaluate(ie,{},c).join(","),nt=v.get("text-rotation-alignment")!=="viewport"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(m.ai.vertical)>=0;for(const yt of ve.sections)if(yt.image)$[yt.image.name]=!0;else{const mt=Eo(ve.toString()),bt=yt.fontStack||Ye,at=H[bt]=H[bt]||{};this.calculateGlyphDependencies(yt.text,at,nt,this.allowVerticalPlacement,mt)}}}v.get("symbol-placement")==="line"&&(this.features=function(re){const de={},ze={},_e=[];let G=0;function ie(Ye){_e.push(re[Ye]),G++}function ve(Ye,nt,yt){const mt=ze[Ye];return delete ze[Ye],ze[nt]=mt,_e[mt].geometry[0].pop(),_e[mt].geometry[0]=_e[mt].geometry[0].concat(yt[0]),mt}function He(Ye,nt,yt){const mt=de[nt];return delete de[nt],de[Ye]=mt,_e[mt].geometry[0].shift(),_e[mt].geometry[0]=yt[0].concat(_e[mt].geometry[0]),mt}function ht(Ye,nt,yt){const mt=yt?nt[0][nt[0].length-1]:nt[0][0];return`${Ye}:${mt.x}:${mt.y}`}for(let Ye=0;Ye<re.length;Ye++){const nt=re[Ye],yt=nt.geometry,mt=nt.text?nt.text.toString():null;if(!mt){ie(Ye);continue}const bt=ht(mt,yt),at=ht(mt,yt,!0);if(bt in ze&&at in de&&ze[bt]!==de[at]){const jt=He(bt,at,yt),Qt=ve(bt,at,_e[jt].geometry);delete de[bt],delete ze[at],ze[ht(mt,_e[Qt].geometry,!0)]=Qt,_e[jt].geometry=null}else bt in ze?ve(bt,at,yt):at in de?He(bt,at,yt):(ie(Ye),de[bt]=G-1,ze[at]=G-1)}return _e.filter(Ye=>Ye.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((re,de)=>re.sortKey-de.sortKey)}update(n,a,c){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,a,this.layers,c),this.icon.programConfigurations.updatePaintArrays(n,a,this.layers,c))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,a){const c=this.lineVertexArray.length;if(n.segment!==void 0){let p=n.dist(a[n.segment+1]),v=n.dist(a[n.segment]);const b={};for(let w=n.segment+1;w<a.length;w++)b[w]={x:a[w].x,y:a[w].y,tileUnitDistanceFromAnchor:p},w<a.length-1&&(p+=a[w+1].dist(a[w]));for(let w=n.segment||0;w>=0;w--)b[w]={x:a[w].x,y:a[w].y,tileUnitDistanceFromAnchor:v},w>0&&(v+=a[w-1].dist(a[w]));for(let w=0;w<a.length;w++){const C=b[w];this.lineVertexArray.emplaceBack(C.x,C.y,C.tileUnitDistanceFromAnchor)}}return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(n,a,c,p,v,b,w,C,M,R,L,$){const H=n.indexArray,q=n.layoutVertexArray,Y=n.segments.prepareSegment(4*a.length,q,H,this.canOverlap?b.sortKey:void 0),re=this.glyphOffsetArray.length,de=Y.vertexLength,ze=this.allowVerticalPlacement&&w===m.ai.vertical?Math.PI/2:0,_e=b.text&&b.text.sections;for(let G=0;G<a.length;G++){const{tl:ie,tr:ve,bl:He,br:ht,tex:Ye,pixelOffsetTL:nt,pixelOffsetBR:yt,minFontScaleX:mt,minFontScaleY:bt,glyphOffset:at,isSDF:jt,sectionIndex:Qt}=a[G],Kt=Y.vertexLength,Gt=at[1];Qf(q,C.x,C.y,ie.x,Gt+ie.y,Ye.x,Ye.y,c,jt,nt.x,nt.y,mt,bt),Qf(q,C.x,C.y,ve.x,Gt+ve.y,Ye.x+Ye.w,Ye.y,c,jt,yt.x,nt.y,mt,bt),Qf(q,C.x,C.y,He.x,Gt+He.y,Ye.x,Ye.y+Ye.h,c,jt,nt.x,yt.y,mt,bt),Qf(q,C.x,C.y,ht.x,Gt+ht.y,Ye.x+Ye.w,Ye.y+Ye.h,c,jt,yt.x,yt.y,mt,bt),Mg(n.dynamicLayoutVertexArray,C,ze),H.emplaceBack(Kt,Kt+2,Kt+1),H.emplaceBack(Kt+1,Kt+2,Kt+3),Y.vertexLength+=4,Y.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(at[0]),G!==a.length-1&&Qt===a[G+1].sectionIndex||n.programConfigurations.populatePaintArrays(q.length,b,b.index,{},$,_e&&_e[Qt])}n.placedSymbolArray.emplaceBack(C.x,C.y,re,this.glyphOffsetArray.length-re,de,M,R,C.segment,c?c[0]:0,c?c[1]:0,p[0],p[1],w,0,!1,0,L)}_addCollisionDebugVertex(n,a,c,p,v,b){return a.emplaceBack(0,0),n.emplaceBack(c.x,c.y,p,v,Math.round(b.x),Math.round(b.y))}addCollisionDebugVertices(n,a,c,p,v,b,w){const C=v.segments.prepareSegment(4,v.layoutVertexArray,v.indexArray),M=C.vertexLength,R=v.layoutVertexArray,L=v.collisionVertexArray,$=w.anchorX,H=w.anchorY;this._addCollisionDebugVertex(R,L,b,$,H,new B(n,a)),this._addCollisionDebugVertex(R,L,b,$,H,new B(c,a)),this._addCollisionDebugVertex(R,L,b,$,H,new B(c,p)),this._addCollisionDebugVertex(R,L,b,$,H,new B(n,p)),C.vertexLength+=4;const q=v.indexArray;q.emplaceBack(M,M+1),q.emplaceBack(M+1,M+2),q.emplaceBack(M+2,M+3),q.emplaceBack(M+3,M),C.primitiveLength+=4}addDebugCollisionBoxes(n,a,c,p){for(let v=n;v<a;v++){const b=this.collisionBoxArray.get(v);this.addCollisionDebugVertices(b.x1,b.y1,b.x2,b.y2,p?this.textCollisionBox:this.iconCollisionBox,b.anchorPoint,c)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ag(rt,Wv.members,Pt),this.iconCollisionBox=new Ag(rt,Wv.members,Pt);for(let n=0;n<this.symbolInstances.length;n++){const a=this.symbolInstances.get(n);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}}_deserializeCollisionBoxesForSymbol(n,a,c,p,v,b,w,C,M){const R={};for(let L=a;L<c;L++){const $=n.get(L);R.textBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},R.textFeatureIndex=$.featureIndex;break}for(let L=p;L<v;L++){const $=n.get(L);R.verticalTextBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},R.verticalTextFeatureIndex=$.featureIndex;break}for(let L=b;L<w;L++){const $=n.get(L);R.iconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},R.iconFeatureIndex=$.featureIndex;break}for(let L=C;L<M;L++){const $=n.get(L);R.verticalIconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},R.verticalIconFeatureIndex=$.featureIndex;break}return R}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const c=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,a){const c=n.placedSymbolArray.get(a),p=c.vertexStartIndex+4*c.numGlyphs;for(let v=c.vertexStartIndex;v<p;v+=4)n.indexArray.emplaceBack(v,v+2,v+1),n.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(n),c=Math.cos(n),p=[],v=[],b=[];for(let w=0;w<this.symbolInstances.length;++w){b.push(w);const C=this.symbolInstances.get(w);p.push(0|Math.round(a*C.anchorX+c*C.anchorY)),v.push(C.featureIndex)}return b.sort((w,C)=>p[w]-p[C]||v[C]-v[w]),b}addToSortKeyRanges(n,a){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===a?c.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const c=this.symbolInstances.get(a);this.featureSortOrder.push(c.featureIndex),[c.rightJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.leftJustifiedTextSymbolIndex].forEach((p,v,b)=>{p>=0&&b.indexOf(p)===v&&this.addIndicesForPlacedSymbol(this.text,p)}),c.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,c.verticalPlacedTextSymbolIndex),c.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.placedIconSymbolIndex),c.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let l0,c0;Ft("SymbolBucket",Zc,{omit:["layers","collisionBoxArray","features","compareText"]}),Zc.MAX_GLYPHS=65535,Zc.addDynamicAttributes=Mg;var Rg={get paint(){return c0=c0||new Ar({"icon-opacity":new sn(ae.paint_symbol["icon-opacity"]),"icon-color":new sn(ae.paint_symbol["icon-color"]),"icon-halo-color":new sn(ae.paint_symbol["icon-halo-color"]),"icon-halo-width":new sn(ae.paint_symbol["icon-halo-width"]),"icon-halo-blur":new sn(ae.paint_symbol["icon-halo-blur"]),"icon-translate":new Zt(ae.paint_symbol["icon-translate"]),"icon-translate-anchor":new Zt(ae.paint_symbol["icon-translate-anchor"]),"text-opacity":new sn(ae.paint_symbol["text-opacity"]),"text-color":new sn(ae.paint_symbol["text-color"],{runtimeType:Cn,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new sn(ae.paint_symbol["text-halo-color"]),"text-halo-width":new sn(ae.paint_symbol["text-halo-width"]),"text-halo-blur":new sn(ae.paint_symbol["text-halo-blur"]),"text-translate":new Zt(ae.paint_symbol["text-translate"]),"text-translate-anchor":new Zt(ae.paint_symbol["text-translate-anchor"])})},get layout(){return l0=l0||new Ar({"symbol-placement":new Zt(ae.layout_symbol["symbol-placement"]),"symbol-spacing":new Zt(ae.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Zt(ae.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new sn(ae.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Zt(ae.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Zt(ae.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Zt(ae.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Zt(ae.layout_symbol["icon-ignore-placement"]),"icon-optional":new Zt(ae.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Zt(ae.layout_symbol["icon-rotation-alignment"]),"icon-size":new sn(ae.layout_symbol["icon-size"]),"icon-text-fit":new Zt(ae.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Zt(ae.layout_symbol["icon-text-fit-padding"]),"icon-image":new sn(ae.layout_symbol["icon-image"]),"icon-rotate":new sn(ae.layout_symbol["icon-rotate"]),"icon-padding":new sn(ae.layout_symbol["icon-padding"]),"icon-keep-upright":new Zt(ae.layout_symbol["icon-keep-upright"]),"icon-offset":new sn(ae.layout_symbol["icon-offset"]),"icon-anchor":new sn(ae.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Zt(ae.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Zt(ae.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Zt(ae.layout_symbol["text-rotation-alignment"]),"text-field":new sn(ae.layout_symbol["text-field"]),"text-font":new sn(ae.layout_symbol["text-font"]),"text-size":new sn(ae.layout_symbol["text-size"]),"text-max-width":new sn(ae.layout_symbol["text-max-width"]),"text-line-height":new Zt(ae.layout_symbol["text-line-height"]),"text-letter-spacing":new sn(ae.layout_symbol["text-letter-spacing"]),"text-justify":new sn(ae.layout_symbol["text-justify"]),"text-radial-offset":new sn(ae.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Zt(ae.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new sn(ae.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new sn(ae.layout_symbol["text-anchor"]),"text-max-angle":new Zt(ae.layout_symbol["text-max-angle"]),"text-writing-mode":new Zt(ae.layout_symbol["text-writing-mode"]),"text-rotate":new sn(ae.layout_symbol["text-rotate"]),"text-padding":new Zt(ae.layout_symbol["text-padding"]),"text-keep-upright":new Zt(ae.layout_symbol["text-keep-upright"]),"text-transform":new sn(ae.layout_symbol["text-transform"]),"text-offset":new sn(ae.layout_symbol["text-offset"]),"text-allow-overlap":new Zt(ae.layout_symbol["text-allow-overlap"]),"text-overlap":new Zt(ae.layout_symbol["text-overlap"]),"text-ignore-placement":new Zt(ae.layout_symbol["text-ignore-placement"]),"text-optional":new Zt(ae.layout_symbol["text-optional"])})}};class u0{constructor(n){if(n.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=n.property.overrides?n.property.overrides.runtimeType:pn,this.defaultValue=n}evaluate(n){if(n.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(n.formattedSection))return a.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ft("FormatSectionOverride",u0,{omit:["defaultValue"]});class ep extends Aa{constructor(n){super(n,Rg)}recalculate(n,a){if(super.recalculate(n,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const c=this.layout.get("text-writing-mode");if(c){const p=[];for(const v of c)p.indexOf(v)<0&&p.push(v);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(n,a,c,p){const v=this.layout.get(n).evaluate(a,{},c,p),b=this._unevaluatedLayout._values[n];return b.isDataDriven()||bc(b.value)||!v?v:function(w,C){return C.replace(/{([^{}]+)}/g,(M,R)=>w&&R in w?String(w[R]):"")}(a.properties,v)}createBucket(n){return new Zc(n)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const n of Rg.paint.overridableProperties){if(!ep.hasPaintOverride(this.layout,n))continue;const a=this.paint.get(n),c=new u0(a),p=new vc(c,a.property.specification);let v=null;v=a.value.kind==="constant"||a.value.kind==="source"?new So("source",p):new wc("composite",p,a.value.zoomStops),this.paint._values[n]=new Ea(a.property,v,a.parameters)}}_handleOverridablePaintPropertyUpdate(n,a,c){return!(!this.layout||a.isDataDriven()||c.isDataDriven())&&ep.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,a){const c=n.get("text-field"),p=Rg.paint.properties[a];let v=!1;const b=w=>{for(const C of w)if(p.overrides&&p.overrides.hasOverride(C))return void(v=!0)};if(c.value.kind==="constant"&&c.value.value instanceof Ai)b(c.value.value.sections);else if(c.value.kind==="source"){const w=M=>{v||(M instanceof Ma&&oi(M.value)===cs?b(M.value.sections):M instanceof ll?b(M.sections):M.eachChild(w))},C=c.value;C._styleExpression&&w(C._styleExpression.expression)}return v}}let d0;var cT={get paint(){return d0=d0||new Ar({"background-color":new Zt(ae.paint_background["background-color"]),"background-pattern":new Bc(ae.paint_background["background-pattern"]),"background-opacity":new Zt(ae.paint_background["background-opacity"])})}};class uT extends Aa{constructor(n){super(n,cT)}}let h0;var dT={get paint(){return h0=h0||new Ar({"raster-opacity":new Zt(ae.paint_raster["raster-opacity"]),"raster-hue-rotate":new Zt(ae.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Zt(ae.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Zt(ae.paint_raster["raster-brightness-max"]),"raster-saturation":new Zt(ae.paint_raster["raster-saturation"]),"raster-contrast":new Zt(ae.paint_raster["raster-contrast"]),"raster-resampling":new Zt(ae.paint_raster["raster-resampling"]),"raster-fade-duration":new Zt(ae.paint_raster["raster-fade-duration"])})}};class hT extends Aa{constructor(n){super(n,dT)}}class fT extends Aa{constructor(n){super(n,{}),this.onAdd=a=>{this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)},this.onRemove=a=>{this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)},this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class pT{constructor(n){this._methodToThrottle=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Dg=63710088e-1;class Fo{constructor(n,a){if(isNaN(n)||isNaN(a))throw new Error(`Invalid LngLat object: (${n}, ${a})`);if(this.lng=+n,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Fo(Lt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const a=Math.PI/180,c=this.lat*a,p=n.lat*a,v=Math.sin(c)*Math.sin(p)+Math.cos(c)*Math.cos(p)*Math.cos((n.lng-this.lng)*a);return Dg*Math.acos(Math.min(v,1))}static convert(n){if(n instanceof Fo)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new Fo(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new Fo(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const f0=2*Math.PI*Dg;function p0(s){return f0*Math.cos(s*Math.PI/180)}function m0(s){return(180+s)/360}function g0(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function _0(s,n){return s/p0(n)}function zg(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function y0(s,n){return s*p0(zg(n))}class Nd{constructor(n,a,c=0){this.x=+n,this.y=+a,this.z=+c}static fromLngLat(n,a=0){const c=Fo.convert(n);return new Nd(m0(c.lng),g0(c.lat),_0(a,c.lat))}toLngLat(){return new Fo(360*this.x-180,zg(this.y))}toAltitude(){return y0(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/f0*(n=zg(this.y),1/Math.cos(n*Math.PI/180));var n}}function v0(s,n,a){var c=2*Math.PI*6378137/256/Math.pow(2,a);return[s*c-2*Math.PI*6378137/2,n*c-2*Math.PI*6378137/2]}class Lg{constructor(n,a,c){if(!function(p,v,b){return!(p<0||p>25||b<0||b>=Math.pow(2,p)||v<0||v>=Math.pow(2,p))}(n,a,c))throw new Error(`x=${a}, y=${c}, z=${n} outside of bounds. 0<=x<${Math.pow(2,n)}, 0<=y<${Math.pow(2,n)} 0<=z<=25 `);this.z=n,this.x=a,this.y=c,this.key=qc(0,n,n,a,c)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,a,c){const p=(b=this.y,w=this.z,C=v0(256*(v=this.x),256*(b=Math.pow(2,w)-b-1),w),M=v0(256*(v+1),256*(b+1),w),C[0]+","+C[1]+","+M[0]+","+M[1]);var v,b,w,C,M;const R=function(L,$,H){let q,Y="";for(let re=L;re>0;re--)q=1<<re-1,Y+=($&q?1:0)+(H&q?2:0);return Y}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,a>1?"@2x":"").replace(/{quadkey}/g,R).replace(/{bbox-epsg-3857}/g,p)}isChildOf(n){const a=this.z-n.z;return a>0&&n.x===this.x>>a&&n.y===this.y>>a}getTilePoint(n){const a=Math.pow(2,this.z);return new B((n.x*a-this.x)*je,(n.y*a-this.y)*je)}toString(){return`${this.z}/${this.x}/${this.y}`}}class b0{constructor(n,a){this.wrap=n,this.canonical=a,this.key=qc(n,a.z,a.z,a.x,a.y)}}class ga{constructor(n,a,c,p,v){if(this.terrainRttPosMatrix32f=null,n<c)throw new Error(`overscaledZ should be >= z; overscaledZ = ${n}; z = ${c}`);this.overscaledZ=n,this.wrap=a,this.canonical=new Lg(c,+p,+v),this.key=qc(a,n,c,p,v)}clone(){return new ga(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-n;return n>this.canonical.z?new ga(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ga(n,this.wrap,n,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(n,a){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const c=this.canonical.z-n;return n>this.canonical.z?qc(this.wrap*+a,n,this.canonical.z,this.canonical.x,this.canonical.y):qc(this.wrap*+a,n,n,this.canonical.x>>c,this.canonical.y>>c)}isChildOf(n){if(n.wrap!==this.wrap)return!1;const a=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.x===this.canonical.x>>a&&n.canonical.y===this.canonical.y>>a}children(n){if(this.overscaledZ>=n)return[new ga(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,c=2*this.canonical.x,p=2*this.canonical.y;return[new ga(a,this.wrap,a,c,p),new ga(a,this.wrap,a,c+1,p),new ga(a,this.wrap,a,c,p+1),new ga(a,this.wrap,a,c+1,p+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new ga(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new ga(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new b0(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(n){return this.canonical.getTilePoint(new Nd(n.x-this.wrap,n.y))}}function qc(s,n,a,c,p){(s*=2)<0&&(s=-1*s-1);const v=1<<a;return(v*v*s+v*p+c).toString(36)+a.toString(36)+n.toString(36)}Ft("CanonicalTileID",Lg),Ft("OverscaledTileID",ga,{omit:["terrainRttPosMatrix32f"]});class x0{constructor(n,a,c,p=1,v=1,b=1,w=0){if(this.uid=n,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(c&&!["mapbox","terrarium","custom"].includes(c))return void si(`"${c}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=a.height;const C=this.dim=a.height-2;switch(this.data=new Uint32Array(a.data.buffer),c){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=p,this.greenFactor=v,this.blueFactor=b,this.baseShift=w;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let M=0;M<C;M++)this.data[this._idx(-1,M)]=this.data[this._idx(0,M)],this.data[this._idx(C,M)]=this.data[this._idx(C-1,M)],this.data[this._idx(M,-1)]=this.data[this._idx(M,0)],this.data[this._idx(M,C)]=this.data[this._idx(M,C-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(C,-1)]=this.data[this._idx(C-1,0)],this.data[this._idx(-1,C)]=this.data[this._idx(0,C-1)],this.data[this._idx(C,C)]=this.data[this._idx(C-1,C-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let M=0;M<C;M++)for(let R=0;R<C;R++){const L=this.get(M,R);L>this.max&&(this.max=L),L<this.min&&(this.min=L)}}get(n,a){const c=new Uint8Array(this.data.buffer),p=4*this._idx(n,a);return this.unpack(c[p],c[p+1],c[p+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(n,a){if(n<-1||n>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(n+1)}unpack(n,a,c){return n*this.redFactor+a*this.greenFactor+c*this.blueFactor-this.baseShift}getPixels(){return new ma({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(n,a,c){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let p=a*this.dim,v=a*this.dim+this.dim,b=c*this.dim,w=c*this.dim+this.dim;switch(a){case-1:p=v-1;break;case 1:v=p+1}switch(c){case-1:b=w-1;break;case 1:w=b+1}const C=-a*this.dim,M=-c*this.dim;for(let R=b;R<w;R++)for(let L=p;L<v;L++)this.data[this._idx(L,R)]=n.data[this._idx(L+C,R+M)]}}Ft("DEMData",x0);class w0{constructor(n){this._stringToNumber={},this._numberToString=[];for(let a=0;a<n.length;a++){const c=n[a];this._stringToNumber[c]=a,this._numberToString[a]=c}}encode(n){return this._stringToNumber[n]}decode(n){if(n>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${n} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[n]}}class S0{constructor(n,a,c,p,v){this.type="Feature",this._vectorTileFeature=n,n._z=a,n._x=c,n._y=p,this.properties=n.properties,this.id=v}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={geometry:this.geometry};for(const a in this)a!=="_geometry"&&a!=="_vectorTileFeature"&&(n[a]=this[a]);return n}}class C0{constructor(n,a){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new Us(je,16,0),this.grid3D=new Us(je,16,0),this.featureIndexArray=new le,this.promoteId=a}insert(n,a,c,p,v,b){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,p,v);const C=b?this.grid3D:this.grid;for(let M=0;M<a.length;M++){const R=a[M],L=[1/0,1/0,-1/0,-1/0];for(let $=0;$<R.length;$++){const H=R[$];L[0]=Math.min(L[0],H.x),L[1]=Math.min(L[1],H.y),L[2]=Math.max(L[2],H.x),L[3]=Math.max(L[3],H.y)}L[0]<je&&L[1]<je&&L[2]>=0&&L[3]>=0&&C.insert(w,L[0],L[1],L[2],L[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new zd.VectorTile(new Sg(this.rawTileData)).layers,this.sourceLayerCoder=new w0(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(n,a,c,p){this.loadVTLayers();const v=n.params,b=je/n.tileSize/n.scale,w=Tc(v.filter),C=n.queryGeometry,M=n.queryPadding*b,R=P0(C),L=this.grid.query(R.minX-M,R.minY-M,R.maxX+M,R.maxY+M),$=P0(n.cameraQueryGeometry),H=this.grid3D.query($.minX-M,$.minY-M,$.maxX+M,$.maxY+M,(re,de,ze,_e)=>function(G,ie,ve,He,ht){for(const nt of G)if(ie<=nt.x&&ve<=nt.y&&He>=nt.x&&ht>=nt.y)return!0;const Ye=[new B(ie,ve),new B(ie,ht),new B(He,ht),new B(He,ve)];if(G.length>2){for(const nt of Ye)if($c(G,nt))return!0}for(let nt=0;nt<G.length-1;nt++)if(i2(G[nt],G[nt+1],Ye))return!0;return!1}(n.cameraQueryGeometry,re-M,de-M,ze+M,_e+M));for(const re of H)L.push(re);L.sort(mT);const q={};let Y;for(let re=0;re<L.length;re++){const de=L[re];if(de===Y)continue;Y=de;const ze=this.featureIndexArray.get(de);let _e=null;this.loadMatchingFeature(q,ze.bucketIndex,ze.sourceLayerIndex,ze.featureIndex,w,v.layers,v.availableImages,a,c,p,(G,ie,ve)=>(_e||(_e=Zs(G)),ie.queryIntersectsFeature({queryGeometry:C,feature:G,featureState:ve,geometry:_e,zoom:this.z,transform:n.transform,pixelsToTileUnits:b,pixelPosMatrix:n.pixelPosMatrix})))}return q}loadMatchingFeature(n,a,c,p,v,b,w,C,M,R,L){const $=this.bucketLayerIDs[a];if(b&&!$.some(re=>b.has(re)))return;const H=this.sourceLayerCoder.decode(c),q=this.vtLayers[H].feature(p);if(v.needGeometry){const re=qs(q,!0);if(!v.filter(new mi(this.tileID.overscaledZ),re,this.tileID.canonical))return}else if(!v.filter(new mi(this.tileID.overscaledZ),q))return;const Y=this.getId(q,H);for(let re=0;re<$.length;re++){const de=$[re];if(b&&!b.has(de))continue;const ze=C[de];if(!ze)continue;let _e={};Y&&R&&(_e=R.getState(ze.sourceLayer||"_geojsonTileLayer",Y));const G=Yt({},M[de]);G.paint=T0(G.paint,ze.paint,q,_e,w),G.layout=T0(G.layout,ze.layout,q,_e,w);const ie=!L||L(q,ze,_e);if(!ie)continue;const ve=new S0(q,this.z,this.x,this.y,Y);ve.layer=G;let He=n[de];He===void 0&&(He=n[de]=[]),He.push({featureIndex:p,feature:ve,intersectionZ:ie})}}lookupSymbolFeatures(n,a,c,p,v,b,w,C){const M={};this.loadVTLayers();const R=Tc(v);for(const L of n)this.loadMatchingFeature(M,c,p,L,R,b,w,C,a);return M}hasLayer(n){for(const a of this.bucketLayerIDs)for(const c of a)if(n===c)return!0;return!1}getId(n,a){var c;let p=n.id;return this.promoteId&&(p=n.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[a]],typeof p=="boolean"&&(p=Number(p)),p===void 0&&(!((c=n.properties)===null||c===void 0)&&c.cluster)&&this.promoteId&&(p=Number(n.properties.cluster_id))),p}}function T0(s,n,a,c,p){return _n(s,(v,b)=>{const w=n instanceof Ao?n.get(b):null;return w&&w.evaluate?w.evaluate(a,c,p):w})}function P0(s){let n=1/0,a=1/0,c=-1/0,p=-1/0;for(const v of s)n=Math.min(n,v.x),a=Math.min(a,v.y),c=Math.max(c,v.x),p=Math.max(p,v.y);return{minX:n,minY:a,maxX:c,maxY:p}}function mT(s,n){return n-s}function k0(s,n,a,c,p){const v=[];for(let b=0;b<s.length;b++){const w=s[b];let C;for(let M=0;M<w.length-1;M++){let R=w[M],L=w[M+1];R.x<n&&L.x<n||(R.x<n?R=new B(n,R.y+(n-R.x)/(L.x-R.x)*(L.y-R.y))._round():L.x<n&&(L=new B(n,R.y+(n-R.x)/(L.x-R.x)*(L.y-R.y))._round()),R.y<a&&L.y<a||(R.y<a?R=new B(R.x+(a-R.y)/(L.y-R.y)*(L.x-R.x),a)._round():L.y<a&&(L=new B(R.x+(a-R.y)/(L.y-R.y)*(L.x-R.x),a)._round()),R.x>=c&&L.x>=c||(R.x>=c?R=new B(c,R.y+(c-R.x)/(L.x-R.x)*(L.y-R.y))._round():L.x>=c&&(L=new B(c,R.y+(c-R.x)/(L.x-R.x)*(L.y-R.y))._round()),R.y>=p&&L.y>=p||(R.y>=p?R=new B(R.x+(p-R.y)/(L.y-R.y)*(L.x-R.x),p)._round():L.y>=p&&(L=new B(R.x+(p-R.y)/(L.y-R.y)*(L.x-R.x),p)._round()),C&&R.equals(C[C.length-1])||(C=[R],v.push(C)),C.push(L)))))}}return v}Ft("FeatureIndex",C0,{omit:["rawTileData","sourceLayerCoder"]});class Oo extends B{constructor(n,a,c,p){super(n,a),this.angle=c,p!==void 0&&(this.segment=p)}clone(){return new Oo(this.x,this.y,this.angle,this.segment)}}function I0(s,n,a,c,p){if(n.segment===void 0||a===0)return!0;let v=n,b=n.segment+1,w=0;for(;w>-a/2;){if(b--,b<0)return!1;w-=s[b].dist(v),v=s[b]}w+=s[b].dist(s[b+1]),b++;const C=[];let M=0;for(;w<a/2;){const R=s[b],L=s[b+1];if(!L)return!1;let $=s[b-1].angleTo(R)-R.angleTo(L);for($=Math.abs(($+3*Math.PI)%(2*Math.PI)-Math.PI),C.push({distance:w,angleDelta:$}),M+=$;w-C[0].distance>c;)M-=C.shift().angleDelta;if(M>p)return!1;b++,w+=R.dist(L)}return!0}function M0(s){let n=0;for(let a=0;a<s.length-1;a++)n+=s[a].dist(s[a+1]);return n}function E0(s,n,a){return s?.6*n*a:0}function A0(s,n){return Math.max(s?s.right-s.left:0,n?n.right-n.left:0)}function gT(s,n,a,c,p,v){const b=E0(a,p,v),w=A0(a,c)*v;let C=0;const M=M0(s)/2;for(let R=0;R<s.length-1;R++){const L=s[R],$=s[R+1],H=L.dist($);if(C+H>M){const q=(M-C)/H,Y=fa.number(L.x,$.x,q),re=fa.number(L.y,$.y,q),de=new Oo(Y,re,$.angleTo(L),R);return de._round(),!b||I0(s,de,w,b,n)?de:void 0}C+=H}}function _T(s,n,a,c,p,v,b,w,C){const M=E0(c,v,b),R=A0(c,p),L=R*b,$=s[0].x===0||s[0].x===C||s[0].y===0||s[0].y===C;return n-L<n/4&&(n=L+n/4),R0(s,$?n/2*w%n:(R/2+2*v)*b*w%n,n,M,a,L,$,!1,C)}function R0(s,n,a,c,p,v,b,w,C){const M=v/2,R=M0(s);let L=0,$=n-a,H=[];for(let q=0;q<s.length-1;q++){const Y=s[q],re=s[q+1],de=Y.dist(re),ze=re.angleTo(Y);for(;$+a<L+de;){$+=a;const _e=($-L)/de,G=fa.number(Y.x,re.x,_e),ie=fa.number(Y.y,re.y,_e);if(G>=0&&G<C&&ie>=0&&ie<C&&$-M>=0&&$+M<=R){const ve=new Oo(G,ie,ze,q);ve._round(),c&&!I0(s,ve,v,c,p)||H.push(ve)}}L+=de}return w||H.length||b||(H=R0(s,L/2,a,c,p,v,b,!0,C)),H}Ft("Anchor",Oo);const $d=Ur;function D0(s,n,a,c){const p=[],v=s.image,b=v.pixelRatio,w=v.paddedRect.w-2*$d,C=v.paddedRect.h-2*$d;let M={x1:s.left,y1:s.top,x2:s.right,y2:s.bottom};const R=v.stretchX||[[0,w]],L=v.stretchY||[[0,C]],$=(at,jt)=>at+jt[1]-jt[0],H=R.reduce($,0),q=L.reduce($,0),Y=w-H,re=C-q;let de=0,ze=H,_e=0,G=q,ie=0,ve=Y,He=0,ht=re;if(v.content&&c){const at=v.content,jt=at[2]-at[0],Qt=at[3]-at[1];(v.textFitWidth||v.textFitHeight)&&(M=a0(s)),de=tp(R,0,at[0]),_e=tp(L,0,at[1]),ze=tp(R,at[0],at[2]),G=tp(L,at[1],at[3]),ie=at[0]-de,He=at[1]-_e,ve=jt-ze,ht=Qt-G}const Ye=M.x1,nt=M.y1,yt=M.x2-Ye,mt=M.y2-nt,bt=(at,jt,Qt,Kt)=>{const Gt=np(at.stretch-de,ze,yt,Ye),Mn=ip(at.fixed-ie,ve,at.stretch,H),Mi=np(jt.stretch-_e,G,mt,nt),Yi=ip(jt.fixed-He,ht,jt.stretch,q),vr=np(Qt.stretch-de,ze,yt,Ye),_a=ip(Qt.fixed-ie,ve,Qt.stretch,H),Gr=np(Kt.stretch-_e,G,mt,nt),cr=ip(Kt.fixed-He,ht,Kt.stretch,q),wi=new B(Gt,Mi),nr=new B(vr,Mi),ur=new B(vr,Gr),dr=new B(Gt,Gr),Dr=new B(Mn/b,Yi/b),ya=new B(_a/b,cr/b),ir=n*Math.PI/180;if(ir){const rr=Math.sin(ir),ar=Math.cos(ir),ji=[ar,-rr,rr,ar];wi._matMult(ji),nr._matMult(ji),dr._matMult(ji),ur._matMult(ji)}const Hr=at.stretch+at.fixed,Ji=jt.stretch+jt.fixed;return{tl:wi,tr:nr,bl:dr,br:ur,tex:{x:v.paddedRect.x+$d+Hr,y:v.paddedRect.y+$d+Ji,w:Qt.stretch+Qt.fixed-Hr,h:Kt.stretch+Kt.fixed-Ji},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Dr,pixelOffsetBR:ya,minFontScaleX:ve/b/yt,minFontScaleY:ht/b/mt,isSDF:a}};if(c&&(v.stretchX||v.stretchY)){const at=z0(R,Y,H),jt=z0(L,re,q);for(let Qt=0;Qt<at.length-1;Qt++){const Kt=at[Qt],Gt=at[Qt+1];for(let Mn=0;Mn<jt.length-1;Mn++)p.push(bt(Kt,jt[Mn],Gt,jt[Mn+1]))}}else p.push(bt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:C+1}));return p}function tp(s,n,a){let c=0;for(const p of s)c+=Math.max(n,Math.min(a,p[1]))-Math.max(n,Math.min(a,p[0]));return c}function z0(s,n,a){const c=[{fixed:-1,stretch:0}];for(const[p,v]of s){const b=c[c.length-1];c.push({fixed:p-b.stretch,stretch:b.stretch}),c.push({fixed:p-b.stretch,stretch:b.stretch+(v-p)})}return c.push({fixed:n+$d,stretch:a}),c}function np(s,n,a,c){return s/n*a+c}function ip(s,n,a,c){return s-n*a/c}class rp{constructor(n,a,c,p,v,b,w,C,M,R){var L;if(this.boxStartIndex=n.length,M){let $=b.top,H=b.bottom;const q=b.collisionPadding;q&&($-=q[1],H+=q[3]);let Y=H-$;Y>0&&(Y=Math.max(10,Y),this.circleDiameter=Y)}else{const $=!((L=b.image)===null||L===void 0)&&L.content&&(b.image.textFitWidth||b.image.textFitHeight)?a0(b):{x1:b.left,y1:b.top,x2:b.right,y2:b.bottom};$.y1=$.y1*w-C[0],$.y2=$.y2*w+C[2],$.x1=$.x1*w-C[3],$.x2=$.x2*w+C[1];const H=b.collisionPadding;if(H&&($.x1-=H[0]*w,$.y1-=H[1]*w,$.x2+=H[2]*w,$.y2+=H[3]*w),R){const q=new B($.x1,$.y1),Y=new B($.x2,$.y1),re=new B($.x1,$.y2),de=new B($.x2,$.y2),ze=R*Math.PI/180;q._rotate(ze),Y._rotate(ze),re._rotate(ze),de._rotate(ze),$.x1=Math.min(q.x,Y.x,re.x,de.x),$.x2=Math.max(q.x,Y.x,re.x,de.x),$.y1=Math.min(q.y,Y.y,re.y,de.y),$.y2=Math.max(q.y,Y.y,re.y,de.y)}n.emplaceBack(a.x,a.y,$.x1,$.y1,$.x2,$.y2,c,p,v)}this.boxEndIndex=n.length}}class yT{constructor(n=[],a=(c,p)=>c<p?-1:c>p?1:0){if(this.data=n,this.length=this.data.length,this.compare=a,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:a,compare:c}=this,p=a[n];for(;n>0;){const v=n-1>>1,b=a[v];if(c(p,b)>=0)break;a[n]=b,n=v}a[n]=p}_down(n){const{data:a,compare:c}=this,p=this.length>>1,v=a[n];for(;n<p;){let b=1+(n<<1);const w=b+1;if(w<this.length&&c(a[w],a[b])<0&&(b=w),c(a[b],v)>=0)break;a[n]=a[b],n=b}a[n]=v}}function vT(s,n=1,a=!1){let c=1/0,p=1/0,v=-1/0,b=-1/0;const w=s[0];for(let H=0;H<w.length;H++){const q=w[H];(!H||q.x<c)&&(c=q.x),(!H||q.y<p)&&(p=q.y),(!H||q.x>v)&&(v=q.x),(!H||q.y>b)&&(b=q.y)}const C=Math.min(v-c,b-p);let M=C/2;const R=new yT([],bT);if(C===0)return new B(c,p);for(let H=c;H<v;H+=C)for(let q=p;q<b;q+=C)R.push(new Wc(H+M,q+M,M,s));let L=function(H){let q=0,Y=0,re=0;const de=H[0];for(let ze=0,_e=de.length,G=_e-1;ze<_e;G=ze++){const ie=de[ze],ve=de[G],He=ie.x*ve.y-ve.x*ie.y;Y+=(ie.x+ve.x)*He,re+=(ie.y+ve.y)*He,q+=3*He}return new Wc(Y/q,re/q,0,H)}(s),$=R.length;for(;R.length;){const H=R.pop();(H.d>L.d||!L.d)&&(L=H,a&&console.log("found best %d after %d probes",Math.round(1e4*H.d)/1e4,$)),H.max-L.d<=n||(M=H.h/2,R.push(new Wc(H.p.x-M,H.p.y-M,M,s)),R.push(new Wc(H.p.x+M,H.p.y-M,M,s)),R.push(new Wc(H.p.x-M,H.p.y+M,M,s)),R.push(new Wc(H.p.x+M,H.p.y+M,M,s)),$+=4)}return a&&(console.log(`num probes: ${$}`),console.log(`best distance: ${L.d}`)),L.p}function bT(s,n){return n.max-s.max}function Wc(s,n,a,c){this.p=new B(s,n),this.h=a,this.d=function(p,v){let b=!1,w=1/0;for(let C=0;C<v.length;C++){const M=v[C];for(let R=0,L=M.length,$=L-1;R<L;$=R++){const H=M[R],q=M[$];H.y>p.y!=q.y>p.y&&p.x<(q.x-H.x)*(p.y-H.y)/(q.y-H.y)+H.x&&(b=!b),w=Math.min(w,pv(p,H,q))}}return(b?1:-1)*Math.sqrt(w)}(this.p,c),this.max=this.d+this.h*Math.SQRT2}var yr;m.av=void 0,(yr=m.av||(m.av={}))[yr.center=1]="center",yr[yr.left=2]="left",yr[yr.right=3]="right",yr[yr.top=4]="top",yr[yr.bottom=5]="bottom",yr[yr["top-left"]=6]="top-left",yr[yr["top-right"]=7]="top-right",yr[yr["bottom-left"]=8]="bottom-left",yr[yr["bottom-right"]=9]="bottom-right";const Vo=7,Bg=Number.POSITIVE_INFINITY;function L0(s,n){return n[1]!==Bg?function(a,c,p){let v=0,b=0;switch(c=Math.abs(c),p=Math.abs(p),a){case"top-right":case"top-left":case"top":b=p-Vo;break;case"bottom-right":case"bottom-left":case"bottom":b=-p+Vo}switch(a){case"top-right":case"bottom-right":case"right":v=-c;break;case"top-left":case"bottom-left":case"left":v=c}return[v,b]}(s,n[0],n[1]):function(a,c){let p=0,v=0;c<0&&(c=0);const b=c/Math.SQRT2;switch(a){case"top-right":case"top-left":v=b-Vo;break;case"bottom-right":case"bottom-left":v=-b+Vo;break;case"bottom":v=-c+Vo;break;case"top":v=c-Vo}switch(a){case"top-right":case"bottom-right":p=-b;break;case"top-left":case"bottom-left":p=b;break;case"left":p=c;break;case"right":p=-c}return[p,v]}(s,n[0])}function B0(s,n,a){var c;const p=s.layout,v=(c=p.get("text-variable-anchor-offset"))===null||c===void 0?void 0:c.evaluate(n,{},a);if(v){const w=v.values,C=[];for(let M=0;M<w.length;M+=2){const R=C[M]=w[M],L=w[M+1].map($=>$*Ki);R.startsWith("top")?L[1]-=Vo:R.startsWith("bottom")&&(L[1]+=Vo),C[M+1]=L}return new mr(C)}const b=p.get("text-variable-anchor");if(b){let w;w=s._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[p.get("text-radial-offset").evaluate(n,{},a)*Ki,Bg]:p.get("text-offset").evaluate(n,{},a).map(M=>M*Ki);const C=[];for(const M of b)C.push(M,L0(M,w));return new mr(C)}return null}function Fg(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function xT(s,n,a,c,p,v,b,w,C,M,R,L){let $=v.textMaxSize.evaluate(n,{});$===void 0&&($=b);const H=s.layers[0].layout,q=H.get("icon-offset").evaluate(n,{},R),Y=O0(a.horizontal),re=b/24,de=s.tilePixelRatio*re,ze=s.tilePixelRatio*$/24,_e=s.tilePixelRatio*w,G=s.tilePixelRatio*H.get("symbol-spacing"),ie=H.get("text-padding")*s.tilePixelRatio,ve=function(Qt,Kt,Gt,Mn=1){const Mi=Qt.get("icon-padding").evaluate(Kt,{},Gt),Yi=Mi&&Mi.values;return[Yi[0]*Mn,Yi[1]*Mn,Yi[2]*Mn,Yi[3]*Mn]}(H,n,R,s.tilePixelRatio),He=H.get("text-max-angle")/180*Math.PI,ht=H.get("text-rotation-alignment")!=="viewport"&&H.get("symbol-placement")!=="point",Ye=H.get("icon-rotation-alignment")==="map"&&H.get("symbol-placement")!=="point",nt=H.get("symbol-placement"),yt=G/2,mt=H.get("icon-text-fit");let bt;c&&mt!=="none"&&(s.allowVerticalPlacement&&a.vertical&&(bt=s0(c,a.vertical,mt,H.get("icon-text-fit-padding"),q,re)),Y&&(c=s0(c,Y,mt,H.get("icon-text-fit-padding"),q,re)));const at=R?L.line.getGranularityForZoomLevel(R.z):1,jt=(Qt,Kt)=>{Kt.x<0||Kt.x>=je||Kt.y<0||Kt.y>=je||function(Gt,Mn,Mi,Yi,vr,_a,Gr,cr,wi,nr,ur,dr,Dr,ya,ir,Hr,Ji,rr,ar,ji,ci,Ya,Xc,Ja,CT){const Kc=Gt.addToLineVertexArray(Mn,Mi);let Rl,Yc,Jc,Qc,j0=0,U0=0,G0=0,H0=0,Hg=-1,Zg=-1;const Ws={};let Z0=Ni("");if(Gt.allowVerticalPlacement&&Yi.vertical){const Cr=cr.layout.get("text-rotate").evaluate(ci,{},Ja)+90;Jc=new rp(wi,Mn,nr,ur,dr,Yi.vertical,Dr,ya,ir,Cr),Gr&&(Qc=new rp(wi,Mn,nr,ur,dr,Gr,Ji,rr,ir,Cr))}if(vr){const Cr=cr.layout.get("icon-rotate").evaluate(ci,{}),va=cr.layout.get("icon-text-fit")!=="none",Dl=D0(vr,Cr,Xc,va),es=Gr?D0(Gr,Cr,Xc,va):void 0;Yc=new rp(wi,Mn,nr,ur,dr,vr,Ji,rr,!1,Cr),j0=4*Dl.length;const zl=Gt.iconSizeData;let _s=null;zl.kind==="source"?(_s=[gs*cr.layout.get("icon-size").evaluate(ci,{})],_s[0]>Bo&&si(`${Gt.layerIds[0]}: Value for "icon-size" is >= ${Vd}. Reduce your "icon-size".`)):zl.kind==="composite"&&(_s=[gs*Ya.compositeIconSizes[0].evaluate(ci,{},Ja),gs*Ya.compositeIconSizes[1].evaluate(ci,{},Ja)],(_s[0]>Bo||_s[1]>Bo)&&si(`${Gt.layerIds[0]}: Value for "icon-size" is >= ${Vd}. Reduce your "icon-size".`)),Gt.addSymbols(Gt.icon,Dl,_s,ji,ar,ci,m.ai.none,Mn,Kc.lineStartIndex,Kc.lineLength,-1,Ja),Hg=Gt.icon.placedSymbolArray.length-1,es&&(U0=4*es.length,Gt.addSymbols(Gt.icon,es,_s,ji,ar,ci,m.ai.vertical,Mn,Kc.lineStartIndex,Kc.lineLength,-1,Ja),Zg=Gt.icon.placedSymbolArray.length-1)}const q0=Object.keys(Yi.horizontal);for(const Cr of q0){const va=Yi.horizontal[Cr];if(!Rl){Z0=Ni(va.text);const es=cr.layout.get("text-rotate").evaluate(ci,{},Ja);Rl=new rp(wi,Mn,nr,ur,dr,va,Dr,ya,ir,es)}const Dl=va.positionedLines.length===1;if(G0+=F0(Gt,Mn,va,_a,cr,ir,ci,Hr,Kc,Yi.vertical?m.ai.horizontal:m.ai.horizontalOnly,Dl?q0:[Cr],Ws,Hg,Ya,Ja),Dl)break}Yi.vertical&&(H0+=F0(Gt,Mn,Yi.vertical,_a,cr,ir,ci,Hr,Kc,m.ai.vertical,["vertical"],Ws,Zg,Ya,Ja));const TT=Rl?Rl.boxStartIndex:Gt.collisionBoxArray.length,PT=Rl?Rl.boxEndIndex:Gt.collisionBoxArray.length,kT=Jc?Jc.boxStartIndex:Gt.collisionBoxArray.length,IT=Jc?Jc.boxEndIndex:Gt.collisionBoxArray.length,MT=Yc?Yc.boxStartIndex:Gt.collisionBoxArray.length,ET=Yc?Yc.boxEndIndex:Gt.collisionBoxArray.length,AT=Qc?Qc.boxStartIndex:Gt.collisionBoxArray.length,RT=Qc?Qc.boxEndIndex:Gt.collisionBoxArray.length;let Qa=-1;const sp=(Cr,va)=>Cr&&Cr.circleDiameter?Math.max(Cr.circleDiameter,va):va;Qa=sp(Rl,Qa),Qa=sp(Jc,Qa),Qa=sp(Yc,Qa),Qa=sp(Qc,Qa);const W0=Qa>-1?1:0;W0&&(Qa*=CT/Ki),Gt.glyphOffsetArray.length>=Zc.MAX_GLYPHS&&si("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ci.sortKey!==void 0&&Gt.addToSortKeyRanges(Gt.symbolInstances.length,ci.sortKey);const DT=B0(cr,ci,Ja),[zT,LT]=function(Cr,va){const Dl=Cr.length,es=va==null?void 0:va.values;if((es==null?void 0:es.length)>0)for(let zl=0;zl<es.length;zl+=2){const _s=es[zl+1];Cr.emplaceBack(m.av[es[zl]],_s[0],_s[1])}return[Dl,Cr.length]}(Gt.textAnchorOffsets,DT);Gt.symbolInstances.emplaceBack(Mn.x,Mn.y,Ws.right>=0?Ws.right:-1,Ws.center>=0?Ws.center:-1,Ws.left>=0?Ws.left:-1,Ws.vertical||-1,Hg,Zg,Z0,TT,PT,kT,IT,MT,ET,AT,RT,nr,G0,H0,j0,U0,W0,0,Dr,Qa,zT,LT)}(s,Kt,Qt,a,c,p,bt,s.layers[0],s.collisionBoxArray,n.index,n.sourceLayerIndex,s.index,de,[ie,ie,ie,ie],ht,C,_e,ve,Ye,q,n,v,M,R,b)};if(nt==="line")for(const Qt of k0(n.geometry,0,0,je,je)){const Kt=Al(Qt,at),Gt=_T(Kt,G,He,a.vertical||Y,c,24,ze,s.overscaling,je);for(const Mn of Gt)Y&&wT(s,Y.text,yt,Mn)||jt(Kt,Mn)}else if(nt==="line-center"){for(const Qt of n.geometry)if(Qt.length>1){const Kt=Al(Qt,at),Gt=gT(Kt,He,a.vertical||Y,c,24,ze);Gt&&jt(Kt,Gt)}}else if(n.type==="Polygon")for(const Qt of uc(n.geometry,0)){const Kt=vT(Qt,16);jt(Al(Qt[0],at,!0),new Oo(Kt.x,Kt.y,0))}else if(n.type==="LineString")for(const Qt of n.geometry){const Kt=Al(Qt,at);jt(Kt,new Oo(Kt[0].x,Kt[0].y,0))}else if(n.type==="Point")for(const Qt of n.geometry)for(const Kt of Qt)jt([Kt],new Oo(Kt.x,Kt.y,0))}function F0(s,n,a,c,p,v,b,w,C,M,R,L,$,H,q){const Y=function(ze,_e,G,ie,ve,He,ht,Ye){const nt=ie.layout.get("text-rotate").evaluate(He,{})*Math.PI/180,yt=[];for(const mt of _e.positionedLines)for(const bt of mt.positionedGlyphs){if(!bt.rect)continue;const at=bt.rect||{};let jt=K2+1,Qt=!0,Kt=1,Gt=0;const Mn=(ve||Ye)&&bt.vertical,Mi=bt.metrics.advance*bt.scale/2;if(Ye&&_e.verticalizable&&(Gt=mt.lineOffset/2-(bt.imageName?-(Ki-bt.metrics.width*bt.scale)/2:(bt.scale-1)*Ki)),bt.imageName){const rr=ht[bt.imageName];Qt=rr.sdf,Kt=rr.pixelRatio,jt=Ur/Kt}const Yi=ve?[bt.x+Mi,bt.y]:[0,0];let vr=ve?[0,0]:[bt.x+Mi+G[0],bt.y+G[1]-Gt],_a=[0,0];Mn&&(_a=vr,vr=[0,0]);const Gr=bt.metrics.isDoubleResolution?2:1,cr=(bt.metrics.left-jt)*bt.scale-Mi+vr[0],wi=(-bt.metrics.top-jt)*bt.scale+vr[1],nr=cr+at.w/Gr*bt.scale/Kt,ur=wi+at.h/Gr*bt.scale/Kt,dr=new B(cr,wi),Dr=new B(nr,wi),ya=new B(cr,ur),ir=new B(nr,ur);if(Mn){const rr=new B(-Mi,Mi-Kf),ar=-Math.PI/2,ji=Ki/2-Mi,ci=new B(5-Kf-ji,-(bt.imageName?ji:0)),Ya=new B(..._a);dr._rotateAround(ar,rr)._add(ci)._add(Ya),Dr._rotateAround(ar,rr)._add(ci)._add(Ya),ya._rotateAround(ar,rr)._add(ci)._add(Ya),ir._rotateAround(ar,rr)._add(ci)._add(Ya)}if(nt){const rr=Math.sin(nt),ar=Math.cos(nt),ji=[ar,-rr,rr,ar];dr._matMult(ji),Dr._matMult(ji),ya._matMult(ji),ir._matMult(ji)}const Hr=new B(0,0),Ji=new B(0,0);yt.push({tl:dr,tr:Dr,bl:ya,br:ir,tex:at,writingMode:_e.writingMode,glyphOffset:Yi,sectionIndex:bt.sectionIndex,isSDF:Qt,pixelOffsetTL:Hr,pixelOffsetBR:Ji,minFontScaleX:0,minFontScaleY:0})}return yt}(0,a,w,p,v,b,c,s.allowVerticalPlacement),re=s.textSizeData;let de=null;re.kind==="source"?(de=[gs*p.layout.get("text-size").evaluate(b,{})],de[0]>Bo&&si(`${s.layerIds[0]}: Value for "text-size" is >= ${Vd}. Reduce your "text-size".`)):re.kind==="composite"&&(de=[gs*H.compositeTextSizes[0].evaluate(b,{},q),gs*H.compositeTextSizes[1].evaluate(b,{},q)],(de[0]>Bo||de[1]>Bo)&&si(`${s.layerIds[0]}: Value for "text-size" is >= ${Vd}. Reduce your "text-size".`)),s.addSymbols(s.text,Y,de,w,v,b,M,n,C.lineStartIndex,C.lineLength,$,q);for(const ze of R)L[ze]=s.text.placedSymbolArray.length-1;return 4*Y.length}function O0(s){for(const n in s)return s[n];return null}function wT(s,n,a,c){const p=s.compareText;if(n in p){const v=p[n];for(let b=v.length-1;b>=0;b--)if(c.dist(v[b])<a)return!0}else p[n]=[];return p[n].push(c),!1}const V0=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Og{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,c]=new Uint8Array(n,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=c>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const v=V0[15&c];if(!v)throw new Error("Unrecognized array type.");const[b]=new Uint16Array(n,2,1),[w]=new Uint32Array(n,4,1);return new Og(w,b,v,n)}constructor(n,a=64,c=Float64Array,p){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=c,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const v=V0.indexOf(this.ArrayType),b=2*n*this.ArrayType.BYTES_PER_ELEMENT,w=n*this.IndexArrayType.BYTES_PER_ELEMENT,C=(8-w%8)%8;if(v<0)throw new Error(`Unexpected typed array class: ${c}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+w+C,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+b+w+C),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+w+C,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+v]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=n)}add(n,a){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=n,this.coords[this._pos++]=a,c}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return Vg(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,a,c,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:b,nodeSize:w}=this,C=[0,v.length-1,0],M=[];for(;C.length;){const R=C.pop()||0,L=C.pop()||0,$=C.pop()||0;if(L-$<=w){for(let re=$;re<=L;re++){const de=b[2*re],ze=b[2*re+1];de>=n&&de<=c&&ze>=a&&ze<=p&&M.push(v[re])}continue}const H=$+L>>1,q=b[2*H],Y=b[2*H+1];q>=n&&q<=c&&Y>=a&&Y<=p&&M.push(v[H]),(R===0?n<=q:a<=Y)&&(C.push($),C.push(H-1),C.push(1-R)),(R===0?c>=q:p>=Y)&&(C.push(H+1),C.push(L),C.push(1-R))}return M}within(n,a,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:v,nodeSize:b}=this,w=[0,p.length-1,0],C=[],M=c*c;for(;w.length;){const R=w.pop()||0,L=w.pop()||0,$=w.pop()||0;if(L-$<=b){for(let re=$;re<=L;re++)$0(v[2*re],v[2*re+1],n,a)<=M&&C.push(p[re]);continue}const H=$+L>>1,q=v[2*H],Y=v[2*H+1];$0(q,Y,n,a)<=M&&C.push(p[H]),(R===0?n-c<=q:a-c<=Y)&&(w.push($),w.push(H-1),w.push(1-R)),(R===0?n+c>=q:a+c>=Y)&&(w.push(H+1),w.push(L),w.push(1-R))}return C}}function Vg(s,n,a,c,p,v){if(p-c<=a)return;const b=c+p>>1;N0(s,n,b,c,p,v),Vg(s,n,a,c,b-1,1-v),Vg(s,n,a,b+1,p,1-v)}function N0(s,n,a,c,p,v){for(;p>c;){if(p-c>600){const M=p-c+1,R=a-c+1,L=Math.log(M),$=.5*Math.exp(2*L/3),H=.5*Math.sqrt(L*$*(M-$)/M)*(R-M/2<0?-1:1);N0(s,n,a,Math.max(c,Math.floor(a-R*$/M+H)),Math.min(p,Math.floor(a+(M-R)*$/M+H)),v)}const b=n[2*a+v];let w=c,C=p;for(jd(s,n,c,a),n[2*p+v]>b&&jd(s,n,c,p);w<C;){for(jd(s,n,w,C),w++,C--;n[2*w+v]<b;)w++;for(;n[2*C+v]>b;)C--}n[2*c+v]===b?jd(s,n,c,C):(C++,jd(s,n,C,p)),C<=a&&(c=C+1),a<=C&&(p=C-1)}}function jd(s,n,a,c){Ng(s,a,c),Ng(n,2*a,2*c),Ng(n,2*a+1,2*c+1)}function Ng(s,n,a){const c=s[n];s[n]=s[a],s[a]=c}function $0(s,n,a,c){const p=s-a,v=n-c;return p*p+v*v}var $g;m.ce=void 0,($g=m.ce||(m.ce={})).create="create",$g.load="load",$g.fullLoad="fullLoad";let ap=null,Ud=[];const jg=1e3/60,Ug="loadTime",Gg="fullLoadTime",ST={mark(s){performance.mark(s)},frame(s){const n=s;ap!=null&&Ud.push(n-ap),ap=n},clearMetrics(){ap=null,Ud=[],performance.clearMeasures(Ug),performance.clearMeasures(Gg);for(const s in m.ce)performance.clearMarks(m.ce[s])},getPerformanceMetrics(){performance.measure(Ug,m.ce.create,m.ce.load),performance.measure(Gg,m.ce.create,m.ce.fullLoad);const s=performance.getEntriesByName(Ug)[0].duration,n=performance.getEntriesByName(Gg)[0].duration,a=Ud.length,c=1/(Ud.reduce((v,b)=>v+b,0)/a/1e3),p=Ud.filter(v=>v>jg).reduce((v,b)=>v+(b-jg)/jg,0);return{loadTime:s,fullLoadTime:n,fps:c,percentDroppedFrames:p/(a+p)*100,totalFrames:a}}};m.$=Be,m.A=Ce,m.B=vl,m.C=function(s){if(Le==null){const n=s.navigator?s.navigator.userAgent:null;Le=!!s.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return Le},m.D=Zt,m.E=Er,m.F=class{constructor(s,n){this.target=s,this.mapId=n,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new pT(()=>this.process()),this.subscription=function(a,c,p,v){return a.addEventListener(c,p,!1),{unsubscribe:()=>{a.removeEventListener(c,p,!1)}}}(this.target,"message",a=>this.receive(a)),this.globalScope=Pe(self)?s:window}registerMessageHandler(s,n){this.messageHandlers[s]=n}sendAsync(s,n){return new Promise((a,c)=>{const p=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[p]={resolve:a,reject:c},n&&n.signal.addEventListener("abort",()=>{delete this.resolveRejects[p];const w={id:p,type:"<cancel>",origin:location.origin,targetMapId:s.targetMapId,sourceMapId:this.mapId};this.target.postMessage(w)},{once:!0});const v=[],b=Object.assign(Object.assign({},s),{id:p,sourceMapId:this.mapId,origin:location.origin,data:bl(s.data,v)});this.target.postMessage(b,{transfer:v})})}receive(s){const n=s.data,a=n.id;if(!(n.origin!=="file://"&&location.origin!=="file://"&&n.origin!=="resource://android"&&location.origin!=="resource://android"&&n.origin!==location.origin||n.targetMapId&&this.mapId!==n.targetMapId)){if(n.type==="<cancel>"){delete this.tasks[a];const c=this.abortControllers[a];return delete this.abortControllers[a],void(c&&c.abort())}if(Pe(self)||n.mustQueue)return this.tasks[a]=n,this.taskQueue.push(a),void this.invoker.trigger();this.processTask(a,n)}}process(){if(this.taskQueue.length===0)return;const s=this.taskQueue.shift(),n=this.tasks[s];delete this.tasks[s],this.taskQueue.length>0&&this.invoker.trigger(),n&&this.processTask(s,n)}processTask(s,n){return o(this,void 0,void 0,function*(){if(n.type==="<response>"){const p=this.resolveRejects[s];return delete this.resolveRejects[s],p?void(n.error?p.reject(fs(n.error)):p.resolve(fs(n.data))):void 0}if(!this.messageHandlers[n.type])return void this.completeTask(s,new Error(`Could not find a registered handler for ${n.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const a=fs(n.data),c=new AbortController;this.abortControllers[s]=c;try{const p=yield this.messageHandlers[n.type](n.sourceMapId,a,c);this.completeTask(s,null,p)}catch(p){this.completeTask(s,p)}})}completeTask(s,n,a){const c=[];delete this.abortControllers[s];const p={id:s,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:n?bl(n):null,data:bl(a,c)};this.target.postMessage(p,{transfer:c})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},m.G=Xt,m.H=function(){var s=new Ce(16);return Ce!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},m.I=Tg,m.J=function(s,n,a){var c,p,v,b,w,C,M,R,L,$,H,q,Y=a[0],re=a[1],de=a[2];return n===s?(s[12]=n[0]*Y+n[4]*re+n[8]*de+n[12],s[13]=n[1]*Y+n[5]*re+n[9]*de+n[13],s[14]=n[2]*Y+n[6]*re+n[10]*de+n[14],s[15]=n[3]*Y+n[7]*re+n[11]*de+n[15]):(p=n[1],v=n[2],b=n[3],w=n[4],C=n[5],M=n[6],R=n[7],L=n[8],$=n[9],H=n[10],q=n[11],s[0]=c=n[0],s[1]=p,s[2]=v,s[3]=b,s[4]=w,s[5]=C,s[6]=M,s[7]=R,s[8]=L,s[9]=$,s[10]=H,s[11]=q,s[12]=c*Y+w*re+L*de+n[12],s[13]=p*Y+C*re+$*de+n[13],s[14]=v*Y+M*re+H*de+n[14],s[15]=b*Y+R*re+q*de+n[15]),s},m.K=function(s,n,a){var c=a[0],p=a[1],v=a[2];return s[0]=n[0]*c,s[1]=n[1]*c,s[2]=n[2]*c,s[3]=n[3]*c,s[4]=n[4]*p,s[5]=n[5]*p,s[6]=n[6]*p,s[7]=n[7]*p,s[8]=n[8]*v,s[9]=n[9]*v,s[10]=n[10]*v,s[11]=n[11]*v,s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15],s},m.L=function(s,n,a){var c=n[0],p=n[1],v=n[2],b=n[3],w=n[4],C=n[5],M=n[6],R=n[7],L=n[8],$=n[9],H=n[10],q=n[11],Y=n[12],re=n[13],de=n[14],ze=n[15],_e=a[0],G=a[1],ie=a[2],ve=a[3];return s[0]=_e*c+G*w+ie*L+ve*Y,s[1]=_e*p+G*C+ie*$+ve*re,s[2]=_e*v+G*M+ie*H+ve*de,s[3]=_e*b+G*R+ie*q+ve*ze,s[4]=(_e=a[4])*c+(G=a[5])*w+(ie=a[6])*L+(ve=a[7])*Y,s[5]=_e*p+G*C+ie*$+ve*re,s[6]=_e*v+G*M+ie*H+ve*de,s[7]=_e*b+G*R+ie*q+ve*ze,s[8]=(_e=a[8])*c+(G=a[9])*w+(ie=a[10])*L+(ve=a[11])*Y,s[9]=_e*p+G*C+ie*$+ve*re,s[10]=_e*v+G*M+ie*H+ve*de,s[11]=_e*b+G*R+ie*q+ve*ze,s[12]=(_e=a[12])*c+(G=a[13])*w+(ie=a[14])*L+(ve=a[15])*Y,s[13]=_e*p+G*C+ie*$+ve*re,s[14]=_e*v+G*M+ie*H+ve*de,s[15]=_e*b+G*R+ie*q+ve*ze,s},m.M=function(s,n){const a={};for(let c=0;c<n.length;c++){const p=n[c];p in s&&(a[p]=s[p])}return a},m.N=Fo,m.O=m0,m.P=B,m.Q=g0,m.R=ma,m.S=ga,m.T=dd,m.U=Se,m.V=me,m.W=gt,m.X=je,m.Y=Nd,m.Z=Lg,m._=o,m.a=tn,m.a$=function(){return new Float64Array(16)},m.a0=s=>{const n=window.document.createElement("video");return n.muted=!0,new Promise(a=>{n.onloadstart=()=>{a(n)};for(const c of s){const p=window.document.createElement("source");An(c)||(n.crossOrigin="Anonymous"),p.src=c,n.appendChild(p)}})},m.a1=function(){return qt++},m.a2=y,m.a3=Zc,m.a4=Tc,m.a5=qs,m.a6=S0,m.a7=function(s){const n={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,c,p,v)=>{const b=p||v;return n[c]=!b||b.toLowerCase(),""}),n["max-age"]){const a=parseInt(n["max-age"],10);isNaN(a)?delete n["max-age"]:n["max-age"]=a}return n},m.a8=function(s){return Math.log(s)/Math.LN2},m.a9=function(s){var n=s[0],a=s[1];return n*n+a*a},m.aA=zi,m.aB=qf,m.aC=se,m.aD=Dt,m.aE=et,m.aF=85.051129,m.aG=function(s){return Math.pow(2,s)},m.aH=_0,m.aI=Lt,m.aJ=It,m.aK=y0,m.aL=function(s,n,a){return s[0]=n[0]*a,s[1]=n[1]*a,s[2]=n[2]*a,s},m.aM=function(s,n,a){return s[0]=n[0]+a[0],s[1]=n[1]+a[1],s[2]=n[2]+a[2],s},m.aN=function(s){var n=new Ce(3);return n[0]=s[0],n[1]=s[1],n[2]=s[2],n},m.aO=function(s,n,a){return s[0]=n[0]*a[0],s[1]=n[1]*a[1],s[2]=n[2]*a[2],s[3]=n[3]*a[3],s},m.aP=function(s,n,a){return s[0]=n[0]-a[0],s[1]=n[1]-a[1],s[2]=n[2]-a[2],s},m.aQ=function(s,n){var a=n[0],c=n[1],p=n[2],v=a*a+c*c+p*p;return v>0&&(v=1/Math.sqrt(v)),s[0]=n[0]*v,s[1]=n[1]*v,s[2]=n[2]*v,s},m.aR=function(s,n,a){var c=n[0],p=n[1],v=n[2],b=a[0],w=a[1],C=a[2];return s[0]=p*C-v*w,s[1]=v*b-c*C,s[2]=c*w-p*b,s},m.aS=function(s,n){return s[0]*n[0]+s[1]*n[1]+s[2]*n[2]},m.aT=b0,m.aU=qc,m.aV=function(s,n,a,c,p){var v,b=1/Math.tan(n/2);return s[0]=b/a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=b,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,p!=null&&p!==1/0?(s[10]=(p+c)*(v=1/(c-p)),s[14]=2*p*c*v):(s[10]=-1,s[14]=-2*c),s},m.aW=function(s){var n=new Ce(16);return n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],n[4]=s[4],n[5]=s[5],n[6]=s[6],n[7]=s[7],n[8]=s[8],n[9]=s[9],n[10]=s[10],n[11]=s[11],n[12]=s[12],n[13]=s[13],n[14]=s[14],n[15]=s[15],n},m.aX=function(s,n,a){var c=Math.sin(a),p=Math.cos(a),v=n[0],b=n[1],w=n[2],C=n[3],M=n[4],R=n[5],L=n[6],$=n[7];return n!==s&&(s[8]=n[8],s[9]=n[9],s[10]=n[10],s[11]=n[11],s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15]),s[0]=v*p+M*c,s[1]=b*p+R*c,s[2]=w*p+L*c,s[3]=C*p+$*c,s[4]=M*p-v*c,s[5]=R*p-b*c,s[6]=L*p-w*c,s[7]=$*p-C*c,s},m.aY=function(s,n,a){var c=Math.sin(a),p=Math.cos(a),v=n[4],b=n[5],w=n[6],C=n[7],M=n[8],R=n[9],L=n[10],$=n[11];return n!==s&&(s[0]=n[0],s[1]=n[1],s[2]=n[2],s[3]=n[3],s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15]),s[4]=v*p+M*c,s[5]=b*p+R*c,s[6]=w*p+L*c,s[7]=C*p+$*c,s[8]=M*p-v*c,s[9]=R*p-b*c,s[10]=L*p-w*c,s[11]=$*p-C*c,s},m.aZ=function(){const s=new Float32Array(16);return Me(s),s},m.a_=function(){const s=new Float64Array(16);return Me(s),s},m.aa=function(s){return s*Math.PI/180},m.ab=Jt,m.ac=function(s,n){const a=[];for(const c in s)c in n||a.push(c);return a},m.ad=We,m.ae=function(s){return Math.hypot(s[0],s[1])},m.af=function(s){return s[0]=0,s[1]=0,s},m.ag=function(s,n,a){return s[0]=n[0]*a,s[1]=n[1]*a,s},m.ah=function(s,n){let a=0,c=0;if(s.kind==="constant")c=s.layoutSize;else if(s.kind!=="source"){const{interpolationType:p,minZoom:v,maxZoom:b}=s,w=p?Jt(ti.interpolationFactor(p,n,v,b),0,1):0;s.kind==="camera"?c=fa.number(s.minSize,s.maxSize,w):a=w}return{uSizeT:a,uSize:c}},m.aj=function(s,{uSize:n,uSizeT:a},{lowerSize:c,upperSize:p}){return s.kind==="source"?c/gs:s.kind==="composite"?fa.number(c/gs,p/gs,a):n},m.ak=Mg,m.al=xe,m.am=function(s,n,a,c){const p=n.y-s.y,v=n.x-s.x,b=c.y-a.y,w=c.x-a.x,C=b*v-w*p;if(C===0)return null;const M=(w*(s.y-a.y)-b*(s.x-a.x))/C;return new B(s.x+M*v,s.y+M*p)},m.an=function(s,n){var a=n[0],c=n[1],p=n[2],v=n[3],b=n[4],w=n[5],C=n[6],M=n[7],R=n[8],L=n[9],$=n[10],H=n[11],q=n[12],Y=n[13],re=n[14],de=n[15],ze=a*w-c*b,_e=a*C-p*b,G=a*M-v*b,ie=c*C-p*w,ve=c*M-v*w,He=p*M-v*C,ht=R*Y-L*q,Ye=R*re-$*q,nt=R*de-H*q,yt=L*re-$*Y,mt=L*de-H*Y,bt=$*de-H*re,at=ze*bt-_e*mt+G*yt+ie*nt-ve*Ye+He*ht;return at?(s[0]=(w*bt-C*mt+M*yt)*(at=1/at),s[1]=(p*mt-c*bt-v*yt)*at,s[2]=(Y*He-re*ve+de*ie)*at,s[3]=($*ve-L*He-H*ie)*at,s[4]=(C*nt-b*bt-M*Ye)*at,s[5]=(a*bt-p*nt+v*Ye)*at,s[6]=(re*G-q*He-de*_e)*at,s[7]=(R*He-$*G+H*_e)*at,s[8]=(b*mt-w*nt+M*ht)*at,s[9]=(c*nt-a*mt-v*ht)*at,s[10]=(q*ve-Y*G+de*ze)*at,s[11]=(L*G-R*ve-H*ze)*at,s[12]=(w*Ye-b*yt-C*ht)*at,s[13]=(a*yt-c*Ye+p*ht)*at,s[14]=(Y*_e-q*ie-re*ze)*at,s[15]=(R*ie-L*_e+$*ze)*at,s):null},m.ao=k0,m.ap=wd,m.aq=Me,m.ar=function(s){let n=1/0,a=1/0,c=-1/0,p=-1/0;for(const v of s)n=Math.min(n,v.x),a=Math.min(a,v.y),c=Math.max(c,v.x),p=Math.max(p,v.y);return[n,a,c,p]},m.as=Ki,m.at=tt,m.au=function(s,n,a,c,p=!1){if(!a[0]&&!a[1])return[0,0];const v=p?c==="map"?-s.bearingInRadians:0:c==="viewport"?s.bearingInRadians:0;if(v){const b=Math.sin(v),w=Math.cos(v);a=[a[0]*w-a[1]*b,a[0]*b+a[1]*w]}return[p?a[0]:tt(n,a[0],s.zoom),p?a[1]:tt(n,a[1],s.zoom)]},m.aw=Ig,m.ax=Fg,m.ay=kg,m.az=Og,m.b=ot,m.b$=s=>s.type==="line",m.b0=function(s,n,a){const c=new Float64Array(4);return function(p,v,b,w){var C=.5*Math.PI/180;v*=C,b*=C,w*=C;var M=Math.sin(v),R=Math.cos(v),L=Math.sin(b),$=Math.cos(b),H=Math.sin(w),q=Math.cos(w);p[0]=M*$*q-R*L*H,p[1]=R*L*q+M*$*H,p[2]=R*$*H-M*L*q,p[3]=R*$*q+M*L*H}(c,s,n-90,a),c},m.b1=function(s,n,a,c){var p,v,b,w,C,M=n[0],R=n[1],L=n[2],$=n[3],H=a[0],q=a[1],Y=a[2],re=a[3];return(v=M*H+R*q+L*Y+$*re)<0&&(v=-v,H=-H,q=-q,Y=-Y,re=-re),1-v>he?(p=Math.acos(v),b=Math.sin(p),w=Math.sin((1-c)*p)/b,C=Math.sin(c*p)/b):(w=1-c,C=c),s[0]=w*M+C*H,s[1]=w*R+C*q,s[2]=w*L+C*Y,s[3]=w*$+C*re,s},m.b2=function(s){const n=new Float64Array(9);var a,c,p,v,b,w,C,M,R,L,$,H,q,Y,re,de,ze,_e;L=(p=(c=s)[0])*(C=p+p),$=(v=c[1])*C,q=(b=c[2])*C,Y=b*(M=v+v),de=(w=c[3])*C,ze=w*M,_e=w*(R=b+b),(a=n)[0]=1-(H=v*M)-(re=b*R),a[3]=$-_e,a[6]=q+ze,a[1]=$+_e,a[4]=1-L-re,a[7]=Y-de,a[2]=q-ze,a[5]=Y+de,a[8]=1-L-H;const G=It(-Math.asin(Jt(n[2],-1,1)));let ie,ve;return Math.hypot(n[5],n[8])<.001?(ie=0,ve=-It(Math.atan2(n[3],n[4]))):(ie=It(n[5]===0&&n[8]===0?0:Math.atan2(n[5],n[8])),ve=It(n[1]===0&&n[0]===0?0:Math.atan2(n[1],n[0]))),{roll:ie,pitch:G+90,bearing:ve}},m.b3=function(s,n){return s.roll==n.roll&&s.pitch==n.pitch&&s.bearing==n.bearing},m.b4=Pn,m.b5=Ka,m.b6=Gc,m.b7=Rd,m.b8=Uc,m.b9=_t,m.bA=_n,m.bB=bn,m.bC=class extends Nr{constructor(s,n){super(s,n),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},m.bD=class extends Nr{constructor(s,n){super(s,n),this.current=zo}set(s){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let n=1;n<16;n++)if(s[n]!==this.current[n]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}},m.bE=Il,m.bF=Ml,m.bG=class extends Nr{constructor(s,n){super(s,n),this.current=[0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2]))}},m.bH=class extends Nr{constructor(s,n){super(s,n),this.current=[0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1]))}},m.bI=ye,m.bJ=function(s,n){var a=Math.sin(n),c=Math.cos(n);return s[0]=c,s[1]=a,s[2]=0,s[3]=-a,s[4]=c,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},m.bK=function(s,n,a){var c=n[0],p=n[1],v=n[2];return s[0]=c*a[0]+p*a[3]+v*a[6],s[1]=c*a[1]+p*a[4]+v*a[7],s[2]=c*a[2]+p*a[5]+v*a[8],s},m.bL=function(s,n,a,c,p,v,b){var w=1/(n-a),C=1/(c-p),M=1/(v-b);return s[0]=-2*w,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*C,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*M,s[11]=0,s[12]=(n+a)*w,s[13]=(p+c)*C,s[14]=(b+v)*M,s[15]=1,s},m.bM=class extends _d{},m.bN=G2,m.bO=class extends ps{},m.bP=cg,m.bQ=function(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))},m.bR=wv,m.bS=function(s,n,a){var c=n[0],p=n[1],v=n[2],b=a[3]*c+a[7]*p+a[11]*v+a[15];return s[0]=(a[0]*c+a[4]*p+a[8]*v+a[12])/(b=b||1),s[1]=(a[1]*c+a[5]*p+a[9]*v+a[13])/b,s[2]=(a[2]*c+a[6]*p+a[10]*v+a[14])/b,s},m.bT=class extends pd{},m.bU=class extends r{},m.bV=function(s,n){return s[0]===n[0]&&s[1]===n[1]&&s[2]===n[2]&&s[3]===n[3]&&s[4]===n[4]&&s[5]===n[5]&&s[6]===n[6]&&s[7]===n[7]&&s[8]===n[8]&&s[9]===n[9]&&s[10]===n[10]&&s[11]===n[11]&&s[12]===n[12]&&s[13]===n[13]&&s[14]===n[14]&&s[15]===n[15]},m.bW=function(s,n){var a=s[0],c=s[1],p=s[2],v=s[3],b=s[4],w=s[5],C=s[6],M=s[7],R=s[8],L=s[9],$=s[10],H=s[11],q=s[12],Y=s[13],re=s[14],de=s[15],ze=n[0],_e=n[1],G=n[2],ie=n[3],ve=n[4],He=n[5],ht=n[6],Ye=n[7],nt=n[8],yt=n[9],mt=n[10],bt=n[11],at=n[12],jt=n[13],Qt=n[14],Kt=n[15];return Math.abs(a-ze)<=he*Math.max(1,Math.abs(a),Math.abs(ze))&&Math.abs(c-_e)<=he*Math.max(1,Math.abs(c),Math.abs(_e))&&Math.abs(p-G)<=he*Math.max(1,Math.abs(p),Math.abs(G))&&Math.abs(v-ie)<=he*Math.max(1,Math.abs(v),Math.abs(ie))&&Math.abs(b-ve)<=he*Math.max(1,Math.abs(b),Math.abs(ve))&&Math.abs(w-He)<=he*Math.max(1,Math.abs(w),Math.abs(He))&&Math.abs(C-ht)<=he*Math.max(1,Math.abs(C),Math.abs(ht))&&Math.abs(M-Ye)<=he*Math.max(1,Math.abs(M),Math.abs(Ye))&&Math.abs(R-nt)<=he*Math.max(1,Math.abs(R),Math.abs(nt))&&Math.abs(L-yt)<=he*Math.max(1,Math.abs(L),Math.abs(yt))&&Math.abs($-mt)<=he*Math.max(1,Math.abs($),Math.abs(mt))&&Math.abs(H-bt)<=he*Math.max(1,Math.abs(H),Math.abs(bt))&&Math.abs(q-at)<=he*Math.max(1,Math.abs(q),Math.abs(at))&&Math.abs(Y-jt)<=he*Math.max(1,Math.abs(Y),Math.abs(jt))&&Math.abs(re-Qt)<=he*Math.max(1,Math.abs(re),Math.abs(Qt))&&Math.abs(de-Kt)<=he*Math.max(1,Math.abs(de),Math.abs(Kt))},m.bX=function(s,n){return s[0]=n[0],s[1]=n[1],s[2]=n[2],s[3]=n[3],s[4]=n[4],s[5]=n[5],s[6]=n[6],s[7]=n[7],s[8]=n[8],s[9]=n[9],s[10]=n[10],s[11]=n[11],s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15],s},m.bY=s=>s.type==="symbol",m.bZ=s=>s.type==="circle",m.b_=s=>s.type==="heatmap",m.ba=Qe,m.bb=_r,m.bc=function(s,n,a,c,p){return _t(c,p,Jt((s-n)/(a-n),0,1))},m.bd=Et,m.be=function(){return new Float64Array(4)},m.bf=function(){return new Float64Array(3)},m.bg=function(s,n,a,c){var p=[],v=[];return p[0]=n[0]-a[0],p[1]=n[1]-a[1],p[2]=n[2]-a[2],v[0]=p[0]*Math.cos(c)-p[1]*Math.sin(c),v[1]=p[0]*Math.sin(c)+p[1]*Math.cos(c),v[2]=p[2],s[0]=v[0]+a[0],s[1]=v[1]+a[1],s[2]=v[2]+a[2],s},m.bh=function(s,n,a,c){var p=[],v=[];return p[0]=n[0]-a[0],p[1]=n[1]-a[1],p[2]=n[2]-a[2],v[0]=p[0],v[1]=p[1]*Math.cos(c)-p[2]*Math.sin(c),v[2]=p[1]*Math.sin(c)+p[2]*Math.cos(c),s[0]=v[0]+a[0],s[1]=v[1]+a[1],s[2]=v[2]+a[2],s},m.bi=function(s,n,a,c){var p=[],v=[];return p[0]=n[0]-a[0],p[1]=n[1]-a[1],p[2]=n[2]-a[2],v[0]=p[2]*Math.sin(c)+p[0]*Math.cos(c),v[1]=p[1],v[2]=p[2]*Math.cos(c)-p[0]*Math.sin(c),s[0]=v[0]+a[0],s[1]=v[1]+a[1],s[2]=v[2]+a[2],s},m.bj=function(s,n,a){var c=Math.sin(a),p=Math.cos(a),v=n[0],b=n[1],w=n[2],C=n[3],M=n[8],R=n[9],L=n[10],$=n[11];return n!==s&&(s[4]=n[4],s[5]=n[5],s[6]=n[6],s[7]=n[7],s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15]),s[0]=v*p-M*c,s[1]=b*p-R*c,s[2]=w*p-L*c,s[3]=C*p-$*c,s[8]=v*c+M*p,s[9]=b*c+R*p,s[10]=w*c+L*p,s[11]=C*c+$*p,s},m.bk=function(s,n){const a=Et(s,360),c=Et(n,360),p=c-a,v=c>a?p-360:p+360;return Math.abs(p)<Math.abs(v)?p:v},m.bl=function(s){return s[0]=0,s[1]=0,s[2]=0,s},m.bm=function(s,n,a,c){const p=Math.sqrt(s*s+n*n),v=Math.sqrt(a*a+c*c);s/=p,n/=p,a/=v,c/=v;const b=Math.acos(s*a+n*c);return-n*a+s*c>0?b:-b},m.bn=function(s,n){return s[0]*n[0]+s[1]*n[1]+s[2]*n[2]+s[3]},m.bo=Dg,m.bp=function(s,n){const a=Et(s,2*Math.PI),c=Et(n,2*Math.PI);return Math.min(Math.abs(a-c),Math.abs(a-c+2*Math.PI),Math.abs(a-c-2*Math.PI))},m.bq=function(s){return Math.hypot(s[0],s[1],s[2])},m.br=function(){const s={},n=ae.$version;for(const a in ae.$root){const c=ae.$root[a];if(c.required){let p=null;p=a==="version"?n:c.type==="array"?[]:{},p!=null&&(s[a]=p)}}return s},m.bs=Mf,m.bt=Sn,m.bu=function(s){s=s.slice();const n=Object.create(null);for(let a=0;a<s.length;a++)n[s[a].id]=s[a];for(let a=0;a<s.length;a++)"ref"in s[a]&&(s[a]=Q(s[a],n[s[a].ref]));return s},m.bv=function(s){if(s.type==="custom")return new fT(s);switch(s.type){case"background":return new uT(s);case"circle":return new a2(s);case"fill":return new C2(s);case"fill-extrusion":return new R2(s);case"heatmap":return new o2(s);case"hillshade":return new c2(s);case"line":return new N2(s);case"raster":return new hT(s);case"symbol":return new ep(s)}},m.bw=jn,m.bx=function(s,n){if(!s)return[{command:"setStyle",args:[n]}];let a=[];try{if(!te(s.version,n.version))return[{command:"setStyle",args:[n]}];te(s.center,n.center)||a.push({command:"setCenter",args:[n.center]}),te(s.centerAltitude,n.centerAltitude)||a.push({command:"setCenterAltitude",args:[n.centerAltitude]}),te(s.zoom,n.zoom)||a.push({command:"setZoom",args:[n.zoom]}),te(s.bearing,n.bearing)||a.push({command:"setBearing",args:[n.bearing]}),te(s.pitch,n.pitch)||a.push({command:"setPitch",args:[n.pitch]}),te(s.roll,n.roll)||a.push({command:"setRoll",args:[n.roll]}),te(s.sprite,n.sprite)||a.push({command:"setSprite",args:[n.sprite]}),te(s.glyphs,n.glyphs)||a.push({command:"setGlyphs",args:[n.glyphs]}),te(s.transition,n.transition)||a.push({command:"setTransition",args:[n.transition]}),te(s.light,n.light)||a.push({command:"setLight",args:[n.light]}),te(s.terrain,n.terrain)||a.push({command:"setTerrain",args:[n.terrain]}),te(s.sky,n.sky)||a.push({command:"setSky",args:[n.sky]}),te(s.projection,n.projection)||a.push({command:"setProjection",args:[n.projection]});const c={},p=[];(function(b,w,C,M){let R;for(R in w=w||{},b=b||{})Object.prototype.hasOwnProperty.call(b,R)&&(Object.prototype.hasOwnProperty.call(w,R)||$e(R,C,M));for(R in w)Object.prototype.hasOwnProperty.call(w,R)&&(Object.prototype.hasOwnProperty.call(b,R)?te(b[R],w[R])||(b[R].type==="geojson"&&w[R].type==="geojson"&&Ve(b,w,R)?ge(C,{command:"setGeoJSONSourceData",args:[R,w[R].data]}):qe(R,w,C,M)):Ae(R,w,C))})(s.sources,n.sources,p,c);const v=[];s.layers&&s.layers.forEach(b=>{"source"in b&&c[b.source]?a.push({command:"removeLayer",args:[b.id]}):v.push(b)}),a=a.concat(p),function(b,w,C){w=w||[];const M=(b=b||[]).map(Je),R=w.map(Je),L=b.reduce(Ue,{}),$=w.reduce(Ue,{}),H=M.slice(),q=Object.create(null);let Y,re,de,ze,_e;for(let G=0,ie=0;G<M.length;G++)Y=M[G],Object.prototype.hasOwnProperty.call($,Y)?ie++:(ge(C,{command:"removeLayer",args:[Y]}),H.splice(H.indexOf(Y,ie),1));for(let G=0,ie=0;G<R.length;G++)Y=R[R.length-1-G],H[H.length-1-G]!==Y&&(Object.prototype.hasOwnProperty.call(L,Y)?(ge(C,{command:"removeLayer",args:[Y]}),H.splice(H.lastIndexOf(Y,H.length-ie),1)):ie++,ze=H[H.length-G],ge(C,{command:"addLayer",args:[$[Y],ze]}),H.splice(H.length-G,0,Y),q[Y]=!0);for(let G=0;G<R.length;G++)if(Y=R[G],re=L[Y],de=$[Y],!q[Y]&&!te(re,de))if(te(re.source,de.source)&&te(re["source-layer"],de["source-layer"])&&te(re.type,de.type)){for(_e in it(re.layout,de.layout,C,Y,null,"setLayoutProperty"),it(re.paint,de.paint,C,Y,null,"setPaintProperty"),te(re.filter,de.filter)||ge(C,{command:"setFilter",args:[Y,de.filter]}),te(re.minzoom,de.minzoom)&&te(re.maxzoom,de.maxzoom)||ge(C,{command:"setLayerZoomRange",args:[Y,de.minzoom,de.maxzoom]}),re)Object.prototype.hasOwnProperty.call(re,_e)&&_e!=="layout"&&_e!=="paint"&&_e!=="filter"&&_e!=="metadata"&&_e!=="minzoom"&&_e!=="maxzoom"&&(_e.indexOf("paint.")===0?it(re[_e],de[_e],C,Y,_e.slice(6),"setPaintProperty"):te(re[_e],de[_e])||ge(C,{command:"setLayerProperty",args:[Y,_e,de[_e]]}));for(_e in de)Object.prototype.hasOwnProperty.call(de,_e)&&!Object.prototype.hasOwnProperty.call(re,_e)&&_e!=="layout"&&_e!=="paint"&&_e!=="filter"&&_e!=="metadata"&&_e!=="minzoom"&&_e!=="maxzoom"&&(_e.indexOf("paint.")===0?it(re[_e],de[_e],C,Y,_e.slice(6),"setPaintProperty"):te(re[_e],de[_e])||ge(C,{command:"setLayerProperty",args:[Y,_e,de[_e]]}))}else ge(C,{command:"removeLayer",args:[Y]}),ze=H[H.lastIndexOf(Y)+1],ge(C,{command:"addLayer",args:[de,ze]})}(v,n.layers,a)}catch(c){console.warn("Unable to compute style diff:",c),a=[{command:"setStyle",args:[n]}]}return a},m.by=function(s){const n=[],a=s.id;return a===void 0&&n.push({message:`layers.${a}: missing required property "id"`}),s.render===void 0&&n.push({message:`layers.${a}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&n.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),n},m.bz=function s(n,a){if(Array.isArray(n)){if(!Array.isArray(a)||n.length!==a.length)return!1;for(let c=0;c<n.length;c++)if(!s(n[c],a[c]))return!1;return!0}if(typeof n=="object"&&n!==null&&a!==null){if(typeof a!="object"||Object.keys(n).length!==Object.keys(a).length)return!1;for(const c in n)if(!s(n[c],a[c]))return!1;return!0}return n===a},m.c=wt,m.c0=s=>s.type==="fill",m.c1=s=>s.type==="fill-extrusion",m.c2=s=>s.type==="hillshade",m.c3=s=>s.type==="raster",m.c4=s=>s.type==="background",m.c5=s=>s.type==="custom",m.c6=ct,m.c7=function(s,n,a){const c=dt(n.x-a.x,n.y-a.y),p=dt(s.x-a.x,s.y-a.y);var v,b;return It(Math.atan2(c[0]*p[1]-c[1]*p[0],(v=c)[0]*(b=p)[0]+v[1]*b[1]))},m.c8=zt,m.c9=function(s,n,a){var c=n[0],p=n[1];return s[0]=a[0]*c+a[4]*p+a[12],s[1]=a[1]*c+a[5]*p+a[13],s},m.cA=Yv,m.cB=xc,m.cC=qa,m.ca=function(s,n){const{x:a,y:c}=Nd.fromLngLat(n);return!(s<0||s>25||c<0||c>=1||a<0||a>=1)},m.cb=function(s,n){return s[0]=n[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=n[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=n[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},m.cc=class extends Cl{},m.cd=ST,m.cf=function(s){return s.message===Rt},m.cg=dn,m.ch=function(s,n){tn.REGISTERED_PROTOCOLS[s]=n},m.ci=function(s){delete tn.REGISTERED_PROTOCOLS[s]},m.cj=function(s,n){const a={};for(let p=0;p<s.length;p++){const v=n&&n[s[p].id]||rd(s[p]);n&&(n[s[p].id]=v);let b=a[v];b||(b=a[v]=[]),b.push(s[p])}const c=[];for(const p in a)c.push(a[p]);return c},m.ck=Ft,m.cl=w0,m.cm=C0,m.cn=Qv,m.co=function(s){s.bucket.createArrays(),s.bucket.tilePixelRatio=je/(512*s.bucket.overscaling),s.bucket.compareText={},s.bucket.iconsNeedLinear=!1;const n=s.bucket.layers[0],a=n.layout,c=n._unevaluatedLayout._values,p={layoutIconSize:c["icon-size"].possiblyEvaluate(new mi(s.bucket.zoom+1),s.canonical),layoutTextSize:c["text-size"].possiblyEvaluate(new mi(s.bucket.zoom+1),s.canonical),textMaxSize:c["text-size"].possiblyEvaluate(new mi(18))};if(s.bucket.textSizeData.kind==="composite"){const{minZoom:M,maxZoom:R}=s.bucket.textSizeData;p.compositeTextSizes=[c["text-size"].possiblyEvaluate(new mi(M),s.canonical),c["text-size"].possiblyEvaluate(new mi(R),s.canonical)]}if(s.bucket.iconSizeData.kind==="composite"){const{minZoom:M,maxZoom:R}=s.bucket.iconSizeData;p.compositeIconSizes=[c["icon-size"].possiblyEvaluate(new mi(M),s.canonical),c["icon-size"].possiblyEvaluate(new mi(R),s.canonical)]}const v=a.get("text-line-height")*Ki,b=a.get("text-rotation-alignment")!=="viewport"&&a.get("symbol-placement")!=="point",w=a.get("text-keep-upright"),C=a.get("text-size");for(const M of s.bucket.features){const R=a.get("text-font").evaluate(M,{},s.canonical).join(","),L=C.evaluate(M,{},s.canonical),$=p.layoutTextSize.evaluate(M,{},s.canonical),H=p.layoutIconSize.evaluate(M,{},s.canonical),q={horizontal:{},vertical:void 0},Y=M.text;let re,de=[0,0];if(Y){const G=Y.toString(),ie=a.get("text-letter-spacing").evaluate(M,{},s.canonical)*Ki,ve=Ef(G)?ie:0,He=a.get("text-anchor").evaluate(M,{},s.canonical),ht=B0(n,M,s.canonical);if(!ht){const mt=a.get("text-radial-offset").evaluate(M,{},s.canonical);de=mt?L0(He,[mt*Ki,Bg]):a.get("text-offset").evaluate(M,{},s.canonical).map(bt=>bt*Ki)}let Ye=b?"center":a.get("text-justify").evaluate(M,{},s.canonical);const nt=a.get("symbol-placement")==="point"?a.get("text-max-width").evaluate(M,{},s.canonical)*Ki:1/0,yt=()=>{s.bucket.allowVerticalPlacement&&Eo(G)&&(q.vertical=Yf(Y,s.glyphMap,s.glyphPositions,s.imagePositions,R,nt,v,He,"left",ve,de,m.ai.vertical,!0,$,L))};if(!b&&ht){const mt=new Set;if(Ye==="auto")for(let at=0;at<ht.values.length;at+=2)mt.add(Fg(ht.values[at]));else mt.add(Ye);let bt=!1;for(const at of mt)if(!q.horizontal[at])if(bt)q.horizontal[at]=q.horizontal[0];else{const jt=Yf(Y,s.glyphMap,s.glyphPositions,s.imagePositions,R,nt,v,"center",at,ve,de,m.ai.horizontal,!1,$,L);jt&&(q.horizontal[at]=jt,bt=jt.positionedLines.length===1)}yt()}else{Ye==="auto"&&(Ye=Fg(He));const mt=Yf(Y,s.glyphMap,s.glyphPositions,s.imagePositions,R,nt,v,He,Ye,ve,de,m.ai.horizontal,!1,$,L);mt&&(q.horizontal[Ye]=mt),yt(),Eo(G)&&b&&w&&(q.vertical=Yf(Y,s.glyphMap,s.glyphPositions,s.imagePositions,R,nt,v,He,Ye,ve,de,m.ai.vertical,!1,$,L))}}let ze=!1;if(M.icon&&M.icon.name){const G=s.imageMap[M.icon.name];G&&(re=aT(s.imagePositions[M.icon.name],a.get("icon-offset").evaluate(M,{},s.canonical),a.get("icon-anchor").evaluate(M,{},s.canonical)),ze=!!G.sdf,s.bucket.sdfIcons===void 0?s.bucket.sdfIcons=ze:s.bucket.sdfIcons!==ze&&si("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(G.pixelRatio!==s.bucket.pixelRatio||a.get("icon-rotate").constantOr(1)!==0)&&(s.bucket.iconsNeedLinear=!0))}const _e=O0(q.horizontal)||q.vertical;s.bucket.iconsInText=!!_e&&_e.iconsInText,(_e||re)&&xT(s.bucket,M,q,re,s.imageMap,p,$,H,de,ze,s.canonical,s.subdivisionGranularity)}s.showCollisionBoxes&&s.bucket.generateCollisionDebugBuffers()},m.cp=bg,m.cq=pg,m.cr=vg,m.cs=zd,m.ct=Sg,m.cu=class{constructor(s){this._marks={start:[s.url,"start"].join("#"),end:[s.url,"end"].join("#"),measure:s.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let s=performance.getEntriesByName(this._marks.measure);return s.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),s=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),s}},m.cv=function(s,n,a,c,p){return o(this,void 0,void 0,function*(){if(me())try{return yield gt(s,n,a,c,p)}catch{}return function(v,b,w,C,M){const R=v.width,L=v.height;vt&&Bt||(vt=new OffscreenCanvas(R,L),Bt=vt.getContext("2d",{willReadFrequently:!0})),vt.width=R,vt.height=L,Bt.drawImage(v,0,0,R,L);const $=Bt.getImageData(b,w,C,M);return Bt.clearRect(0,0,R,L),$.data}(s,n,a,c,p)})},m.cw=x0,m.cx=T,m.cy=z,m.cz=Vv,m.d=s=>o(void 0,void 0,void 0,function*(){if(s.byteLength===0)return createImageBitmap(new ImageData(1,1));const n=new Blob([new Uint8Array(s)],{type:"image/png"});try{return createImageBitmap(n)}catch(a){throw new Error(`Could not load image because of ${a.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),m.e=Yt,m.f=s=>new Promise((n,a)=>{const c=new Image;c.onload=()=>{n(c),URL.revokeObjectURL(c.src),c.onload=null,window.requestAnimationFrame(()=>{c.src=xt})},c.onerror=()=>a(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const p=new Blob([new Uint8Array(s)],{type:"image/png"});c.src=s.byteLength?URL.createObjectURL(p):xt}),m.g=$t,m.h=(s,n)=>Dn(Yt(s,{type:"json"}),n),m.i=Pe,m.j=Zi,m.k=tr,m.l=(s,n)=>Dn(Yt(s,{type:"arrayBuffer"}),n),m.m=Dn,m.n=function(s){return new Sg(s).readFields(q2,[])},m.o=kd,m.p=Jv,m.q=Ar,m.r=ng,m.s=An,m.t=Pf,m.u=Mo,m.v=ae,m.w=si,m.x=function([s,n,a]){return n+=90,n*=Math.PI/180,a*=Math.PI/180,{x:s*Math.cos(n)*Math.sin(a),y:s*Math.sin(n)*Math.sin(a),z:s*Math.cos(a)}},m.y=fa,m.z=mi}),f("worker",["./shared"],function(m){class o{constructor(W){this.keyCache={},W&&this.replace(W)}replace(W){this._layerConfigs={},this._layers={},this.update(W,[])}update(W,Q){for(const ge of W){this._layerConfigs[ge.id]=ge;const Ae=this._layers[ge.id]=m.bv(ge);Ae._featureFilter=m.a4(Ae.filter),this.keyCache[ge.id]&&delete this.keyCache[ge.id]}for(const ge of Q)delete this.keyCache[ge],delete this._layerConfigs[ge],delete this._layers[ge];this.familiesBySource={};const te=m.cj(Object.values(this._layerConfigs),this.keyCache);for(const ge of te){const Ae=ge.map(Ue=>this._layers[Ue.id]),$e=Ae[0];if($e.visibility==="none")continue;const qe=$e.source||"";let Ve=this.familiesBySource[qe];Ve||(Ve=this.familiesBySource[qe]={});const it=$e.sourceLayer||"_geojsonTileLayer";let Je=Ve[it];Je||(Je=Ve[it]=[]),Je.push(Ae)}}}class T{constructor(W){const Q={},te=[];for(const qe in W){const Ve=W[qe],it=Q[qe]={};for(const Je in Ve){const Ue=Ve[+Je];if(!Ue||Ue.bitmap.width===0||Ue.bitmap.height===0)continue;const Be={x:0,y:0,w:Ue.bitmap.width+2,h:Ue.bitmap.height+2};te.push(Be),it[Je]={rect:Be,metrics:Ue.metrics}}}const{w:ge,h:Ae}=m.p(te),$e=new m.o({width:ge||1,height:Ae||1});for(const qe in W){const Ve=W[qe];for(const it in Ve){const Je=Ve[+it];if(!Je||Je.bitmap.width===0||Je.bitmap.height===0)continue;const Ue=Q[qe][it].rect;m.o.copy(Je.bitmap,$e,{x:0,y:0},{x:Ue.x+1,y:Ue.y+1},Je.bitmap)}}this.image=$e,this.positions=Q}}m.ck("GlyphAtlas",T);class k{constructor(W){this.tileID=new m.S(W.tileID.overscaledZ,W.tileID.wrap,W.tileID.canonical.z,W.tileID.canonical.x,W.tileID.canonical.y),this.uid=W.uid,this.zoom=W.zoom,this.pixelRatio=W.pixelRatio,this.tileSize=W.tileSize,this.source=W.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=W.showCollisionBoxes,this.collectResourceTiming=!!W.collectResourceTiming,this.returnDependencies=!!W.returnDependencies,this.promoteId=W.promoteId,this.inFlightDependencies=[]}parse(W,Q,te,ge,Ae){return m._(this,void 0,void 0,function*(){this.status="parsing",this.data=W,this.collisionBoxArray=new m.a2;const $e=new m.cl(Object.keys(W.layers).sort()),qe=new m.cm(this.tileID,this.promoteId);qe.bucketLayerIDs=[];const Ve={},it={featureIndex:qe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:te,subdivisionGranularity:Ae},Je=Q.familiesBySource[this.source];for(const cn in Je){const Vt=W.layers[cn];if(!Vt)continue;Vt.version===1&&m.w(`Vector tile source "${this.source}" layer "${cn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ii=$e.encode(cn),cs=[];for(let qi=0;qi<Vt.length;qi++){const Vi=Vt.feature(qi),hi=qe.getId(Vi,cn);cs.push({feature:Vi,id:hi,index:qi,sourceLayerIndex:Ii})}for(const qi of Je[cn]){const Vi=qi[0];Vi.source!==this.source&&m.w(`layer.source = ${Vi.source} does not equal this.source = ${this.source}`),Vi.minzoom&&this.zoom<Math.floor(Vi.minzoom)||Vi.maxzoom&&this.zoom>=Vi.maxzoom||Vi.visibility!=="none"&&(I(qi,this.zoom,te),(Ve[Vi.id]=Vi.createBucket({index:qe.bucketLayerIDs.length,layers:qi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ii,sourceID:this.source})).populate(cs,it,this.tileID.canonical),qe.bucketLayerIDs.push(qi.map(hi=>hi.id)))}}const Ue=m.bA(it.glyphDependencies,cn=>Object.keys(cn).map(Number));this.inFlightDependencies.forEach(cn=>cn==null?void 0:cn.abort()),this.inFlightDependencies=[];let Be=Promise.resolve({});if(Object.keys(Ue).length){const cn=new AbortController;this.inFlightDependencies.push(cn),Be=ge.sendAsync({type:"GG",data:{stacks:Ue,source:this.source,tileID:this.tileID,type:"glyphs"}},cn)}const kt=Object.keys(it.iconDependencies);let Tt=Promise.resolve({});if(kt.length){const cn=new AbortController;this.inFlightDependencies.push(cn),Tt=ge.sendAsync({type:"GI",data:{icons:kt,source:this.source,tileID:this.tileID,type:"icons"}},cn)}const nn=Object.keys(it.patternDependencies);let pn=Promise.resolve({});if(nn.length){const cn=new AbortController;this.inFlightDependencies.push(cn),pn=ge.sendAsync({type:"GI",data:{icons:nn,source:this.source,tileID:this.tileID,type:"patterns"}},cn)}const[st,At,Ut]=yield Promise.all([Be,Tt,pn]),Cn=new T(st),zn=new m.cn(At,Ut);for(const cn in Ve){const Vt=Ve[cn];Vt instanceof m.a3?(I(Vt.layers,this.zoom,te),m.co({bucket:Vt,glyphMap:st,glyphPositions:Cn.positions,imageMap:At,imagePositions:zn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:it.subdivisionGranularity})):Vt.hasPattern&&(Vt instanceof m.cp||Vt instanceof m.cq||Vt instanceof m.cr)&&(I(Vt.layers,this.zoom,te),Vt.addFeatures(it,this.tileID.canonical,zn.patternPositions))}return this.status="done",{buckets:Object.values(Ve).filter(cn=>!cn.isEmpty()),featureIndex:qe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Cn.image,imageAtlas:zn,glyphMap:this.returnDependencies?st:null,iconMap:this.returnDependencies?At:null,glyphPositions:this.returnDependencies?Cn.positions:null}})}}function I(ae,W,Q){const te=new m.z(W);for(const ge of ae)ge.recalculate(te,Q)}class z{constructor(W,Q,te){this.actor=W,this.layerIndex=Q,this.availableImages=te,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(W,Q){return m._(this,void 0,void 0,function*(){const te=yield m.l(W.request,Q);try{return{vectorTile:new m.cs.VectorTile(new m.ct(te.data)),rawData:te.data,cacheControl:te.cacheControl,expires:te.expires}}catch(ge){const Ae=new Uint8Array(te.data);let $e=`Unable to parse the tile at ${W.request.url}, `;throw $e+=Ae[0]===31&&Ae[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ge.message}`,new Error($e)}})}loadTile(W){return m._(this,void 0,void 0,function*(){const Q=W.uid,te=!!(W&&W.request&&W.request.collectResourceTiming)&&new m.cu(W.request),ge=new k(W);this.loading[Q]=ge;const Ae=new AbortController;ge.abort=Ae;try{const $e=yield this.loadVectorTile(W,Ae);if(delete this.loading[Q],!$e)return null;const qe=$e.rawData,Ve={};$e.expires&&(Ve.expires=$e.expires),$e.cacheControl&&(Ve.cacheControl=$e.cacheControl);const it={};if(te){const Ue=te.finish();Ue&&(it.resourceTiming=JSON.parse(JSON.stringify(Ue)))}ge.vectorTile=$e.vectorTile;const Je=ge.parse($e.vectorTile,this.layerIndex,this.availableImages,this.actor,W.subdivisionGranularity);this.loaded[Q]=ge,this.fetching[Q]={rawTileData:qe,cacheControl:Ve,resourceTiming:it};try{const Ue=yield Je;return m.e({rawTileData:qe.slice(0)},Ue,Ve,it)}finally{delete this.fetching[Q]}}catch($e){throw delete this.loading[Q],ge.status="done",this.loaded[Q]=ge,$e}})}reloadTile(W){return m._(this,void 0,void 0,function*(){const Q=W.uid;if(!this.loaded||!this.loaded[Q])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const te=this.loaded[Q];if(te.showCollisionBoxes=W.showCollisionBoxes,te.status==="parsing"){const ge=yield te.parse(te.vectorTile,this.layerIndex,this.availableImages,this.actor,W.subdivisionGranularity);let Ae;if(this.fetching[Q]){const{rawTileData:$e,cacheControl:qe,resourceTiming:Ve}=this.fetching[Q];delete this.fetching[Q],Ae=m.e({rawTileData:$e.slice(0)},ge,qe,Ve)}else Ae=ge;return Ae}if(te.status==="done"&&te.vectorTile)return te.parse(te.vectorTile,this.layerIndex,this.availableImages,this.actor,W.subdivisionGranularity)})}abortTile(W){return m._(this,void 0,void 0,function*(){const Q=this.loading,te=W.uid;Q&&Q[te]&&Q[te].abort&&(Q[te].abort.abort(),delete Q[te])})}removeTile(W){return m._(this,void 0,void 0,function*(){this.loaded&&this.loaded[W.uid]&&delete this.loaded[W.uid]})}}class O{constructor(){this.loaded={}}loadTile(W){return m._(this,void 0,void 0,function*(){const{uid:Q,encoding:te,rawImageData:ge,redFactor:Ae,greenFactor:$e,blueFactor:qe,baseShift:Ve}=W,it=ge.width+2,Je=ge.height+2,Ue=m.b(ge)?new m.R({width:it,height:Je},yield m.cv(ge,-1,-1,it,Je)):ge,Be=new m.cw(Q,Ue,te,Ae,$e,qe,Ve);return this.loaded=this.loaded||{},this.loaded[Q]=Be,Be})}removeTile(W){const Q=this.loaded,te=W.uid;Q&&Q[te]&&delete Q[te]}}var D,B,V=function(){if(B)return D;function ae(Q,te){if(Q.length!==0){W(Q[0],te);for(var ge=1;ge<Q.length;ge++)W(Q[ge],!te)}}function W(Q,te){for(var ge=0,Ae=0,$e=0,qe=Q.length,Ve=qe-1;$e<qe;Ve=$e++){var it=(Q[$e][0]-Q[Ve][0])*(Q[Ve][1]+Q[$e][1]),Je=ge+it;Ae+=Math.abs(ge)>=Math.abs(it)?ge-Je+it:it-Je+ge,ge=Je}ge+Ae>=0!=!!te&&Q.reverse()}return B=1,D=function Q(te,ge){var Ae,$e=te&&te.type;if($e==="FeatureCollection")for(Ae=0;Ae<te.features.length;Ae++)Q(te.features[Ae],ge);else if($e==="GeometryCollection")for(Ae=0;Ae<te.geometries.length;Ae++)Q(te.geometries[Ae],ge);else if($e==="Feature")Q(te.geometry,ge);else if($e==="Polygon")ae(te.coordinates,ge);else if($e==="MultiPolygon")for(Ae=0;Ae<te.coordinates.length;Ae++)ae(te.coordinates[Ae],ge);return te}}(),Z=m.cx(V);const oe=m.cs.VectorTileFeature.prototype.toGeoJSON;class pe{constructor(W){this._feature=W,this.extent=m.X,this.type=W.type,this.properties=W.tags,"id"in W&&!isNaN(W.id)&&(this.id=parseInt(W.id,10))}loadGeometry(){if(this._feature.type===1){const W=[];for(const Q of this._feature.geometry)W.push([new m.P(Q[0],Q[1])]);return W}{const W=[];for(const Q of this._feature.geometry){const te=[];for(const ge of Q)te.push(new m.P(ge[0],ge[1]));W.push(te)}return W}}toGeoJSON(W,Q,te){return oe.call(this,W,Q,te)}}class Se{constructor(W){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=m.X,this.length=W.length,this._features=W}feature(W){return new pe(this._features[W])}}var me,be,he,Ce={exports:{}},ye=function(){if(he)return Ce.exports;he=1;var ae=m.cA(),W=function(){if(be)return me;be=1;var Je=m.cy(),Ue=m.cz().VectorTileFeature;function Be(Tt,nn){this.options=nn||{},this.features=Tt,this.length=Tt.length}function kt(Tt,nn){this.id=typeof Tt.id=="number"?Tt.id:void 0,this.type=Tt.type,this.rawGeometry=Tt.type===1?[Tt.geometry]:Tt.geometry,this.properties=Tt.tags,this.extent=nn||4096}return me=Be,Be.prototype.feature=function(Tt){return new kt(this.features[Tt],this.options.extent)},kt.prototype.loadGeometry=function(){var Tt=this.rawGeometry;this.geometry=[];for(var nn=0;nn<Tt.length;nn++){for(var pn=Tt[nn],st=[],At=0;At<pn.length;At++)st.push(new Je(pn[At][0],pn[At][1]));this.geometry.push(st)}return this.geometry},kt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Tt=this.geometry,nn=1/0,pn=-1/0,st=1/0,At=-1/0,Ut=0;Ut<Tt.length;Ut++)for(var Cn=Tt[Ut],zn=0;zn<Cn.length;zn++){var cn=Cn[zn];nn=Math.min(nn,cn.x),pn=Math.max(pn,cn.x),st=Math.min(st,cn.y),At=Math.max(At,cn.y)}return[nn,st,pn,At]},kt.prototype.toGeoJSON=Ue.prototype.toGeoJSON,me}();function Q(Je){var Ue=new ae;return function(Be,kt){for(var Tt in Be.layers)kt.writeMessage(3,te,Be.layers[Tt])}(Je,Ue),Ue.finish()}function te(Je,Ue){var Be;Ue.writeVarintField(15,Je.version||1),Ue.writeStringField(1,Je.name||""),Ue.writeVarintField(5,Je.extent||4096);var kt={keys:[],values:[],keycache:{},valuecache:{}};for(Be=0;Be<Je.length;Be++)kt.feature=Je.feature(Be),Ue.writeMessage(2,ge,kt);var Tt=kt.keys;for(Be=0;Be<Tt.length;Be++)Ue.writeStringField(3,Tt[Be]);var nn=kt.values;for(Be=0;Be<nn.length;Be++)Ue.writeMessage(4,it,nn[Be])}function ge(Je,Ue){var Be=Je.feature;Be.id!==void 0&&Ue.writeVarintField(1,Be.id),Ue.writeMessage(2,Ae,Je),Ue.writeVarintField(3,Be.type),Ue.writeMessage(4,Ve,Be)}function Ae(Je,Ue){var Be=Je.feature,kt=Je.keys,Tt=Je.values,nn=Je.keycache,pn=Je.valuecache;for(var st in Be.properties){var At=Be.properties[st],Ut=nn[st];if(At!==null){Ut===void 0&&(kt.push(st),nn[st]=Ut=kt.length-1),Ue.writeVarint(Ut);var Cn=typeof At;Cn!=="string"&&Cn!=="boolean"&&Cn!=="number"&&(At=JSON.stringify(At));var zn=Cn+":"+At,cn=pn[zn];cn===void 0&&(Tt.push(At),pn[zn]=cn=Tt.length-1),Ue.writeVarint(cn)}}}function $e(Je,Ue){return(Ue<<3)+(7&Je)}function qe(Je){return Je<<1^Je>>31}function Ve(Je,Ue){for(var Be=Je.loadGeometry(),kt=Je.type,Tt=0,nn=0,pn=Be.length,st=0;st<pn;st++){var At=Be[st],Ut=1;kt===1&&(Ut=At.length),Ue.writeVarint($e(1,Ut));for(var Cn=kt===3?At.length-1:At.length,zn=0;zn<Cn;zn++){zn===1&&kt!==1&&Ue.writeVarint($e(2,Cn-1));var cn=At[zn].x-Tt,Vt=At[zn].y-nn;Ue.writeVarint(qe(cn)),Ue.writeVarint(qe(Vt)),Tt+=cn,nn+=Vt}kt===3&&Ue.writeVarint($e(7,1))}}function it(Je,Ue){var Be=typeof Je;Be==="string"?Ue.writeStringField(1,Je):Be==="boolean"?Ue.writeBooleanField(7,Je):Be==="number"&&(Je%1!=0?Ue.writeDoubleField(3,Je):Je<0?Ue.writeSVarintField(6,Je):Ue.writeVarintField(5,Je))}return Ce.exports=Q,Ce.exports.fromVectorTileJs=Q,Ce.exports.fromGeojsonVt=function(Je,Ue){Ue=Ue||{};var Be={};for(var kt in Je)Be[kt]=new W(Je[kt].features,Ue),Be[kt].name=kt,Be[kt].version=Ue.version,Be[kt].extent=Ue.extent;return Q({layers:Be})},Ce.exports.GeoJSONWrapper=W,Ce.exports}(),Me=m.cx(ye);const ke={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ae=>ae},Ee=Math.fround||(xe=new Float32Array(1),ae=>(xe[0]=+ae,xe[0]));var xe;const Oe=3,We=5,dt=6;class je{constructor(W){this.options=Object.assign(Object.create(ke),W),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(W){const{log:Q,minZoom:te,maxZoom:ge}=this.options;Q&&console.time("total time");const Ae=`prepare ${W.length} points`;Q&&console.time(Ae),this.points=W;const $e=[];for(let Ve=0;Ve<W.length;Ve++){const it=W[Ve];if(!it.geometry)continue;const[Je,Ue]=it.geometry.coordinates,Be=Ee(_t(Je)),kt=Ee(Qe(Ue));$e.push(Be,kt,1/0,Ve,-1,1),this.options.reduce&&$e.push(0)}let qe=this.trees[ge+1]=this._createTree($e);Q&&console.timeEnd(Ae);for(let Ve=ge;Ve>=te;Ve--){const it=+Date.now();qe=this.trees[Ve]=this._createTree(this._cluster(qe,Ve)),Q&&console.log("z%d: %d clusters in %dms",Ve,qe.numItems,+Date.now()-it)}return Q&&console.timeEnd("total time"),this}getClusters(W,Q){let te=((W[0]+180)%360+360)%360-180;const ge=Math.max(-90,Math.min(90,W[1]));let Ae=W[2]===180?180:((W[2]+180)%360+360)%360-180;const $e=Math.max(-90,Math.min(90,W[3]));if(W[2]-W[0]>=360)te=-180,Ae=180;else if(te>Ae){const Ue=this.getClusters([te,ge,180,$e],Q),Be=this.getClusters([-180,ge,Ae,$e],Q);return Ue.concat(Be)}const qe=this.trees[this._limitZoom(Q)],Ve=qe.range(_t(te),Qe($e),_t(Ae),Qe(ge)),it=qe.data,Je=[];for(const Ue of Ve){const Be=this.stride*Ue;Je.push(it[Be+We]>1?tt(it,Be,this.clusterProps):this.points[it[Be+Oe]])}return Je}getChildren(W){const Q=this._getOriginId(W),te=this._getOriginZoom(W),ge="No cluster with the specified id.",Ae=this.trees[te];if(!Ae)throw new Error(ge);const $e=Ae.data;if(Q*this.stride>=$e.length)throw new Error(ge);const qe=this.options.radius/(this.options.extent*Math.pow(2,te-1)),Ve=Ae.within($e[Q*this.stride],$e[Q*this.stride+1],qe),it=[];for(const Je of Ve){const Ue=Je*this.stride;$e[Ue+4]===W&&it.push($e[Ue+We]>1?tt($e,Ue,this.clusterProps):this.points[$e[Ue+Oe]])}if(it.length===0)throw new Error(ge);return it}getLeaves(W,Q,te){const ge=[];return this._appendLeaves(ge,W,Q=Q||10,te=te||0,0),ge}getTile(W,Q,te){const ge=this.trees[this._limitZoom(W)],Ae=Math.pow(2,W),{extent:$e,radius:qe}=this.options,Ve=qe/$e,it=(te-Ve)/Ae,Je=(te+1+Ve)/Ae,Ue={features:[]};return this._addTileFeatures(ge.range((Q-Ve)/Ae,it,(Q+1+Ve)/Ae,Je),ge.data,Q,te,Ae,Ue),Q===0&&this._addTileFeatures(ge.range(1-Ve/Ae,it,1,Je),ge.data,Ae,te,Ae,Ue),Q===Ae-1&&this._addTileFeatures(ge.range(0,it,Ve/Ae,Je),ge.data,-1,te,Ae,Ue),Ue.features.length?Ue:null}getClusterExpansionZoom(W){let Q=this._getOriginZoom(W)-1;for(;Q<=this.options.maxZoom;){const te=this.getChildren(W);if(Q++,te.length!==1)break;W=te[0].properties.cluster_id}return Q}_appendLeaves(W,Q,te,ge,Ae){const $e=this.getChildren(Q);for(const qe of $e){const Ve=qe.properties;if(Ve&&Ve.cluster?Ae+Ve.point_count<=ge?Ae+=Ve.point_count:Ae=this._appendLeaves(W,Ve.cluster_id,te,ge,Ae):Ae<ge?Ae++:W.push(qe),W.length===te)break}return Ae}_createTree(W){const Q=new m.az(W.length/this.stride|0,this.options.nodeSize,Float32Array);for(let te=0;te<W.length;te+=this.stride)Q.add(W[te],W[te+1]);return Q.finish(),Q.data=W,Q}_addTileFeatures(W,Q,te,ge,Ae,$e){for(const qe of W){const Ve=qe*this.stride,it=Q[Ve+We]>1;let Je,Ue,Be;if(it)Je=Et(Q,Ve,this.clusterProps),Ue=Q[Ve],Be=Q[Ve+1];else{const nn=this.points[Q[Ve+Oe]];Je=nn.properties;const[pn,st]=nn.geometry.coordinates;Ue=_t(pn),Be=Qe(st)}const kt={type:1,geometry:[[Math.round(this.options.extent*(Ue*Ae-te)),Math.round(this.options.extent*(Be*Ae-ge))]],tags:Je};let Tt;Tt=it||this.options.generateId?Q[Ve+Oe]:this.points[Q[Ve+Oe]].id,Tt!==void 0&&(kt.id=Tt),$e.features.push(kt)}}_limitZoom(W){return Math.max(this.options.minZoom,Math.min(Math.floor(+W),this.options.maxZoom+1))}_cluster(W,Q){const{radius:te,extent:ge,reduce:Ae,minPoints:$e}=this.options,qe=te/(ge*Math.pow(2,Q)),Ve=W.data,it=[],Je=this.stride;for(let Ue=0;Ue<Ve.length;Ue+=Je){if(Ve[Ue+2]<=Q)continue;Ve[Ue+2]=Q;const Be=Ve[Ue],kt=Ve[Ue+1],Tt=W.within(Ve[Ue],Ve[Ue+1],qe),nn=Ve[Ue+We];let pn=nn;for(const st of Tt){const At=st*Je;Ve[At+2]>Q&&(pn+=Ve[At+We])}if(pn>nn&&pn>=$e){let st,At=Be*nn,Ut=kt*nn,Cn=-1;const zn=((Ue/Je|0)<<5)+(Q+1)+this.points.length;for(const cn of Tt){const Vt=cn*Je;if(Ve[Vt+2]<=Q)continue;Ve[Vt+2]=Q;const Ii=Ve[Vt+We];At+=Ve[Vt]*Ii,Ut+=Ve[Vt+1]*Ii,Ve[Vt+4]=zn,Ae&&(st||(st=this._map(Ve,Ue,!0),Cn=this.clusterProps.length,this.clusterProps.push(st)),Ae(st,this._map(Ve,Vt)))}Ve[Ue+4]=zn,it.push(At/pn,Ut/pn,1/0,zn,-1,pn),Ae&&it.push(Cn)}else{for(let st=0;st<Je;st++)it.push(Ve[Ue+st]);if(pn>1)for(const st of Tt){const At=st*Je;if(!(Ve[At+2]<=Q)){Ve[At+2]=Q;for(let Ut=0;Ut<Je;Ut++)it.push(Ve[At+Ut])}}}}return it}_getOriginId(W){return W-this.points.length>>5}_getOriginZoom(W){return(W-this.points.length)%32}_map(W,Q,te){if(W[Q+We]>1){const $e=this.clusterProps[W[Q+dt]];return te?Object.assign({},$e):$e}const ge=this.points[W[Q+Oe]].properties,Ae=this.options.map(ge);return te&&Ae===ge?Object.assign({},Ae):Ae}}function tt(ae,W,Q){return{type:"Feature",id:ae[W+Oe],properties:Et(ae,W,Q),geometry:{type:"Point",coordinates:[(te=ae[W],360*(te-.5)),ct(ae[W+1])]}};var te}function Et(ae,W,Q){const te=ae[W+We],ge=te>=1e4?`${Math.round(te/1e3)}k`:te>=1e3?Math.round(te/100)/10+"k":te,Ae=ae[W+dt],$e=Ae===-1?{}:Object.assign({},Q[Ae]);return Object.assign($e,{cluster:!0,cluster_id:ae[W+Oe],point_count:te,point_count_abbreviated:ge})}function _t(ae){return ae/360+.5}function Qe(ae){const W=Math.sin(ae*Math.PI/180),Q=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return Q<0?0:Q>1?1:Q}function ct(ae){const W=(180-360*ae)*Math.PI/180;return 360*Math.atan(Math.exp(W))/Math.PI-90}function zt(ae,W,Q,te){let ge=te;const Ae=W+(Q-W>>1);let $e,qe=Q-W;const Ve=ae[W],it=ae[W+1],Je=ae[Q],Ue=ae[Q+1];for(let Be=W+3;Be<Q;Be+=3){const kt=Jt(ae[Be],ae[Be+1],Ve,it,Je,Ue);if(kt>ge)$e=Be,ge=kt;else if(kt===ge){const Tt=Math.abs(Be-Ae);Tt<qe&&($e=Be,qe=Tt)}}ge>te&&($e-W>3&&zt(ae,W,$e,te),ae[$e+2]=ge,Q-$e>3&&zt(ae,$e,Q,te))}function Jt(ae,W,Q,te,ge,Ae){let $e=ge-Q,qe=Ae-te;if($e!==0||qe!==0){const Ve=((ae-Q)*$e+(W-te)*qe)/($e*$e+qe*qe);Ve>1?(Q=ge,te=Ae):Ve>0&&(Q+=$e*Ve,te+=qe*Ve)}return $e=ae-Q,qe=W-te,$e*$e+qe*qe}function Lt(ae,W,Q,te){const ge={id:ae??null,type:W,geometry:Q,tags:te,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(W==="Point"||W==="MultiPoint"||W==="LineString")Yt(ge,Q);else if(W==="Polygon")Yt(ge,Q[0]);else if(W==="MultiLineString")for(const Ae of Q)Yt(ge,Ae);else if(W==="MultiPolygon")for(const Ae of Q)Yt(ge,Ae[0]);return ge}function Yt(ae,W){for(let Q=0;Q<W.length;Q+=3)ae.minX=Math.min(ae.minX,W[Q]),ae.minY=Math.min(ae.minY,W[Q+1]),ae.maxX=Math.max(ae.maxX,W[Q]),ae.maxY=Math.max(ae.maxY,W[Q+1])}function qt(ae,W,Q,te){if(!W.geometry)return;const ge=W.geometry.coordinates;if(ge&&ge.length===0)return;const Ae=W.geometry.type,$e=Math.pow(Q.tolerance/((1<<Q.maxZoom)*Q.extent),2);let qe=[],Ve=W.id;if(Q.promoteId?Ve=W.properties[Q.promoteId]:Q.generateId&&(Ve=te||0),Ae==="Point")_n(ge,qe);else if(Ae==="MultiPoint")for(const it of ge)_n(it,qe);else if(Ae==="LineString")bn(ge,qe,$e,!1);else if(Ae==="MultiLineString"){if(Q.lineMetrics){for(const it of ge)qe=[],bn(it,qe,$e,!1),ae.push(Lt(Ve,"LineString",qe,W.properties));return}jn(ge,qe,$e,!1)}else if(Ae==="Polygon")jn(ge,qe,$e,!0);else{if(Ae!=="MultiPolygon"){if(Ae==="GeometryCollection"){for(const it of W.geometry.geometries)qt(ae,{id:Ve,geometry:it,properties:W.properties},Q,te);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const it of ge){const Je=[];jn(it,Je,$e,!0),qe.push(Je)}}ae.push(Lt(Ve,Ae,qe,W.properties))}function _n(ae,W){W.push(Nn(ae[0]),si(ae[1]),0)}function bn(ae,W,Q,te){let ge,Ae,$e=0;for(let Ve=0;Ve<ae.length;Ve++){const it=Nn(ae[Ve][0]),Je=si(ae[Ve][1]);W.push(it,Je,0),Ve>0&&($e+=te?(ge*Je-it*Ae)/2:Math.sqrt(Math.pow(it-ge,2)+Math.pow(Je-Ae,2))),ge=it,Ae=Je}const qe=W.length-3;W[2]=1,zt(W,0,qe,Q),W[qe+2]=1,W.size=Math.abs($e),W.start=0,W.end=W.size}function jn(ae,W,Q,te){for(let ge=0;ge<ae.length;ge++){const Ae=[];bn(ae[ge],Ae,Q,te),W.push(Ae)}}function Nn(ae){return ae/360+.5}function si(ae){const W=Math.sin(ae*Math.PI/180),Q=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return Q<0?0:Q>1?1:Q}function En(ae,W,Q,te,ge,Ae,$e,qe){if(te/=W,Ae>=(Q/=W)&&$e<te)return ae;if($e<Q||Ae>=te)return null;const Ve=[];for(const it of ae){const Je=it.geometry;let Ue=it.type;const Be=ge===0?it.minX:it.minY,kt=ge===0?it.maxX:it.maxY;if(Be>=Q&&kt<te){Ve.push(it);continue}if(kt<Q||Be>=te)continue;let Tt=[];if(Ue==="Point"||Ue==="MultiPoint")Pe(Je,Tt,Q,te,ge);else if(Ue==="LineString")Le(Je,Tt,Q,te,ge,!1,qe.lineMetrics);else if(Ue==="MultiLineString")xt(Je,Tt,Q,te,ge,!1);else if(Ue==="Polygon")xt(Je,Tt,Q,te,ge,!0);else if(Ue==="MultiPolygon")for(const nn of Je){const pn=[];xt(nn,pn,Q,te,ge,!0),pn.length&&Tt.push(pn)}if(Tt.length){if(qe.lineMetrics&&Ue==="LineString"){for(const nn of Tt)Ve.push(Lt(it.id,Ue,nn,it.tags));continue}Ue!=="LineString"&&Ue!=="MultiLineString"||(Tt.length===1?(Ue="LineString",Tt=Tt[0]):Ue="MultiLineString"),Ue!=="Point"&&Ue!=="MultiPoint"||(Ue=Tt.length===3?"Point":"MultiPoint"),Ve.push(Lt(it.id,Ue,Tt,it.tags))}}return Ve.length?Ve:null}function Pe(ae,W,Q,te,ge){for(let Ae=0;Ae<ae.length;Ae+=3){const $e=ae[Ae+ge];$e>=Q&&$e<=te&&gt(W,ae[Ae],ae[Ae+1],ae[Ae+2])}}function Le(ae,W,Q,te,ge,Ae,$e){let qe=ot(ae);const Ve=ge===0?vt:Bt;let it,Je,Ue=ae.start;for(let pn=0;pn<ae.length-3;pn+=3){const st=ae[pn],At=ae[pn+1],Ut=ae[pn+2],Cn=ae[pn+3],zn=ae[pn+4],cn=ge===0?st:At,Vt=ge===0?Cn:zn;let Ii=!1;$e&&(it=Math.sqrt(Math.pow(st-Cn,2)+Math.pow(At-zn,2))),cn<Q?Vt>Q&&(Je=Ve(qe,st,At,Cn,zn,Q),$e&&(qe.start=Ue+it*Je)):cn>te?Vt<te&&(Je=Ve(qe,st,At,Cn,zn,te),$e&&(qe.start=Ue+it*Je)):gt(qe,st,At,Ut),Vt<Q&&cn>=Q&&(Je=Ve(qe,st,At,Cn,zn,Q),Ii=!0),Vt>te&&cn<=te&&(Je=Ve(qe,st,At,Cn,zn,te),Ii=!0),!Ae&&Ii&&($e&&(qe.end=Ue+it*Je),W.push(qe),qe=ot(ae)),$e&&(Ue+=it)}let Be=ae.length-3;const kt=ae[Be],Tt=ae[Be+1],nn=ge===0?kt:Tt;nn>=Q&&nn<=te&&gt(qe,kt,Tt,ae[Be+2]),Be=qe.length-3,Ae&&Be>=3&&(qe[Be]!==qe[0]||qe[Be+1]!==qe[1])&&gt(qe,qe[0],qe[1],qe[2]),qe.length&&W.push(qe)}function ot(ae){const W=[];return W.size=ae.size,W.start=ae.start,W.end=ae.end,W}function xt(ae,W,Q,te,ge,Ae){for(const $e of ae)Le($e,W,Q,te,ge,Ae,!1)}function gt(ae,W,Q,te){ae.push(W,Q,te)}function vt(ae,W,Q,te,ge,Ae){const $e=(Ae-W)/(te-W);return gt(ae,Ae,Q+(ge-Q)*$e,1),$e}function Bt(ae,W,Q,te,ge,Ae){const $e=(Ae-Q)/(ge-Q);return gt(ae,W+(te-W)*$e,Ae,1),$e}function It(ae,W){const Q=[];for(let te=0;te<ae.length;te++){const ge=ae[te],Ae=ge.type;let $e;if(Ae==="Point"||Ae==="MultiPoint"||Ae==="LineString")$e=Rt(ge.geometry,W);else if(Ae==="MultiLineString"||Ae==="Polygon"){$e=[];for(const qe of ge.geometry)$e.push(Rt(qe,W))}else if(Ae==="MultiPolygon"){$e=[];for(const qe of ge.geometry){const Ve=[];for(const it of qe)Ve.push(Rt(it,W));$e.push(Ve)}}Q.push(Lt(ge.id,Ae,$e,ge.tags))}return Q}function Rt(ae,W){const Q=[];Q.size=ae.size,ae.start!==void 0&&(Q.start=ae.start,Q.end=ae.end);for(let te=0;te<ae.length;te+=3)Q.push(ae[te]+W,ae[te+1],ae[te+2]);return Q}function wt(ae,W){if(ae.transformed)return ae;const Q=1<<ae.z,te=ae.x,ge=ae.y;for(const Ae of ae.features){const $e=Ae.geometry,qe=Ae.type;if(Ae.geometry=[],qe===1)for(let Ve=0;Ve<$e.length;Ve+=2)Ae.geometry.push(tn($e[Ve],$e[Ve+1],W,Q,te,ge));else for(let Ve=0;Ve<$e.length;Ve++){const it=[];for(let Je=0;Je<$e[Ve].length;Je+=2)it.push(tn($e[Ve][Je],$e[Ve][Je+1],W,Q,te,ge));Ae.geometry.push(it)}}return ae.transformed=!0,ae}function tn(ae,W,Q,te,ge,Ae){return[Math.round(Q*(ae*te-ge)),Math.round(Q*(W*te-Ae))]}function $t(ae,W,Q,te,ge){const Ae=W===ge.maxZoom?0:ge.tolerance/((1<<W)*ge.extent),$e={features:[],numPoints:0,numSimplified:0,numFeatures:ae.length,source:null,x:Q,y:te,z:W,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const qe of ae)Xt($e,qe,Ae,ge);return $e}function Xt(ae,W,Q,te){const ge=W.geometry,Ae=W.type,$e=[];if(ae.minX=Math.min(ae.minX,W.minX),ae.minY=Math.min(ae.minY,W.minY),ae.maxX=Math.max(ae.maxX,W.maxX),ae.maxY=Math.max(ae.maxY,W.maxY),Ae==="Point"||Ae==="MultiPoint")for(let qe=0;qe<ge.length;qe+=3)$e.push(ge[qe],ge[qe+1]),ae.numPoints++,ae.numSimplified++;else if(Ae==="LineString")dn($e,ge,ae,Q,!1,!1);else if(Ae==="MultiLineString"||Ae==="Polygon")for(let qe=0;qe<ge.length;qe++)dn($e,ge[qe],ae,Q,Ae==="Polygon",qe===0);else if(Ae==="MultiPolygon")for(let qe=0;qe<ge.length;qe++){const Ve=ge[qe];for(let it=0;it<Ve.length;it++)dn($e,Ve[it],ae,Q,!0,it===0)}if($e.length){let qe=W.tags||null;if(Ae==="LineString"&&te.lineMetrics){qe={};for(const it in W.tags)qe[it]=W.tags[it];qe.mapbox_clip_start=ge.start/ge.size,qe.mapbox_clip_end=ge.end/ge.size}const Ve={geometry:$e,type:Ae==="Polygon"||Ae==="MultiPolygon"?3:Ae==="LineString"||Ae==="MultiLineString"?2:1,tags:qe};W.id!==null&&(Ve.id=W.id),ae.features.push(Ve)}}function dn(ae,W,Q,te,ge,Ae){const $e=te*te;if(te>0&&W.size<(ge?$e:te))return void(Q.numPoints+=W.length/3);const qe=[];for(let Ve=0;Ve<W.length;Ve+=3)(te===0||W[Ve+2]>$e)&&(Q.numSimplified++,qe.push(W[Ve],W[Ve+1])),Q.numPoints++;ge&&function(Ve,it){let Je=0;for(let Ue=0,Be=Ve.length,kt=Be-2;Ue<Be;kt=Ue,Ue+=2)Je+=(Ve[Ue]-Ve[kt])*(Ve[Ue+1]+Ve[kt+1]);if(Je>0===it)for(let Ue=0,Be=Ve.length;Ue<Be/2;Ue+=2){const kt=Ve[Ue],Tt=Ve[Ue+1];Ve[Ue]=Ve[Be-2-Ue],Ve[Ue+1]=Ve[Be-1-Ue],Ve[Be-2-Ue]=kt,Ve[Be-1-Ue]=Tt}}(qe,Ae),ae.push(qe)}const Sn={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Dn{constructor(W,Q){const te=(Q=this.options=function(Ae,$e){for(const qe in $e)Ae[qe]=$e[qe];return Ae}(Object.create(Sn),Q)).debug;if(te&&console.time("preprocess data"),Q.maxZoom<0||Q.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Q.promoteId&&Q.generateId)throw new Error("promoteId and generateId cannot be used together.");let ge=function(Ae,$e){const qe=[];if(Ae.type==="FeatureCollection")for(let Ve=0;Ve<Ae.features.length;Ve++)qt(qe,Ae.features[Ve],$e,Ve);else qt(qe,Ae.type==="Feature"?Ae:{geometry:Ae},$e);return qe}(W,Q);this.tiles={},this.tileCoords=[],te&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Q.indexMaxZoom,Q.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ge=function(Ae,$e){const qe=$e.buffer/$e.extent;let Ve=Ae;const it=En(Ae,1,-1-qe,qe,0,-1,2,$e),Je=En(Ae,1,1-qe,2+qe,0,-1,2,$e);return(it||Je)&&(Ve=En(Ae,1,-qe,1+qe,0,-1,2,$e)||[],it&&(Ve=It(it,1).concat(Ve)),Je&&(Ve=Ve.concat(It(Je,-1)))),Ve}(ge,Q),ge.length&&this.splitTile(ge,0,0,0),te&&(ge.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(W,Q,te,ge,Ae,$e,qe){const Ve=[W,Q,te,ge],it=this.options,Je=it.debug;for(;Ve.length;){ge=Ve.pop(),te=Ve.pop(),Q=Ve.pop(),W=Ve.pop();const Ue=1<<Q,Be=An(Q,te,ge);let kt=this.tiles[Be];if(!kt&&(Je>1&&console.time("creation"),kt=this.tiles[Be]=$t(W,Q,te,ge,it),this.tileCoords.push({z:Q,x:te,y:ge}),Je)){Je>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Q,te,ge,kt.numFeatures,kt.numPoints,kt.numSimplified),console.timeEnd("creation"));const Ii=`z${Q}`;this.stats[Ii]=(this.stats[Ii]||0)+1,this.total++}if(kt.source=W,Ae==null){if(Q===it.indexMaxZoom||kt.numPoints<=it.indexMaxPoints)continue}else{if(Q===it.maxZoom||Q===Ae)continue;if(Ae!=null){const Ii=Ae-Q;if(te!==$e>>Ii||ge!==qe>>Ii)continue}}if(kt.source=null,W.length===0)continue;Je>1&&console.time("clipping");const Tt=.5*it.buffer/it.extent,nn=.5-Tt,pn=.5+Tt,st=1+Tt;let At=null,Ut=null,Cn=null,zn=null,cn=En(W,Ue,te-Tt,te+pn,0,kt.minX,kt.maxX,it),Vt=En(W,Ue,te+nn,te+st,0,kt.minX,kt.maxX,it);W=null,cn&&(At=En(cn,Ue,ge-Tt,ge+pn,1,kt.minY,kt.maxY,it),Ut=En(cn,Ue,ge+nn,ge+st,1,kt.minY,kt.maxY,it),cn=null),Vt&&(Cn=En(Vt,Ue,ge-Tt,ge+pn,1,kt.minY,kt.maxY,it),zn=En(Vt,Ue,ge+nn,ge+st,1,kt.minY,kt.maxY,it),Vt=null),Je>1&&console.timeEnd("clipping"),Ve.push(At||[],Q+1,2*te,2*ge),Ve.push(Ut||[],Q+1,2*te,2*ge+1),Ve.push(Cn||[],Q+1,2*te+1,2*ge),Ve.push(zn||[],Q+1,2*te+1,2*ge+1)}}getTile(W,Q,te){W=+W,Q=+Q,te=+te;const ge=this.options,{extent:Ae,debug:$e}=ge;if(W<0||W>24)return null;const qe=1<<W,Ve=An(W,Q=Q+qe&qe-1,te);if(this.tiles[Ve])return wt(this.tiles[Ve],Ae);$e>1&&console.log("drilling down to z%d-%d-%d",W,Q,te);let it,Je=W,Ue=Q,Be=te;for(;!it&&Je>0;)Je--,Ue>>=1,Be>>=1,it=this.tiles[An(Je,Ue,Be)];return it&&it.source?($e>1&&(console.log("found parent tile z%d-%d-%d",Je,Ue,Be),console.time("drilling down")),this.splitTile(it.source,Je,Ue,Be,W,Q,te),$e>1&&console.timeEnd("drilling down"),this.tiles[Ve]?wt(this.tiles[Ve],Ae):null):null}}function An(ae,W,Q){return 32*((1<<ae)*Q+W)+ae}function Ei(ae,W){return W?ae.properties[W]:ae.id}function ki(ae,W){if(ae==null)return!0;if(ae.type==="Feature")return Ei(ae,W)!=null;if(ae.type==="FeatureCollection"){const Q=new Set;for(const te of ae.features){const ge=Ei(te,W);if(ge==null||Q.has(ge))return!1;Q.add(ge)}return!0}return!1}function tr(ae,W){const Q=new Map;if(ae!=null)if(ae.type==="Feature")Q.set(Ei(ae,W),ae);else for(const te of ae.features)Q.set(Ei(te,W),te);return Q}class Zi extends z{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(W,Q){return m._(this,void 0,void 0,function*(){const te=W.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ge=this._geoJSONIndex.getTile(te.z,te.x,te.y);if(!ge)return null;const Ae=new Se(ge.features);let $e=Me(Ae);return $e.byteOffset===0&&$e.byteLength===$e.buffer.byteLength||($e=new Uint8Array($e)),{vectorTile:Ae,rawData:$e.buffer}})}loadData(W){return m._(this,void 0,void 0,function*(){var Q;(Q=this._pendingRequest)===null||Q===void 0||Q.abort();const te=!!(W&&W.request&&W.request.collectResourceTiming)&&new m.cu(W.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(W,this._pendingRequest),this._geoJSONIndex=W.cluster?new je(function({superclusterOptions:$e,clusterProperties:qe}){if(!qe||!$e)return $e;const Ve={},it={},Je={accumulated:null,zoom:0},Ue={properties:null},Be=Object.keys(qe);for(const kt of Be){const[Tt,nn]=qe[kt],pn=m.cB(nn),st=m.cB(typeof Tt=="string"?[Tt,["accumulated"],["get",kt]]:Tt);Ve[kt]=pn.value,it[kt]=st.value}return $e.map=kt=>{Ue.properties=kt;const Tt={};for(const nn of Be)Tt[nn]=Ve[nn].evaluate(Je,Ue);return Tt},$e.reduce=(kt,Tt)=>{Ue.properties=Tt;for(const nn of Be)Je.accumulated=kt[nn],kt[nn]=it[nn].evaluate(Je,Ue)},$e}(W)).load((yield this._pendingData).features):(ge=yield this._pendingData,new Dn(ge,W.geojsonVtOptions)),this.loaded={};const Ae={};if(te){const $e=te.finish();$e&&(Ae.resourceTiming={},Ae.resourceTiming[W.source]=JSON.parse(JSON.stringify($e)))}return Ae}catch(Ae){if(delete this._pendingRequest,m.cf(Ae))return{abandoned:!0};throw Ae}var ge})}getData(){return m._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(W){const Q=this.loaded;return Q&&Q[W.uid]?super.reloadTile(W):this.loadTile(W)}loadAndProcessGeoJSON(W,Q){return m._(this,void 0,void 0,function*(){let te=yield this.loadGeoJSON(W,Q);if(delete this._pendingRequest,typeof te!="object")throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`);if(Z(te,!0),W.filter){const ge=m.cB(W.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ge.result==="error")throw new Error(ge.value.map($e=>`${$e.key}: ${$e.message}`).join(", "));te={type:"FeatureCollection",features:te.features.filter($e=>ge.value.evaluate({zoom:0},$e))}}return te})}loadGeoJSON(W,Q){return m._(this,void 0,void 0,function*(){const{promoteId:te}=W;if(W.request){const ge=yield m.h(W.request,Q);return this._dataUpdateable=ki(ge.data,te)?tr(ge.data,te):void 0,ge.data}if(typeof W.data=="string")try{const ge=JSON.parse(W.data);return this._dataUpdateable=ki(ge,te)?tr(ge,te):void 0,ge}catch{throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`)}if(!W.dataDiff)throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${W.source}`);return function(ge,Ae,$e){var qe,Ve,it,Je;if(Ae.removeAll&&ge.clear(),Ae.remove)for(const Ue of Ae.remove)ge.delete(Ue);if(Ae.add)for(const Ue of Ae.add){const Be=Ei(Ue,$e);Be!=null&&ge.set(Be,Ue)}if(Ae.update)for(const Ue of Ae.update){let Be=ge.get(Ue.id);if(Be==null)continue;const kt=!Ue.removeAllProperties&&(((qe=Ue.removeProperties)===null||qe===void 0?void 0:qe.length)>0||((Ve=Ue.addOrUpdateProperties)===null||Ve===void 0?void 0:Ve.length)>0);if((Ue.newGeometry||Ue.removeAllProperties||kt)&&(Be=Object.assign({},Be),ge.set(Ue.id,Be),kt&&(Be.properties=Object.assign({},Be.properties))),Ue.newGeometry&&(Be.geometry=Ue.newGeometry),Ue.removeAllProperties)Be.properties={};else if(((it=Ue.removeProperties)===null||it===void 0?void 0:it.length)>0)for(const Tt of Ue.removeProperties)Object.prototype.hasOwnProperty.call(Be.properties,Tt)&&delete Be.properties[Tt];if(((Je=Ue.addOrUpdateProperties)===null||Je===void 0?void 0:Je.length)>0)for(const{key:Tt,value:nn}of Ue.addOrUpdateProperties)Be.properties[Tt]=nn}}(this._dataUpdateable,W.dataDiff,te),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(W){return m._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(W){return this._geoJSONIndex.getClusterExpansionZoom(W.clusterId)}getClusterChildren(W){return this._geoJSONIndex.getChildren(W.clusterId)}getClusterLeaves(W){return this._geoJSONIndex.getLeaves(W.clusterId,W.limit,W.offset)}}class Er{constructor(W){this.self=W,this.actor=new m.F(W),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(Q,te)=>{if(this.externalWorkerSourceTypes[Q])throw new Error(`Worker source with name "${Q}" already registered.`);this.externalWorkerSourceTypes[Q]=te},this.self.addProtocol=m.ch,this.self.removeProtocol=m.ci,this.self.registerRTLTextPlugin=Q=>{m.cC.setMethods(Q)},this.actor.registerMessageHandler("LDT",(Q,te)=>this._getDEMWorkerSource(Q,te.source).loadTile(te)),this.actor.registerMessageHandler("RDT",(Q,te)=>m._(this,void 0,void 0,function*(){this._getDEMWorkerSource(Q,te.source).removeTile(te)})),this.actor.registerMessageHandler("GCEZ",(Q,te)=>m._(this,void 0,void 0,function*(){return this._getWorkerSource(Q,te.type,te.source).getClusterExpansionZoom(te)})),this.actor.registerMessageHandler("GCC",(Q,te)=>m._(this,void 0,void 0,function*(){return this._getWorkerSource(Q,te.type,te.source).getClusterChildren(te)})),this.actor.registerMessageHandler("GCL",(Q,te)=>m._(this,void 0,void 0,function*(){return this._getWorkerSource(Q,te.type,te.source).getClusterLeaves(te)})),this.actor.registerMessageHandler("LD",(Q,te)=>this._getWorkerSource(Q,te.type,te.source).loadData(te)),this.actor.registerMessageHandler("GD",(Q,te)=>this._getWorkerSource(Q,te.type,te.source).getData()),this.actor.registerMessageHandler("LT",(Q,te)=>this._getWorkerSource(Q,te.type,te.source).loadTile(te)),this.actor.registerMessageHandler("RT",(Q,te)=>this._getWorkerSource(Q,te.type,te.source).reloadTile(te)),this.actor.registerMessageHandler("AT",(Q,te)=>this._getWorkerSource(Q,te.type,te.source).abortTile(te)),this.actor.registerMessageHandler("RMT",(Q,te)=>this._getWorkerSource(Q,te.type,te.source).removeTile(te)),this.actor.registerMessageHandler("RS",(Q,te)=>m._(this,void 0,void 0,function*(){if(!this.workerSources[Q]||!this.workerSources[Q][te.type]||!this.workerSources[Q][te.type][te.source])return;const ge=this.workerSources[Q][te.type][te.source];delete this.workerSources[Q][te.type][te.source],ge.removeSource!==void 0&&ge.removeSource(te)})),this.actor.registerMessageHandler("RM",Q=>m._(this,void 0,void 0,function*(){delete this.layerIndexes[Q],delete this.availableImages[Q],delete this.workerSources[Q],delete this.demWorkerSources[Q]})),this.actor.registerMessageHandler("SR",(Q,te)=>m._(this,void 0,void 0,function*(){this.referrer=te})),this.actor.registerMessageHandler("SRPS",(Q,te)=>this._syncRTLPluginState(Q,te)),this.actor.registerMessageHandler("IS",(Q,te)=>m._(this,void 0,void 0,function*(){this.self.importScripts(te)})),this.actor.registerMessageHandler("SI",(Q,te)=>this._setImages(Q,te)),this.actor.registerMessageHandler("UL",(Q,te)=>m._(this,void 0,void 0,function*(){this._getLayerIndex(Q).update(te.layers,te.removedIds)})),this.actor.registerMessageHandler("SL",(Q,te)=>m._(this,void 0,void 0,function*(){this._getLayerIndex(Q).replace(te)}))}_setImages(W,Q){return m._(this,void 0,void 0,function*(){this.availableImages[W]=Q;for(const te in this.workerSources[W]){const ge=this.workerSources[W][te];for(const Ae in ge)ge[Ae].availableImages=Q}})}_syncRTLPluginState(W,Q){return m._(this,void 0,void 0,function*(){return yield m.cC.syncState(Q,this.self.importScripts)})}_getAvailableImages(W){let Q=this.availableImages[W];return Q||(Q=[]),Q}_getLayerIndex(W){let Q=this.layerIndexes[W];return Q||(Q=this.layerIndexes[W]=new o),Q}_getWorkerSource(W,Q,te){if(this.workerSources[W]||(this.workerSources[W]={}),this.workerSources[W][Q]||(this.workerSources[W][Q]={}),!this.workerSources[W][Q][te]){const ge={sendAsync:(Ae,$e)=>(Ae.targetMapId=W,this.actor.sendAsync(Ae,$e))};switch(Q){case"vector":this.workerSources[W][Q][te]=new z(ge,this._getLayerIndex(W),this._getAvailableImages(W));break;case"geojson":this.workerSources[W][Q][te]=new Zi(ge,this._getLayerIndex(W),this._getAvailableImages(W));break;default:this.workerSources[W][Q][te]=new this.externalWorkerSourceTypes[Q](ge,this._getLayerIndex(W),this._getAvailableImages(W))}}return this.workerSources[W][Q][te]}_getDEMWorkerSource(W,Q){return this.demWorkerSources[W]||(this.demWorkerSources[W]={}),this.demWorkerSources[W][Q]||(this.demWorkerSources[W][Q]=new O),this.demWorkerSources[W][Q]}}return m.i(self)&&(self.worker=new Er(self)),Er}),f("index",["exports","./shared"],function(m,o){var T="5.1.0";function k(){var _=new o.A(4);return o.A!=Float32Array&&(_[1]=0,_[2]=0),_[0]=1,_[3]=1,_}let I,z;const O={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(_,t,r){const d=requestAnimationFrame(t);_.signal.addEventListener("abort",()=>{cancelAnimationFrame(d),r(o.c())})},frameAsync(_){return new Promise((t,r)=>{this.frame(_,t,r)})},getImageData(_,t=0){return this.getImageCanvasContext(_).getImageData(-t,-t,_.width+2*t,_.height+2*t)},getImageCanvasContext(_){const t=window.document.createElement("canvas"),r=t.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("failed to create canvas 2d context");return t.width=_.width,t.height=_.height,r.drawImage(_,0,0,_.width,_.height),r},resolveURL:_=>(I||(I=document.createElement("a")),I.href=_,I.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(z==null&&(z=matchMedia("(prefers-reduced-motion: reduce)")),z.matches)}};class D{static testProp(t){if(!D.docStyle)return t[0];for(let r=0;r<t.length;r++)if(t[r]in D.docStyle)return t[r];return t[0]}static create(t,r,d){const h=window.document.createElement(t);return r!==void 0&&(h.className=r),d&&d.appendChild(h),h}static createNS(t,r){return window.document.createElementNS(t,r)}static disableDrag(){D.docStyle&&D.selectProp&&(D.userSelect=D.docStyle[D.selectProp],D.docStyle[D.selectProp]="none")}static enableDrag(){D.docStyle&&D.selectProp&&(D.docStyle[D.selectProp]=D.userSelect)}static setTransform(t,r){t.style[D.transformProp]=r}static addEventListener(t,r,d,h={}){t.addEventListener(r,d,"passive"in h?h:h.capture)}static removeEventListener(t,r,d,h={}){t.removeEventListener(r,d,"passive"in h?h:h.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",D.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",D.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",D.suppressClickInternal,!0)},0)}static getScale(t){const r=t.getBoundingClientRect();return{x:r.width/t.offsetWidth||1,y:r.height/t.offsetHeight||1,boundingClientRect:r}}static getPoint(t,r,d){const h=r.boundingClientRect;return new o.P((d.clientX-h.left)/r.x-t.clientLeft,(d.clientY-h.top)/r.y-t.clientTop)}static mousePos(t,r){const d=D.getScale(t);return D.getPoint(t,d,r)}static touchPos(t,r){const d=[],h=D.getScale(t);for(let y=0;y<r.length;y++)d.push(D.getPoint(t,h,r[y]));return d}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}static sanitize(t){const r=new DOMParser().parseFromString(t,"text/html").body||document.createElement("body"),d=r.querySelectorAll("script");for(const h of d)h.remove();return D.clean(r),r.innerHTML}static isPossiblyDangerous(t,r){const d=r.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(t)||!d.includes("javascript:")&&!d.includes("data:"))||!!t.startsWith("on")||void 0}static clean(t){const r=t.children;for(const d of r)D.removeAttributes(d),D.clean(d)}static removeAttributes(t){for(const{name:r,value:d}of t.attributes)D.isPossiblyDangerous(r,d)&&t.removeAttribute(r)}}D.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,D.selectProp=D.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),D.transformProp=D.testProp(["transform","WebkitTransform"]);const B={supported:!1,testSupport:function(_){!oe&&Z&&(pe?Se(_):V=_)}};let V,Z,oe=!1,pe=!1;function Se(_){const t=_.createTexture();_.bindTexture(_.TEXTURE_2D,t);try{if(_.texImage2D(_.TEXTURE_2D,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,Z),_.isContextLost())return;B.supported=!0}catch{}_.deleteTexture(t),oe=!0}var me;typeof document<"u"&&(Z=document.createElement("img"),Z.onload=()=>{V&&Se(V),V=null,pe=!0},Z.onerror=()=>{oe=!0,V=null},Z.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(_){let t,r,d,h;_.resetRequestQueue=()=>{t=[],r=0,d=0,h={}},_.addThrottleControl=P=>{const A=d++;return h[A]=P,A},_.removeThrottleControl=P=>{delete h[P],x()},_.getImage=(P,A,F=!0)=>new Promise((N,j)=>{B.supported&&(P.headers||(P.headers={}),P.headers.accept="image/webp,*/*"),o.e(P,{type:"image"}),t.push({abortController:A,requestParameters:P,supportImageRefresh:F,state:"queued",onError:X=>{j(X)},onSuccess:X=>{N(X)}}),x()});const y=P=>o._(this,void 0,void 0,function*(){P.state="running";const{requestParameters:A,supportImageRefresh:F,onError:N,onSuccess:j,abortController:X}=P,J=F===!1&&!o.i(self)&&!o.g(A.url)&&(!A.headers||Object.keys(A.headers).reduce((ue,fe)=>ue&&fe==="accept",!0));r++;const le=J?S(A,X):o.m(A,X);try{const ue=yield le;delete P.abortController,P.state="completed",ue.data instanceof HTMLImageElement||o.b(ue.data)?j(ue):ue.data&&j({data:yield(se=ue.data,typeof createImageBitmap=="function"?o.d(se):o.f(se)),cacheControl:ue.cacheControl,expires:ue.expires})}catch(ue){delete P.abortController,N(ue)}finally{r--,x()}var se}),x=()=>{const P=(()=>{for(const A of Object.keys(h))if(h[A]())return!0;return!1})()?o.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let A=r;A<P&&t.length>0;A++){const F=t.shift();F.abortController.signal.aborted?A--:y(F)}},S=(P,A)=>new Promise((F,N)=>{const j=new Image,X=P.url,J=P.credentials;J&&J==="include"?j.crossOrigin="use-credentials":(J&&J==="same-origin"||!o.s(X))&&(j.crossOrigin="anonymous"),A.signal.addEventListener("abort",()=>{j.src="",N(o.c())}),j.fetchPriority="high",j.onload=()=>{j.onerror=j.onload=null,F({data:j})},j.onerror=()=>{j.onerror=j.onload=null,A.signal.aborted||N(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},j.src=X})}(me||(me={})),me.resetRequestQueue();class be{constructor(t){this._transformRequestFn=t}transformRequest(t,r){return this._transformRequestFn&&this._transformRequestFn(t,r)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function he(_){const t=[];if(typeof _=="string")t.push({id:"default",url:_});else if(_&&_.length>0){const r=[];for(const{id:d,url:h}of _){const y=`${d}${h}`;r.indexOf(y)===-1&&(r.push(y),t.push({id:d,url:h}))}}return t}function Ce(_,t,r){try{const d=new URL(_);return d.pathname+=`${t}${r}`,d.toString()}catch{throw new Error(`Invalid sprite URL "${_}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class ye{constructor(t,r,d,h){this.context=t,this.format=d,this.texture=t.gl.createTexture(),this.update(r,h)}update(t,r,d){const{width:h,height:y}=t,x=!(this.size&&this.size[0]===h&&this.size[1]===y||d),{context:S}=this,{gl:P}=S;if(this.useMipmap=!!(r&&r.useMipmap),P.bindTexture(P.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===P.RGBA&&(!r||r.premultiply!==!1)),x)this.size=[h,y],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||o.b(t)?P.texImage2D(P.TEXTURE_2D,0,this.format,this.format,P.UNSIGNED_BYTE,t):P.texImage2D(P.TEXTURE_2D,0,this.format,h,y,0,this.format,P.UNSIGNED_BYTE,t.data);else{const{x:A,y:F}=d||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||o.b(t)?P.texSubImage2D(P.TEXTURE_2D,0,A,F,P.RGBA,P.UNSIGNED_BYTE,t):P.texSubImage2D(P.TEXTURE_2D,0,A,F,h,y,P.RGBA,P.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&P.generateMipmap(P.TEXTURE_2D)}bind(t,r,d){const{context:h}=this,{gl:y}=h;y.bindTexture(y.TEXTURE_2D,this.texture),d!==y.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(d=y.LINEAR),t!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,t),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,d||t),this.filter=t),r!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,r),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function Me(_){const{userImage:t}=_;return!!(t&&t.render&&t.render())&&(_.data.replace(new Uint8Array(t.data.buffer)),!0)}class ke extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:r,promiseResolve:d}of this.requestors)d(this._getImagesForIds(r));this.requestors=[]}}getImage(t){const r=this.images[t];if(r&&!r.data&&r.spriteData){const d=r.spriteData;r.data=new o.R({width:d.width,height:d.height},d.context.getImageData(d.x,d.y,d.width,d.height).data),r.spriteData=null}return r}addImage(t,r){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,r)&&(this.images[t]=r)}_validate(t,r){let d=!0;const h=r.data||r.spriteData;return this._validateStretch(r.stretchX,h&&h.width)||(this.fire(new o.j(new Error(`Image "${t}" has invalid "stretchX" value`))),d=!1),this._validateStretch(r.stretchY,h&&h.height)||(this.fire(new o.j(new Error(`Image "${t}" has invalid "stretchY" value`))),d=!1),this._validateContent(r.content,r)||(this.fire(new o.j(new Error(`Image "${t}" has invalid "content" value`))),d=!1),d}_validateStretch(t,r){if(!t)return!0;let d=0;for(const h of t){if(h[0]<d||h[1]<h[0]||r<h[1])return!1;d=h[1]}return!0}_validateContent(t,r){if(!t)return!0;if(t.length!==4)return!1;const d=r.spriteData,h=d&&d.width||r.data.width,y=d&&d.height||r.data.height;return!(t[0]<0||h<t[0]||t[1]<0||y<t[1]||t[2]<0||h<t[2]||t[3]<0||y<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,r,d=!0){const h=this.getImage(t);if(d&&(h.data.width!==r.data.width||h.data.height!==r.data.height))throw new Error(`size mismatch between old image (${h.data.width}x${h.data.height}) and new image (${r.data.width}x${r.data.height}).`);r.version=h.version+1,this.images[t]=r,this.updatedImages[t]=!0}removeImage(t){const r=this.images[t];delete this.images[t],delete this.patterns[t],r.userImage&&r.userImage.onRemove&&r.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise((r,d)=>{let h=!0;if(!this.isLoaded())for(const y of t)this.images[y]||(h=!1);this.isLoaded()||h?r(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:r})})}_getImagesForIds(t){const r={};for(const d of t){let h=this.getImage(d);h||(this.fire(new o.k("styleimagemissing",{id:d})),h=this.getImage(d)),h?r[d]={data:h.data.clone(),pixelRatio:h.pixelRatio,sdf:h.sdf,version:h.version,stretchX:h.stretchX,stretchY:h.stretchY,content:h.content,textFitWidth:h.textFitWidth,textFitHeight:h.textFitHeight,hasRenderCallback:!!(h.userImage&&h.userImage.render)}:o.w(`Image "${d}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return r}getPixelSize(){const{width:t,height:r}=this.atlasImage;return{width:t,height:r}}getPattern(t){const r=this.patterns[t],d=this.getImage(t);if(!d)return null;if(r&&r.position.version===d.version)return r.position;if(r)r.position.version=d.version;else{const h={w:d.data.width+2,h:d.data.height+2,x:0,y:0},y=new o.I(h,d);this.patterns[t]={bin:h,position:y}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const r=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ye(t,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const y in this.patterns)t.push(this.patterns[y].bin);const{w:r,h:d}=o.p(t),h=this.atlasImage;h.resize({width:r||1,height:d||1});for(const y in this.patterns){const{bin:x}=this.patterns[y],S=x.x+1,P=x.y+1,A=this.getImage(y).data,F=A.width,N=A.height;o.R.copy(A,h,{x:0,y:0},{x:S,y:P},{width:F,height:N}),o.R.copy(A,h,{x:0,y:N-1},{x:S,y:P-1},{width:F,height:1}),o.R.copy(A,h,{x:0,y:0},{x:S,y:P+N},{width:F,height:1}),o.R.copy(A,h,{x:F-1,y:0},{x:S-1,y:P},{width:1,height:N}),o.R.copy(A,h,{x:0,y:0},{x:S+F,y:P},{width:1,height:N})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const r of t){if(this.callbackDispatchedThisFrame[r])continue;this.callbackDispatchedThisFrame[r]=!0;const d=this.getImage(r);d||o.w(`Image with ID: "${r}" was not found`),Me(d)&&this.updateImage(r,d)}}}const Ee=1e20;function xe(_,t,r,d,h,y,x,S,P){for(let A=t;A<t+d;A++)Oe(_,r*y+A,y,h,x,S,P);for(let A=r;A<r+h;A++)Oe(_,A*y+t,1,d,x,S,P)}function Oe(_,t,r,d,h,y,x){y[0]=0,x[0]=-1e20,x[1]=Ee,h[0]=_[t];for(let S=1,P=0,A=0;S<d;S++){h[S]=_[t+S*r];const F=S*S;do{const N=y[P];A=(h[S]-h[N]+F-N*N)/(S-N)/2}while(A<=x[P]&&--P>-1);P++,y[P]=S,x[P]=A,x[P+1]=Ee}for(let S=0,P=0;S<d;S++){for(;x[P+1]<S;)P++;const A=y[P],F=S-A;_[t+S*r]=h[A]+F*F}}class We{constructor(t,r){this.requestManager=t,this.localIdeographFontFamily=r,this.entries={}}setURL(t){this.url=t}getGlyphs(t){return o._(this,void 0,void 0,function*(){const r=[];for(const y in t)for(const x of t[y])r.push(this._getAndCacheGlyphsPromise(y,x));const d=yield Promise.all(r),h={};for(const{stack:y,id:x,glyph:S}of d)h[y]||(h[y]={}),h[y][x]=S&&{id:S.id,bitmap:S.bitmap.clone(),metrics:S.metrics};return h})}_getAndCacheGlyphsPromise(t,r){return o._(this,void 0,void 0,function*(){let d=this.entries[t];d||(d=this.entries[t]={glyphs:{},requests:{},ranges:{}});let h=d.glyphs[r];if(h!==void 0)return{stack:t,id:r,glyph:h};if(h=this._tinySDF(d,t,r),h)return d.glyphs[r]=h,{stack:t,id:r,glyph:h};const y=Math.floor(r/256);if(256*y>65535)throw new Error("glyphs > 65535 not supported");if(d.ranges[y])return{stack:t,id:r,glyph:h};if(!this.url)throw new Error("glyphsUrl is not set");if(!d.requests[y]){const S=We.loadGlyphRange(t,y,this.url,this.requestManager);d.requests[y]=S}const x=yield d.requests[y];for(const S in x)this._doesCharSupportLocalGlyph(+S)||(d.glyphs[+S]=x[+S]);return d.ranges[y]=!0,{stack:t,id:r,glyph:x[r]||null}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&/\p{Ideo}|\p{sc=Hang}|\p{sc=Hira}|\p{sc=Kana}/u.test(String.fromCodePoint(t))}_tinySDF(t,r,d){const h=this.localIdeographFontFamily;if(!h||!this._doesCharSupportLocalGlyph(d))return;let y=t.tinySDF;if(!y){let S="400";/bold/i.test(r)?S="900":/medium/i.test(r)?S="500":/light/i.test(r)&&(S="200"),y=t.tinySDF=new We.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:h,fontWeight:S})}const x=y.draw(String.fromCharCode(d));return{id:d,bitmap:new o.o({width:x.width||60,height:x.height||60},x.data),metrics:{width:x.glyphWidth/2||24,height:x.glyphHeight/2||24,left:x.glyphLeft/2+.5||0,top:x.glyphTop/2-27.5||-8,advance:x.glyphAdvance/2||24,isDoubleResolution:!0}}}}We.loadGlyphRange=function(_,t,r,d){return o._(this,void 0,void 0,function*(){const h=256*t,y=h+255,x=d.transformRequest(r.replace("{fontstack}",_).replace("{range}",`${h}-${y}`),"Glyphs"),S=yield o.l(x,new AbortController);if(!S||!S.data)throw new Error(`Could not load glyph range. range: ${t}, ${h}-${y}`);const P={};for(const A of o.n(S.data))P[A.id]=A;return P})},We.TinySDF=class{constructor({fontSize:_=24,buffer:t=3,radius:r=8,cutoff:d=.25,fontFamily:h="sans-serif",fontWeight:y="normal",fontStyle:x="normal"}={}){this.buffer=t,this.cutoff=d,this.radius=r;const S=this.size=_+4*t,P=this._createCanvas(S),A=this.ctx=P.getContext("2d",{willReadFrequently:!0});A.font=`${x} ${y} ${_}px ${h}`,A.textBaseline="alphabetic",A.textAlign="left",A.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(_){const t=document.createElement("canvas");return t.width=t.height=_,t}draw(_){const{width:t,actualBoundingBoxAscent:r,actualBoundingBoxDescent:d,actualBoundingBoxLeft:h,actualBoundingBoxRight:y}=this.ctx.measureText(_),x=Math.ceil(r),S=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-h))),P=Math.min(this.size-this.buffer,x+Math.ceil(d)),A=S+2*this.buffer,F=P+2*this.buffer,N=Math.max(A*F,0),j=new Uint8ClampedArray(N),X={data:j,width:A,height:F,glyphWidth:S,glyphHeight:P,glyphTop:x,glyphLeft:0,glyphAdvance:t};if(S===0||P===0)return X;const{ctx:J,buffer:le,gridInner:se,gridOuter:ue}=this;J.clearRect(le,le,S,P),J.fillText(_,le,le+x);const fe=J.getImageData(le,le,S,P);ue.fill(Ee,0,N),se.fill(0,0,N);for(let we=0;we<P;we++)for(let Te=0;Te<S;Te++){const Ie=fe.data[4*(we*S+Te)+3]/255;if(Ie===0)continue;const De=(we+le)*A+Te+le;if(Ie===1)ue[De]=0,se[De]=Ee;else{const Re=.5-Ie;ue[De]=Re>0?Re*Re:0,se[De]=Re<0?Re*Re:0}}xe(ue,0,0,A,F,A,this.f,this.v,this.z),xe(se,le,le,S,P,A,this.f,this.v,this.z);for(let we=0;we<N;we++){const Te=Math.sqrt(ue[we])-Math.sqrt(se[we]);j[we]=Math.round(255-255*(Te/this.radius+this.cutoff))}return X}};class dt{constructor(){this.specification=o.v.light.position}possiblyEvaluate(t,r){return o.x(t.expression.evaluate(r))}interpolate(t,r,d){return{x:o.y.number(t.x,r.x,d),y:o.y.number(t.y,r.y,d),z:o.y.number(t.z,r.z,d)}}}let je;class tt extends o.E{constructor(t){super(),je=je||new o.q({anchor:new o.D(o.v.light.anchor),position:new dt,color:new o.D(o.v.light.color),intensity:new o.D(o.v.light.intensity)}),this._transitionable=new o.T(je),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,r={}){if(!this._validate(o.r,t,r))for(const d in t){const h=t[d];d.endsWith("-transition")?this._transitionable.setTransition(d.slice(0,-11),h):this._transitionable.setValue(d,h)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,r,d){return(!d||d.validate!==!1)&&o.t(this,t.call(o.u,{value:r,style:{glyphs:!0,sprite:!0},styleSpec:o.v}))}}const Et=new o.q({"sky-color":new o.D(o.v.sky["sky-color"]),"horizon-color":new o.D(o.v.sky["horizon-color"]),"fog-color":new o.D(o.v.sky["fog-color"]),"fog-ground-blend":new o.D(o.v.sky["fog-ground-blend"]),"horizon-fog-blend":new o.D(o.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new o.D(o.v.sky["sky-horizon-blend"]),"atmosphere-blend":new o.D(o.v.sky["atmosphere-blend"])});class _t extends o.E{constructor(t){super(),this._transitionable=new o.T(Et),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.z(0))}setSky(t,r={}){if(!this._validate(o.B,t,r)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const d in t){const h=t[d];d.endsWith("-transition")?this._transitionable.setTransition(d.slice(0,-11),h):this._transitionable.setValue(d,h)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,r,d={}){return(d==null?void 0:d.validate)!==!1&&o.t(this,t.call(o.u,o.e({value:r,style:{glyphs:!0,sprite:!0},styleSpec:o.v})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class Qe{constructor(t,r){this.width=t,this.height=r,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,r){const d=t.join(",")+String(r);return this.dashEntry[d]||(this.dashEntry[d]=this.addDash(t,r)),this.dashEntry[d]}getDashRanges(t,r,d){const h=[];let y=t.length%2==1?-t[t.length-1]*d:0,x=t[0]*d,S=!0;h.push({left:y,right:x,isDash:S,zeroLength:t[0]===0});let P=t[0];for(let A=1;A<t.length;A++){S=!S;const F=t[A];y=P*d,P+=F,x=P*d,h.push({left:y,right:x,isDash:S,zeroLength:F===0})}return h}addRoundDash(t,r,d){const h=r/2;for(let y=-d;y<=d;y++){const x=this.width*(this.nextRow+d+y);let S=0,P=t[S];for(let A=0;A<this.width;A++){A/P.right>1&&(P=t[++S]);const F=Math.abs(A-P.left),N=Math.abs(A-P.right),j=Math.min(F,N);let X;const J=y/d*(h+1);if(P.isDash){const le=h-Math.abs(J);X=Math.sqrt(j*j+le*le)}else X=h-Math.sqrt(j*j+J*J);this.data[x+A]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(t){for(let S=t.length-1;S>=0;--S){const P=t[S],A=t[S+1];P.zeroLength?t.splice(S,1):A&&A.isDash===P.isDash&&(A.left=P.left,t.splice(S,1))}const r=t[0],d=t[t.length-1];r.isDash===d.isDash&&(r.left=d.left-this.width,d.right=r.right+this.width);const h=this.width*this.nextRow;let y=0,x=t[y];for(let S=0;S<this.width;S++){S/x.right>1&&(x=t[++y]);const P=Math.abs(S-x.left),A=Math.abs(S-x.right),F=Math.min(P,A);this.data[h+S]=Math.max(0,Math.min(255,(x.isDash?F:-F)+128))}}addDash(t,r){const d=r?7:0,h=2*d+1;if(this.nextRow+h>this.height)return o.w("LineAtlas out of space"),null;let y=0;for(let S=0;S<t.length;S++)y+=t[S];if(y!==0){const S=this.width/y,P=this.getDashRanges(t,this.width,S);r?this.addRoundDash(P,S,d):this.addRegularDash(P)}const x={y:(this.nextRow+d+.5)/this.height,height:2*d/this.height,width:y};return this.nextRow+=h,this.dirty=!0,x}bind(t){const r=t.gl;this.texture?(r.bindTexture(r.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,r.texSubImage2D(r.TEXTURE_2D,0,0,0,this.width,this.height,r.ALPHA,r.UNSIGNED_BYTE,this.data))):(this.texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,this.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.ALPHA,this.width,this.height,0,r.ALPHA,r.UNSIGNED_BYTE,this.data))}}const ct="maplibre_preloaded_worker_pool";class zt{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<zt.workerCount;)this.workers.push(new Worker(o.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(r=>{r.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ct]}numActive(){return Object.keys(this.active).length}}const Jt=Math.floor(O.hardwareConcurrency/2);let Lt,Yt;function qt(){return Lt||(Lt=new zt),Lt}zt.workerCount=o.C(globalThis)?Math.max(Math.min(Jt,3),1):1;class _n{constructor(t,r){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=r;const d=this.workerPool.acquire(r);for(let h=0;h<d.length;h++){const y=new o.F(d[h],r);y.name=`Worker ${h}`,this.actors.push(y)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,r){const d=[];for(const h of this.actors)d.push(h.sendAsync({type:t,data:r}));return Promise.all(d)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach(r=>{r.remove()}),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,r){for(const d of this.actors)d.registerMessageHandler(t,r)}}function bn(){return Yt||(Yt=new _n(qt(),o.G),Yt.registerMessageHandler("GR",(_,t,r)=>o.m(t,r))),Yt}function jn(_,t){const r=o.H();return o.J(r,r,[1,1,0]),o.K(r,r,[.5*_.width,.5*_.height,1]),_.calculatePosMatrix?o.L(r,r,_.calculatePosMatrix(t.toUnwrapped())):r}function Nn(_,t,r,d,h,y){var x;const S=function(N,j,X){if(N)for(const J of N){const le=j[J];if(le&&le.source===X&&le.type==="fill-extrusion")return!0}else for(const J in j){const le=j[J];if(le.source===X&&le.type==="fill-extrusion")return!0}return!1}((x=h==null?void 0:h.layers)!==null&&x!==void 0?x:null,t,_.id),P=y.maxPitchScaleFactor(),A=_.tilesIn(d,P,S);A.sort(si);const F=[];for(const N of A)F.push({wrappedTileID:N.tileID.wrapped().key,queryResults:N.tile.queryRenderedFeatures(t,r,_._state,N.queryGeometry,N.cameraQueryGeometry,N.scale,h,y,P,jn(_.transform,N.tileID))});return function(N,j){for(const X in N)for(const J of N[X])En(J,j);return N}(function(N){const j={},X={};for(const J of N){const le=J.queryResults,se=J.wrappedTileID,ue=X[se]=X[se]||{};for(const fe in le){const we=le[fe],Te=ue[fe]=ue[fe]||{},Ie=j[fe]=j[fe]||[];for(const De of we)Te[De.featureIndex]||(Te[De.featureIndex]=!0,Ie.push(De))}}return j}(F),_)}function si(_,t){const r=_.tileID,d=t.tileID;return r.overscaledZ-d.overscaledZ||r.canonical.y-d.canonical.y||r.wrap-d.wrap||r.canonical.x-d.canonical.x}function En(_,t){const r=_.feature,d=t.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=d}function Pe(_,t,r){return o._(this,void 0,void 0,function*(){let d=_;if(_.url?d=(yield o.h(t.transformRequest(_.url,"Source"),r)).data:yield O.frameAsync(r),!d)return null;const h=o.M(o.e(d,_),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in d&&d.vector_layers&&(h.vectorLayerIds=d.vector_layers.map(y=>y.id)),h})}class Le{constructor(t,r){t&&(r?this.setSouthWest(t).setNorthEast(r):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof o.N?new o.N(t.lng,t.lat):o.N.convert(t),this}setSouthWest(t){return this._sw=t instanceof o.N?new o.N(t.lng,t.lat):o.N.convert(t),this}extend(t){const r=this._sw,d=this._ne;let h,y;if(t instanceof o.N)h=t,y=t;else{if(!(t instanceof Le))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Le.convert(t)):this.extend(o.N.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(o.N.convert(t)):this;if(h=t._sw,y=t._ne,!h||!y)return this}return r||d?(r.lng=Math.min(h.lng,r.lng),r.lat=Math.min(h.lat,r.lat),d.lng=Math.max(y.lng,d.lng),d.lat=Math.max(y.lat,d.lat)):(this._sw=new o.N(h.lng,h.lat),this._ne=new o.N(y.lng,y.lat)),this}getCenter(){return new o.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.N(this.getWest(),this.getNorth())}getSouthEast(){return new o.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:r,lat:d}=o.N.convert(t);let h=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&h}static convert(t){return t instanceof Le?t:t&&new Le(t)}static fromLngLat(t,r=0){const d=360*r/40075017,h=d/Math.cos(Math.PI/180*t.lat);return new Le(new o.N(t.lng-h,t.lat-d),new o.N(t.lng+h,t.lat+d))}adjustAntiMeridian(){const t=new o.N(this._sw.lng,this._sw.lat),r=new o.N(this._ne.lng,this._ne.lat);return new Le(t,t.lng>r.lng?new o.N(r.lng+360,r.lat):r)}}class ot{constructor(t,r,d){this.bounds=Le.convert(this.validateBounds(t)),this.minzoom=r||0,this.maxzoom=d||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const r=Math.pow(2,t.z),d=Math.floor(o.O(this.bounds.getWest())*r),h=Math.floor(o.Q(this.bounds.getNorth())*r),y=Math.ceil(o.O(this.bounds.getEast())*r),x=Math.ceil(o.Q(this.bounds.getSouth())*r);return t.x>=d&&t.x<y&&t.y>=h&&t.y<x}}class xt extends o.E{constructor(t,r,d,h){if(super(),this.id=t,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.M(r,["url","scheme","tileSize","promoteId"])),this._options=o.e({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(h)}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield Pe(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(o.e(this,t),t.bounds&&(this.tileBounds=new ot(t.bounds,this.minzoom,this.maxzoom)),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new o.j(t))}})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(t){return o._(this,void 0,void 0,function*(){const r=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d={request:this.map._requestManager.transformRequest(r,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};d.request.collectResourceTiming=this._collectResourceTiming;let h="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise((y,x)=>{t.reloadPromise={resolve:y,reject:x}})}else t.actor=this.dispatcher.getActor(),h="LT";t.abortController=new AbortController;try{const y=yield t.actor.sendAsync({type:h,data:d},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,y)}catch(y){if(delete t.abortController,t.aborted)return;if(y&&y.status!==404)throw y;this._afterTileLoadWorkerResponse(t,null)}})}_afterTileLoadWorkerResponse(t,r){if(r&&r.resourceTiming&&(t.resourceTiming=r.resourceTiming),r&&this.map._refreshExpiredTiles&&t.setExpiryData(r),t.loadVectorData(r,this.map.painter),t.reloadPromise){const d=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(d.resolve).catch(d.reject)}}abortTile(t){return o._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))})}unloadTile(t){return o._(this,void 0,void 0,function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class gt extends o.E{constructor(t,r,d,h){super(),this.id=t,this.dispatcher=d,this.setEventedParent(h),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},r),o.e(this,o.M(r,["url","scheme","tileSize"]))}load(){return o._(this,arguments,void 0,function*(t=!1){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield Pe(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,r&&(o.e(this,r),r.bounds&&(this.tileBounds=new ot(r.bounds,this.minzoom,this.maxzoom)),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:t})))}catch(r){this._tileJSONRequest=null,this.fire(new o.j(r))}})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}serialize(){return o.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return o._(this,void 0,void 0,function*(){const r=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const d=yield me.getImage(this.map._requestManager.transformRequest(r,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(d&&d.data){this.map._refreshExpiredTiles&&d.cacheControl&&d.expires&&t.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const h=this.map.painter.context,y=h.gl,x=d.data;t.texture=this.map.painter.getTileTexture(x.width),t.texture?t.texture.update(x,{useMipmap:!0}):(t.texture=new ye(h,x,y.RGBA,{useMipmap:!0}),t.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(d){if(delete t.abortController,t.aborted)t.state="unloaded";else if(d)throw t.state="errored",d}})}abortTile(t){return o._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)})}unloadTile(t){return o._(this,void 0,void 0,function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)})}hasTransition(){return!1}}class vt extends gt{constructor(t,r,d,h){super(t,r,d,h),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox",this.redFactor=r.redFactor,this.greenFactor=r.greenFactor,this.blueFactor=r.blueFactor,this.baseShift=r.baseShift}loadTile(t){return o._(this,void 0,void 0,function*(){const r=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d=this.map._requestManager.transformRequest(r,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const h=yield me.getImage(d,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(h&&h.data){const y=h.data;this.map._refreshExpiredTiles&&h.cacheControl&&h.expires&&t.setExpiryData({cacheControl:h.cacheControl,expires:h.expires});const x=o.b(y)&&o.U()?y:yield this.readImageNow(y),S={type:this.type,uid:t.uid,source:this.id,rawImageData:x,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const P=yield t.actor.sendAsync({type:"LDT",data:S});t.dem=P,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(h){if(delete t.abortController,t.aborted)t.state="unloaded";else if(h)throw t.state="errored",h}})}readImageNow(t){return o._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&o.V()){const r=t.width+2,d=t.height+2;try{return new o.R({width:r,height:d},yield o.W(t,-1,-1,r,d))}catch{}}return O.getImageData(t,1)})}_getNeighboringTiles(t){const r=t.canonical,d=Math.pow(2,r.z),h=(r.x-1+d)%d,y=r.x===0?t.wrap-1:t.wrap,x=(r.x+1+d)%d,S=r.x+1===d?t.wrap+1:t.wrap,P={};return P[new o.S(t.overscaledZ,y,r.z,h,r.y).key]={backfilled:!1},P[new o.S(t.overscaledZ,S,r.z,x,r.y).key]={backfilled:!1},r.y>0&&(P[new o.S(t.overscaledZ,y,r.z,h,r.y-1).key]={backfilled:!1},P[new o.S(t.overscaledZ,t.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},P[new o.S(t.overscaledZ,S,r.z,x,r.y-1).key]={backfilled:!1}),r.y+1<d&&(P[new o.S(t.overscaledZ,y,r.z,h,r.y+1).key]={backfilled:!1},P[new o.S(t.overscaledZ,t.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},P[new o.S(t.overscaledZ,S,r.z,x,r.y+1).key]={backfilled:!1}),P}unloadTile(t){return o._(this,void 0,void 0,function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))})}}class Bt extends o.E{constructor(t,r,d,h){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=d.getActor(),this.setEventedParent(h),this._data=r.data,this._options=o.e({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId,r.clusterMaxZoom!==void 0&&this.maxzoom<=r.clusterMaxZoom&&o.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${r.clusterMaxZoom}".`),this.workerOptions=o.e({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(r.buffer!==void 0?r.buffer:128),tolerance:this._pixelsToTileUnits(r.tolerance!==void 0?r.tolerance:.375),extent:o.X,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:o.X,radius:this._pixelsToTileUnits(r.clusterRadius||50),log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(t){return t*(o.X/this.tileSize)}load(){return o._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}getData(){return o._(this,void 0,void 0,function*(){const t=o.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})})}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(t.clusterRadius)),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=t.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,r,d){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:r,offset:d}})}_updateWorkerData(t){return o._(this,void 0,void 0,function*(){const r=o.e({type:this.type},this.workerOptions);t?r.dataDiff=t:typeof this._data=="string"?(r.request=this.map._requestManager.transformRequest(O.resolveURL(this._data),"Source"),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new o.k("dataloading",{dataType:"source"}));try{const d=yield this.actor.sendAsync({type:"LD",data:r});if(this._pendingLoads--,this._removed||d.abandoned)return void this.fire(new o.k("dataabort",{dataType:"source"}));let h=null;d.resourceTiming&&d.resourceTiming[this.id]&&(h=d.resourceTiming[this.id].slice(0));const y={dataType:"source"};this._collectResourceTiming&&h&&h.length>0&&o.e(y,{resourceTiming:h}),this.fire(new o.k("data",Object.assign(Object.assign({},y),{sourceDataType:"metadata"}))),this.fire(new o.k("data",Object.assign(Object.assign({},y),{sourceDataType:"content"})))}catch(d){if(this._pendingLoads--,this._removed)return void this.fire(new o.k("dataabort",{dataType:"source"}));this.fire(new o.j(d))}})}loaded(){return this._pendingLoads===0}loadTile(t){return o._(this,void 0,void 0,function*(){const r=t.actor?"RT":"LT";t.actor=this.actor;const d={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};t.abortController=new AbortController;const h=yield this.actor.sendAsync({type:r,data:d},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(h,this.map.painter,r==="RT")})}abortTile(t){return o._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0})}unloadTile(t){return o._(this,void 0,void 0,function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class It extends o.E{constructor(t,r,d,h){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=d,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(h),this.options=r}load(t){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const r=yield me.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,r&&r.data&&(this.image=r.data,t&&(this.coordinates=t),this._finishLoading())}catch(r){this._request=null,this._loaded=!0,this.fire(new o.j(r))}})}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const r=t.map(o.Y.fromLngLat);var d;return this.tileID=function(h){let y=1/0,x=1/0,S=-1/0,P=-1/0;for(const j of h)y=Math.min(y,j.x),x=Math.min(x,j.y),S=Math.max(S,j.x),P=Math.max(P,j.y);const A=Math.max(S-y,P-x),F=Math.max(0,Math.floor(-Math.log(A)/Math.LN2)),N=Math.pow(2,F);return new o.Z(F,Math.floor((y+S)/2*N),Math.floor((x+P)/2*N))}(r),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=r.map(h=>this.tileID.getTilePoint(h)._round()),this.flippedWindingOrder=((d=this.tileCoords)[1].x-d[0].x)*(d[2].y-d[0].y)-(d[1].y-d[0].y)*(d[2].x-d[0].x)<0,this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,r=t.gl;this.texture||(this.texture=new ye(t,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let d=!1;for(const h in this.tiles){const y=this.tiles[h];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,d=!0)}d&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return o._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Rt extends It{constructor(t,r,d,h){super(t,r,d,h),this.roundZoom=!0,this.type="video",this.options=r}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const r of t.urls)this.urls.push(this.map._requestManager.transformRequest(r,"Source").url);try{const r=yield o.a0(this.urls);if(this._loaded=!0,!r)return;this.video=r,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(r){this.fire(new o.j(r))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const r=this.video.seekable;t<r.start(0)||t>r.end(0)?this.fire(new o.j(new o.$(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,r=t.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new ye(t,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let d=!1;for(const h in this.tiles){const y=this.tiles[h];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,d=!0)}d&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class wt extends It{constructor(t,r,d,h){super(t,r,d,h),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(x=>typeof x!="number"))||this.fire(new o.j(new o.$(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.j(new o.$(`sources.${t}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new o.j(new o.$(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new o.j(new o.$(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.j(new o.$(`sources.${t}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){return o._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context,d=r.gl;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ye(r,this.canvas,d.RGBA,{premultiply:!0});let h=!1;for(const y in this.tiles){const x=this.tiles[y];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,h=!0)}h&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const tn={},$t=_=>{switch(_){case"geojson":return Bt;case"image":return It;case"raster":return gt;case"raster-dem":return vt;case"vector":return xt;case"video":return Rt;case"canvas":return wt}return tn[_]},Xt="RTLPluginLoaded";class dn extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=bn()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch(r=>{throw this.status="error",r})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return o._(this,arguments,void 0,function*(r,d=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=O.resolveURL(r),!this.url)throw new Error(`requested url ${r} is invalid`);if(this.status==="unavailable"){if(!d)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return o._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.k(Xt))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Sn=null;function Dn(){return Sn||(Sn=new dn),Sn}class An{constructor(t,r){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=o.a1(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const r=t+this.timeAdded;r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,r,d){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(h,y){const x={};if(!y)return x;for(const S of h){const P=S.layerIds.map(A=>y.getLayer(A)).filter(Boolean);if(P.length!==0){S.layers=P,S.stateDependentLayerIds&&(S.stateDependentLayers=S.stateDependentLayerIds.map(A=>P.filter(F=>F.id===A)[0]));for(const A of P)x[A.id]=S}}return x}(t.buckets,r==null?void 0:r.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const y=this.buckets[h];if(y instanceof o.a3){if(this.hasSymbolBuckets=!0,!d)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const y=this.buckets[h];if(y instanceof o.a3&&y.hasRTLText){this.hasRTLText=!0,Dn().lazyLoad();break}}this.queryPadding=0;for(const h in this.buckets){const y=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(h).queryRadius(y))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new o.a2}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const d in this.buckets){const h=this.buckets[d];h.uploadPending()&&h.upload(t)}const r=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ye(t,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ye(t,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,r,d,h,y,x,S,P,A,F){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:h,cameraQueryGeometry:y,scale:x,tileSize:this.tileSize,pixelPosMatrix:F,transform:P,params:S,queryPadding:this.queryPadding*A},t,r,d):{}}querySourceFeatures(t,r){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const h=d.loadVTLayers(),y=r&&r.sourceLayer?r.sourceLayer:"",x=h._geojsonTileLayer||h[y];if(!x)return;const S=o.a4(r&&r.filter),{z:P,x:A,y:F}=this.tileID.canonical,N={z:P,x:A,y:F};for(let j=0;j<x.length;j++){const X=x.feature(j);if(S.needGeometry){const se=o.a5(X,!0);if(!S.filter(new o.z(this.tileID.overscaledZ),se,this.tileID.canonical))continue}else if(!S.filter(new o.z(this.tileID.overscaledZ),X))continue;const J=d.getId(X,y),le=new o.a6(X,P,A,F,J);le.tile=N,t.push(le)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const r=this.expirationTime;if(t.cacheControl){const d=o.a7(t.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const d=Date.now();let h=!1;if(this.expirationTime>d)h=!1;else if(r)if(this.expirationTime<r)h=!0;else{const y=this.expirationTime-r;y?this.expirationTime=d+Math.max(y,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const d=this.latestFeatureIndex.loadVTLayers();for(const h in this.buckets){if(!r.style.hasLayer(h))continue;const y=this.buckets[h],x=y.layers[0].sourceLayer||"_geojsonTileLayer",S=d[x],P=t[x];if(!S||!P||Object.keys(P).length===0)continue;y.update(P,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});const A=r&&r.style&&r.style.getLayer(h);A&&(this.queryPadding=Math.max(this.queryPadding,A.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<O.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=O.now()+t}setDependencies(t,r){const d={};for(const h of r)d[h]=!0;this.dependencies[t]=d}hasDependency(t,r){for(const d of t){const h=this.dependencies[d];if(h){for(const y of r)if(h[y])return!0}}return!1}}class Ei{constructor(t,r){this.max=t,this.onRemove=r,this.reset()}reset(){for(const t in this.data)for(const r of this.data[t])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(t,r,d){const h=t.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const y={value:r,timeout:void 0};if(d!==void 0&&(y.timeout=setTimeout(()=>{this.remove(t,y)},d)),this.data[h].push(y),this.order.push(h),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const r=this.data[t].shift();return r.timeout&&clearTimeout(r.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),r.value}getByKey(t){const r=this.data[t];return r?r[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,r){if(!this.has(t))return this;const d=t.wrapped().key,h=r===void 0?0:this.data[d].indexOf(r),y=this.data[d][h];return this.data[d].splice(h,1),y.timeout&&clearTimeout(y.timeout),this.data[d].length===0&&delete this.data[d],this.onRemove(y.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(t){const r=[];for(const d in this.data)for(const h of this.data[d])t(h.value)||r.push(h);for(const d of r)this.remove(d.value.tileID,d)}}class ki{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,r,d){const h=String(r);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][h]=this.stateChanges[t][h]||{},o.e(this.stateChanges[t][h],d),this.deletedStates[t]===null){this.deletedStates[t]={};for(const y in this.state[t])y!==h&&(this.deletedStates[t][y]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][h]===null){this.deletedStates[t][h]={};for(const y in this.state[t][h])d[y]||(this.deletedStates[t][h][y]=null)}else for(const y in d)this.deletedStates[t]&&this.deletedStates[t][h]&&this.deletedStates[t][h][y]===null&&delete this.deletedStates[t][h][y]}removeFeatureState(t,r,d){if(this.deletedStates[t]===null)return;const h=String(r);if(this.deletedStates[t]=this.deletedStates[t]||{},d&&r!==void 0)this.deletedStates[t][h]!==null&&(this.deletedStates[t][h]=this.deletedStates[t][h]||{},this.deletedStates[t][h][d]=null);else if(r!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][h])for(d in this.deletedStates[t][h]={},this.stateChanges[t][h])this.deletedStates[t][h][d]=null;else this.deletedStates[t][h]=null;else this.deletedStates[t]=null}getState(t,r){const d=String(r),h=o.e({},(this.state[t]||{})[d],(this.stateChanges[t]||{})[d]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const y=this.deletedStates[t][r];if(y===null)return{};for(const x in y)delete h[x]}return h}initializeTileState(t,r){t.setFeatureState(this.state,r)}coalesceChanges(t,r){const d={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const y={};for(const x in this.stateChanges[h])this.state[h][x]||(this.state[h][x]={}),o.e(this.state[h][x],this.stateChanges[h][x]),y[x]=this.state[h][x];d[h]=y}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const y={};if(this.deletedStates[h]===null)for(const x in this.state[h])y[x]={},this.state[h][x]={};else for(const x in this.deletedStates[h]){if(this.deletedStates[h][x]===null)this.state[h][x]={};else for(const S of Object.keys(this.deletedStates[h][x]))delete this.state[h][x][S];y[x]=this.state[h][x]}d[h]=d[h]||{},o.e(d[h],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0)for(const h in t)t[h].setFeatureState(d,r)}}function tr(_,t,r){const d=t.intersectsFrustum(_);if(!r)return d;const h=t.intersectsPlane(r);return d===0||h===0?0:d===2&&h===2?2:1}function Zi(_,t,r,d,h){let y=_;const x=Math.atan(t/r),S=Math.hypot(t,r);return y=_+o.a8(d/S/Math.max(.5,Math.cos(o.aa(h/2)))),y+=1*o.a8(Math.cos(x))/2,y+=o.ab(_-y,-0,0),y}function Er(_,t){const r=(t.roundZoom?Math.round:Math.floor)(_.zoom+o.a8(_.tileSize/t.tileSize));return Math.max(0,r)}function ae(_,t){const r=_.getCameraFrustum(),d=_.getClippingPlane(),h=_.screenPointToMercatorCoordinate(_.getCameraPoint()),y=o.Y.fromLngLat(_.center,_.elevation);h.z=y.z+Math.cos(_.pitchInRadians)*_.cameraToCenterDistance/_.worldSize;const x=_.getCoveringTilesDetailsProvider(),S=x.allowVariableZoom(_,t),P=Er(_,t),A=t.minzoom||0,F=t.maxzoom!==void 0?t.maxzoom:_.maxZoom,N=Math.min(Math.max(0,P),F),j=Math.pow(2,N),X=[j*h.x,j*h.y,0],J=[j*y.x,j*y.y,0],le=Math.hypot(y.x-h.x,y.y-h.y),se=Math.abs(y.z-h.z),ue=Math.hypot(le,se),fe=Ie=>({zoom:0,x:0,y:0,wrap:Ie,fullyVisible:!1}),we=[],Te=[];if(_.renderWorldCopies&&x.allowWorldCopies())for(let Ie=1;Ie<=3;Ie++)we.push(fe(-Ie)),we.push(fe(Ie));for(we.push(fe(0));we.length>0;){const Ie=we.pop(),De=Ie.x,Re=Ie.y;let Ge=Ie.fullyVisible;const Ze={x:De,y:Re,z:Ie.zoom},rt=x.getTileAABB(Ze,Ie.wrap,_.elevation,t);if(!Ge){const St=tr(r,rt,d);if(St===0)continue;Ge=St===2}const lt=x.distanceToTile2d(h.x,h.y,Ze,rt);let et=P;S&&(et=(t.calculateTileZoom||Zi)(_.zoom+o.a8(_.tileSize/t.tileSize),lt,se,ue,_.fov)),et=(t.roundZoom?Math.round:Math.floor)(et),et=Math.max(0,et);const Pt=Math.min(et,F);if(Ie.wrap=x.getWrap(y,Ze,Ie.wrap),Ie.zoom>=Pt){if(Ie.zoom<A)continue;const St=N-Ie.zoom,pt=X[0]-.5-(De<<St),Dt=X[1]-.5-(Re<<St),vn=t.reparseOverscaled?Math.max(Ie.zoom,et):Ie.zoom;Te.push({tileID:new o.S(Ie.zoom===F?vn:Ie.zoom,Ie.wrap,Ie.zoom,De,Re),distanceSq:o.a9([J[0]-.5-De,J[1]-.5-Re]),tileDistanceToCamera:Math.sqrt(pt*pt+Dt*Dt)})}else for(let St=0;St<4;St++)we.push({zoom:Ie.zoom+1,x:(De<<1)+St%2,y:(Re<<1)+(St>>1),wrap:Ie.wrap,fullyVisible:Ge})}return Te.sort((Ie,De)=>Ie.distanceSq-De.distanceSq).map(Ie=>Ie.tileID)}class W extends o.E{constructor(t,r,d){super(),this.id=t,this.dispatcher=d,this.on("data",h=>this._dataHandler(h)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((h,y,x,S)=>{const P=new($t(y.type))(h,y,x,S);if(P.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${P.id}`);return P})(t,r,d,this),this._tiles={},this._cache=new Ei(0,h=>this._unloadTile(h)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ki,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const r=this._tiles[t];if(r.state!=="loaded"&&r.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,r,d){return o._(this,void 0,void 0,function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,r,d)}catch(h){t.state="errored",h.status!==404?this._source.fire(new o.j(h,{tile:t})):this.update(this.transform,this.terrain)}})}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new o.k("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){const d=this._tiles[r];d.upload(t),d.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(Q).map(t=>t.key)}getRenderableIds(t){const r=[];for(const d in this._tiles)this._isIdRenderable(d,t)&&r.push(this._tiles[d]);return t?r.sort((d,h)=>{const y=d.tileID,x=h.tileID,S=new o.P(y.canonical.x,y.canonical.y)._rotate(-this.transform.bearingInRadians),P=new o.P(x.canonical.x,x.canonical.y)._rotate(-this.transform.bearingInRadians);return y.overscaledZ-x.overscaledZ||P.y-S.y||P.x-S.x}).map(d=>d.tileID.key):r.map(d=>d.tileID).sort(Q).map(d=>d.key)}hasRenderableParent(t){const r=this.findLoadedParent(t,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(t,r){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(r||!this._tiles[t].holdingForFade())}reload(t){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)(t||this._tiles[r].state!=="errored")&&this._reloadTile(r,"reloading")}}_reloadTile(t,r){return o._(this,void 0,void 0,function*(){const d=this._tiles[t];d&&(d.state!=="loading"&&(d.state=r),yield this._loadTile(d,t,r))})}_tileLoaded(t,r,d){t.timeAdded=O.now(),d==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(r,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new o.k("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const r=this.getRenderableIds();for(let h=0;h<r.length;h++){const y=r[h];if(t.neighboringTiles&&t.neighboringTiles[y]){const x=this.getTileByID(y);d(t,x),d(x,t)}}function d(h,y){h.needsHillshadePrepare=!0,h.needsTerrainPrepare=!0;let x=y.tileID.canonical.x-h.tileID.canonical.x;const S=y.tileID.canonical.y-h.tileID.canonical.y,P=Math.pow(2,h.tileID.canonical.z),A=y.tileID.key;x===0&&S===0||Math.abs(S)>1||(Math.abs(x)>1&&(Math.abs(x+P)===1?x+=P:Math.abs(x-P)===1&&(x-=P)),y.dem&&h.dem&&(h.dem.backfillBorder(y.dem,x,S),h.neighboringTiles&&h.neighboringTiles[A]&&(h.neighboringTiles[A].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,r,d,h){for(const y in this._tiles){let x=this._tiles[y];if(h[y]||!x.hasData()||x.tileID.overscaledZ<=r||x.tileID.overscaledZ>d)continue;let S=x.tileID;for(;x&&x.tileID.overscaledZ>r+1;){const A=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[A.key],x&&x.hasData()&&(S=A)}let P=S;for(;P.overscaledZ>r;)if(P=P.scaledTo(P.overscaledZ-1),t[P.key]||t[P.canonical.key]){h[S.key]=S;break}}}findLoadedParent(t,r){if(t.key in this._loadedParentTiles){const d=this._loadedParentTiles[t.key];return d&&d.tileID.overscaledZ>=r?d:null}for(let d=t.overscaledZ-1;d>=r;d--){const h=t.scaledTo(d),y=this._getLoadedTile(h);if(y)return y}}findLoadedSibling(t){return this._getLoadedTile(t)}_getLoadedTile(t){const r=this._tiles[t.key];return r&&r.hasData()?r:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const r=Math.ceil(t.width/this._source.tileSize)+1,d=Math.ceil(t.height/this._source.tileSize)+1,h=Math.floor(r*d*(this._maxTileCacheZoomLevels===null?o.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,h):h;this._cache.setMaxSize(y)}handleWrapJump(t){const r=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,r){const d={};for(const h in this._tiles){const y=this._tiles[h];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+r),d[y.tileID.key]=y}this._tiles=d;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(h,this._tiles[h])}}_updateCoveredAndRetainedTiles(t,r,d,h,y,x){const S={},P={},A=Object.keys(t),F=O.now();for(const N of A){const j=t[N],X=this._tiles[N];if(!X||X.fadeEndTime!==0&&X.fadeEndTime<=F)continue;const J=this.findLoadedParent(j,r),le=this.findLoadedSibling(j),se=J||le||null;se&&(this._addTile(se.tileID),S[se.tileID.key]=se.tileID),P[N]=j}this._retainLoadedChildren(P,h,d,t);for(const N in S)t[N]||(this._coveredTiles[N]=!0,t[N]=S[N]);if(x){const N={},j={};for(const X of y)this._tiles[X.key].hasData()?N[X.key]=X:j[X.key]=X;for(const X in j){const J=j[X].children(this._source.maxzoom);this._tiles[J[0].key]&&this._tiles[J[1].key]&&this._tiles[J[2].key]&&this._tiles[J[3].key]&&(N[J[0].key]=t[J[0].key]=J[0],N[J[1].key]=t[J[1].key]=J[1],N[J[2].key]=t[J[2].key]=J[2],N[J[3].key]=t[J[3].key]=J[3],delete j[X])}for(const X in j){const J=j[X],le=this.findLoadedParent(J,this._source.minzoom),se=this.findLoadedSibling(J),ue=le||se||null;if(ue){N[ue.tileID.key]=t[ue.tileID.key]=ue.tileID;for(const fe in N)N[fe].isChildOf(ue.tileID)&&delete N[fe]}}for(const X in this._tiles)N[X]||(this._coveredTiles[X]=!0)}}update(t,r){if(!this._sourceLoaded||this._paused)return;let d;this.transform=t,this.terrain=r,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?d=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(F=>new o.S(F.canonical.z,F.wrap,F.canonical.z,F.canonical.x,F.canonical.y)):(d=ae(t,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:r,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(d=d.filter(F=>this._source.hasTile(F)))):d=[];const h=Er(t,this._source),y=Math.max(h-W.maxOverzooming,this._source.minzoom),x=Math.max(h+W.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const F={};for(const N of d)if(N.canonical.z>this._source.minzoom){const j=N.scaledTo(N.canonical.z-1);F[j.key]=j;const X=N.scaledTo(Math.max(this._source.minzoom,Math.min(N.canonical.z,5)));F[X.key]=X}d=d.concat(Object.values(F))}const S=d.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,S&&this.fire(new o.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const P=this._updateRetainedTiles(d,h);te(this._source.type)&&this._updateCoveredAndRetainedTiles(P,y,x,h,d,r);for(const F in P)this._tiles[F].clearFadeHold();const A=o.ac(this._tiles,P);for(const F of A){const N=this._tiles[F];N.hasSymbolBuckets&&!N.holdingForFade()?N.setHoldDuration(this.map._fadeDuration):N.hasSymbolBuckets&&!N.symbolFadeFinished()||this._removeTile(F)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,r){var d;const h={},y={},x=Math.max(r-W.maxOverzooming,this._source.minzoom),S=Math.max(r+W.maxUnderzooming,this._source.minzoom),P={};for(const A of t){const F=this._addTile(A);h[A.key]=A,F.hasData()||r<this._source.maxzoom&&(P[A.key]=A)}this._retainLoadedChildren(P,r,S,h);for(const A of t){let F=this._tiles[A.key];if(F.hasData())continue;if(r+1>this._source.maxzoom){const j=A.children(this._source.maxzoom)[0],X=this.getTile(j);if(X&&X.hasData()){h[j.key]=j;continue}}else{const j=A.children(this._source.maxzoom);if(h[j[0].key]&&h[j[1].key]&&h[j[2].key]&&h[j[3].key])continue}let N=F.wasRequested();for(let j=A.overscaledZ-1;j>=x;--j){const X=A.scaledTo(j);if(y[X.key])break;if(y[X.key]=!0,F=this.getTile(X),!F&&N&&(F=this._addTile(X)),F){const J=F.hasData();if((J||!(!((d=this.map)===null||d===void 0)&&d.cancelPendingTileRequestsWhileZooming)||N)&&(h[X.key]=X),N=F.wasRequested(),J)break}}}return h}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const r=[];let d,h=this._tiles[t].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){d=this._loadedParentTiles[h.key];break}r.push(h.key);const y=h.scaledTo(h.overscaledZ-1);if(d=this._getLoadedTile(y),d)break;h=y}for(const y of r)this._loadedParentTiles[y]=d}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const t in this._tiles){const r=this._tiles[t].tileID,d=this._getLoadedTile(r);this._loadedSiblingTiles[r.key]=d}}_addTile(t){let r=this._tiles[t.key];if(r)return r;r=this._cache.getAndRemove(t),r&&(this._setTileReloadTimer(t.key,r),r.tileID=t,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,r)));const d=r;return r||(r=new An(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(r,t.key,r.state)),r.uses++,this._tiles[t.key]=r,d||this._source.fire(new o.k("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r}_setTileReloadTimer(t,r){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const d=r.getExpiryTimeout();d&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},d))}_removeTile(t){const r=this._tiles[t];r&&(r.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),r.uses>0||(r.hasData()&&r.state!=="reloading"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}_dataHandler(t){const r=t.sourceDataType;t.dataType==="source"&&r==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&t.dataType==="source"&&r==="content"&&(this.reload(t.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,r,d){const h=[],y=this.transform;if(!y)return h;const x=d?y.getCameraQueryGeometry(t):t,S=t.map(J=>y.screenPointToMercatorCoordinate(J,this.terrain)),P=x.map(J=>y.screenPointToMercatorCoordinate(J,this.terrain)),A=this.getIds();let F=1/0,N=1/0,j=-1/0,X=-1/0;for(const J of P)F=Math.min(F,J.x),N=Math.min(N,J.y),j=Math.max(j,J.x),X=Math.max(X,J.y);for(let J=0;J<A.length;J++){const le=this._tiles[A[J]];if(le.holdingForFade())continue;const se=le.tileID,ue=Math.pow(2,y.zoom-le.tileID.overscaledZ),fe=r*le.queryPadding*o.X/le.tileSize/ue,we=[se.getTilePoint(new o.Y(F,N)),se.getTilePoint(new o.Y(j,X))];if(we[0].x-fe<o.X&&we[0].y-fe<o.X&&we[1].x+fe>=0&&we[1].y+fe>=0){const Te=S.map(De=>se.getTilePoint(De)),Ie=P.map(De=>se.getTilePoint(De));h.push({tile:le,tileID:se,queryGeometry:Te,cameraQueryGeometry:Ie,scale:ue})}}return h}getVisibleCoordinates(t){const r=this.getRenderableIds(t).map(d=>this._tiles[d].tileID);return this.transform&&this.transform.populateCache(r),r}hasTransition(){if(this._source.hasTransition())return!0;if(te(this._source.type)){const t=O.now();for(const r in this._tiles)if(this._tiles[r].fadeEndTime>=t)return!0}return!1}setFeatureState(t,r,d){this._state.updateState(t=t||"_geojsonTileLayer",r,d)}removeFeatureState(t,r,d){this._state.removeFeatureState(t=t||"_geojsonTileLayer",r,d)}getFeatureState(t,r){return this._state.getState(t=t||"_geojsonTileLayer",r)}setDependencies(t,r,d){const h=this._tiles[t];h&&h.setDependencies(r,d)}reloadTilesForDependencies(t,r){for(const d in this._tiles)this._tiles[d].hasDependency(t,r)&&this._reloadTile(d,"reloading");this._cache.filter(d=>!d.hasDependency(t,r))}}function Q(_,t){const r=Math.abs(2*_.wrap)-+(_.wrap<0),d=Math.abs(2*t.wrap)-+(t.wrap<0);return _.overscaledZ-t.overscaledZ||d-r||t.canonical.y-_.canonical.y||t.canonical.x-_.canonical.x}function te(_){return _==="raster"||_==="image"||_==="video"}W.maxOverzooming=10,W.maxUnderzooming=3;class ge{constructor(t,r){this.reset(t,r)}reset(t,r){this.points=t||[],this._distances=[0];for(let d=1;d<this.points.length;d++)this._distances[d]=this._distances[d-1]+this.points[d].dist(this.points[d-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(r||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=o.ab(t,0,1);let r=1,d=this._distances[r];const h=t*this.paddedLength+this.padding;for(;d<h&&r<this._distances.length;)d=this._distances[++r];const y=r-1,x=this._distances[y],S=d-x,P=S>0?(h-x)/S:0;return this.points[y].mult(1-P).add(this.points[r].mult(P))}}function Ae(_,t){let r=!0;return _==="always"||_!=="never"&&t!=="never"||(r=!1),r}class $e{constructor(t,r,d){const h=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(t/d),this.yCellCount=Math.ceil(r/d);for(let x=0;x<this.xCellCount*this.yCellCount;x++)h.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=r,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,r,d,h,y){this._forEachCell(r,d,h,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(r),this.bboxes.push(d),this.bboxes.push(h),this.bboxes.push(y)}insertCircle(t,r,d,h){this._forEachCell(r-h,d-h,r+h,d+h,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(r),this.circles.push(d),this.circles.push(h)}_insertBoxCell(t,r,d,h,y,x){this.boxCells[y].push(x)}_insertCircleCell(t,r,d,h,y,x){this.circleCells[y].push(x)}_query(t,r,d,h,y,x,S){if(d<0||t>this.width||h<0||r>this.height)return[];const P=[];if(t<=0&&r<=0&&this.width<=d&&this.height<=h){if(y)return[{key:null,x1:t,y1:r,x2:d,y2:h}];for(let A=0;A<this.boxKeys.length;A++)P.push({key:this.boxKeys[A],x1:this.bboxes[4*A],y1:this.bboxes[4*A+1],x2:this.bboxes[4*A+2],y2:this.bboxes[4*A+3]});for(let A=0;A<this.circleKeys.length;A++){const F=this.circles[3*A],N=this.circles[3*A+1],j=this.circles[3*A+2];P.push({key:this.circleKeys[A],x1:F-j,y1:N-j,x2:F+j,y2:N+j})}}else this._forEachCell(t,r,d,h,this._queryCell,P,{hitTest:y,overlapMode:x,seenUids:{box:{},circle:{}}},S);return P}query(t,r,d,h){return this._query(t,r,d,h,!1,null)}hitTest(t,r,d,h,y,x){return this._query(t,r,d,h,!0,y,x).length>0}hitTestCircle(t,r,d,h,y){const x=t-d,S=t+d,P=r-d,A=r+d;if(S<0||x>this.width||A<0||P>this.height)return!1;const F=[];return this._forEachCell(x,P,S,A,this._queryCellCircle,F,{hitTest:!0,overlapMode:h,circle:{x:t,y:r,radius:d},seenUids:{box:{},circle:{}}},y),F.length>0}_queryCell(t,r,d,h,y,x,S,P){const{seenUids:A,hitTest:F,overlapMode:N}=S,j=this.boxCells[y];if(j!==null){const J=this.bboxes;for(const le of j)if(!A.box[le]){A.box[le]=!0;const se=4*le,ue=this.boxKeys[le];if(t<=J[se+2]&&r<=J[se+3]&&d>=J[se+0]&&h>=J[se+1]&&(!P||P(ue))&&(!F||!Ae(N,ue.overlapMode))&&(x.push({key:ue,x1:J[se],y1:J[se+1],x2:J[se+2],y2:J[se+3]}),F))return!0}}const X=this.circleCells[y];if(X!==null){const J=this.circles;for(const le of X)if(!A.circle[le]){A.circle[le]=!0;const se=3*le,ue=this.circleKeys[le];if(this._circleAndRectCollide(J[se],J[se+1],J[se+2],t,r,d,h)&&(!P||P(ue))&&(!F||!Ae(N,ue.overlapMode))){const fe=J[se],we=J[se+1],Te=J[se+2];if(x.push({key:ue,x1:fe-Te,y1:we-Te,x2:fe+Te,y2:we+Te}),F)return!0}}}return!1}_queryCellCircle(t,r,d,h,y,x,S,P){const{circle:A,seenUids:F,overlapMode:N}=S,j=this.boxCells[y];if(j!==null){const J=this.bboxes;for(const le of j)if(!F.box[le]){F.box[le]=!0;const se=4*le,ue=this.boxKeys[le];if(this._circleAndRectCollide(A.x,A.y,A.radius,J[se+0],J[se+1],J[se+2],J[se+3])&&(!P||P(ue))&&!Ae(N,ue.overlapMode))return x.push(!0),!0}}const X=this.circleCells[y];if(X!==null){const J=this.circles;for(const le of X)if(!F.circle[le]){F.circle[le]=!0;const se=3*le,ue=this.circleKeys[le];if(this._circlesCollide(J[se],J[se+1],J[se+2],A.x,A.y,A.radius)&&(!P||P(ue))&&!Ae(N,ue.overlapMode))return x.push(!0),!0}}}_forEachCell(t,r,d,h,y,x,S,P){const A=this._convertToXCellCoord(t),F=this._convertToYCellCoord(r),N=this._convertToXCellCoord(d),j=this._convertToYCellCoord(h);for(let X=A;X<=N;X++)for(let J=F;J<=j;J++)if(y.call(this,t,r,d,h,this.xCellCount*J+X,x,S,P))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,r,d,h,y,x){const S=h-t,P=y-r,A=d+x;return A*A>S*S+P*P}_circleAndRectCollide(t,r,d,h,y,x,S){const P=(x-h)/2,A=Math.abs(t-(h+P));if(A>P+d)return!1;const F=(S-y)/2,N=Math.abs(r-(y+F));if(N>F+d)return!1;if(A<=P||N<=F)return!0;const j=A-P,X=N-F;return j*j+X*X<=d*d}}function qe(_,t,r){const d=o.H();if(!_){const{vecSouth:N,vecEast:j}=it(t),X=k();X[0]=j[0],X[1]=j[1],X[2]=N[0],X[3]=N[1],h=X,(F=(x=(y=X)[0])*(A=y[3])-(P=y[2])*(S=y[1]))&&(h[0]=A*(F=1/F),h[1]=-S*F,h[2]=-P*F,h[3]=x*F),d[0]=X[0],d[1]=X[1],d[4]=X[2],d[5]=X[3]}var h,y,x,S,P,A,F;return o.K(d,d,[1/r,1/r,1]),d}function Ve(_,t,r,d){if(_){const h=o.H();if(!t){const{vecSouth:y,vecEast:x}=it(r);h[0]=x[0],h[1]=x[1],h[4]=y[0],h[5]=y[1]}return o.K(h,h,[d,d,1]),h}return r.pixelsToClipSpaceMatrix}function it(_){const t=Math.cos(_.rollInRadians),r=Math.sin(_.rollInRadians),d=Math.cos(_.pitchInRadians),h=Math.cos(_.bearingInRadians),y=Math.sin(_.bearingInRadians),x=o.ad();x[0]=-h*d*r-y*t,x[1]=-y*d*r+h*t;const S=o.ae(x);S<1e-9?o.af(x):o.ag(x,x,1/S);const P=o.ad();P[0]=h*d*t-y*r,P[1]=y*d*t+h*r;const A=o.ae(P);return A<1e-9?o.af(P):o.ag(P,P,1/A),{vecEast:P,vecSouth:x}}function Je(_,t,r,d){let h;d?(h=[_,t,d(_,t),1],o.al(h,h,r)):(h=[_,t,0,1],Vi(h,h,r));const y=h[3];return{point:new o.P(h[0]/y,h[1]/y),signedDistanceFromCamera:y,isOccluded:!1}}function Ue(_,t){return .5+_/t*.5}function Be(_,t){return _.x>=-t[0]&&_.x<=t[0]&&_.y>=-t[1]&&_.y<=t[1]}function kt(_,t,r,d,h,y,x,S,P,A,F,N,j){const X=r?_.textSizeData:_.iconSizeData,J=o.ah(X,t.transform.zoom),le=[256/t.width*2+1,256/t.height*2+1],se=r?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;se.clear();const ue=_.lineVertexArray,fe=r?_.text.placedSymbolArray:_.icon.placedSymbolArray,we=t.transform.width/t.transform.height;let Te=!1;for(let Ie=0;Ie<fe.length;Ie++){const De=fe.get(Ie);if(De.hidden||De.writingMode===o.ai.vertical&&!Te){qi(De.numGlyphs,se);continue}Te=!1;const Re=new o.P(De.anchorX,De.anchorY),Ge={getElevation:j,pitchedLabelPlaneMatrix:d,lineVertexArray:ue,pitchWithMap:y,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:t.transform,tileAnchorPoint:Re,unwrappedTileID:P,width:A,height:F,translation:N},Ze=zn(De.anchorX,De.anchorY,Ge);if(!Be(Ze.point,le)){qi(De.numGlyphs,se);continue}const rt=Ue(t.transform.cameraToCenterDistance,Ze.signedDistanceFromCamera),lt=o.aj(X,J,De),et=y?lt*t.transform.getPitchedTextCorrection(De.anchorX,De.anchorY,P)/rt:lt*rt,Pt=pn({projectionContext:Ge,pitchedLabelPlaneMatrixInverse:h,symbol:De,fontSize:et,flip:!1,keepUpright:x,glyphOffsetArray:_.glyphOffsetArray,dynamicLayoutVertexArray:se,aspectRatio:we,rotateToLine:S});Te=Pt.useVertical,(Pt.notEnoughRoom||Te||Pt.needsFlipping&&pn({projectionContext:Ge,pitchedLabelPlaneMatrixInverse:h,symbol:De,fontSize:et,flip:!0,keepUpright:x,glyphOffsetArray:_.glyphOffsetArray,dynamicLayoutVertexArray:se,aspectRatio:we,rotateToLine:S}).notEnoughRoom)&&qi(De.numGlyphs,se)}r?_.text.dynamicLayoutVertexBuffer.updateData(se):_.icon.dynamicLayoutVertexBuffer.updateData(se)}function Tt(_,t,r,d,h,y,x,S){const P=y.glyphStartIndex+y.numGlyphs,A=y.lineStartIndex,F=y.lineStartIndex+y.lineLength,N=t.getoffsetX(y.glyphStartIndex),j=t.getoffsetX(P-1),X=Ii(_*N,r,d,h,y.segment,A,F,S,x);if(!X)return null;const J=Ii(_*j,r,d,h,y.segment,A,F,S,x);return J?S.projectionCache.anyProjectionOccluded?null:{first:X,last:J}:null}function nn(_,t,r,d){return _===o.ai.horizontal&&Math.abs(r.y-t.y)>Math.abs(r.x-t.x)*d?{useVertical:!0}:(_===o.ai.vertical?t.y<r.y:t.x>r.x)?{needsFlipping:!0}:null}function pn(_){const{projectionContext:t,pitchedLabelPlaneMatrixInverse:r,symbol:d,fontSize:h,flip:y,keepUpright:x,glyphOffsetArray:S,dynamicLayoutVertexArray:P,aspectRatio:A,rotateToLine:F}=_,N=h/24,j=d.lineOffsetX*N,X=d.lineOffsetY*N;let J;if(d.numGlyphs>1){const le=d.glyphStartIndex+d.numGlyphs,se=d.lineStartIndex,ue=d.lineStartIndex+d.lineLength,fe=Tt(N,S,j,X,y,d,F,t);if(!fe)return{notEnoughRoom:!0};const we=Cn(fe.first.point.x,fe.first.point.y,t,r),Te=Cn(fe.last.point.x,fe.last.point.y,t,r);if(x&&!y){const Ie=nn(d.writingMode,we,Te,A);if(Ie)return Ie}J=[fe.first];for(let Ie=d.glyphStartIndex+1;Ie<le-1;Ie++)J.push(Ii(N*S.getoffsetX(Ie),j,X,y,d.segment,se,ue,t,F));J.push(fe.last)}else{if(x&&!y){const se=Ut(t.tileAnchorPoint.x,t.tileAnchorPoint.y,t).point,ue=d.lineStartIndex+d.segment+1,fe=new o.P(t.lineVertexArray.getx(ue),t.lineVertexArray.gety(ue)),we=Ut(fe.x,fe.y,t),Te=we.signedDistanceFromCamera>0?we.point:st(t.tileAnchorPoint,fe,se,1,t),Ie=Cn(se.x,se.y,t,r),De=Cn(Te.x,Te.y,t,r),Re=nn(d.writingMode,Ie,De,A);if(Re)return Re}const le=Ii(N*S.getoffsetX(d.glyphStartIndex),j,X,y,d.segment,d.lineStartIndex,d.lineStartIndex+d.lineLength,t,F);if(!le||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};J=[le]}for(const le of J)o.ak(P,le.point,le.angle);return{}}function st(_,t,r,d,h){const y=_.add(_.sub(t)._unit()),x=Ut(y.x,y.y,h).point,S=r.sub(x);return r.add(S._mult(d/S.mag()))}function At(_,t,r){const d=t.projectionCache;if(d.projections[_])return d.projections[_];const h=new o.P(t.lineVertexArray.getx(_),t.lineVertexArray.gety(_)),y=Ut(h.x,h.y,t);if(y.signedDistanceFromCamera>0)return d.projections[_]=y.point,d.anyProjectionOccluded=d.anyProjectionOccluded||y.isOccluded,y.point;const x=_-r.direction;return st(r.distanceFromAnchor===0?t.tileAnchorPoint:new o.P(t.lineVertexArray.getx(x),t.lineVertexArray.gety(x)),h,r.previousVertex,r.absOffsetX-r.distanceFromAnchor+1,t)}function Ut(_,t,r){const d=_+r.translation[0],h=t+r.translation[1];let y;return r.pitchWithMap?(y=Je(d,h,r.pitchedLabelPlaneMatrix,r.getElevation),y.isOccluded=!1):(y=r.transform.projectTileCoordinates(d,h,r.unwrappedTileID,r.getElevation),y.point.x=(.5*y.point.x+.5)*r.width,y.point.y=(.5*-y.point.y+.5)*r.height),y}function Cn(_,t,r,d){if(r.pitchWithMap){const h=[_,t,0,1];return o.al(h,h,d),r.transform.projectTileCoordinates(h[0]/h[3],h[1]/h[3],r.unwrappedTileID,r.getElevation).point}return{x:_/r.width*2-1,y:t/r.height*2-1}}function zn(_,t,r){return r.transform.projectTileCoordinates(_,t,r.unwrappedTileID,r.getElevation)}function cn(_,t,r){return _._unit()._perp()._mult(t*r)}function Vt(_,t,r,d,h,y,x,S,P){if(S.projectionCache.offsets[_])return S.projectionCache.offsets[_];const A=r.add(t);if(_+P.direction<d||_+P.direction>=h)return S.projectionCache.offsets[_]=A,A;const F=At(_+P.direction,S,P),N=cn(F.sub(r),x,P.direction),j=r.add(N),X=F.add(N);return S.projectionCache.offsets[_]=o.am(y,A,j,X)||A,S.projectionCache.offsets[_]}function Ii(_,t,r,d,h,y,x,S,P){const A=d?_-t:_+t;let F=A>0?1:-1,N=0;d&&(F*=-1,N=Math.PI),F<0&&(N+=Math.PI);let j,X=F>0?y+h:y+h+1;S.projectionCache.cachedAnchorPoint?j=S.projectionCache.cachedAnchorPoint:(j=Ut(S.tileAnchorPoint.x,S.tileAnchorPoint.y,S).point,S.projectionCache.cachedAnchorPoint=j);let J,le,se=j,ue=j,fe=0,we=0;const Te=Math.abs(A),Ie=[];let De;for(;fe+we<=Te;){if(X+=F,X<y||X>=x)return null;fe+=we,ue=se,le=J;const Ze={absOffsetX:Te,direction:F,distanceFromAnchor:fe,previousVertex:ue};if(se=At(X,S,Ze),r===0)Ie.push(ue),De=se.sub(ue);else{let rt;const lt=se.sub(ue);rt=lt.mag()===0?cn(At(X+F,S,Ze).sub(se),r,F):cn(lt,r,F),le||(le=ue.add(rt)),J=Vt(X,rt,se,y,x,le,r,S,Ze),Ie.push(le),De=J.sub(le)}we=De.mag()}const Re=De._mult((Te-fe)/we)._add(le||ue),Ge=N+Math.atan2(se.y-ue.y,se.x-ue.x);return Ie.push(Re),{point:Re,angle:P?Ge:0,path:Ie}}const cs=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function qi(_,t){for(let r=0;r<_;r++){const d=t.length;t.resize(d+4),t.float32.set(cs,3*d)}}function Vi(_,t,r){const d=t[0],h=t[1];return _[0]=r[0]*d+r[4]*h+r[12],_[1]=r[1]*d+r[5]*h+r[13],_[3]=r[3]*d+r[7]*h+r[15],_}const hi=100;class Or{constructor(t,r=new $e(t.width+200,t.height+200,25),d=new $e(t.width+200,t.height+200,25)){this.transform=t,this.grid=r,this.ignoredGrid=d,this.pitchFactor=Math.cos(t.pitch*Math.PI/180)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+hi,this.screenBottomBoundary=t.height+hi,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,r,d,h,y,x,S,P,A,F,N,j){const X=this.projectAndGetPerspectiveRatio(t.anchorPointX+P[0],t.anchorPointY+P[1],y,F,j),J=d*X.perspectiveRatio;let le;if(x||S)le=this._projectCollisionBox(t,J,h,y,x,S,P,X,F,N,j);else{const De=X.x+(N?N.x*J:0),Re=X.y+(N?N.y*J:0);le={allPointsOccluded:!1,box:[De+t.x1*J,Re+t.y1*J,De+t.x2*J,Re+t.y2*J]}}const[se,ue,fe,we]=le.box,Te=x?le.allPointsOccluded:X.isOccluded;let Ie=Te;return Ie||(Ie=X.perspectiveRatio<this.perspectiveRatioCutoff),Ie||(Ie=!this.isInsideGrid(se,ue,fe,we)),Ie||r!=="always"&&this.grid.hitTest(se,ue,fe,we,r,A)?{box:[se,ue,fe,we],placeable:!1,offscreen:!1,occluded:Te}:{box:[se,ue,fe,we],placeable:!0,offscreen:this.isOffscreen(se,ue,fe,we),occluded:Te}}placeCollisionCircles(t,r,d,h,y,x,S,P,A,F,N,j,X,J){const le=[],se=new o.P(r.anchorX,r.anchorY),ue=this.getPerspectiveRatio(se.x,se.y,x,J),fe=(A?y*this.transform.getPitchedTextCorrection(r.anchorX,r.anchorY,x)/ue:y*ue)/o.as,we={getElevation:J,pitchedLabelPlaneMatrix:S,lineVertexArray:d,pitchWithMap:A,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:se,unwrappedTileID:x,width:this.transform.width,height:this.transform.height,translation:X},Te=Tt(fe,h,r.lineOffsetX*fe,r.lineOffsetY*fe,!1,r,!1,we);let Ie=!1,De=!1,Re=!0;if(Te){const Ge=.5*N*ue+j,Ze=new o.P(-100,-100),rt=new o.P(this.screenRightBoundary,this.screenBottomBoundary),lt=new ge,et=Te.first,Pt=Te.last;let St=[];for(let vn=et.path.length-1;vn>=1;vn--)St.push(et.path[vn]);for(let vn=1;vn<Pt.path.length;vn++)St.push(Pt.path[vn]);const pt=2.5*Ge;if(A){const vn=this.projectPathToScreenSpace(St,we);St=vn.some(Bn=>Bn.signedDistanceFromCamera<=0)?[]:vn.map(Bn=>Bn.point)}let Dt=[];if(St.length>0){const vn=St[0].clone(),Bn=St[0].clone();for(let gi=1;gi<St.length;gi++)vn.x=Math.min(vn.x,St[gi].x),vn.y=Math.min(vn.y,St[gi].y),Bn.x=Math.max(Bn.x,St[gi].x),Bn.y=Math.max(Bn.y,St[gi].y);Dt=vn.x>=Ze.x&&Bn.x<=rt.x&&vn.y>=Ze.y&&Bn.y<=rt.y?[St]:Bn.x<Ze.x||vn.x>rt.x||Bn.y<Ze.y||vn.y>rt.y?[]:o.ao([St],Ze.x,Ze.y,rt.x,rt.y)}for(const vn of Dt){lt.reset(vn,.25*Ge);let Bn=0;Bn=lt.length<=.5*Ge?1:Math.ceil(lt.paddedLength/pt)+1;for(let gi=0;gi<Bn;gi++){const Xn=gi/Math.max(Bn-1,1),_i=lt.lerp(Xn),Kn=_i.x+hi,Hn=_i.y+hi;le.push(Kn,Hn,Ge,0);const Yn=Kn-Ge,lr=Hn-Ge,Ni=Kn+Ge,$i=Hn+Ge;if(Re=Re&&this.isOffscreen(Yn,lr,Ni,$i),De=De||this.isInsideGrid(Yn,lr,Ni,$i),t!=="always"&&this.grid.hitTestCircle(Kn,Hn,Ge,t,F)&&(Ie=!0,!P))return{circles:[],offscreen:!1,collisionDetected:Ie}}}}return{circles:!P&&Ie||!De||ue<this.perspectiveRatioCutoff?[]:le,offscreen:Re,collisionDetected:Ie}}projectPathToScreenSpace(t,r){const d=function(h,y){const x=o.H();return o.an(x,y.pitchedLabelPlaneMatrix),h.map(S=>{const P=Je(S.x,S.y,x,y.getElevation),A=y.transform.projectTileCoordinates(P.point.x,P.point.y,y.unwrappedTileID,y.getElevation);return A.point.x=(.5*A.point.x+.5)*y.width,A.point.y=(.5*-A.point.y+.5)*y.height,A})}(t,r);return function(h){let y=0,x=0,S=0,P=0;for(let A=0;A<h.length;A++)h[A].isOccluded?(S=A+1,P=0):(P++,P>x&&(x=P,y=S));return h.slice(y,y+x)}(d)}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const r=[];let d=1/0,h=1/0,y=-1/0,x=-1/0;for(const F of t){const N=new o.P(F.x+hi,F.y+hi);d=Math.min(d,N.x),h=Math.min(h,N.y),y=Math.max(y,N.x),x=Math.max(x,N.y),r.push(N)}const S=this.grid.query(d,h,y,x).concat(this.ignoredGrid.query(d,h,y,x)),P={},A={};for(const F of S){const N=F.key;if(P[N.bucketInstanceId]===void 0&&(P[N.bucketInstanceId]={}),P[N.bucketInstanceId][N.featureIndex])continue;const j=[new o.P(F.x1,F.y1),new o.P(F.x2,F.y1),new o.P(F.x2,F.y2),new o.P(F.x1,F.y2)];o.ap(r,j)&&(P[N.bucketInstanceId][N.featureIndex]=!0,A[N.bucketInstanceId]===void 0&&(A[N.bucketInstanceId]=[]),A[N.bucketInstanceId].push(N.featureIndex))}return A}insertCollisionBox(t,r,d,h,y,x){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:y,collisionGroupID:x,overlapMode:r},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,r,d,h,y,x){const S=d?this.ignoredGrid:this.grid,P={bucketInstanceId:h,featureIndex:y,collisionGroupID:x,overlapMode:r};for(let A=0;A<t.length;A+=4)S.insertCircle(P,t[A],t[A+1],t[A+2])}projectAndGetPerspectiveRatio(t,r,d,h,y){if(y){let x;h?(x=[t,r,h(t,r),1],o.al(x,x,y)):(x=[t,r,0,1],Vi(x,x,y));const S=x[3];return{x:(x[0]/S+1)/2*this.transform.width+hi,y:(-x[1]/S+1)/2*this.transform.height+hi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/S*.5,isOccluded:!1,signedDistanceFromCamera:S}}{const x=this.transform.projectTileCoordinates(t,r,d,h);return{x:(x.point.x+1)/2*this.transform.width+hi,y:(1-x.point.y)/2*this.transform.height+hi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/x.signedDistanceFromCamera*.5,isOccluded:x.isOccluded,signedDistanceFromCamera:x.signedDistanceFromCamera}}}getPerspectiveRatio(t,r,d,h){const y=this.transform.projectTileCoordinates(t,r,d,h);return .5+this.transform.cameraToCenterDistance/y.signedDistanceFromCamera*.5}isOffscreen(t,r,d,h){return d<hi||t>=this.screenRightBoundary||h<hi||r>this.screenBottomBoundary}isInsideGrid(t,r,d,h){return d>=0&&t<this.gridRightBoundary&&h>=0&&r<this.gridBottomBoundary}getViewportMatrix(){const t=o.aq([]);return o.J(t,t,[-100,-100,0]),t}_projectCollisionBox(t,r,d,h,y,x,S,P,A,F,N){let j=1,X=0,J=0,le=1;const se=t.anchorPointX+S[0],ue=t.anchorPointY+S[1];if(x&&!y){const St=this.projectAndGetPerspectiveRatio(se+1,ue,h,A,N),pt=St.x-P.x,Dt=Math.atan((St.y-P.y)/pt)+(pt<0?Math.PI:0),vn=Math.sin(Dt),Bn=Math.cos(Dt);j=Bn,X=vn,J=-vn,le=Bn}else if(!x&&y){const St=it(this.transform);j=St.vecEast[0],X=St.vecEast[1],J=St.vecSouth[0],le=St.vecSouth[1]}let fe=P.x,we=P.y,Te=r;y&&(fe=se,we=ue,Te=Math.pow(2,-(this.transform.zoom-d.overscaledZ)),Te*=this.transform.getPitchedTextCorrection(se,ue,h),F||(Te*=o.ab(.5+P.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),F&&(fe+=j*F.x*Te+J*F.y*Te,we+=X*F.x*Te+le*F.y*Te);const Ie=t.x1*Te,De=t.x2*Te,Re=(Ie+De)/2,Ge=t.y1*Te,Ze=t.y2*Te,rt=(Ge+Ze)/2,lt=[{offsetX:Ie,offsetY:Ge},{offsetX:Re,offsetY:Ge},{offsetX:De,offsetY:Ge},{offsetX:De,offsetY:rt},{offsetX:De,offsetY:Ze},{offsetX:Re,offsetY:Ze},{offsetX:Ie,offsetY:Ze},{offsetX:Ie,offsetY:rt}];let et=[];for(const{offsetX:St,offsetY:pt}of lt)et.push(new o.P(fe+j*St+J*pt,we+X*St+le*pt));let Pt=!1;if(y){const St=et.map(pt=>this.projectAndGetPerspectiveRatio(pt.x,pt.y,h,A,N));Pt=St.some(pt=>!pt.isOccluded),et=St.map(pt=>new o.P(pt.x,pt.y))}else Pt=!0;return{box:o.ar(et),allPointsOccluded:!Pt}}}class fi{constructor(t,r,d,h){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?r:-r))):h&&d?1:0,this.placed=d}isHidden(){return this.opacity===0&&!this.placed}}class el{constructor(t,r,d,h,y){this.text=new fi(t?t.text:null,r,d,y),this.icon=new fi(t?t.icon:null,r,h,y)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class po{constructor(t,r,d){this.text=t,this.icon=r,this.skipFade=d}}class Su{constructor(t,r,d,h,y){this.bucketInstanceId=t,this.featureIndex=r,this.sourceLayerIndex=d,this.bucketIndex=h,this.tileID=y}}class Ms{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const r=++this.maxGroupID;this.collisionGroups[t]={ID:r,predicate:d=>d.collisionGroupID===r}}return this.collisionGroups[t]}}function Es(_,t,r,d,h){const{horizontalAlign:y,verticalAlign:x}=o.ay(_);return new o.P(-(y-.5)*t+d[0]*h,-(x-.5)*r+d[1]*h)}class $h{constructor(t,r,d,h,y){this.transform=t.clone(),this.terrain=r,this.collisionIndex=new Or(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new Ms(h),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const r=this.terrain;return r?(d,h)=>r.getElevation(t,d,h):null}getBucketParts(t,r,d,h){const y=d.getBucket(r),x=d.latestFeatureIndex;if(!y||!x||r.id!==y.layerIds[0])return;const S=d.collisionBoxArray,P=y.layers[0].layout,A=y.layers[0].paint,F=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),N=d.tileSize/o.X,j=d.tileID.toUnwrapped(),X=P.get("text-rotation-alignment")==="map",J=o.at(d,1,this.transform.zoom),le=o.au(this.collisionIndex.transform,d,A.get("text-translate"),A.get("text-translate-anchor")),se=o.au(this.collisionIndex.transform,d,A.get("icon-translate"),A.get("icon-translate-anchor")),ue=qe(X,this.transform,J);this.retainedQueryData[y.bucketInstanceId]=new Su(y.bucketInstanceId,x,y.sourceLayerIndex,y.index,d.tileID);const fe={bucket:y,layout:P,translationText:le,translationIcon:se,unwrappedTileID:j,pitchedLabelPlaneMatrix:ue,scale:F,textPixelRatio:N,holdingForFade:d.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:o.ah(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(h)for(const we of y.sortKeyRanges){const{sortKey:Te,symbolInstanceStart:Ie,symbolInstanceEnd:De}=we;t.push({sortKey:Te,symbolInstanceStart:Ie,symbolInstanceEnd:De,parameters:fe})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:fe})}attemptAnchorPlacement(t,r,d,h,y,x,S,P,A,F,N,j,X,J,le,se,ue,fe,we,Te){const Ie=o.av[t.textAnchor],De=[t.textOffset0,t.textOffset1],Re=Es(Ie,d,h,De,y),Ge=this.collisionIndex.placeCollisionBox(r,j,P,A,F,S,x,se,N.predicate,we,Re,Te);if((!fe||this.collisionIndex.placeCollisionBox(fe,j,P,A,F,S,x,ue,N.predicate,we,Re,Te).placeable)&&Ge.placeable){let Ze;if(this.prevPlacement&&this.prevPlacement.variableOffsets[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID].text&&(Ze=this.prevPlacement.variableOffsets[X.crossTileID].anchor),X.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[X.crossTileID]={textOffset:De,width:d,height:h,anchor:Ie,textBoxScale:y,prevAnchor:Ze},this.markUsedJustification(J,Ie,X,le),J.allowVerticalPlacement&&(this.markUsedOrientation(J,le,X),this.placedOrientations[X.crossTileID]=le),{shift:Re,placedGlyphBoxes:Ge}}}placeLayerBucketPart(t,r,d){const{bucket:h,layout:y,translationText:x,translationIcon:S,unwrappedTileID:P,pitchedLabelPlaneMatrix:A,textPixelRatio:F,holdingForFade:N,collisionBoxArray:j,partiallyEvaluatedTextSize:X,collisionGroup:J}=t.parameters,le=y.get("text-optional"),se=y.get("icon-optional"),ue=o.aw(y,"text-overlap","text-allow-overlap"),fe=ue==="always",we=o.aw(y,"icon-overlap","icon-allow-overlap"),Te=we==="always",Ie=y.get("text-rotation-alignment")==="map",De=y.get("text-pitch-alignment")==="map",Re=y.get("icon-text-fit")!=="none",Ge=y.get("symbol-z-order")==="viewport-y",Ze=fe&&(Te||!h.hasIconData()||se),rt=Te&&(fe||!h.hasTextData()||le);!h.collisionArrays&&j&&h.deserializeCollisionBoxes(j);const lt=this.retainedQueryData[h.bucketInstanceId].tileID,et=this._getTerrainElevationFunc(lt),Pt=this.transform.getFastPathSimpleProjectionMatrix(lt),St=(pt,Dt,vn)=>{var Bn,gi;if(r[pt.crossTileID])return;if(N)return void(this.placements[pt.crossTileID]=new po(!1,!1,!1));let Xn=!1,_i=!1,Kn=!0,Hn=null,Yn={box:null,placeable:!1,offscreen:null,occluded:!1},lr={box:null,placeable:!1,offscreen:null},Ni=null,$i=null,Sr=null,Xa=0,Ra=0,Nr=0;Dt.textFeatureIndex?Xa=Dt.textFeatureIndex:pt.useRuntimeCollisionCircles&&(Xa=pt.featureIndex),Dt.verticalTextFeatureIndex&&(Ra=Dt.verticalTextFeatureIndex);const Ka=Dt.textBox;if(Ka){const Rr=Jn=>{let yi=o.ai.horizontal;if(h.allowVerticalPlacement&&!Jn&&this.prevPlacement){const jr=this.prevPlacement.placedOrientations[pt.crossTileID];jr&&(this.placedOrientations[pt.crossTileID]=jr,yi=jr,this.markUsedOrientation(h,yi,pt))}return yi},na=(Jn,yi)=>{if(h.allowVerticalPlacement&&pt.numVerticalGlyphVertices>0&&Dt.verticalTextBox){for(const jr of h.writingModes)if(jr===o.ai.vertical?(Yn=yi(),lr=Yn):Yn=Jn(),Yn&&Yn.placeable)break}else Yn=Jn()},ia=pt.textAnchorOffsetStartIndex,$r=pt.textAnchorOffsetEndIndex;if($r===ia){const Jn=(yi,jr)=>{const xi=this.collisionIndex.placeCollisionBox(yi,ue,F,lt,P,De,Ie,x,J.predicate,et,void 0,Pt);return xi&&xi.placeable&&(this.markUsedOrientation(h,jr,pt),this.placedOrientations[pt.crossTileID]=jr),xi};na(()=>Jn(Ka,o.ai.horizontal),()=>{const yi=Dt.verticalTextBox;return h.allowVerticalPlacement&&pt.numVerticalGlyphVertices>0&&yi?Jn(yi,o.ai.vertical):{box:null,offscreen:null}}),Rr(Yn&&Yn.placeable)}else{let Jn=o.av[(gi=(Bn=this.prevPlacement)===null||Bn===void 0?void 0:Bn.variableOffsets[pt.crossTileID])===null||gi===void 0?void 0:gi.anchor];const yi=(xi,rg,Nf)=>{const xd=xi.x2-xi.x1,$f=xi.y2-xi.y1,Zs=pt.textBoxScale,qs=Re&&we==="never"?rg:null;let ms=null,jf=ue==="never"?1:2,Nc="never";Jn&&jf++;for(let wd=0;wd<jf;wd++){for(let Sd=ia;Sd<$r;Sd++){const Cd=h.textAnchorOffsets.get(Sd);if(Jn&&Cd.textAnchor!==Jn)continue;const Td=this.attemptAnchorPlacement(Cd,xi,xd,$f,Zs,Ie,De,F,lt,P,J,Nc,pt,h,Nf,x,S,qs,et);if(Td&&(ms=Td.placedGlyphBoxes,ms&&ms.placeable))return Xn=!0,Hn=Td.shift,ms}Jn?Jn=null:Nc=ue}return d&&!ms&&(ms={box:this.collisionIndex.placeCollisionBox(Ka,"always",F,lt,P,De,Ie,x,J.predicate,et,void 0,Pt).box,offscreen:!1,placeable:!1,occluded:!1}),ms};na(()=>yi(Ka,Dt.iconBox,o.ai.horizontal),()=>{const xi=Dt.verticalTextBox;return h.allowVerticalPlacement&&(!Yn||!Yn.placeable)&&pt.numVerticalGlyphVertices>0&&xi?yi(xi,Dt.verticalIconBox,o.ai.vertical):{box:null,occluded:!0,offscreen:null}}),Yn&&(Xn=Yn.placeable,Kn=Yn.offscreen);const jr=Rr(Yn&&Yn.placeable);if(!Xn&&this.prevPlacement){const xi=this.prevPlacement.variableOffsets[pt.crossTileID];xi&&(this.variableOffsets[pt.crossTileID]=xi,this.markUsedJustification(h,xi.anchor,pt,jr))}}}if(Ni=Yn,Xn=Ni&&Ni.placeable,Kn=Ni&&Ni.offscreen,pt.useRuntimeCollisionCircles){const Rr=h.text.placedSymbolArray.get(pt.centerJustifiedTextSymbolIndex),na=o.aj(h.textSizeData,X,Rr),ia=y.get("text-padding");$i=this.collisionIndex.placeCollisionCircles(ue,Rr,h.lineVertexArray,h.glyphOffsetArray,na,P,A,d,De,J.predicate,pt.collisionCircleDiameter,ia,x,et),$i.circles.length&&$i.collisionDetected&&!d&&o.w("Collisions detected, but collision boxes are not shown"),Xn=fe||$i.circles.length>0&&!$i.collisionDetected,Kn=Kn&&$i.offscreen}if(Dt.iconFeatureIndex&&(Nr=Dt.iconFeatureIndex),Dt.iconBox){const Rr=na=>this.collisionIndex.placeCollisionBox(na,we,F,lt,P,De,Ie,S,J.predicate,et,Re&&Hn?Hn:void 0,Pt);lr&&lr.placeable&&Dt.verticalIconBox?(Sr=Rr(Dt.verticalIconBox),_i=Sr.placeable):(Sr=Rr(Dt.iconBox),_i=Sr.placeable),Kn=Kn&&Sr.offscreen}const Il=le||pt.numHorizontalGlyphVertices===0&&pt.numVerticalGlyphVertices===0,Ml=se||pt.numIconVertices===0;Il||Ml?Ml?Il||(_i=_i&&Xn):Xn=_i&&Xn:_i=Xn=_i&&Xn;const zo=_i&&Sr.placeable;if(Xn&&Ni.placeable&&this.collisionIndex.insertCollisionBox(Ni.box,ue,y.get("text-ignore-placement"),h.bucketInstanceId,lr&&lr.placeable&&Ra?Ra:Xa,J.ID),zo&&this.collisionIndex.insertCollisionBox(Sr.box,we,y.get("icon-ignore-placement"),h.bucketInstanceId,Nr,J.ID),$i&&Xn&&this.collisionIndex.insertCollisionCircles($i.circles,ue,y.get("text-ignore-placement"),h.bucketInstanceId,Xa,J.ID),d&&this.storeCollisionData(h.bucketInstanceId,vn,Dt,Ni,Sr,$i),pt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(h.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[pt.crossTileID]=new po((Xn||Ze)&&!(Ni!=null&&Ni.occluded),(_i||rt)&&!(Sr!=null&&Sr.occluded),Kn||h.justReloaded),r[pt.crossTileID]=!0};if(Ge){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const pt=h.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Dt=pt.length-1;Dt>=0;--Dt){const vn=pt[Dt];St(h.symbolInstances.get(vn),h.collisionArrays[vn],vn)}}else for(let pt=t.symbolInstanceStart;pt<t.symbolInstanceEnd;pt++)St(h.symbolInstances.get(pt),h.collisionArrays[pt],pt);h.justReloaded=!1}storeCollisionData(t,r,d,h,y,x){if(d.textBox||d.iconBox){let S,P;this.collisionBoxArrays.has(t)?S=this.collisionBoxArrays.get(t):(S=new Map,this.collisionBoxArrays.set(t,S)),S.has(r)?P=S.get(r):(P={text:null,icon:null},S.set(r,P)),d.textBox&&(P.text=h.box),d.iconBox&&(P.icon=y.box)}if(x){let S=this.collisionCircleArrays[t];S===void 0&&(S=this.collisionCircleArrays[t]=[]);for(let P=0;P<x.circles.length;P+=4)S.push(x.circles[P+0]-hi),S.push(x.circles[P+1]-hi),S.push(x.circles[P+2]),S.push(x.collisionDetected?1:0)}}markUsedJustification(t,r,d,h){let y;y=h===o.ai.vertical?d.verticalPlacedTextSymbolIndex:{left:d.leftJustifiedTextSymbolIndex,center:d.centerJustifiedTextSymbolIndex,right:d.rightJustifiedTextSymbolIndex}[o.ax(r)];const x=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex,d.verticalPlacedTextSymbolIndex];for(const S of x)S>=0&&(t.text.placedSymbolArray.get(S).crossTileID=y>=0&&S!==y?0:d.crossTileID)}markUsedOrientation(t,r,d){const h=r===o.ai.horizontal||r===o.ai.horizontalOnly?r:0,y=r===o.ai.vertical?r:0,x=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex];for(const S of x)t.text.placedSymbolArray.get(S).placedOrientation=h;d.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(d.verticalPlacedTextSymbolIndex).placedOrientation=y)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const r=this.prevPlacement;let d=!1;this.prevZoomAdjustment=r?r.zoomAdjustment(this.transform.zoom):0;const h=r?r.symbolFadeChange(t):1,y=r?r.opacities:{},x=r?r.variableOffsets:{},S=r?r.placedOrientations:{};for(const P in this.placements){const A=this.placements[P],F=y[P];F?(this.opacities[P]=new el(F,h,A.text,A.icon),d=d||A.text!==F.text.placed||A.icon!==F.icon.placed):(this.opacities[P]=new el(null,h,A.text,A.icon,A.skipFade),d=d||A.text||A.icon)}for(const P in y){const A=y[P];if(!this.opacities[P]){const F=new el(A,h,!1,!1);F.isHidden()||(this.opacities[P]=F,d=d||A.text.placed||A.icon.placed)}}for(const P in x)this.variableOffsets[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.variableOffsets[P]=x[P]);for(const P in S)this.placedOrientations[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.placedOrientations[P]=S[P]);if(r&&r.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");d?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:t)}updateLayerOpacities(t,r){const d={};for(const h of r){const y=h.getBucket(t);y&&h.latestFeatureIndex&&t.id===y.layerIds[0]&&this.updateBucketOpacities(y,h.tileID,d,h.collisionBoxArray)}}updateBucketOpacities(t,r,d,h){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const y=t.layers[0],x=y.layout,S=new el(null,0,!1,!1,!0),P=x.get("text-allow-overlap"),A=x.get("icon-allow-overlap"),F=y._unevaluatedLayout.hasValue("text-variable-anchor")||y._unevaluatedLayout.hasValue("text-variable-anchor-offset"),N=x.get("text-rotation-alignment")==="map",j=x.get("text-pitch-alignment")==="map",X=x.get("icon-text-fit")!=="none",J=new el(null,0,P&&(A||!t.hasIconData()||x.get("icon-optional")),A&&(P||!t.hasTextData()||x.get("text-optional")),!0);!t.collisionArrays&&h&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(h);const le=(ue,fe,we)=>{for(let Te=0;Te<fe/4;Te++)ue.opacityVertexArray.emplaceBack(we);ue.hasVisibleVertices=ue.hasVisibleVertices||we!==As},se=this.collisionBoxArrays.get(t.bucketInstanceId);for(let ue=0;ue<t.symbolInstances.length;ue++){const fe=t.symbolInstances.get(ue),{numHorizontalGlyphVertices:we,numVerticalGlyphVertices:Te,crossTileID:Ie}=fe;let De=this.opacities[Ie];d[Ie]?De=S:De||(De=J,this.opacities[Ie]=De),d[Ie]=!0;const Re=fe.numIconVertices>0,Ge=this.placedOrientations[fe.crossTileID],Ze=Ge===o.ai.vertical,rt=Ge===o.ai.horizontal||Ge===o.ai.horizontalOnly;if(we>0||Te>0){const et=Tu(De.text);le(t.text,we,Ze?As:et),le(t.text,Te,rt?As:et);const Pt=De.text.isHidden();[fe.rightJustifiedTextSymbolIndex,fe.centerJustifiedTextSymbolIndex,fe.leftJustifiedTextSymbolIndex].forEach(Dt=>{Dt>=0&&(t.text.placedSymbolArray.get(Dt).hidden=Pt||Ze?1:0)}),fe.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(fe.verticalPlacedTextSymbolIndex).hidden=Pt||rt?1:0);const St=this.variableOffsets[fe.crossTileID];St&&this.markUsedJustification(t,St.anchor,fe,Ge);const pt=this.placedOrientations[fe.crossTileID];pt&&(this.markUsedJustification(t,"left",fe,pt),this.markUsedOrientation(t,pt,fe))}if(Re){const et=Tu(De.icon),Pt=!(X&&fe.verticalPlacedIconSymbolIndex&&Ze);fe.placedIconSymbolIndex>=0&&(le(t.icon,fe.numIconVertices,Pt?et:As),t.icon.placedSymbolArray.get(fe.placedIconSymbolIndex).hidden=De.icon.isHidden()),fe.verticalPlacedIconSymbolIndex>=0&&(le(t.icon,fe.numVerticalIconVertices,Pt?As:et),t.icon.placedSymbolArray.get(fe.verticalPlacedIconSymbolIndex).hidden=De.icon.isHidden())}const lt=se&&se.has(ue)?se.get(ue):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const et=t.collisionArrays[ue];if(et){let Pt=new o.P(0,0);if(et.textBox||et.verticalTextBox){let St=!0;if(F){const pt=this.variableOffsets[Ie];pt?(Pt=Es(pt.anchor,pt.width,pt.height,pt.textOffset,pt.textBoxScale),N&&Pt._rotate(j?-this.transform.bearingInRadians:this.transform.bearingInRadians)):St=!1}if(et.textBox||et.verticalTextBox){let pt;et.textBox&&(pt=Ze),et.verticalTextBox&&(pt=rt),Cu(t.textCollisionBox.collisionVertexArray,De.text.placed,!St||pt,lt.text,Pt.x,Pt.y)}}if(et.iconBox||et.verticalIconBox){const St=!!(!rt&&et.verticalIconBox);let pt;et.iconBox&&(pt=St),et.verticalIconBox&&(pt=!St),Cu(t.iconCollisionBox.collisionVertexArray,De.icon.placed,pt,lt.icon,X?Pt.x:0,X?Pt.y:0)}}}}if(t.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);t.bucketInstanceId in this.collisionCircleArrays&&(t.collisionCircleArray=this.collisionCircleArrays[t.bucketInstanceId],delete this.collisionCircleArrays[t.bucketInstanceId])}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,r){const d=this.zoomAtLastRecencyCheck===r?1-this.zoomAdjustment(r):1;return this.zoomAtLastRecencyCheck=r,this.commitTime+this.fadeDuration*d>t}setStale(){this.stale=!0}}function Cu(_,t,r,d,h,y){d&&d.length!==0||(d=[0,0,0,0]);const x=d[0]-hi,S=d[1]-hi,P=d[2]-hi,A=d[3]-hi;_.emplaceBack(t?1:0,r?1:0,h||0,y||0,x,S),_.emplaceBack(t?1:0,r?1:0,h||0,y||0,P,S),_.emplaceBack(t?1:0,r?1:0,h||0,y||0,P,A),_.emplaceBack(t?1:0,r?1:0,h||0,y||0,x,A)}const jh=Math.pow(2,25),mo=Math.pow(2,24),Uh=Math.pow(2,17),Om=Math.pow(2,16),Vm=Math.pow(2,9),Nm=Math.pow(2,8),Gh=Math.pow(2,1);function Tu(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;const t=_.placed?1:0,r=Math.floor(127*_.opacity);return r*jh+t*mo+r*Uh+t*Om+r*Vm+t*Nm+r*Gh+t}const As=0;class Pu{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,r,d,h,y){const x=this._bucketParts;for(;this._currentTileIndex<t.length;)if(r.getBucketParts(x,h,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort((S,P)=>S.sortKey-P.sortKey));this._currentPartIndex<x.length;)if(r.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,d),this._currentPartIndex++,y())return!0;return!1}}class Hh{constructor(t,r,d,h,y,x,S,P){this.placement=new $h(t,r,x,S,P),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(t,r,d){const h=O.now(),y=()=>!this._forceFullPlacement&&O.now()-h>2;for(;this._currentPlacementIndex>=0;){const x=r[t[this._currentPlacementIndex]],S=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=S)&&(!x.maxzoom||x.maxzoom>S)){if(this._inProgressLayer||(this._inProgressLayer=new Pu(x)),this._inProgressLayer.continuePlacement(d[x.source],this.placement,this._showCollisionBoxes,x,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Rs=512/o.X/2;class ku{constructor(t,r,d){this.tileID=t,this.bucketInstanceId=d,this._symbolsByKey={};const h=new Map;for(let y=0;y<r.length;y++){const x=r.get(y),S=x.key,P=h.get(S);P?P.push(x):h.set(S,[x])}for(const[y,x]of h){const S={positions:x.map(P=>({x:Math.floor(P.anchorX*Rs),y:Math.floor(P.anchorY*Rs)})),crossTileIDs:x.map(P=>P.crossTileID)};if(S.positions.length>128){const P=new o.az(S.positions.length,16,Uint16Array);for(const{x:A,y:F}of S.positions)P.add(A,F);P.finish(),delete S.positions,S.index=P}this._symbolsByKey[y]=S}}getScaledCoordinates(t,r){const{x:d,y:h,z:y}=this.tileID.canonical,{x,y:S,z:P}=r.canonical,A=Rs/Math.pow(2,P-y),F=(S*o.X+t.anchorY)*A,N=h*o.X*Rs;return{x:Math.floor((x*o.X+t.anchorX)*A-d*o.X*Rs),y:Math.floor(F-N)}}findMatches(t,r,d){const h=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z);for(let y=0;y<t.length;y++){const x=t.get(y);if(x.crossTileID)continue;const S=this._symbolsByKey[x.key];if(!S)continue;const P=this.getScaledCoordinates(x,r);if(S.index){const A=S.index.range(P.x-h,P.y-h,P.x+h,P.y+h).sort();for(const F of A){const N=S.crossTileIDs[F];if(!d[N]){d[N]=!0,x.crossTileID=N;break}}}else if(S.positions)for(let A=0;A<S.positions.length;A++){const F=S.positions[A],N=S.crossTileIDs[A];if(Math.abs(F.x-P.x)<=h&&Math.abs(F.y-P.y)<=h&&!d[N]){d[N]=!0,x.crossTileID=N;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:t})=>t)}}class ic{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Zh{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const r=Math.round((t-this.lng)/360);if(r!==0)for(const d in this.indexes){const h=this.indexes[d],y={};for(const x in h){const S=h[x];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+r),y[S.tileID.key]=S}this.indexes[d]=y}this.lng=t}addBucket(t,r,d){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===r.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let y=0;y<r.symbolInstances.length;y++)r.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const h=this.usedCrossTileIDs[t.overscaledZ];for(const y in this.indexes){const x=this.indexes[y];if(Number(y)>t.overscaledZ)for(const S in x){const P=x[S];P.tileID.isChildOf(t)&&P.findMatches(r.symbolInstances,t,h)}else{const S=x[t.scaledTo(Number(y)).key];S&&S.findMatches(r.symbolInstances,t,h)}}for(let y=0;y<r.symbolInstances.length;y++){const x=r.symbolInstances.get(y);x.crossTileID||(x.crossTileID=d.generate(),h[x.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new ku(t,r.symbolInstances,r.bucketInstanceId),!0}removeBucketCrossTileIDs(t,r){for(const d of r.getCrossTileIDsLists())for(const h of d)delete this.usedCrossTileIDs[t][h]}removeStaleBuckets(t){let r=!1;for(const d in this.indexes){const h=this.indexes[d];for(const y in h)t[h[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(d,h[y]),delete h[y],r=!0)}return r}}class Ds{constructor(){this.layerIndexes={},this.crossTileIDs=new ic,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,r,d){let h=this.layerIndexes[t.id];h===void 0&&(h=this.layerIndexes[t.id]=new Zh);let y=!1;const x={};h.handleWrapJump(d);for(const S of r){const P=S.getBucket(t);P&&t.id===P.layerIds[0]&&(P.bucketInstanceId||(P.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(S.tileID,P,this.crossTileIDs)&&(y=!0),x[P.bucketInstanceId]=!0)}return h.removeStaleBuckets(x)&&(y=!0),y}pruneUnusedLayers(t){const r={};t.forEach(d=>{r[d]=!0});for(const d in this.layerIndexes)r[d]||delete this.layerIndexes[d]}}var Iu="void main() {fragColor=vec4(1.0);}";const ka={prelude:Tn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Tn("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Tn("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Tn(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Tn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Tn(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Tn(Iu,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Tn(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Tn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Tn("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Tn("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Tn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Tn(Iu,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Tn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Tn(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Tn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Tn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Tn(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Tn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Tn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));fragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Tn(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Tn(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Tn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Tn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Tn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Tn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Tn(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Tn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Tn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Tn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Tn("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Tn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Tn("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Tn(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Tn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Tn(_,t){const r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d=t.match(/in ([\w]+) ([\w]+)/g),h=_.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=y?y.concat(h):h,S={};return{fragmentSource:_=_.replace(r,(P,A,F,N,j)=>(S[j]=!0,A==="define"?`
#ifndef HAS_UNIFORM_u_${j}
in ${F} ${N} ${j};
#else
uniform ${F} ${N} u_${j};
#endif
`:`
#ifdef HAS_UNIFORM_u_${j}
    ${F} ${N} ${j} = u_${j};
#endif
`)),vertexSource:t=t.replace(r,(P,A,F,N,j)=>{const X=N==="float"?"vec2":"vec4",J=j.match(/color/)?"color":X;return S[j]?A==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
in ${F} ${X} a_${j};
out ${F} ${N} ${j};
#else
uniform ${F} ${N} u_${j};
#endif
`:J==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = a_${j};
#else
    ${F} ${N} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = unpack_mix_${J}(a_${j}, u_${j}_t);
#else
    ${F} ${N} ${j} = u_${j};
#endif
`:A==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
in ${F} ${X} a_${j};
#else
uniform ${F} ${N} u_${j};
#endif
`:J==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${F} ${N} ${j} = a_${j};
#else
    ${F} ${N} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${F} ${N} ${j} = unpack_mix_${J}(a_${j}, u_${j}_t);
#else
    ${F} ${N} ${j} = u_${j};
#endif
`}),staticAttributes:d,staticUniforms:x}}class Ia{constructor(t,r,d){this.vertexBuffer=t,this.indexBuffer=r,this.segments=d}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Pn=o.aA([{name:"a_pos",type:"Int16",components:2}]);const rc="#define PROJECTION_MERCATOR",qh="mercator";class tl{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return qh}get shaderDefine(){return rc}get shaderPreludeCode(){return ka.projectionMercator}get vertexShaderPreludeCode(){return ka.projectionMercator.vertexSource}get subdivisionGranularity(){return o.aB.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,r,d,h,y){if(this._cachedMesh)return this._cachedMesh;const x=new o.aC;x.emplaceBack(0,0),x.emplaceBack(o.X,0),x.emplaceBack(0,o.X),x.emplaceBack(o.X,o.X);const S=t.createVertexBuffer(x,Pn.members),P=o.aD.simpleSegment(0,0,4,2),A=new o.aE;A.emplaceBack(1,0,2),A.emplaceBack(1,2,3);const F=t.createIndexBuffer(A);return this._cachedMesh=new Ia(S,F,P),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}}function Ai(_,t){const r=o.ab(t.lat,-85.051129,o.aF);return new o.P(o.O(t.lng)*_,o.Q(r)*_)}function Wi(_,t){return new o.Y(t.x/_,t.y/_).toLngLat()}function bi(_){return _.cameraToCenterDistance*Math.min(.85*Math.tan(o.aa(90-_.pitch)),Math.tan(o.aa(89.25-_.pitch)))}function Mu(_,t){const r=_.canonical,d=t/o.aG(r.z),h=r.x+Math.pow(2,r.z)*_.wrap,y=o.aq(new Float64Array(16));return o.J(y,y,[h*d,r.y*d,0]),o.K(y,y,[d/o.X,d/o.X,1]),y}function mr(_,t,r,d,h){const y=o.Y.fromLngLat(_,t),x=h*o.aH(1,_.lat),S=x*Math.cos(o.aa(r)),P=Math.sqrt(x*x-S*S),A=P*Math.sin(o.aa(-d)),F=P*Math.cos(o.aa(-d));return new o.Y(y.x+A,y.y+F,y.z+S)}class gr{constructor(t=0,r=0,d=0,h=0){if(isNaN(t)||t<0||isNaN(r)||r<0||isNaN(d)||d<0||isNaN(h)||h<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=r,this.left=d,this.right=h}interpolate(t,r,d){return r.top!=null&&t.top!=null&&(this.top=o.y.number(t.top,r.top,d)),r.bottom!=null&&t.bottom!=null&&(this.bottom=o.y.number(t.bottom,r.bottom,d)),r.left!=null&&t.left!=null&&(this.left=o.y.number(t.left,r.left,d)),r.right!=null&&t.right!=null&&(this.right=o.y.number(t.right,r.right,d)),this}getCenter(t,r){const d=o.ab((this.left+t-this.right)/2,0,t),h=o.ab((this.top+r-this.bottom)/2,0,r);return new o.P(d,h)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new gr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function _r(_,t){if(!_.renderWorldCopies||_.lngRange)return;const r=t.lng-_.center.lng;t.lng+=r>180?-360:r<-180?360:0}function Eu(_){return Math.max(0,Math.floor(_))}class zs{constructor(t,r,d,h,y,x){this._callbacks=t,this._tileSize=512,this._renderWorldCopies=x===void 0||!!x,this._minZoom=r||0,this._maxZoom=d||22,this._minPitch=h??0,this._maxPitch=y??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new o.N(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Eu(this._zoom),this._scale=o.aG(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new gr,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,r,d){this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=Eu(this._zoom),this._scale=o.aG(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new gr(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!d&&t.autoCalculateNearFarZ,r&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){const r=o.aI(t,-180,180)*Math.PI/180;var d,h,y,x,S,P,A,F,N;this._bearingInRadians!==r&&(this._unmodified=!1,this._bearingInRadians=r,this._calcMatrices(),this._rotationMatrix=k(),d=this._rotationMatrix,y=-this._bearingInRadians,x=(h=this._rotationMatrix)[0],S=h[1],P=h[2],A=h[3],F=Math.sin(y),N=Math.cos(y),d[0]=x*N+P*F,d[1]=S*N+A*F,d[2]=x*-F+P*N,d[3]=S*-F+A*N)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){const r=o.ab(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==r&&(this._unmodified=!1,this._pitchInRadians=r,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){const r=t/180*Math.PI;this._rollInRadians!==r&&(this._unmodified=!1,this._rollInRadians=r,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return o.aJ(this._fovInRadians)}setFov(t){t=o.ab(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=o.aa(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){const r=this.getConstrained(this._center,t).zoom;this._zoom!==r&&(this._unmodified=!1,this._zoom=r,this._tileZoom=Math.max(0,Math.floor(r)),this._scale=o.aG(r),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,r){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=r,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,r,d){this._unmodified=!1,this._edgeInsets.interpolate(t,r,d),this._constrain(),this._calcMatrices()}resize(t,r,d=!0){this._width=t,this._height=r,d&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Le([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,o.aF])}getConstrained(t,r){return this._callbacks.getConstrained(t,r)}getCameraQueryGeometry(t,r){if(r.length===1)return[r[0],t];{let d=t.x,h=t.y,y=t.x,x=t.y;for(const S of r)d=Math.min(d,S.x),h=Math.min(h,S.y),y=Math.max(y,S.x),x=Math.max(x,S.y);return[new o.P(d,h),new o.P(y,h),new o.P(y,x),new o.P(d,x),new o.P(d,h)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:r,zoom:d}=this.getConstrained(this.center,this.zoom);this.setCenter(r),this.setZoom(d),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=o.aq(new Float64Array(16));o.K(t,t,[this._width/2,-this._height/2,1]),o.J(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=o.aq(new Float64Array(16)),o.K(t,t,[1,-1,1]),o.J(t,t,[-1,-1,0]),o.K(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,r,d,h){const y=d!==void 0?d:this.bearing,x=h=h!==void 0?h:this.pitch,S=o.Y.fromLngLat(t,r),P=-Math.cos(o.aa(x)),A=Math.sin(o.aa(x)),F=A*Math.sin(o.aa(y)),N=-A*Math.cos(o.aa(y));let j=this.elevation;const X=r-j;let J;P*X>=0||Math.abs(P)<.1?(J=1e4,j=r+J*P):J=-X/P;let le,se,ue=o.aK(1,S.y),fe=0;do{if(fe+=1,fe>10)break;se=J/ue,le=new o.Y(S.x+F*se,S.y+N*se),ue=1/le.meterInMercatorCoordinateUnits()}while(Math.abs(J-se*ue)>1e-12);return{center:le.toLngLat(),elevation:j,zoom:o.a8(this.height/2/Math.tan(this.fovInRadians/2)/se/this.tileSize)}}recalculateZoomAndCenter(t){if(this.elevation-t==0)return;const r=o.aH(1,this.center.lat)*this.worldSize,d=this.cameraToCenterDistance/r,h=o.Y.fromLngLat(this.center,this.elevation),y=mr(this.center,this.elevation,this.pitch,this.bearing,d);this._elevation=t;const x=this.calculateCenterFromCameraLngLatAlt(y.toLngLat(),o.aK(y.z,h.y),this.bearing,this.pitch);this._elevation=x.elevation,this._center=x.center,this.setZoom(x.zoom)}getCameraPoint(){const t=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(t*Math.sin(this.rollInRadians),t*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const t=o.aH(1,this.center.lat)*this.worldSize;return mr(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/t).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];const r=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/r,t.canonical.y/r,1/r/o.X,1/r/o.X]}}class oi{constructor(t,r){this.min=t,this.max=r,this.center=o.aL([],o.aM([],this.min,this.max),.5)}quadrant(t){const r=[t%2==0,t<2],d=o.aN(this.min),h=o.aN(this.max);for(let y=0;y<r.length;y++)d[y]=r[y]?this.min[y]:this.center[y],h[y]=r[y]?this.center[y]:this.max[y];return h[2]=this.max[2],new oi(d,h)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersectsFrustum(t){let r=!0;for(let d=0;d<t.planes.length;d++){const h=this.intersectsPlane(t.planes[d]);if(h===0)return 0;h===1&&(r=!1)}return r?2:t.aabb.min[0]>this.max[0]||t.aabb.min[1]>this.max[1]||t.aabb.min[2]>this.max[2]||t.aabb.max[0]<this.min[0]||t.aabb.max[1]<this.min[1]||t.aabb.max[2]<this.min[2]?0:1}intersectsPlane(t){let r=t[3],d=t[3];for(let h=0;h<3;h++)t[h]>0?(r+=t[h]*this.min[h],d+=t[h]*this.max[h]):(d+=t[h]*this.min[h],r+=t[h]*this.max[h]);return r>=0?2:d<0?0:1}}class nl{distanceToTile2d(t,r,d,h){const y=h.distanceX([t,r]),x=h.distanceY([t,r]);return Math.hypot(y,x)}getWrap(t,r,d){return d}getTileAABB(t,r,d,h){var y,x;let S=d,P=d;if(h.terrain){const F=new o.S(t.z,r,t.z,t.x,t.y),N=h.terrain.getMinMaxElevation(F);S=(y=N.minElevation)!==null&&y!==void 0?y:d,P=(x=N.maxElevation)!==null&&x!==void 0?x:d}const A=1<<t.z;return new oi([r+t.x/A,t.y/A,S],[r+(t.x+1)/A,(t.y+1)/A,P])}allowVariableZoom(t,r){const d=t.fov*(Math.abs(Math.cos(t.rollInRadians))*t.height+Math.abs(Math.sin(t.rollInRadians))*t.width)/t.height,h=o.ab(78.5-d/2,0,60);return!!r.terrain||t.pitch>h||t.padding.top>=.1}allowWorldCopies(){return!0}recalculateCache(){}}class Ma{constructor(t,r,d){this.points=t,this.planes=r,this.aabb=d}static fromInvProjectionMatrix(t,r=1,d=0){const h=Math.pow(2,d),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(A=>{const F=1/(A=o.al([],A,t))[3]/r*h;return o.aO(A,A,[F,F,1/A[3],F])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(A=>{const F=o.aP([],y[A[0]],y[A[1]]),N=o.aP([],y[A[2]],y[A[1]]),j=o.aQ([],o.aR([],F,N)),X=-o.aS(j,y[A[1]]);return j.concat(X)}),S=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],P=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const A of y)for(let F=0;F<3;F++)S[F]=Math.min(S[F],A[F]),P[F]=Math.max(P[F],A[F]);return new Ma(y,x,new oi(S,P))}}class Ua{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,r,d){return this._helper.interpolatePadding(t,r,d)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,r,d=!0){this._helper.resize(t,r,d)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,r){this._helper.overrideNearFarZ(t,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t,r){}constructor(t,r,d,h,y){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new zs({calcMatrices:()=>{this._calcMatrices()},getConstrained:(x,S)=>this.getConstrained(x,S)},t,r,d,h,y),this._coveringTilesDetailsProvider=new nl}clone(){const t=new Ua;return t.apply(this),t}apply(t,r,d){this._helper.apply(t,r,d)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(t){const r=[new o.aT(0,t)];if(this._helper._renderWorldCopies){const d=this.screenPointToMercatorCoordinate(new o.P(0,0)),h=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,0)),y=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,this._helper._height)),x=this.screenPointToMercatorCoordinate(new o.P(0,this._helper._height)),S=Math.floor(Math.min(d.x,h.x,y.x,x.x)),P=Math.floor(Math.max(d.x,h.x,y.x,x.x)),A=1;for(let F=S-A;F<=P+A;F++)F!==0&&r.push(new o.aT(F,t))}return r}getCameraFrustum(){return Ma.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){const r=this.screenPointToLocation(this.centerPoint,t),d=t?t.getElevationForLngLatZoom(r,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(d)}setLocationAtPoint(t,r){const d=o.aH(this.elevation,this.center.lat),h=this.screenPointToMercatorCoordinateAtZ(r,d),y=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,d),x=o.Y.fromLngLat(t),S=new o.Y(x.x-(h.x-y.x),x.y-(h.y-y.y));this.setCenter(S==null?void 0:S.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(t,r){return r?this.coordinatePoint(o.Y.fromLngLat(t),r.getElevationForLngLatZoom(t,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(o.Y.fromLngLat(t))}screenPointToLocation(t,r){var d;return(d=this.screenPointToMercatorCoordinate(t,r))===null||d===void 0?void 0:d.toLngLat()}screenPointToMercatorCoordinate(t,r){if(r){const d=r.pointCoordinate(t);if(d!=null)return d}return this.screenPointToMercatorCoordinateAtZ(t)}screenPointToMercatorCoordinateAtZ(t,r){const d=r||0,h=[t.x,t.y,0,1],y=[t.x,t.y,1,1];o.al(h,h,this._pixelMatrixInverse),o.al(y,y,this._pixelMatrixInverse);const x=h[3],S=y[3],P=h[1]/x,A=y[1]/S,F=h[2]/x,N=y[2]/S,j=F===N?0:(d-F)/(N-F);return new o.Y(o.y.number(h[0]/x,y[0]/S,j)/this.worldSize,o.y.number(P,A,j)/this.worldSize,d)}coordinatePoint(t,r=0,d=this._pixelMatrix){const h=[t.x*this.worldSize,t.y*this.worldSize,r,1];return o.al(h,h,d),new o.P(h[0]/h[3],h[1]/h[3])}getBounds(){const t=Math.max(0,this._helper._height/2-bi(this));return new Le().extend(this.screenPointToLocation(new o.P(0,t))).extend(this.screenPointToLocation(new o.P(this._helper._width,t))).extend(this.screenPointToLocation(new o.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new o.P(0,this._helper._height)))}isPointOnMapSurface(t,r){return r?r.pointCoordinate(t)!=null:t.y>this.height/2-bi(this)}calculatePosMatrix(t,r=!1,d){var h;const y=(h=t.key)!==null&&h!==void 0?h:o.aU(t.wrap,t.canonical.z,t.canonical.z,t.canonical.x,t.canonical.y),x=r?this._alignedPosMatrixCache:this._posMatrixCache;if(x.has(y)){const A=x.get(y);return d?A.f32:A.f64}const S=Mu(t,this.worldSize);o.L(S,r?this._alignedProjMatrix:this._viewProjMatrix,S);const P={f64:S,f32:new Float32Array(S)};return x.set(y,P),d?P.f32:P.f64}calculateFogMatrix(t){const r=t.key,d=this._fogMatrixCacheF32;if(d.has(r))return d.get(r);const h=Mu(t,this.worldSize);return o.L(h,this._fogMatrix,h),d.set(r,new Float32Array(h)),d.get(r)}getConstrained(t,r){r=o.ab(+r,this.minZoom,this.maxZoom);const d={center:new o.N(t.lng,t.lat),zoom:r};let h=this._helper._lngRange;this._helper._renderWorldCopies||h!==null||(h=[-179.9999999999,180-1e-10]);const y=this.tileSize*o.aG(d.zoom);let x=0,S=y,P=0,A=y,F=0,N=0;const{x:j,y:X}=this.size;if(this._helper._latRange){const we=this._helper._latRange;x=o.Q(we[1])*y,S=o.Q(we[0])*y,S-x<X&&(F=X/(S-x))}h&&(P=o.aI(o.O(h[0])*y,0,y),A=o.aI(o.O(h[1])*y,0,y),A<P&&(A+=y),A-P<j&&(N=j/(A-P)));const{x:J,y:le}=Ai(y,t);let se,ue;const fe=Math.max(N||0,F||0);if(fe){const we=new o.P(N?(A+P)/2:J,F?(S+x)/2:le);return d.center=Wi(y,we).wrap(),d.zoom+=o.a8(fe),d}if(this._helper._latRange){const we=X/2;le-we<x&&(ue=x+we),le+we>S&&(ue=S-we)}if(h){const we=(P+A)/2;let Te=J;this._helper._renderWorldCopies&&(Te=o.aI(J,we-y/2,we+y/2));const Ie=j/2;Te-Ie<P&&(se=P+Ie),Te+Ie>A&&(se=A-Ie)}if(se!==void 0||ue!==void 0){const we=new o.P(se??J,ue??le);d.center=Wi(y,we).wrap()}return d}calculateCenterFromCameraLngLatAlt(t,r,d,h){return this._helper.calculateCenterFromCameraLngLatAlt(t,r,d,h)}_calculateNearFarZIfNeeded(t,r,d){if(!this._helper.autoCalculateNearFarZ)return;const h=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),y=t-h*this._helper._pixelPerMeter/Math.cos(r),x=h<0?y:t,S=Math.PI/2+this.pitchInRadians,P=o.aa(this.fov)*(Math.abs(Math.cos(o.aa(this.roll)))*this.height+Math.abs(Math.sin(o.aa(this.roll)))*this.width)/this.height*(.5+d.y/this.height),A=Math.sin(P)*x/Math.sin(o.ab(Math.PI-S-P,.01,Math.PI-.01)),F=bi(this),N=Math.atan(F/this._helper.cameraToCenterDistance),j=o.aa(.75),X=N>j?2*N*(.5+d.y/(2*F)):j,J=Math.sin(X)*x/Math.sin(o.ab(Math.PI-S-X,.01,Math.PI-.01)),le=Math.min(A,J);this._helper._farZ=1.01*(Math.cos(Math.PI/2-r)*le+x),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const t=this.centerOffset,r=Ai(this.worldSize,this.center),d=r.x,h=r.y;this._helper._pixelPerMeter=o.aH(1,this.center.lat)*this.worldSize;const y=o.aa(Math.min(this.pitch,89.25)),x=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(y));let S;this._calculateNearFarZIfNeeded(x,y,t),S=new Float64Array(16),o.aV(S,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),o.an(this._invProjMatrix,S),S[8]=2*-t.x/this._helper._width,S[9]=2*t.y/this._helper._height,this._projectionMatrix=o.aW(S),o.K(S,S,[1,-1,1]),o.J(S,S,[0,0,-this._helper.cameraToCenterDistance]),o.aX(S,S,-this.rollInRadians),o.aY(S,S,this.pitchInRadians),o.aX(S,S,-this.bearingInRadians),o.J(S,S,[-d,-h,0]),this._mercatorMatrix=o.K([],S,[this.worldSize,this.worldSize,this.worldSize]),o.K(S,S,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=o.L(new Float64Array(16),this.clipSpaceToPixelsMatrix,S),o.J(S,S,[0,0,-this.elevation]),this._viewProjMatrix=S,this._invViewProjMatrix=o.an([],S);const P=[0,0,-1,1];o.al(P,P,this._invViewProjMatrix),this._cameraPosition=[P[0]/P[3],P[1]/P[3],P[2]/P[3]],this._fogMatrix=new Float64Array(16),o.aV(this._fogMatrix,this.fovInRadians,this.width/this.height,x,this._helper._farZ),this._fogMatrix[8]=2*-t.x/this.width,this._fogMatrix[9]=2*t.y/this.height,o.K(this._fogMatrix,this._fogMatrix,[1,-1,1]),o.J(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),o.aX(this._fogMatrix,this._fogMatrix,-this.rollInRadians),o.aY(this._fogMatrix,this._fogMatrix,this.pitchInRadians),o.aX(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),o.J(this._fogMatrix,this._fogMatrix,[-d,-h,0]),o.K(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),o.J(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=o.L(new Float64Array(16),this.clipSpaceToPixelsMatrix,S);const A=this._helper._width%2/2,F=this._helper._height%2/2,N=Math.cos(this.bearingInRadians),j=Math.sin(-this.bearingInRadians),X=d-Math.round(d)+N*A+j*F,J=h-Math.round(h)+N*F+j*A,le=new Float64Array(S);if(o.J(le,le,[X>.5?X-1:X,J>.5?J-1:J,0]),this._alignedProjMatrix=le,S=o.an(new Float64Array(16),this._pixelMatrix),!S)throw new Error("failed to invert matrix");this._pixelMatrixInverse=S,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const t=this.screenPointToMercatorCoordinate(new o.P(0,0)),r=[t.x*this.worldSize,t.y*this.worldSize,0,1];return o.al(r,r,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const t=o.aH(1,this.center.lat)*this.worldSize;return mr(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/t).toLngLat()}lngLatToCameraDepth(t,r){const d=o.Y.fromLngLat(t),h=[d.x*this.worldSize,d.y*this.worldSize,r,1];return o.al(h,h,this._viewProjMatrix),h[2]/h[3]}getProjectionData(t){const{overscaledTileID:r,aligned:d,applyTerrainMatrix:h}=t,y=this._helper.getMercatorTileCoordinates(r),x=r?this.calculatePosMatrix(r,d,!0):null;let S;return S=r&&r.terrainRttPosMatrix32f&&h?r.terrainRttPosMatrix32f:x||o.aZ(),{mainMatrix:S,tileMercatorCoords:y,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:S}}isLocationOccluded(t){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(t,r,d){return 1}transformLightDirection(t){return o.aN(t)}getRayDirectionFromPixel(t){throw new Error("Not implemented.")}projectTileCoordinates(t,r,d,h){const y=this.calculatePosMatrix(d);let x;h?(x=[t,r,h(t,r),1],o.al(x,x,y)):(x=[t,r,0,1],Vi(x,x,y));const S=x[3];return{point:new o.P(x[0]/S,x[1]/S),signedDistanceFromCamera:S,isOccluded:!1}}populateCache(t){for(const r of t)this.calculatePosMatrix(r)}getMatrixForModel(t,r){const d=o.Y.fromLngLat(t,r),h=d.meterInMercatorCoordinateUnits(),y=o.a_();return o.J(y,y,[d.x,d.y,d.z]),o.aX(y,y,Math.PI),o.aY(y,y,Math.PI/2),o.K(y,y,[-h,h,h]),y}getProjectionDataForCustomLayer(t=!0){const r=new o.S(0,0,0,0,0),d=this.getProjectionData({overscaledTileID:r,applyGlobeMatrix:t}),h=Mu(r,this.worldSize);o.L(h,this._viewProjMatrix,h),d.tileMercatorCoords=[0,0,1,1];const y=[o.X,o.X,this.worldSize/this._helper.pixelsPerMeter],x=o.a$();return o.K(x,h,y),d.fallbackMatrix=x,d.mainMatrix=x,d}getFastPathSimpleProjectionMatrix(t){return this.calculatePosMatrix(t)}}function Jr(){o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Au(_){if(_.useSlerp)if(_.k<1){const t=o.b0(_.startEulerAngles.roll,_.startEulerAngles.pitch,_.startEulerAngles.bearing),r=o.b0(_.endEulerAngles.roll,_.endEulerAngles.pitch,_.endEulerAngles.bearing),d=new Float64Array(4);o.b1(d,t,r,_.k);const h=o.b2(d);_.tr.setRoll(h.roll),_.tr.setPitch(h.pitch),_.tr.setBearing(h.bearing)}else _.tr.setRoll(_.endEulerAngles.roll),_.tr.setPitch(_.endEulerAngles.pitch),_.tr.setBearing(_.endEulerAngles.bearing);else _.tr.setRoll(o.y.number(_.startEulerAngles.roll,_.endEulerAngles.roll,_.k)),_.tr.setPitch(o.y.number(_.startEulerAngles.pitch,_.endEulerAngles.pitch,_.k)),_.tr.setBearing(o.y.number(_.startEulerAngles.bearing,_.endEulerAngles.bearing,_.k))}function Ga(_,t,r,d,h){const y=h.padding,x=Ai(h.worldSize,r.getNorthWest()),S=Ai(h.worldSize,r.getNorthEast()),P=Ai(h.worldSize,r.getSouthEast()),A=Ai(h.worldSize,r.getSouthWest()),F=o.aa(-d),N=x.rotate(F),j=S.rotate(F),X=P.rotate(F),J=A.rotate(F),le=new o.P(Math.max(N.x,j.x,J.x,X.x),Math.max(N.y,j.y,J.y,X.y)),se=new o.P(Math.min(N.x,j.x,J.x,X.x),Math.min(N.y,j.y,J.y,X.y)),ue=le.sub(se),fe=(h.width-(y.left+y.right+t.left+t.right))/ue.x,we=(h.height-(y.top+y.bottom+t.top+t.bottom))/ue.y;if(we<0||fe<0)return void Jr();const Te=Math.min(o.a8(h.scale*Math.min(fe,we)),_.maxZoom),Ie=o.P.convert(_.offset),De=new o.P((t.left-t.right)/2,(t.top-t.bottom)/2).rotate(o.aa(d)),Re=Ie.add(De).mult(h.scale/o.aG(Te));return{center:Wi(h.worldSize,x.add(P).div(2).sub(Re)),zoom:Te,bearing:d}}class ac{get useGlobeControls(){return!1}handlePanInertia(t,r){return{easingOffset:t,easingCenter:r.center}}handleMapControlsRollPitchBearingZoom(t,r){t.bearingDelta&&r.setBearing(r.bearing+t.bearingDelta),t.pitchDelta&&r.setPitch(r.pitch+t.pitchDelta),t.rollDelta&&r.setRoll(r.roll+t.rollDelta),t.zoomDelta&&r.setZoom(r.zoom+t.zoomDelta)}handleMapControlsPan(t,r,d){t.around.distSqr(r.centerPoint)<.01||r.setLocationAtPoint(d,t.around)}cameraForBoxAndBearing(t,r,d,h,y){return Ga(t,r,d,h,y)}handleJumpToCenterZoom(t,r){t.zoom!==(r.zoom!==void 0?+r.zoom:t.zoom)&&t.setZoom(+r.zoom),r.center!==void 0&&t.setCenter(o.N.convert(r.center))}handleEaseTo(t,r){const d=t.zoom,h=t.padding,y={roll:t.roll,pitch:t.pitch,bearing:t.bearing},x={roll:r.roll===void 0?t.roll:r.roll,pitch:r.pitch===void 0?t.pitch:r.pitch,bearing:r.bearing===void 0?t.bearing:r.bearing},S=r.zoom!==void 0,P=!t.isPaddingEqual(r.padding);let A=!1;const F=S?+r.zoom:t.zoom;let N=t.centerPoint.add(r.offsetAsPoint);const j=t.screenPointToLocation(N),{center:X,zoom:J}=t.getConstrained(o.N.convert(r.center||j),F??d);_r(t,X);const le=Ai(t.worldSize,j),se=Ai(t.worldSize,X).sub(le),ue=o.aG(J-d);return A=J!==d,{easeFunc:fe=>{if(A&&t.setZoom(o.y.number(d,J,fe)),o.b3(y,x)||Au({startEulerAngles:y,endEulerAngles:x,tr:t,k:fe,useSlerp:y.roll!=x.roll}),P&&(t.interpolatePadding(h,r.padding,fe),N=t.centerPoint.add(r.offsetAsPoint)),r.around)t.setLocationAtPoint(r.around,r.aroundPoint);else{const we=o.aG(t.zoom-d),Te=J>d?Math.min(2,ue):Math.max(.5,ue),Ie=Math.pow(Te,1-fe),De=Wi(t.worldSize,le.add(se.mult(fe*Ie)).mult(we));t.setLocationAtPoint(t.renderWorldCopies?De.wrap():De,N)}},isZooming:A,elevationCenter:X}}handleFlyTo(t,r){const d=r.zoom!==void 0,h=t.zoom,y=t.getConstrained(o.N.convert(r.center||r.locationAtOffset),d?+r.zoom:h),x=y.center,S=y.zoom;_r(t,x);const P=Ai(t.worldSize,r.locationAtOffset),A=Ai(t.worldSize,x).sub(P),F=A.mag(),N=o.aG(S-h);let j;if(r.minZoom!==void 0){const X=Math.min(+r.minZoom,h,S),J=t.getConstrained(x,X).zoom;j=o.aG(J-h)}return{easeFunc:(X,J,le,se)=>{t.setZoom(X===1?S:h+o.a8(J));const ue=X===1?x:Wi(t.worldSize,P.add(A.mult(le)).mult(J));t.setLocationAtPoint(t.renderWorldCopies?ue.wrap():ue,se)},scaleOfZoom:N,targetCenter:x,scaleOfMinZoom:j,pixelPathLength:F}}}class li{constructor(t,r,d){this.blendFunction=t,this.blendColor=r,this.mask=d}}li.Replace=[1,0],li.disabled=new li(li.Replace,o.b4.transparent,[!1,!1,!1,!1]),li.unblended=new li(li.Replace,o.b4.transparent,[!0,!0,!0,!0]),li.alphaBlended=new li([1,771],o.b4.transparent,[!0,!0,!0,!0]);const go=2305;class Rn{constructor(t,r,d){this.enable=t,this.mode=r,this.frontFace=d}}Rn.disabled=new Rn(!1,1029,go),Rn.backCCW=new Rn(!0,1029,go),Rn.frontCCW=new Rn(!0,1028,go);class yn{constructor(t,r,d){this.func=t,this.mask=r,this.range=d}}yn.ReadOnly=!1,yn.ReadWrite=!0,yn.disabled=new yn(519,yn.ReadOnly,[0,1]);const il=7680;class Ln{constructor(t,r,d,h,y,x){this.test=t,this.ref=r,this.mask=d,this.fail=h,this.depthFail=y,this.pass=x}}Ln.disabled=new Ln({func:519,mask:0},0,0,il,il,il);const _o=new WeakMap;function ha(_){var t;if(_o.has(_))return _o.get(_);{const r=(t=_.getParameter(_.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return _o.set(_,r),r}}class rl{get awaitingQuery(){return!!this._readbackQueue}constructor(t){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=t;const r=t.context,d=r.gl;this._texFormat=d.RGBA,this._texType=d.UNSIGNED_BYTE;const h=new o.aC;h.emplaceBack(-1,-1),h.emplaceBack(2,-1),h.emplaceBack(-1,2);const y=new o.aE;y.emplaceBack(0,1,2),this._fullscreenTriangle=new Ia(r.createVertexBuffer(h,Pn.members),r.createIndexBuffer(y),o.aD.simpleSegment(0,0,h.length,y.length)),this._resultBuffer=new Uint8Array(4),r.activeTexture.set(d.TEXTURE1);const x=d.createTexture();d.bindTexture(d.TEXTURE_2D,x),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST),d.texImage2D(d.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=r.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(x),ha(d)&&(this._pbo=d.createBuffer(),d.bindBuffer(d.PIXEL_PACK_BUFFER,this._pbo),d.bufferData(d.PIXEL_PACK_BUFFER,4,d.STREAM_READ),d.bindBuffer(d.PIXEL_PACK_BUFFER,null))}destroy(){const t=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),t.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(t,r){const d=this._updateCount;return this._readbackQueue?d>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():d>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(t,r),this._updateCount++,this._measuredError}_bindFramebuffer(){const t=this._cachedRenderContext.context,r=t.gl;t.activeTexture.set(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,this._fbo.colorAttachment.get()),t.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(t,r){const d=this._cachedRenderContext.context,h=d.gl;if(this._bindFramebuffer(),d.viewport.set([0,0,this._texWidth,this._texHeight]),d.clear({color:o.b4.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(d,h.TRIANGLES,yn.disabled,Ln.disabled,li.unblended,Rn.disabled,((y,x)=>({u_input:y,u_output_expected:x}))(t,r),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&ha(h)){h.bindBuffer(h.PIXEL_PACK_BUFFER,this._pbo),h.readBuffer(h.COLOR_ATTACHMENT0),h.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),h.bindBuffer(h.PIXEL_PACK_BUFFER,null);const y=h.fenceSync(h.SYNC_GPU_COMMANDS_COMPLETE,0);h.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:y}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const t=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&ha(t)){const r=t.clientWaitSync(this._readbackQueue.sync,0,0);if(r===t.WAIT_FAILED)return o.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(r===t.TIMEOUT_EXPIRED)return;t.bindBuffer(t.PIXEL_PACK_BUFFER,this._pbo),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),t.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=rl._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(t){let r=0;return r+=t[0]/256,r+=t[1]/65536,r+=t[2]/16777216,t[3]<127&&(r=-r),r/128}}const al=o.X/128;function sl(_,t){const r=_.granularity!==void 0?Math.max(_.granularity,1):1,d=r+(_.generateBorders?2:0),h=r+(_.extendToNorthPole||_.generateBorders?1:0)+(_.extendToSouthPole||_.generateBorders?1:0),y=d+1,x=h+1,S=_.generateBorders?-1:0,P=_.generateBorders||_.extendToNorthPole?-1:0,A=r+(_.generateBorders?1:0),F=r+(_.generateBorders||_.extendToSouthPole?1:0),N=y*x,j=d*h*6,X=y*x>65536;if(X&&t==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const J=X||t==="32bit",le=new Int16Array(2*N);let se=0;for(let we=P;we<=F;we++)for(let Te=S;Te<=A;Te++){let Ie=Te/r*o.X;Te===-1&&(Ie=-64),Te===r+1&&(Ie=o.X+al);let De=we/r*o.X;we===-1&&(De=_.extendToNorthPole?o.b6:-64),we===r+1&&(De=_.extendToSouthPole?o.b7:o.X+al),le[se++]=Ie,le[se++]=De}const ue=J?new Uint32Array(j):new Uint16Array(j);let fe=0;for(let we=0;we<h;we++)for(let Te=0;Te<d;Te++){const Ie=Te+1+we*y,De=Te+(we+1)*y,Re=Te+1+(we+1)*y;ue[fe++]=Te+we*y,ue[fe++]=De,ue[fe++]=Ie,ue[fe++]=Ie,ue[fe++]=De,ue[fe++]=Re}return{vertices:le.buffer.slice(0),indices:ue.buffer.slice(0),uses32bitIndices:J}}const Ls=new o.aB({fill:new o.b8(128,2),line:new o.b8(512,0),tile:new o.b8(128,32),stencil:new o.b8(128,1),circle:3});class Wh{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return ka.projectionGlobe}get vertexShaderPreludeCode(){return ka.projectionMercator.vertexSource}get subdivisionGranularity(){return Ls}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(t){this._errorMeasurement||(this._errorMeasurement=new rl(t));const r=o.Q(this._errorQueryLatitudeDegrees),d=2*Math.atan(Math.exp(Math.PI-r*Math.PI*2))-.5*Math.PI,h=this._errorMeasurement.updateErrorLoop(r,d),y=O.now();h!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=h,this._errorMeasurementLastChangeTime=y);const x=Math.min(Math.max((y-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=o.b9(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,o.ba(x))}_getMeshKey(t){return`${t.granularity.toString(36)}_${t.generateBorders?"b":""}${t.extendToNorthPole?"n":""}${t.extendToSouthPole?"s":""}`}getMeshFromTileID(t,r,d,h,y){const x=(y==="stencil"?Ls.stencil:Ls.tile).getGranularityForZoomLevel(r.z);return this._getMesh(t,{granularity:x,generateBorders:d,extendToNorthPole:r.y===0&&h,extendToSouthPole:r.y===(1<<r.z)-1&&h})}_getMesh(t,r){const d=this._getMeshKey(r);if(d in this._tileMeshCache)return this._tileMeshCache[d];const h=function(y,x){const S=sl(x,"16bit"),P=o.aC.deserialize({arrayBuffer:S.vertices,length:S.vertices.byteLength/2/2}),A=o.aE.deserialize({arrayBuffer:S.indices,length:S.indices.byteLength/2/3});return new Ia(y.createVertexBuffer(P,Pn.members),y.createIndexBuffer(A),o.aD.simpleSegment(0,0,P.length,A.length))}(t,r);return this._tileMeshCache[d]=h,h}recalculate(t){}hasTransition(){const t=O.now();let r=!1;return r=r||(t-this._errorMeasurementLastChangeTime)/1e3<.7,r=r||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,r}setErrorQueryLatitudeDegrees(t){this._errorQueryLatitudeDegrees=t}}const Ru=new o.q({type:new o.D(o.v.projection.type)});class Du extends o.E{constructor(t){super(),this._transitionable=new o.T(Ru),this.setProjection(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.z(0)),this._mercatorProjection=new tl,this._verticalPerspectiveProjection=new Wh}get transitionState(){const t=this.properties.get("type");if(typeof t=="string"&&t==="mercator")return 0;if(typeof t=="string"&&t==="vertical-perspective")return 1;if(t instanceof o.bb){if(t.from==="vertical-perspective"&&t.to==="mercator")return 1-t.transition;if(t.from==="mercator"&&t.to==="vertical-perspective")return t.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(t){this._mercatorProjection.updateGPUdependent(t),this._verticalPerspectiveProjection.updateGPUdependent(t)}getMeshFromTileID(t,r,d,h,y){return this.currentProjection.getMeshFromTileID(t,r,d,h,y)}setProjection(t){this._transitionable.setValue("type",(t==null?void 0:t.type)||"mercator")}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}setErrorQueryLatitudeDegrees(t){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(t),this._mercatorProjection.setErrorQueryLatitudeDegrees(t)}}function Xh(_){const t=yo(_.worldSize,_.center.lat);return 2*Math.PI*t}function ol(_,t,r,d,h){const y=1/(1<<h),x=t/o.X*y+d*y,S=o.bd((_/o.X*y+r*y)*Math.PI*2+Math.PI,2*Math.PI),P=2*Math.atan(Math.exp(Math.PI-x*Math.PI*2))-.5*Math.PI,A=Math.cos(P),F=new Float64Array(3);return F[0]=Math.sin(S)*A,F[1]=Math.sin(P),F[2]=Math.cos(S)*A,F}function ti(_){return function(t,r){const d=Math.cos(r),h=new Float64Array(3);return h[0]=Math.sin(t)*d,h[1]=Math.sin(r),h[2]=Math.cos(t)*d,h}(_.lng*Math.PI/180,_.lat*Math.PI/180)}function yo(_,t){return _/(2*Math.PI)/Math.cos(t*Math.PI/180)}function fa(_){const t=Math.asin(_[1])/Math.PI*180,r=Math.sqrt(_[0]*_[0]+_[2]*_[2]);if(r>1e-6){const d=_[0]/r,h=Math.acos(_[2]/r),y=(d>0?h:-h)/Math.PI*180;return new o.N(o.aI(y,-180,180),t)}return new o.N(0,t)}function Bs(_){return Math.cos(_*Math.PI/180)}function Xi(_,t){const r=Bs(_),d=Bs(t);return o.a8(d/r)}function zu(_,t){const r=_.rotate(t.bearingInRadians),d=t.zoom+Xi(t.center.lat,0),h=o.b9(1/Bs(t.center.lat),1/Bs(Math.min(Math.abs(t.center.lat),60)),o.bc(d,7,3,0,1)),y=360/Xh({worldSize:t.worldSize,center:{lat:t.center.lat}});return new o.N(t.center.lng-r.x*y*h,o.ab(t.center.lat+r.y*y,-85.051129,o.aF))}function us(_){const t=.5*_,r=Math.sin(t),d=Math.cos(t);return Math.log(r+d)-Math.log(d-r)}function Kh(_,t,r,d){const h=_.lat+r*d;if(Math.abs(r)>1){const y=(Math.sign(_.lat+r)!==Math.sign(_.lat)?-Math.abs(_.lat):Math.abs(_.lat))*Math.PI/180,x=Math.abs(_.lat+r)*Math.PI/180,S=us(y+d*(x-y)),P=us(y),A=us(x);return new o.N(_.lng+t*((S-P)/(A-P)),h)}return new o.N(_.lng+t*d,h)}class $m{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=t}recalculateCache(){if(!this._hadAnyChanges)return;const t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(t,r,d,h){const y=`${t.z}_${t.x}_${t.y}`,x=this._cache.get(y);if(x)return x;const S=this._cachePrevious.get(y);if(S)return this._cache.set(y,S),S;const P=this._aabbFactory(t,r,d,h);return this._cache.set(y,P),this._hadAnyChanges=!0,P}}function sc(_,t,r){const d=_-t;return d<0?-d:Math.max(0,d-r)}function Lu(_,t,r,d,h){const y=_-r;let x;return x=y<0?Math.min(-y,1+y-h):y>1?Math.min(Math.max(y-h,0),1-y):0,Math.max(x,sc(t,d,h))}class jm{constructor(){this._aabbCache=new $m(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(t,r,d,h){const y=1<<d.z,x=1/y,S=d.x/y,P=d.y/y;let A=2;return A=Math.min(A,Lu(t,r,S,P,x)),A=Math.min(A,Lu(t,r,S+.5,-P-x,x)),A=Math.min(A,Lu(t,r,S+.5,2-P-x,x)),A}getWrap(t,r,d){const h=1<<r.z,y=1/h,x=r.x/h,S=sc(t.x,x,y),P=sc(t.x,x-1,y),A=sc(t.x,x+1,y),F=Math.min(S,P,A);return F===A?1:F===P?-1:0}allowVariableZoom(t,r){return Er(t,r)>4}allowWorldCopies(){return!1}getTileAABB(t,r,d,h){return this._aabbCache.getTileAABB(t,r,d,h)}_computeTileAABB(t,r,d,h){if(t.z<=0)return new oi([-1,-1,-1],[1,1,1]);if(t.z===1)return new oi([t.x===0?-1:0,t.y===0?0:-1,-1],[t.x===0?0:1,t.y===0?1:0,1]);{const y=[ol(0,0,t.x,t.y,t.z),ol(o.X,0,t.x,t.y,t.z),ol(o.X,o.X,t.x,t.y,t.z),ol(0,o.X,t.x,t.y,t.z)],x=[1,1,1],S=[-1,-1,-1];for(const P of y)for(let A=0;A<3;A++)x[A]=Math.min(x[A],P[A]),S[A]=Math.max(S[A],P[A]);if(t.y===0||t.y===(1<<t.z)-1){const P=[0,t.y===0?1:-1,0];for(let A=0;A<3;A++)x[A]=Math.min(x[A],P[A]),S[A]=Math.max(S[A],P[A])}return new oi(x,S)}}}class oc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,r,d){return this._helper.interpolatePadding(t,r,d)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,r){this._helper.resize(t,r)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,r){this._helper.overrideNearFarZ(t,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t){}constructor(){this._cachedClippingPlane=o.be(),this._projectionMatrix=o.a_(),this._globeViewProjMatrix32f=o.aZ(),this._globeViewProjMatrixNoCorrection=o.a_(),this._globeViewProjMatrixNoCorrectionInverted=o.a_(),this._globeProjMatrixInverted=o.a_(),this._cameraPosition=o.bf(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new zs({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,r)=>this.getConstrained(t,r)}),this._coveringTilesDetailsProvider=new jm}clone(){const t=new oc;return t.apply(this),t}apply(t,r){this._globeLatitudeErrorCorrectionRadians=r||0,this._helper.apply(t)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const t=o.bf();return t[0]=this._cameraPosition[0],t[1]=this._cameraPosition[1],t[2]=this._cameraPosition[2],t}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(t){const{overscaledTileID:r,applyGlobeMatrix:d}=t,h=this._helper.getMercatorTileCoordinates(r);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:h,clippingPlane:this._cachedClippingPlane,projectionTransition:d?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(t){const r=this.pitchInRadians,d=this.cameraToCenterDistance/t,h=Math.sin(r)*d,y=Math.cos(r)*d+1,x=1/Math.sqrt(h*h+y*y)*1;let S=-h,P=y;const A=Math.sqrt(S*S+P*P);S/=A,P/=A;const F=[0,S,P];return o.bg(F,F,[0,0,0],-this.bearingInRadians),o.bh(F,F,[0,0,0],-1*this.center.lat*Math.PI/180),o.bi(F,F,[0,0,0],this.center.lng*Math.PI/180),o.aL(F,F,.25),[...F,.25*-x]}isLocationOccluded(t){return!this.isSurfacePointVisible(ti(t))}transformLightDirection(t){const r=this._helper._center.lng*Math.PI/180,d=this._helper._center.lat*Math.PI/180,h=Math.cos(d),y=[Math.sin(r)*h,Math.sin(d),Math.cos(r)*h],x=[y[2],0,-y[0]],S=[0,0,0];o.aR(S,x,y),o.aQ(x,x),o.aQ(S,S);const P=[0,0,0];return o.aQ(P,[x[0]*t[0]+S[0]*t[1]+y[0]*t[2],x[1]*t[0]+S[1]*t[1]+y[1]*t[2],x[2]*t[0]+S[2]*t[1]+y[2]*t[2]]),P}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(t,r,d){const h=function(S,P,A){const F=1/(1<<A.z);return new o.Y(S/o.X*F+A.x*F,P/o.X*F+A.y*F)}(t,r,d.canonical),y=(x=h.y,[o.bd(h.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-x*Math.PI*2))-.5*Math.PI]);var x;return this.getCircleRadiusCorrection()/Math.cos(y[1])}projectTileCoordinates(t,r,d,h){const y=d.canonical,x=ol(t,r,y.x,y.y,y.z),S=1+(h?h(t,r):0)/o.bo,P=[x[0]*S,x[1]*S,x[2]*S,1];o.al(P,P,this._globeViewProjMatrixNoCorrection);const A=this._cachedClippingPlane,F=A[0]*x[0]+A[1]*x[1]+A[2]*x[2]+A[3]<0;return{point:new o.P(P[0]/P[3],P[1]/P[3]),signedDistanceFromCamera:P[3],isOccluded:F}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const t=yo(this.worldSize,this.center.lat),r=o.a$(),d=o.a$();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*t),o.aV(r,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const h=this.centerOffset;r[8]=2*-h.x/this._helper._width,r[9]=2*h.y/this._helper._height,this._projectionMatrix=o.aW(r),this._globeProjMatrixInverted=o.a$(),o.an(this._globeProjMatrixInverted,r),o.J(r,r,[0,0,-this.cameraToCenterDistance]),o.aX(r,r,this.rollInRadians),o.aY(r,r,-this.pitchInRadians),o.aX(r,r,this.bearingInRadians),o.J(r,r,[0,0,-t]);const y=o.bf();y[0]=t,y[1]=t,y[2]=t,o.aY(d,r,this.center.lat*Math.PI/180),o.bj(d,d,-this.center.lng*Math.PI/180),o.K(d,d,y),this._globeViewProjMatrixNoCorrection=d,o.aY(r,r,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),o.bj(r,r,-this.center.lng*Math.PI/180),o.K(r,r,y),this._globeViewProjMatrix32f=new Float32Array(r),this._globeViewProjMatrixNoCorrectionInverted=o.a$(),o.an(this._globeViewProjMatrixNoCorrectionInverted,d);const x=o.bf();this._cameraPosition=o.bf(),this._cameraPosition[2]=this.cameraToCenterDistance/t,o.bg(this._cameraPosition,this._cameraPosition,x,-this.rollInRadians),o.bh(this._cameraPosition,this._cameraPosition,x,this.pitchInRadians),o.bg(this._cameraPosition,this._cameraPosition,x,-this.bearingInRadians),o.aM(this._cameraPosition,this._cameraPosition,[0,0,1]),o.bh(this._cameraPosition,this._cameraPosition,x,-this.center.lat*Math.PI/180),o.bi(this._cameraPosition,this._cameraPosition,x,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(t);const S=o.aW(this._globeViewProjMatrixNoCorrectionInverted);o.K(S,S,[1,1,-1]),this._cachedFrustum=Ma.fromInvProjectionMatrix(S)}calculateFogMatrix(t){o.w("calculateFogMatrix is not supported on globe projection.");const r=o.a$();return o.aq(r),r}getVisibleUnwrappedCoordinates(t){return[new o.aT(0,t)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){t&&o.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,r){if(!this._globeViewProjMatrixNoCorrection)return 1;const d=ti(t);o.aL(d,d,1+r/o.bo);const h=o.be();return o.al(h,[d[0],d[1],d[2],1],this._globeViewProjMatrixNoCorrection),h[2]/h[3]}populateCache(t){}getBounds(){const t=.5*this.width,r=.5*this.height,d=[new o.P(0,0),new o.P(t,0),new o.P(this.width,0),new o.P(this.width,r),new o.P(this.width,this.height),new o.P(t,this.height),new o.P(0,this.height),new o.P(0,r)],h=[];for(const N of d)h.push(this.unprojectScreenPoint(N));let y=0,x=0,S=0,P=0;const A=this.center;for(const N of h){const j=o.bk(A.lng,N.lng),X=o.bk(A.lat,N.lat);j<x&&(x=j),j>y&&(y=j),X<P&&(P=X),X>S&&(S=X)}const F=[A.lng+x,A.lat+P,A.lng+y,A.lat+S];return this.isSurfacePointOnScreen([0,1,0])&&(F[3]=90,F[0]=-180,F[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(F[1]=-90,F[0]=-180,F[2]=180),new Le(F)}getConstrained(t,r){const d=o.ab(t.lat,-85.051129,o.aF),h=o.ab(+r,this.minZoom+Xi(0,d),this.maxZoom);return{center:new o.N(t.lng,d),zoom:h}}calculateCenterFromCameraLngLatAlt(t,r,d,h){return this._helper.calculateCenterFromCameraLngLatAlt(t,r,d,h)}setLocationAtPoint(t,r){const d=ti(this.unprojectScreenPoint(r)),h=ti(t),y=o.bf();o.bl(y);const x=o.bf();o.bi(x,d,y,-this.center.lng*Math.PI/180),o.bh(x,x,y,this.center.lat*Math.PI/180);const S=h[0]*h[0]+h[2]*h[2],P=x[0]*x[0];if(S<P)return;const A=Math.sqrt(S-P),F=-A,N=o.bm(h[0],h[2],x[0],A),j=o.bm(h[0],h[2],x[0],F),X=o.bf();o.bi(X,h,y,-N);const J=o.bm(X[1],X[2],x[1],x[2]),le=o.bf();o.bi(le,h,y,-j);const se=o.bm(le[1],le[2],x[1],x[2]),ue=.5*Math.PI,fe=J>=-ue&&J<=ue,we=se>=-ue&&se<=ue;let Te,Ie;if(fe&&we){const Ze=this.center.lng*Math.PI/180,rt=this.center.lat*Math.PI/180;o.bp(N,Ze)+o.bp(J,rt)<o.bp(j,Ze)+o.bp(se,rt)?(Te=N,Ie=J):(Te=j,Ie=se)}else if(fe)Te=N,Ie=J;else{if(!we)return;Te=j,Ie=se}const De=Te/Math.PI*180,Re=Ie/Math.PI*180,Ge=this.center.lat;this.setCenter(new o.N(De,o.ab(Re,-90,90))),this.setZoom(this.zoom+Xi(Ge,this.center.lat))}locationToScreenPoint(t,r){const d=ti(t);if(r){const h=r.getElevationForLngLatZoom(t,this._helper._tileZoom);o.aL(d,d,1+h/o.bo)}return this._projectSurfacePointToScreen(d)}_projectSurfacePointToScreen(t){const r=o.be();return o.al(r,[...t,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],new o.P((.5*r[0]+.5)*this.width,(.5*-r[1]+.5)*this.height)}screenPointToMercatorCoordinate(t,r){if(r){const d=r.pointCoordinate(t);if(d)return d}return o.Y.fromLngLat(this.unprojectScreenPoint(t))}screenPointToLocation(t,r){var d;return(d=this.screenPointToMercatorCoordinate(t,r))===null||d===void 0?void 0:d.toLngLat()}isPointOnMapSurface(t,r){const d=this._cameraPosition,h=this.getRayDirectionFromPixel(t);return!!this.rayPlanetIntersection(d,h)}getRayDirectionFromPixel(t){const r=o.be();r[0]=t.x/this.width*2-1,r[1]=-1*(t.y/this.height*2-1),r[2]=1,r[3]=1,o.al(r,r,this._globeViewProjMatrixNoCorrectionInverted),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3];const d=o.bf();d[0]=r[0]-this._cameraPosition[0],d[1]=r[1]-this._cameraPosition[1],d[2]=r[2]-this._cameraPosition[2];const h=o.bf();return o.aQ(h,d),h}isSurfacePointVisible(t){const r=this._cachedClippingPlane;return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]>=0}isSurfacePointOnScreen(t){if(!this.isSurfacePointVisible(t))return!1;const r=o.be();return o.al(r,[...t,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3],r[0]>-1&&r[0]<1&&r[1]>-1&&r[1]<1&&r[2]>-1&&r[2]<1}rayPlanetIntersection(t,r){const d=o.aS(t,r),h=o.bf(),y=o.bf();o.aL(y,r,d),o.aP(h,t,y);const x=1-o.aS(h,h);if(x<0)return null;const S=o.aS(t,t)-1,P=-d+(d<0?1:-1)*Math.sqrt(x),A=S/P,F=P;return{tMin:Math.min(A,F),tMax:Math.max(A,F)}}unprojectScreenPoint(t){const r=this._cameraPosition,d=this.getRayDirectionFromPixel(t),h=this.rayPlanetIntersection(r,d);if(h){const A=o.bf();o.aM(A,r,[d[0]*h.tMin,d[1]*h.tMin,d[2]*h.tMin]);const F=o.bf();return o.aQ(F,A),fa(F)}const y=this._cachedClippingPlane[0]*d[0]+this._cachedClippingPlane[1]*d[1]+this._cachedClippingPlane[2]*d[2],x=-o.bn(this._cachedClippingPlane,r)/y,S=o.bf();if(x>0)o.aM(S,r,[d[0]*x,d[1]*x,d[2]*x]);else{const A=o.bf();o.aM(A,r,[2*d[0],2*d[1],2*d[2]]);const F=o.bn(this._cachedClippingPlane,A);o.aP(S,A,[this._cachedClippingPlane[0]*F,this._cachedClippingPlane[1]*F,this._cachedClippingPlane[2]*F])}const P=o.bf();return o.aQ(P,S),fa(P)}getMatrixForModel(t,r){const d=o.N.convert(t),h=1/o.bo,y=o.a_();return o.bj(y,y,d.lng/180*Math.PI),o.aY(y,y,-d.lat/180*Math.PI),o.J(y,y,[0,0,1+r/o.bo]),o.aY(y,y,.5*Math.PI),o.K(y,y,[h,h,h]),y}getProjectionDataForCustomLayer(t=!0){const r=this.getProjectionData({overscaledTileID:new o.S(0,0,0,0,0),applyGlobeMatrix:t});return r.tileMercatorCoords=[0,0,1,1],r}getFastPathSimpleProjectionMatrix(t){}}class Fs{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,r,d){return this._helper.interpolatePadding(t,r,d)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,r,d=!0){this._helper.resize(t,r,d)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,r){this._helper.overrideNearFarZ(t,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(t,r){this._globeness=t,this._globeLatitudeErrorCorrectionRadians=r,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new zs({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,r)=>this.getConstrained(t,r)}),this._globeness=1,this._mercatorTransform=new Ua,this._verticalPerspectiveTransform=new oc}clone(){const t=new Fs;return t._globeness=this._globeness,t._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,t.apply(this),t}apply(t){this._helper.apply(t),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(t){const r=this._mercatorTransform.getProjectionData(t),d=this._verticalPerspectiveTransform.getProjectionData(t);return{mainMatrix:this.isGlobeRendering?d.mainMatrix:r.mainMatrix,clippingPlane:d.clippingPlane,tileMercatorCoords:d.tileMercatorCoords,projectionTransition:t.applyGlobeMatrix?this._globeness:0,fallbackMatrix:r.fallbackMatrix}}isLocationOccluded(t){return this.currentTransform.isLocationOccluded(t)}transformLightDirection(t){return this.currentTransform.transformLightDirection(t)}getPixelScale(){return o.b9(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return o.b9(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(t,r,d){const h=this._mercatorTransform.getPitchedTextCorrection(t,r,d),y=this._verticalPerspectiveTransform.getPitchedTextCorrection(t,r,d);return o.b9(h,y,this._globeness)}projectTileCoordinates(t,r,d,h){return this.currentTransform.projectTileCoordinates(t,r,d,h)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(t){return this.currentTransform.calculateFogMatrix(t)}getVisibleUnwrappedCoordinates(t){return this.currentTransform.getVisibleUnwrappedCoordinates(t)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(t){this._mercatorTransform.recalculateZoomAndCenter(t),this._verticalPerspectiveTransform.recalculateZoomAndCenter(t)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,r){return this.currentTransform.lngLatToCameraDepth(t,r)}populateCache(t){this._mercatorTransform.populateCache(t),this._verticalPerspectiveTransform.populateCache(t)}getBounds(){return this.currentTransform.getBounds()}getConstrained(t,r){return this.currentTransform.getConstrained(t,r)}calculateCenterFromCameraLngLatAlt(t,r,d,h){return this._helper.calculateCenterFromCameraLngLatAlt(t,r,d,h)}setLocationAtPoint(t,r){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(t,r),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(t,r),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(t,r){return this.currentTransform.locationToScreenPoint(t,r)}screenPointToMercatorCoordinate(t,r){return this.currentTransform.screenPointToMercatorCoordinate(t,r)}screenPointToLocation(t,r){return this.currentTransform.screenPointToLocation(t,r)}isPointOnMapSurface(t,r){return this.currentTransform.isPointOnMapSurface(t,r)}getRayDirectionFromPixel(t){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(t)}getMatrixForModel(t,r){return this.currentTransform.getMatrixForModel(t,r)}getProjectionDataForCustomLayer(t=!0){const r=this._mercatorTransform.getProjectionDataForCustomLayer(t);if(!this.isGlobeRendering)return r;const d=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(t);return d.fallbackMatrix=r.mainMatrix,d}getFastPathSimpleProjectionMatrix(t){return this.currentTransform.getFastPathSimpleProjectionMatrix(t)}}class Vr{get useGlobeControls(){return!0}handlePanInertia(t,r){const d=zu(t,r);return Math.abs(d.lng-r.center.lng)>180&&(d.lng=r.center.lng+179.5*Math.sign(d.lng-r.center.lng)),{easingCenter:d,easingOffset:new o.P(0,0)}}handleMapControlsRollPitchBearingZoom(t,r){const d=t.around,h=r.screenPointToLocation(d);t.bearingDelta&&r.setBearing(r.bearing+t.bearingDelta),t.pitchDelta&&r.setPitch(r.pitch+t.pitchDelta),t.rollDelta&&r.setRoll(r.roll+t.rollDelta);const y=r.zoom;t.zoomDelta&&r.setZoom(r.zoom+t.zoomDelta);const x=r.zoom-y;if(x===0)return;const S=o.bk(r.center.lng,h.lng),P=S/(Math.abs(S/180)+1),A=o.bk(r.center.lat,h.lat),F=r.getRayDirectionFromPixel(d),N=r.cameraPosition,j=-1*o.aS(N,F),X=o.bf();o.aM(X,N,[F[0]*j,F[1]*j,F[2]*j]);const J=o.bq(X)-1,le=Math.exp(.5*-Math.max(J-.3,0)),se=yo(r.worldSize,r.center.lat)/Math.min(r.width,r.height),ue=o.bc(se,.9,.5,1,.25),fe=(1-o.aG(-x))*Math.min(le,ue),we=r.center.lat,Te=r.zoom,Ie=new o.N(r.center.lng+P*fe,o.ab(r.center.lat+A*fe,-85.051129,o.aF));r.setLocationAtPoint(h,d);const De=r.center,Re=o.bc(Math.abs(S),45,85,0,1),Ge=o.bc(se,.75,.35,0,1),Ze=Math.pow(Math.max(Re,Ge),.25),rt=o.bk(De.lng,Ie.lng),lt=o.bk(De.lat,Ie.lat);r.setCenter(new o.N(De.lng+rt*Ze,De.lat+lt*Ze).wrap()),r.setZoom(Te+Xi(we,r.center.lat))}handleMapControlsPan(t,r,d){if(!t.panDelta)return;const h=r.center.lat,y=r.zoom;r.setCenter(zu(t.panDelta,r).wrap()),r.setZoom(y+Xi(h,r.center.lat))}cameraForBoxAndBearing(t,r,d,h,y){const x=Ga(t,r,d,h,y),S=r.left/y.width*2-1,P=(y.width-r.right)/y.width*2-1,A=r.top/y.height*-2+1,F=(y.height-r.bottom)/y.height*-2+1,N=o.bk(d.getWest(),d.getEast())<0,j=N?d.getEast():d.getWest(),X=N?d.getWest():d.getEast(),J=Math.max(d.getNorth(),d.getSouth()),le=Math.min(d.getNorth(),d.getSouth()),se=j+.5*o.bk(j,X),ue=J+.5*o.bk(J,le),fe=y.clone();fe.setCenter(x.center),fe.setBearing(x.bearing),fe.setPitch(0),fe.setRoll(0),fe.setZoom(x.zoom);const we=fe.modelViewProjectionMatrix,Te=[ti(d.getNorthWest()),ti(d.getNorthEast()),ti(d.getSouthWest()),ti(d.getSouthEast()),ti(new o.N(X,ue)),ti(new o.N(j,ue)),ti(new o.N(se,J)),ti(new o.N(se,le))],Ie=ti(x.center);let De=Number.POSITIVE_INFINITY;for(const Re of Te)S<0&&(De=Vr.getLesserNonNegativeNonNull(De,Vr.solveVectorScale(Re,Ie,we,"x",S))),P>0&&(De=Vr.getLesserNonNegativeNonNull(De,Vr.solveVectorScale(Re,Ie,we,"x",P))),A>0&&(De=Vr.getLesserNonNegativeNonNull(De,Vr.solveVectorScale(Re,Ie,we,"y",A))),F<0&&(De=Vr.getLesserNonNegativeNonNull(De,Vr.solveVectorScale(Re,Ie,we,"y",F)));if(Number.isFinite(De)&&De!==0)return x.zoom=fe.zoom+o.a8(De),x;Jr()}handleJumpToCenterZoom(t,r){const d=t.center.lat,h=t.getConstrained(r.center?o.N.convert(r.center):t.center,t.zoom).center;t.setCenter(h.wrap());const y=r.zoom!==void 0?+r.zoom:t.zoom+Xi(d,h.lat);t.zoom!==y&&t.setZoom(y)}handleEaseTo(t,r){const d=t.zoom,h=t.center,y=t.padding,x={roll:t.roll,pitch:t.pitch,bearing:t.bearing},S={roll:r.roll===void 0?t.roll:r.roll,pitch:r.pitch===void 0?t.pitch:r.pitch,bearing:r.bearing===void 0?t.bearing:r.bearing},P=r.zoom!==void 0,A=!t.isPaddingEqual(r.padding);let F=!1;const N=r.center?o.N.convert(r.center):h,j=t.getConstrained(N,d).center;_r(t,j);const X=t.clone();X.setCenter(j),X.setZoom(P?+r.zoom:d+Xi(h.lat,N.lat)),X.setBearing(r.bearing);const J=new o.P(o.ab(t.centerPoint.x+r.offsetAsPoint.x,0,t.width),o.ab(t.centerPoint.y+r.offsetAsPoint.y,0,t.height));X.setLocationAtPoint(j,J);const le=(r.offset&&r.offsetAsPoint.mag())>0?X.center:j,se=P?+r.zoom:d+Xi(h.lat,le.lat),ue=d+Xi(h.lat,0),fe=se+Xi(le.lat,0),we=o.bk(h.lng,le.lng),Te=o.bk(h.lat,le.lat),Ie=o.aG(fe-ue);return F=se!==d,{easeFunc:De=>{if(o.b3(x,S)||Au({startEulerAngles:x,endEulerAngles:S,tr:t,k:De,useSlerp:x.roll!=S.roll}),A&&t.interpolatePadding(y,r.padding,De),r.around)o.w("Easing around a point is not supported under globe projection."),t.setLocationAtPoint(r.around,r.aroundPoint);else{const Re=fe>ue?Math.min(2,Ie):Math.max(.5,Ie),Ge=Math.pow(Re,1-De),Ze=Kh(h,we,Te,De*Ge);t.setCenter(Ze.wrap())}if(F){const Re=o.y.number(ue,fe,De)+Xi(0,t.center.lat);t.setZoom(Re)}},isZooming:F,elevationCenter:le}}handleFlyTo(t,r){const d=r.zoom!==void 0,h=t.center,y=t.zoom,x=!t.isPaddingEqual(r.padding),S=t.getConstrained(o.N.convert(r.center||r.locationAtOffset),y).center,P=d?+r.zoom:t.zoom+Xi(t.center.lat,S.lat),A=t.clone();A.setCenter(S),x&&A.setPadding(r.padding),A.setZoom(P),A.setBearing(r.bearing);const F=new o.P(o.ab(t.centerPoint.x+r.offsetAsPoint.x,0,t.width),o.ab(t.centerPoint.y+r.offsetAsPoint.y,0,t.height));A.setLocationAtPoint(S,F);const N=A.center;_r(t,N);const j=function(we,Te,Ie){const De=ti(Te),Re=ti(Ie),Ge=o.aS(De,Re),Ze=Math.acos(Ge),rt=Xh(we);return Ze/(2*Math.PI)*rt}(t,h,N),X=y+Xi(h.lat,0),J=P+Xi(N.lat,0),le=o.aG(J-X);let se;if(typeof r.minZoom=="number"){const we=+r.minZoom+Xi(N.lat,0),Te=Math.min(we,X,J)+Xi(0,N.lat),Ie=t.getConstrained(N,Te).zoom+Xi(N.lat,0);se=o.aG(Ie-X)}const ue=o.bk(h.lng,N.lng),fe=o.bk(h.lat,N.lat);return{easeFunc:(we,Te,Ie,De)=>{const Re=Kh(h,ue,fe,Ie),Ge=we===1?N:Re;t.setCenter(Ge.wrap());const Ze=X+o.a8(Te);t.setZoom(we===1?P:Ze+Xi(0,Ge.lat))},scaleOfZoom:le,targetCenter:N,scaleOfMinZoom:se,pixelPathLength:j}}static solveVectorScale(t,r,d,h,y){const x=h==="x"?[d[0],d[4],d[8],d[12]]:[d[1],d[5],d[9],d[13]],S=[d[3],d[7],d[11],d[15]],P=t[0]*x[0]+t[1]*x[1]+t[2]*x[2],A=t[0]*S[0]+t[1]*S[1]+t[2]*S[2],F=r[0]*x[0]+r[1]*x[1]+r[2]*x[2],N=r[0]*S[0]+r[1]*S[1]+r[2]*S[2];return F+y*A===P+y*N||S[3]*(P-F)+x[3]*(N-A)+P*N==F*A?null:(F+x[3]-y*N-y*S[3])/(F-P-y*N+y*A)}static getLesserNonNegativeNonNull(t,r){return r!==null&&r>=0&&r<t?r:t}}class ll{constructor(t){this._globe=t,this._mercatorCameraHelper=new ac,this._verticalPerspectiveCameraHelper=new Vr}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(t,r){return this.currentHelper.handlePanInertia(t,r)}handleMapControlsRollPitchBearingZoom(t,r){return this.currentHelper.handleMapControlsRollPitchBearingZoom(t,r)}handleMapControlsPan(t,r,d){this.currentHelper.handleMapControlsPan(t,r,d)}cameraForBoxAndBearing(t,r,d,h,y){return this.currentHelper.cameraForBoxAndBearing(t,r,d,h,y)}handleJumpToCenterZoom(t,r){this.currentHelper.handleJumpToCenterZoom(t,r)}handleEaseTo(t,r){return this.currentHelper.handleEaseTo(t,r)}handleFlyTo(t,r){return this.currentHelper.handleFlyTo(t,r)}}const vo=(_,t)=>o.t(_,t&&t.filter(r=>r.identifier!=="source.canvas")),Bu=o.br();class Qr extends o.E{constructor(t,r={}){super(),this._rtlPluginLoaded=()=>{for(const d in this.sourceCaches){const h=this.sourceCaches[d].getSource().type;h!=="vector"&&h!=="geojson"||this.sourceCaches[d].reload()}},this.map=t,this.dispatcher=new _n(qt(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",(d,h)=>this.getGlyphs(d,h)),this.dispatcher.registerMessageHandler("GI",(d,h)=>this.getImages(d,h)),this.imageManager=new ke,this.imageManager.setEventedParent(this),this.glyphManager=new We(t._requestManager,r.localIdeographFontFamily),this.lineAtlas=new Qe(256,512),this.crossTileSymbolIndex=new Ds,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.bs,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",o.bt()),Dn().on(Xt,this._rtlPluginLoaded),this.on("data",d=>{if(d.dataType!=="source"||d.sourceDataType!=="metadata")return;const h=this.sourceCaches[d.sourceId];if(!h)return;const y=h.getSource();if(y&&y.vectorLayerIds)for(const x in this._layers){const S=this._layers[x];S.source===y.id&&this._validateLayer(S)}})}loadURL(t,r={},d){this.fire(new o.k("dataloading",{dataType:"style"})),r.validate=typeof r.validate!="boolean"||r.validate;const h=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const y=this._loadStyleRequest;o.h(h,this._loadStyleRequest).then(x=>{this._loadStyleRequest=null,this._load(x.data,r,d)}).catch(x=>{this._loadStyleRequest=null,x&&!y.signal.aborted&&this.fire(new o.j(x))})}loadJSON(t,r={},d){this.fire(new o.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,O.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,r.validate=r.validate!==!1,this._load(t,r,d)}).catch(()=>{})}loadEmpty(){this.fire(new o.k("dataloading",{dataType:"style"})),this._load(Bu,{validate:!1})}_load(t,r,d){var h,y;const x=r.transformStyle?r.transformStyle(d,t):t;if(!r.validate||!vo(this,o.u(x))){this._loaded=!0,this.stylesheet=x;for(const S in x.sources)this.addSource(S,x.sources[S],{validate:!1});x.sprite?this._loadSprite(x.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(x.glyphs),this._createLayers(),this.light=new tt(this.stylesheet.light),this._setProjectionInternal(((h=this.stylesheet.projection)===null||h===void 0?void 0:h.type)||"mercator"),this.sky=new _t(this.stylesheet.sky),this.map.setTerrain((y=this.stylesheet.terrain)!==null&&y!==void 0?y:null),this.fire(new o.k("data",{dataType:"style"})),this.fire(new o.k("style.load"))}}_createLayers(){const t=o.bu(this.stylesheet.layers);this.dispatcher.broadcast("SL",t),this._order=t.map(r=>r.id),this._layers={},this._serializedLayers=null;for(const r of t){const d=o.bv(r);d.setEventedParent(this,{layer:{id:r.id}}),this._layers[r.id]=d}}_loadSprite(t,r=!1,d=void 0){let h;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(y,x,S,P){return o._(this,void 0,void 0,function*(){const A=he(y),F=S>1?"@2x":"",N={},j={};for(const{id:X,url:J}of A){const le=x.transformRequest(Ce(J,F,".json"),"SpriteJSON");N[X]=o.h(le,P);const se=x.transformRequest(Ce(J,F,".png"),"SpriteImage");j[X]=me.getImage(se,P)}return yield Promise.all([...Object.values(N),...Object.values(j)]),function(X,J){return o._(this,void 0,void 0,function*(){const le={};for(const se in X){le[se]={};const ue=O.getImageCanvasContext((yield J[se]).data),fe=(yield X[se]).data;for(const we in fe){const{width:Te,height:Ie,x:De,y:Re,sdf:Ge,pixelRatio:Ze,stretchX:rt,stretchY:lt,content:et,textFitWidth:Pt,textFitHeight:St}=fe[we];le[se][we]={data:null,pixelRatio:Ze,sdf:Ge,stretchX:rt,stretchY:lt,content:et,textFitWidth:Pt,textFitHeight:St,spriteData:{width:Te,height:Ie,x:De,y:Re,context:ue}}}}return le})}(N,j)})}(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(y=>{if(this._spriteRequest=null,y)for(const x in y){this._spritesImagesIds[x]=[];const S=this._spritesImagesIds[x]?this._spritesImagesIds[x].filter(P=>!(P in y)):[];for(const P of S)this.imageManager.removeImage(P),this._changedImages[P]=!0;for(const P in y[x]){const A=x==="default"?P:`${x}:${P}`;this._spritesImagesIds[x].push(A),A in this.imageManager.images?this.imageManager.updateImage(A,y[x][P],!1):this.imageManager.addImage(A,y[x][P]),r&&(this._changedImages[A]=!0)}}}).catch(y=>{this._spriteRequest=null,h=y,this.fire(new o.j(h))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),r&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"})),d&&d(h)})}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}_validateLayer(t){const r=this.sourceCaches[t.source];if(!r)return;const d=t.sourceLayer;if(!d)return;const h=r.getSource();(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(d)===-1)&&this.fire(new o.j(new Error(`Source layer "${d}" does not exist on source "${h.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,r=!1){const d=this._serializedAllLayers();if(!t||t.length===0)return Object.values(r?o.bw(d):d);const h=[];for(const y of t)if(d[y]){const x=r?o.bw(d[y]):d[y];h.push(x)}return h}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const r=Object.keys(this._layers);for(const d of r){const h=this._layers[d];h.type!=="custom"&&(t[d]=h.serialize())}return t}hasTransitions(){var t,r,d;if(!((t=this.light)===null||t===void 0)&&t.hasTransition()||!((r=this.sky)===null||r===void 0)&&r.hasTransition()||!((d=this.projection)===null||d===void 0)&&d.hasTransition())return!0;for(const h in this.sourceCaches)if(this.sourceCaches[h].hasTransition())return!0;for(const h in this._layers)if(this._layers[h].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const r=this._changed;if(r){const h=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(h.length||y.length)&&this._updateWorkerLayers(h,y);for(const x in this._updatedSources){const S=this._updatedSources[x];if(S==="reload")this._reloadSource(x);else{if(S!=="clear")throw new Error(`Invalid action ${S}`);this._clearSource(x)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const x in this._updatedPaintProps)this._layers[x].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const d={};for(const h in this.sourceCaches){const y=this.sourceCaches[h];d[h]=y.used,y.used=!1}for(const h of this._order){const y=this._layers[h];y.recalculate(t,this._availableImages),!y.isHidden(t.zoom)&&y.source&&(this.sourceCaches[y.source].used=!0)}for(const h in d){const y=this.sourceCaches[h];!!d[h]!=!!y.used&&y.fire(new o.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:h}))}this.light.recalculate(t),this.sky.recalculate(t),this.projection.recalculate(t),this.z=t.zoom,r&&this.fire(new o.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,r){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:r})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,r={}){var d;this._checkLoaded();const h=this.serialize();if(t=r.transformStyle?r.transformStyle(h,t):t,((d=r.validate)===null||d===void 0||d)&&vo(this,o.u(t)))return!1;(t=o.bw(t)).layers=o.bu(t.layers);const y=o.bx(h,t),x=this._getOperationsToPerform(y);if(x.unimplemented.length>0)throw new Error(`Unimplemented: ${x.unimplemented.join(", ")}.`);if(x.operations.length===0)return!1;for(const S of x.operations)S();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const r=[],d=[];for(const h of t)switch(h.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":r.push(()=>this.addLayer.apply(this,h.args));break;case"removeLayer":r.push(()=>this.removeLayer.apply(this,h.args));break;case"setPaintProperty":r.push(()=>this.setPaintProperty.apply(this,h.args));break;case"setLayoutProperty":r.push(()=>this.setLayoutProperty.apply(this,h.args));break;case"setFilter":r.push(()=>this.setFilter.apply(this,h.args));break;case"addSource":r.push(()=>this.addSource.apply(this,h.args));break;case"removeSource":r.push(()=>this.removeSource.apply(this,h.args));break;case"setLayerZoomRange":r.push(()=>this.setLayerZoomRange.apply(this,h.args));break;case"setLight":r.push(()=>this.setLight.apply(this,h.args));break;case"setGeoJSONSourceData":r.push(()=>this.setGeoJSONSourceData.apply(this,h.args));break;case"setGlyphs":r.push(()=>this.setGlyphs.apply(this,h.args));break;case"setSprite":r.push(()=>this.setSprite.apply(this,h.args));break;case"setTerrain":r.push(()=>this.map.setTerrain.apply(this,h.args));break;case"setSky":r.push(()=>this.setSky.apply(this,h.args));break;case"setProjection":this.setProjection.apply(this,h.args);break;case"setTransition":r.push(()=>{});break;default:d.push(h.command)}return{operations:r,unimplemented:d}}addImage(t,r){if(this.getImage(t))return this.fire(new o.j(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,r),this._afterImageUpdated(t)}updateImage(t,r){this.imageManager.updateImage(t,r)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new o.j(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,r,d={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(o.u.source,`sources.${t}`,r,null,d))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const h=this.sourceCaches[t]=new W(t,r,this.dispatcher);h.style=this,h.setEventedParent(this,()=>({isSourceLoaded:h.loaded(),source:h.serialize(),sourceId:t})),h.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const d in this._layers)if(this._layers[d].source===t)return this.fire(new o.j(new Error(`Source "${t}" cannot be removed while layer "${d}" is using it.`)));const r=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],r.fire(new o.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),r.setEventedParent(null),r.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,r){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const d=this.sourceCaches[t].getSource();if(d.type!=="geojson")throw new Error(`geojsonSource.type is ${d.type}, which is !== 'geojson`);d.setData(r),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,r,d={}){this._checkLoaded();const h=t.id;if(this.getLayer(h))return void this.fire(new o.j(new Error(`Layer "${h}" already exists on this map.`)));let y;if(t.type==="custom"){if(vo(this,o.by(t)))return;y=o.bv(t)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(h,t.source),t=o.bw(t),t=o.e(t,{source:h})),this._validate(o.u.layer,`layers.${h}`,t,{arrayIndex:-1},d))return;y=o.bv(t),this._validateLayer(y),y.setEventedParent(this,{layer:{id:h}})}const x=r?this._order.indexOf(r):this._order.length;if(r&&x===-1)this.fire(new o.j(new Error(`Cannot add layer "${h}" before non-existing layer "${r}".`)));else{if(this._order.splice(x,0,h),this._layerOrderChanged=!0,this._layers[h]=y,this._removedLayers[h]&&y.source&&y.type!=="custom"){const S=this._removedLayers[h];delete this._removedLayers[h],S.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.sourceCaches[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}moveLayer(t,r){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new o.j(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===r)return;const d=this._order.indexOf(t);this._order.splice(d,1);const h=r?this._order.indexOf(r):this._order.length;r&&h===-1?this.fire(new o.j(new Error(`Cannot move layer "${t}" before non-existing layer "${r}".`))):(this._order.splice(h,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const r=this._layers[t];if(!r)return void this.fire(new o.j(new Error(`Cannot remove non-existing layer "${t}".`)));r.setEventedParent(null);const d=this._order.indexOf(t);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=r,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],r.onRemove&&r.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,r,d){this._checkLoaded();const h=this.getLayer(t);h?h.minzoom===r&&h.maxzoom===d||(r!=null&&(h.minzoom=r),d!=null&&(h.maxzoom=d),this._updateLayer(h)):this.fire(new o.j(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,r,d={}){this._checkLoaded();const h=this.getLayer(t);if(h){if(!o.bz(h.filter,r))return r==null?(h.filter=void 0,void this._updateLayer(h)):void(this._validate(o.u.filter,`layers.${h.id}.filter`,r,null,d)||(h.filter=o.bw(r),this._updateLayer(h)))}else this.fire(new o.j(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return o.bw(this.getLayer(t).filter)}setLayoutProperty(t,r,d,h={}){this._checkLoaded();const y=this.getLayer(t);y?o.bz(y.getLayoutProperty(r),d)||(y.setLayoutProperty(r,d,h),this._updateLayer(y)):this.fire(new o.j(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,r){const d=this.getLayer(t);if(d)return d.getLayoutProperty(r);this.fire(new o.j(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,r,d,h={}){this._checkLoaded();const y=this.getLayer(t);y?o.bz(y.getPaintProperty(r),d)||(y.setPaintProperty(r,d,h)&&this._updateLayer(y),this._changed=!0,this._updatedPaintProps[t]=!0,this._serializedLayers=null):this.fire(new o.j(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,r){return this.getLayer(t).getPaintProperty(r)}setFeatureState(t,r){this._checkLoaded();const d=t.source,h=t.sourceLayer,y=this.sourceCaches[d];if(y===void 0)return void this.fire(new o.j(new Error(`The source '${d}' does not exist in the map's style.`)));const x=y.getSource().type;x==="geojson"&&h?this.fire(new o.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||h?(t.id===void 0&&this.fire(new o.j(new Error("The feature id parameter must be provided."))),y.setFeatureState(h,t.id,r)):this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,r){this._checkLoaded();const d=t.source,h=this.sourceCaches[d];if(h===void 0)return void this.fire(new o.j(new Error(`The source '${d}' does not exist in the map's style.`)));const y=h.getSource().type,x=y==="vector"?t.sourceLayer:void 0;y!=="vector"||x?r&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new o.j(new Error("A feature id is required to remove its specific state property."))):h.removeFeatureState(x,t.id,r):this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const r=t.source,d=t.sourceLayer,h=this.sourceCaches[r];if(h!==void 0)return h.getSource().type!=="vector"||d?(t.id===void 0&&this.fire(new o.j(new Error("The feature id parameter must be provided."))),h.getFeatureState(d,t.id)):void this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.j(new Error(`The source '${r}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=o.bA(this.sourceCaches,y=>y.serialize()),r=this._serializeByIds(this._order,!0),d=this.map.getTerrain()||void 0,h=this.stylesheet;return o.bB({version:h.version,name:h.name,metadata:h.metadata,light:h.light,sky:h.sky,center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch,sprite:h.sprite,glyphs:h.glyphs,transition:h.transition,projection:h.projection,sources:t,layers:r,terrain:d},y=>y!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const r=x=>this._layers[x].type==="fill-extrusion",d={},h=[];for(let x=this._order.length-1;x>=0;x--){const S=this._order[x];if(r(S)){d[S]=x;for(const P of t){const A=P[S];if(A)for(const F of A)h.push(F)}}}h.sort((x,S)=>S.intersectionZ-x.intersectionZ);const y=[];for(let x=this._order.length-1;x>=0;x--){const S=this._order[x];if(r(S))for(let P=h.length-1;P>=0;P--){const A=h[P].feature;if(d[A.layer.id]<x)break;y.push(A),h.pop()}else for(const P of t){const A=P[S];if(A)for(const F of A)y.push(F.feature)}}return y}queryRenderedFeatures(t,r,d){r&&r.filter&&this._validate(o.u.filter,"queryRenderedFeatures.filter",r.filter,null,r);const h={};if(r&&r.layers){if(!(Array.isArray(r.layers)||r.layers instanceof Set))return this.fire(new o.j(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const A of r.layers){const F=this._layers[A];if(!F)return this.fire(new o.j(new Error(`The layer '${A}' does not exist in the map's style and cannot be queried for features.`))),[];h[F.source]=!0}}const y=[];r.availableImages=this._availableImages;const x=this._serializedAllLayers(),S=r.layers instanceof Set?r.layers:Array.isArray(r.layers)?new Set(r.layers):null,P=Object.assign(Object.assign({},r),{layers:S});for(const A in this.sourceCaches)r.layers&&!h[A]||y.push(Nn(this.sourceCaches[A],this._layers,x,t,P,d));return this.placement&&y.push(function(A,F,N,j,X,J,le){const se={},ue=J.queryRenderedSymbols(j),fe=[];for(const we of Object.keys(ue).map(Number))fe.push(le[we]);fe.sort(si);for(const we of fe){const Te=we.featureIndex.lookupSymbolFeatures(ue[we.bucketInstanceId],F,we.bucketIndex,we.sourceLayerIndex,X.filter,X.layers,X.availableImages,A);for(const Ie in Te){const De=se[Ie]=se[Ie]||[],Re=Te[Ie];Re.sort((Ge,Ze)=>{const rt=we.featureSortOrder;if(rt){const lt=rt.indexOf(Ge.featureIndex);return rt.indexOf(Ze.featureIndex)-lt}return Ze.featureIndex-Ge.featureIndex});for(const Ge of Re)De.push(Ge)}}return function(we,Te,Ie){for(const De in we)for(const Re of we[De])En(Re,Ie[Te[De].source]);return we}(se,A,N)}(this._layers,x,this.sourceCaches,t,P,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(t,r){r&&r.filter&&this._validate(o.u.filter,"querySourceFeatures.filter",r.filter,null,r);const d=this.sourceCaches[t];return d?function(h,y){const x=h.getRenderableIds().map(A=>h.getTileByID(A)),S=[],P={};for(let A=0;A<x.length;A++){const F=x[A],N=F.tileID.canonical.key;P[N]||(P[N]=!0,F.querySourceFeatures(S,y))}return S}(d,r):[]}getLight(){return this.light.getLight()}setLight(t,r={}){this._checkLoaded();const d=this.light.getLight();let h=!1;for(const x in t)if(!o.bz(t[x],d[x])){h=!0;break}if(!h)return;const y={now:O.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,r),this.light.updateTransitions(y)}getProjection(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.projection}setProjection(t){if(this._checkLoaded(),this.projection){if(this.projection.name===t.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=t,this._setProjectionInternal(t.type)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,r={}){this._checkLoaded();const d=this.getSky();let h=!1;if(!t&&!d)return;if(t&&!d)h=!0;else if(!t&&d)h=!0;else for(const x in t)if(!o.bz(t[x],d[x])){h=!0;break}if(!h)return;const y={now:O.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,r),this.sky.updateTransitions(y)}_setProjectionInternal(t){const r=function(d){if(Array.isArray(d)){const h=new Du({type:d});return{projection:h,transform:new Fs,cameraHelper:new ll(h)}}switch(d){case"mercator":return{projection:new tl,transform:new Ua,cameraHelper:new ac};case"globe":{const h=new Du({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:h,transform:new Fs,cameraHelper:new ll(h)}}case"vertical-perspective":return{projection:new Wh,transform:new oc,cameraHelper:new Vr};default:return o.w(`Unknown projection name: ${d}. Falling back to mercator projection.`),{projection:new tl,transform:new Ua,cameraHelper:new ac}}}(t);this.projection=r.projection,this.map.migrateProjection(r.transform,r.cameraHelper);for(const d in this.sourceCaches)this.sourceCaches[d].reload()}_validate(t,r,d,h,y={}){return(!y||y.validate!==!1)&&vo(this,t.call(o.u,o.e({key:r,style:this.serialize(),value:d,styleSpec:o.v},h)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Dn().off(Xt,this._rtlPluginLoaded);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this.sourceCaches){const d=this.sourceCaches[r];d.setEventedParent(null),d.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const r in this.sourceCaches)this.sourceCaches[r].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,r,d,h,y=!1){let x=!1,S=!1;const P={};for(const A of this._order){const F=this._layers[A];if(F.type!=="symbol")continue;if(!P[F.source]){const j=this.sourceCaches[F.source];P[F.source]=j.getRenderableIds(!0).map(X=>j.getTileByID(X)).sort((X,J)=>J.tileID.overscaledZ-X.tileID.overscaledZ||(X.tileID.isLessThan(J.tileID)?-1:1))}const N=this.crossTileSymbolIndex.addLayer(F,P[F.source],t.center.lng);x=x||N}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||d===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(O.now(),t.zoom))&&(this.pauseablePlacement=new Hh(t,this.map.terrain,this._order,y,r,d,h,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,P),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(O.now()),S=!0),x&&this.pauseablePlacement.placement.setStale()),S||x)for(const A of this._order){const F=this._layers[A];F.type==="symbol"&&this.placement.updateLayerOpacities(F,P[F.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(O.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,r){return o._(this,void 0,void 0,function*(){const d=yield this.imageManager.getImages(r.icons);this._updateTilesForChangedImages();const h=this.sourceCaches[r.source];return h&&h.setDependencies(r.tileID.key,r.type,r.icons),d})}getGlyphs(t,r){return o._(this,void 0,void 0,function*(){const d=yield this.glyphManager.getGlyphs(r.stacks),h=this.sourceCaches[r.source];return h&&h.setDependencies(r.tileID.key,r.type,[""]),d})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,r={}){this._checkLoaded(),t&&this._validate(o.u.glyphs,"glyphs",t,null,r)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,r,d={},h){this._checkLoaded();const y=[{id:t,url:r}],x=[...he(this.stylesheet.sprite),...y];this._validate(o.u.sprite,"sprite",x,null,d)||(this.stylesheet.sprite=x,this._loadSprite(y,!0,h))}removeSprite(t){this._checkLoaded();const r=he(this.stylesheet.sprite);if(r.find(d=>d.id===t)){if(this._spritesImagesIds[t])for(const d of this._spritesImagesIds[t])this.imageManager.removeImage(d),this._changedImages[d]=!0;r.splice(r.findIndex(d=>d.id===t),1),this.stylesheet.sprite=r.length>0?r:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}else this.fire(new o.j(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return he(this.stylesheet.sprite)}setSprite(t,r={},d){this._checkLoaded(),t&&this._validate(o.u.sprite,"sprite",t,null,r)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,d):(this._unloadSprite(),d&&d(null)))}}var Um=o.aA([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Fu{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,r,d,h,y,x,S,P,A){this.context=t;let F=this.boundPaintVertexBuffers.length!==h.length;for(let N=0;!F&&N<h.length;N++)this.boundPaintVertexBuffers[N]!==h[N]&&(F=!0);!this.vao||this.boundProgram!==r||this.boundLayoutVertexBuffer!==d||F||this.boundIndexBuffer!==y||this.boundVertexOffset!==x||this.boundDynamicVertexBuffer!==S||this.boundDynamicVertexBuffer2!==P||this.boundDynamicVertexBuffer3!==A?this.freshBind(r,d,h,y,x,S,P,A):(t.bindVertexArray.set(this.vao),S&&S.bind(),y&&y.dynamicDraw&&y.bind(),P&&P.bind(),A&&A.bind())}freshBind(t,r,d,h,y,x,S,P){const A=t.numAttributes,F=this.context,N=F.gl;this.vao&&this.destroy(),this.vao=F.createVertexArray(),F.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=r,this.boundPaintVertexBuffers=d,this.boundIndexBuffer=h,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=S,this.boundDynamicVertexBuffer3=P,r.enableAttributes(N,t);for(const j of d)j.enableAttributes(N,t);x&&x.enableAttributes(N,t),S&&S.enableAttributes(N,t),P&&P.enableAttributes(N,t),r.bind(),r.setVertexAttribPointers(N,t,y);for(const j of d)j.bind(),j.setVertexAttribPointers(N,t,y);x&&(x.bind(),x.setVertexAttribPointers(N,t,y)),h&&h.bind(),S&&(S.bind(),S.setVertexAttribPointers(N,t,y)),P&&(P.bind(),P.setVertexAttribPointers(N,t,y)),F.currentNumAttributes=A}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const cl=(_,t,r,d,h)=>({u_texture:0,u_ele_delta:_,u_fog_matrix:t,u_fog_color:r?r.properties.get("fog-color"):o.b4.white,u_fog_ground_blend:r?r.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:h?0:r?r.calculateFogBlendOpacity(d):0,u_horizon_color:r?r.properties.get("horizon-color"):o.b4.white,u_horizon_fog_blend:r?r.properties.get("horizon-fog-blend"):1,u_is_globe_mode:h?1:0}),ul={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function lc(_){const t=[];for(let r=0;r<_.length;r++){if(_[r]===null)continue;const d=_[r].split(" ");t.push(d.pop())}return t}class cc{constructor(t,r,d,h,y,x,S,P){const A=t.gl;this.program=A.createProgram();const F=lc(r.staticAttributes),N=d?d.getBinderAttributes():[],j=F.concat(N),X=ka.prelude.staticUniforms?lc(ka.prelude.staticUniforms):[],J=S.staticUniforms?lc(S.staticUniforms):[],le=r.staticUniforms?lc(r.staticUniforms):[],se=d?d.getBinderUniforms():[],ue=X.concat(J).concat(le).concat(se),fe=[];for(const Ze of ue)fe.indexOf(Ze)<0&&fe.push(Ze);const we=d?d.defines():[];ha(A)&&we.unshift("#version 300 es"),y&&we.push("#define OVERDRAW_INSPECTOR;"),x&&we.push("#define TERRAIN3D;"),P&&we.push(P);let Te=we.concat(ka.prelude.fragmentSource,S.fragmentSource,r.fragmentSource).join(`
`),Ie=we.concat(ka.prelude.vertexSource,S.vertexSource,r.vertexSource).join(`
`);ha(A)||(Te=function(Ze){return Ze.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(Te),Ie=function(Ze){return Ze.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Ie));const De=A.createShader(A.FRAGMENT_SHADER);if(A.isContextLost())return void(this.failedToCreate=!0);if(A.shaderSource(De,Te),A.compileShader(De),!A.getShaderParameter(De,A.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${A.getShaderInfoLog(De)}`);A.attachShader(this.program,De);const Re=A.createShader(A.VERTEX_SHADER);if(A.isContextLost())return void(this.failedToCreate=!0);if(A.shaderSource(Re,Ie),A.compileShader(Re),!A.getShaderParameter(Re,A.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${A.getShaderInfoLog(Re)}`);A.attachShader(this.program,Re),this.attributes={};const Ge={};this.numAttributes=j.length;for(let Ze=0;Ze<this.numAttributes;Ze++)j[Ze]&&(A.bindAttribLocation(this.program,Ze,j[Ze]),this.attributes[j[Ze]]=Ze);if(A.linkProgram(this.program),!A.getProgramParameter(this.program,A.LINK_STATUS))throw new Error(`Program failed to link: ${A.getProgramInfoLog(this.program)}`);A.deleteShader(Re),A.deleteShader(De);for(let Ze=0;Ze<fe.length;Ze++){const rt=fe[Ze];if(rt&&!Ge[rt]){const lt=A.getUniformLocation(this.program,rt);lt&&(Ge[rt]=lt)}}this.fixedUniforms=h(t,Ge),this.terrainUniforms=((Ze,rt)=>({u_depth:new o.bC(Ze,rt.u_depth),u_terrain:new o.bC(Ze,rt.u_terrain),u_terrain_dim:new o.b5(Ze,rt.u_terrain_dim),u_terrain_matrix:new o.bD(Ze,rt.u_terrain_matrix),u_terrain_unpack:new o.bE(Ze,rt.u_terrain_unpack),u_terrain_exaggeration:new o.b5(Ze,rt.u_terrain_exaggeration)}))(t,Ge),this.projectionUniforms=((Ze,rt)=>({u_projection_matrix:new o.bD(Ze,rt.u_projection_matrix),u_projection_tile_mercator_coords:new o.bE(Ze,rt.u_projection_tile_mercator_coords),u_projection_clipping_plane:new o.bE(Ze,rt.u_projection_clipping_plane),u_projection_transition:new o.b5(Ze,rt.u_projection_transition),u_projection_fallback_matrix:new o.bD(Ze,rt.u_projection_fallback_matrix)}))(t,Ge),this.binderUniforms=d?d.getUniforms(t,Ge):[]}draw(t,r,d,h,y,x,S,P,A,F,N,j,X,J,le,se,ue,fe,we){const Te=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(d),t.setStencilMode(h),t.setColorMode(y),t.setCullFace(x),P){t.activeTexture.set(Te.TEXTURE2),Te.bindTexture(Te.TEXTURE_2D,P.depthTexture),t.activeTexture.set(Te.TEXTURE3),Te.bindTexture(Te.TEXTURE_2D,P.texture);for(const De in this.terrainUniforms)this.terrainUniforms[De].set(P[De])}if(A)for(const De in A)this.projectionUniforms[ul[De]].set(A[De]);if(S)for(const De in this.fixedUniforms)this.fixedUniforms[De].set(S[De]);se&&se.setUniforms(t,this.binderUniforms,J,{zoom:le});let Ie=0;switch(r){case Te.LINES:Ie=2;break;case Te.TRIANGLES:Ie=3;break;case Te.LINE_STRIP:Ie=1}for(const De of X.get()){const Re=De.vaos||(De.vaos={});(Re[F]||(Re[F]=new Fu)).bind(t,this,N,se?se.getPaintVertexBuffers():[],j,De.vertexOffset,ue,fe,we),Te.drawElements(r,De.primitiveLength*Ie,Te.UNSIGNED_SHORT,De.primitiveOffset*Ie*2)}}}function Yh(_,t,r){const d=1/o.at(r,1,t.transform.tileZoom),h=Math.pow(2,r.tileID.overscaledZ),y=r.tileSize*Math.pow(2,t.transform.tileZoom)/h,x=y*(r.tileID.canonical.x+r.tileID.wrap*h),S=y*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[d,_.fromScale,_.toScale],u_fade:_.t,u_pixel_coord_upper:[x>>16,S>>16],u_pixel_coord_lower:[65535&x,65535&S]}}const Os=(_,t,r,d)=>{const h=_.style.light,y=h.properties.get("position"),x=[y.x,y.y,y.z],S=o.bI();h.properties.get("anchor")==="viewport"&&o.bJ(S,_.transform.bearingInRadians),o.bK(x,x,S);const P=_.transform.transformLightDirection(x),A=h.properties.get("color");return{u_lightpos:x,u_lightpos_globe:P,u_lightintensity:h.properties.get("intensity"),u_lightcolor:[A.r,A.g,A.b],u_vertical_gradient:+t,u_opacity:r,u_fill_translate:d}},Gm=(_,t,r,d,h,y,x)=>o.e(Os(_,t,r,d),Yh(y,_,x),{u_height_factor:-Math.pow(2,h.overscaledZ)/x.tileSize/8}),Ou=(_,t,r,d)=>o.e(Yh(t,_,r),{u_fill_translate:d}),Hm=(_,t)=>({u_world:_,u_fill_translate:t}),Jh=(_,t,r,d,h)=>o.e(Ou(_,t,r,h),{u_world:d}),Vu=(_,t,r,d,h)=>{const y=_.transform;let x,S,P=0;if(r.paint.get("circle-pitch-alignment")==="map"){const A=o.at(t,1,y.zoom);x=!0,S=[A,A],P=A/(o.X*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*h}else x=!1,S=y.pixelsToGLUnits;return{u_camera_to_center_distance:y.cameraToCenterDistance,u_scale_with_map:+(r.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+x,u_device_pixel_ratio:_.pixelRatio,u_extrude_scale:S,u_globe_extrude_scale:P,u_translate:d}},Qh=_=>({u_pixel_extrude_scale:[1/_.width,1/_.height]}),ef=_=>({u_viewport_size:[_.width,_.height]}),Nu=(_,t=1)=>({u_color:_,u_overlay:0,u_overlay_scale:t}),$u=(_,t,r,d)=>{const h=o.at(_,1,t)/(o.X*Math.pow(2,_.tileID.overscaledZ))*2*Math.PI*d;return{u_extrude_scale:o.at(_,1,t),u_intensity:r,u_globe_extrude_scale:h}},ds=(_,t,r,d)=>{const h=o.H();o.bL(h,0,_.width,_.height,0,0,1);const y=_.context.gl;return{u_matrix:h,u_world:[y.drawingBufferWidth,y.drawingBufferHeight],u_image:r,u_color_ramp:d,u_opacity:t.paint.get("heatmap-opacity")}},tf=(_,t,r)=>{const d=r.paint.get("hillshade-shadow-color"),h=r.paint.get("hillshade-highlight-color"),y=r.paint.get("hillshade-accent-color");let x=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);return r.paint.get("hillshade-illumination-anchor")==="viewport"&&(x+=_.transform.bearingInRadians),{u_image:0,u_latrange:dl(0,t.tileID),u_light:[r.paint.get("hillshade-exaggeration"),x],u_shadow:d,u_highlight:h,u_accent:y}},nf=(_,t)=>{const r=t.stride,d=o.H();return o.bL(d,0,o.X,-8192,0,0,1),o.J(d,d,[0,-8192,0]),{u_matrix:d,u_image:1,u_dimension:[r,r],u_zoom:_.overscaledZ,u_unpack:t.getUnpackVector()}};function dl(_,t){const r=Math.pow(2,t.canonical.z),d=t.canonical.y;return[new o.Y(0,d/r).toLngLat().lat,new o.Y(0,(d+1)/r).toLngLat().lat]}const ju=(_,t,r,d)=>{const h=_.transform;return{u_translation:Gu(_,t,r),u_ratio:d/o.at(t,1,h.zoom),u_device_pixel_ratio:_.pixelRatio,u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]]}},uc=(_,t,r,d,h)=>o.e(ju(_,t,r,d),{u_image:0,u_image_height:h}),Zm=(_,t,r,d,h)=>{const y=_.transform,x=Uu(t,y);return{u_translation:Gu(_,t,r),u_texsize:t.imageAtlasTexture.size,u_ratio:d/o.at(t,1,y.zoom),u_device_pixel_ratio:_.pixelRatio,u_image:0,u_scale:[x,h.fromScale,h.toScale],u_fade:h.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},qm=(_,t,r,d,h,y)=>{const x=_.lineAtlas,S=Uu(t,_.transform),P=r.layout.get("line-cap")==="round",A=x.getDash(h.from,P),F=x.getDash(h.to,P),N=A.width*y.fromScale,j=F.width*y.toScale;return o.e(ju(_,t,r,d),{u_patternscale_a:[S/N,-A.height/2],u_patternscale_b:[S/j,-F.height/2],u_sdfgamma:x.width/(256*Math.min(N,j)*_.pixelRatio)/2,u_image:0,u_tex_y_a:A.y,u_tex_y_b:F.y,u_mix:y.t})};function Uu(_,t){return 1/o.at(_,1,t.tileZoom)}function Gu(_,t,r){return o.au(_.transform,t,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}const rf=(_,t,r,d,h)=>{return{u_tl_parent:_,u_scale_parent:t,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(x=d.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(y=d.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:Hu(d.paint.get("raster-hue-rotate")),u_coords_top:[h[0].x,h[0].y,h[1].x,h[1].y],u_coords_bottom:[h[3].x,h[3].y,h[2].x,h[2].y]};var y,x};function Hu(_){_*=Math.PI/180;const t=Math.sin(_),r=Math.cos(_);return[(2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3]}const Zu=(_,t,r,d,h,y,x,S,P,A,F,N,j)=>{const X=x.transform;return{u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:X.cameraToCenterDistance,u_pitch:X.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:X.width/X.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_label_plane_matrix:S,u_coord_matrix:P,u_is_text:+F,u_pitch_with_map:+d,u_is_along_line:h,u_is_variable_anchor:y,u_texsize:N,u_texture:0,u_translation:A,u_pitched_scale:j}},hl=(_,t,r,d,h,y,x,S,P,A,F,N,j,X)=>{const J=x.transform;return o.e(Zu(_,t,r,d,h,y,x,S,P,A,F,N,X),{u_gamma_scale:d?Math.cos(J.pitch*Math.PI/180)*J.cameraToCenterDistance:1,u_device_pixel_ratio:x.pixelRatio,u_is_halo:1})},Ha=(_,t,r,d,h,y,x,S,P,A,F,N,j)=>o.e(hl(_,t,r,d,h,y,x,S,P,A,!0,F,0,j),{u_texsize_icon:N,u_texture_icon:1}),qu=(_,t)=>({u_opacity:_,u_color:t}),Wu=(_,t,r,d,h)=>o.e(function(y,x,S,P){const A=S.imageManager.getPattern(y.from.toString()),F=S.imageManager.getPattern(y.to.toString()),{width:N,height:j}=S.imageManager.getPixelSize(),X=Math.pow(2,P.tileID.overscaledZ),J=P.tileSize*Math.pow(2,S.transform.tileZoom)/X,le=J*(P.tileID.canonical.x+P.tileID.wrap*X),se=J*P.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:A.tl,u_pattern_br_a:A.br,u_pattern_tl_b:F.tl,u_pattern_br_b:F.br,u_texsize:[N,j],u_mix:x.t,u_pattern_size_a:A.displaySize,u_pattern_size_b:F.displaySize,u_scale_a:x.fromScale,u_scale_b:x.toScale,u_tile_units_to_pixels:1/o.at(P,1,S.transform.tileZoom),u_pixel_coord_upper:[le>>16,se>>16],u_pixel_coord_lower:[65535&le,65535&se]}}(r,h,t,d),{u_opacity:_}),dc=(_,t)=>{},af={fillExtrusion:(_,t)=>({u_lightpos:new o.bG(_,t.u_lightpos),u_lightpos_globe:new o.bG(_,t.u_lightpos_globe),u_lightintensity:new o.b5(_,t.u_lightintensity),u_lightcolor:new o.bG(_,t.u_lightcolor),u_vertical_gradient:new o.b5(_,t.u_vertical_gradient),u_opacity:new o.b5(_,t.u_opacity),u_fill_translate:new o.bH(_,t.u_fill_translate)}),fillExtrusionPattern:(_,t)=>({u_lightpos:new o.bG(_,t.u_lightpos),u_lightpos_globe:new o.bG(_,t.u_lightpos_globe),u_lightintensity:new o.b5(_,t.u_lightintensity),u_lightcolor:new o.bG(_,t.u_lightcolor),u_vertical_gradient:new o.b5(_,t.u_vertical_gradient),u_height_factor:new o.b5(_,t.u_height_factor),u_opacity:new o.b5(_,t.u_opacity),u_fill_translate:new o.bH(_,t.u_fill_translate),u_image:new o.bC(_,t.u_image),u_texsize:new o.bH(_,t.u_texsize),u_pixel_coord_upper:new o.bH(_,t.u_pixel_coord_upper),u_pixel_coord_lower:new o.bH(_,t.u_pixel_coord_lower),u_scale:new o.bG(_,t.u_scale),u_fade:new o.b5(_,t.u_fade)}),fill:(_,t)=>({u_fill_translate:new o.bH(_,t.u_fill_translate)}),fillPattern:(_,t)=>({u_image:new o.bC(_,t.u_image),u_texsize:new o.bH(_,t.u_texsize),u_pixel_coord_upper:new o.bH(_,t.u_pixel_coord_upper),u_pixel_coord_lower:new o.bH(_,t.u_pixel_coord_lower),u_scale:new o.bG(_,t.u_scale),u_fade:new o.b5(_,t.u_fade),u_fill_translate:new o.bH(_,t.u_fill_translate)}),fillOutline:(_,t)=>({u_world:new o.bH(_,t.u_world),u_fill_translate:new o.bH(_,t.u_fill_translate)}),fillOutlinePattern:(_,t)=>({u_world:new o.bH(_,t.u_world),u_image:new o.bC(_,t.u_image),u_texsize:new o.bH(_,t.u_texsize),u_pixel_coord_upper:new o.bH(_,t.u_pixel_coord_upper),u_pixel_coord_lower:new o.bH(_,t.u_pixel_coord_lower),u_scale:new o.bG(_,t.u_scale),u_fade:new o.b5(_,t.u_fade),u_fill_translate:new o.bH(_,t.u_fill_translate)}),circle:(_,t)=>({u_camera_to_center_distance:new o.b5(_,t.u_camera_to_center_distance),u_scale_with_map:new o.bC(_,t.u_scale_with_map),u_pitch_with_map:new o.bC(_,t.u_pitch_with_map),u_extrude_scale:new o.bH(_,t.u_extrude_scale),u_device_pixel_ratio:new o.b5(_,t.u_device_pixel_ratio),u_globe_extrude_scale:new o.b5(_,t.u_globe_extrude_scale),u_translate:new o.bH(_,t.u_translate)}),collisionBox:(_,t)=>({u_pixel_extrude_scale:new o.bH(_,t.u_pixel_extrude_scale)}),collisionCircle:(_,t)=>({u_viewport_size:new o.bH(_,t.u_viewport_size)}),debug:(_,t)=>({u_color:new o.bF(_,t.u_color),u_overlay:new o.bC(_,t.u_overlay),u_overlay_scale:new o.b5(_,t.u_overlay_scale)}),depth:dc,clippingMask:dc,heatmap:(_,t)=>({u_extrude_scale:new o.b5(_,t.u_extrude_scale),u_intensity:new o.b5(_,t.u_intensity),u_globe_extrude_scale:new o.b5(_,t.u_globe_extrude_scale)}),heatmapTexture:(_,t)=>({u_matrix:new o.bD(_,t.u_matrix),u_world:new o.bH(_,t.u_world),u_image:new o.bC(_,t.u_image),u_color_ramp:new o.bC(_,t.u_color_ramp),u_opacity:new o.b5(_,t.u_opacity)}),hillshade:(_,t)=>({u_image:new o.bC(_,t.u_image),u_latrange:new o.bH(_,t.u_latrange),u_light:new o.bH(_,t.u_light),u_shadow:new o.bF(_,t.u_shadow),u_highlight:new o.bF(_,t.u_highlight),u_accent:new o.bF(_,t.u_accent)}),hillshadePrepare:(_,t)=>({u_matrix:new o.bD(_,t.u_matrix),u_image:new o.bC(_,t.u_image),u_dimension:new o.bH(_,t.u_dimension),u_zoom:new o.b5(_,t.u_zoom),u_unpack:new o.bE(_,t.u_unpack)}),line:(_,t)=>({u_translation:new o.bH(_,t.u_translation),u_ratio:new o.b5(_,t.u_ratio),u_device_pixel_ratio:new o.b5(_,t.u_device_pixel_ratio),u_units_to_pixels:new o.bH(_,t.u_units_to_pixels)}),lineGradient:(_,t)=>({u_translation:new o.bH(_,t.u_translation),u_ratio:new o.b5(_,t.u_ratio),u_device_pixel_ratio:new o.b5(_,t.u_device_pixel_ratio),u_units_to_pixels:new o.bH(_,t.u_units_to_pixels),u_image:new o.bC(_,t.u_image),u_image_height:new o.b5(_,t.u_image_height)}),linePattern:(_,t)=>({u_translation:new o.bH(_,t.u_translation),u_texsize:new o.bH(_,t.u_texsize),u_ratio:new o.b5(_,t.u_ratio),u_device_pixel_ratio:new o.b5(_,t.u_device_pixel_ratio),u_image:new o.bC(_,t.u_image),u_units_to_pixels:new o.bH(_,t.u_units_to_pixels),u_scale:new o.bG(_,t.u_scale),u_fade:new o.b5(_,t.u_fade)}),lineSDF:(_,t)=>({u_translation:new o.bH(_,t.u_translation),u_ratio:new o.b5(_,t.u_ratio),u_device_pixel_ratio:new o.b5(_,t.u_device_pixel_ratio),u_units_to_pixels:new o.bH(_,t.u_units_to_pixels),u_patternscale_a:new o.bH(_,t.u_patternscale_a),u_patternscale_b:new o.bH(_,t.u_patternscale_b),u_sdfgamma:new o.b5(_,t.u_sdfgamma),u_image:new o.bC(_,t.u_image),u_tex_y_a:new o.b5(_,t.u_tex_y_a),u_tex_y_b:new o.b5(_,t.u_tex_y_b),u_mix:new o.b5(_,t.u_mix)}),raster:(_,t)=>({u_tl_parent:new o.bH(_,t.u_tl_parent),u_scale_parent:new o.b5(_,t.u_scale_parent),u_buffer_scale:new o.b5(_,t.u_buffer_scale),u_fade_t:new o.b5(_,t.u_fade_t),u_opacity:new o.b5(_,t.u_opacity),u_image0:new o.bC(_,t.u_image0),u_image1:new o.bC(_,t.u_image1),u_brightness_low:new o.b5(_,t.u_brightness_low),u_brightness_high:new o.b5(_,t.u_brightness_high),u_saturation_factor:new o.b5(_,t.u_saturation_factor),u_contrast_factor:new o.b5(_,t.u_contrast_factor),u_spin_weights:new o.bG(_,t.u_spin_weights),u_coords_top:new o.bE(_,t.u_coords_top),u_coords_bottom:new o.bE(_,t.u_coords_bottom)}),symbolIcon:(_,t)=>({u_is_size_zoom_constant:new o.bC(_,t.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bC(_,t.u_is_size_feature_constant),u_size_t:new o.b5(_,t.u_size_t),u_size:new o.b5(_,t.u_size),u_camera_to_center_distance:new o.b5(_,t.u_camera_to_center_distance),u_pitch:new o.b5(_,t.u_pitch),u_rotate_symbol:new o.bC(_,t.u_rotate_symbol),u_aspect_ratio:new o.b5(_,t.u_aspect_ratio),u_fade_change:new o.b5(_,t.u_fade_change),u_label_plane_matrix:new o.bD(_,t.u_label_plane_matrix),u_coord_matrix:new o.bD(_,t.u_coord_matrix),u_is_text:new o.bC(_,t.u_is_text),u_pitch_with_map:new o.bC(_,t.u_pitch_with_map),u_is_along_line:new o.bC(_,t.u_is_along_line),u_is_variable_anchor:new o.bC(_,t.u_is_variable_anchor),u_texsize:new o.bH(_,t.u_texsize),u_texture:new o.bC(_,t.u_texture),u_translation:new o.bH(_,t.u_translation),u_pitched_scale:new o.b5(_,t.u_pitched_scale)}),symbolSDF:(_,t)=>({u_is_size_zoom_constant:new o.bC(_,t.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bC(_,t.u_is_size_feature_constant),u_size_t:new o.b5(_,t.u_size_t),u_size:new o.b5(_,t.u_size),u_camera_to_center_distance:new o.b5(_,t.u_camera_to_center_distance),u_pitch:new o.b5(_,t.u_pitch),u_rotate_symbol:new o.bC(_,t.u_rotate_symbol),u_aspect_ratio:new o.b5(_,t.u_aspect_ratio),u_fade_change:new o.b5(_,t.u_fade_change),u_label_plane_matrix:new o.bD(_,t.u_label_plane_matrix),u_coord_matrix:new o.bD(_,t.u_coord_matrix),u_is_text:new o.bC(_,t.u_is_text),u_pitch_with_map:new o.bC(_,t.u_pitch_with_map),u_is_along_line:new o.bC(_,t.u_is_along_line),u_is_variable_anchor:new o.bC(_,t.u_is_variable_anchor),u_texsize:new o.bH(_,t.u_texsize),u_texture:new o.bC(_,t.u_texture),u_gamma_scale:new o.b5(_,t.u_gamma_scale),u_device_pixel_ratio:new o.b5(_,t.u_device_pixel_ratio),u_is_halo:new o.bC(_,t.u_is_halo),u_translation:new o.bH(_,t.u_translation),u_pitched_scale:new o.b5(_,t.u_pitched_scale)}),symbolTextAndIcon:(_,t)=>({u_is_size_zoom_constant:new o.bC(_,t.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bC(_,t.u_is_size_feature_constant),u_size_t:new o.b5(_,t.u_size_t),u_size:new o.b5(_,t.u_size),u_camera_to_center_distance:new o.b5(_,t.u_camera_to_center_distance),u_pitch:new o.b5(_,t.u_pitch),u_rotate_symbol:new o.bC(_,t.u_rotate_symbol),u_aspect_ratio:new o.b5(_,t.u_aspect_ratio),u_fade_change:new o.b5(_,t.u_fade_change),u_label_plane_matrix:new o.bD(_,t.u_label_plane_matrix),u_coord_matrix:new o.bD(_,t.u_coord_matrix),u_is_text:new o.bC(_,t.u_is_text),u_pitch_with_map:new o.bC(_,t.u_pitch_with_map),u_is_along_line:new o.bC(_,t.u_is_along_line),u_is_variable_anchor:new o.bC(_,t.u_is_variable_anchor),u_texsize:new o.bH(_,t.u_texsize),u_texsize_icon:new o.bH(_,t.u_texsize_icon),u_texture:new o.bC(_,t.u_texture),u_texture_icon:new o.bC(_,t.u_texture_icon),u_gamma_scale:new o.b5(_,t.u_gamma_scale),u_device_pixel_ratio:new o.b5(_,t.u_device_pixel_ratio),u_is_halo:new o.bC(_,t.u_is_halo),u_translation:new o.bH(_,t.u_translation),u_pitched_scale:new o.b5(_,t.u_pitched_scale)}),background:(_,t)=>({u_opacity:new o.b5(_,t.u_opacity),u_color:new o.bF(_,t.u_color)}),backgroundPattern:(_,t)=>({u_opacity:new o.b5(_,t.u_opacity),u_image:new o.bC(_,t.u_image),u_pattern_tl_a:new o.bH(_,t.u_pattern_tl_a),u_pattern_br_a:new o.bH(_,t.u_pattern_br_a),u_pattern_tl_b:new o.bH(_,t.u_pattern_tl_b),u_pattern_br_b:new o.bH(_,t.u_pattern_br_b),u_texsize:new o.bH(_,t.u_texsize),u_mix:new o.b5(_,t.u_mix),u_pattern_size_a:new o.bH(_,t.u_pattern_size_a),u_pattern_size_b:new o.bH(_,t.u_pattern_size_b),u_scale_a:new o.b5(_,t.u_scale_a),u_scale_b:new o.b5(_,t.u_scale_b),u_pixel_coord_upper:new o.bH(_,t.u_pixel_coord_upper),u_pixel_coord_lower:new o.bH(_,t.u_pixel_coord_lower),u_tile_units_to_pixels:new o.b5(_,t.u_tile_units_to_pixels)}),terrain:(_,t)=>({u_texture:new o.bC(_,t.u_texture),u_ele_delta:new o.b5(_,t.u_ele_delta),u_fog_matrix:new o.bD(_,t.u_fog_matrix),u_fog_color:new o.bF(_,t.u_fog_color),u_fog_ground_blend:new o.b5(_,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new o.b5(_,t.u_fog_ground_blend_opacity),u_horizon_color:new o.bF(_,t.u_horizon_color),u_horizon_fog_blend:new o.b5(_,t.u_horizon_fog_blend),u_is_globe_mode:new o.b5(_,t.u_is_globe_mode)}),terrainDepth:(_,t)=>({u_ele_delta:new o.b5(_,t.u_ele_delta)}),terrainCoords:(_,t)=>({u_texture:new o.bC(_,t.u_texture),u_terrain_coords_id:new o.b5(_,t.u_terrain_coords_id),u_ele_delta:new o.b5(_,t.u_ele_delta)}),projectionErrorMeasurement:(_,t)=>({u_input:new o.b5(_,t.u_input),u_output_expected:new o.b5(_,t.u_output_expected)}),atmosphere:(_,t)=>({u_sun_pos:new o.bG(_,t.u_sun_pos),u_atmosphere_blend:new o.b5(_,t.u_atmosphere_blend),u_globe_position:new o.bG(_,t.u_globe_position),u_globe_radius:new o.b5(_,t.u_globe_radius),u_inv_proj_matrix:new o.bD(_,t.u_inv_proj_matrix)}),sky:(_,t)=>({u_sky_color:new o.bF(_,t.u_sky_color),u_horizon_color:new o.bF(_,t.u_horizon_color),u_horizon:new o.bH(_,t.u_horizon),u_horizon_normal:new o.bH(_,t.u_horizon_normal),u_sky_horizon_blend:new o.b5(_,t.u_sky_horizon_blend),u_sky_blend:new o.b5(_,t.u_sky_blend)})};class Xu{constructor(t,r,d){this.context=t;const h=t.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!d,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const r=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Vs={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ku{constructor(t,r,d,h){this.length=r.length,this.attributes=d,this.itemSize=r.bytesPerElement,this.dynamicDraw=h,this.context=t;const y=t.gl;this.buffer=y.createBuffer(),t.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const r=this.context.gl;this.bind(),r.bufferSubData(r.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,r){for(let d=0;d<this.attributes.length;d++){const h=r.attributes[this.attributes[d].name];h!==void 0&&t.enableVertexAttribArray(h)}}setVertexAttribPointers(t,r,d){for(let h=0;h<this.attributes.length;h++){const y=this.attributes[h],x=r.attributes[y.name];x!==void 0&&t.vertexAttribPointer(x,y.components,t[Vs[y.type]],!1,this.itemSize,y.offset+this.itemSize*(d||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Un{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Wm extends Un{getDefault(){return o.b4.transparent}set(t){const r=this.current;(t.r!==r.r||t.g!==r.g||t.b!==r.b||t.a!==r.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Xm extends Un{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Km extends Un{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class sf extends Un{getDefault(){return[!0,!0,!0,!0]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||t[3]!==r[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Ym extends Un{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class of extends Un{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class hc extends Un{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const r=this.current;(t.func!==r.func||t.ref!==r.ref||t.mask!==r.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class fc extends Un{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class pc extends Un{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST),this.current=t,this.dirty=!1}}class Yu extends Un{getDefault(){return[0,1]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Ns extends Un{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST),this.current=t,this.dirty=!1}}class bo extends Un{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class ea extends Un{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.BLEND):r.disable(r.BLEND),this.current=t,this.dirty=!1}}class lf extends Un{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class cf extends Un{getDefault(){return o.b4.transparent}set(t){const r=this.current;(t.r!==r.r||t.g!==r.g||t.b!==r.b||t.a!==r.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Ju extends Un{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class $s extends Un{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),this.current=t,this.dirty=!1}}class mc extends Un{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class gc extends Un{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class fl extends Un{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class _c extends Un{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class uf extends Un{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||t[3]!==r[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class xo extends Un{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class wo extends Un{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class df extends Un{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindTexture(r.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Qu extends Un{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Fn extends Un{getDefault(){return null}set(t){const r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class yc extends Un{getDefault(){return null}set(t){var r;if(t===this.current&&!this.dirty)return;const d=this.gl;ha(d)?d.bindVertexArray(t):(r=d.getExtension("OES_vertex_array_object"))===null||r===void 0||r.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class Jm extends Un{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class hf extends Un{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class pl extends Un{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class ed extends Un{constructor(t,r){super(t),this.context=t,this.parent=r}getDefault(){return null}}class Qm extends ed{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class ff extends ed{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class eg extends ed{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,t),this.current=t,this.dirty=!1}}const vc="Framebuffer is not complete";class bc{constructor(t,r,d,h,y){this.context=t,this.width=r,this.height=d;const x=t.gl,S=this.framebuffer=x.createFramebuffer();if(this.colorAttachment=new Qm(t,S),h)this.depthAttachment=y?new eg(t,S):new ff(t,S);else if(y)throw new Error("Stencil cannot be set without depth");if(x.checkFramebufferStatus(x.FRAMEBUFFER)!==x.FRAMEBUFFER_COMPLETE)throw new Error(vc)}destroy(){const t=this.context.gl,r=this.colorAttachment.get();if(r&&t.deleteTexture(r),this.depthAttachment){const d=this.depthAttachment.get();d&&t.deleteRenderbuffer(d)}t.deleteFramebuffer(this.framebuffer)}}class xc{constructor(t){var r,d;if(this.gl=t,this.clearColor=new Wm(this),this.clearDepth=new Xm(this),this.clearStencil=new Km(this),this.colorMask=new sf(this),this.depthMask=new Ym(this),this.stencilMask=new of(this),this.stencilFunc=new hc(this),this.stencilOp=new fc(this),this.stencilTest=new pc(this),this.depthRange=new Yu(this),this.depthTest=new Ns(this),this.depthFunc=new bo(this),this.blend=new ea(this),this.blendFunc=new lf(this),this.blendColor=new cf(this),this.blendEquation=new Ju(this),this.cullFace=new $s(this),this.cullFaceSide=new mc(this),this.frontFace=new gc(this),this.program=new fl(this),this.activeTexture=new _c(this),this.viewport=new uf(this),this.bindFramebuffer=new xo(this),this.bindRenderbuffer=new wo(this),this.bindTexture=new df(this),this.bindVertexBuffer=new Qu(this),this.bindElementBuffer=new Fn(this),this.bindVertexArray=new yc(this),this.pixelStoreUnpack=new Jm(this),this.pixelStoreUnpackPremultiplyAlpha=new hf(this),this.pixelStoreUnpackFlipY=new pl(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),ha(t)){this.HALF_FLOAT=t.HALF_FLOAT;const h=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(r=t.RGBA16F)!==null&&r!==void 0?r:h==null?void 0:h.RGBA16F_EXT,this.RGB16F=(d=t.RGB16F)!==null&&d!==void 0?d:h==null?void 0:h.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const h=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=h==null?void 0:h.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,r){return new Xu(this,t,r)}createVertexBuffer(t,r,d){return new Ku(this,t,r,d)}createRenderbuffer(t,r,d){const h=this.gl,y=h.createRenderbuffer();return this.bindRenderbuffer.set(y),h.renderbufferStorage(h.RENDERBUFFER,t,r,d),this.bindRenderbuffer.set(null),y}createFramebuffer(t,r,d,h){return new bc(this,t,r,d,h)}clear({color:t,depth:r,stencil:d}){const h=this.gl;let y=0;t&&(y|=h.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),r!==void 0&&(y|=h.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),d!==void 0&&(y|=h.STENCIL_BUFFER_BIT,this.clearStencil.set(d),this.stencilMask.set(255)),h.clear(y)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){o.bz(t.blendFunction,li.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return ha(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var r;return ha(this.gl)?this.gl.deleteVertexArray(t):(r=this.gl.getExtension("OES_vertex_array_object"))===null||r===void 0?void 0:r.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}let So;function wc(_,t,r,d,h){const y=_.context,x=_.transform,S=y.gl,P=_.useProgram("collisionBox"),A=[];let F=0,N=0;for(let ue=0;ue<d.length;ue++){const fe=d[ue],we=t.getTile(fe).getBucket(r);if(!we)continue;const Te=h?we.textCollisionBox:we.iconCollisionBox,Ie=we.collisionCircleArray;Ie.length>0&&(A.push({circleArray:Ie,circleOffset:N,coord:fe}),F+=Ie.length/4,N=F),Te&&P.draw(y,S.LINES,yn.disabled,Ln.disabled,_.colorModeForRenderPass(),Rn.disabled,Qh(_.transform),_.style.map.terrain&&_.style.map.terrain.getTerrainData(fe),x.getProjectionData({overscaledTileID:fe,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),r.id,Te.layoutVertexBuffer,Te.indexBuffer,Te.segments,null,_.transform.zoom,null,null,Te.collisionVertexBuffer)}if(!h||!A.length)return;const j=_.useProgram("collisionCircle"),X=new o.bM;X.resize(4*F),X._trim();let J=0;for(const ue of A)for(let fe=0;fe<ue.circleArray.length/4;fe++){const we=4*fe,Te=ue.circleArray[we+0],Ie=ue.circleArray[we+1],De=ue.circleArray[we+2],Re=ue.circleArray[we+3];X.emplace(J++,Te,Ie,De,Re,0),X.emplace(J++,Te,Ie,De,Re,1),X.emplace(J++,Te,Ie,De,Re,2),X.emplace(J++,Te,Ie,De,Re,3)}(!So||So.length<2*F)&&(So=function(ue){const fe=2*ue,we=new o.bO;we.resize(fe),we._trim();for(let Te=0;Te<fe;Te++){const Ie=6*Te;we.uint16[Ie+0]=4*Te+0,we.uint16[Ie+1]=4*Te+1,we.uint16[Ie+2]=4*Te+2,we.uint16[Ie+3]=4*Te+2,we.uint16[Ie+4]=4*Te+3,we.uint16[Ie+5]=4*Te+0}return we}(F));const le=y.createIndexBuffer(So,!0),se=y.createVertexBuffer(X,o.bN.members,!0);for(const ue of A){const fe=ef(_.transform);j.draw(y,S.TRIANGLES,yn.disabled,Ln.disabled,_.colorModeForRenderPass(),Rn.disabled,fe,_.style.map.terrain&&_.style.map.terrain.getTerrainData(ue.coord),null,r.id,se,le,o.aD.simpleSegment(0,2*ue.circleOffset,ue.circleArray.length,ue.circleArray.length/2),null,_.transform.zoom,null,null,null)}se.destroy(),le.destroy()}const pf=o.aq(new Float32Array(16));function Sc(_,t,r,d,h,y){const{horizontalAlign:x,verticalAlign:S}=o.ay(_);return new o.P((-(x-.5)*t/h+d[0])*y,(-(S-.5)*r/h+d[1])*y)}function Cc(_,t,r,d,h,y){const x=t.tileAnchorPoint.add(new o.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let S=d.mult(y);r||(S=S.rotate(-h));const P=x.add(S);return Je(P.x,P.y,t.pitchedLabelPlaneMatrix,t.getElevation).point}if(r){const S=Ut(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(_),P=Math.atan(S.y/S.x)+(S.x<0?Math.PI:0);return _.add(d.rotate(P))}return _.add(d)}function td(_,t,r,d,h,y,x,S,P,A,F,N){const j=_.text.placedSymbolArray,X=_.text.dynamicLayoutVertexArray,J=_.icon.dynamicLayoutVertexArray,le={};X.clear();for(let se=0;se<j.length;se++){const ue=j.get(se),fe=ue.hidden||!ue.crossTileID||_.allowVerticalPlacement&&!ue.placedOrientation?null:d[ue.crossTileID];if(fe){const we=new o.P(ue.anchorX,ue.anchorY),Te={getElevation:N,width:h.width,height:h.height,pitchedLabelPlaneMatrix:y,lineVertexArray:null,pitchWithMap:r,transform:h,projectionCache:null,tileAnchorPoint:we,translation:A,unwrappedTileID:F},Ie=r?zn(we.x,we.y,Te):Ut(we.x,we.y,Te),De=Ue(h.cameraToCenterDistance,Ie.signedDistanceFromCamera);let Re=o.aj(_.textSizeData,S,ue)*De/o.as;r&&(Re*=_.tilePixelRatio/x);const{width:Ge,height:Ze,anchor:rt,textOffset:lt,textBoxScale:et}=fe,Pt=Sc(rt,Ge,Ze,lt,et,Re),St=h.getPitchedTextCorrection(we.x+A[0],we.y+A[1],F),pt=Cc(Ie.point,Te,t,Pt,-h.bearingInRadians,St),Dt=_.allowVerticalPlacement&&ue.placedOrientation===o.ai.vertical?Math.PI/2:0;for(let vn=0;vn<ue.numGlyphs;vn++)o.ak(X,pt,Dt);P&&ue.associatedIconIndex>=0&&(le[ue.associatedIconIndex]={shiftedAnchor:pt,angle:Dt})}else qi(ue.numGlyphs,X)}if(P){J.clear();const se=_.icon.placedSymbolArray;for(let ue=0;ue<se.length;ue++){const fe=se.get(ue);if(fe.hidden)qi(fe.numGlyphs,J);else{const we=le[ue];if(we)for(let Te=0;Te<fe.numGlyphs;Te++)o.ak(J,we.shiftedAnchor,we.angle);else qi(fe.numGlyphs,J)}}_.icon.dynamicLayoutVertexBuffer.updateData(J)}_.text.dynamicLayoutVertexBuffer.updateData(X)}function tg(_,t,r){return r.iconsInText&&t?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function Tc(_,t,r,d,h,y,x,S,P,A,F,N,j){const X=_.context,J=X.gl,le=_.transform,se=S==="map",ue=P==="map",fe=S!=="viewport"&&r.layout.get("symbol-placement")!=="point",we=se&&!ue&&!fe,Te=!r.layout.get("symbol-sort-key").isConstant();let Ie=!1;const De=_.getDepthModeForSublayer(0,yn.ReadOnly),Re=r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ge=[],Ze=le.getCircleRadiusCorrection();for(const rt of d){const lt=t.getTile(rt),et=lt.getBucket(r);if(!et)continue;const Pt=h?et.text:et.icon;if(!Pt||!Pt.segments.get().length||!Pt.hasVisibleVertices)continue;const St=Pt.programConfigurations.get(r.id),pt=h||et.sdfIcons,Dt=h?et.textSizeData:et.iconSizeData,vn=ue||le.pitch!==0,Bn=_.useProgram(tg(pt,h,et),St),gi=o.ah(Dt,le.zoom),Xn=_.style.map.terrain&&_.style.map.terrain.getTerrainData(rt);let _i,Kn,Hn,Yn,lr=[0,0],Ni=null;if(h)Kn=lt.glyphAtlasTexture,Hn=J.LINEAR,_i=lt.glyphAtlasTexture.size,et.iconsInText&&(lr=lt.imageAtlasTexture.size,Ni=lt.imageAtlasTexture,Yn=vn||_.options.rotating||_.options.zooming||Dt.kind==="composite"||Dt.kind==="camera"?J.LINEAR:J.NEAREST);else{const Jn=r.layout.get("icon-size").constantOr(0)!==1||et.iconsNeedLinear;Kn=lt.imageAtlasTexture,Hn=pt||_.options.rotating||_.options.zooming||Jn||vn?J.LINEAR:J.NEAREST,_i=lt.imageAtlasTexture.size}const $i=o.at(lt,1,_.transform.zoom),Sr=qe(se,_.transform,$i),Xa=o.H();o.an(Xa,Sr);const Ra=Ve(ue,se,_.transform,$i),Nr=o.au(le,lt,y,x),Ka=le.getProjectionData({overscaledTileID:rt,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),Il=Re&&et.hasTextData(),Ml=r.layout.get("icon-text-fit")!=="none"&&Il&&et.hasIconData();if(fe){const Jn=_.style.map.terrain?(jr,xi)=>_.style.map.terrain.getElevation(rt,jr,xi):null,yi=r.layout.get("text-rotation-alignment")==="map";kt(et,_,h,Sr,Xa,ue,A,yi,rt.toUnwrapped(),le.width,le.height,Nr,Jn)}const zo=h&&Re||Ml,Rr=fe||zo?pf:ue?Sr:_.transform.clipSpaceToPixelsMatrix,na=pt&&r.paint.get(h?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ia;ia=pt?et.iconsInText?Ha(Dt.kind,gi,we,ue,fe,zo,_,Rr,Ra,Nr,_i,lr,Ze):hl(Dt.kind,gi,we,ue,fe,zo,_,Rr,Ra,Nr,h,_i,0,Ze):Zu(Dt.kind,gi,we,ue,fe,zo,_,Rr,Ra,Nr,h,_i,Ze);const $r={program:Bn,buffers:Pt,uniformValues:ia,projectionData:Ka,atlasTexture:Kn,atlasTextureIcon:Ni,atlasInterpolation:Hn,atlasInterpolationIcon:Yn,isSDF:pt,hasHalo:na};if(Te&&et.canOverlap){Ie=!0;const Jn=Pt.segments.get();for(const yi of Jn)Ge.push({segments:new o.aD([yi]),sortKey:yi.sortKey,state:$r,terrainData:Xn})}else Ge.push({segments:Pt.segments,sortKey:0,state:$r,terrainData:Xn})}Ie&&Ge.sort((rt,lt)=>rt.sortKey-lt.sortKey);for(const rt of Ge){const lt=rt.state;if(X.activeTexture.set(J.TEXTURE0),lt.atlasTexture.bind(lt.atlasInterpolation,J.CLAMP_TO_EDGE),lt.atlasTextureIcon&&(X.activeTexture.set(J.TEXTURE1),lt.atlasTextureIcon&&lt.atlasTextureIcon.bind(lt.atlasInterpolationIcon,J.CLAMP_TO_EDGE)),lt.isSDF){const et=lt.uniformValues;lt.hasHalo&&(et.u_is_halo=1,mf(lt.buffers,rt.segments,r,_,lt.program,De,F,N,et,lt.projectionData,rt.terrainData)),et.u_is_halo=0}mf(lt.buffers,rt.segments,r,_,lt.program,De,F,N,lt.uniformValues,lt.projectionData,rt.terrainData)}}function mf(_,t,r,d,h,y,x,S,P,A,F){const N=d.context;h.draw(N,N.gl.TRIANGLES,y,x,S,Rn.backCCW,P,F,A,r.id,_.layoutVertexBuffer,_.indexBuffer,t,r.paint,d.transform.zoom,_.programConfigurations.get(r.id),_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer)}function gf(_,t,r,d,h){const y=_.context,x=y.gl,S=Ln.disabled,P=new li([x.ONE,x.ONE],o.b4.transparent,[!0,!0,!0,!0]),A=t.getBucket(r);if(!A)return;const F=d.key;let N=r.heatmapFbos.get(F);N||(N=kc(y,t.tileSize,t.tileSize),r.heatmapFbos.set(F,N)),y.bindFramebuffer.set(N.framebuffer),y.viewport.set([0,0,t.tileSize,t.tileSize]),y.clear({color:o.b4.transparent});const j=A.programConfigurations.get(r.id),X=_.useProgram("heatmap",j,!h),J=_.transform.getProjectionData({overscaledTileID:t.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),le=_.style.map.terrain.getTerrainData(d);X.draw(y,x.TRIANGLES,yn.disabled,S,P,Rn.disabled,$u(t,_.transform.zoom,r.paint.get("heatmap-intensity"),1),le,J,r.id,A.layoutVertexBuffer,A.indexBuffer,A.segments,r.paint,_.transform.zoom,j)}function Pc(_,t,r,d,h){const y=_.context,x=y.gl,S=_.transform;y.setColorMode(_.colorModeForRenderPass());const P=nd(y,t),A=r.key,F=t.heatmapFbos.get(A);if(!F)return;y.activeTexture.set(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,F.colorAttachment.get()),y.activeTexture.set(x.TEXTURE1),P.bind(x.LINEAR,x.CLAMP_TO_EDGE);const N=S.getProjectionData({overscaledTileID:r,applyTerrainMatrix:h,applyGlobeMatrix:!d});_.useProgram("heatmapTexture").draw(y,x.TRIANGLES,yn.disabled,Ln.disabled,_.colorModeForRenderPass(),Rn.disabled,ds(_,t,0,1),null,N,t.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments,t.paint,S.zoom),F.destroy(),t.heatmapFbos.delete(A)}function kc(_,t,r){var d,h;const y=_.gl,x=y.createTexture();y.bindTexture(y.TEXTURE_2D,x),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.LINEAR);const S=(d=_.HALF_FLOAT)!==null&&d!==void 0?d:y.UNSIGNED_BYTE,P=(h=_.RGBA16F)!==null&&h!==void 0?h:y.RGBA;y.texImage2D(y.TEXTURE_2D,0,P,t,r,0,y.RGBA,S,null);const A=_.createFramebuffer(t,r,!1,!1);return A.colorAttachment.set(x),A}function nd(_,t){return t.colorRampTexture||(t.colorRampTexture=new ye(_,t.colorRamp,_.gl.RGBA)),t.colorRampTexture}function id(_,t,r,d,h){if(!r||!d||!d.imageAtlas)return;const y=d.imageAtlas.patternPositions;let x=y[r.to.toString()],S=y[r.from.toString()];if(!x&&S&&(x=S),!S&&x&&(S=x),!x||!S){const P=h.getPaintProperty(t);x=y[P],S=y[P]}x&&S&&_.setConstantPatternPositions(x,S)}function ml(_,t,r,d,h,y,x,S){const P=_.context.gl,A="fill-pattern",F=r.paint.get(A),N=F&&F.constantOr(1),j=r.getCrossfadeParameters();let X,J,le,se,ue;const fe=_.transform,we=r.paint.get("fill-translate"),Te=r.paint.get("fill-translate-anchor");x?(J=N&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",X=P.LINES):(J=N?"fillPattern":"fill",X=P.TRIANGLES);const Ie=F.constantOr(null);for(const De of d){const Re=t.getTile(De);if(N&&!Re.patternsLoaded())continue;const Ge=Re.getBucket(r);if(!Ge)continue;const Ze=Ge.programConfigurations.get(r.id),rt=_.useProgram(J,Ze),lt=_.style.map.terrain&&_.style.map.terrain.getTerrainData(De);N&&(_.context.activeTexture.set(P.TEXTURE0),Re.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),Ze.updatePaintBuffers(j)),id(Ze,A,Ie,Re,r);const et=fe.getProjectionData({overscaledTileID:De,applyGlobeMatrix:!S,applyTerrainMatrix:!0}),Pt=o.au(fe,Re,we,Te);if(x){se=Ge.indexBuffer2,ue=Ge.segments2;const pt=[P.drawingBufferWidth,P.drawingBufferHeight];le=J==="fillOutlinePattern"&&N?Jh(_,j,Re,pt,Pt):Hm(pt,Pt)}else se=Ge.indexBuffer,ue=Ge.segments,le=N?Ou(_,j,Re,Pt):{u_fill_translate:Pt};let St;if(_.renderPass==="translucent"&&S){const[pt]=_.getStencilConfigForOverlapAndUpdateStencilID(d);St=pt[De.overscaledZ]}else St=_.stencilModeForClipping(De);rt.draw(_.context,X,h,St,y,Rn.backCCW,le,lt,et,r.id,Ge.layoutVertexBuffer,se,ue,r.paint,_.transform.zoom,Ze)}}function gl(_,t,r,d,h,y,x,S){const P=_.context,A=P.gl,F="fill-extrusion-pattern",N=r.paint.get(F),j=N.constantOr(1),X=r.getCrossfadeParameters(),J=r.paint.get("fill-extrusion-opacity"),le=N.constantOr(null),se=_.transform;for(const ue of d){const fe=t.getTile(ue),we=fe.getBucket(r);if(!we)continue;const Te=_.style.map.terrain&&_.style.map.terrain.getTerrainData(ue),Ie=we.programConfigurations.get(r.id),De=_.useProgram(j?"fillExtrusionPattern":"fillExtrusion",Ie);j&&(_.context.activeTexture.set(A.TEXTURE0),fe.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),Ie.updatePaintBuffers(X));const Re=se.getProjectionData({overscaledTileID:ue,applyGlobeMatrix:!S,applyTerrainMatrix:!0});id(Ie,F,le,fe,r);const Ge=o.au(se,fe,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),Ze=r.paint.get("fill-extrusion-vertical-gradient"),rt=j?Gm(_,Ze,J,Ge,ue,X,fe):Os(_,Ze,J,Ge);De.draw(P,P.gl.TRIANGLES,h,y,x,Rn.backCCW,rt,Te,Re,r.id,we.layoutVertexBuffer,we.indexBuffer,we.segments,r.paint,_.transform.zoom,Ie,_.style.map.terrain&&we.centroidVertexBuffer)}}function rd(_,t,r,d,h,y,x,S,P){var A;const F=_.style.projection,N=_.context,j=_.transform,X=N.gl,J=_.useProgram("hillshade"),le=!_.options.moving;for(const se of d){const ue=t.getTile(se),fe=ue.fbo;if(!fe)continue;const we=F.getMeshFromTileID(N,se.canonical,S,!0,"raster"),Te=(A=_.style.map.terrain)===null||A===void 0?void 0:A.getTerrainData(se);N.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,fe.colorAttachment.get());const Ie=j.getProjectionData({overscaledTileID:se,aligned:le,applyGlobeMatrix:!P,applyTerrainMatrix:!0});J.draw(N,X.TRIANGLES,y,h[se.overscaledZ],x,Rn.backCCW,tf(_,ue,r),Te,Ie,r.id,we.vertexBuffer,we.indexBuffer,we.segments)}}const Ic=[new o.P(0,0),new o.P(o.X,0),new o.P(o.X,o.X),new o.P(0,o.X)];function pi(_,t,r,d,h,y,x,S,P=!1,A=!1){const F=d[d.length-1].overscaledZ,N=_.context,j=N.gl,X=_.useProgram("raster"),J=_.transform,le=_.style.projection,se=_.colorModeForRenderPass(),ue=!_.options.moving;for(const fe of d){const we=_.getDepthModeForSublayer(fe.overscaledZ-F,r.paint.get("raster-opacity")===1?yn.ReadWrite:yn.ReadOnly,j.LESS),Te=t.getTile(fe);Te.registerFadeDuration(r.paint.get("raster-fade-duration"));const Ie=t.findLoadedParent(fe,0),De=t.findLoadedSibling(fe),Re=js(Te,Ie||De||null,t,r,_.transform,_.style.map.terrain);let Ge,Ze;const rt=r.paint.get("raster-resampling")==="nearest"?j.NEAREST:j.LINEAR;N.activeTexture.set(j.TEXTURE0),Te.texture.bind(rt,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),N.activeTexture.set(j.TEXTURE1),Ie?(Ie.texture.bind(rt,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),Ge=Math.pow(2,Ie.tileID.overscaledZ-Te.tileID.overscaledZ),Ze=[Te.tileID.canonical.x*Ge%1,Te.tileID.canonical.y*Ge%1]):Te.texture.bind(rt,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),Te.texture.useMipmap&&N.extTextureFilterAnisotropic&&_.transform.pitch>20&&j.texParameterf(j.TEXTURE_2D,N.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,N.extTextureFilterAnisotropicMax);const lt=_.style.map.terrain&&_.style.map.terrain.getTerrainData(fe),et=J.getProjectionData({overscaledTileID:fe,aligned:ue,applyGlobeMatrix:!A,applyTerrainMatrix:!0}),Pt=rf(Ze||[0,0],Ge||1,Re,r,S),St=le.getMeshFromTileID(N,fe.canonical,y,x,"raster");X.draw(N,j.TRIANGLES,we,h?h[fe.overscaledZ]:Ln.disabled,se,P?Rn.frontCCW:Rn.backCCW,Pt,lt,et,r.id,St.vertexBuffer,St.indexBuffer,St.segments)}}function js(_,t,r,d,h,y){const x=d.paint.get("raster-fade-duration");if(!y&&x>0){const S=O.now(),P=(S-_.timeAdded)/x,A=t?(S-t.timeAdded)/x:-1,F=r.getSource(),N=Er(h,{tileSize:F.tileSize,roundZoom:F.roundZoom}),j=!t||Math.abs(t.tileID.overscaledZ-N)>Math.abs(_.tileID.overscaledZ-N),X=j&&_.refreshedUponExpiration?1:o.ab(j?P:1-A,0,1);return _.refreshedUponExpiration&&P>=1&&(_.refreshedUponExpiration=!1),t?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}const ta=new o.b4(1,0,0,1),ad=new o.b4(0,1,0,1),sd=new o.b4(0,0,1,1),_f=new o.b4(1,0,1,1),Co=new o.b4(0,1,1,1);function To(_,t,r,d){_l(_,0,t+r/2,_.transform.width,r,d)}function Mc(_,t,r,d){_l(_,t-r/2,0,r,_.transform.height,d)}function _l(_,t,r,d,h,y){const x=_.context,S=x.gl;S.enable(S.SCISSOR_TEST),S.scissor(t*_.pixelRatio,r*_.pixelRatio,d*_.pixelRatio,h*_.pixelRatio),x.clear({color:y}),S.disable(S.SCISSOR_TEST)}function yf(_,t,r){const d=_.context,h=d.gl,y=_.useProgram("debug"),x=yn.disabled,S=Ln.disabled,P=_.colorModeForRenderPass(),A="$debug",F=_.style.map.terrain&&_.style.map.terrain.getTerrainData(r);d.activeTexture.set(h.TEXTURE0);const N=t.getTileByID(r.key).latestRawTileData,j=Math.floor((N&&N.byteLength||0)/1024),X=t.getTile(r).tileSize,J=512/Math.min(X,512)*(r.overscaledZ/_.transform.zoom)*.5;let le=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(le+=` => ${r.overscaledZ}`),function(ue,fe){ue.initDebugOverlayCanvas();const we=ue.debugOverlayCanvas,Te=ue.context.gl,Ie=ue.debugOverlayCanvas.getContext("2d");Ie.clearRect(0,0,we.width,we.height),Ie.shadowColor="white",Ie.shadowBlur=2,Ie.lineWidth=1.5,Ie.strokeStyle="white",Ie.textBaseline="top",Ie.font="bold 36px Open Sans, sans-serif",Ie.fillText(fe,5,5),Ie.strokeText(fe,5,5),ue.debugOverlayTexture.update(we),ue.debugOverlayTexture.bind(Te.LINEAR,Te.CLAMP_TO_EDGE)}(_,`${le} ${j}kB`);const se=_.transform.getProjectionData({overscaledTileID:r,applyGlobeMatrix:!0,applyTerrainMatrix:!0});y.draw(d,h.TRIANGLES,x,S,li.alphaBlended,Rn.disabled,Nu(o.b4.transparent,J),null,se,A,_.debugBuffer,_.quadTriangleIndexBuffer,_.debugSegments),y.draw(d,h.LINE_STRIP,x,S,P,Rn.disabled,Nu(o.b4.red),F,se,A,_.debugBuffer,_.tileBorderIndexBuffer,_.debugSegments)}function od(_,t,r,d){const{isRenderingGlobe:h}=d,y=_.context,x=y.gl,S=_.transform,P=_.colorModeForRenderPass(),A=_.getDepthModeFor3D(),F=_.useProgram("terrain");y.bindFramebuffer.set(null),y.viewport.set([0,0,_.width,_.height]);for(const N of r){const j=t.getTerrainMesh(N.tileID),X=_.renderToTexture.getTexture(N),J=t.getTerrainData(N.tileID);y.activeTexture.set(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,X.texture);const le=t.getMeshFrameDelta(S.zoom),se=S.calculateFogMatrix(N.tileID.toUnwrapped()),ue=cl(le,se,_.style.sky,S.pitch,h),fe=S.getProjectionData({overscaledTileID:N.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});F.draw(y,x.TRIANGLES,A,Ln.disabled,P,Rn.backCCW,ue,J,fe,"terrain",j.vertexBuffer,j.indexBuffer,j.segments)}}function ld(_,t){if(!t.mesh){const r=new o.aC;r.emplaceBack(-1,-1),r.emplaceBack(1,-1),r.emplaceBack(1,1),r.emplaceBack(-1,1);const d=new o.aE;d.emplaceBack(0,1,2),d.emplaceBack(0,2,3),t.mesh=new Ia(_.createVertexBuffer(r,Pn.members),_.createIndexBuffer(d),o.aD.simpleSegment(0,0,r.length,d.length))}return t.mesh}class vf{constructor(t,r){this.context=new xc(t),this.transform=r,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.aq(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=W.maxUnderzooming+W.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ds}resize(t,r,d){if(this.width=Math.floor(t*d),this.height=Math.floor(r*d),this.pixelRatio=d,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const h of this.style._order)this.style._layers[h].resize()}setup(){const t=this.context,r=new o.aC;r.emplaceBack(0,0),r.emplaceBack(o.X,0),r.emplaceBack(0,o.X),r.emplaceBack(o.X,o.X),this.tileExtentBuffer=t.createVertexBuffer(r,Pn.members),this.tileExtentSegments=o.aD.simpleSegment(0,0,4,2);const d=new o.aC;d.emplaceBack(0,0),d.emplaceBack(o.X,0),d.emplaceBack(0,o.X),d.emplaceBack(o.X,o.X),this.debugBuffer=t.createVertexBuffer(d,Pn.members),this.debugSegments=o.aD.simpleSegment(0,0,4,5);const h=new o.bT;h.emplaceBack(0,0,0,0),h.emplaceBack(o.X,0,o.X,0),h.emplaceBack(0,o.X,0,o.X),h.emplaceBack(o.X,o.X,o.X,o.X),this.rasterBoundsBuffer=t.createVertexBuffer(h,Um.members),this.rasterBoundsSegments=o.aD.simpleSegment(0,0,4,2);const y=new o.aC;y.emplaceBack(0,0),y.emplaceBack(o.X,0),y.emplaceBack(0,o.X),y.emplaceBack(o.X,o.X),this.rasterBoundsBufferPosOnly=t.createVertexBuffer(y,Pn.members),this.rasterBoundsSegmentsPosOnly=o.aD.simpleSegment(0,0,4,5);const x=new o.aC;x.emplaceBack(0,0),x.emplaceBack(1,0),x.emplaceBack(0,1),x.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(x,Pn.members),this.viewportSegments=o.aD.simpleSegment(0,0,4,2);const S=new o.bU;S.emplaceBack(0),S.emplaceBack(1),S.emplaceBack(3),S.emplaceBack(2),S.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(S);const P=new o.aE;P.emplaceBack(1,0,2),P.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(P);const A=this.context.gl;this.stencilClearMode=new Ln({func:A.ALWAYS,mask:0},0,255,A.ZERO,A.ZERO,A.ZERO),this.tileExtentMesh=new Ia(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const t=this.context,r=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const d=o.H();o.bL(d,0,this.width,this.height,0,0,1),o.K(d,d,[r.drawingBufferWidth,r.drawingBufferHeight,0]);const h={mainMatrix:d,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:d};this.useProgram("clippingMask",null,!0).draw(t,r.TRIANGLES,yn.disabled,this.stencilClearMode,li.disabled,Rn.disabled,null,null,h,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,r,d){if(this.currentStencilSource===t.source||!t.isTileClipped()||!r||!r.length)return;this.currentStencilSource=t.source,this.nextStencilID+r.length>256&&this.clearStencil();const h=this.context;h.setColorMode(li.disabled),h.setDepthMode(yn.disabled);const y={};for(const x of r)y[x.key]=this.nextStencilID++;this._renderTileMasks(y,r,d,!0),this._renderTileMasks(y,r,d,!1),this._tileClippingMaskIDs=y}_renderTileMasks(t,r,d,h){const y=this.context,x=y.gl,S=this.style.projection,P=this.transform,A=this.useProgram("clippingMask");for(const F of r){const N=t[F.key],j=this.style.map.terrain&&this.style.map.terrain.getTerrainData(F),X=S.getMeshFromTileID(this.context,F.canonical,h,!0,"stencil"),J=P.getProjectionData({overscaledTileID:F,applyGlobeMatrix:!0,applyTerrainMatrix:!0});A.draw(y,x.TRIANGLES,yn.disabled,new Ln({func:x.ALWAYS,mask:0},N,255,x.KEEP,x.KEEP,x.REPLACE),li.disabled,d?Rn.disabled:Rn.backCCW,null,j,J,"$clipping",X.vertexBuffer,X.indexBuffer,X.segments)}}_renderTilesDepthBuffer(){const t=this.context,r=t.gl,d=this.style.projection,h=this.transform,y=this.useProgram("depth"),x=this.getDepthModeFor3D(),S=ae(h,{tileSize:h.tileSize});for(const P of S){const A=this.style.map.terrain&&this.style.map.terrain.getTerrainData(P),F=d.getMeshFromTileID(this.context,P.canonical,!0,!0,"raster"),N=h.getProjectionData({overscaledTileID:P,applyGlobeMatrix:!0,applyTerrainMatrix:!0});y.draw(t,r.TRIANGLES,x,Ln.disabled,li.disabled,Rn.backCCW,null,A,N,"$clipping",F.vertexBuffer,F.indexBuffer,F.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,r=this.context.gl;return new Ln({func:r.NOTEQUAL,mask:255},t,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(t){const r=this.context.gl;return new Ln({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,r.KEEP,r.KEEP,r.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(t){const r=this.context.gl,d=t.sort((x,S)=>S.overscaledZ-x.overscaledZ),h=d[d.length-1].overscaledZ,y=d[0].overscaledZ-h+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const x={};for(let S=0;S<y;S++)x[S+h]=new Ln({func:r.GEQUAL,mask:255},S+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=y,[x,d]}return[{[h]:Ln.disabled},d]}stencilConfigForOverlapTwoPass(t){const r=this.context.gl,d=t.sort((x,S)=>S.overscaledZ-x.overscaledZ),h=d[d.length-1].overscaledZ,y=d[0].overscaledZ-h+1;if(this.clearStencil(),y>1){const x={},S={};for(let P=0;P<y;P++)x[P+h]=new Ln({func:r.GREATER,mask:255},y+1+P,255,r.KEEP,r.KEEP,r.REPLACE),S[P+h]=new Ln({func:r.GREATER,mask:255},1+P,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID=2*y+1,[x,S,d]}return this.nextStencilID=3,[{[h]:new Ln({func:r.GREATER,mask:255},2,255,r.KEEP,r.KEEP,r.REPLACE)},{[h]:new Ln({func:r.GREATER,mask:255},1,255,r.KEEP,r.KEEP,r.REPLACE)},d]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new li([t.CONSTANT_COLOR,t.ONE],new o.b4(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?li.unblended:li.alphaBlended}getDepthModeForSublayer(t,r,d){if(!this.opaquePassEnabledForLayer())return yn.disabled;const h=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new yn(d||this.context.gl.LEQUAL,r,[h,h])}getDepthModeFor3D(){return new yn(this.context.gl.LEQUAL,yn.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,r){var d,h;this.style=t,this.options=r,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(O.now()),this.imageManager.beginFrame();const y=this.style._order,x=this.style.sourceCaches,S={},P={},A={},F={isRenderingToTexture:!1,isRenderingGlobe:((d=t.projection)===null||d===void 0?void 0:d.transitionState)>0};for(const j in x){const X=x[j];X.used&&X.prepare(this.context),S[j]=X.getVisibleCoordinates(!1),P[j]=S[j].slice().reverse(),A[j]=X.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let j=0;j<y.length;j++)if(this.style._layers[y[j]].is3D()){this.opaquePassCutoff=j;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const j of y){const X=this.style._layers[j];if(!X.hasOffscreenPass()||X.isHidden(this.transform.zoom))continue;const J=P[X.source];(X.type==="custom"||J.length)&&this.renderLayer(this,x[X.source],X,J,F)}if((h=this.style.projection)===null||h===void 0||h.updateGPUdependent({context:this.context,useProgram:j=>this.useProgram(j)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?o.b4.black:o.b4.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(j,X){const J=j.context,le=J.gl,se=((De,Re,Ge)=>{const Ze=Math.cos(Re.rollInRadians),rt=Math.sin(Re.rollInRadians),lt=bi(Re),et=Re.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:De.properties.get("sky-color"),u_horizon_color:De.properties.get("horizon-color"),u_horizon:[(Re.width/2-lt*rt)*Ge,(Re.height/2+lt*Ze)*Ge],u_horizon_normal:[-rt,Ze],u_sky_horizon_blend:De.properties.get("sky-horizon-blend")*Re.height/2*Ge,u_sky_blend:et}})(X,j.style.map.transform,j.pixelRatio),ue=new yn(le.LEQUAL,yn.ReadWrite,[0,1]),fe=Ln.disabled,we=j.colorModeForRenderPass(),Te=j.useProgram("sky"),Ie=ld(J,X);Te.draw(J,le.TRIANGLES,ue,fe,we,Rn.disabled,se,null,void 0,"sky",Ie.vertexBuffer,Ie.indexBuffer,Ie.segments)}(this,this.style.sky),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const j=this.style._layers[y[this.currentLayer]],X=x[j.source],J=S[j.source];this._renderTileClippingMasks(j,J,!1),this.renderLayer(this,X,j,J,F)}this.renderPass="translucent";let N=!1;for(this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const j=this.style._layers[y[this.currentLayer]],X=x[j.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(j,F))continue;this.opaquePassEnabledForLayer()||N||(N=!0,F.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const J=(j.type==="symbol"?A:P)[j.source];this._renderTileClippingMasks(j,S[j.source],!1),this.renderLayer(this,X,j,J,F)}if(F.isRenderingGlobe&&function(j,X,J){const le=j.context,se=le.gl,ue=j.useProgram("atmosphere"),fe=new yn(se.LEQUAL,yn.ReadOnly,[0,1]),we=j.transform,Te=function(et,Pt){const St=et.properties.get("position"),pt=[-St.x,-St.y,-St.z],Dt=o.aq(new Float64Array(16));return et.properties.get("anchor")==="map"&&(o.aX(Dt,Dt,Pt.rollInRadians),o.aY(Dt,Dt,-Pt.pitchInRadians),o.aX(Dt,Dt,Pt.bearingInRadians),o.aY(Dt,Dt,Pt.center.lat*Math.PI/180),o.bj(Dt,Dt,-Pt.center.lng*Math.PI/180)),o.bS(pt,pt,Dt),pt}(J,j.transform),Ie=we.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),De=X.properties.get("atmosphere-blend")*Ie.projectionTransition;if(De===0)return;const Re=yo(we.worldSize,we.center.lat),Ge=we.inverseProjectionMatrix,Ze=new Float64Array(4);Ze[3]=1,o.al(Ze,Ze,we.modelViewProjectionMatrix),Ze[0]/=Ze[3],Ze[1]/=Ze[3],Ze[2]/=Ze[3],Ze[3]=1,o.al(Ze,Ze,Ge),Ze[0]/=Ze[3],Ze[1]/=Ze[3],Ze[2]/=Ze[3],Ze[3]=1;const rt=((et,Pt,St,pt,Dt)=>({u_sun_pos:et,u_atmosphere_blend:Pt,u_globe_position:St,u_globe_radius:pt,u_inv_proj_matrix:Dt}))(Te,De,[Ze[0],Ze[1],Ze[2]],Re,Ge),lt=ld(le,X);ue.draw(le,se.TRIANGLES,fe,Ln.disabled,li.alphaBlended,Rn.disabled,rt,null,null,"atmosphere",lt.vertexBuffer,lt.indexBuffer,lt.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const j=function(X,J){let le=null;const se=Object.values(X._layers).flatMap(Te=>Te.source&&!Te.isHidden(J)?[X.sourceCaches[Te.source]]:[]),ue=se.filter(Te=>Te.getSource().type==="vector"),fe=se.filter(Te=>Te.getSource().type!=="vector"),we=Te=>{(!le||le.getSource().maxzoom<Te.getSource().maxzoom)&&(le=Te)};return ue.forEach(Te=>we(Te)),le||fe.forEach(Te=>we(Te)),le}(this.style,this.transform.zoom);j&&function(X,J,le){for(let se=0;se<le.length;se++)yf(X,J,le[se])}(this,j,j.getVisibleCoordinates())}this.options.showPadding&&function(j){const X=j.transform.padding;To(j,j.transform.height-(X.top||0),3,ta),To(j,X.bottom||0,3,ad),Mc(j,X.left||0,3,sd),Mc(j,j.transform.width-(X.right||0),3,_f);const J=j.transform.centerPoint;(function(le,se,ue,fe){_l(le,se-1,ue-10,2,20,fe),_l(le,se-10,ue-1,20,2,fe)})(j,J.x,j.transform.height-J.y,Co)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const r=this.terrainFacilitator.matrix,d=this.transform.modelViewProjectionMatrix;let h=this.terrainFacilitator.dirty;h||(h=t?!o.bV(r,d):!o.bW(r,d)),h||(h=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),h&&(o.bX(r,d),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(y,x){const S=y.context,P=S.gl,A=y.transform,F=li.unblended,N=new yn(P.LEQUAL,yn.ReadWrite,[0,1]),j=x.sourceCache.getRenderableTiles(),X=y.useProgram("terrainDepth");S.bindFramebuffer.set(x.getFramebuffer("depth").framebuffer),S.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),S.clear({color:o.b4.transparent,depth:1});for(const J of j){const le=x.getTerrainMesh(J.tileID),se=x.getTerrainData(J.tileID),ue=A.getProjectionData({overscaledTileID:J.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),fe={u_ele_delta:x.getMeshFrameDelta(A.zoom)};X.draw(S,P.TRIANGLES,N,Ln.disabled,F,Rn.backCCW,fe,se,ue,"terrain",le.vertexBuffer,le.indexBuffer,le.segments)}S.bindFramebuffer.set(null),S.viewport.set([0,0,y.width,y.height])}(this,this.style.map.terrain),function(y,x){const S=y.context,P=S.gl,A=y.transform,F=li.unblended,N=new yn(P.LEQUAL,yn.ReadWrite,[0,1]),j=x.getCoordsTexture(),X=x.sourceCache.getRenderableTiles(),J=y.useProgram("terrainCoords");S.bindFramebuffer.set(x.getFramebuffer("coords").framebuffer),S.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),S.clear({color:o.b4.transparent,depth:1}),x.coordsIndex=[];for(const le of X){const se=x.getTerrainMesh(le.tileID),ue=x.getTerrainData(le.tileID);S.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,j.texture);const fe={u_terrain_coords_id:(255-x.coordsIndex.length)/255,u_texture:0,u_ele_delta:x.getMeshFrameDelta(A.zoom)},we=A.getProjectionData({overscaledTileID:le.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});J.draw(S,P.TRIANGLES,N,Ln.disabled,F,Rn.backCCW,fe,ue,we,"terrain",se.vertexBuffer,se.indexBuffer,se.segments),x.coordsIndex.push(le.tileID.key)}S.bindFramebuffer.set(null),S.viewport.set([0,0,y.width,y.height])}(this,this.style.map.terrain))}renderLayer(t,r,d,h,y){d.isHidden(this.transform.zoom)||(d.type==="background"||d.type==="custom"||(h||[]).length)&&(this.id=d.id,o.bY(d)?function(x,S,P,A,F,N){if(x.renderPass!=="translucent")return;const{isRenderingToTexture:j}=N,X=Ln.disabled,J=x.colorModeForRenderPass();(P._unevaluatedLayout.hasValue("text-variable-anchor")||P._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(le,se,ue,fe,we,Te,Ie,De,Re){const Ge=se.transform,Ze=se.style.map.terrain,rt=we==="map",lt=Te==="map";for(const et of le){const Pt=fe.getTile(et),St=Pt.getBucket(ue);if(!St||!St.text||!St.text.segments.get().length)continue;const pt=o.ah(St.textSizeData,Ge.zoom),Dt=o.at(Pt,1,se.transform.zoom),vn=qe(rt,se.transform,Dt),Bn=ue.layout.get("icon-text-fit")!=="none"&&St.hasIconData();{const gi=Math.pow(2,Ge.zoom-Pt.tileID.overscaledZ),Xn=Ze?(_i,Kn)=>Ze.getElevation(et,_i,Kn):null;td(St,rt,lt,Re,Ge,vn,gi,pt,Bn,o.au(Ge,Pt,Ie,De),et.toUnwrapped(),Xn)}}}(A,x,P,S,P.layout.get("text-rotation-alignment"),P.layout.get("text-pitch-alignment"),P.paint.get("text-translate"),P.paint.get("text-translate-anchor"),F),P.paint.get("icon-opacity").constantOr(1)!==0&&Tc(x,S,P,A,!1,P.paint.get("icon-translate"),P.paint.get("icon-translate-anchor"),P.layout.get("icon-rotation-alignment"),P.layout.get("icon-pitch-alignment"),P.layout.get("icon-keep-upright"),X,J,j),P.paint.get("text-opacity").constantOr(1)!==0&&Tc(x,S,P,A,!0,P.paint.get("text-translate"),P.paint.get("text-translate-anchor"),P.layout.get("text-rotation-alignment"),P.layout.get("text-pitch-alignment"),P.layout.get("text-keep-upright"),X,J,j),S.map.showCollisionBoxes&&(wc(x,S,P,A,!0),wc(x,S,P,A,!1))}(t,r,d,h,this.style.placement.variableOffsets,y):o.bZ(d)?function(x,S,P,A,F){if(x.renderPass!=="translucent")return;const{isRenderingToTexture:N}=F,j=P.paint.get("circle-opacity"),X=P.paint.get("circle-stroke-width"),J=P.paint.get("circle-stroke-opacity"),le=!P.layout.get("circle-sort-key").isConstant();if(j.constantOr(1)===0&&(X.constantOr(1)===0||J.constantOr(1)===0))return;const se=x.context,ue=se.gl,fe=x.transform,we=x.getDepthModeForSublayer(0,yn.ReadOnly),Te=Ln.disabled,Ie=x.colorModeForRenderPass(),De=[],Re=fe.getCircleRadiusCorrection();for(let Ge=0;Ge<A.length;Ge++){const Ze=A[Ge],rt=S.getTile(Ze),lt=rt.getBucket(P);if(!lt)continue;const et=P.paint.get("circle-translate"),Pt=P.paint.get("circle-translate-anchor"),St=o.au(fe,rt,et,Pt),pt=lt.programConfigurations.get(P.id),Dt=x.useProgram("circle",pt),vn=lt.layoutVertexBuffer,Bn=lt.indexBuffer,gi=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Ze),Xn={programConfiguration:pt,program:Dt,layoutVertexBuffer:vn,indexBuffer:Bn,uniformValues:Vu(x,rt,P,St,Re),terrainData:gi,projectionData:fe.getProjectionData({overscaledTileID:Ze,applyGlobeMatrix:!N,applyTerrainMatrix:!0})};if(le){const _i=lt.segments.get();for(const Kn of _i)De.push({segments:new o.aD([Kn]),sortKey:Kn.sortKey,state:Xn})}else De.push({segments:lt.segments,sortKey:0,state:Xn})}le&&De.sort((Ge,Ze)=>Ge.sortKey-Ze.sortKey);for(const Ge of De){const{programConfiguration:Ze,program:rt,layoutVertexBuffer:lt,indexBuffer:et,uniformValues:Pt,terrainData:St,projectionData:pt}=Ge.state;rt.draw(se,ue.TRIANGLES,we,Te,Ie,Rn.backCCW,Pt,St,pt,P.id,lt,et,Ge.segments,P.paint,x.transform.zoom,Ze)}}(t,r,d,h,y):o.b_(d)?function(x,S,P,A,F){if(P.paint.get("heatmap-opacity")===0)return;const N=x.context,{isRenderingToTexture:j,isRenderingGlobe:X}=F;if(x.style.map.terrain){for(const J of A){const le=S.getTile(J);S.hasRenderableParent(J)||(x.renderPass==="offscreen"?gf(x,le,P,J,X):x.renderPass==="translucent"&&Pc(x,P,J,j,X))}N.viewport.set([0,0,x.width,x.height])}else x.renderPass==="offscreen"?function(J,le,se,ue){const fe=J.context,we=fe.gl,Te=J.transform,Ie=Ln.disabled,De=new li([we.ONE,we.ONE],o.b4.transparent,[!0,!0,!0,!0]);(function(Re,Ge,Ze){const rt=Re.gl;Re.activeTexture.set(rt.TEXTURE1),Re.viewport.set([0,0,Ge.width/4,Ge.height/4]);let lt=Ze.heatmapFbos.get(o.bP);lt?(rt.bindTexture(rt.TEXTURE_2D,lt.colorAttachment.get()),Re.bindFramebuffer.set(lt.framebuffer)):(lt=kc(Re,Ge.width/4,Ge.height/4),Ze.heatmapFbos.set(o.bP,lt))})(fe,J,se),fe.clear({color:o.b4.transparent});for(let Re=0;Re<ue.length;Re++){const Ge=ue[Re];if(le.hasRenderableParent(Ge))continue;const Ze=le.getTile(Ge),rt=Ze.getBucket(se);if(!rt)continue;const lt=rt.programConfigurations.get(se.id),et=J.useProgram("heatmap",lt),Pt=Te.getProjectionData({overscaledTileID:Ge,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),St=Te.getCircleRadiusCorrection();et.draw(fe,we.TRIANGLES,yn.disabled,Ie,De,Rn.backCCW,$u(Ze,Te.zoom,se.paint.get("heatmap-intensity"),St),null,Pt,se.id,rt.layoutVertexBuffer,rt.indexBuffer,rt.segments,se.paint,Te.zoom,lt)}fe.viewport.set([0,0,J.width,J.height])}(x,S,P,A):x.renderPass==="translucent"&&function(J,le){const se=J.context,ue=se.gl;se.setColorMode(J.colorModeForRenderPass());const fe=le.heatmapFbos.get(o.bP);fe&&(se.activeTexture.set(ue.TEXTURE0),ue.bindTexture(ue.TEXTURE_2D,fe.colorAttachment.get()),se.activeTexture.set(ue.TEXTURE1),nd(se,le).bind(ue.LINEAR,ue.CLAMP_TO_EDGE),J.useProgram("heatmapTexture").draw(se,ue.TRIANGLES,yn.disabled,Ln.disabled,J.colorModeForRenderPass(),Rn.disabled,ds(J,le,0,1),null,null,le.id,J.viewportBuffer,J.quadTriangleIndexBuffer,J.viewportSegments,le.paint,J.transform.zoom))}(x,P)}(t,r,d,h,y):o.b$(d)?function(x,S,P,A,F){if(x.renderPass!=="translucent")return;const{isRenderingToTexture:N}=F,j=P.paint.get("line-opacity"),X=P.paint.get("line-width");if(j.constantOr(1)===0||X.constantOr(1)===0)return;const J=x.getDepthModeForSublayer(0,yn.ReadOnly),le=x.colorModeForRenderPass(),se=P.paint.get("line-dasharray"),ue=P.paint.get("line-pattern"),fe=ue.constantOr(1),we=P.paint.get("line-gradient"),Te=P.getCrossfadeParameters(),Ie=fe?"linePattern":se?"lineSDF":we?"lineGradient":"line",De=x.context,Re=De.gl,Ge=x.transform;let Ze=!0;for(const rt of A){const lt=S.getTile(rt);if(fe&&!lt.patternsLoaded())continue;const et=lt.getBucket(P);if(!et)continue;const Pt=et.programConfigurations.get(P.id),St=x.context.program.get(),pt=x.useProgram(Ie,Pt),Dt=Ze||pt.program!==St,vn=x.style.map.terrain&&x.style.map.terrain.getTerrainData(rt),Bn=ue.constantOr(null);if(Bn&&lt.imageAtlas){const Hn=lt.imageAtlas,Yn=Hn.patternPositions[Bn.to.toString()],lr=Hn.patternPositions[Bn.from.toString()];Yn&&lr&&Pt.setConstantPatternPositions(Yn,lr)}const gi=Ge.getProjectionData({overscaledTileID:rt,applyGlobeMatrix:!N,applyTerrainMatrix:!0}),Xn=Ge.getPixelScale(),_i=fe?Zm(x,lt,P,Xn,Te):se?qm(x,lt,P,Xn,se,Te):we?uc(x,lt,P,Xn,et.lineClipsArray.length):ju(x,lt,P,Xn);if(fe)De.activeTexture.set(Re.TEXTURE0),lt.imageAtlasTexture.bind(Re.LINEAR,Re.CLAMP_TO_EDGE),Pt.updatePaintBuffers(Te);else if(se&&(Dt||x.lineAtlas.dirty))De.activeTexture.set(Re.TEXTURE0),x.lineAtlas.bind(De);else if(we){const Hn=et.gradients[P.id];let Yn=Hn.texture;if(P.gradientVersion!==Hn.version){let lr=256;if(P.stepInterpolant){const Ni=S.getSource().maxzoom,$i=rt.canonical.z===Ni?Math.ceil(1<<x.transform.maxZoom-rt.canonical.z):1;lr=o.ab(o.bQ(et.maxLineLength/o.X*1024*$i),256,De.maxTextureSize)}Hn.gradient=o.bR({expression:P.gradientExpression(),evaluationKey:"lineProgress",resolution:lr,image:Hn.gradient||void 0,clips:et.lineClipsArray}),Hn.texture?Hn.texture.update(Hn.gradient):Hn.texture=new ye(De,Hn.gradient,Re.RGBA),Hn.version=P.gradientVersion,Yn=Hn.texture}De.activeTexture.set(Re.TEXTURE0),Yn.bind(P.stepInterpolant?Re.NEAREST:Re.LINEAR,Re.CLAMP_TO_EDGE)}let Kn;if(N){const[Hn]=x.getStencilConfigForOverlapAndUpdateStencilID(A);Kn=Hn[rt.overscaledZ]}else Kn=x.stencilModeForClipping(rt);pt.draw(De,Re.TRIANGLES,J,Kn,le,Rn.disabled,_i,vn,gi,P.id,et.layoutVertexBuffer,et.indexBuffer,et.segments,P.paint,x.transform.zoom,Pt,et.layoutVertexBuffer2),Ze=!1}}(t,r,d,h,y):o.c0(d)?function(x,S,P,A,F){const N=P.paint.get("fill-color"),j=P.paint.get("fill-opacity");if(j.constantOr(1)===0)return;const{isRenderingToTexture:X}=F,J=x.colorModeForRenderPass(),le=P.paint.get("fill-pattern"),se=x.opaquePassEnabledForLayer()&&!le.constantOr(1)&&N.constantOr(o.b4.transparent).a===1&&j.constantOr(0)===1?"opaque":"translucent";if(x.renderPass===se){const ue=x.getDepthModeForSublayer(1,x.renderPass==="opaque"?yn.ReadWrite:yn.ReadOnly);ml(x,S,P,A,ue,J,!1,X)}if(x.renderPass==="translucent"&&P.paint.get("fill-antialias")){const ue=x.getDepthModeForSublayer(P.getPaintProperty("fill-outline-color")?2:0,yn.ReadOnly);ml(x,S,P,A,ue,J,!0,X)}}(t,r,d,h,y):o.c1(d)?function(x,S,P,A,F){const N=P.paint.get("fill-extrusion-opacity");if(N===0)return;const{isRenderingToTexture:j}=F;if(x.renderPass==="translucent"){const X=new yn(x.context.gl.LEQUAL,yn.ReadWrite,x.depthRangeFor3D);if(N!==1||P.paint.get("fill-extrusion-pattern").constantOr(1))gl(x,S,P,A,X,Ln.disabled,li.disabled,j),gl(x,S,P,A,X,x.stencilModeFor3D(),x.colorModeForRenderPass(),j);else{const J=x.colorModeForRenderPass();gl(x,S,P,A,X,Ln.disabled,J,j)}}}(t,r,d,h,y):o.c2(d)?function(x,S,P,A,F){if(x.renderPass!=="offscreen"&&x.renderPass!=="translucent")return;const{isRenderingToTexture:N}=F,j=x.context,X=x.style.projection.useSubdivision,J=x.getDepthModeForSublayer(0,yn.ReadOnly),le=x.colorModeForRenderPass();if(x.renderPass==="offscreen")(function(se,ue,fe,we,Te,Ie,De){const Re=se.context,Ge=Re.gl;for(const Ze of fe){const rt=ue.getTile(Ze),lt=rt.dem;if(!lt||!lt.data||!rt.needsHillshadePrepare)continue;const et=lt.dim,Pt=lt.stride,St=lt.getPixels();if(Re.activeTexture.set(Ge.TEXTURE1),Re.pixelStoreUnpackPremultiplyAlpha.set(!1),rt.demTexture=rt.demTexture||se.getTileTexture(Pt),rt.demTexture){const Dt=rt.demTexture;Dt.update(St,{premultiply:!1}),Dt.bind(Ge.NEAREST,Ge.CLAMP_TO_EDGE)}else rt.demTexture=new ye(Re,St,Ge.RGBA,{premultiply:!1}),rt.demTexture.bind(Ge.NEAREST,Ge.CLAMP_TO_EDGE);Re.activeTexture.set(Ge.TEXTURE0);let pt=rt.fbo;if(!pt){const Dt=new ye(Re,{width:et,height:et,data:null},Ge.RGBA);Dt.bind(Ge.LINEAR,Ge.CLAMP_TO_EDGE),pt=rt.fbo=Re.createFramebuffer(et,et,!0,!1),pt.colorAttachment.set(Dt.texture)}Re.bindFramebuffer.set(pt.framebuffer),Re.viewport.set([0,0,et,et]),se.useProgram("hillshadePrepare").draw(Re,Ge.TRIANGLES,Te,Ie,De,Rn.disabled,nf(rt.tileID,lt),null,null,we.id,se.rasterBoundsBuffer,se.quadTriangleIndexBuffer,se.rasterBoundsSegments),rt.needsHillshadePrepare=!1}})(x,S,A,P,J,Ln.disabled,le),j.viewport.set([0,0,x.width,x.height]);else if(x.renderPass==="translucent")if(X){const[se,ue,fe]=x.stencilConfigForOverlapTwoPass(A);rd(x,S,P,fe,se,J,le,!1,N),rd(x,S,P,fe,ue,J,le,!0,N)}else{const[se,ue]=x.getStencilConfigForOverlapAndUpdateStencilID(A);rd(x,S,P,ue,se,J,le,!1,N)}}(t,r,d,h,y):o.c3(d)?function(x,S,P,A,F){if(x.renderPass!=="translucent"||P.paint.get("raster-opacity")===0||!A.length)return;const{isRenderingToTexture:N}=F,j=S.getSource(),X=x.style.projection.useSubdivision;if(j instanceof It)pi(x,S,P,A,null,!1,!1,j.tileCoords,j.flippedWindingOrder,N);else if(X){const[J,le,se]=x.stencilConfigForOverlapTwoPass(A);pi(x,S,P,se,J,!1,!0,Ic,!1,N),pi(x,S,P,se,le,!0,!0,Ic,!1,N)}else{const[J,le]=x.getStencilConfigForOverlapAndUpdateStencilID(A);pi(x,S,P,le,J,!1,!0,Ic,!1,N)}}(t,r,d,h,y):o.c4(d)?function(x,S,P,A,F){const N=P.paint.get("background-color"),j=P.paint.get("background-opacity");if(j===0)return;const{isRenderingToTexture:X}=F,J=x.context,le=J.gl,se=x.style.projection,ue=x.transform,fe=ue.tileSize,we=P.paint.get("background-pattern");if(x.isPatternMissing(we))return;const Te=!we&&N.a===1&&j===1&&x.opaquePassEnabledForLayer()?"opaque":"translucent";if(x.renderPass!==Te)return;const Ie=Ln.disabled,De=x.getDepthModeForSublayer(0,Te==="opaque"?yn.ReadWrite:yn.ReadOnly),Re=x.colorModeForRenderPass(),Ge=x.useProgram(we?"backgroundPattern":"background"),Ze=A||ae(ue,{tileSize:fe,terrain:x.style.map.terrain});we&&(J.activeTexture.set(le.TEXTURE0),x.imageManager.bind(x.context));const rt=P.getCrossfadeParameters();for(const lt of Ze){const et=ue.getProjectionData({overscaledTileID:lt,applyGlobeMatrix:!X,applyTerrainMatrix:!0}),Pt=we?Wu(j,x,we,{tileID:lt,tileSize:fe},rt):qu(j,N),St=x.style.map.terrain&&x.style.map.terrain.getTerrainData(lt),pt=se.getMeshFromTileID(J,lt.canonical,!1,!0,"raster");Ge.draw(J,le.TRIANGLES,De,Ie,Re,Rn.backCCW,Pt,St,et,P.id,pt.vertexBuffer,pt.indexBuffer,pt.segments)}}(t,0,d,h,y):o.c5(d)&&function(x,S,P,A){const{isRenderingGlobe:F}=A,N=x.context,j=P.implementation,X=x.style.projection,J=x.transform,le=J.getProjectionDataForCustomLayer(F),se={farZ:J.farZ,nearZ:J.nearZ,fov:J.fov*Math.PI/180,modelViewProjectionMatrix:J.modelViewProjectionMatrix,projectionMatrix:J.projectionMatrix,shaderData:{variantName:X.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${X.shaderPreludeCode.vertexSource}`,define:X.shaderDefine},defaultProjectionData:le},ue=j.renderingMode?j.renderingMode:"2d";if(x.renderPass==="offscreen"){const fe=j.prerender;fe&&(x.setCustomLayerDefaults(),N.setColorMode(x.colorModeForRenderPass()),fe.call(j,N.gl,se),N.setDirty(),x.setBaseState())}else if(x.renderPass==="translucent"){x.setCustomLayerDefaults(),N.setColorMode(x.colorModeForRenderPass()),N.setStencilMode(Ln.disabled);const fe=ue==="3d"?x.getDepthModeFor3D():x.getDepthModeForSublayer(0,yn.ReadOnly);N.setDepthMode(fe),j.render(N.gl,se),N.setDirty(),x.setBaseState(),N.bindFramebuffer.set(null)}}(t,0,d,y))}saveTileTexture(t){const r=this._tileTextures[t.size[0]];r?r.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const r=this._tileTextures[t];return r&&r.length>0?r.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const r=this.imageManager.getPattern(t.from.toString()),d=this.imageManager.getPattern(t.to.toString());return!r||!d}useProgram(t,r,d=!1){this.cache=this.cache||{};const h=!!this.style.map.terrain,y=this.style.projection,x=t+(r?r.cacheKey:"")+`/${d?qh:y.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(h?"/terrain":"");return this.cache[x]||(this.cache[x]=new cc(this.context,ka[t],r,af[t],this._showOverdrawInspector,h,d?ka.projectionMercator:y.shaderPreludeCode,d?rc:y.shaderDefine)),this.cache[x]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ye(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:r}=this.context.gl;return this.width!==t||this.height!==r}}function hs(_,t){let r,d=!1,h=null,y=null;const x=()=>{h=null,d&&(_.apply(y,r),h=setTimeout(x,t),d=!1)};return(...S)=>(d=!0,y=this,r=S,h||x(),h)}class cd{constructor(t){this._getCurrentHash=()=>{const r=window.location.hash.replace("#","");if(this._hashName){let d;return r.split("&").map(h=>h.split("=")).forEach(h=>{h[0]===this._hashName&&(d=h)}),(d&&d[1]||"").split("/")}return r.split("/")},this._onHashChange=()=>{const r=this._getCurrentHash();if(!this._isValidHash(r))return!1;const d=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:d,pitch:+(r[4]||0)}),!0},this._updateHashUnthrottled=()=>{const r=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,r)},this._removeHash=()=>{const r=this._getCurrentHash();if(r.length===0)return;const d=r.join("/");let h=d;h.split("&").length>0&&(h=h.split("&")[0]),this._hashName&&(h=`${this._hashName}=${d}`);let y=window.location.hash.replace(h,"");y.startsWith("#&")?y=y.slice(0,1)+y.slice(2):y==="#"&&(y="");let x=window.location.href.replace(/(#.+)?$/,y);x=x.replace("&&","&"),window.history.replaceState(window.history.state,null,x)},this._updateHash=hs(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const r=this._map.getCenter(),d=Math.round(100*this._map.getZoom())/100,h=Math.ceil((d*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,h),x=Math.round(r.lng*y)/y,S=Math.round(r.lat*y)/y,P=this._map.getBearing(),A=this._map.getPitch();let F="";if(F+=t?`/${x}/${S}/${d}`:`${d}/${S}/${x}`,(P||A)&&(F+="/"+Math.round(10*P)/10),A&&(F+=`/${Math.round(A)}`),this._hashName){const N=this._hashName;let j=!1;const X=window.location.hash.slice(1).split("&").map(J=>{const le=J.split("=")[0];return le===N?(j=!0,`${le}=${F}`):J}).filter(J=>J);return j||X.push(`${N}=${F}`),`#${X.join("&")}`}return`#${F}`}_isValidHash(t){if(t.length<3||t.some(isNaN))return!1;try{new o.N(+t[2],+t[1])}catch{return!1}const r=+t[0],d=+(t[3]||0),h=+(t[4]||0);return r>=this._map.getMinZoom()&&r<=this._map.getMaxZoom()&&d>=0&&d<=180&&h>=this._map.getMinPitch()&&h<=this._map.getMaxPitch()}}const Po={linearity:.3,easing:o.c6(0,0,.3,1)},bf=o.e({deceleration:2500,maxSpeed:1400},Po),xf=o.e({deceleration:20,maxSpeed:1400},Po),wf=o.e({deceleration:1e3,maxSpeed:360},Po),Sf=o.e({deceleration:1e3,maxSpeed:90},Po),Cf=o.e({deceleration:1e3,maxSpeed:360},Po);class yl{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:O.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,r=O.now();for(;t.length>0&&r-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const r={zoom:0,bearing:0,pitch:0,roll:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)r.zoom+=y.zoomDelta||0,r.bearing+=y.bearingDelta||0,r.pitch+=y.pitchDelta||0,r.roll+=y.rollDelta||0,y.panDelta&&r.pan._add(y.panDelta),y.around&&(r.around=y.around),y.pinchAround&&(r.pinchAround=y.pinchAround);const d=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,h={};if(r.pan.mag()){const y=wr(r.pan.mag(),d,o.e({},bf,t||{})),x=r.pan.mult(y.amount/r.pan.mag()),S=this._map.cameraHelper.handlePanInertia(x,this._map.transform);h.center=S.easingCenter,h.offset=S.easingOffset,ko(h,y)}if(r.zoom){const y=wr(r.zoom,d,xf);h.zoom=this._map.transform.zoom+y.amount,ko(h,y)}if(r.bearing){const y=wr(r.bearing,d,wf);h.bearing=this._map.transform.bearing+o.ab(y.amount,-179,179),ko(h,y)}if(r.pitch){const y=wr(r.pitch,d,Sf);h.pitch=this._map.transform.pitch+y.amount,ko(h,y)}if(r.roll){const y=wr(r.roll,d,Cf);h.roll=this._map.transform.roll+o.ab(y.amount,-179,179),ko(h,y)}if(h.zoom||h.bearing){const y=r.pinchAround===void 0?r.around:r.pinchAround;h.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),o.e(h,{noMoveStart:!0})}}function ko(_,t){(!_.duration||_.duration<t.duration)&&(_.duration=t.duration,_.easing=t.easing)}function wr(_,t,r){const{maxSpeed:d,linearity:h,deceleration:y}=r,x=o.ab(_*h/(t/1e3),-d,d),S=Math.abs(x)/(y*h);return{easing:r.easing,duration:1e3*S,amount:x*(S/2)}}class Ri extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,d,h={}){const y=D.mousePos(r.getCanvas(),d),x=r.unproject(y);super(t,o.e({point:y,lngLat:x,originalEvent:d},h)),this._defaultPrevented=!1,this.target=r}}class Io extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,d){const h=t==="touchend"?d.changedTouches:d.touches,y=D.touchPos(r.getCanvasContainer(),h),x=y.map(P=>r.unproject(P)),S=y.reduce((P,A,F,N)=>P.add(A.div(N.length)),new o.P(0,0));super(t,{points:y,point:S,lngLats:x,lngLat:r.unproject(S),originalEvent:d}),this._defaultPrevented=!1}}class pa extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,d){super(t,{originalEvent:d}),this._defaultPrevented=!1}}class Mo{constructor(t,r){this._map=t,this._clickTolerance=r.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new pa(t.type,this._map,t))}mousedown(t,r){return this._mousedownPos=r,this._firePreventable(new Ri(t.type,this._map,t))}mouseup(t){this._map.fire(new Ri(t.type,this._map,t))}click(t,r){this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance||this._map.fire(new Ri(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Ri(t.type,this._map,t))}mouseover(t){this._map.fire(new Ri(t.type,this._map,t))}mouseout(t){this._map.fire(new Ri(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Io(t.type,this._map,t))}touchmove(t){this._map.fire(new Io(t.type,this._map,t))}touchend(t){this._map.fire(new Io(t.type,this._map,t))}touchcancel(t){this._map.fire(new Io(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ng{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Ri(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ri("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Ri(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class vl{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.screenPointToLocation(o.P.convert(t),this._map.terrain)}}class Tf{constructor(t,r){this._map=t,this._tr=new vl(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=r.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,r){this.isEnabled()&&t.shiftKey&&t.button===0&&(D.disableDrag(),this._startPos=this._lastPos=r,this._active=!0)}mousemoveWindow(t,r){if(!this._active)return;const d=r;if(this._lastPos.equals(d)||!this._box&&d.dist(this._startPos)<this._clickTolerance)return;const h=this._startPos;this._lastPos=d,this._box||(this._box=D.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const y=Math.min(h.x,d.x),x=Math.max(h.x,d.x),S=Math.min(h.y,d.y),P=Math.max(h.y,d.y);D.setTransform(this._box,`translate(${y}px,${S}px)`),this._box.style.width=x-y+"px",this._box.style.height=P-S+"px"}mouseupWindow(t,r){if(!this._active||t.button!==0)return;const d=this._startPos,h=r;if(this.reset(),D.suppressClick(),d.x!==h.x||d.y!==h.y)return this._map.fire(new o.k("boxzoomend",{originalEvent:t})),{cameraAnimation:y=>y.fitScreenCoordinates(d,h,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(D.remove(this._box),this._box=null),D.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,r){return this._map.fire(new o.k(t,{originalEvent:r}))}}function ud(_,t){if(_.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${_.length}, points ${t.length}`);const r={};for(let d=0;d<_.length;d++)r[_[d].identifier]=t[d];return r}class Pf{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,r,d){(this.centroid||d.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),d.length===this.numTouches&&(this.centroid=function(h){const y=new o.P(0,0);for(const x of h)y._add(x);return y.div(h.length)}(r),this.touches=ud(d,r)))}touchmove(t,r,d){if(this.aborted||!this.centroid)return;const h=ud(d,r);for(const y in this.touches){const x=h[y];(!x||x.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(t,r,d){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),d.length===0){const h=!this.aborted&&this.centroid;if(this.reset(),h)return h}}}class Us{constructor(t){this.singleTap=new Pf(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,r,d){this.singleTap.touchstart(t,r,d)}touchmove(t,r,d){this.singleTap.touchmove(t,r,d)}touchend(t,r,d){const h=this.singleTap.touchend(t,r,d);if(h){const y=t.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(h)<30;if(y&&x||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=h,this.count===this.numTaps)return this.reset(),h}}}class Za{constructor(t){this._tr=new vl(t),this._zoomIn=new Us({numTouches:1,numTaps:2}),this._zoomOut=new Us({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,r,d){this._zoomIn.touchstart(t,r,d),this._zoomOut.touchstart(t,r,d)}touchmove(t,r,d){this._zoomIn.touchmove(t,r,d),this._zoomOut.touchmove(t,r,d)}touchend(t,r,d){const h=this._zoomIn.touchend(t,r,d),y=this._zoomOut.touchend(t,r,d),x=this._tr;return h?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:x.zoom+1,around:x.unproject(h)},{originalEvent:t})}):y?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:x.zoom-1,around:x.unproject(y)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ft{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const r=this._moveFunction(...t);if(r.bearingDelta||r.pitchDelta||r.rollDelta||r.around||r.panDelta)return this._active=!0,r}dragStart(t,r){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(r)?r[0]:r,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,r){if(!this.isEnabled())return;const d=this._lastPoint;if(!d)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const h=Array.isArray(r)?r[0]:r;return!this._moved&&h.dist(d)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=h,this._move(d,h))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&D.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const kf={0:1,2:2};class Gs{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const r=D.mouseButton(t);this._eventButton=r}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(r,d){const h=kf[d];return r.buttons===void 0||(r.buttons&h)!==h}(t,this._eventButton)}isValidEndEvent(t){return D.mouseButton(t)===this._eventButton}}class If{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}class bl{constructor(t=new Gs({checkCorrectEvent:()=>!0}),r=new If){this.mouseMoveStateManager=t,this.oneFingerTouchMoveStateManager=r}_executeRelevantHandler(t,r,d){return t instanceof MouseEvent?r(t):typeof TouchEvent<"u"&&t instanceof TouchEvent?d(t):void 0}startMove(t){this._executeRelevantHandler(t,r=>this.mouseMoveStateManager.startMove(r),r=>this.oneFingerTouchMoveStateManager.startMove(r))}endMove(t){this._executeRelevantHandler(t,r=>this.mouseMoveStateManager.endMove(r),r=>this.oneFingerTouchMoveStateManager.endMove(r))}isValidStartEvent(t){return this._executeRelevantHandler(t,r=>this.mouseMoveStateManager.isValidStartEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidStartEvent(r))}isValidMoveEvent(t){return this._executeRelevantHandler(t,r=>this.mouseMoveStateManager.isValidMoveEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(r))}isValidEndEvent(t){return this._executeRelevantHandler(t,r=>this.mouseMoveStateManager.isValidEndEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidEndEvent(r))}}const fs=_=>{_.mousedown=_.dragStart,_.mousemoveWindow=_.dragMove,_.mouseup=_.dragEnd,_.contextmenu=t=>{t.preventDefault()}};class Mf{constructor(t,r){this._clickTolerance=t.clickTolerance||1,this._map=r,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,r,d){return this._calculateTransform(t,r,d)}touchmove(t,r,d){if(this._active){if(!this._shouldBePrevented(d.length))return t.preventDefault(),this._calculateTransform(t,r,d);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,r,d){this._calculateTransform(t,r,d),this._active&&this._shouldBePrevented(d.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,r,d){d.length>0&&(this._active=!0);const h=ud(d,r),y=new o.P(0,0),x=new o.P(0,0);let S=0;for(const A in h){const F=h[A],N=this._touches[A];N&&(y._add(F),x._add(F.sub(N)),S++,h[A]=F)}if(this._touches=h,this._shouldBePrevented(S)||!x.mag())return;const P=x.div(S);return this._sum._add(P),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(S),panDelta:P}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class kn{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,r,d){this._firstTwoTouches||d.length<2||(this._firstTwoTouches=[d[0].identifier,d[1].identifier],this._start([r[0],r[1]]))}touchmove(t,r,d){if(!this._firstTwoTouches)return;t.preventDefault();const[h,y]=this._firstTwoTouches,x=Eo(d,r,h),S=Eo(d,r,y);if(!x||!S)return;const P=this._aroundCenter?null:x.add(S).div(2);return this._move([x,S],P,t)}touchend(t,r,d){if(!this._firstTwoTouches)return;const[h,y]=this._firstTwoTouches,x=Eo(d,r,h),S=Eo(d,r,y);x&&S||(this._active&&D.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Eo(_,t,r){for(let d=0;d<_.length;d++)if(_[d].identifier===r)return t[d]}function Ef(_,t){return Math.log(_/t)/Math.LN2}class Ec extends kn{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,r){const d=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Ef(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ef(this._distance,d),pinchAround:r}}}function Af(_,t){return 180*_.angleWith(t)/Math.PI}class Rf extends kn{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,r,d){const h=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Af(this._vector,h),pinchAround:r}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const r=25/(Math.PI*this._minDiameter)*360,d=Af(t,this._startVector);return Math.abs(d)<r}}function Ac(_){return Math.abs(_.y)>Math.abs(_.x)}class Rc extends kn{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,r,d){super.touchstart(t,r,d),this._currentTouchCount=d.length}_start(t){this._lastPoints=t,Ac(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,r,d){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const h=t[0].sub(this._lastPoints[0]),y=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(h,y,d.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(h.y+y.y)/2*-.5}):void 0}gestureBeginsVertically(t,r,d){if(this._valid!==void 0)return this._valid;const h=t.mag()>=2,y=r.mag()>=2;if(!h&&!y)return;if(!h||!y)return this._firstMove===void 0&&(this._firstMove=d),d-this._firstMove<100&&void 0;const x=t.y>0==r.y>0;return Ac(t)&&Ac(r)&&x}}const Df={panStep:100,bearingStep:15,pitchStep:10};class zf{constructor(t){this._tr=new vl(t);const r=Df;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let r=0,d=0,h=0,y=0,x=0;switch(t.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:t.shiftKey?d=-1:(t.preventDefault(),y=-1);break;case 39:t.shiftKey?d=1:(t.preventDefault(),y=1);break;case 38:t.shiftKey?h=1:(t.preventDefault(),x=-1);break;case 40:t.shiftKey?h=-1:(t.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(d=0,h=0),{cameraAnimation:S=>{const P=this._tr;S.easeTo({duration:300,easeId:"keyboardHandler",easing:Lf,zoom:r?Math.round(P.zoom)+r*(t.shiftKey?2:1):P.zoom,bearing:P.bearing+d*this._bearingStep,pitch:P.pitch+h*this._pitchStep,offset:[-y*this._panStep,-x*this._panStep],center:P.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Lf(_){return _*(2-_)}const Bf=4.000244140625;class Ff{constructor(t,r){this._onTimeout=d=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)},this._map=t,this._tr=new vl(t),this._triggerRenderFrame=r,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let r=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const d=O.now(),h=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,r!==0&&r%Bf==0?this._type="wheel":r!==0&&Math.abs(r)<4?this._type="trackpad":h>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(h*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),t.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=t,this._delta-=r,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=D.mousePos(this._map.getCanvas(),t),d=this._tr;this._aroundPoint=this._aroundCenter?d.transform.locationToScreenPoint(o.N.convert(d.center)):r,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const S=t.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=S),typeof this._targetZoom=="number"&&(this._targetZoom+=S)}if(this._delta!==0){const S=this._type==="wheel"&&Math.abs(this._delta)>Bf?this._wheelZoomRate:this._defaultZoomRate;let P=2/(1+Math.exp(-Math.abs(this._delta*S)));this._delta<0&&P!==0&&(P=1/P);const A=typeof this._targetZoom!="number"?t.scale:o.aG(this._targetZoom);this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,o.a8(A*P))),this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const r=typeof this._targetZoom!="number"?t.zoom:this._targetZoom,d=this._startZoom,h=this._easing;let y,x=!1;if(this._type==="wheel"&&d&&h){const S=O.now()-this._lastWheelEventTime,P=Math.min((S+5)/200,1),A=h(P);y=o.y.number(d,r,A),P<1?this._frameId||(this._frameId=!0):x=!0}else y=r,x=!0;return this._active=!0,x&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=y,{noInertia:!0,needsRenderFrame:!x,zoomDelta:y-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let r=o.c8;if(this._prevEase){const d=this._prevEase,h=(O.now()-d.start)/d.duration,y=d.easing(h+.01)-d.easing(h),x=.27/Math.sqrt(y*y+1e-4)*.01,S=Math.sqrt(.0729-x*x);r=o.c6(x,S,.25,1)}return this._prevEase={start:O.now(),duration:t,easing:r},r}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class qa{constructor(t,r){this._clickZoom=t,this._tapZoom=r}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class mi{constructor(t){this._tr=new vl(t),this.reset()}reset(){this._active=!1}dblclick(t,r){return t.preventDefault(),{cameraAnimation:d=>{d.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(r)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Dc{constructor(){this._tap=new Us({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,r,d){if(!this._swipePoint)if(this._tapTime){const h=r[0],y=t.timeStamp-this._tapTime<500,x=this._tapPoint.dist(h)<30;y&&x?d.length>0&&(this._swipePoint=h,this._swipeTouch=d[0].identifier):this.reset()}else this._tap.touchstart(t,r,d)}touchmove(t,r,d){if(this._tapTime){if(this._swipePoint){if(d[0].identifier!==this._swipeTouch)return;const h=r[0],y=h.y-this._swipePoint.y;return this._swipePoint=h,t.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(t,r,d)}touchend(t,r,d){if(this._tapTime)this._swipePoint&&d.length===0&&this.reset();else{const h=this._tap.touchend(t,r,d);h&&(this._tapTime=t.timeStamp,this._tapPoint=h)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zc{constructor(t,r,d){this._el=t,this._mousePan=r,this._touchPan=d}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class dd{constructor(t,r,d,h){this._pitchWithRotate=t.pitchWithRotate,this._rollEnabled=t.rollEnabled,this._mouseRotate=r,this._mousePitch=d,this._mouseRoll=h}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class hd{constructor(t,r,d,h){this._el=t,this._touchZoom=r,this._touchRotate=d,this._tapDragZoom=h,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class fd{constructor(t,r){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=r,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=D.create("div","maplibregl-cooperative-gesture-screen",t);let r=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(r=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const d=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),h=document.createElement("div");h.className="maplibregl-desktop-message",h.textContent=r,this._container.appendChild(h);const y=document.createElement("div");y.className="maplibregl-mobile-message",y.textContent=d,this._container.appendChild(y),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(D.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,r){this._enabled&&(this._map.fire(new o.k("cooperativegestureprevented",{gestureType:t,originalEvent:r})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Lc=_=>_.zoom||_.drag||_.roll||_.pitch||_.rotate;class Ea extends o.k{}function Ao(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta||_.rollDelta}class Zt{constructor(t,r){this.handleWindowEvent=h=>{this.handleEvent(h,`${h.type}Window`)},this.handleEvent=(h,y)=>{if(h.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const x=h.type==="renderFrame"?void 0:h,S={needsRenderFrame:!1},P={},A={},F=h.touches,N=F?this._getMapTouches(F):void 0,j=N?D.touchPos(this._map.getCanvas(),N):D.mousePos(this._map.getCanvas(),h);for(const{handlerName:le,handler:se,allowed:ue}of this._handlers){if(!se.isEnabled())continue;let fe;this._blockedByActive(A,ue,le)?se.reset():se[y||h.type]&&(fe=se[y||h.type](h,j,N),this.mergeHandlerResult(S,P,fe,le,x),fe&&fe.needsRenderFrame&&this._triggerRenderFrame()),(fe||se.isActive())&&(A[le]=se)}const X={};for(const le in this._previousActiveHandlers)A[le]||(X[le]=x);this._previousActiveHandlers=A,(Object.keys(X).length||Ao(S))&&(this._changes.push([S,P,X]),this._triggerRenderFrame()),(Object.keys(A).length||Ao(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:J}=S;J&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],J(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new yl(t),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r);const d=this._el;this._listeners=[[d,"touchstart",{passive:!0}],[d,"touchmove",{passive:!1}],[d,"touchend",void 0],[d,"touchcancel",void 0],[d,"mousedown",void 0],[d,"mousemove",void 0],[d,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[d,"mouseover",void 0],[d,"mouseout",void 0],[d,"dblclick",void 0],[d,"click",void 0],[d,"keydown",{capture:!1}],[d,"keyup",void 0],[d,"wheel",{passive:!1}],[d,"contextmenu",void 0],[window,"blur",void 0]];for(const[h,y,x]of this._listeners)D.addEventListener(h,y,h===document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[t,r,d]of this._listeners)D.removeEventListener(t,r,t===document?this.handleWindowEvent:this.handleEvent,d)}_addDefaultHandlers(t){const r=this._map,d=r.getCanvasContainer();this._add("mapEvent",new Mo(r,t));const h=r.boxZoom=new Tf(r,t);this._add("boxZoom",h),t.interactive&&t.boxZoom&&h.enable();const y=r.cooperativeGestures=new fd(r,t.cooperativeGestures);this._add("cooperativeGestures",y),t.cooperativeGestures&&y.enable();const x=new Za(r),S=new mi(r);r.doubleClickZoom=new qa(S,x),this._add("tapZoom",x),this._add("clickZoom",S),t.interactive&&t.doubleClickZoom&&r.doubleClickZoom.enable();const P=new Dc;this._add("tapDragZoom",P);const A=r.touchPitch=new Rc(r);this._add("touchPitch",A),t.interactive&&t.touchPitch&&r.touchPitch.enable(t.touchPitch);const F=()=>r.project(r.getCenter()),N=function({enable:Te,clickTolerance:Ie,aroundCenter:De=!0,minPixelCenterThreshold:Re=100,rotateDegreesPerPixelMoved:Ge=.8},Ze){const rt=new Gs({checkCorrectEvent:lt=>D.mouseButton(lt)===0&&lt.ctrlKey||D.mouseButton(lt)===2&&!lt.ctrlKey});return new Ft({clickTolerance:Ie,move:(lt,et)=>{const Pt=Ze();if(De&&Math.abs(Pt.y-lt.y)>Re)return{bearingDelta:o.c7(new o.P(lt.x,et.y),et,Pt)};let St=(et.x-lt.x)*Ge;return De&&et.y<Pt.y&&(St=-St),{bearingDelta:St}},moveStateManager:rt,enable:Te,assignEvents:fs})}(t,F),j=function({enable:Te,clickTolerance:Ie,pitchDegreesPerPixelMoved:De=-.5}){const Re=new Gs({checkCorrectEvent:Ge=>D.mouseButton(Ge)===0&&Ge.ctrlKey||D.mouseButton(Ge)===2});return new Ft({clickTolerance:Ie,move:(Ge,Ze)=>({pitchDelta:(Ze.y-Ge.y)*De}),moveStateManager:Re,enable:Te,assignEvents:fs})}(t),X=function({enable:Te,clickTolerance:Ie,rollDegreesPerPixelMoved:De=.3},Re){const Ge=new Gs({checkCorrectEvent:Ze=>D.mouseButton(Ze)===2&&Ze.ctrlKey});return new Ft({clickTolerance:Ie,move:(Ze,rt)=>{const lt=Re();let et=(rt.x-Ze.x)*De;return rt.y<lt.y&&(et=-et),{rollDelta:et}},moveStateManager:Ge,enable:Te,assignEvents:fs})}(t,F);r.dragRotate=new dd(t,N,j,X),this._add("mouseRotate",N,["mousePitch"]),this._add("mousePitch",j,["mouseRotate","mouseRoll"]),this._add("mouseRoll",X,["mousePitch"]),t.interactive&&t.dragRotate&&r.dragRotate.enable();const J=function({enable:Te,clickTolerance:Ie}){const De=new Gs({checkCorrectEvent:Re=>D.mouseButton(Re)===0&&!Re.ctrlKey});return new Ft({clickTolerance:Ie,move:(Re,Ge)=>({around:Ge,panDelta:Ge.sub(Re)}),activateOnStart:!0,moveStateManager:De,enable:Te,assignEvents:fs})}(t),le=new Mf(t,r);r.dragPan=new zc(d,J,le),this._add("mousePan",J),this._add("touchPan",le,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&r.dragPan.enable(t.dragPan);const se=new Rf,ue=new Ec;r.touchZoomRotate=new hd(d,ue,se,P),this._add("touchRotate",se,["touchPan","touchZoom"]),this._add("touchZoom",ue,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&r.touchZoomRotate.enable(t.touchZoomRotate);const fe=r.scrollZoom=new Ff(r,()=>this._triggerRenderFrame());this._add("scrollZoom",fe,["mousePan"]),t.interactive&&t.scrollZoom&&r.scrollZoom.enable(t.scrollZoom);const we=r.keyboard=new zf(r);this._add("keyboard",we),t.interactive&&t.keyboard&&r.keyboard.enable(),this._add("blockableMapEvent",new ng(r))}_add(t,r,d){this._handlers.push({handlerName:t,handler:r,allowed:d}),this._handlersById[t]=r}stop(t){if(!this._updatingCamera){for(const{handler:r}of this._handlers)r.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Lc(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,r,d){for(const h in t)if(h!==d&&(!r||r.indexOf(h)<0))return!0;return!1}_getMapTouches(t){const r=[];for(const d of t)this._el.contains(d.target)&&r.push(d);return r}mergeHandlerResult(t,r,d,h,y){if(!d)return;o.e(t,d);const x={handlerName:h,originalEvent:d.originalEvent||y};d.zoomDelta!==void 0&&(r.zoom=x),d.panDelta!==void 0&&(r.drag=x),d.rollDelta!==void 0&&(r.roll=x),d.pitchDelta!==void 0&&(r.pitch=x),d.bearingDelta!==void 0&&(r.rotate=x)}_applyChanges(){const t={},r={},d={};for(const[h,y,x]of this._changes)h.panDelta&&(t.panDelta=(t.panDelta||new o.P(0,0))._add(h.panDelta)),h.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+h.zoomDelta),h.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+h.bearingDelta),h.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+h.pitchDelta),h.rollDelta&&(t.rollDelta=(t.rollDelta||0)+h.rollDelta),h.around!==void 0&&(t.around=h.around),h.pinchAround!==void 0&&(t.pinchAround=h.pinchAround),h.noInertia&&(t.noInertia=h.noInertia),o.e(r,y),o.e(d,x);this._updateMapTransform(t,r,d),this._changes=[]}_updateMapTransform(t,r,d){const h=this._map,y=h._getTransformForUpdate(),x=h.terrain;if(!(Ao(t)||x&&this._terrainMovement))return this._fireEvents(r,d,!0);h._stop(!0);let{panDelta:S,zoomDelta:P,bearingDelta:A,pitchDelta:F,rollDelta:N,around:j,pinchAround:X}=t;X!==void 0&&(j=X),j=j||h.transform.centerPoint,x&&!y.isPointOnMapSurface(j)&&(j=y.centerPoint);const J={panDelta:S,zoomDelta:P,rollDelta:N,pitchDelta:F,bearingDelta:A,around:j};this._map.cameraHelper.useGlobeControls&&!y.isPointOnMapSurface(j)&&(j=y.centerPoint);const le=j.distSqr(y.centerPoint)<.01?y.center:y.screenPointToLocation(S?j.sub(S):j);x?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(J,y),this._terrainMovement||!r.drag&&!r.zoom?r.drag&&this._terrainMovement?y.setCenter(y.screenPointToLocation(y.centerPoint.sub(S))):this._map.cameraHelper.handleMapControlsPan(J,y,le):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(J,y,le))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(J,y),this._map.cameraHelper.handleMapControlsPan(J,y,le)),h._applyUpdatedTransform(y),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(r,d,!0)}_fireEvents(t,r,d){const h=Lc(this._eventsInProgress),y=Lc(t),x={};for(const N in t){const{originalEvent:j}=t[N];this._eventsInProgress[N]||(x[`${N}start`]=j),this._eventsInProgress[N]=t[N]}!h&&y&&this._fireEvent("movestart",y.originalEvent);for(const N in x)this._fireEvent(N,x[N]);y&&this._fireEvent("move",y.originalEvent);for(const N in t){const{originalEvent:j}=t[N];this._fireEvent(N,j)}const S={};let P;for(const N in this._eventsInProgress){const{handlerName:j,originalEvent:X}=this._eventsInProgress[N];this._handlersById[j].isActive()||(delete this._eventsInProgress[N],P=r[j]||X,S[`${N}end`]=P)}for(const N in S)this._fireEvent(N,S[N]);const A=Lc(this._eventsInProgress),F=(h||y)&&!A;if(F&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const N=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&N.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(N)}if(d&&F){this._updatingCamera=!0;const N=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),j=X=>X!==0&&-this._bearingSnap<X&&X<this._bearingSnap;!N||!N.essential&&O.prefersReducedMotion?(this._map.fire(new o.k("moveend",{originalEvent:P})),j(this._map.getBearing())&&this._map.resetNorth()):(j(N.bearing||this._map.getBearing())&&(N.bearing=0),N.freezeElevation=!0,this._map.easeTo(N,{originalEvent:P})),this._updatingCamera=!1}}_fireEvent(t,r){this._map.fire(new o.k(t,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new Ea("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class sn extends o.E{constructor(t,r,d){super(),this._renderFrameCallback=()=>{const h=Math.min((O.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(h)),h<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=d.bearingSnap,this.cameraHelper=r,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(t,r){t.apply(this.transform),this.transform=t,this.cameraHelper=r}getCenter(){return new o.N(this.transform.center.lng,this.transform.center.lat)}setCenter(t,r){return this.jumpTo({center:t},r)}getCenterElevation(){return this.transform.elevation}setCenterElevation(t,r){return this.jumpTo({elevation:t},r),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(t){this._centerClampedToGround=t}panBy(t,r,d){return t=o.P.convert(t).mult(-1),this.panTo(this.transform.center,o.e({offset:t},r),d)}panTo(t,r,d){return this.easeTo(o.e({center:t},r),d)}getZoom(){return this.transform.zoom}setZoom(t,r){return this.jumpTo({zoom:t},r),this}zoomTo(t,r,d){return this.easeTo(o.e({zoom:t},r),d)}zoomIn(t,r){return this.zoomTo(this.getZoom()+1,t,r),this}zoomOut(t,r){return this.zoomTo(this.getZoom()-1,t,r),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(t,r){return t!=this.transform.fov&&(this.transform.setFov(t),this.fire(new o.k("movestart",r)).fire(new o.k("move",r)).fire(new o.k("moveend",r))),this}getBearing(){return this.transform.bearing}setBearing(t,r){return this.jumpTo({bearing:t},r),this}getPadding(){return this.transform.padding}setPadding(t,r){return this.jumpTo({padding:t},r),this}rotateTo(t,r,d){return this.easeTo(o.e({bearing:t},r),d)}resetNorth(t,r){return this.rotateTo(0,o.e({duration:1e3},t),r),this}resetNorthPitch(t,r){return this.easeTo(o.e({bearing:0,pitch:0,roll:0,duration:1e3},t),r),this}snapToNorth(t,r){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,r):this}getPitch(){return this.transform.pitch}setPitch(t,r){return this.jumpTo({pitch:t},r),this}getRoll(){return this.transform.roll}setRoll(t,r){return this.jumpTo({roll:t},r),this}cameraForBounds(t,r){t=Le.convert(t).adjustAntiMeridian();const d=r&&r.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),d,r)}_cameraForBoxAndBearing(t,r,d,h){const y={top:0,bottom:0,right:0,left:0};if(typeof(h=o.e({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const A=h.padding;h.padding={top:A,bottom:A,right:A,left:A}}const x=o.e(y,h.padding);h.padding=x;const S=this.transform,P=new Le(t,r);return this.cameraHelper.cameraForBoxAndBearing(h,x,P,d,S)}fitBounds(t,r,d){return this._fitInternal(this.cameraForBounds(t,r),r,d)}fitScreenCoordinates(t,r,d,h,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(o.P.convert(t)),this.transform.screenPointToLocation(o.P.convert(r)),d,h),h,y)}_fitInternal(t,r,d){return t?(delete(r=o.e(t,r)).padding,r.linear?this.easeTo(r,d):this.flyTo(r,d)):this}jumpTo(t,r){this.stop();const d=this._getTransformForUpdate();let h=!1,y=!1,x=!1;const S=d.zoom;this.cameraHelper.handleJumpToCenterZoom(d,t);const P=d.zoom!==S;return"elevation"in t&&d.elevation!==+t.elevation&&d.setElevation(+t.elevation),"bearing"in t&&d.bearing!==+t.bearing&&(h=!0,d.setBearing(+t.bearing)),"pitch"in t&&d.pitch!==+t.pitch&&(y=!0,d.setPitch(+t.pitch)),"roll"in t&&d.roll!==+t.roll&&(x=!0,d.setRoll(+t.roll)),t.padding==null||d.isPaddingEqual(t.padding)||d.setPadding(t.padding),this._applyUpdatedTransform(d),this.fire(new o.k("movestart",r)).fire(new o.k("move",r)),P&&this.fire(new o.k("zoomstart",r)).fire(new o.k("zoom",r)).fire(new o.k("zoomend",r)),h&&this.fire(new o.k("rotatestart",r)).fire(new o.k("rotate",r)).fire(new o.k("rotateend",r)),y&&this.fire(new o.k("pitchstart",r)).fire(new o.k("pitch",r)).fire(new o.k("pitchend",r)),x&&this.fire(new o.k("rollstart",r)).fire(new o.k("roll",r)).fire(new o.k("rollend",r)),this.fire(new o.k("moveend",r))}calculateCameraOptionsFromTo(t,r,d,h=0){const y=o.Y.fromLngLat(t,r),x=o.Y.fromLngLat(d,h),S=x.x-y.x,P=x.y-y.y,A=x.z-y.z,F=Math.hypot(S,P,A);if(F===0)throw new Error("Can't calculate camera options with same From and To");const N=Math.hypot(S,P),j=o.a8(this.transform.cameraToCenterDistance/F/this.transform.tileSize),X=180*Math.atan2(S,-P)/Math.PI;let J=180*Math.acos(N/F)/Math.PI;return J=A<0?90-J:90+J,{center:x.toLngLat(),elevation:h,zoom:j,pitch:J,bearing:X}}calculateCameraOptionsFromCameraLngLatAltRotation(t,r,d,h,y){const x=this.transform.calculateCenterFromCameraLngLatAlt(t,r,d,h);return{center:x.center,elevation:x.elevation,zoom:x.zoom,bearing:d,pitch:h,roll:y}}easeTo(t,r){this._stop(!1,t.easeId),((t=o.e({offset:[0,0],duration:500,easing:o.c8},t)).animate===!1||!t.essential&&O.prefersReducedMotion)&&(t.duration=0);const d=this._getTransformForUpdate(),h=this.getBearing(),y=d.pitch,x=d.roll,S="bearing"in t?this._normalizeBearing(t.bearing,h):h,P="pitch"in t?+t.pitch:y,A="roll"in t?this._normalizeBearing(t.roll,x):x,F="padding"in t?t.padding:d.padding,N=o.P.convert(t.offset);let j,X;t.around&&(j=o.N.convert(t.around),X=d.locationToScreenPoint(j));const J={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},le=this.cameraHelper.handleEaseTo(d,{bearing:S,pitch:P,roll:A,padding:F,around:j,aroundPoint:X,offsetAsPoint:N,offset:t.offset,zoom:t.zoom,center:t.center});return this._rotating=this._rotating||h!==S,this._pitching=this._pitching||P!==y,this._rolling=this._rolling||A!==x,this._padding=!d.isPaddingEqual(F),this._zooming=this._zooming||le.isZooming,this._easeId=t.easeId,this._prepareEase(r,t.noMoveStart,J),this.terrain&&this._prepareElevation(le.elevationCenter),this._ease(se=>{le.easeFunc(se),this.terrain&&!t.freezeElevation&&this._updateElevation(se),this._applyUpdatedTransform(d),this._fireMoveEvents(r)},se=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(r,se)},t),this}_prepareEase(t,r,d={}){this._moving=!0,r||d.moving||this.fire(new o.k("movestart",t)),this._zooming&&!d.zooming&&this.fire(new o.k("zoomstart",t)),this._rotating&&!d.rotating&&this.fire(new o.k("rotatestart",t)),this._pitching&&!d.pitching&&this.fire(new o.k("pitchstart",t)),this._rolling&&!d.rolling&&this.fire(new o.k("rollstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const r=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&r!==this._elevationTarget){const d=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(d-(r-(d*t+this._elevationStart))/(1-t)),this._elevationTarget=r}this.transform.setElevation(o.y.number(this._elevationStart,this._elevationTarget,t))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){if(!this.terrain&&t.elevation>=0&&t.pitch<=90)return{};const r=t.getCameraLngLat(),d=t.getCameraAltitude(),h=this.terrain?this.terrain.getElevationForLngLatZoom(r,t.zoom):0;if(d<h){const y=this.calculateCameraOptionsFromTo(r,h,t.center,t.elevation);return{pitch:y.pitch,zoom:y.zoom}}return{}}_applyUpdatedTransform(t){const r=[];if(r.push(h=>this._elevateCameraIfInsideTerrain(h)),this.transformCameraUpdate&&r.push(h=>this.transformCameraUpdate(h)),!r.length)return;const d=t.clone();for(const h of r){const y=d.clone(),{center:x,zoom:S,roll:P,pitch:A,bearing:F,elevation:N}=h(y);x&&y.setCenter(x),N!==void 0&&y.setElevation(N),S!==void 0&&y.setZoom(S),P!==void 0&&y.setRoll(P),A!==void 0&&y.setPitch(A),F!==void 0&&y.setBearing(F),d.apply(y)}this.transform.apply(d)}_fireMoveEvents(t){this.fire(new o.k("move",t)),this._zooming&&this.fire(new o.k("zoom",t)),this._rotating&&this.fire(new o.k("rotate",t)),this._pitching&&this.fire(new o.k("pitch",t)),this._rolling&&this.fire(new o.k("roll",t))}_afterEase(t,r){if(this._easeId&&r&&this._easeId===r)return;delete this._easeId;const d=this._zooming,h=this._rotating,y=this._pitching,x=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,d&&this.fire(new o.k("zoomend",t)),h&&this.fire(new o.k("rotateend",t)),y&&this.fire(new o.k("pitchend",t)),x&&this.fire(new o.k("rollend",t)),this.fire(new o.k("moveend",t))}flyTo(t,r){if(!t.essential&&O.prefersReducedMotion){const et=o.M(t,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(et,r)}this.stop(),t=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.c8},t);const d=this._getTransformForUpdate(),h=d.bearing,y=d.pitch,x=d.roll,S=d.padding,P="bearing"in t?this._normalizeBearing(t.bearing,h):h,A="pitch"in t?+t.pitch:y,F="roll"in t?this._normalizeBearing(t.roll,x):x,N="padding"in t?t.padding:d.padding,j=o.P.convert(t.offset);let X=d.centerPoint.add(j);const J=d.screenPointToLocation(X),le=this.cameraHelper.handleFlyTo(d,{bearing:P,pitch:A,roll:F,padding:N,locationAtOffset:J,offsetAsPoint:j,center:t.center,minZoom:t.minZoom,zoom:t.zoom});let se=t.curve;const ue=Math.max(d.width,d.height),fe=ue/le.scaleOfZoom,we=le.pixelPathLength;typeof le.scaleOfMinZoom=="number"&&(se=Math.sqrt(ue/le.scaleOfMinZoom/we*2));const Te=se*se;function Ie(et){const Pt=(fe*fe-ue*ue+(et?-1:1)*Te*Te*we*we)/(2*(et?fe:ue)*Te*we);return Math.log(Math.sqrt(Pt*Pt+1)-Pt)}function De(et){return(Math.exp(et)-Math.exp(-et))/2}function Re(et){return(Math.exp(et)+Math.exp(-et))/2}const Ge=Ie(!1);let Ze=function(et){return Re(Ge)/Re(Ge+se*et)},rt=function(et){return ue*((Re(Ge)*(De(Pt=Ge+se*et)/Re(Pt))-De(Ge))/Te)/we;var Pt},lt=(Ie(!0)-Ge)/se;if(Math.abs(we)<2e-6||!isFinite(lt)){if(Math.abs(ue-fe)<1e-6)return this.easeTo(t,r);const et=fe<ue?-1:1;lt=Math.abs(Math.log(fe/ue))/se,rt=()=>0,Ze=Pt=>Math.exp(et*se*Pt)}return t.duration="duration"in t?+t.duration:1e3*lt/("screenSpeed"in t?+t.screenSpeed/se:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=h!==P,this._pitching=A!==y,this._rolling=F!==x,this._padding=!d.isPaddingEqual(N),this._prepareEase(r,!1),this.terrain&&this._prepareElevation(le.targetCenter),this._ease(et=>{const Pt=et*lt,St=1/Ze(Pt),pt=rt(Pt);this._rotating&&d.setBearing(o.y.number(h,P,et)),this._pitching&&d.setPitch(o.y.number(y,A,et)),this._rolling&&d.setRoll(o.y.number(x,F,et)),this._padding&&(d.interpolatePadding(S,N,et),X=d.centerPoint.add(j)),le.easeFunc(et,St,pt,X),this.terrain&&!t.freezeElevation&&this._updateElevation(et),this._applyUpdatedTransform(d),this._fireMoveEvents(r)},()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(r)},t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,r){var d;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const h=this._onEaseEnd;delete this._onEaseEnd,h.call(this,r)}return t||(d=this.handlers)===null||d===void 0||d.stop(!1),this}_ease(t,r,d){d.animate===!1||d.duration===0?(t(1),r()):(this._easeStart=O.now(),this._easeOptions=d,this._onEaseFrame=t,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,r){t=o.aI(t,-180,180);const d=Math.abs(t-r);return Math.abs(t-360-r)<d&&(t-=360),Math.abs(t+360-r)<d&&(t+=360),t}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(o.N.convert(t),this.transform.tileZoom):null}}const xl={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Bc{constructor(t=xl){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=r=>{!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"&&r.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=D.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=D.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=D.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){D.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._sanitizedAttributionHTML=void 0}_setElementTitle(t,r){const d=this._map._getUIString(`AttributionControl.${r}`);t.title=d,t.setAttribute("aria-label",d)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(h=>typeof h!="string"?"":h)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const h=this._map.style.stylesheet;this.styleOwner=h.owner,this.styleId=h.id}const r=this._map.style.sourceCaches;for(const h in r){const y=r[h];if(y.used||y.usedForTerrain){const x=y.getSource();x.attribution&&t.indexOf(x.attribution)<0&&t.push(x.attribution)}}t=t.filter(h=>String(h).trim()),t.sort((h,y)=>h.length-y.length),t=t.filter((h,y)=>{for(let x=y+1;x<t.length;x++)if(t[x].indexOf(h)>=0)return!1;return!0});const d=t.join(" | ");d!==this._sanitizedAttributionHTML&&(this._sanitizedAttributionHTML=D.sanitize(d),t.length?(this._innerContainer.innerHTML=this._sanitizedAttributionHTML,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Fc{constructor(t={}){this._updateCompact=()=>{const r=this._container.children;if(r.length){const d=r[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&d.classList.add("maplibregl-compact"):d.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=D.create("div","maplibregl-ctrl");const r=D.create("a","maplibregl-ctrl-logo");return r.target="_blank",r.rel="noopener nofollow",r.href="https://maplibre.org/",r.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),r.setAttribute("rel","noopener nofollow"),this._container.appendChild(r),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){D.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Ar{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const r=++this._id;return this._queue.push({callback:t,id:r,cancelled:!1}),r}remove(t){const r=this._currentlyRunning,d=r?this._queue.concat(r):this._queue;for(const h of d)if(h.id===t)return void(h.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const r=this._currentlyRunning=this._queue;this._queue=[];for(const d of r)if(!d.cancelled&&(d.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Of=o.aA([{name:"a_pos3d",type:"Int16",components:3}]);class Aa extends o.E{constructor(t){super(),this._lastTilesetChange=O.now(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=t._source.tileSize*2**this.deltaZoom,t.usedForTerrain=!0,t.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,r){this.sourceCache.update(t,r),this._renderableTilesKeys=[];const d={};for(const h of ae(t,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:r,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))d[h.key]=!0,this._renderableTilesKeys.push(h.key),this._tiles[h.key]||(h.terrainRttPosMatrix32f=new Float64Array(16),o.bL(h.terrainRttPosMatrix32f,0,o.X,o.X,0,0,1),this._tiles[h.key]=new An(h,this.tileSize),this._lastTilesetChange=O.now());for(const h in this._tiles)d[h]||delete this._tiles[h]}freeRtt(t){for(const r in this._tiles){const d=this._tiles[r];(!t||d.tileID.equals(t)||d.tileID.isChildOf(t)||t.isChildOf(d.tileID))&&(d.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const r={};for(const d of this._renderableTilesKeys){const h=this._tiles[d].tileID,y=t.clone(),x=o.a$();if(h.canonical.equals(t.canonical))o.bL(x,0,o.X,o.X,0,0,1);else if(h.canonical.isChildOf(t.canonical)){const S=h.canonical.z-t.canonical.z,P=h.canonical.x-(h.canonical.x>>S<<S),A=h.canonical.y-(h.canonical.y>>S<<S),F=o.X>>S;o.bL(x,0,F,F,0,0,1),o.J(x,x,[-P*F,-A*F,0])}else{if(!t.canonical.isChildOf(h.canonical))continue;{const S=t.canonical.z-h.canonical.z,P=t.canonical.x-(t.canonical.x>>S<<S),A=t.canonical.y-(t.canonical.y>>S<<S),F=o.X>>S;o.bL(x,0,o.X,o.X,0,0,1),o.J(x,x,[P*F,A*F,0]),o.K(x,x,[1/2**S,1/2**S,0])}}y.terrainRttPosMatrix32f=new Float32Array(x),r[d]=y}return r}getSourceTile(t,r){const d=this.sourceCache._source;let h=t.overscaledZ-this.deltaZoom;if(h>d.maxzoom&&(h=d.maxzoom),h<d.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(h).key);let y=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!y||!y.dem)&&r)for(;h>=d.minzoom&&(!y||!y.dem);)y=this.sourceCache.getTileByID(t.scaledTo(h--).key);return y}anyTilesAfterTime(t=Date.now()){return this._lastTilesetChange>=t}}class ig{constructor(t,r,d){this._meshCache={},this.painter=t,this.sourceCache=new Aa(r),this.options=d,this.exaggeration=typeof d.exaggeration=="number"?d.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,r,d,h=o.X){var y;if(!(r>=0&&r<h&&d>=0&&d<h))return 0;const x=this.getTerrainData(t),S=(y=x.tile)===null||y===void 0?void 0:y.dem;if(!S)return 0;const P=o.c9([],[r/h*o.X,d/h*o.X],x.u_terrain_matrix),A=[P[0]*S.dim,P[1]*S.dim],F=Math.floor(A[0]),N=Math.floor(A[1]),j=A[0]-F,X=A[1]-N;return S.get(F,N)*(1-j)*(1-X)+S.get(F+1,N)*j*(1-X)+S.get(F,N+1)*(1-j)*X+S.get(F+1,N+1)*j*X}getElevationForLngLatZoom(t,r){if(!o.ca(r,t.wrap()))return 0;const{tileID:d,mercatorX:h,mercatorY:y}=this._getOverscaledTileIDFromLngLatZoom(t,r);return this.getElevation(d,h%o.X,y%o.X,o.X)}getElevation(t,r,d,h=o.X){return this.getDEMElevation(t,r,d,h)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const h=this.painter.context,y=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ye(h,y,h.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ye(h,new o.R({width:1,height:1}),h.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.aq([])}const r=this.sourceCache.getSourceTile(t,!0);if(r&&r.dem&&(!r.demTexture||r.needsTerrainPrepare)){const h=this.painter.context;r.demTexture=this.painter.getTileTexture(r.dem.stride),r.demTexture?r.demTexture.update(r.dem.getPixels(),{premultiply:!1}):r.demTexture=new ye(h,r.dem.getPixels(),h.gl.RGBA,{premultiply:!1}),r.demTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),r.needsTerrainPrepare=!1}const d=r&&r+r.tileID.key+t.key;if(d&&!this._demMatrixCache[d]){const h=this.sourceCache.sourceCache._source.maxzoom;let y=t.canonical.z-r.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=h?y=t.canonical.z-h:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const x=t.canonical.x-(t.canonical.x>>y<<y),S=t.canonical.y-(t.canonical.y>>y<<y),P=o.cb(new Float64Array(16),[1/(o.X<<y),1/(o.X<<y),0]);o.J(P,P,[x*o.X,S*o.X,0]),this._demMatrixCache[t.key]={matrix:P,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:r&&r.dem&&r.dem.dim||1,u_terrain_matrix:d?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:r&&r.dem&&r.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(r&&r.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:r}}getFramebuffer(t){const r=this.painter,d=r.width/devicePixelRatio,h=r.height/devicePixelRatio;return!this._fbo||this._fbo.width===d&&this._fbo.height===h||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ye(r.context,{width:d,height:h,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ye(r.context,{width:d,height:h,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=r.context.createFramebuffer(d,h,!0,!1),this._fbo.depthAttachment.set(r.context.createRenderbuffer(r.context.gl.DEPTH_COMPONENT16,d,h))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const r=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let y=0,x=0;y<this._coordsTextureSize;y++)for(let S=0;S<this._coordsTextureSize;S++,x+=4)r[x+0]=255&S,r[x+1]=255&y,r[x+2]=S>>8<<4|y>>8,r[x+3]=0;const d=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(r.buffer)),h=new ye(t,d,t.gl.RGBA,{premultiply:!1});return h.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=h,h}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const r=new Uint8Array(4),d=this.painter.context,h=d.gl,y=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),x=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),S=Math.round(this.painter.height/devicePixelRatio);d.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),h.readPixels(y,S-x-1,1,1,h.RGBA,h.UNSIGNED_BYTE,r),d.bindFramebuffer.set(null);const P=r[0]+(r[2]>>4<<8),A=r[1]+((15&r[2])<<8),F=this.coordsIndex[255-r[3]],N=F&&this.sourceCache.getTileByID(F);if(!N)return null;const j=this._coordsTextureSize,X=(1<<N.tileID.canonical.z)*j;return new o.Y((N.tileID.canonical.x*j+P)/X+N.tileID.wrap,(N.tileID.canonical.y*j+A)/X,this.getElevation(N.tileID,P,A,j))}depthAtPoint(t){const r=new Uint8Array(4),d=this.painter.context,h=d.gl;return d.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),h.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,h.RGBA,h.UNSIGNED_BYTE,r),d.bindFramebuffer.set(null),(r[0]/16777216+r[1]/65536+r[2]/256+r[3])/256}getTerrainMesh(t){var r;const d=((r=this.painter.style.projection)===null||r===void 0?void 0:r.transitionState)>0,h=d&&t.canonical.y===0,y=d&&t.canonical.y===(1<<t.canonical.z)-1,x=`m_${h?"n":""}_${y?"s":""}`;if(this._meshCache[x])return this._meshCache[x];const S=this.painter.context,P=new o.cc,A=new o.aE,F=this.meshSize,N=o.X/F,j=F*F;for(let Re=0;Re<=F;Re++)for(let Ge=0;Ge<=F;Ge++)P.emplaceBack(Ge*N,Re*N,0);for(let Re=0;Re<j;Re+=F+1)for(let Ge=0;Ge<F;Ge++)A.emplaceBack(Ge+Re,F+Ge+Re+1,F+Ge+Re+2),A.emplaceBack(Ge+Re,F+Ge+Re+2,Ge+Re+1);const X=P.length,J=X+(F+1),le=(F+1)*F,se=h?o.b6:0,ue=h?0:1,fe=y?o.b7:o.X,we=y?0:1;for(let Re=0;Re<=F;Re++)P.emplaceBack(Re*N,se,ue);for(let Re=0;Re<=F;Re++)P.emplaceBack(Re*N,fe,we);for(let Re=0;Re<F;Re++)A.emplaceBack(le+Re,J+Re,J+Re+1),A.emplaceBack(le+Re,J+Re+1,le+Re+1),A.emplaceBack(0+Re,X+Re+1,X+Re),A.emplaceBack(0+Re,0+Re+1,X+Re+1);const Te=P.length,Ie=Te+2*(F+1);for(const Re of[0,1])for(let Ge=0;Ge<=F;Ge++)for(const Ze of[0,1])P.emplaceBack(Re*o.X,Ge*N,Ze);for(let Re=0;Re<2*F;Re+=2)A.emplaceBack(Te+Re,Te+Re+1,Te+Re+3),A.emplaceBack(Te+Re,Te+Re+3,Te+Re+2),A.emplaceBack(Ie+Re,Ie+Re+3,Ie+Re+1),A.emplaceBack(Ie+Re,Ie+Re+2,Ie+Re+3);const De=new Ia(S.createVertexBuffer(P,Of.members),S.createIndexBuffer(A),o.aD.simpleSegment(0,0,P.length,A.length));return this._meshCache[x]=De,De}getMeshFrameDelta(t){return 2*Math.PI*o.bo/Math.pow(2,Math.max(t,0))/5}getMinTileElevationForLngLatZoom(t,r){var d;const{tileID:h}=this._getOverscaledTileIDFromLngLatZoom(t,r);return(d=this.getMinMaxElevation(h).minElevation)!==null&&d!==void 0?d:0}getMinMaxElevation(t){const r=this.getTerrainData(t).tile,d={minElevation:null,maxElevation:null};return r&&r.dem&&(d.minElevation=r.dem.min*this.exaggeration,d.maxElevation=r.dem.max*this.exaggeration),d}_getOverscaledTileIDFromLngLatZoom(t,r){const d=o.Y.fromLngLat(t.wrap()),h=(1<<r)*o.X,y=d.x*h,x=d.y*h,S=Math.floor(y/o.X),P=Math.floor(x/o.X);return{tileID:new o.S(r,0,r,S,P),mercatorX:y,mercatorY:x}}}class wl{constructor(t,r,d){this._context=t,this._size=r,this._tileSize=d,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const r=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),d=new ye(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return d.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),r.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),r.colorAttachment.set(d.texture),{id:t,fbo:r,texture:d,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(r=>t.id!==r),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const r of this._recentlyUsed)if(!this._objects[r].inUse)return this._objects[r];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(t=>!t.inUse)===!1}}const ni={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class zi{constructor(t,r){this.painter=t,this.terrain=r,this.pool=new wl(t.context,30,r.sourceCache.tileSize*r.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,r){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter(d=>!t._layers[d].isHidden(r)),this._coordsAscending={};for(const d in t.sourceCaches){this._coordsAscending[d]={};const h=t.sourceCaches[d].getVisibleCoordinates();for(const y of h){const x=this.terrain.sourceCache.getTerrainCoords(y);for(const S in x)this._coordsAscending[d][S]||(this._coordsAscending[d][S]=[]),this._coordsAscending[d][S].push(x[S])}}this._coordsAscendingStr={};for(const d of t._order){const h=t._layers[d],y=h.source;if(ni[h.type]&&!this._coordsAscendingStr[y]){this._coordsAscendingStr[y]={};for(const x in this._coordsAscending[y])this._coordsAscendingStr[y][x]=this._coordsAscending[y][x].map(S=>S.key).sort().join()}}for(const d of this._renderableTiles)for(const h in this._coordsAscendingStr){const y=this._coordsAscendingStr[h][d.tileID.key];y&&y!==d.rttCoords[h]&&(d.rtt=[])}}renderLayer(t,r){if(t.isHidden(this.painter.transform.zoom))return!1;const d=Object.assign(Object.assign({},r),{isRenderingToTexture:!0}),h=t.type,y=this.painter,x=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(ni[h]&&(this._prevType&&ni[this._prevType]||this._stacks.push([]),this._prevType=h,this._stacks[this._stacks.length-1].push(t.id),!x))return!0;if(ni[this._prevType]||ni[h]&&x){this._prevType=h;const S=this._stacks.length-1,P=this._stacks[S]||[];for(const A of this._renderableTiles){if(this.pool.isFull()&&(od(this.painter,this.terrain,this._rttTiles,d),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(A),A.rtt[S]){const N=this.pool.getObjectForId(A.rtt[S].id);if(N.stamp===A.rtt[S].stamp){this.pool.useObject(N);continue}}const F=this.pool.getOrCreateFreeObject();this.pool.useObject(F),this.pool.stampObject(F),A.rtt[S]={id:F.id,stamp:F.stamp},y.context.bindFramebuffer.set(F.fbo.framebuffer),y.context.clear({color:o.b4.transparent,stencil:0}),y.currentStencilSource=void 0;for(let N=0;N<P.length;N++){const j=y.style._layers[P[N]],X=j.source?this._coordsAscending[j.source][A.tileID.key]:[A.tileID];y.context.viewport.set([0,0,F.fbo.width,F.fbo.height]),y._renderTileClippingMasks(j,X,!0),y.renderLayer(y,y.style.sourceCaches[j.source],j,X,d),j.source&&(A.rttCoords[j.source]=this._coordsAscendingStr[j.source][A.tileID.key])}}return od(this.painter,this.terrain,this._rttTiles,d),this._rttTiles=[],this.pool.freeAllObjects(),ni[h]}return!1}}const Vf={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Sl=T,Cl={hash:!1,interactive:!0,bearingSnap:7,attributionControl:xl,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},pd={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class md{constructor(t,r,d=!1){this.mousedown=y=>{this.startMove(y,D.mousePos(this.element,y)),D.addEventListener(window,"mousemove",this.mousemove),D.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=y=>{this.move(y,D.mousePos(this.element,y))},this.mouseup=y=>{this._rotatePitchHanlder.dragEnd(y),this.offTemp()},this.touchstart=y=>{y.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=D.touchPos(this.element,y.targetTouches)[0],this.startMove(y,this._startPos),D.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),D.addEventListener(window,"touchend",this.touchend))},this.touchmove=y=>{y.targetTouches.length!==1?this.reset():(this._lastPos=D.touchPos(this.element,y.targetTouches)[0],this.move(y,this._lastPos))},this.touchend=y=>{y.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=r;const h=new bl;this._rotatePitchHanlder=new Ft({clickTolerance:3,move:(y,x)=>{const S=r.getBoundingClientRect(),P=new o.P((S.bottom-S.top)/2,(S.right-S.left)/2);return{bearingDelta:o.c7(new o.P(y.x,x.y),x,P),pitchDelta:d?-.5*(x.y-y.y):void 0}},moveStateManager:h,enable:!0,assignEvents:()=>{}}),this.map=t,D.addEventListener(r,"mousedown",this.mousedown),D.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),D.addEventListener(r,"touchcancel",this.reset)}startMove(t,r){this._rotatePitchHanlder.dragStart(t,r),D.disableDrag()}move(t,r){const d=this.map,{bearingDelta:h,pitchDelta:y}=this._rotatePitchHanlder.dragMove(t,r)||{};h&&d.setBearing(d.getBearing()+h),y&&d.setPitch(d.getPitch()+y)}off(){const t=this.element;D.removeEventListener(t,"mousedown",this.mousedown),D.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),D.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),D.removeEventListener(window,"touchend",this.touchend),D.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){D.enableDrag(),D.removeEventListener(window,"mousemove",this.mousemove),D.removeEventListener(window,"mouseup",this.mouseup),D.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),D.removeEventListener(window,"touchend",this.touchend)}}let Wa;function Ro(_,t,r){const d=new o.N(_.lng,_.lat);if(_=new o.N(_.lng,_.lat),t){const h=new o.N(_.lng-360,_.lat),y=new o.N(_.lng+360,_.lat),x=r.locationToScreenPoint(_).distSqr(t);r.locationToScreenPoint(h).distSqr(t)<x?_=h:r.locationToScreenPoint(y).distSqr(t)<x&&(_=y)}for(;Math.abs(_.lng-r.center.lng)>180;){const h=r.locationToScreenPoint(_);if(h.x>=0&&h.y>=0&&h.x<=r.width&&h.y<=r.height)break;_.lng>r.center.lng?_.lng-=360:_.lng+=360}return _.lng!==d.lng&&r.isPointOnMapSurface(r.locationToScreenPoint(_))?_:d}const Tl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Oc(_,t,r){const d=_.classList;for(const h in Tl)d.remove(`maplibregl-${r}-anchor-${h}`);d.add(`maplibregl-${r}-anchor-${t}`)}class Pl extends o.E{constructor(t){if(super(),this._onKeyPress=r=>{const d=r.code,h=r.charCode||r.keyCode;d!=="Space"&&d!=="Enter"&&h!==32&&h!==13||this.togglePopup()},this._onMapClick=r=>{const d=r.originalEvent.target,h=this._element;this._popup&&(d===h||h.contains(d))&&this.togglePopup()},this._update=r=>{var d;if(!this._map)return;const h=this._map.loaded()&&!this._map.isMoving();((r==null?void 0:r.type)==="terrain"||(r==null?void 0:r.type)==="render"&&!h)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Ro(this._lngLat,this._flatPos,this._map.transform):(d=this._lngLat)===null||d===void 0?void 0:d.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let y="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?y=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(y=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let x="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?x="rotateX(0deg)":this._pitchAlignment==="map"&&(x=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||r&&r.type!=="moveend"||(this._pos=this._pos.round()),D.setTransform(this._element,`${Tl[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${x} ${y}`),O.frameAsync(new AbortController).then(()=>{this._updateOpacity(r&&r.type==="moveend")}).catch(()=>{})},this._onMove=r=>{if(!this._isDragging){const d=this._clickTolerance||this._map._clickTolerance;this._isDragging=r.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=r.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.k("dragstart"))),this.fire(new o.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.k("dragend")),this._state="inactive"},this._addDragHandler=r=>{this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos).add(this._offset),this._pointerdownPos=r.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(t==null?void 0:t.opacity,t==null?void 0:t.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=o.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=D.create("div");const r=D.createNS("http://www.w3.org/2000/svg","svg"),d=41,h=27;r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height",`${d}px`),r.setAttributeNS(null,"width",`${h}px`),r.setAttributeNS(null,"viewBox",`0 0 ${h} ${d}`);const y=D.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"stroke","none"),y.setAttributeNS(null,"stroke-width","1"),y.setAttributeNS(null,"fill","none"),y.setAttributeNS(null,"fill-rule","evenodd");const x=D.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"fill-rule","nonzero");const S=D.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"transform","translate(3.0, 29.0)"),S.setAttributeNS(null,"fill","#000000");const P=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ue of P){const fe=D.createNS("http://www.w3.org/2000/svg","ellipse");fe.setAttributeNS(null,"opacity","0.04"),fe.setAttributeNS(null,"cx","10.5"),fe.setAttributeNS(null,"cy","5.80029008"),fe.setAttributeNS(null,"rx",ue.rx),fe.setAttributeNS(null,"ry",ue.ry),S.appendChild(fe)}const A=D.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"fill",this._color);const F=D.createNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),A.appendChild(F);const N=D.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"opacity","0.25"),N.setAttributeNS(null,"fill","#000000");const j=D.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),N.appendChild(j);const X=D.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"transform","translate(6.0, 7.0)"),X.setAttributeNS(null,"fill","#FFFFFF");const J=D.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"transform","translate(8.0, 8.0)");const le=D.createNS("http://www.w3.org/2000/svg","circle");le.setAttributeNS(null,"fill","#000000"),le.setAttributeNS(null,"opacity","0.25"),le.setAttributeNS(null,"cx","5.5"),le.setAttributeNS(null,"cy","5.5"),le.setAttributeNS(null,"r","5.4999962");const se=D.createNS("http://www.w3.org/2000/svg","circle");se.setAttributeNS(null,"fill","#FFFFFF"),se.setAttributeNS(null,"cx","5.5"),se.setAttributeNS(null,"cy","5.5"),se.setAttributeNS(null,"r","5.4999962"),J.appendChild(le),J.appendChild(se),x.appendChild(S),x.appendChild(A),x.appendChild(N),x.appendChild(X),x.appendChild(J),r.appendChild(x),r.setAttributeNS(null,"height",d*this._scale+"px"),r.setAttributeNS(null,"width",h*this._scale+"px"),this._element.appendChild(r),this._offset=o.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",r=>{r.preventDefault()}),this._element.addEventListener("mousedown",r=>{r.preventDefault()}),Oc(this._element,this._anchor,"marker"),t&&t.className)for(const r of t.className.split(" "))this._element.classList.add(r);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),t.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),D.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=o.N.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const h=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[h,-1*(38.1-13.5+h)],"bottom-right":[-h,-1*(38.1-13.5+h)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var r,d;if(!(!((r=this._map)===null||r===void 0)&&r.terrain)){const N=this._map.transform.isLocationOccluded(this._lngLat)?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==N&&(this._element.style.opacity=N))}if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const h=this._map,y=h.terrain.depthAtPoint(this._pos),x=h.terrain.getElevationForLngLatZoom(this._lngLat,h.transform.tileZoom);if(h.transform.lngLatToCameraDepth(this._lngLat,x)-y<.006)return void(this._element.style.opacity=this._opacity);const S=-this._offset.y/h.transform.pixelsPerMeter,P=Math.sin(h.getPitch()*Math.PI/180)*S,A=h.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),F=h.transform.lngLatToCameraDepth(this._lngLat,x+P)-A>.006;!((d=this._popup)===null||d===void 0)&&d.isOpen()&&F&&this._popup.remove(),this._element.style.opacity=F?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=o.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,r){return t===void 0&&r===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),r!==void 0&&(this._opacityWhenCovered=r),this._map&&this._updateOpacity(!0),this}}const gd={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Do=0,Hs=!1;const _d={maxWidth:100,unit:"metric"};function Vc(_,t,r){const d=r&&r.maxWidth||100,h=_._container.clientHeight/2,y=_._container.clientWidth/2,x=_.unproject([y-d/2,h]),S=_.unproject([y+d/2,h]),P=Math.round(_.project(S).x-_.project(x).x),A=Math.min(d,P,_._container.clientWidth),F=x.distanceTo(S);if(r&&r.unit==="imperial"){const N=3.2808*F;N>5280?ps(t,A,N/5280,_._getUIString("ScaleControl.Miles")):ps(t,A,N,_._getUIString("ScaleControl.Feet"))}else r&&r.unit==="nautical"?ps(t,A,F/1852,_._getUIString("ScaleControl.NauticalMiles")):F>=1e3?ps(t,A,F/1e3,_._getUIString("ScaleControl.Kilometers")):ps(t,A,F,_._getUIString("ScaleControl.Meters"))}function ps(_,t,r,d){const h=function(y){const x=Math.pow(10,`${Math.floor(y)}`.length-1);let S=y/x;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(P){const A=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*A)/A}(S),x*S}(r);_.style.width=t*(h/r)+"px",_.innerHTML=`${h}&nbsp;${d}`}const yd={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},vd=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function kl(_){if(_){if(typeof _=="number"){const t=Math.round(Math.abs(_)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,_),"top-left":new o.P(t,t),"top-right":new o.P(-t,t),bottom:new o.P(0,-_),"bottom-left":new o.P(t,-t),"bottom-right":new o.P(-t,-t),left:new o.P(_,0),right:new o.P(-_,0)}}if(_ instanceof o.P||Array.isArray(_)){const t=o.P.convert(_);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:o.P.convert(_.center||[0,0]),top:o.P.convert(_.top||[0,0]),"top-left":o.P.convert(_["top-left"]||[0,0]),"top-right":o.P.convert(_["top-right"]||[0,0]),bottom:o.P.convert(_.bottom||[0,0]),"bottom-left":o.P.convert(_["bottom-left"]||[0,0]),"bottom-right":o.P.convert(_["bottom-right"]||[0,0]),left:o.P.convert(_.left||[0,0]),right:o.P.convert(_.right||[0,0])}}return kl(new o.P(0,0))}const bd=T;m.AJAXError=o.cg,m.Event=o.k,m.Evented=o.E,m.LngLat=o.N,m.MercatorCoordinate=o.Y,m.Point=o.P,m.addProtocol=o.ch,m.config=o.a,m.removeProtocol=o.ci,m.AttributionControl=Bc,m.BoxZoomHandler=Tf,m.CanvasSource=wt,m.CooperativeGesturesHandler=fd,m.DoubleClickZoomHandler=qa,m.DragPanHandler=zc,m.DragRotateHandler=dd,m.EdgeInsets=gr,m.FullscreenControl=class extends o.E{constructor(_={}){super(),this._onFullscreenChange=()=>{var t;let r=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=r==null?void 0:r.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)r=r.shadowRoot.fullscreenElement;r===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,_&&_.container&&(_.container instanceof HTMLElement?this._container=_.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){D.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const _=this._fullscreenButton=D.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);D.create("span","maplibregl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.title=_}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},m.GeoJSONSource=Bt,m.GeolocateControl=class extends o.E{constructor(_){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new o.k("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.k("geolocate",t)),this._finish()}},this._updateCamera=t=>{const r=new o.N(t.coords.longitude,t.coords.latitude),d=t.coords.accuracy,h=this._map.getBearing(),y=o.e({bearing:h},this.options.fitBoundsOptions),x=Le.fromLngLat(r,d);this._map.fitBounds(x,y,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const r=new o.N(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(this.options.trackUserLocation)if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&Hs)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.k("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=D.create("button","maplibregl-ctrl-geolocate",this._container),D.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Pl({element:this._dotElement}),this._circleElement=D.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Pl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.k("trackuserlocationend")),this.fire(new o.k("userlocationlostfocus")))})}},this.options=o.e({},gd,_)}onAdd(_){return this._map=_,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return o._(this,arguments,void 0,function*(t=!1){if(Wa!==void 0&&!t)return Wa;if(window.navigator.permissions===void 0)return Wa=!!window.navigator.geolocation,Wa;try{Wa=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Wa=!!window.navigator.geolocation}return Wa})}().then(t=>this._finishSetupUI(t)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),D.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Do=0,Hs=!1}_isOutOfMapMaxBounds(_){const t=this._map.getMaxBounds(),r=_.coords;return t&&(r.longitude<t.getWest()||r.longitude>t.getEast()||r.latitude<t.getSouth()||r.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const _=this._map.getBounds(),t=_.getSouthEast(),r=_.getNorthEast(),d=t.distanceTo(r),h=Math.ceil(this._accuracy/(d/this._map._container.clientHeight)*2);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Do--,Hs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.k("trackuserlocationstart")),this.fire(new o.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let _;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Do++,Do>1?(_={maximumAge:6e5,timeout:0},Hs=!0):(_=this.options.positionOptions,Hs=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,_)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},m.GlobeControl=class{constructor(){this._toggleProjection=()=>{var _;const t=(_=this._map.getProjection())===null||_===void 0?void 0:_.type;this._map.setProjection(t!=="mercator"&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var _;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((_=this._map.getProjection())===null||_===void 0?void 0:_.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(_){return this._map=_,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=D.create("button","maplibregl-ctrl-globe",this._container),D.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){D.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},m.Hash=cd,m.ImageSource=It,m.KeyboardHandler=zf,m.LngLatBounds=Le,m.LogoControl=Fc,m.Map=class extends sn{constructor(_){var t,r;o.cd.mark(o.ce.create);const d=Object.assign(Object.assign(Object.assign({},Cl),_),{canvasContextAttributes:Object.assign(Object.assign({},Cl.canvasContextAttributes),_.canvasContextAttributes)});if(d.minZoom!=null&&d.maxZoom!=null&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(d.minPitch!=null&&d.maxPitch!=null&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(d.minPitch!=null&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(d.maxPitch!=null&&d.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const h=new Ua,y=new ac;if(d.minZoom!==void 0&&h.setMinZoom(d.minZoom),d.maxZoom!==void 0&&h.setMaxZoom(d.maxZoom),d.minPitch!==void 0&&h.setMinPitch(d.minPitch),d.maxPitch!==void 0&&h.setMaxPitch(d.maxPitch),d.renderWorldCopies!==void 0&&h.setRenderWorldCopies(d.renderWorldCopies),super(h,y,{bearingSnap:d.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Ar,this._controls=[],this._mapId=o.a1(),this._contextLost=S=>{S.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new o.k("webglcontextlost",{originalEvent:S}))},this._contextRestored=S=>{this._setupPainter(),this.resize(),this._update(),this.fire(new o.k("webglcontextrestored",{originalEvent:S}))},this._onMapScroll=S=>{if(S.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=d.interactive,this._maxTileCacheSize=d.maxTileCacheSize,this._maxTileCacheZoomLevels=d.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},d.canvasContextAttributes),this._trackResize=d.trackResize===!0,this._bearingSnap=d.bearingSnap,this._centerClampedToGround=d.centerClampedToGround,this._refreshExpiredTiles=d.refreshExpiredTiles===!0,this._fadeDuration=d.fadeDuration,this._crossSourceCollisions=d.crossSourceCollisions===!0,this._collectResourceTiming=d.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Vf),d.locale),this._clickTolerance=d.clickTolerance,this._overridePixelRatio=d.pixelRatio,this._maxCanvasSize=d.maxCanvasSize,this.transformCameraUpdate=d.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=d.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=me.addThrottleControl(()=>this.isMoving()),this._requestManager=new be(d.transformRequest),typeof d.container=="string"){if(this._container=document.getElementById(d.container),!this._container)throw new Error(`Container '${d.container}' not found.`)}else{if(!(d.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(d.maxBounds&&this.setMaxBounds(d.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let S=!1;const P=hs(A=>{this._trackResize&&!this._removed&&(this.resize(A),this.redraw())},50);this._resizeObserver=new ResizeObserver(A=>{S?P(A):S=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Zt(this,d),this._hash=d.hash&&new cd(typeof d.hash=="string"&&d.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:d.center,elevation:d.elevation,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,roll:d.roll}),d.bounds&&(this.resize(),this.fitBounds(d.bounds,o.e({},d.fitBoundsOptions,{duration:0}))));const x=typeof d.style=="string"||((r=(t=d.style)===null||t===void 0?void 0:t.projection)===null||r===void 0?void 0:r.type)!=="globe";this.resize(null,x),this._localIdeographFontFamily=d.localIdeographFontFamily,this._validateStyle=d.validateStyle,d.style&&this.setStyle(d.style,{localIdeographFontFamily:d.localIdeographFontFamily}),d.attributionControl&&this.addControl(new Bc(typeof d.attributionControl=="boolean"?void 0:d.attributionControl)),d.maplibreLogo&&this.addControl(new Fc,d.logoPosition),this.on("style.load",()=>{if(x||this._resizeTransform(),this.transform.unmodified){const S=o.M(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(S)}}),this.on("data",S=>{this._update(S.dataType==="style"),this.fire(new o.k(`${S.dataType}data`,S))}),this.on("dataloading",S=>{this.fire(new o.k(`${S.dataType}dataloading`,S))}),this.on("dataabort",S=>{this.fire(new o.k("sourcedataabort",S))})}_getMapId(){return this._mapId}addControl(_,t){if(t===void 0&&(t=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new o.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=_.onAdd(this);this._controls.push(_);const d=this._controlPositions[t];return t.indexOf("bottom")!==-1?d.insertBefore(r,d.firstChild):d.appendChild(r),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new o.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(_);return t>-1&&this._controls.splice(t,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}calculateCameraOptionsFromTo(_,t,r,d){return d==null&&this.terrain&&(d=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(_,t,r,d)}resize(_,t=!0){const[r,d]=this._containerDimensions(),h=this._getClampedPixelRatio(r,d);if(this._resizeCanvas(r,d,h),this.painter.resize(r,d,h),this.painter.overLimit()){const x=this.painter.context.gl;this._maxCanvasSize=[x.drawingBufferWidth,x.drawingBufferHeight];const S=this._getClampedPixelRatio(r,d);this._resizeCanvas(r,d,S),this.painter.resize(r,d,S)}this._resizeTransform(t);const y=!this._moving;return y&&(this.stop(),this.fire(new o.k("movestart",_)).fire(new o.k("move",_))),this.fire(new o.k("resize",_)),y&&this.fire(new o.k("moveend",_)),this}_resizeTransform(_=!0){var t;const[r,d]=this._containerDimensions();this.transform.resize(r,d,_),(t=this._requestedCameraState)===null||t===void 0||t.resize(r,d,_)}_getClampedPixelRatio(_,t){const{0:r,1:d}=this._maxCanvasSize,h=this.getPixelRatio(),y=_*h,x=t*h;return Math.min(y>r?r/y:1,x>d?d/x:1)*h}getPixelRatio(){var _;return(_=this._overridePixelRatio)!==null&&_!==void 0?_:devicePixelRatio}setPixelRatio(_){this._overridePixelRatio=_,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(_){return this.transform.setMaxBounds(Le.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.setMinZoom(_),this._update(),this.getZoom()<_&&this.setZoom(_),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.setMaxZoom(_),this._update(),this.getZoom()>_&&this.setZoom(_),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.setMinPitch(_),this._update(),this.getPitch()<_&&this.setPitch(_),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(_>=this.transform.minPitch)return this.transform.setMaxPitch(_),this._update(),this.getPitch()>_&&this.setPitch(_),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.setRenderWorldCopies(_),this._update()}project(_){return this.transform.locationToScreenPoint(o.N.convert(_),this.style&&this.terrain)}unproject(_){return this.transform.screenPointToLocation(o.P.convert(_),this.terrain)}isMoving(){var _;return this._moving||((_=this.handlers)===null||_===void 0?void 0:_.isMoving())}isZooming(){var _;return this._zooming||((_=this.handlers)===null||_===void 0?void 0:_.isZooming())}isRotating(){var _;return this._rotating||((_=this.handlers)===null||_===void 0?void 0:_.isRotating())}_createDelegatedListener(_,t,r){if(_==="mouseenter"||_==="mouseover"){let d=!1;return{layers:t,listener:r,delegates:{mousemove:y=>{const x=t.filter(P=>this.getLayer(P)),S=x.length!==0?this.queryRenderedFeatures(y.point,{layers:x}):[];S.length?d||(d=!0,r.call(this,new Ri(_,this,y.originalEvent,{features:S}))):d=!1},mouseout:()=>{d=!1}}}}if(_==="mouseleave"||_==="mouseout"){let d=!1;return{layers:t,listener:r,delegates:{mousemove:x=>{const S=t.filter(P=>this.getLayer(P));(S.length!==0?this.queryRenderedFeatures(x.point,{layers:S}):[]).length?d=!0:d&&(d=!1,r.call(this,new Ri(_,this,x.originalEvent)))},mouseout:x=>{d&&(d=!1,r.call(this,new Ri(_,this,x.originalEvent)))}}}}{const d=h=>{const y=t.filter(S=>this.getLayer(S)),x=y.length!==0?this.queryRenderedFeatures(h.point,{layers:y}):[];x.length&&(h.features=x,r.call(this,h),delete h.features)};return{layers:t,listener:r,delegates:{[_]:d}}}}_saveDelegatedListener(_,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(t)}_removeDelegatedListener(_,t,r){if(!this._delegatedListeners||!this._delegatedListeners[_])return;const d=this._delegatedListeners[_];for(let h=0;h<d.length;h++){const y=d[h];if(y.listener===r&&y.layers.length===t.length&&y.layers.every(x=>t.includes(x))){for(const x in y.delegates)this.off(x,y.delegates[x]);return void d.splice(h,1)}}}on(_,t,r){if(r===void 0)return super.on(_,t);const d=typeof t=="string"?[t]:t,h=this._createDelegatedListener(_,d,r);this._saveDelegatedListener(_,h);for(const y in h.delegates)this.on(y,h.delegates[y]);return{unsubscribe:()=>{this._removeDelegatedListener(_,d,r)}}}once(_,t,r){if(r===void 0)return super.once(_,t);const d=typeof t=="string"?[t]:t,h=this._createDelegatedListener(_,d,r);for(const y in h.delegates){const x=h.delegates[y];h.delegates[y]=(...S)=>{this._removeDelegatedListener(_,d,r),x(...S)}}this._saveDelegatedListener(_,h);for(const y in h.delegates)this.once(y,h.delegates[y]);return this}off(_,t,r){return r===void 0?super.off(_,t):(this._removeDelegatedListener(_,typeof t=="string"?[t]:t,r),this)}queryRenderedFeatures(_,t){if(!this.style)return[];let r;const d=_ instanceof o.P||Array.isArray(_),h=d?_:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(d?{}:_)||{},h instanceof o.P||typeof h[0]=="number")r=[o.P.convert(h)];else{const y=o.P.convert(h[0]),x=o.P.convert(h[1]);r=[y,new o.P(x.x,y.y),x,new o.P(y.x,x.y),y]}return this.style.queryRenderedFeatures(r,t,this.transform)}querySourceFeatures(_,t){return this.style.querySourceFeatures(_,t)}setStyle(_,t){return(t=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&_?(this._diffStyle(_,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(_,t))}setTransformRequest(_){return this._requestManager.setTransformRequest(_),this}_getUIString(_){const t=this._locale[_];if(t==null)throw new Error(`Missing UI string '${_}'`);return t}_updateStyle(_,t){var r,d;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(_,t));const h=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!_)),_?(this.style=new Qr(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof _=="string"?this.style.loadURL(_,t,h):this.style.loadJSON(_,t,h),this):((d=(r=this.style)===null||r===void 0?void 0:r.projection)===null||d===void 0||d.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Qr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,t){if(typeof _=="string"){const r=this._requestManager.transformRequest(_,"Style");o.h(r,new AbortController).then(d=>{this._updateDiff(d.data,t)}).catch(d=>{d&&this.fire(new o.j(d))})}else typeof _=="object"&&this._updateDiff(_,t)}_updateDiff(_,t){try{this.style.setState(_,t)&&this._update(!0)}catch(r){o.w(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(_,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(_,t){return this._lazyInitEmptyStyle(),this.style.addSource(_,t),this._update(!0)}isSourceLoaded(_){const t=this.style&&this.style.sourceCaches[_];if(t!==void 0)return t.loaded();this.fire(new o.j(new Error(`There is no source with ID '${_}'`)))}setTerrain(_){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),_){const t=this.style.sourceCaches[_.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${_.source}`);this.terrain===null&&t.reload();for(const r in this.style._layers){const d=this.style._layers[r];d.type==="hillshade"&&d.source===_.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new ig(this.painter,t,_),this.painter.renderToTexture=new zi(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=r=>{r.dataType==="style"?this.terrain.sourceCache.freeRtt():r.dataType==="source"&&r.tile&&(r.sourceId!==_.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),this.terrain.sourceCache.freeRtt(r.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new o.k("terrain",{terrain:_})),this}getTerrain(){var _,t;return(t=(_=this.terrain)===null||_===void 0?void 0:_.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const _=this.style&&this.style.sourceCaches;for(const t in _){const r=_[t]._tiles;for(const d in r){const h=r[d];if(h.state!=="loaded"&&h.state!=="errored")return!1}}return!0}removeSource(_){return this.style.removeSource(_),this._update(!0)}getSource(_){return this.style.getSource(_)}addImage(_,t,r={}){const{pixelRatio:d=1,sdf:h=!1,stretchX:y,stretchY:x,content:S,textFitWidth:P,textFitHeight:A}=r;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||o.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new o.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:F,height:N,data:j}=t,X=t;return this.style.addImage(_,{data:new o.R({width:F,height:N},new Uint8Array(j)),pixelRatio:d,stretchX:y,stretchY:x,content:S,textFitWidth:P,textFitHeight:A,sdf:h,version:0,userImage:X}),X.onAdd&&X.onAdd(this,_),this}}{const{width:F,height:N,data:j}=O.getImageData(t);this.style.addImage(_,{data:new o.R({width:F,height:N},j),pixelRatio:d,stretchX:y,stretchY:x,content:S,textFitWidth:P,textFitHeight:A,sdf:h,version:0})}}updateImage(_,t){const r=this.style.getImage(_);if(!r)return this.fire(new o.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const d=t instanceof HTMLImageElement||o.b(t)?O.getImageData(t):t,{width:h,height:y,data:x}=d;if(h===void 0||y===void 0)return this.fire(new o.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(h!==r.data.width||y!==r.data.height)return this.fire(new o.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const S=!(t instanceof HTMLImageElement||o.b(t));return r.data.replace(x,S),this.style.updateImage(_,r),this}getImage(_){return this.style.getImage(_)}hasImage(_){return _?!!this.style.getImage(_):(this.fire(new o.j(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_){return me.getImage(this._requestManager.transformRequest(_,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(_,t){return this._lazyInitEmptyStyle(),this.style.addLayer(_,t),this._update(!0)}moveLayer(_,t){return this.style.moveLayer(_,t),this._update(!0)}removeLayer(_){return this.style.removeLayer(_),this._update(!0)}getLayer(_){return this.style.getLayer(_)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(_,t,r){return this.style.setLayerZoomRange(_,t,r),this._update(!0)}setFilter(_,t,r={}){return this.style.setFilter(_,t,r),this._update(!0)}getFilter(_){return this.style.getFilter(_)}setPaintProperty(_,t,r,d={}){return this.style.setPaintProperty(_,t,r,d),this._update(!0)}getPaintProperty(_,t){return this.style.getPaintProperty(_,t)}setLayoutProperty(_,t,r,d={}){return this.style.setLayoutProperty(_,t,r,d),this._update(!0)}getLayoutProperty(_,t){return this.style.getLayoutProperty(_,t)}setGlyphs(_,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(_,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(_,t,r={}){return this._lazyInitEmptyStyle(),this.style.addSprite(_,t,r,d=>{d||this._update(!0)}),this}removeSprite(_){return this._lazyInitEmptyStyle(),this.style.removeSprite(_),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(_,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(_,t,r=>{r||this._update(!0)}),this}setLight(_,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(_,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(_,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(_,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(_,t){return this.style.setFeatureState(_,t),this._update()}removeFeatureState(_,t){return this.style.removeFeatureState(_,t),this._update()}getFeatureState(_){return this.style.getFeatureState(_)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let _=0,t=0;return this._container&&(_=this._container.clientWidth||400,t=this._container.clientHeight||300),[_,t]}_setupContainer(){const _=this._container;_.classList.add("maplibregl-map");const t=this._canvasContainer=D.create("div","maplibregl-canvas-container",_);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=D.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const r=this._containerDimensions(),d=this._getClampedPixelRatio(r[0],r[1]);this._resizeCanvas(r[0],r[1],d);const h=this._controlContainer=D.create("div","maplibregl-control-container",_),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{y[x]=D.create("div",`maplibregl-ctrl-${x} `,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,t,r){this._canvas.width=Math.floor(r*_),this._canvas.height=Math.floor(r*t),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const _=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",d=>{t={requestedAttributes:_},d&&(t.statusMessage=d.statusMessage,t.type=d.type)},{once:!0});let r=null;if(r=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,_):this._canvas.getContext("webgl2",_)||this._canvas.getContext("webgl",_),!r){const d="Failed to initialize WebGL";throw t?(t.message=d,new Error(JSON.stringify(t))):new Error(d)}this.painter=new vf(r,this.transform),B.testSupport(r)}migrateProjection(_,t){super.migrateProjection(_,t),this.painter.transform=_,this.fire(new o.k("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_render(_){var t,r,d,h,y;const x=this._idleTriggered?this._fadeDuration:0,S=((t=this.style.projection)===null||t===void 0?void 0:t.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(_),this._removed)return;let P=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const N=this.transform.zoom,j=O.now();this.style.zoomHistory.update(N,j);const X=new o.z(N,{now:j,fadeDuration:x,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),J=X.crossFadingFactor();J===1&&J===this._crossFadingFactor||(P=!0,this._crossFadingFactor=J),this.style.update(X)}const A=((r=this.style.projection)===null||r===void 0?void 0:r.transitionState)>0!==S;(d=this.style.projection)===null||d===void 0||d.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((h=this.style.projection)===null||h===void 0?void 0:h.transitionState,(y=this.style.projection)===null||y===void 0?void 0:y.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||A)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,x,this._crossSourceCollisions,A),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:x,showPadding:this.showPadding}),this.fire(new o.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.cd.mark(o.ce.load),this.fire(new o.k("load"))),this.style&&(this.style.hasTransitions()||P)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const F=this._sourcesDirty||this._styleDirty||this._placementDirty;return F||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.k("idle")),!this._loaded||this._fullyLoaded||F||(this._fullyLoaded=!0,o.cd.mark(o.ce.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var _;this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),me.removeThrottleControl(this._imageQueueHandle),(_=this._resizeObserver)===null||_===void 0||_.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t!=null&&t.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),D.remove(this._canvasContainer),D.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),o.cd.clearMetrics(),this._removed=!0,this.fire(new o.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,O.frame(this._frameRequest,_=>{o.cd.frame(_),this._frameRequest=null;try{this._render(_)}catch(t){if(!o.cf(t)&&!function(r){return r.message===vc}(t))throw t}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get version(){return Sl}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(_){return this._lazyInitEmptyStyle(),this.style.setProjection(_),this._update(!0)}},m.MapMouseEvent=Ri,m.MapTouchEvent=Io,m.MapWheelEvent=pa,m.Marker=Pl,m.NavigationControl=class{constructor(_){this._updateZoomButtons=()=>{const t=this._map.getZoom(),r=t===this._map.getMaxZoom(),d=t===this._map.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(t,r)=>{const d=this._map._getUIString(`NavigationControl.${r}`);t.title=d,t.setAttribute("aria-label",d)},this.options=o.e({},pd,_),this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),D.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),D.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=D.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new md(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){D.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(_,t){const r=D.create("button",_,this._container);return r.type="button",r.addEventListener("click",t),r}},m.Popup=class extends o.E{constructor(_){super(),this.remove=()=>(this._content&&D.remove(this._content),this._container&&(D.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.k("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{var r;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=D.create("div","maplibregl-popup",this._map.getContainer()),this._tip=D.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const S of this.options.className.split(" "))this._container.classList.add(S);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Ro(this._lngLat,this._flatPos,this._map.transform):(r=this._lngLat)===null||r===void 0?void 0:r.wrap(),this._trackPointer&&!t)return;const d=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationToScreenPoint(this._lngLat));let h=this.options.anchor;const y=kl(this.options.offset);if(!h){const S=this._container.offsetWidth,P=this._container.offsetHeight;let A;A=d.y+y.bottom.y<P?["top"]:d.y>this._map.transform.height-P?["bottom"]:[],d.x<S/2?A.push("left"):d.x>this._map.transform.width-S/2&&A.push("right"),h=A.length===0?"bottom":A.join("-")}let x=d.add(y[h]);this.options.subpixelPositioning||(x=x.round()),D.setTransform(this._container,`${Tl[h]} translate(${x.x}px,${x.y}px)`),Oc(this._container,h,"popup")},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(yd),_)}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(_){return this._lngLat=o.N.convert(_),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(document.createTextNode(_))}setHTML(_){const t=document.createDocumentFragment(),r=document.createElement("body");let d;for(r.innerHTML=_;d=r.firstChild,d;)t.appendChild(d);return this.setDOMContent(t)}getMaxWidth(){var _;return(_=this._container)===null||_===void 0?void 0:_.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=D.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(_),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(_){return this._container&&this._container.classList.add(_),this}removeClassName(_){return this._container&&this._container.classList.remove(_),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){if(this._container)return this._container.classList.toggle(_)}setSubpixelPositioning(_){this.options.subpixelPositioning=_}_createCloseButton(){this.options.closeButton&&(this._closeButton=D.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(vd);_&&_.focus()}},m.RasterDEMTileSource=vt,m.RasterTileSource=gt,m.ScaleControl=class{constructor(_){this._onMove=()=>{Vc(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,Vc(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},_d),_)}getDefaultPosition(){return"bottom-left"}onAdd(_){return this._map=_,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-scale",_.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){D.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},m.ScrollZoomHandler=Ff,m.Style=Qr,m.TerrainControl=class{constructor(_){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=_}onAdd(_){return this._map=_,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=D.create("button","maplibregl-ctrl-terrain",this._container),D.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){D.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},m.TwoFingersTouchPitchHandler=Rc,m.TwoFingersTouchRotateHandler=Rf,m.TwoFingersTouchZoomHandler=Ec,m.TwoFingersTouchZoomRotateHandler=hd,m.VectorTileSource=xt,m.VideoSource=Rt,m.addSourceType=(_,t)=>o._(void 0,void 0,void 0,function*(){if($t(_))throw new Error(`A source type called "${_}" already exists.`);((r,d)=>{tn[r]=d})(_,t)}),m.clearPrewarmedResources=function(){const _=Lt;_&&(_.isPreloaded()&&_.numActive()===1?(_.release(ct),Lt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},m.createTileMesh=sl,m.getMaxParallelImageRequests=function(){return o.a.MAX_PARALLEL_IMAGE_REQUESTS},m.getRTLTextPluginStatus=function(){return Dn().getRTLTextPluginStatus()},m.getVersion=function(){return bd},m.getWorkerCount=function(){return zt.workerCount},m.getWorkerUrl=function(){return o.a.WORKER_URL},m.importScriptInWorkers=function(_){return bn().broadcast("IS",_)},m.prewarm=function(){qt().acquire(ct)},m.setMaxParallelImageRequests=function(_){o.a.MAX_PARALLEL_IMAGE_REQUESTS=_},m.setRTLTextPlugin=function(_,t){return Dn().setRTLTextPlugin(_,t)},m.setWorkerCount=function(_){zt.workerCount=_},m.setWorkerUrl=function(_){o.a.WORKER_URL=_}});var g=l;return g})})(WC);var Ap=WC.exports;const yp=Xz(Ap),Kz={class:"map-page-container"},Yz={class:"subheader"},Jz={class:"map-wrapper"},Qz="https://s.rsg.sc/sc/images/games/GTAV/map/game/{z}/{x}/{y}.jpg",eL=4,tL=Vn({__name:"RacingMapTab",setup(e){const i=Qw(),l=ei(),u=Ke(void 0),f=Ke(void 0),g=Ke(void 0),m=Ke(void 0),o=Ke(!1),T=Ke([]),k=Ke(void 0),I=Ke(void 0),z=Ke([]),O=[-100.43,.74],D=()=>{f.value&&be.value.forEach(ke=>{if(!f.value)return;const Ee=new yp.Marker({element:Z(ke)}).setLngLat(_p(ke.Checkpoints[0].coords.x,ke.Checkpoints[0].coords.y)).addTo(f.value);Ee.getElement().addEventListener("click",()=>{oe(ke)}),z.value.push(Ee)})},B=()=>{setTimeout(()=>{z.value.forEach(ke=>ke.remove()),z.value=[],D()},100)},V=()=>{T.value.forEach(ke=>ke.remove()),T.value=[],k.value&&f.value&&(f.value.getLayer(k.value)&&f.value.removeLayer(k.value),f.value.getSource(k.value)&&f.value.removeSource(k.value),k.value=void 0),I.value&&(I.value.remove(),I.value=void 0)},Z=ke=>{const Ee=document.createElement("div");Ee.className="marker",Ee.style.color=Se(ke);const xe="http://www.w3.org/2000/svg",Oe=document.createElementNS(xe,"svg");Oe.setAttribute("viewBox","0 0 24 24"),Oe.setAttribute("width","34"),Oe.setAttribute("height","34");const We=document.createElementNS(xe,"path");return We.setAttribute("d","M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"),We.setAttribute("fill","currentColor"),Oe.appendChild(We),Ee.appendChild(Oe),Ee},oe=ke=>{if(V(),g.value=ke,f.value){ke.Checkpoints.forEach((Oe,We)=>{if(!f.value)return;const dt=new yp.Marker({element:pe(We+1,`${ke.TrackId}-${We}`)}).setLngLat(_p(Oe.coords.x,Oe.coords.y)).addTo(f.value);T.value.push(dt)});const Ee=ke.Checkpoints.map(Oe=>_p(Oe.coords.x,Oe.coords.y)),xe=`polyline-${ke.TrackId}`;k.value=xe,f.value.addSource(xe,{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:Ee}}}),f.value.addLayer({id:xe,type:"line",source:xe,layout:{},paint:{"line-color":i.themes.value.dark.colors.primary,"line-width":3}}),I.value=new yp.Popup({closeOnClick:!1}).setLngLat(_p(ke.Checkpoints[0].coords.x,ke.Checkpoints[0].coords.y)).setHTML(`
        <div class="popup-content">
          <h2>${ke.RaceName}</h2>
          <h3>${ne("creator")}: ${ke.CreatorName}</h3>
          <div class="popup-actions">
            <button 
              class="popup-button"
              ${ke.Waiting||ke.Started?"disabled":""}
              onclick="setWaypoint('${ke.TrackId}')"
            >
              ${ne("set_waypoint")}
            </button>
            <button 
              class="popup-button"
              ${ke.Waiting||ke.Started?"disabled":""}
              onclick="selectTrack('${ke.TrackId}')"
            >
              ${ne("setup_race")}
            </button>
          </div>
        </div>
      `).addTo(f.value)}},pe=(ke,Ee)=>{const xe=document.createElement("div");return xe.className="checkpoint-marker",xe.id=Ee,xe.innerText=ke.toString(),xe.onclick=()=>V(),xe},Se=ke=>ke.Started?i.themes.value.dark.colors.error:ke.Waiting?i.themes.value.dark.colors.success:i.themes.value.dark.colors.primary,me=()=>{m.value=void 0},be=ce(()=>{let ke=l.$state.tracks;return!ke||ke.length===0?[]:(l.$state.showOnlyCurated&&(ke=ke.filter(Ee=>Ee.Curated)),ke.filter(Ee=>{var xe,Oe,We,dt,je,tt;return((We=(Oe=(xe=Ee.Checkpoints)==null?void 0:xe[0])==null?void 0:Oe.coords)==null?void 0:We.x)&&((tt=(je=(dt=Ee.Checkpoints)==null?void 0:dt[0])==null?void 0:je.coords)==null?void 0:tt.y)}))}),he=()=>{if(u.value){let ke=new Ap.LngLat(-168,-57.8),Ee=new Ap.LngLat(0,85.8002),xe=new Ap.LngLatBounds(ke,Ee);f.value=new yp.Map({container:u.value,style:{version:8,sources:{raster:{type:"raster",tiles:[Qz],tileSize:256}},layers:[{id:"raster-layer",type:"raster",source:"raster",minzoom:2,maxzoom:5}]},center:O,zoom:eL,minZoom:3,maxZoom:5,bounds:xe}),f.value.on("click",Oe=>{if(!f.value)return;f.value.queryRenderedFeatures(Oe.point,{layers:["raster-layer"]}).length>0&&(V(),g.value=void 0),g.value=void 0}),f.value.on("load",()=>{D(),f.value&&f.value.resize()})}},Ce=async()=>{o.value=!0;const ke=await Ht.post("UiGetAvailableTracks");ke&&(l.$state.tracks=ke.data),o.value=!1,he()},ye=ke=>{const Ee=be.value.find(xe=>xe.TrackId===ke);m.value=Ee},Me=ke=>{const Ee=be.value.find(xe=>xe.TrackId===ke);Ht.post("UiSetWaypoint",JSON.stringify(Ee)),ca()};return Qn(()=>{Ce(),window.setWaypoint=ke=>{Me(ke)},window.selectTrack=ke=>{ye(ke)},he()}),(ke,Ee)=>(Fe(),Ot("div",Kz,[Xe("div",Yz,[E(Qi),E(aa,{color:"primary",modelValue:U(l).$state.showOnlyCurated,"onUpdate:modelValue":Ee[0]||(Ee[0]=xe=>U(l).$state.showOnlyCurated=xe),"hide-details":"",density:"compact",class:"mr-1",onClick:B},{label:K(()=>[Ne(ee(U(l).$state.showOnlyCurated?U(ne)("showing_curated"):U(ne)("showing_all")),1)]),_:1},8,["modelValue"])]),E(On,{border:"",class:"fill-height"},{default:K(()=>[E(qn,{class:"fill-height pa-0"},{default:K(()=>[Xe("div",Jz,[Xe("div",{ref_key:"mapContainer",ref:u,class:"map"},null,512)])]),_:1})]),_:1}),m.value?(Fe(),ft(HC,{key:0,open:!!m.value,track:m.value,onGoBack:Ee[1]||(Ee[1]=xe=>me())},null,8,["open","track"])):Mt("",!0)]))}});const nL=Vn({__name:"Head2HeadInviteMenu",setup(e){const i=ei(),l=Ke(!1),u=Ke(!1),f=async()=>{const m=await Ht.post("UiFetchH2HData");i.head2headData=m.data},g=()=>{l.value=!0,Ht.post("UiSetupHead2Head"),l.value=!1,f(),u.value=!1};return Qn(()=>{f()}),(m,o)=>(Fe(),ft($C,{modelValue:u.value,"onUpdate:modelValue":o[1]||(o[1]=T=>u.value=T),"close-on-content-click":!1,location:"start"},{activator:K(({props:T})=>[E(Nt,an({color:"primary"},T),{default:K(()=>[Ne(ee(U(ne)("h2h")),1)]),_:2},1040)]),default:K(()=>[E(On,{border:"",rounded:"xl",class:"invite-card mb-3"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("head2head_title")),1)]),_:1}),E(qn,null,{default:K(()=>[Ne(ee(U(ne)("head2head_subtitle")),1)]),_:1}),E(Zn,null,{default:K(()=>[E(Qi),E(Nt,{rounded:"xl",loading:l.value,onClick:o[0]||(o[0]=T=>u.value=!1),variant:"flat"},{default:K(()=>[Ne(ee(U(ne)("close")),1)]),_:1},8,["loading"]),E(Nt,{rounded:"xl",loading:l.value,onClick:g,variant:"flat",color:"primary"},{default:K(()=>[Ne(ee(U(ne)("invite_closest")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}});const dv=Symbol.for("vuetify:v-tabs"),iL=Ct({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...Ps(gC({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),fr=Wt()({name:"VTab",props:iL(),setup(e,i){let{slots:l,attrs:u}=i;const{textColorClasses:f,textColorStyles:g}=os(e,"sliderColor"),m=Ke(),o=Ke(),T=ce(()=>e.direction==="horizontal"),k=ce(()=>{var z,O;return((O=(z=m.value)==null?void 0:z.group)==null?void 0:O.isSelected.value)??!1});function I(z){var D,B;let{value:O}=z;if(O){const V=(B=(D=m.value)==null?void 0:D.$el.parentElement)==null?void 0:B.querySelector(".v-tab--selected .v-tab__slider"),Z=o.value;if(!V||!Z)return;const oe=getComputedStyle(V).color,pe=V.getBoundingClientRect(),Se=Z.getBoundingClientRect(),me=T.value?"x":"y",be=T.value?"X":"Y",he=T.value?"right":"bottom",Ce=T.value?"width":"height",ye=pe[me],Me=Se[me],ke=ye>Me?pe[he]-Se[he]:pe[me]-Se[me],Ee=Math.sign(ke)>0?T.value?"right":"bottom":Math.sign(ke)<0?T.value?"left":"top":"center",Oe=(Math.abs(ke)+(Math.sign(ke)<0?pe[Ce]:Se[Ce]))/Math.max(pe[Ce],Se[Ce])||0,We=pe[Ce]/Se[Ce]||0,dt=1.5;jl(Z,{backgroundColor:[oe,"currentcolor"],transform:[`translate${be}(${ke}px) scale${be}(${We})`,`translate${be}(${ke/dt}px) scale${be}(${(Oe-1)/dt+1})`,"none"],transformOrigin:Array(3).fill(Ee)},{duration:225,easing:mh})}}return hn(()=>{const z=Nt.filterProps(e);return E(Nt,an({symbol:dv,ref:m,class:["v-tab",e.class],style:e.style,tabindex:k.value?0:-1,role:"tab","aria-selected":String(k.value),active:!1},z,u,{block:e.fixed,maxWidth:e.fixed?300:void 0,"onGroup:selected":I}),{...l,default:()=>{var O;return E(un,null,[((O=l.default)==null?void 0:O.call(l))??e.text,!e.hideSlider&&E("div",{ref:o,class:["v-tab__slider",f.value],style:g.value},null)])}})}),fo({},m)}});const rL=e=>{const{touchstartX:i,touchendX:l,touchstartY:u,touchendY:f}=e,g=.5,m=16;e.offsetX=l-i,e.offsetY=f-u,Math.abs(e.offsetY)<g*Math.abs(e.offsetX)&&(e.left&&l<i-m&&e.left(e),e.right&&l>i+m&&e.right(e)),Math.abs(e.offsetX)<g*Math.abs(e.offsetY)&&(e.up&&f<u-m&&e.up(e),e.down&&f>u+m&&e.down(e))};function aL(e,i){var u;const l=e.changedTouches[0];i.touchstartX=l.clientX,i.touchstartY=l.clientY,(u=i.start)==null||u.call(i,{originalEvent:e,...i})}function sL(e,i){var u;const l=e.changedTouches[0];i.touchendX=l.clientX,i.touchendY=l.clientY,(u=i.end)==null||u.call(i,{originalEvent:e,...i}),rL(i)}function oL(e,i){var u;const l=e.changedTouches[0];i.touchmoveX=l.clientX,i.touchmoveY=l.clientY,(u=i.move)==null||u.call(i,{originalEvent:e,...i})}function lL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const i={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:e.left,right:e.right,up:e.up,down:e.down,start:e.start,move:e.move,end:e.end};return{touchstart:l=>aL(l,i),touchend:l=>sL(l,i),touchmove:l=>oL(l,i)}}function cL(e,i){var o;const l=i.value,u=l!=null&&l.parent?e.parentElement:e,f=(l==null?void 0:l.options)??{passive:!0},g=(o=i.instance)==null?void 0:o.$.uid;if(!u||!g)return;const m=lL(i.value);u._touchHandlers=u._touchHandlers??Object.create(null),u._touchHandlers[g]=m,Mw(m).forEach(T=>{u.addEventListener(T,m[T],f)})}function uL(e,i){var g,m;const l=(g=i.value)!=null&&g.parent?e.parentElement:e,u=(m=i.instance)==null?void 0:m.$.uid;if(!(l!=null&&l._touchHandlers)||!u)return;const f=l._touchHandlers[u];Mw(f).forEach(o=>{l.removeEventListener(o,f[o])}),delete l._touchHandlers[u]}const KC={mounted:cL,unmounted:uL},dL=KC,YC=Symbol.for("vuetify:v-window"),JC=Symbol.for("vuetify:v-window-group"),QC=Ct({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||e==="hover"},touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},...xn(),...Ti(),...Di()},"VWindow"),ro=Wt()({name:"VWindow",directives:{Touch:KC},props:QC(),emits:{"update:modelValue":e=>!0},setup(e,i){let{slots:l}=i;const{themeClasses:u}=Hi(e),{isRtl:f}=ja(),{t:g}=Dh(),m=Sm(e,JC),o=Ke(),T=ce(()=>f.value?!e.reverse:e.reverse),k=ln(!1),I=ce(()=>{const me=e.direction==="vertical"?"y":"x",he=(T.value?!k.value:k.value)?"-reverse":"";return`v-window-${me}${he}-transition`}),z=ln(0),O=Ke(void 0),D=ce(()=>m.items.value.findIndex(me=>m.selected.value.includes(me.id)));en(D,(me,be)=>{const he=m.items.value.length,Ce=he-1;he<=2?k.value=me<be:me===Ce&&be===0?k.value=!0:me===0&&be===Ce?k.value=!1:k.value=me<be}),Mr(YC,{transition:I,isReversed:k,transitionCount:z,transitionHeight:O,rootRef:o});const B=ce(()=>e.continuous||D.value!==0),V=ce(()=>e.continuous||D.value!==m.items.value.length-1);function Z(){B.value&&m.prev()}function oe(){V.value&&m.next()}const pe=ce(()=>{const me=[],be={icon:f.value?e.nextIcon:e.prevIcon,class:`v-window__${T.value?"right":"left"}`,onClick:m.prev,"aria-label":g("$vuetify.carousel.prev")};me.push(B.value?l.prev?l.prev({props:be}):E(Nt,be,null):E("div",null,null));const he={icon:f.value?e.prevIcon:e.nextIcon,class:`v-window__${T.value?"left":"right"}`,onClick:m.next,"aria-label":g("$vuetify.carousel.next")};return me.push(V.value?l.next?l.next({props:he}):E(Nt,he,null):E("div",null,null)),me}),Se=ce(()=>e.touch===!1?e.touch:{...{left:()=>{T.value?Z():oe()},right:()=>{T.value?oe():Z()},start:be=>{let{originalEvent:he}=be;he.stopPropagation()}},...e.touch===!0?{}:e.touch});return hn(()=>Pr(E(e.tag,{ref:o,class:["v-window",{"v-window--show-arrows-on-hover":e.showArrows==="hover"},u.value,e.class],style:e.style},{default:()=>{var me,be;return[E("div",{class:"v-window__container",style:{height:O.value}},[(me=l.default)==null?void 0:me.call(l,{group:m}),e.showArrows!==!1&&E("div",{class:"v-window__controls"},[pe.value])]),(be=l.additional)==null?void 0:be.call(l,{group:m})]}}),[[oo("touch"),Se.value]])),{group:m}}}),hL=Ct({...Ps(QC(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),e2=Wt()({name:"VTabsWindow",props:hL(),emits:{"update:modelValue":e=>!0},setup(e,i){let{slots:l}=i;const u=ri(dv,null),f=ai(e,"modelValue"),g=ce({get(){var m;return f.value!=null||!u?f.value:(m=u.items.value.find(o=>u.selected.value.includes(o.id)))==null?void 0:m.value},set(m){f.value=m}});return hn(()=>{const m=ro.filterProps(e);return E(ro,an({_as:"VTabsWindow"},m,{modelValue:g.value,"onUpdate:modelValue":o=>g.value=o,class:["v-tabs-window",e.class],style:e.style,mandatory:!1,touch:!1}),l)}),{}}}),t2=Ct({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...xn(),...Uy(),...EC()},"VWindowItem"),pr=Wt()({name:"VWindowItem",directives:{Touch:dL},props:t2(),emits:{"group:selected":e=>!0},setup(e,i){let{slots:l}=i;const u=ri(YC),f=Gy(e,JC),{isBooted:g}=Wy();if(!u||!f)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const m=ln(!1),o=ce(()=>g.value&&(u.isReversed.value?e.reverseTransition!==!1:e.transition!==!1));function T(){!m.value||!u||(m.value=!1,u.transitionCount.value>0&&(u.transitionCount.value-=1,u.transitionCount.value===0&&(u.transitionHeight.value=void 0)))}function k(){var B;m.value||!u||(m.value=!0,u.transitionCount.value===0&&(u.transitionHeight.value=mn((B=u.rootRef.value)==null?void 0:B.clientHeight)),u.transitionCount.value+=1)}function I(){T()}function z(B){m.value&&Fi(()=>{!o.value||!m.value||!u||(u.transitionHeight.value=mn(B.clientHeight))})}const O=ce(()=>{const B=u.isReversed.value?e.reverseTransition:e.transition;return o.value?{name:typeof B!="string"?u.transition.value:B,onBeforeEnter:k,onAfterEnter:T,onEnterCancelled:I,onBeforeLeave:k,onAfterLeave:T,onLeaveCancelled:I,onEnter:z}:!1}),{hasContent:D}=AC(e,f.isSelected);return hn(()=>E(to,{transition:O.value,disabled:!g.value},{default:()=>{var B;return[Pr(E("div",{class:["v-window-item",f.selectedClass.value,e.class],style:e.style},[D.value&&((B=l.default)==null?void 0:B.call(l))]),[[Ql,f.isSelected.value]])]}})),{groupItem:f}}}),fL=Ct({...t2()},"VTabsWindowItem"),Rp=Wt()({name:"VTabsWindowItem",props:fL(),setup(e,i){let{slots:l}=i;return hn(()=>{const u=pr.filterProps(e);return E(pr,an({_as:"VTabsWindowItem"},u,{class:["v-tabs-window-item",e.class],style:e.style}),l)}),{}}});function pL(e){return e?e.map(i=>My(i)?i:{text:i,value:i}):[]}const mL=Ct({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...Hy({mandatory:"force",selectedClass:"v-tab-item--selected"}),...Pa(),...Ti()},"VTabs"),wu=Wt()({name:"VTabs",props:mL(),emits:{"update:modelValue":e=>!0},setup(e,i){let{attrs:l,slots:u}=i;const f=ai(e,"modelValue"),g=ce(()=>pL(e.items)),{densityClasses:m}=$a(e),{backgroundColorClasses:o,backgroundColorStyles:T}=Fa(rn(e,"bgColor")),{scopeId:k}=nc();return Qo({VTab:{color:rn(e,"color"),direction:rn(e,"direction"),stacked:rn(e,"stacked"),fixed:rn(e,"fixedTabs"),sliderColor:rn(e,"sliderColor"),hideSlider:rn(e,"hideSlider")}}),hn(()=>{const I=Wp.filterProps(e),z=!!(u.window||e.items.length>0);return E(un,null,[E(Wp,an(I,{modelValue:f.value,"onUpdate:modelValue":O=>f.value=O,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--stacked":e.stacked},m.value,o.value,e.class],style:[{"--v-tabs-height":mn(e.height)},T.value,e.style],role:"tablist",symbol:dv},k,l),{default:()=>{var O;return[((O=u.default)==null?void 0:O.call(u))??g.value.map(D=>{var B;return((B=u.tab)==null?void 0:B.call(u,{item:D}))??E(fr,an(D,{key:D.text,value:D.value}),{default:u[`tab.${D.value}`]?()=>{var V;return(V=u[`tab.${D.value}`])==null?void 0:V.call(u,{item:D})}:void 0})})]}}),z&&E(e2,an({modelValue:f.value,"onUpdate:modelValue":O=>f.value=O,key:"tabs-window"},k),{default:()=>{var O;return[g.value.map(D=>{var B;return((B=u.item)==null?void 0:B.call(u,{item:D}))??E(Rp,{value:D.value},{default:()=>{var V;return(V=u[`item.${D.value}`])==null?void 0:V.call(u,{item:D})}})}),(O=u.window)==null?void 0:O.call(u)]}})])}),{}}}),gL={id:"RacingPage",class:"pagecontent"},_L={class:"tab-bar"},yL={class:"current-race-container"},vL={key:0,id:"current-race-selection"},bL={class:"mb-1",id:"subheader"},xL={class:"subheader mt-2"},wL={key:0,class:"loading-container",id:"available-races-loader"},SL={key:1,class:"available-races"},CL={class:"subheader"},TL={class:"header-text"},PL={key:0,class:"loading-container",id:"available-races-loader"},kL={key:1,class:"page-container available-tracks"},IL=Vn({__name:"RacingPage",setup(e){const i=ei(),l=Ke(i.currentPage),u=Ke(!1),f=Ke([]),g=Ke(!1),m=Ke(""),o=Ke(void 0),T=Ke(void 0),k=ce(()=>{let me=i.tracks;return i.showOnlyCurated&&(me=me==null?void 0:me.filter(be=>!!be.Curated)),me&&m.value!==""&&(me=me.filter(be=>be.RaceName.toLowerCase().includes(m.value.toLowerCase())||be.TrackId.toLowerCase().includes(m.value.toLowerCase())||be.CreatorName.toLocaleLowerCase().includes(m.value.toLowerCase()))),me.sort((be,he)=>be.RaceName.toLowerCase()>he.RaceName.toLowerCase()?1:-1)}),I=()=>{l.value="setup",o.value=void 0},z=ce(()=>f.value.filter(me=>!me.Started&&!me.Hidden)),O=async()=>{u.value=!0;const me=await Ht.post("UiGetListedRaces");f.value=me.data,u.value=!1},D=me=>{g.value=!0,o.value=me},B=async()=>{u.value=!0;const me=await Ht.post("UiGetAvailableTracks");i.$state.tracks=me.data,u.value=!1},V=async()=>{const me=await Ht.post("UiFetchCurrentRace");me.data.raceId?T.value=me.data:T.value=void 0},Z=async()=>{var me;(me=T==null?void 0:T.value)!=null&&me.raceId&&(await Ht.post("UiLeaveCurrentRace",JSON.stringify(T.value.raceId)),T.value=void 0)},oe=async()=>{var me;(me=T==null?void 0:T.value)!=null&&me.raceId&&(await Ht.post("UiStartCurrentRace",JSON.stringify(T.value.raceId)),T.value=void 0,ca())},pe=()=>{l.value==="current"?(O(),V()):l.value==="setup"&&B()},Se=()=>{V(),O()};return Qn(()=>{pe(),o.value=void 0}),(me,be)=>(Fe(),Ot(un,null,[Xe("div",gL,[Xe("div",_L,[l.value!=="setup2"?(Fe(),ft(wu,{key:0,color:"primary",modelValue:l.value,"onUpdate:modelValue":[be[0]||(be[0]=he=>l.value=he),be[1]||(be[1]=he=>pe())]},{default:K(()=>[E(fr,{value:"current"},{default:K(()=>[Ne(ee(U(ne)("available_races")),1)]),_:1}),U(i).baseData.data.hideMap?Mt("",!0):(Fe(),ft(fr,{key:0,value:"map"},{default:K(()=>[Ne(ee(U(ne)("racing_map")),1)]),_:1})),E(fr,{value:"bounties"},{default:K(()=>[Ne(ee(U(ne)("bounties")),1)]),_:1}),U(i).baseData.data.auth.setup?(Fe(),ft(fr,{key:1,value:"setup"},{default:K(()=>[Ne(ee(U(ne)("setup")),1)]),_:1})):Mt("",!0)]),_:1},8,["modelValue"])):Mt("",!0),U(i).baseData.data.showH2H?(Fe(),ft(nL,{key:1})):Mt("",!0)]),E(ro,{modelValue:l.value,"onUpdate:modelValue":be[7]||(be[7]=he=>l.value=he),class:"page-container"},{default:K(()=>[E(pr,{value:"current",class:"tabcontent"},{default:K(()=>[Xe("div",yL,[T.value?(Fe(),Ot("div",vL,[Xe("div",bL,[Xe("h3",null,ee(U(ne)("active")),1)]),E(JD,{race:T.value,onLeave:be[2]||(be[2]=he=>Z()),onStart:be[3]||(be[3]=he=>oe()),onCancel:be[4]||(be[4]=he=>Se())},null,8,["race"])])):Mt("",!0)]),Xe("div",xL,[Xe("h3",null,ee(U(ne)("available_races")),1)]),u.value?(Fe(),Ot("div",wL,be[9]||(be[9]=[Xe("span",{class:"loader"},null,-1)]))):(Fe(),Ot("div",SL,[(Fe(!0),Ot(un,null,la(z.value,he=>(Fe(),ft(WD,{key:he,race:he},null,8,["race"]))),128))])),f.value.length===0?(Fe(),ft(Tr,{key:2,title:U(ne)("no_races")},null,8,["title"])):Mt("",!0)]),_:1}),E(pr,{value:"map",class:"tabcontent"},{default:K(()=>[E(tL)]),_:1}),E(pr,{value:"bounties",class:"tabcontent"},{default:K(()=>[E(Gz)]),_:1}),E(pr,{value:"setup",class:"tabcontent"},{default:K(()=>[Xe("div",CL,[Xe("h3",TL,ee(U(ne)("pick_track")),1),E(aa,{color:"primary",modelValue:U(i).showOnlyCurated,"onUpdate:modelValue":be[5]||(be[5]=he=>U(i).showOnlyCurated=he),"hide-details":"",density:"compact",class:"mr-1"},{label:K(()=>[Ne(ee(U(i).showOnlyCurated?U(ne)("showing_curated"):U(ne)("showing_all")),1)]),_:1},8,["modelValue"]),E(hr,{color:"primary",class:"text-field",hideDetails:"",placeholder:U(ne)("search_dot"),density:"compact",modelValue:m.value,"onUpdate:modelValue":be[6]||(be[6]=he=>m.value=he)},null,8,["placeholder","modelValue"])]),u.value?(Fe(),Ot("div",PL,be[10]||(be[10]=[Xe("span",{class:"loader"},null,-1)]))):(Fe(),Ot("div",kL,[(Fe(!0),Ot(un,null,la(k.value,he=>(Fe(),ft(YD,{key:he.TrackId,track:he,onSelect:Ce=>D(Ce)},null,8,["track","onSelect"]))),128))]))]),_:1})]),_:1},8,["modelValue"])]),o.value?(Fe(),ft(HC,{key:0,open:!!o.value,track:o.value,onGoBack:be[8]||(be[8]=he=>I())},null,8,["open","track"])):Mt("",!0)],64))}});const ML=Pi(IL,[["__scopeId","data-v-9e5947c4"]]),EL={class:"results-container page-container"},AL={class:"inline standardGap header"},RL={key:0},DL={key:1},zL={class:"text-left"},LL={class:"text-left"},BL={key:0,class:"text-left"},FL={class:"text-left"},OL={class:"text-left"},VL={key:1,class:"text-left"},NL={key:0},$L={key:1},jL={key:1},UL=Vn({__name:"RaceResults",props:{allResults:{}},setup(e){const i=e,l=ce(()=>{const g=[];for(const m in i.allResults){const T=i.allResults[m],k=T.Data.RaceData.RaceName;if(T.Data.FinishTime){const I=new Date(T.Data.FinishTime*1e3),z=I.getHours().toString().padStart(2,"0"),O=I.getMinutes().toString().padStart(2,"0"),D=`${z}:${O}`;T.title=`${k} (${D})`,g.push(T)}}return g}),u=Ke(void 0),f=ce(()=>u.value?u.value.Result.sort((m,o)=>m.TotalTime<o.TotalTime?-1:1):void 0);return(g,m)=>(Fe(),Ot("div",EL,[Xe("div",AL,[E(ts,{color:"primary",density:"compact","hide-details":"",items:l.value,"return-object":"","item-title":"title",modelValue:u.value,"onUpdate:modelValue":m[0]||(m[0]=o=>u.value=o),placeholder:U(ne)("select_track"),class:"w-50"},null,8,["items","modelValue","placeholder"])]),u.value?(Fe(),Ot("div",DL,[u.value.Result.length>0?(Fe(),ft(Nh,{key:0},{default:K(()=>[Xe("thead",null,[Xe("tr",null,[m[1]||(m[1]=Xe("th",{class:"text-left"},null,-1)),Xe("th",zL,ee(U(ne)("rank")),1),Xe("th",LL,ee(U(ne)("time")),1),u.value.Data.Laps>0?(Fe(),Ot("th",BL,ee(U(ne)("best_lap")),1)):Mt("",!0),Xe("th",FL,ee(U(ne)("vehicle")),1),Xe("th",OL,ee(U(ne)("class")),1),u.value.Data.RaceData.Ranked?(Fe(),Ot("th",VL,ee(U(ne)("rank_change")),1)):Mt("",!0)])]),Xe("tbody",null,[(Fe(!0),Ot(un,null,la(f.value,(o,T)=>(Fe(),Ot("tr",{key:o.RacerName},[Xe("td",null,ee(T+1)+". "+ee(o.RacerName)+" "+ee(o.RacingCrew?"["+o.RacingCrew+"]":""),1),Xe("td",null,ee(o.Ranking),1),Xe("td",null,ee(U(no)(o.TotalTime)),1),u.value.Data.Laps>0?(Fe(),Ot("td",NL,ee(U(no)(o.BestLap)),1)):Mt("",!0),Xe("td",null,ee(o.VehicleModel),1),Xe("td",null,ee(o.CarClass),1),u.value.Data.RaceData.Ranked?(Fe(),Ot("td",$L,ee(o.TotalChange),1)):Mt("",!0)]))),128))])]),_:1})):(Fe(),Ot("div",jL,[E(Tr,{title:U(ne)("no_data")},null,8,["title"])]))])):(Fe(),Ot("div",RL,[E(Tr,{title:U(ne)("select_track_to_view")},null,8,["title"])]))]))}});const GL=Pi(UL,[["__scopeId","data-v-9c8dedb1"]]),HL={class:"results-container page-container"},ZL={class:"inline standardGap header"},qL={key:0},WL={key:1,class:"scrollable"},XL={class:"text-left"},KL={class:"text-left"},YL={class:"text-left"},JL={class:"text-left"},QL={key:1},eB=Vn({__name:"RaceRecords",props:{allRecords:{}},setup(e){const i=Ke(void 0),l=Ke(!1),u=ce(()=>{var g;return(g=i.value)==null?void 0:g.Records.filter(m=>m.Reversed===void 0?!l.value:m.Reversed===l.value)}),f=ce(()=>u.value?u.value.sort((m,o)=>m.Time<o.Time?-1:1):void 0);return(g,m)=>(Fe(),Ot("div",HL,[Xe("div",ZL,[E(ts,{color:"primary",density:"compact","hide-details":"",items:Object.values(g.allRecords),"return-object":"","item-title":"RaceName",modelValue:i.value,"onUpdate:modelValue":m[0]||(m[0]=o=>i.value=o),placeholder:U(ne)("select_track"),class:"w-50"},null,8,["items","modelValue","placeholder"]),E(aa,{color:"primary",density:"compact",label:U(ne)("reversed"),modelValue:l.value,"onUpdate:modelValue":m[1]||(m[1]=o=>l.value=o),"hide-details":""},null,8,["label","modelValue"])]),m[3]||(m[3]=Xe("div",{class:"loading-container",id:"results-items-loader"},[Xe("span",{class:"loader"})],-1)),i.value?(Fe(),Ot("div",WL,[f.value&&f.value.length>0?(Fe(),ft(Nh,{key:0},{default:K(()=>[Xe("thead",null,[Xe("tr",null,[m[2]||(m[2]=Xe("th",{class:"text-left"},null,-1)),Xe("th",XL,ee(U(ne)("time")),1),Xe("th",KL,ee(U(ne)("vehicle")),1),Xe("th",YL,ee(U(ne)("class")),1),Xe("th",JL,ee(U(ne)("type")),1)])]),Xe("tbody",null,[(Fe(!0),Ot(un,null,la(f.value,(o,T)=>(Fe(),Ot("tr",{key:`${o.Holder}-${o.Class}`},[Xe("td",null,ee(T+1)+". "+ee(o.Holder),1),Xe("td",null,ee(U(no)(o.Time)),1),Xe("td",null,ee(o.Vehicle),1),Xe("td",null,ee(o.Class),1),Xe("td",null,ee(o.RaceType),1)]))),128))])]),_:1})):(Fe(),Ot("div",QL,[E(Tr,{title:U(ne)("no_data")},null,8,["title"])]))])):(Fe(),Ot("div",qL,[E(Tr,{title:U(ne)("select_track_to_view")},null,8,["title"])]))]))}});const tB=Pi(eB,[["__scopeId","data-v-eb68fd06"]]),nB={class:"results-container page-container"},iB={class:"text-left"},rB={class:"text-left"},aB={class:"text-left"},sB={class:"text-left"},oB={key:1},lB=Vn({__name:"CrewTable",setup(e){const i=Ke(void 0),l=async()=>{const u=await Ht.post("UiGetAllCrews");if(u.data){let f=u.data;i.value=Object.values(f).sort((g,m)=>m.rank-g.rank)}};return Qn(()=>{l()}),(u,f)=>(Fe(),Ot("div",nB,[i.value&&i.value.length>0?(Fe(),ft(Nh,{key:0,rounded:"lg",class:"scrollable"},{default:K(()=>[Xe("thead",null,[Xe("tr",null,[f[0]||(f[0]=Xe("th",{class:"text-left"},null,-1)),Xe("th",iB,ee(U(ne)("rank")),1),Xe("th",rB,ee(U(ne)("wins")),1),Xe("th",aB,ee(U(ne)("races")),1),Xe("th",sB,ee(U(ne)("founder")),1)])]),Xe("tbody",null,[(Fe(!0),Ot(un,null,la(i.value,(g,m)=>(Fe(),Ot("tr",{key:g.crewName},[Xe("td",null,ee(m+1)+". "+ee(g.crewName),1),Xe("td",null,ee(g.rank),1),Xe("td",null,ee(g.wins),1),Xe("td",null,ee(g.races),1),Xe("td",null,ee(g.founderName),1)]))),128))])]),_:1})):(Fe(),Ot("div",oB,[E(Tr,{title:U(ne)("no_data")},null,8,["title"])]))]))}});const cB=Pi(lB,[["__scopeId","data-v-e29a369e"]]),uB={class:"results-container page-container"},dB={class:"text-left"},hB={class:"text-left"},fB={class:"text-left"},pB={key:1},mB=Vn({__name:"RacersTable",setup(e){const i=Ke(void 0),l=async()=>{const u=await Ht.post("UiGetAllRacers");if(u.data){let f=u.data;f.sort((g,m)=>m.ranking-g.ranking),i.value=f}};return Qn(()=>{l()}),(u,f)=>(Fe(),Ot("div",uB,[i.value&&i.value.length>0?(Fe(),ft(Nh,{key:0,class:"scrollable"},{default:K(()=>[Xe("thead",null,[Xe("tr",null,[f[0]||(f[0]=Xe("th",{class:"text-left"},null,-1)),Xe("th",dB,ee(U(ne)("rank")),1),Xe("th",hB,ee(U(ne)("wins")),1),Xe("th",fB,ee(U(ne)("races")),1)])]),Xe("tbody",null,[(Fe(!0),Ot(un,null,la(i.value,(g,m)=>(Fe(),Ot("tr",{key:g.racername},[Xe("td",null,ee(m+1)+". "+ee(g.racername),1),Xe("td",null,ee(g.ranking),1),Xe("td",null,ee(g.wins),1),Xe("td",null,ee(g.races),1)]))),128))])]),_:1})):(Fe(),Ot("div",pB,[E(Tr,{title:U(ne)("no_data")},null,8,["title"])]))]))}});const gB=Pi(mB,[["__scopeId","data-v-f232719f"]]),_B={id:"ResultsPage",class:"pagecontent"},yB=Vn({__name:"ResultsPage",setup(e){const i=Ke(void 0),l=Ke(void 0),u=ei(),f=Ke(u.currentTab),g=async()=>{const o=await Ht.post("UiGetRacingResults");o.data&&(i.value=o.data)},m=async()=>{const o=await Ht.post("UiGetRaces");o.data&&(l.value=o.data)};return Qn(()=>{g(),m()}),(o,T)=>(Fe(),Ot("div",_B,[E(wu,{color:"primary",modelValue:f.value,"onUpdate:modelValue":T[0]||(T[0]=k=>f.value=k)},{default:K(()=>[E(fr,{value:"results"},{default:K(()=>[Ne(ee(U(ne)("race_results")),1)]),_:1}),E(fr,{value:"crewRank"},{default:K(()=>[Ne(ee(U(ne)("crew_rankings")),1)]),_:1}),E(fr,{value:"racerRank"},{default:K(()=>[Ne(ee(U(ne)("racer_rankings")),1)]),_:1}),E(fr,{value:"records"},{default:K(()=>[Ne(ee(U(ne)("track_records")),1)]),_:1})]),_:1},8,["modelValue"]),E(ro,{modelValue:f.value,"onUpdate:modelValue":T[1]||(T[1]=k=>f.value=k)},{default:K(()=>[E(pr,{value:"results",class:"tabcontent"},{default:K(()=>[i.value?(Fe(),ft(GL,{key:0,allResults:i.value},null,8,["allResults"])):(Fe(),ft(Tr,{key:1,title:U(ne)("no_data")},null,8,["title"]))]),_:1}),E(pr,{value:"crewRank",class:"tabcontent"},{default:K(()=>[E(cB)]),_:1}),E(pr,{value:"racerRank",class:"tabcontent"},{default:K(()=>[E(gB)]),_:1}),E(pr,{value:"records",class:"tabcontent"},{default:K(()=>[l.value?(Fe(),ft(tB,{key:0,allRecords:l.value},null,8,["allRecords"])):(Fe(),ft(Tr,{key:1,title:U(ne)("no_data")},null,8,["title"]))]),_:1})]),_:1},8,["modelValue"])]))}});const vB=vm("v-alert-title"),bB=["success","info","warning","error"],xB=Ct({border:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["top","end","bottom","start"].includes(e)},borderColor:String,closable:Boolean,closeIcon:{type:Gn,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:e=>bB.includes(e)},...xn(),...Pa(),...Va(),...uo(),...vu(),...Bh(),...ua(),...Ti(),...Di(),...Is({variant:"flat"})},"VAlert"),hu=Wt()({name:"VAlert",props:xB(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0},setup(e,i){let{emit:l,slots:u}=i;const f=ai(e,"modelValue"),g=ce(()=>{if(e.icon!==!1)return e.type?e.icon??`$${e.type}`:e.icon}),m=ce(()=>({color:e.color??e.type,variant:e.variant})),{themeClasses:o}=Hi(e),{colorClasses:T,colorStyles:k,variantClasses:I}=tc(m),{densityClasses:z}=$a(e),{dimensionStyles:O}=Na(e),{elevationClasses:D}=ho(e),{locationStyles:B}=Lh(e),{positionClasses:V}=Fh(e),{roundedClasses:Z}=da(e),{textColorClasses:oe,textColorStyles:pe}=os(rn(e,"borderColor")),{t:Se}=Dh(),me=ce(()=>({"aria-label":Se(e.closeLabel),onClick(be){f.value=!1,l("click:close",be)}}));return()=>{const be=!!(u.prepend||g.value),he=!!(u.title||e.title),Ce=!!(u.close||e.closable);return f.value&&E(e.tag,{class:["v-alert",e.border&&{"v-alert--border":!!e.border,[`v-alert--border-${e.border===!0?"start":e.border}`]:!0},{"v-alert--prominent":e.prominent},o.value,T.value,z.value,D.value,V.value,Z.value,I.value,e.class],style:[k.value,O.value,B.value,e.style],role:"alert"},{default:()=>{var ye,Me;return[ec(!1,"v-alert"),e.border&&E("div",{key:"border",class:["v-alert__border",oe.value],style:pe.value},null),be&&E("div",{key:"prepend",class:"v-alert__prepend"},[u.prepend?E(Bi,{key:"prepend-defaults",disabled:!g.value,defaults:{VIcon:{density:e.density,icon:g.value,size:e.prominent?44:28}}},u.prepend):E(ui,{key:"prepend-icon",density:e.density,icon:g.value,size:e.prominent?44:28},null)]),E("div",{class:"v-alert__content"},[he&&E(vB,{key:"title"},{default:()=>{var ke;return[((ke=u.title)==null?void 0:ke.call(u))??e.title]}}),((ye=u.text)==null?void 0:ye.call(u))??e.text,(Me=u.default)==null?void 0:Me.call(u)]),u.append&&E("div",{key:"append",class:"v-alert__append"},[u.append()]),Ce&&E("div",{key:"close",class:"v-alert__close"},[u.close?E(Bi,{key:"close-defaults",defaults:{VBtn:{icon:e.closeIcon,size:"x-small",variant:"text"}}},{default:()=>{var ke;return[(ke=u.close)==null?void 0:ke.call(u,{props:me.value})]}}):E(Nt,an({key:"close-btn",icon:e.closeIcon,size:"x-small",variant:"text"},me.value),null)])]}})}}});const wB=Ct({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...Fm(),...cv()},"VTextarea"),SB=Wt()({name:"VTextarea",directives:{Intersect:Vy},inheritAttrs:!1,props:wB(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,i){let{attrs:l,emit:u,slots:f}=i;const g=ai(e,"modelValue"),{isFocused:m,focus:o,blur:T}=Bm(e),k=ce(()=>typeof e.counterValue=="function"?e.counterValue(g.value):(g.value||"").toString().length),I=ce(()=>{if(l.maxlength)return l.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function z(Ee,xe){var Oe,We;!e.autofocus||!Ee||(We=(Oe=xe[0].target)==null?void 0:Oe.focus)==null||We.call(Oe)}const O=Ke(),D=Ke(),B=ln(""),V=Ke(),Z=ce(()=>e.persistentPlaceholder||m.value||e.active);function oe(){var Ee;V.value!==document.activeElement&&((Ee=V.value)==null||Ee.focus()),m.value||o()}function pe(Ee){oe(),u("click:control",Ee)}function Se(Ee){u("mousedown:control",Ee)}function me(Ee){Ee.stopPropagation(),oe(),Fi(()=>{g.value="",zw(e["onClick:clear"],Ee)})}function be(Ee){var Oe;const xe=Ee.target;if(g.value=xe.value,(Oe=e.modelModifiers)!=null&&Oe.trim){const We=[xe.selectionStart,xe.selectionEnd];Fi(()=>{xe.selectionStart=We[0],xe.selectionEnd=We[1]})}}const he=Ke(),Ce=Ke(+e.rows),ye=ce(()=>["plain","underlined"].includes(e.variant));Sa(()=>{e.autoGrow||(Ce.value=+e.rows)});function Me(){e.autoGrow&&Fi(()=>{if(!he.value||!D.value)return;const Ee=getComputedStyle(he.value),xe=getComputedStyle(D.value.$el),Oe=parseFloat(Ee.getPropertyValue("--v-field-padding-top"))+parseFloat(Ee.getPropertyValue("--v-input-padding-top"))+parseFloat(Ee.getPropertyValue("--v-field-padding-bottom")),We=he.value.scrollHeight,dt=parseFloat(Ee.lineHeight),je=Math.max(parseFloat(e.rows)*dt+Oe,parseFloat(xe.getPropertyValue("--v-input-control-height"))),tt=parseFloat(e.maxRows)*dt+Oe||1/0,Et=Cs(We??0,je,tt);Ce.value=Math.floor((Et-Oe)/dt),B.value=mn(Et)})}Qn(Me),en(g,Me),en(()=>e.rows,Me),en(()=>e.maxRows,Me),en(()=>e.density,Me);let ke;return en(he,Ee=>{Ee?(ke=new ResizeObserver(Me),ke.observe(he.value)):ke==null||ke.disconnect()}),Ir(()=>{ke==null||ke.disconnect()}),hn(()=>{const Ee=!!(f.counter||e.counter||e.counterValue),xe=!!(Ee||f.details),[Oe,We]=ym(l),{modelValue:dt,...je}=gu.filterProps(e),tt=UC(e);return E(gu,an({ref:O,modelValue:g.value,"onUpdate:modelValue":Et=>g.value=Et,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":ye.value},e.class],style:e.style},Oe,je,{centerAffix:Ce.value===1&&!ye.value,focused:m.value}),{...f,default:Et=>{let{id:_t,isDisabled:Qe,isDirty:ct,isReadonly:zt,isValid:Jt}=Et;return E(uv,an({ref:D,style:{"--v-textarea-control-height":B.value},onClick:pe,onMousedown:Se,"onClick:clear":me,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},tt,{id:_t.value,active:Z.value||ct.value,centerAffix:Ce.value===1&&!ye.value,dirty:ct.value||e.dirty,disabled:Qe.value,focused:m.value,error:Jt.value===!1}),{...f,default:Lt=>{let{props:{class:Yt,...qt}}=Lt;return E(un,null,[e.prefix&&E("span",{class:"v-text-field__prefix"},[e.prefix]),Pr(E("textarea",an({ref:V,class:Yt,value:g.value,onInput:be,autofocus:e.autofocus,readonly:zt.value,disabled:Qe.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:oe,onBlur:T},qt,We),null),[[oo("intersect"),{handler:z},null,{once:!0}]]),e.autoGrow&&Pr(E("textarea",{class:[Yt,"v-textarea__sizer"],id:`${qt.id}-sizer`,"onUpdate:modelValue":_n=>g.value=_n,ref:he,readonly:!0,"aria-hidden":"true"},null),[[Kk,g.value]]),e.suffix&&E("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:xe?Et=>{var _t;return E(un,null,[(_t=f.details)==null?void 0:_t.call(f,Et),Ee&&E(un,null,[E("span",null,null),E(jC,{active:e.persistentCounter||m.value,value:k.value,max:I.value,disabled:e.disabled},f.counter)])])}:void 0})}),fo({},O,D,V)}}),CB={class:"d-inline-flex ga-1 align-xl-center"},TB=Vn({__name:"MyTrackCard",props:{track:{}},emits:["update"],setup(e,{emit:i}){const l=[{value:"any",label:ne("any")},{value:"circuit_only",label:ne("circuit_only")},{value:"sprint_only",label:ne("sprint_only")}],u=ei(),f=e,g=i,m=Ke(!1),o=Ke(!1),T=Ke(!1),k=Ke(!1),I=Ke(!1),z=Ke(!1),O=Ke(!1),D=Ke(void 0),B=Ke(!1),V=dt=>{D.value=dt,O.value=!0},Z=()=>{D.value=void 0,O.value=!1},oe=async()=>{B.value=!0,D.value&&await Ht.post("UiRemoveRecord",JSON.stringify({trackId:f.track.TrackId,record:D.value}))&&(g("update"),Z(),B.value=!1)},pe=Ke({description:void 0,raceType:void 0}),Se=Ke(!1),me=Ke(void 0),be=()=>{const dt=document.createElement("textarea");dt.value=JSON.stringify(f.track.Checkpoints),document.body.appendChild(dt),dt.select(),document.execCommand("copy"),document.body.removeChild(dt)},he=()=>{Ht.post("UiClearLeaderboard",JSON.stringify({RaceName:f.track.RaceName,TrackId:f.track.TrackId})),o.value=!1},Ce=()=>{Ht.post("UiEditTrack",JSON.stringify({RaceName:f.track.RaceName,TrackId:f.track.TrackId})),T.value=!1,ca()},ye=async()=>{const dt=await Ht.post("UiGetAccess",JSON.stringify({RaceName:f.track.RaceName,TrackId:f.track.TrackId}));me.value=dt.data,k.value=!0},Me=async()=>{Object.keys(pe.value).forEach(dt=>{pe.value[dt]=f.track.Metadata[dt]||void 0}),I.value=!0},ke=()=>{Ht.post("UiEditAccess",JSON.stringify({RaceName:f.track.RaceName,TrackId:f.track.TrackId,NewAccess:me.value})),k.value=!1},Ee=async()=>{pe.value.raceType==="any"&&(pe.value.raceType=void 0),await Ht.post("UiConfirmSettings",JSON.stringify({TrackId:f.track.TrackId,Metadata:pe.value})),I.value=!1,g("update")},xe=()=>{Ht.post("UiDeleteTrack",JSON.stringify({RaceName:f.track.RaceName,TrackId:f.track.TrackId})),Se.value=!1,setTimeout(()=>{g("update")},1500)},Oe=async dt=>{(await Ht.post("UiSetCurated",JSON.stringify({curated:dt,trackId:f.track.TrackId}))).data&&(f.track.Curated=dt,m.value=!1)},We=async()=>{(await Ht.post("UiShowTrack",JSON.stringify(f.track.TrackId))).data&&ca()};return(dt,je)=>(Fe(),Ot(un,null,[E(On,{border:"",class:"big-card",rounded:"xl"},{default:K(()=>[E($n,{class:"title"},{default:K(()=>[Xe("span",CB,ee(dt.track.RaceName),1),Xe("div",null,[E(Nt,{rounded:"xl",variant:"text",onClick:je[0]||(je[0]=tt=>We())},{default:K(()=>[Ne(ee(U(ne)("show_track")),1)]),_:1}),E(Nt,{rounded:"xl",small:"",variant:"text",onClick:je[1]||(je[1]=tt=>be())},{default:K(()=>[Ne(ee(U(ne)("copy_checkpoints")),1)]),_:1})])]),_:1}),E(qn,{class:"text"},{default:K(()=>{var tt;return[dt.track.Curated?(Fe(),ft(on,{key:0,color:"green","prepend-icon":"mdi-star"},{default:K(()=>[Ne(ee(U(ne)("curated")),1)]),_:1})):Mt("",!0),E(on,{color:"primary",class:"allow-select"},{default:K(()=>[Ne(ee(U(ne)("track_id"))+": "+ee(dt.track.TrackId),1)]),_:1}),E(on,{color:"primary"},{default:K(()=>[Ne(ee(U(ne)("length"))+": "+ee(dt.track.Distance)+"m ",1)]),_:1}),E(on,{color:"primary"},{default:K(()=>[Ne(ee(U(ne)("checkpoints"))+": "+ee(dt.track.Checkpoints.length),1)]),_:1}),E(on,{color:"primary"},{default:K(()=>[Ne(ee(U(ne)("created_by"))+": "+ee(dt.track.CreatorName),1)]),_:1}),(tt=dt.track.Access)!=null&&tt.race&&dt.track.Access.race.length>0?(Fe(),ft(on,{key:1,color:"primary"},{default:K(()=>[Ne(ee(U(ne)("shared_with"))+": "+ee(dt.track.Access.race.length)+" "+ee(U(ne)("racers")),1)]),_:1})):Mt("",!0)]}),_:1}),E(Zn,null,{default:K(()=>[E(Qi),U(u).baseData.data.auth.curateTracks?(Fe(),ft(Nt,{key:0,rounded:"xl",onClick:je[2]||(je[2]=tt=>m.value=!0)},{default:K(()=>[Ne(ee(U(ne)("curation")),1)]),_:1})):Mt("",!0),E(Nt,{rounded:"xl",onClick:je[3]||(je[3]=tt=>z.value=!0)},{default:K(()=>[Ne(ee(U(ne)("view_records")),1)]),_:1}),E(Nt,{rounded:"xl",onClick:je[4]||(je[4]=tt=>o.value=!0)},{default:K(()=>[Ne(ee(U(ne)("clear_lead")),1)]),_:1}),dt.track.Curated?Mt("",!0):(Fe(),ft(Nt,{key:1,rounded:"xl",onClick:je[5]||(je[5]=tt=>T.value=!0)},{default:K(()=>[Ne(ee(U(ne)("edit_track")),1)]),_:1})),E(Nt,{rounded:"xl",onClick:je[6]||(je[6]=tt=>Me())},{default:K(()=>[Ne(ee(U(ne)("edit_settings")),1)]),_:1}),E(Nt,{rounded:"xl",onClick:je[7]||(je[7]=tt=>ye())},{default:K(()=>[Ne(ee(U(ne)("edit_access")),1)]),_:1}),E(Nt,{rounded:"xl",onClick:je[8]||(je[8]=tt=>Se.value=!0)},{default:K(()=>[Ne(ee(U(ne)("delete_track")),1)]),_:1})]),_:1})]),_:1}),E(ra,{attach:".app-container",contained:"",modelValue:m.value,"onUpdate:modelValue":je[12]||(je[12]=tt=>m.value=tt),width:"auto"},{default:K(()=>[E(On,{rounded:"lg"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("handle_curation_for"))+" "+ee(dt.track.RaceName)+"?",1)]),_:1}),E(Zn,null,{default:K(()=>[E(Qi),E(Nt,{rounded:"xl",onClick:je[9]||(je[9]=tt=>o.value=!1)},{default:K(()=>[Ne(ee(U(ne)("close")),1)]),_:1}),E(Nt,{rounded:"xl",variant:"flat",color:"red",onClick:je[10]||(je[10]=tt=>Oe(0))},{default:K(()=>[Ne(ee(U(ne)("set_uncurated")),1)]),_:1}),E(Nt,{rounded:"xl",variant:"flat",color:"success",onClick:je[11]||(je[11]=tt=>Oe(1))},{default:K(()=>[Ne(ee(U(ne)("set_curated")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),E(ra,{attach:".app-container",contained:"",modelValue:o.value,"onUpdate:modelValue":je[15]||(je[15]=tt=>o.value=tt),width:"auto"},{default:K(()=>[E(On,{rounded:"lg"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("clear_lead_for"))+" "+ee(dt.track.RaceName)+"?",1)]),_:1}),E(qn,null,{default:K(()=>[Ne(ee(U(ne)("cant_be_reverted")),1)]),_:1}),E(Zn,null,{default:K(()=>[E(Qi),E(Nt,{rounded:"xl",onClick:je[13]||(je[13]=tt=>o.value=!1)},{default:K(()=>[Ne(ee(U(ne)("close")),1)]),_:1}),E(Nt,{rounded:"xl",variant:"flat",color:"red",onClick:je[14]||(je[14]=tt=>he())},{default:K(()=>[Ne(ee(U(ne)("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),E(ra,{attach:".app-container",contained:"",modelValue:T.value,"onUpdate:modelValue":je[18]||(je[18]=tt=>T.value=tt),width:"auto"},{default:K(()=>[E(On,{rounded:"xl"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("open_track_editor_for"))+" "+ee(dt.track.RaceName)+"?",1)]),_:1}),E(Zn,null,{default:K(()=>[E(Qi),E(Nt,{rounded:"xl",onClick:je[16]||(je[16]=tt=>T.value=!1)},{default:K(()=>[Ne(ee(U(ne)("close")),1)]),_:1}),E(Nt,{rounded:"xl",variant:"flat",color:"success",onClick:je[17]||(je[17]=tt=>Ce())},{default:K(()=>[Ne(ee(U(ne)("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),E(ra,{attach:".app-container",contained:"",modelValue:k.value,"onUpdate:modelValue":je[22]||(je[22]=tt=>k.value=tt),width:"auto"},{default:K(()=>[E(On,{rounded:"xl"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("editing_access_for"))+" "+ee(dt.track.RaceName),1)]),_:1}),E(qn,null,{default:K(()=>[E(hr,{label:U(ne)("access_list"),modelValue:me.value.race,"onUpdate:modelValue":je[19]||(je[19]=tt=>me.value.race=tt),hint:U(ne)("editing_access_info")},null,8,["label","modelValue","hint"])]),_:1}),E(Zn,null,{default:K(()=>[E(Qi),E(Nt,{rounded:"xl",onClick:je[20]||(je[20]=tt=>k.value=!1)},{default:K(()=>[Ne(ee(U(ne)("close")),1)]),_:1}),E(Nt,{rounded:"xl",variant:"flat",color:"success",onClick:je[21]||(je[21]=tt=>ke())},{default:K(()=>[Ne(ee(U(ne)("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),E(ra,{attach:".app-container",contained:"",modelValue:I.value,"onUpdate:modelValue":je[27]||(je[27]=tt=>I.value=tt),width:"auto"},{default:K(()=>[E(On,{rounded:"lg"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("edit_settings"))+" ",1),E(on,null,{default:K(()=>[Ne(ee(dt.track.RaceName),1)]),_:1})]),_:1}),E(qn,null,{default:K(()=>[E(SB,{class:"text-area",maxlength:200,counter:200,label:U(ne)("description"),hint:U(ne)("description_hint"),color:"primary",density:"compact",modelValue:pe.value.description,"onUpdate:modelValue":je[23]||(je[23]=tt=>pe.value.description=tt)},null,8,["label","hint","modelValue"]),E(ts,{label:U(ne)("race_type"),items:l,"item-value":"value","item-title":"label",color:"primary",density:"compact",modelValue:pe.value.raceType,"onUpdate:modelValue":je[24]||(je[24]=tt=>pe.value.raceType=tt),hideDetails:""},null,8,["label","modelValue"])]),_:1}),E(Zn,null,{default:K(()=>[E(Qi),E(Nt,{rounded:"xl",onClick:je[25]||(je[25]=tt=>I.value=!1)},{default:K(()=>[Ne(ee(U(ne)("close")),1)]),_:1}),E(Nt,{rounded:"xl",variant:"flat",color:"success",onClick:je[26]||(je[26]=tt=>Ee())},{default:K(()=>[Ne(ee(U(ne)("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),E(ra,{attach:".app-container",contained:"",modelValue:Se.value,"onUpdate:modelValue":je[30]||(je[30]=tt=>Se.value=tt),width:"auto"},{default:K(()=>[E(On,{rounded:"lg"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("delete_track"))+" "+ee(dt.track.RaceName)+"?",1)]),_:1}),E(qn,null,{default:K(()=>[Ne(ee(U(ne)("cant_be_reverted")),1)]),_:1}),E(Zn,null,{default:K(()=>[E(Qi),E(Nt,{rounded:"xl",onClick:je[28]||(je[28]=tt=>Se.value=!1)},{default:K(()=>[Ne(ee(U(ne)("close")),1)]),_:1}),E(Nt,{rounded:"xl",variant:"flat",color:"red",onClick:je[29]||(je[29]=tt=>xe())},{default:K(()=>[Ne(ee(U(ne)("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),E(ra,{attach:".app-container",contained:"",modelValue:z.value,"onUpdate:modelValue":je[33]||(je[33]=tt=>z.value=tt),width:"auto"},{default:K(()=>[E(On,{rounded:"lg"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("view_records"))+" "+ee(dt.track.RaceName)+"?",1)]),_:1}),E(rv,null,{default:K(()=>[Ne(ee(U(ne)("view_records_modal_desc")),1)]),_:1}),E(qn,null,{default:K(()=>[E(hu,{type:"warning"},{default:K(()=>[Ne(ee(U(ne)("changes_are_permanent")),1)]),_:1}),E(Xy,null,{default:K(()=>[(Fe(!0),Ot(un,null,la(dt.track.Records,(tt,Et)=>(Fe(),ft(za,{key:Et,title:tt.Holder+" | "+U(no)(tt.Time),subtitle:tt.Vehicle+" | "+tt.Class},{append:K(()=>[E(Nt,{variant:"text",color:"red",text:U(ne)("remove_record"),onClick:_t=>V(tt)},null,8,["text","onClick"])]),_:2},1032,["title","subtitle"]))),128))]),_:1})]),_:1}),E(Zn,null,{default:K(()=>[E(Qi),E(Nt,{rounded:"xl",onClick:je[31]||(je[31]=tt=>z.value=!1)},{default:K(()=>[Ne(ee(U(ne)("close")),1)]),_:1})]),_:1})]),_:1}),E(ra,{attach:".app-container",contained:"",width:"auto",modelValue:O.value,"onUpdate:modelValue":je[32]||(je[32]=tt=>O.value=tt)},{default:K(()=>[E(On,{rounded:"lg",title:U(ne)("confirm_record_removal")},{default:K(()=>[D.value?(Fe(),ft(qn,{key:0},{default:K(()=>[Xe("p",null,ee(U(ne)("racer_name"))+": "+ee(D.value.Holder),1),Xe("p",null,ee(U(ne)("best_lap"))+": "+ee(D.value.Time),1),Xe("p",null,ee(U(ne)("vehicle"))+": "+ee(D.value.Vehicle),1),Xe("p",null,ee(U(ne)("class"))+": "+ee(D.value.Class),1),Xe("p",null,ee(U(ne)("race_type"))+": "+ee(D.value.RaceType),1),Xe("p",null,ee(U(ne)("reversed"))+": "+ee(D.value.Reversed),1)]),_:1})):Mt("",!0),E(Zn,null,{default:K(()=>[E(Nt,{variant:"text",text:U(ne)("close"),onClick:Z},null,8,["text"]),E(Nt,{loading:B.value,variant:"text",color:"red",onClick:oe,text:U(ne)("confirm")},null,8,["loading","text"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])],64))}});const Kx=Pi(TB,[["__scopeId","data-v-e95aa6c6"]]),PB={id:"MyTracksPage",class:"pagecontent"},kB={class:"subheader inline"},IB={class:"header-text"},MB={key:0,class:"mytracks-items scrollable"},EB={key:2,class:"mytracks-items scrollable"},AB={class:"header-text"},RB=Vn({__name:"MyTracksPage",setup(e){const i=ei(),l=Ke(""),u=Ke(i.currentPage),f=Ke(void 0),g=Ke(void 0),m=Ke(void 0),o=Ke(void 0),T=ce(()=>{var B;let D=(B=m==null?void 0:m.value)==null?void 0:B.filter(V=>V.CreatorName===i.baseData.data.currentRacerName);return D&&l.value!==""&&(D=D.filter(V=>V.RaceName.toLowerCase().includes(l.value.toLowerCase())||V.TrackId.toLowerCase().includes(l.value.toLowerCase()))),D}),k=ce(()=>{let D=m.value;return D&&l.value!==""&&(D=D.filter(B=>B.RaceName.toLowerCase().includes(l.value.toLowerCase())||B.TrackId.toLowerCase().includes(l.value.toLowerCase()))),D}),I=async()=>{const D=await Ht.post("UiGetMyTracks");D.data&&(m.value=Object.values(D.data))},z=async()=>{(await Ht.post("UiCreateTrack",JSON.stringify({name:f.value}))).data&&ca()},O=async()=>{(await Ht.post("UiCreateTrack",JSON.stringify({name:g.value,checkpoints:o.value}))).data&&ca()};return Qn(()=>{I()}),(D,B)=>(Fe(),Ot("div",PB,[E(wu,{color:"primary",modelValue:u.value,"onUpdate:modelValue":B[0]||(B[0]=V=>u.value=V)},{default:K(()=>[E(fr,{value:"myTracks"},{default:K(()=>[Ne(ee(U(ne)("my_tracks")),1)]),_:1}),E(fr,{value:"create"},{default:K(()=>[Ne(ee(U(ne)("create_track")),1)]),_:1})]),_:1},8,["modelValue"]),E(ro,{modelValue:u.value,"onUpdate:modelValue":B[7]||(B[7]=V=>u.value=V),class:"page-container"},{default:K(()=>[E(pr,{value:"myTracks",class:"tabcontent mt"},{default:K(()=>[Xe("div",kB,[Xe("h3",IB,ee(U(ne)("my_tracks")),1),E(hr,{class:"text-field",hideDetails:"",placeholder:U(ne)("search_dot"),density:"compact",modelValue:l.value,"onUpdate:modelValue":B[1]||(B[1]=V=>l.value=V)},null,8,["placeholder","modelValue"])]),T.value&&T.value.length>0?(Fe(),Ot("div",MB,[(Fe(!0),Ot(un,null,la(T.value,V=>(Fe(),ft(Kx,{onUpdate:I,track:V},null,8,["track"]))),256))])):(Fe(),ft(Tr,{key:1,title:U(ne)("no_data")},null,8,["title"])),U(i).baseData.data.auth.controlAll?(Fe(),Ot("div",EB,[Xe("h3",AB,ee(U(ne)("tracks")),1),(Fe(!0),Ot(un,null,la(k.value,V=>(Fe(),ft(Kx,{onUpdate:I,track:V},null,8,["track"]))),256))])):Mt("",!0)]),_:1}),E(pr,{value:"create",class:"tabcontent create mt"},{default:K(()=>[E(On,{class:"card"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("create_with_editor")),1)]),_:1}),E(qn,null,{default:K(()=>[E(hr,{density:"compact",placeholder:U(ne)("track_name"),modelValue:f.value,"onUpdate:modelValue":B[2]||(B[2]=V=>f.value=V)},null,8,["placeholder","modelValue"])]),_:1}),E(Zn,null,{default:K(()=>[E(Nt,{block:"",color:"success",variant:"elevated",type:"submit",onClick:B[3]||(B[3]=V=>z())},{default:K(()=>[Ne(ee(U(ne)("confirm")),1)]),_:1})]),_:1})]),_:1}),E(On,{class:"card"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("create_with_share")),1)]),_:1}),E(qn,null,{default:K(()=>[E(hr,{density:"compact",placeholder:U(ne)("track_name"),modelValue:g.value,"onUpdate:modelValue":B[4]||(B[4]=V=>g.value=V)},null,8,["placeholder","modelValue"]),E(hr,{density:"compact",placeholder:"Paste Checkpoints Here",modelValue:o.value,"onUpdate:modelValue":B[5]||(B[5]=V=>o.value=V)},null,8,["modelValue"])]),_:1}),E(Zn,null,{default:K(()=>[E(Nt,{block:"",color:"success",variant:"elevated",type:"submit",onClick:B[6]||(B[6]=V=>O())},{default:K(()=>[Ne(ee(U(ne)("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}});const DB=Pi(RB,[["__scopeId","data-v-9bc95f92"]]),zB=Vn({__name:"MyRacerCard",props:{racer:{}},emits:["triggerReload"],setup(e,{emit:i}){const l=e,u=ei(),f=Ke(!1),g=Ke(!1),m=Ke(!1),o=i,T=ce(()=>l.racer.revoked==1),k=Ke(l.racer.auth),I=ce(()=>{const B=u.baseData.data.allAuthorities,V=[];return Object.entries(B).map(([Z,oe])=>{V.push(Z)}),V}),z=()=>{Ht.post("UiChangeAuth",JSON.stringify({racername:l.racer.racername,auth:k.value,citizenId:l.racer.citizenid})),f.value=!1,setTimeout(()=>{o("triggerReload")},1e3)},O=()=>{Ht.post("UiRevokeRacer",JSON.stringify({racername:l.racer.racername,status:l.racer.revoked})),g.value=!1,setTimeout(()=>{o("triggerReload")},1e3)},D=async()=>{Ht.post("UiRemoveRacer",JSON.stringify({racername:l.racer.racername})),m.value=!1,setTimeout(()=>{o("triggerReload")},1e3)};return(B,V)=>(Fe(),Ot(un,null,[E(On,{border:"",rounded:"xl",class:"big-card"},{default:K(()=>[E($n,{class:"title"},{default:K(()=>[Ne(ee(B.racer.racername),1)]),_:1}),E(qn,{class:"text"},{default:K(()=>[E(on,{color:"primary",class:"allow-select"},{default:K(()=>[Ne(ee(U(ne)("citizen_id"))+" : "+ee(B.racer.citizenid),1)]),_:1}),E(on,{color:"primary"},{default:K(()=>[Ne(ee(U(ne)("tracks"))+" : "+ee(B.racer.tracks),1)]),_:1}),E(on,{color:"primary"},{default:K(()=>[Ne(ee(U(ne)("races"))+" : "+ee(B.racer.races),1)]),_:1}),E(on,{color:"primary"},{default:K(()=>[Ne(ee(U(ne)("wins"))+" : "+ee(B.racer.wins),1)]),_:1}),E(on,{color:"primary"},{default:K(()=>[Ne(ee(U(ne)("auth"))+" : "+ee(B.racer.auth),1)]),_:1}),E(on,{color:"primary"},{default:K(()=>[Ne(ee(U(ne)("created_by"))+" : "+ee(B.racer.createdby?B.racer.createdby:U(ne)("unknown")),1)]),_:1})]),_:1}),E(Zn,null,{default:K(()=>[E(Qi),U(u).baseData.data.auth.controlAll?(Fe(),ft(Nt,{key:0,rounded:"xl",onClick:V[0]||(V[0]=Z=>f.value=!0)},{default:K(()=>[Ne(ee(U(ne)("auth")),1)]),_:1})):Mt("",!0),E(Nt,{rounded:"xl",onClick:V[1]||(V[1]=Z=>g.value=!0)},{default:K(()=>[Ne(ee(T.value?U(ne)("activate"):U(ne)("revoke")),1)]),_:1}),U(u).baseData.data.auth.controlAll?(Fe(),ft(Nt,{key:1,rounded:"xl",onClick:V[2]||(V[2]=Z=>m.value=!0)},{default:K(()=>[Ne(ee(U(ne)("delete_user")),1)]),_:1})):Mt("",!0)]),_:1})]),_:1}),E(ra,{attach:".app-container",contained:"",modelValue:f.value,"onUpdate:modelValue":V[6]||(V[6]=Z=>f.value=Z),width:"auto"},{default:K(()=>[E(On,{rounded:"lg"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("change_auth"))+"?",1)]),_:1}),E(qn,null,{default:K(()=>[E(ts,{color:"primary",density:"compact",items:I.value,"item-value":"value","item-title":"text",label:U(ne)("auth"),hideDetails:"",modelValue:k.value,"onUpdate:modelValue":V[3]||(V[3]=Z=>k.value=Z)},null,8,["items","label","modelValue"])]),_:1}),E(Zn,null,{default:K(()=>[E(Qi),E(Nt,{rounded:"xl",onClick:V[4]||(V[4]=Z=>f.value=!1)},{default:K(()=>[Ne(ee(U(ne)("close")),1)]),_:1}),E(Nt,{rounded:"xl",variant:"flat",color:"primary",onClick:V[5]||(V[5]=Z=>z())},{default:K(()=>[Ne(ee(U(ne)("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),E(ra,{attach:".app-container",contained:"",modelValue:g.value,"onUpdate:modelValue":V[9]||(V[9]=Z=>g.value=Z),width:"auto"},{default:K(()=>[E(On,{rounded:"lg"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(T.value?U(ne)("activate"):U(ne)("revoke"))+" "+ee(U(ne)("access_for"))+" "+ee(B.racer.racername)+"?",1)]),_:1}),E(qn,null,{default:K(()=>[Ne(ee(U(ne)("can_be_reverted")),1)]),_:1}),E(Zn,null,{default:K(()=>[E(Qi),E(Nt,{rounded:"xl",onClick:V[7]||(V[7]=Z=>g.value=!1)},{default:K(()=>[Ne(ee(U(ne)("close")),1)]),_:1}),E(Nt,{rounded:"xl",variant:"flat",color:"red",onClick:V[8]||(V[8]=Z=>O())},{default:K(()=>[Ne(ee(U(ne)("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),E(ra,{attach:".app-container",contained:"",modelValue:m.value,"onUpdate:modelValue":V[12]||(V[12]=Z=>m.value=Z),width:"auto"},{default:K(()=>[E(On,{rounded:"lg"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("delete_user"))+" "+ee(B.racer.racername)+"?",1)]),_:1}),E(qn,null,{default:K(()=>[Ne(ee(U(ne)("cant_be_reverted")),1)]),_:1}),E(Zn,null,{default:K(()=>[E(Qi),E(Nt,{rounded:"xl",onClick:V[10]||(V[10]=Z=>m.value=!1)},{default:K(()=>[Ne(ee(U(ne)("close")),1)]),_:1}),E(Nt,{rounded:"xl",variant:"flat",color:"red",onClick:V[11]||(V[11]=Z=>D())},{default:K(()=>[Ne(ee(U(ne)("confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}});const LB=Pi(zB,[["__scopeId","data-v-fd798e99"]]),BB={id:"RacersPage",class:"pagecontent"},FB={class:"subheader inline"},OB={key:0,class:"myRacers-items-container scrollable"},VB={key:0,class:"create-options"},NB=Vn({__name:"RacersPage",setup(e){const i=ei(),l=Ke(i.currentPage),u=Ke(void 0),f=Ke(void 0),g=Ke(""),m=Ke(void 0),o=ce(()=>u.value&&g.value!==""?u.value.filter(D=>D.racername.toLowerCase().includes(g.value.toLowerCase())||D.citizenid.toLowerCase().includes(g.value.toLowerCase())):u.value),T=Ke({racerName:"",racerId:""}),k=Ke(!1),I=ce(()=>!!(k.value||T.value.racerName===""||!m.value)),z=async()=>{const D=await Ht.post("UiGetRacersCreatedByUser");D.data&&(u.value=D.data);const B=await Ht.post("UiGetPermissionedUserTypes");B.data&&(f.value=B.data)},O=async()=>{k.value=!0;const D=await Ht.post("UiCreateUser",JSON.stringify({racerName:T.value.racerName,racerId:T.value.racerId,selectedAuth:m.value}));setTimeout(()=>{k.value=!1,D.data&&(T.value.racerName=""),T.value.racerId=""},1e3)};return Qn(()=>{z()}),(D,B)=>(Fe(),Ot("div",BB,[E(wu,{color:"primary",modelValue:l.value,"onUpdate:modelValue":B[0]||(B[0]=V=>l.value=V)},{default:K(()=>{var V,Z,oe;return[E(fr,{value:"myRacers"},{default:K(()=>[Ne(ee(U(ne)("my_racers")),1)]),_:1}),(oe=(Z=(V=U(i).baseData)==null?void 0:V.data)==null?void 0:Z.auth)!=null&&oe.create?(Fe(),ft(fr,{key:0,value:"create"},{default:K(()=>[Ne(ee(U(ne)("create_racer")),1)]),_:1})):Mt("",!0)]}),_:1},8,["modelValue"]),E(ro,{modelValue:l.value,"onUpdate:modelValue":B[7]||(B[7]=V=>l.value=V),class:"page-container"},{default:K(()=>[E(pr,{value:"myRacers",class:"tabcontent"},{default:K(()=>[Xe("div",FB,[E(hr,{class:"text-field",hideDetails:"",density:"compact",color:"primary",placeholder:U(ne)("search_dot"),modelValue:g.value,"onUpdate:modelValue":B[1]||(B[1]=V=>g.value=V)},null,8,["placeholder","modelValue"])]),u.value&&u.value.length>0?(Fe(),Ot("div",OB,[(Fe(!0),Ot(un,null,la(o.value,V=>(Fe(),ft(LB,{key:V.id,onTriggerReload:B[2]||(B[2]=Z=>z()),racer:V},null,8,["racer"]))),128))])):Mt("",!0)]),_:1}),E(pr,{value:"create",class:"tabcontent"},{default:K(()=>{var V,Z,oe;return[(oe=(Z=(V=U(i).baseData)==null?void 0:V.data)==null?void 0:Z.auth)!=null&&oe.create?(Fe(),Ot("div",VB,[E(On,{class:"card"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("create_racer")),1)]),_:1}),E(qn,null,{default:K(()=>[E(hr,{color:"primary",density:"compact",placeholder:U(ne)("racer_name"),modelValue:T.value.racerName,"onUpdate:modelValue":B[3]||(B[3]=pe=>T.value.racerName=pe)},null,8,["placeholder","modelValue"]),E(hr,{color:"primary",density:"compact",placeholder:U(ne)("racer_id"),modelValue:T.value.racerId,"onUpdate:modelValue":B[4]||(B[4]=pe=>T.value.racerId=pe)},null,8,["placeholder","modelValue"]),f.value&&f.value.length>0?(Fe(),ft(ts,{key:0,color:"primary",density:"compact","hide-details":"",items:Object.values(f.value),"return-object":"","item-title":"label",modelValue:m.value,"onUpdate:modelValue":B[5]||(B[5]=pe=>m.value=pe)},null,8,["items","modelValue"])):(Fe(),ft(Tr,{key:1,title:U(ne)("not_auth")},null,8,["title"]))]),_:1}),E(Zn,null,{default:K(()=>[E(Nt,{block:"",color:"success",variant:"flat",type:"submit",onClick:B[6]||(B[6]=pe=>O()),loading:k.value,disabled:I.value},{default:K(()=>[Ne(ee(U(ne)("confirm")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})])):(Fe(),ft(Tr,{key:1,title:U(ne)("not_auth")},null,8,["title"]))]}),_:1})]),_:1},8,["modelValue"])]))}});const $B=Pi(NB,[["__scopeId","data-v-ce4be085"]]),Ys=async()=>{const e=ei();e.isLoadingBaseData=!0;const i=await Ht.post("GetBaseData");i&&(e.baseData=i),e.isLoadingBaseData=!1},jB={id:"RacingPage",class:"pagecontent"},UB=Vn({__name:"SettingsPage",setup(e){const i=ei(),l=Ke({ShowGpsRoute:!1,IgnoreRoadsForGps:!1,UseUglyWaypoint:!1,CheckDistance:!1,UseDrawTextWaypoint:!1}),u=Ke(i.baseData.data.currentRacerName),f=Ke(!1),g=async T=>{await Ht.post("UiUpdateSettings",JSON.stringify({setting:T,value:l.value[T]}))},m=async()=>{f.value=!0,await Ht.post("UiChangeRacerName",JSON.stringify(u.value)),setTimeout(()=>{Ys(),f.value=!1},1e3)},o=async()=>{const T=await Ht.post("UiGetSettings");l.value=T.data};return Qn(()=>{o()}),(T,k)=>(Fe(),Ot("div",jB,[E(ro,null,{default:K(()=>[E(pr,{value:"current",class:"tabcontent"},{default:K(()=>[E(ov,null,{default:K(()=>[E(On,null,{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("settings")),1)]),_:1}),E(qn,null,{default:K(()=>[E(Lm,null,{default:K(()=>[E(ns,null,{default:K(()=>[E(sr,{cols:"12",sm:"6"},{default:K(()=>[E(aa,{color:"primary",label:U(ne)("show_gps"),modelValue:l.value.ShowGpsRoute,"onUpdate:modelValue":k[0]||(k[0]=I=>l.value.ShowGpsRoute=I),onChange:k[1]||(k[1]=I=>g("ShowGpsRoute"))},null,8,["label","modelValue"])]),_:1}),E(sr,{cols:"12",sm:"6"},{default:K(()=>[E(aa,{color:"primary",label:U(ne)("ignore_roads"),modelValue:l.value.IgnoreRoadsForGps,"onUpdate:modelValue":k[2]||(k[2]=I=>l.value.IgnoreRoadsForGps=I),onChange:k[3]||(k[3]=I=>g("IgnoreRoadsForGps"))},null,8,["label","modelValue"])]),_:1})]),_:1}),E(ns,null,{default:K(()=>[E(sr,{cols:"12",sm:"6"},{default:K(()=>[E(aa,{color:"primary",label:U(ne)("base_wps"),modelValue:l.value.UseUglyWaypoint,"onUpdate:modelValue":k[4]||(k[4]=I=>l.value.UseUglyWaypoint=I),onChange:k[5]||(k[5]=I=>g("UseUglyWaypoint"))},null,8,["label","modelValue"])]),_:1}),E(sr,{cols:"12",sm:"6"},{default:K(()=>[E(aa,{color:"primary",label:U(ne)("distance_check"),modelValue:l.value.CheckDistance,"onUpdate:modelValue":k[6]||(k[6]=I=>l.value.CheckDistance=I),onChange:k[7]||(k[7]=I=>g("CheckDistance"))},null,8,["label","modelValue"]),E(tm,{location:"top",activator:"parent",text:U(ne)("distance_info")},null,8,["text"])]),_:1})]),_:1}),E(ns,null,{default:K(()=>[E(sr,{cols:"12",sm:"6"},{default:K(()=>[E(aa,{color:"primary",label:U(ne)("pillar_columns"),modelValue:l.value.UseDrawTextWaypoint,"onUpdate:modelValue":k[8]||(k[8]=I=>l.value.UseDrawTextWaypoint=I),onChange:k[9]||(k[9]=I=>g("UseDrawTextWaypoint"))},null,8,["label","modelValue"]),E(tm,{location:"top",activator:"parent",text:U(ne)("distance_info")},null,8,["text"])]),_:1})]),_:1}),E(ns,null,{default:K(()=>[E(sr,{cols:"12",sm:"6"},{default:K(()=>[E(ts,{color:"primary","hide-details":"",items:U(i).baseData.data.racerNames,"item-value":"racername","item-title":"racername",label:U(ne)("user"),modelValue:u.value,"onUpdate:modelValue":[k[10]||(k[10]=I=>u.value=I),k[11]||(k[11]=I=>m())],loading:f.value,disabled:U(i).activeHudData.InRace},null,8,["items","label","modelValue","loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]))}});const GB=Pi(UB,[["__scopeId","data-v-54341e69"]]),HB=Vn({__name:"MyCrewMemberCard",props:{member:{},memberIsFounder:{type:Boolean},isFounder:{type:Boolean}},emits:["triggerReload"],setup(e,{emit:i}){return(l,u)=>(Fe(),ft(On,{border:"",rounded:"xl",class:"big-card"},{default:K(()=>[E($n,{class:"title"},{default:K(()=>[Ne(ee(l.member.racername)+" "+ee(l.memberIsFounder?"⭐":""),1)]),_:1}),E(qn,{class:"text"},{default:K(()=>[E(on,{color:"primary"},{default:K(()=>[Ne(ee(U(ne)("citizen_id"))+": "+ee(l.member.citizenID),1)]),_:1})]),_:1})]),_:1}))}});const ZB=Pi(HB,[["__scopeId","data-v-94275c56"]]),qB={id:"CrewPage",class:"pagecontent"},WB={class:"subheader inline mt-1"},XB={class:"header-text"},KB={key:1,class:"myRacers-items-container"},YB={class:"subheader inline"},JB={class:"header-text"},QB={class:"w-100 invitations"},eF={class:"subheader inline"},tF={class:"header-text"},nF={class:"myRacers-items-container"},iF={class:"invitations"},rF=Vn({__name:"CrewPage",setup(e){const i=ei(),l=Ke(i.currentTab),u=Ke(i.myCrew),f=Ke(void 0),g=Ke(!1),m=ce(()=>{var oe;return((oe=u==null?void 0:u.value)==null?void 0:oe.founderName)===i.baseData.data.currentRacerName}),o=Ke(""),T=Ke(""),k=async()=>{const oe=await Ht.post("UiGetCrewData");oe.data&&(i.myCrew=oe.data.crew,u.value=oe.data.crew,f.value=oe.data.invites)},I=async()=>{g.value=!0,await Ht.post("UiCreateCrew",JSON.stringify({crewName:o.value})),setTimeout(()=>{Ys(),k(),g.value=!1},1e3)},z=async()=>{g.value=!0,Ht.post("UiLeaveCrew",JSON.stringify({crewName:i.baseData.data.currentCrewName})),setTimeout(()=>{Ys(),k(),g.value=!1},1e3)},O=async()=>{g.value=!0,Ht.post("UiDisbandCrew",JSON.stringify({crewName:i.baseData.data.currentCrewName})),setTimeout(()=>{Ys(),k(),g.value=!1},1e3)},D=async()=>{g.value=!0,Ht.post("UiAcceptInvite",JSON.stringify({crewName:f.value.crewName})),setTimeout(()=>{Ys(),k(),g.value=!1},1e3)},B=async()=>{g.value=!0,Ht.post("UiDenyInvite",JSON.stringify({})),setTimeout(()=>{Ys(),k(),g.value=!1},1e3)},V=async()=>{g.value=!0;const oe=await Ht.post("UiSendInvite",JSON.stringify({citizenId:T.value}));setTimeout(()=>{Ys(),k(),g.value=!1,oe.data&&(T.value="")},1e3)},Z=async()=>{g.value=!0,await Ht.post("UiSendInviteClosest",JSON.stringify({})),setTimeout(()=>{Ys(),k(),g.value=!1},1e3)};return Qn(()=>{k()}),(oe,pe)=>(Fe(),Ot("div",qB,[E(wu,{color:"primary",modelValue:l.value,"onUpdate:modelValue":pe[3]||(pe[3]=Se=>l.value=Se)},{default:K(()=>[E(fr,{onClick:pe[0]||(pe[0]=Se=>k()),value:"myCrew"},{default:K(()=>[Ne(ee(U(ne)("my_crew")),1)]),_:1}),E(fr,{onClick:pe[1]||(pe[1]=Se=>k()),value:"create"},{default:K(()=>[Ne(ee(U(ne)("manage")),1)]),_:1}),E(fr,{onClick:pe[2]||(pe[2]=Se=>k()),value:"invites"},{default:K(()=>[Ne(ee(U(ne)("invites")),1)]),_:1})]),_:1},8,["modelValue"]),E(ro,{modelValue:l.value,"onUpdate:modelValue":pe[14]||(pe[14]=Se=>l.value=Se),class:"page-container"},{default:K(()=>[E(pr,{value:"myCrew",class:"tabcontent"},{default:K(()=>{var Se,me,be;return[u.value?(Fe(),ft(On,{key:0},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("crew_stats")),1)]),_:1}),E(qn,{class:"text"},{default:K(()=>[E(on,{color:"primary"},{default:K(()=>[Ne(ee(U(ne)("rank"))+": "+ee(u.value.rank),1)]),_:1}),E(on,{color:"primary"},{default:K(()=>[Ne(ee(U(ne)("races"))+": "+ee(u.value.races),1)]),_:1}),E(on,{color:"primary"},{default:K(()=>[Ne(ee(U(ne)("wins"))+": "+ee(u.value.wins),1)]),_:1})]),_:1})]),_:1})):Mt("",!0),Xe("div",WB,[Xe("h3",XB,ee(U(ne)("my_crew"))+" "+ee((Se=u.value)==null?void 0:Se.crewName),1)]),u.value&&((be=(me=u.value)==null?void 0:me.members)==null?void 0:be.length)>0?(Fe(),Ot("div",KB,[(Fe(!0),Ot(un,null,la(u.value.members,he=>(Fe(),ft(ZB,{isFounder:m.value,memberIsFounder:he.racername===u.value.founderName,onTriggerReload:pe[4]||(pe[4]=Ce=>k()),member:he,key:he.citizenID},null,8,["isFounder","memberIsFounder","member"]))),128))])):u.value?(Fe(),ft(Tr,{key:3,title:U(ne)("no_members_in_crew")},null,8,["title"])):(Fe(),ft(Tr,{key:2,title:U(ne)("not_in_crew")},null,8,["title"]))]}),_:1}),E(pr,{value:"create",class:"tabcontent"},{default:K(()=>{var Se,me,be,he;return[Xe("div",YB,[Xe("h3",JB,ee(U(ne)("manage")),1)]),Xe("div",QB,[(he=(be=(me=(Se=U(i))==null?void 0:Se.baseData)==null?void 0:me.data)==null?void 0:be.auth)!=null&&he.createCrew&&!m.value?(Fe(),ft(On,{key:0,class:"card"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("create_crew")),1)]),_:1}),E(qn,null,{default:K(()=>[E(hr,{density:"compact",placeholder:"Crew Name",modelValue:o.value,"onUpdate:modelValue":pe[5]||(pe[5]=Ce=>o.value=Ce)},null,8,["modelValue"])]),_:1}),E(Zn,null,{default:K(()=>[E(Nt,{block:"",color:"success",variant:"elevated",type:"submit",onClick:pe[6]||(pe[6]=Ce=>I()),loading:g.value},{default:K(()=>[Ne(ee(U(ne)("confirm")),1)]),_:1},8,["loading"])]),_:1})]),_:1})):Mt("",!0),U(i).baseData.data.currentCrewName&&!m.value?(Fe(),ft(On,{key:1,class:"card"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("leave_current_crew"))+" : "+ee(U(i).baseData.data.currentCrewName),1)]),_:1}),E(Zn,null,{default:K(()=>[E(Nt,{block:"",color:"error",variant:"elevated",type:"submit",onClick:pe[7]||(pe[7]=Ce=>z()),loading:g.value},{default:K(()=>[Ne(ee(U(ne)("leave")),1)]),_:1},8,["loading"])]),_:1})]),_:1})):Mt("",!0),U(i).baseData.data.currentCrewName&&m.value?(Fe(),ft(On,{key:2,class:"card"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("disband_crew"))+" : "+ee(U(i).baseData.data.currentCrewName),1)]),_:1}),E(Zn,null,{default:K(()=>[E(Nt,{block:"",color:"error",variant:"elevated",type:"submit",onClick:pe[8]||(pe[8]=Ce=>O()),loading:g.value},{default:K(()=>[Ne(ee(U(ne)("confirm")),1)]),_:1},8,["loading"])]),_:1})]),_:1})):Mt("",!0)])]}),_:1}),E(pr,{value:"invites",class:"tabcontent"},{default:K(()=>[Xe("div",eF,[Xe("h3",tF,ee(U(ne)("invites")),1)]),Xe("div",nF,[f.value?(Fe(),ft(On,{key:0},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("invite_from_crew"))+": "+ee(f.value.crewName),1)]),_:1}),E(Zn,null,{default:K(()=>[E(Nt,{variant:"tonal",type:"submit",onClick:pe[9]||(pe[9]=Se=>B()),loading:g.value},{default:K(()=>[Ne(ee(U(ne)("deny")),1)]),_:1},8,["loading"]),E(Nt,{color:"success",variant:"elevated",type:"submit",onClick:pe[10]||(pe[10]=Se=>D()),loading:g.value},{default:K(()=>[Ne(ee(U(ne)("accept")),1)]),_:1},8,["loading"])]),_:1})]),_:1})):(Fe(),ft(Tr,{key:1,title:U(ne)("no_invites")},null,8,["title"])),m.value?(Fe(),ft(IS,{key:2})):Mt("",!0),Xe("div",iF,[m.value?(Fe(),ft(On,{key:0,class:"card"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("invite")),1)]),_:1}),E(qn,null,{default:K(()=>[E(hr,{density:"compact",placeholder:"CitizenID",modelValue:T.value,"onUpdate:modelValue":pe[11]||(pe[11]=Se=>T.value=Se)},null,8,["modelValue"])]),_:1}),E(Zn,null,{default:K(()=>[E(Nt,{block:"",color:"success",variant:"elevated",type:"submit",onClick:pe[12]||(pe[12]=Se=>V()),loading:g.value},{default:K(()=>[Ne(ee(U(ne)("confirm")),1)]),_:1},8,["loading"])]),_:1})]),_:1})):Mt("",!0),m.value?(Fe(),ft(On,{key:1,class:"card"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("invite_closest")),1)]),_:1}),E(Zn,null,{default:K(()=>[E(Nt,{block:"",color:"success",variant:"elevated",type:"submit",onClick:pe[13]||(pe[13]=Se=>Z()),loading:g.value},{default:K(()=>[Ne(ee(U(ne)("confirm")),1)]),_:1},8,["loading"])]),_:1})]),_:1})):Mt("",!0)])])]),_:1})]),_:1},8,["modelValue"])]))}});const aF=Pi(rF,[["__scopeId","data-v-447d11fe"]]),sF=Vn({__name:"UserCreation",setup(e){const i=ei(),l=Ke({racerName:""}),u=Ke(!1),f=Ke(void 0),g=ce(()=>!!(u.value||l.value.racerName==="")),m=async()=>{u.value=!0;const T=await Ht.post("UiCreateUser",JSON.stringify({racerName:l.value.racerName,racerId:void 0,selectedAuth:f.value}));setTimeout(()=>{u.value=!1,T.data&&(l.value.racerName="")},1e3)},o=async()=>{const T=await Ht.post("UiGetPermissionedUserTypeFirstUser");T.data&&(f.value=T.data)};return Qn(()=>{o()}),(T,k)=>(Fe(),ft(On,{class:"w-100 mt-3"},{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("create_racer")),1)]),_:1}),E(qn,null,{default:K(()=>[E(hr,{color:"primary",density:"compact",placeholder:U(ne)("racer_name"),modelValue:l.value.racerName,"onUpdate:modelValue":k[0]||(k[0]=I=>l.value.racerName=I)},null,8,["placeholder","modelValue"]),U(i).baseData.data.isFirstUser?(Fe(),ft(hu,{key:0,icon:"$info",color:"info"},{default:K(()=>[Ne(ee(U(ne)("is_first_user")),1)]),_:1})):Mt("",!0)]),_:1}),E(Zn,null,{default:K(()=>[E(Nt,{block:"",color:"success",variant:"flat",type:"submit",onClick:k[1]||(k[1]=I=>m()),loading:u.value,disabled:g.value},{default:K(()=>[Ne(ee(U(ne)("confirm")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1}))}}),oF={class:"mt-1"},lF={class:"mt-1"},cF={class:"mt-1"},uF={class:"mt-1"},dF={class:"mt-1"},hF=Vn({__name:"CryptoModal",setup(e){const i=ei(),l=i.baseData.data.allowBuyingCrypto?"buy":i.baseData.data.allowSellingCrypto?"sell":"transfer",u=Ke(l),f=Ke(0),g=Ke(0),m=Ke(0),o=Ke(""),T=Ke(void 0),k=Ke(void 0),I=Ke(void 0),z=Ke(!1),O=Ke(!1),D=Ke(!1),B=ce(()=>Math.floor(f.value/i.baseData.data.cryptoConversionRate)),V=ce(()=>Math.floor(g.value/i.baseData.data.cryptoConversionRate)),Z=ce(()=>Math.floor(V.value-V.value*i.baseData.data.sellCharge)),oe=ce(()=>!(!(f.value>=1&&B.value>=1)||!Number.isInteger(f.value))),pe=ce(()=>!(g.value>i.baseData.data.currentCrypto||!(g.value>=1&&V.value>=1)||!Number.isInteger(g.value))),Se=ce(()=>!(m.value>i.baseData.data.currentCrypto||!(m.value>=1)||!Number.isInteger(m.value))),me=ce(()=>o.value.length!==0),be=async()=>{z.value=!0;const ye=await Ht.post("UiPurchaseCrypto",JSON.stringify({cryptoAmount:f.value}));ye.data!=="SUCCESS"?T.value=ye.data:T.value=void 0,z.value=!1},he=async()=>{O.value=!0;const ye=await Ht.post("UiSellCrypto",JSON.stringify({cryptoAmount:g.value}));ye.data!=="SUCCESS"?k.value=ye.data:k.value=void 0,O.value=!1},Ce=async()=>{D.value=!0;const ye=await Ht.post("UiTransferCrypto",JSON.stringify({cryptoAmount:m.value,recipient:o.value}));ye.data!=="SUCCESS"?I.value=ye.data:I.value=void 0,D.value=!1};return(ye,Me)=>(Fe(),ft(ra,{attach:".app-container",contained:"",width:"auto",modelValue:U(i).showCryptoModal,"onUpdate:modelValue":Me[7]||(Me[7]=ke=>U(i).showCryptoModal=ke)},{default:K(()=>[E(On,{class:"mx-auto",rounded:"lg",title:U(ne)("purchase")+" "+U(i).baseData.data.cryptoType,subtitle:U(ne)("current_conversionrate")+": 1"+U(i).baseData.data.cryptoType+" = "+U(ne)("currency_text")+1/U(i).baseData.data.cryptoConversionRate},{default:K(()=>[E(wu,{modelValue:u.value,"onUpdate:modelValue":Me[0]||(Me[0]=ke=>u.value=ke)},{default:K(()=>[U(i).baseData.data.allowBuyingCrypto?(Fe(),ft(fr,{key:0,value:"buy"},{default:K(()=>[Ne(ee(U(ne)("buy")),1)]),_:1})):Mt("",!0),U(i).baseData.data.allowSellingCrypto?(Fe(),ft(fr,{key:1,value:"sell"},{default:K(()=>[Ne(ee(U(ne)("sell")),1)]),_:1})):Mt("",!0),U(i).baseData.data.allowTransferCrypto?(Fe(),ft(fr,{key:2,value:"transfer"},{default:K(()=>[Ne(ee(U(ne)("transfer")),1)]),_:1})):Mt("",!0)]),_:1},8,["modelValue"]),E(qn,null,{default:K(()=>[E(e2,{modelValue:u.value,"onUpdate:modelValue":Me[5]||(Me[5]=ke=>u.value=ke)},{default:K(()=>[E(Rp,{value:"buy"},{default:K(()=>[E(hr,{modelValue:f.value,"onUpdate:modelValue":Me[1]||(Me[1]=ke=>f.value=ke),modelModifiers:{number:!0},error:!oe.value,hint:U(ne)("crypto_hint"),"hide-details":"auto",label:U(ne)("crypto_amount"),"persistent-hint":"",type:"number"},null,8,["modelValue","error","hint","label"]),Xe("p",oF,ee(U(ne)("total_cost"))+": "+ee(U(ne)("currency_text"))+ee(B.value),1),T.value?(Fe(),ft(hu,{key:0,class:"mt-1",type:"error"},{default:K(()=>[Ne(ee(U(ne)(T.value)),1)]),_:1})):Mt("",!0),Xe("p",lF,[E(Nt,{rounded:"xl",block:"",color:"success",variant:"flat",disabled:!oe.value,loading:z.value,text:U(ne)("buy")+" "+f.value+" "+U(i).baseData.data.cryptoType,onClick:be},null,8,["disabled","loading","text"])])]),_:1}),E(Rp,{value:"sell"},{default:K(()=>[E(hr,{modelValue:g.value,"onUpdate:modelValue":Me[2]||(Me[2]=ke=>g.value=ke),modelModifiers:{number:!0},error:!pe.value,hint:U(ne)("crypto_hint"),"hide-details":"auto",label:U(ne)("crypto_amount"),"persistent-hint":"",type:"number"},null,8,["modelValue","error","hint","label"]),Xe("p",cF,ee(U(ne)("total"))+": "+ee(U(ne)("currency_text"))+ee(V.value),1),Xe("p",null,ee(U(ne)("fee"))+": "+ee(U(i).baseData.data.sellCharge*100)+"% ",1),Xe("p",null,ee(U(ne)("you_get"))+": "+ee(U(ne)("currency_text"))+ee(Z.value),1),k.value?(Fe(),ft(hu,{key:0,class:"mt-1",type:"error"},{default:K(()=>[Ne(ee(U(ne)(k.value)),1)]),_:1})):Mt("",!0),Xe("p",uF,[E(Nt,{block:"",rounded:"xl",color:"success",variant:"flat",disabled:!pe.value,loading:O.value,text:U(ne)("sell")+" "+g.value+" "+U(i).baseData.data.cryptoType,onClick:he},null,8,["disabled","loading","text"])])]),_:1}),E(Rp,{value:"transfer"},{default:K(()=>[E(hr,{modelValue:m.value,"onUpdate:modelValue":Me[3]||(Me[3]=ke=>m.value=ke),modelModifiers:{number:!0},error:!Se.value,"hide-details":"auto",label:U(ne)("crypto_amount"),type:"number"},null,8,["modelValue","error","label"]),E(hr,{modelValue:o.value,"onUpdate:modelValue":Me[4]||(Me[4]=ke=>o.value=ke),error:!me.value,hint:U(ne)("crypto_hint"),"hide-details":"auto",label:U(ne)("recipient_racer_name"),"persistent-hint":""},null,8,["modelValue","error","hint","label"]),I.value?(Fe(),ft(hu,{key:0,class:"mt-1",type:"error"},{default:K(()=>[Ne(ee(U(ne)(I.value)),1)]),_:1})):Mt("",!0),Xe("p",dF,[E(Nt,{block:"",rounded:"xl",color:"success",variant:"flat",loading:D.value,disabled:!Se.value,text:U(ne)("transfer")+" "+m.value+" "+U(i).baseData.data.cryptoType,onClick:Ce},null,8,["loading","disabled","text"])])]),_:1})]),_:1},8,["modelValue"])]),_:1}),E(Zn,null,{default:K(()=>[E(Qi),E(Nt,{variant:"text",text:U(ne)("close"),onClick:Me[6]||(Me[6]=ke=>U(i).showCryptoModal=!1)},null,8,["text"])]),_:1})]),_:1},8,["title","subtitle"])]),_:1},8,["modelValue"]))}});const fF=Pi(hF,[["__scopeId","data-v-2fd83ae0"]]);function pF(e){const i=ln(e());let l=-1;function u(){clearInterval(l)}function f(){u(),Fi(()=>i.value=e())}function g(m){const o=m?getComputedStyle(m):{transitionDuration:.2},T=parseFloat(o.transitionDuration)*1e3||200;if(u(),i.value<=0)return;const k=performance.now();l=window.setInterval(()=>{const I=performance.now()-k+T;i.value=Math.max(e()-I,0),i.value<=0&&u()},T)}return kr(u),{clear:u,time:i,start:g,reset:f}}const mF=Ct({multiLine:Boolean,text:String,timer:[Boolean,String],timeout:{type:[Number,String],default:5e3},vertical:Boolean,...vu({location:"bottom"}),...Bh(),...ua(),...Is(),...Di(),...Ps(Vh({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},"VSnackbar"),hv=Wt()({name:"VSnackbar",props:mF(),emits:{"update:modelValue":e=>!0},setup(e,i){let{slots:l}=i;const u=ai(e,"modelValue"),{positionClasses:f}=Fh(e),{scopeId:g}=nc(),{themeClasses:m}=Hi(e),{colorClasses:o,colorStyles:T,variantClasses:k}=tc(e),{roundedClasses:I}=da(e),z=pF(()=>Number(e.timeout)),O=Ke(),D=Ke(),B=ln(!1),V=ln(0),Z=Ke(),oe=ri(xh,void 0);Oa(()=>!!oe,()=>{const Ee=yA();Sa(()=>{Z.value=Ee.mainStyles.value})}),en(u,Se),en(()=>e.timeout,Se),Qn(()=>{u.value&&Se()});let pe=-1;function Se(){z.reset(),window.clearTimeout(pe);const Ee=Number(e.timeout);if(!u.value||Ee===-1)return;const xe=Ey(D.value);z.start(xe),pe=window.setTimeout(()=>{u.value=!1},Ee)}function me(){z.reset(),window.clearTimeout(pe)}function be(){B.value=!0,me()}function he(){B.value=!1,Se()}function Ce(Ee){V.value=Ee.touches[0].clientY}function ye(Ee){Math.abs(V.value-Ee.changedTouches[0].clientY)>50&&(u.value=!1)}function Me(){B.value&&he()}const ke=ce(()=>e.location.split(" ").reduce((Ee,xe)=>(Ee[`v-snackbar--${xe}`]=!0,Ee),{}));return hn(()=>{const Ee=Wo.filterProps(e),xe=!!(l.default||l.text||e.text);return E(Wo,an({ref:O,class:["v-snackbar",{"v-snackbar--active":u.value,"v-snackbar--multi-line":e.multiLine&&!e.vertical,"v-snackbar--timer":!!e.timer,"v-snackbar--vertical":e.vertical},ke.value,f.value,e.class],style:[Z.value,e.style]},Ee,{modelValue:u.value,"onUpdate:modelValue":Oe=>u.value=Oe,contentProps:an({class:["v-snackbar__wrapper",m.value,o.value,I.value,k.value],style:[T.value],onPointerenter:be,onPointerleave:he},Ee.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0,onTouchstartPassive:Ce,onTouchend:ye,onAfterLeave:Me},g),{default:()=>{var Oe,We;return[ec(!1,"v-snackbar"),e.timer&&!B.value&&E("div",{key:"timer",class:"v-snackbar__timer"},[E(mC,{ref:D,color:typeof e.timer=="string"?e.timer:"info",max:e.timeout,"model-value":z.time.value},null)]),xe&&E("div",{key:"content",class:"v-snackbar__content",role:"status","aria-live":"polite"},[((Oe=l.text)==null?void 0:Oe.call(l))??e.text,(We=l.default)==null?void 0:We.call(l)]),l.actions&&E(Bi,{defaults:{VBtn:{variant:"text",ripple:!1,slim:!0}}},{default:()=>[E("div",{class:"v-snackbar__actions"},[l.actions({isActive:u})])]})]},activator:l.activator})}),fo({},O)}}),gF={key:0,class:"text-subtitle-1 pt-2"},_F=Vn({__name:"H2HInvite",setup(e){const i=ei(),l=Ke(!1),u=ce(()=>!!i.head2headData.inviteRaceId),f=async()=>{const o=await Ht.post("UiFetchH2HData");i.head2headData=o.data},g=()=>{l.value=!0,Ht.post("UiJoinHead2Head"),l.value=!1,f(),ca()},m=()=>{l.value=!0,Ht.post("UiDenyHead2Head"),l.value=!1,f()};return Qn(()=>{f()}),(o,T)=>(Fe(),ft(hv,{"z-index":"2000",modelValue:u.value,"onUpdate:modelValue":T[0]||(T[0]=k=>u.value=k),attach:".app-container",transition:"slide-y-transition",location:"top right",contained:"",timeout:1e4,variant:"flat",color:"surface"},{actions:K(()=>[E(Nt,{rounded:"xl",loading:l.value,onClick:m,color:"red"},{default:K(()=>[Ne(ee(U(ne)("deny")),1)]),_:1},8,["loading"]),E(Nt,{rounded:"xl",loading:l.value,onClick:g,variant:"flat",color:"green"},{default:K(()=>[Ne(ee(U(ne)("accept")),1)]),_:1},8,["loading"])]),default:K(()=>{var k;return[Xe("h3",null,ee(U(ne)("head2head_invite"))+" "+ee(U(i).head2headData.invitee),1),(k=U(i).notification)!=null&&k.text?(Fe(),Ot("p",gF,ee(U(i).notification.text),1)):Mt("",!0)]}),_:1},8,["modelValue"]))}});const yF={key:0,class:"text-subtitle-1 pt-2"},vF=Vn({__name:"H2HActive",setup(e){const i=ei(),l=Ke(!1),u=ce(()=>!!i.head2headData.opponentId),f=async()=>{const m=await Ht.post("UiFetchH2HData");i.head2headData=m.data},g=async()=>{l.value=!0,await Ht.post("UiLeaveHead2Head"),l.value=!1,f(),ca()};return Qn(()=>{f()}),(m,o)=>(Fe(),ft(hv,{"z-index":"2000",modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=T=>u.value=T),attach:".app-container",transition:"slide-y-transition",location:"top right",contained:"",timeout:-1,variant:"tonal",color:"surface"},{actions:K(()=>[E(Nt,{rounded:"xl",loading:l.value,onClick:g,color:"red"},{default:K(()=>[Ne(ee(U(ne)("leave_h2h")),1)]),_:1},8,["loading"])]),default:K(()=>{var T;return[Xe("h3",null,ee(U(ne)("in_h2h")),1),(T=U(i).notification)!=null&&T.text?(Fe(),Ot("p",yF,ee(U(i).notification.text),1)):Mt("",!0)]}),_:1},8,["modelValue"]))}});const bF={id:"SettingsPage",class:"pagecontent"},xF=Vn({__name:"AdminMenu",setup(e){const i=Ke({autoHostIsEnabled:!1,hostingIsEnabled:!1}),l=ei(),u=Ke(!1),f=async k=>{u.value=!0,await Ht.post("UiToggleAutoHost"),u.value=!1},g=async k=>{u.value=!0,await Ht.post("UiToggleHosting"),u.value=!1},m=()=>{Ht.post("UIRerollBounties")},o=()=>{Ht.post("UINewAutoHost")},T=async()=>{u.value=!0;const k=await Ht.post("UiGetAdminData");i.value=k.data,u.value=!1};return Qn(()=>{T()}),(k,I)=>(Fe(),Ot("div",bF,[E(ro,null,{default:K(()=>[E(pr,{value:"current",class:"tabcontent"},{default:K(()=>[E(ov,null,{default:K(()=>[E(On,null,{default:K(()=>[E($n,null,{default:K(()=>[Ne(ee(U(ne)("race_admin")),1)]),_:1}),E(qn,null,{default:K(()=>[E(Lm,null,{default:K(()=>[U(l).baseData.data.auth.handleHosting?(Fe(),ft(ns,{key:0},{default:K(()=>[E(sr,{cols:"12",sm:"6"},{default:K(()=>[E(aa,{color:"primary",label:U(ne)("enable_hosting"),modelValue:i.value.hostingIsEnabled,"onUpdate:modelValue":I[0]||(I[0]=z=>i.value.hostingIsEnabled=z),onChange:g},null,8,["label","modelValue"])]),_:1})]),_:1})):Mt("",!0),U(l).baseData.data.auth.handleAutoHost?(Fe(),ft(ns,{key:1},{default:K(()=>[E(sr,{cols:"12",sm:"6"},{default:K(()=>[E(Nt,{onClick:o,variant:"flat",color:"primary"},{default:K(()=>[Ne(ee(U(ne)("trigger_new_autohost")),1)]),_:1})]),_:1}),E(sr,{cols:"12",sm:"6"},{default:K(()=>[E(aa,{color:"primary",label:U(ne)("enable_auto_hosting"),modelValue:i.value.autoHostIsEnabled,"onUpdate:modelValue":I[1]||(I[1]=z=>i.value.autoHostIsEnabled=z),onChange:f},null,8,["label","modelValue"])]),_:1})]),_:1})):Mt("",!0),U(l).baseData.data.auth.handleBounties?(Fe(),ft(ns,{key:2},{default:K(()=>[E(sr,{cols:"12",sm:"6"},{default:K(()=>[E(Nt,{onClick:m,variant:"flat",color:"primary"},{default:K(()=>[Ne(ee(U(ne)("reroll_bounties")),1)]),_:1})]),_:1})]),_:1})):Mt("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]))}});const wF=Pi(xF,[["__scopeId","data-v-084799c7"]]);const SF=Ct({...xn(),...Va(),...FS()},"VLayout"),CF=Wt()({name:"VLayout",props:SF(),setup(e,i){let{slots:l}=i;const{layoutClasses:u,layoutStyles:f,getLayoutItem:g,items:m,layoutRef:o}=OS(e),{dimensionStyles:T}=Na(e);return hn(()=>{var k;return E("div",{ref:o,class:[u.value,e.class],style:[T.value,f.value,e.style]},[(k=l.default)==null?void 0:k.call(l)])}),{getLayoutItem:g,items:m}}}),TF={class:"ui-container"},PF={key:0,class:"screen-container"},kF={class:"app-container"},IF={key:0,class:"text-subtitle-1 pt-2"},MF={key:0,class:"tabs-container"},EF={key:1,id:"revoked-message-container"},AF={class:"revoked-message-holder"},RF=Vn({__name:"RaceAppView",setup(e){const i=ei(),l=Ke(!1),u=Ke(3e3),f=ce(()=>{var m;if(!i.baseData.data.currentRacerName&&i.baseData.data.racerNames&&i.baseData.data.racerNames.length===0)return{title:ne("error_lacking_user"),text:ne("error_lacking_user_desc"),color:"info",icon:"$info",type:"no_user"};if(i.baseData.data.currentRacerName){const o=(m=i.baseData.data.racerNames)==null?void 0:m.find(T=>i.baseData.data.currentRacerName===T.racername);if(o){if(o.revoked)return{title:ne("error_revoked"),text:ne("error_revoked_desc"),type:"revoked"}}else return{title:ne("error_permanently_removed"),text:ne("error_permanently_removed_desc"),type:"removed"}}else return{title:ne("error_no_user"),text:ne("error_no_user_desc"),color:"info",icon:"$info",type:"no_user"};return!1});document.onkeydown=function(m){(m==null?void 0:m.key)==="Escape"&&ca()};const g=m=>{const o=m==null?void 0:m.data;o.type==="notify"&&(i.$state.notification=o.data,l.value=!0)};return Qn(()=>{Ys(),window.addEventListener("message",g)}),(m,o)=>{var T;return Fe(),Ot("div",TF,[U(i).baseData.data?(Fe(),Ot("div",PF,[E(JM),Xe("div",kF,[E(hv,{modelValue:l.value,"onUpdate:modelValue":o[1]||(o[1]=k=>l.value=k),attach:".app-container",transition:"slide-y-transition",location:"top",contained:"","multi-line":"",vertical:"",timeout:u.value,color:(T=U(i).notification)==null?void 0:T.type},{actions:K(()=>[E(Nt,{variant:"text",onClick:o[0]||(o[0]=k=>l.value=!1)},{default:K(()=>[Ne(ee(U(ne)("close")),1)]),_:1})]),default:K(()=>{var k,I;return[Xe("h3",null,ee((k=U(i).notification)==null?void 0:k.title),1),(I=U(i).notification)!=null&&I.text?(Fe(),Ot("p",IF,ee(U(i).notification.text),1)):Mt("",!0)]}),_:1},8,["modelValue","timeout","color"]),E(_F),E(vF),E(CF,null,{default:K(()=>[E(TA),U(i).currentPage==="settings"||!f.value?(Fe(),Ot("div",MF,[U(i).currentPage==="racing"?(Fe(),ft(ML,{key:0})):Mt("",!0),U(i).currentPage==="results"?(Fe(),ft(yB,{key:1})):Mt("",!0),U(i).currentPage==="mytracks"?(Fe(),ft(DB,{key:2})):Mt("",!0),U(i).currentPage==="racers"?(Fe(),ft($B,{key:3})):Mt("",!0),U(i).currentPage==="crew"?(Fe(),ft(aF,{key:4})):Mt("",!0),U(i).currentPage==="settings"?(Fe(),ft(GB,{key:5})):Mt("",!0),U(i).currentPage==="admin"?(Fe(),ft(wF,{key:6})):Mt("",!0)])):(Fe(),Ot("div",EF,[Xe("div",AF,[E(hu,{title:f.value.title,text:f.value.text,color:f.value.color?f.value.color:"error",icon:f.value.icon?f.value.icon:"$error"},null,8,["title","text","color","icon"]),U(i).baseData.data.anyoneCanCreate&&U(i).baseData.data.racerNames.length===0?(Fe(),ft(sF,{key:0})):Mt("",!0)])]))]),_:1}),E(fF)])])):Mt("",!0)])}}});const DF=Pi(RF,[["__scopeId","data-v-a3527e4a"]]),zF={class:"editor"},LF={class:"blocks-container"},BF={class:"blocks"},FF={class:"box editor-holder"},OF={class:"editor-text",id:"editor-racename"},VF={class:"editor-text",id:"editor-checkpoints"},NF={class:"editor-text",id:"editor-checkpoints"},$F={class:"box editor-holder buttons"},jF={class:"editor-text",id:"editor-keys-add"},UF={id:"editor-keys-add-button",style:{color:"rgb(0, 201, 0)"}},GF={key:0,class:"editor-text",id:"editor-keys-delete"},HF={style:{color:"rgb(255, 43, 43)"}},ZF={class:"editor-text",id:"editor-keys-edit"},qF={id:"editor-keys-edit-button",style:{color:"rgb(0, 201, 0)"}},WF={class:"editor-text",id:"editor-keys-tiredistance"},XF={style:{"margin-right":"0.5em",color:"rgb(255, 43, 43)"}},KF={style:{color:"rgb(0, 201, 0)"}},YF={class:"editor-text",id:"editor-keys-cancel"},JF={id:"editor-keys-cancel-button",style:{color:"rgb(255, 43, 43)"}},QF={class:"editor-text",id:"editor-keys-save"},eO={id:"editor-keys-save-button",style:{color:"rgb(0, 201, 0)"}},tO=Vn({__name:"EditorHud",setup(e){const i=ei();return(l,u)=>(Fe(),Ot("div",zF,[Xe("div",LF,[Xe("div",BF,[Xe("div",FF,[Xe("span",OF,ee(U(ne)("track_name"))+" : "+ee(U(i).creatorData.RaceName),1),Xe("span",VF,ee(U(ne)("checkpoints"))+" : "+ee(U(i).creatorData.Checkpoints?U(i).creatorData.Checkpoints.length:0),1),Xe("span",NF,ee(U(ne)("closest_checkpoint"))+" : "+ee(U(i).creatorData.ClosestCheckpoint?U(i).creatorData.ClosestCheckpoint:"Unknown"),1)]),Xe("div",$F,[Xe("span",jF,[Xe("span",UF,ee(U(i).buttons.AddCheckpoint),1),Ne(" : "+ee(U(ne)("add_checkpoint")),1)]),U(i).creatorData.ClosestCheckpoint?(Fe(),Ot("span",GF,[Xe("span",HF,"["+ee(U(i).buttons.DeleteCheckpoint)+"]",1),Ne(" : "+ee(U(ne)("delete_checkpoint"))+" "+ee(U(i).creatorData.ClosestCheckpoint),1)])):Mt("",!0),Xe("span",ZF,[Xe("span",qF,"["+ee(U(i).buttons.MoveCheckpoint)+"]",1),Ne(": "+ee(U(ne)("modify_checkpoint")),1)]),Xe("span",WF,[Xe("span",XF,"["+ee(U(i).buttons.DecreaseDistance)+"]",1),Xe("span",KF," ["+ee(U(i).buttons.IncreaseDistance)+"] ",1),Ne(" "+ee(U(ne)("tire_distance"))+" : ["+ee(U(i).creatorData.TireDistance)+"] ",1)]),Xe("span",YF,[Xe("span",JF,"["+ee(U(i).buttons.Exit)+"]",1),Ne(" : "+ee(U(ne)("close_editor")),1)]),Xe("span",QF,[Xe("span",eO,"["+ee(U(i).buttons.SaveRace)+"]",1),Ne(" :"+ee(U(ne)("save_track")),1)])])])])]))}});const nO=Pi(tO,[["__scopeId","data-v-292afe78"]]),iO={class:"racers-holder"},rO={class:"number"},aO={class:"name"},sO={key:0,class:"difference"},oO={key:1,class:"difference"},lO={key:2,class:"difference"},cO=Vn({__name:"RacerList",props:{racers:{}},setup(e){const i=e,l=ei(),u=ce(()=>{var m,o,T,k;return(k=i.racers)==null?void 0:k.slice(0,((T=(o=(m=l.baseData)==null?void 0:m.data)==null?void 0:o.hudSettings)==null?void 0:T.maxPositions)||10)}),f=m=>{if(m===0)return"0.000";const o=m>0,k=(Math.abs(m)/1e3).toFixed(3);return o?`+${k}`:`-${k}`},g=(m,o)=>{const T=m.CheckpointTimes.length,k=o.CheckpointTimes.length;if(T===0||k===0)return"";const I=Math.min(T,k)-1,z=m.CheckpointTimes[I].time,O=o.CheckpointTimes[I].time;return f(O-z)};return(m,o)=>(Fe(),Ot("div",iO,[(Fe(!0),Ot(un,null,la(u.value,(T,k)=>(Fe(),Ot("div",{class:om(["box",{me:k===U(l).activeRace.position-1}]),key:T.RacerSource},[Xe("div",rO,ee(k+1),1),Xe("span",aO,ee(T.RacerName),1),k===0&&T.Finished?(Fe(),Ot("span",sO,ee(U(ne)("winner")),1)):T.Finished?(Fe(),Ot("span",oO,ee(U(ne)("finished")),1)):k!==U(l).activeRace.position-1?(Fe(),Ot("span",lO,ee(g(m.racers[U(l).activeRace.position-1],T)),1)):Mt("",!0)],2))),128))]))}});const uO=Pi(cO,[["__scopeId","data-v-adc35222"]]),dO={class:"race"},hO={class:"boxes"},fO={class:"positions-container"},pO={class:"blocks-container"},mO={class:"blocks"},gO={id:"track-name"},_O={key:0,class:"position-container"},yO={id:"smaller"},vO={id:"position"},bO={class:"column"},xO={id:"smaller"},wO={id:"checkpoint"},SO={class:"row"},CO={id:"race-time"},TO={class:"row"},PO={id:"race-time"},kO={class:"row"},IO={id:"race-time"},MO={class:"row"},EO={id:"race-time"},AO={key:1,id:"race-ghosted-span"},RO=Vn({__name:"RaceHud",setup(e){Ek(m=>({b2c08384:u.value,"0261b2d8":f.value}));const i=ei(),l={split:"space-between",left:"start",right:"end"},u=ce(()=>{var m,o,T,k,I,z;return(T=(o=(m=i.baseData)==null?void 0:m.data)==null?void 0:o.hudSettings)!=null&&T.location?l[(z=(I=(k=i.baseData)==null?void 0:k.data)==null?void 0:I.hudSettings)==null?void 0:z.location]:"space-between"}),f=ce(()=>{var m,o,T;return((T=(o=(m=i.baseData)==null?void 0:m.data)==null?void 0:o.hudSettings)==null?void 0:T.location)==="left"?"row-reverse":"row"}),g=ce(()=>i.activeRace.totalLaps===0?"Sprint":i.activeRace.totalLaps===-1?`${i.activeRace.currentLap}/-`:`${i.activeRace.currentLap}/${i.activeRace.totalLaps}`);return(m,o)=>(Fe(),Ot("div",dO,[Xe("div",hO,[Xe("div",fO,[E(uO,{racers:U(i).activeRace.positions},null,8,["racers"])]),Xe("div",pO,[Xe("div",mO,[Xe("span",gO,ee(U(i).activeRace.raceName),1),U(i).activeRace.totalRacers&&U(i).activeRace.totalRacers!==1?(Fe(),Ot("div",_O,[Xe("span",yO,ee(U(ne)("pos")),1),Xe("span",vO,ee(`${U(i).activeRace.position}/${U(i).activeRace.totalRacers}`),1)])):Mt("",!0),Xe("div",bO,[Xe("span",xO,ee(U(ne)("checkpoints")),1),Xe("span",wO,ee(`${U(i).activeRace.currentCheckpoint}/${U(i).activeRace.totalCheckpoints}`),1)]),Xe("div",SO,[Xe("span",CO,ee(g.value),1),E(ui,{icon:"mdi-cached"})]),Xe("div",TO,[Xe("span",PO,ee(U(no)(U(i).activeRace.time)),1),E(ui,{icon:"mdi-timer-sync-outline"})]),Xe("div",kO,[Xe("span",IO,ee(U(no)(U(i).activeRace.totalTime)),1),E(ui,{icon:"mdi-timer-outline"})]),Xe("div",MO,[Xe("span",EO,ee(U(no)(U(i).activeRace.bestLap)),1),E(ui,{icon:"mdi-timer-star-outline"})]),U(i).activeRace.ghosted?(Fe(),Ot("div",AO,[E(ui,{icon:"mdi-ghost-outline"})])):Mt("",!0)])])])]))}});const DO=Pi(RO,[["__scopeId","data-v-1fa91d2c"]]),zO={class:"countdown-container"},LO={class:"countdown-holder"},BO={key:0,id:"countdown-text"},FO={key:1,id:"countdown-text"},OO={id:"countdown-number"},VO=Vn({__name:"CountdownHud",props:{countdownNumber:{}},setup(e){return(i,l)=>(Fe(),Ot("div",zO,[Xe("div",LO,[E(Ts,{name:"scale",mode:"out-in"},{default:K(()=>[i.countdownNumber===0?(Fe(),Ot("span",BO,ee(U(ne)("go")),1)):i.countdownNumber===10?(Fe(),Ot("span",FO,ee(U(ne)("get_ready")),1)):(Fe(),Ot("div",{key:i.countdownNumber,class:"number-holder"},[Xe("span",OO,ee(i.countdownNumber),1)]))]),_:1})])]))}});const NO=Pi(VO,[["__scopeId","data-v-8df4136b"]]),$O=Vn({__name:"HudView",setup(e){const i=ei();return(l,u)=>(Fe(),ft(Lm,{class:"d-flex fill-height"},{default:K(()=>[U(i).creatorData&&U(i).activeHudData.InCreator?(Fe(),ft(nO,{key:0})):Mt("",!0),U(i).activeRace&&U(i).activeHudData.InRace?(Fe(),ft(DO,{key:1})):Mt("",!0),U(i).countdown>-1?(Fe(),ft(NO,{key:2,countdownNumber:U(i).countdown},null,8,["countdownNumber"])):Mt("",!0)]),_:1}))}});const jO=Ct({...xn(),...FS({fullHeight:!0}),...Di()},"VApp"),UO=Wt()({name:"VApp",props:jO(),setup(e,i){let{slots:l}=i;const u=Hi(e),{layoutClasses:f,getLayoutItem:g,items:m,layoutRef:o}=OS(e),{rtlClasses:T}=ja();return hn(()=>{var k;return E("div",{ref:o,class:["v-application",u.themeClasses.value,f.value,T.value,e.class],style:[e.style]},[E("div",{class:"v-application__wrap"},[(k=l.default)==null?void 0:k.call(l)])])}),{getLayoutItem:g,items:m,theme:u}}}),GO=Vn({__name:"App",setup(e){const i=Qw(),l=ei(),u=I=>{I&&k(),l.$state.appIsOpen=I},f=I=>{I.action=="update"?(l.$state.hudIsOpen=I,l.$state.activeRace=I.data,l.$state.activeHudData=I.racedata):(l.$state.countdown=I.data.value,I.data.value===0&&setTimeout(()=>{l.$state.countdown=-1},2e3))},g=I=>{I.action=="update"&&(l.$state.buttons=I.buttons,l.$state.creatorData=I.data,l.$state.activeHudData.InCreator=I.active)},m=I=>{switch(I.dataType){case"bounties":l.bounties=I.data;break;case"crypto":l.baseData.data.currentCrypto=I.data;break}},o=I=>{l.head2headData=I},T=I=>{const z=I==null?void 0:I.data;if(z!=null&&z.type)switch(z.type){case"race":f(z);break;case"creator":g(z);break;case"toggleApp":u(z.open);break;case"notify":l.$state.notification=z.data;break;case"updateBaseData":k();break;case"dataUpdate":m(z);break;case"head2head":o(z.data)}},k=async()=>{const I=await Ht.post("GetBaseData");I&&(l.$state.baseData=I),I.data.primaryColor&&(i.themes.value.dark.colors.primary=I.data.primaryColor)};return Qn(()=>{window.addEventListener("message",T)}),kh(()=>{window.removeEventListener("message",T,!1)}),(I,z)=>(Fe(),ft(UO,{theme:"dark"},{default:K(()=>[E(Ts,{name:"scale",mode:"out-in"},{default:K(()=>[U(l).appIsOpen?(Fe(),ft(DF,{key:0})):Mt("",!0)]),_:1}),E($O)]),_:1}))}});const HO="modulepreload",ZO=function(e,i){return new URL(e,i).href},Yx={},qO=function(i,l,u){if(!l||l.length===0)return i();const f=document.getElementsByTagName("link");return Promise.all(l.map(g=>{if(g=ZO(g,u),g in Yx)return;Yx[g]=!0;const m=g.endsWith(".css"),o=m?'[rel="stylesheet"]':"";if(!!u)for(let I=f.length-1;I>=0;I--){const z=f[I];if(z.href===g&&(!m||z.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${g}"]${o}`))return;const k=document.createElement("link");if(k.rel=m?"stylesheet":HO,m||(k.as="script",k.crossOrigin=""),k.href=g,document.head.appendChild(k),m)return new Promise((I,z)=>{k.addEventListener("load",I),k.addEventListener("error",()=>z(new Error(`Unable to preload CSS for ${g}`)))})})).then(()=>i()).catch(g=>{const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=g,window.dispatchEvent(m),!m.defaultPrevented)throw g})};async function WO(){(await qO(()=>import("./webfontloader-d2524f64.js").then(i=>i.w),[],import.meta.url)).load({google:{families:["Roboto:100,300,400,500,700,900&display=swap"]}})}const XO=qC({theme:{themes:{dark:{colors:{primary:"#e36a00",secondary:"#5CBBF6",surface:"#0e0e0e"}}}}}),KO=Sw();function YO(e){WO(),e.use(XO).use(KO)}const JO=Sw(),fv=Qk(GO);fv.use(JO);YO(fv);fv.mount("#app");export{Xz as g};
